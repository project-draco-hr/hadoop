{
  inMemoryMapOutputs.add(mapOutput);
  LOG.info("closeInMemoryFile -> map-output of size: " + mapOutput.getSize() + ", inMemoryMapOutputs.size() -> "+ inMemoryMapOutputs.size());
synchronized (inMemoryMerger) {
    if (!inMemoryMerger.isInProgress() && usedMemory >= mergeThreshold) {
      LOG.info("Starting inMemoryMerger's merge since usedMemory=" + usedMemory + " > mergeThreshold="+ mergeThreshold);
      inMemoryMapOutputs.addAll(inMemoryMergedMapOutputs);
      inMemoryMergedMapOutputs.clear();
      inMemoryMerger.startMerge(inMemoryMapOutputs);
    }
  }
  if (memToMemMerger != null) {
synchronized (memToMemMerger) {
      if (!memToMemMerger.isInProgress() && inMemoryMapOutputs.size() >= memToMemMergeOutputsThreshold) {
        memToMemMerger.startMerge(inMemoryMapOutputs);
      }
    }
  }
}
