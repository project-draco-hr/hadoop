{
  if (!canShuffleToMemory(requestedSize)) {
    LOG.info(mapId + ": Shuffling to disk since " + requestedSize+ " is greater than maxSingleShuffleLimit ("+ maxSingleShuffleLimit+ ")");
    return new MapOutput<K,V>(mapId,this,requestedSize,jobConf,localDirAllocator,fetcher,true,mapOutputFile);
  }
  if (usedMemory > memoryLimit) {
    LOG.debug(mapId + ": Stalling shuffle since usedMemory (" + usedMemory+ ") is greater than memoryLimit ("+ memoryLimit+ ")");
    return stallShuffle;
  }
  LOG.debug(mapId + ": Proceeding with shuffle since usedMemory (" + usedMemory+ ") is lesser than memoryLimit ("+ memoryLimit+ ")");
  return unconditionalReserve(mapId,requestedSize,true);
}
