{
  Class<? extends Reducer<K,V,K,V>> cls=(Class<? extends Reducer<K,V,K,V>>)job.getCombinerClass();
  if (cls != null) {
    return new OldCombinerRunner(cls,job,inputCounter,reporter);
  }
  org.apache.hadoop.mapreduce.TaskAttemptContext taskContext=new org.apache.hadoop.mapreduce.task.TaskAttemptContextImpl(job,taskId,reporter);
  Class<? extends org.apache.hadoop.mapreduce.Reducer<K,V,K,V>> newcls=(Class<? extends org.apache.hadoop.mapreduce.Reducer<K,V,K,V>>)taskContext.getCombinerClass();
  if (newcls != null) {
    return new NewCombinerRunner<K,V>(newcls,job,taskId,taskContext,inputCounter,reporter,committer);
  }
  return null;
}
