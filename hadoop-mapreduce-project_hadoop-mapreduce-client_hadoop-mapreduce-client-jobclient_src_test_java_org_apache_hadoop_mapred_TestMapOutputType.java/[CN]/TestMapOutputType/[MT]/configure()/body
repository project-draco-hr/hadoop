{
  Path testdir=new Path(TEST_DIR.getAbsolutePath());
  Path inDir=new Path(testdir,"in");
  Path outDir=new Path(testdir,"out");
  FileSystem fs=FileSystem.get(conf);
  fs.delete(testdir,true);
  conf.setInt(JobContext.IO_SORT_MB,1);
  conf.setInputFormat(SequenceFileInputFormat.class);
  FileInputFormat.setInputPaths(conf,inDir);
  FileOutputFormat.setOutputPath(conf,outDir);
  conf.setMapperClass(TextGen.class);
  conf.setReducerClass(TextReduce.class);
  conf.setOutputKeyClass(Text.class);
  conf.setOutputValueClass(Text.class);
  conf.set(MRConfig.FRAMEWORK_NAME,MRConfig.LOCAL_FRAMEWORK_NAME);
  conf.setOutputFormat(SequenceFileOutputFormat.class);
  if (!fs.mkdirs(testdir)) {
    throw new IOException("Mkdirs failed to create " + testdir.toString());
  }
  if (!fs.mkdirs(inDir)) {
    throw new IOException("Mkdirs failed to create " + inDir.toString());
  }
  Path inFile=new Path(inDir,"part0");
  SequenceFile.Writer writer=SequenceFile.createWriter(fs,conf,inFile,Text.class,Text.class);
  writer.append(new Text("rec: 1"),new Text("Hello"));
  writer.close();
  jc=new JobClient(conf);
}
