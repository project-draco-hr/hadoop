{
  fs.mkdirs(linkParent);
  fs.mkdirs(targetParent);
  DFSTestUtil.createFile(fs,target,1024,(short)3,0xBEEFl);
  fs.createSymlink(target,link,false);
  fs.setXAttr(target,name1,value1);
  fs.setXAttr(target,name2,value2);
  Map<String,byte[]> xattrs=fs.getXAttrs(link);
  Assert.assertEquals(xattrs.size(),2);
  Assert.assertArrayEquals(value1,xattrs.get(name1));
  Assert.assertArrayEquals(value2,xattrs.get(name2));
  fs.setXAttr(link,name3,null);
  xattrs=fs.getXAttrs(target);
  Assert.assertEquals(xattrs.size(),3);
  Assert.assertArrayEquals(value1,xattrs.get(name1));
  Assert.assertArrayEquals(value2,xattrs.get(name2));
  Assert.assertArrayEquals(new byte[0],xattrs.get(name3));
  fs.removeXAttr(link,name1);
  xattrs=fs.getXAttrs(target);
  Assert.assertEquals(xattrs.size(),2);
  Assert.assertArrayEquals(value2,xattrs.get(name2));
  Assert.assertArrayEquals(new byte[0],xattrs.get(name3));
  fs.removeXAttr(target,name3);
  xattrs=fs.getXAttrs(link);
  Assert.assertEquals(xattrs.size(),1);
  Assert.assertArrayEquals(value2,xattrs.get(name2));
  fs.delete(linkParent,true);
  fs.delete(targetParent,true);
}
