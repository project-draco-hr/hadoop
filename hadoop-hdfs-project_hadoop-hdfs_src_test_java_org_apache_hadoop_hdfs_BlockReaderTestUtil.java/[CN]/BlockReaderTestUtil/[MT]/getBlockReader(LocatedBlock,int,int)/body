{
  InetSocketAddress targetAddr=null;
  Socket sock=null;
  ExtendedBlock block=testBlock.getBlock();
  DatanodeInfo[] nodes=testBlock.getLocations();
  targetAddr=NetUtils.createSocketAddr(nodes[0].getXferAddr());
  sock=NetUtils.getDefaultSocketFactory(conf).createSocket();
  sock.connect(targetAddr,HdfsServerConstants.READ_TIMEOUT);
  sock.setSoTimeout(HdfsServerConstants.READ_TIMEOUT);
  return BlockReaderFactory.newBlockReader(new BlockReaderFactory.Params(new Conf(conf)).setSocket(sock).setFile(targetAddr.toString() + ":" + block.getBlockId()).setBlock(block).setBlockToken(testBlock.getBlockToken()).setStartOffset(offset).setLen(lenToRead).setBufferSize(conf.getInt(CommonConfigurationKeys.IO_FILE_BUFFER_SIZE_KEY,4096)).setVerifyChecksum(true));
}
