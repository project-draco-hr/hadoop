{
  InetSocketAddress targetAddr=null;
  Socket sock=null;
  ExtendedBlock block=testBlock.getBlock();
  DatanodeInfo[] nodes=testBlock.getLocations();
  targetAddr=NetUtils.createSocketAddr(nodes[0].getXferAddr());
  sock=NetUtils.getDefaultSocketFactory(conf).createSocket();
  sock.connect(targetAddr,HdfsServerConstants.READ_TIMEOUT);
  sock.setSoTimeout(HdfsServerConstants.READ_TIMEOUT);
  return BlockReaderFactory.newBlockReader(new DFSClient.Conf(conf),sock,targetAddr.toString() + ":" + block.getBlockId(),block,testBlock.getBlockToken(),offset,lenToRead,conf.getInt(CommonConfigurationKeys.IO_FILE_BUFFER_SIZE_KEY,4096),true,"",null,null);
}
