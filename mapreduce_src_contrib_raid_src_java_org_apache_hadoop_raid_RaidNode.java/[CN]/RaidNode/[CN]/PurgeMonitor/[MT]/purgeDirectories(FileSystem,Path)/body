{
  String prefix=root.toUri().getPath();
  List<FileStatus> startPaths=new LinkedList<FileStatus>();
  try {
    startPaths.add(fs.getFileStatus(root));
  }
 catch (  FileNotFoundException e) {
    return;
  }
  DirectoryTraversal dt=new DirectoryTraversal(fs,startPaths);
  FileStatus dir=dt.getNextDirectory();
  for (; dir != null; dir=dt.getNextDirectory()) {
    Path dirPath=dir.getPath();
    if (dirPath.toUri().getPath().endsWith(HAR_SUFFIX)) {
      continue;
    }
    String dirStr=dirPath.toUri().getPath();
    if (!dirStr.startsWith(prefix)) {
      continue;
    }
    String src=dirStr.replaceFirst(prefix,"");
    if (src.length() == 0)     continue;
    Path srcPath=new Path(src);
    if (!fs.exists(srcPath)) {
      LOG.info("Purging directory " + dirPath);
      boolean done=fs.delete(dirPath,true);
      if (!done) {
        LOG.error("Could not purge " + dirPath);
      }
    }
  }
}
