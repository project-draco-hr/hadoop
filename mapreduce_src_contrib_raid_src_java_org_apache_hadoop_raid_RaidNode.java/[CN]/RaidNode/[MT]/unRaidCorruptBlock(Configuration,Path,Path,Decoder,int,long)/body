{
  ParityFilePair ppair=getParityFile(destPathPrefix,srcPath,conf);
  if (ppair == null) {
    LOG.error("Could not find parity file for " + srcPath);
    return null;
  }
  final Path recoveryDestination=new Path(RaidNode.xorTempPrefix(conf));
  FileSystem destFs=recoveryDestination.getFileSystem(conf);
  final Path recoveredPrefix=destFs.makeQualified(new Path(recoveryDestination,makeRelative(srcPath)));
  final Path recoveredBlock=new Path(recoveredPrefix + "." + new Random().nextLong()+ ".recovered");
  LOG.info("Creating recovered Block " + recoveredBlock);
  FileSystem srcFs=srcPath.getFileSystem(conf);
  FileStatus stat=srcFs.getFileStatus(srcPath);
  long limit=Math.min(stat.getBlockSize(),stat.getLen() - corruptOffset);
  java.io.OutputStream out=ppair.getFileSystem().create(recoveredBlock);
  decoder.fixErasedBlock(srcFs,srcPath,ppair.getFileSystem(),ppair.getPath(),stat.getBlockSize(),corruptOffset,0,limit,out);
  out.close();
  return recoveredBlock;
}
