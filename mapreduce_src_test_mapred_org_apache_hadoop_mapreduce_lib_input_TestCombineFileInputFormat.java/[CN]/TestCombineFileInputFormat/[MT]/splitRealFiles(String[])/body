{
  Configuration conf=new Configuration();
  Job job=Job.getInstance();
  FileSystem fs=FileSystem.get(conf);
  if (!(fs instanceof DistributedFileSystem)) {
    throw new IOException("Wrong file system: " + fs.getClass().getName());
  }
  int blockSize=conf.getInt("dfs.block.size",128 * 1024 * 1024);
  DummyInputFormat inFormat=new DummyInputFormat();
  for (int i=0; i < args.length; i++) {
    FileInputFormat.addInputPaths(job,args[i]);
  }
  inFormat.setMinSplitSizeRack(blockSize);
  inFormat.setMaxSplitSize(10 * blockSize);
  List<InputSplit> splits=inFormat.getSplits(job);
  System.out.println("Total number of splits " + splits.size());
  for (int i=0; i < splits.size(); ++i) {
    CombineFileSplit fileSplit=(CombineFileSplit)splits.get(i);
    System.out.println("Split[" + i + "] "+ fileSplit);
  }
}
