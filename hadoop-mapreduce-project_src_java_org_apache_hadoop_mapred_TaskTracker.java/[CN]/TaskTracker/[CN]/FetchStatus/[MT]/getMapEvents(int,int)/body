{
  TaskCompletionEvent[] mapEvents=TaskCompletionEvent.EMPTY_ARRAY;
  boolean notifyFetcher=false;
synchronized (allMapEvents) {
    if (allMapEvents.size() > fromId) {
      int actualMax=Math.min(max,(allMapEvents.size() - fromId));
      List<TaskCompletionEvent> eventSublist=allMapEvents.subList(fromId,actualMax + fromId);
      mapEvents=eventSublist.toArray(mapEvents);
    }
 else {
      notifyFetcher=true;
    }
  }
  if (notifyFetcher) {
synchronized (waitingOn) {
      waitingOn.notify();
    }
  }
  return mapEvents;
}
