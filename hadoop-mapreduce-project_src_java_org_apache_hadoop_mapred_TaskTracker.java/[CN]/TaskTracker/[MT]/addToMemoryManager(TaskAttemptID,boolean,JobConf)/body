{
  if (!isTaskMemoryManagerEnabled()) {
    return;
  }
  long physicalMemoryLimit=conf.getLong(isMap ? MRJobConfig.MAP_MEMORY_PHYSICAL_MB : MRJobConfig.REDUCE_MEMORY_PHYSICAL_MB,JobConf.DISABLED_MEMORY_LIMIT);
  if (physicalMemoryLimit > 0) {
    physicalMemoryLimit*=1024L * 1024L;
  }
  long virtualMemoryLimit=isMap ? conf.getMemoryForMapTask() * 1024 * 1024 : conf.getMemoryForReduceTask() * 1024 * 1024;
  taskMemoryManager.addTask(attemptId,virtualMemoryLimit,physicalMemoryLimit);
}
