{
  Configuration conf=job.getConfiguration();
  OneFileInfo[] files;
  HashMap<String,List<OneBlockInfo>> rackToBlocks=new HashMap<String,List<OneBlockInfo>>();
  HashMap<OneBlockInfo,String[]> blockToNodes=new HashMap<OneBlockInfo,String[]>();
  HashMap<String,List<OneBlockInfo>> nodeToBlocks=new HashMap<String,List<OneBlockInfo>>();
  files=new OneFileInfo[paths.length];
  if (paths.length == 0) {
    return;
  }
  long totLength=0;
  for (int i=0; i < paths.length; i++) {
    files[i]=new OneFileInfo(paths[i],conf,isSplitable(job,paths[i]),rackToBlocks,blockToNodes,nodeToBlocks,rackToNodes,maxSize);
    totLength+=files[i].getLength();
  }
  createSplits(nodeToBlocks,blockToNodes,rackToBlocks,totLength,maxSize,minSizeNode,minSizeRack,splits);
}
