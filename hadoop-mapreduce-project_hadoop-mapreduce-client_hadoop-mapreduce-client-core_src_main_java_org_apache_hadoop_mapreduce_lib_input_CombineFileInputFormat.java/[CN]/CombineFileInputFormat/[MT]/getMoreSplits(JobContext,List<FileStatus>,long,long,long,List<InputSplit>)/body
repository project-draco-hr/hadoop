{
  Configuration conf=job.getConfiguration();
  OneFileInfo[] files;
  HashMap<String,List<OneBlockInfo>> rackToBlocks=new HashMap<String,List<OneBlockInfo>>();
  HashMap<OneBlockInfo,String[]> blockToNodes=new HashMap<OneBlockInfo,String[]>();
  HashMap<String,Set<OneBlockInfo>> nodeToBlocks=new HashMap<String,Set<OneBlockInfo>>();
  files=new OneFileInfo[stats.size()];
  if (stats.size() == 0) {
    return;
  }
  long totLength=0;
  int i=0;
  for (  FileStatus stat : stats) {
    files[i]=new OneFileInfo(stat,conf,isSplitable(job,stat.getPath()),rackToBlocks,blockToNodes,nodeToBlocks,rackToNodes,maxSize);
    totLength+=files[i].getLength();
  }
  createSplits(nodeToBlocks,blockToNodes,rackToBlocks,totLength,maxSize,minSizeNode,minSizeRack,splits);
}
