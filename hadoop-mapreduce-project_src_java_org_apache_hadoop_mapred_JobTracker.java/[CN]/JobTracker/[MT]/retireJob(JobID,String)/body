{
synchronized (jobs) {
    JobInProgress job=jobs.get(jobid);
    if (job != null) {
      JobStatus status=job.getStatus();
      if (historyFile != null) {
        status.setHistoryFile(historyFile);
      }
      job.cleanupLocalizedJobConf(job.getProfile().getJobID());
      boolean retireJob=conf.getBoolean(JT_RETIREJOBS,true);
      if (retireJob) {
        removeJobTasks(job);
        jobs.remove(job.getProfile().getJobID());
        for (        JobInProgressListener l : jobInProgressListeners) {
          l.jobRemoved(job);
        }
        String jobUser=job.getProfile().getUser();
        LOG.info("Retired job with id: '" + job.getProfile().getJobID() + "' of user '"+ jobUser+ "'");
        retireJobs.addToCache(job.getStatus());
      }
    }
  }
}
