{
  String trackerName=status.getTrackerName();
  for (  TaskStatus report : status.getTaskReports()) {
    report.setTaskTracker(trackerName);
    TaskAttemptID taskId=report.getTaskID();
    expireLaunchingTasks.removeTask(taskId);
    JobInProgress job=getJob(taskId.getJobID());
    if (job == null) {
synchronized (trackerToJobsToCleanup) {
        Set<JobID> jobs=trackerToJobsToCleanup.get(trackerName);
        if (jobs == null) {
          jobs=new HashSet<JobID>();
          trackerToJobsToCleanup.put(trackerName,jobs);
        }
        jobs.add(taskId.getJobID());
      }
      continue;
    }
    if (!job.inited()) {
synchronized (trackerToTasksToCleanup) {
        Set<TaskAttemptID> tasks=trackerToTasksToCleanup.get(trackerName);
        if (tasks == null) {
          tasks=new HashSet<TaskAttemptID>();
          trackerToTasksToCleanup.put(trackerName,tasks);
        }
        tasks.add(taskId);
      }
      continue;
    }
    TaskInProgress tip=taskidToTIPMap.get(taskId);
    if (tip != null) {
      JobStatus prevStatus=(JobStatus)job.getStatus().clone();
      job.updateTaskStatus(tip,(TaskStatus)report.clone());
      JobStatus newStatus=(JobStatus)job.getStatus().clone();
      if (prevStatus.getRunState() != newStatus.getRunState()) {
        JobStatusChangeEvent event=new JobStatusChangeEvent(job,EventType.RUN_STATE_CHANGED,prevStatus,newStatus);
        updateJobInProgressListeners(event);
      }
    }
 else {
      LOG.info("Serious problem.  While updating status, cannot find taskid " + report.getTaskID());
    }
    List<TaskAttemptID> failedFetchMaps=report.getFetchFailedMaps();
    if (failedFetchMaps != null) {
      for (      TaskAttemptID mapTaskId : failedFetchMaps) {
        TaskInProgress failedFetchMap=taskidToTIPMap.get(mapTaskId);
        if (failedFetchMap != null) {
          String failedFetchTrackerName=getAssignedTracker(mapTaskId);
          if (failedFetchTrackerName == null) {
            failedFetchTrackerName="Lost task tracker";
          }
          failedFetchMap.getJob().fetchFailureNotification(failedFetchMap,mapTaskId,failedFetchTrackerName,taskId,trackerName);
        }
      }
    }
  }
}
