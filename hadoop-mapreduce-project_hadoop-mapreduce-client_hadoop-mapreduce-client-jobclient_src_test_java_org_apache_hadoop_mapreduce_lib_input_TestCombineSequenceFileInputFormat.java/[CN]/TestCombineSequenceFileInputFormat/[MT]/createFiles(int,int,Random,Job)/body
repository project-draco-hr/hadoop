{
  Range[] ranges=createRanges(length,numFiles,random);
  for (int i=0; i < numFiles; i++) {
    Path file=new Path(workDir,"test_" + i + ".seq");
    @SuppressWarnings("deprecation") SequenceFile.Writer writer=SequenceFile.createWriter(localFs,job.getConfiguration(),file,IntWritable.class,BytesWritable.class);
    Range range=ranges[i];
    try {
      for (int j=range.start; j < range.end; j++) {
        IntWritable key=new IntWritable(j);
        byte[] data=new byte[random.nextInt(10)];
        random.nextBytes(data);
        BytesWritable value=new BytesWritable(data);
        writer.append(key,value);
      }
    }
  finally {
      writer.close();
    }
  }
}
