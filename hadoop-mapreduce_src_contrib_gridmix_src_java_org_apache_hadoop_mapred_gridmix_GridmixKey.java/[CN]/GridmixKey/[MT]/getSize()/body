{
switch (type) {
case REDUCE_SPEC:
    return super.getSize() + spec.getSize() + META_BYTES;
case DATA:
  return super.getSize() + META_BYTES;
default :
throw new IllegalStateException("Invalid type: " + type);
}
}
