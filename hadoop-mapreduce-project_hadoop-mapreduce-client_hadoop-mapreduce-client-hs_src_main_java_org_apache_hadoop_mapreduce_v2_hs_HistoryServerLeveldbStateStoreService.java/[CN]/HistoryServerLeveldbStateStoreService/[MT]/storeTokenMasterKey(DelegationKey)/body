{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Storing master key " + masterKey.getKeyId());
  }
  ByteArrayOutputStream memStream=new ByteArrayOutputStream();
  DataOutputStream dataStream=new DataOutputStream(memStream);
  try {
    masterKey.write(dataStream);
    dataStream.close();
    dataStream=null;
  }
  finally {
    IOUtils.cleanup(LOG,dataStream);
  }
  String dbKey=getTokenMasterKeyDatabaseKey(masterKey);
  try {
    db.put(bytes(dbKey),memStream.toByteArray());
  }
 catch (  DBException e) {
    throw new IOException(e);
  }
}
