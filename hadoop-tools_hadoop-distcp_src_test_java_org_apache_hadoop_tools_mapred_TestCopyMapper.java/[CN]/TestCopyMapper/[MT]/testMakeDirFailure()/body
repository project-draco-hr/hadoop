{
  try {
    deleteState();
    createSourceData();
    FileSystem fs=cluster.getFileSystem();
    CopyMapper copyMapper=new CopyMapper();
    StubContext stubContext=new StubContext(getConfiguration(),null,0);
    Mapper<Text,CopyListingFileStatus,Text,Text>.Context context=stubContext.getContext();
    Configuration configuration=context.getConfiguration();
    String workPath=new Path("webhdfs://localhost:1234/*/*/*/?/").makeQualified(fs.getUri(),fs.getWorkingDirectory()).toString();
    configuration.set(DistCpConstants.CONF_LABEL_TARGET_WORK_PATH,workPath);
    copyMapper.setup(context);
    copyMapper.map(new Text(DistCpUtils.getRelativePath(new Path(SOURCE_PATH),pathList.get(0))),new CopyListingFileStatus(fs.getFileStatus(pathList.get(0))),context);
    Assert.assertTrue("There should have been an exception.",false);
  }
 catch (  Exception ignore) {
  }
}
