{
  try {
    deleteState();
    createSourceData();
    FileSystem fs=cluster.getFileSystem();
    CopyMapper copyMapper=new CopyMapper();
    StubContext stubContext=new StubContext(getConfiguration(),null,0);
    Mapper<Text,FileStatus,Text,Text>.Context context=stubContext.getContext();
    touchFile(SOURCE_PATH + "/src/file");
    mkdirs(TARGET_PATH + "/src/file");
    try {
      copyMapper.setup(context);
      copyMapper.map(new Text("/src/file"),fs.getFileStatus(new Path(SOURCE_PATH + "/src/file")),context);
    }
 catch (    IOException e) {
      Assert.assertTrue(e.getMessage().startsWith("Can't replace"));
    }
  }
 catch (  Exception e) {
    LOG.error("Exception encountered ",e);
    Assert.fail("Test failed: " + e.getMessage());
  }
}
