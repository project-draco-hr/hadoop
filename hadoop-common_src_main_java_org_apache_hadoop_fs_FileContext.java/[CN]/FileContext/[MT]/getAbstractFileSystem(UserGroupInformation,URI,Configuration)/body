{
  try {
    return user.doAs(new PrivilegedExceptionAction<AbstractFileSystem>(){
      public AbstractFileSystem run() throws UnsupportedFileSystemException {
        return AbstractFileSystem.get(uri,conf);
      }
    }
);
  }
 catch (  InterruptedException ex) {
    LOG.error(ex);
    throw new IOException("Failed to get the AbstractFileSystem for path: " + uri,ex);
  }
}
