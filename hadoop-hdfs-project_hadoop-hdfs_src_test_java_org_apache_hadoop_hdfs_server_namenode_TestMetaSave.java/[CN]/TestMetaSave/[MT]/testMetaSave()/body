{
  final FSNamesystem namesystem=cluster.getNamesystem();
  for (int i=0; i < 2; i++) {
    Path file=new Path("/filestatus" + i);
    DFSTestUtil.createFile(fileSys,file,1024,1024,blockSize,(short)2,seed);
  }
  cluster.stopDataNode(1);
  Thread.sleep(15000);
  namesystem.setReplication("/filestatus0",(short)4);
  namesystem.metaSave("metasave.out.txt");
  String logFile=System.getProperty("hadoop.log.dir") + "/" + "metasave.out.txt";
  FileInputStream fstream=new FileInputStream(logFile);
  DataInputStream in=new DataInputStream(fstream);
  BufferedReader reader=new BufferedReader(new InputStreamReader(in));
  String line=reader.readLine();
  assertTrue(line.equals("3 files and directories, 2 blocks = 5 total filesystem objects"));
  line=reader.readLine();
  assertTrue(line.equals("Live Datanodes: 1"));
  line=reader.readLine();
  assertTrue(line.equals("Dead Datanodes: 1"));
  line=reader.readLine();
  line=reader.readLine();
  assertTrue(line.matches("^/filestatus[01]:.*"));
}
