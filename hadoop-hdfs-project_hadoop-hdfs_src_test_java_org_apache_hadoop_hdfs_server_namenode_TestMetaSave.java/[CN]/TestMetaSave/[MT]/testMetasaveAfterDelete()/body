{
  for (int i=0; i < 2; i++) {
    Path file=new Path("/filestatus" + i);
    DFSTestUtil.createFile(fileSys,file,1024,1024,blockSize,(short)2,seed);
  }
  cluster.stopDataNode(1);
  Thread.sleep(15000);
  namesystem.setReplication("/filestatus0",(short)4);
  namesystem.delete("/filestatus0",true);
  namesystem.delete("/filestatus1",true);
  namesystem.metaSave("metasaveAfterDelete.out.txt");
  BufferedReader reader=null;
  try {
    FileInputStream fstream=new FileInputStream(getLogFile("metasaveAfterDelete.out.txt"));
    DataInputStream in=new DataInputStream(fstream);
    reader=new BufferedReader(new InputStreamReader(in));
    reader.readLine();
    String line=reader.readLine();
    assertTrue(line.equals("Live Datanodes: 1"));
    line=reader.readLine();
    assertTrue(line.equals("Dead Datanodes: 1"));
    line=reader.readLine();
    assertTrue(line.equals("Metasave: Blocks waiting for replication: 0"));
    line=reader.readLine();
    assertTrue(line.equals("Mis-replicated blocks that have been postponed:"));
    line=reader.readLine();
    assertTrue(line.equals("Metasave: Blocks being replicated: 0"));
  }
  finally {
    if (reader != null)     reader.close();
  }
}
