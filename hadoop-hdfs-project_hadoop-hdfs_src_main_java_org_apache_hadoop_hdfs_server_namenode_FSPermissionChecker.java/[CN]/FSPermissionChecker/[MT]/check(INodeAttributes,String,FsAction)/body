{
  if (inode == null) {
    return;
  }
  final FsPermission mode=inode.getFsPermission();
  final AclFeature aclFeature=inode.getAclFeature();
  if (aclFeature != null) {
    int firstEntry=aclFeature.getEntryAt(0);
    if (AclEntryStatusFormat.getScope(firstEntry) == AclEntryScope.ACCESS) {
      checkAccessAcl(inode,path,access,mode,aclFeature);
      return;
    }
  }
  if (getUser().equals(inode.getUserName())) {
    if (mode.getUserAction().implies(access)) {
      return;
    }
  }
 else   if (getGroups().contains(inode.getGroupName())) {
    if (mode.getGroupAction().implies(access)) {
      return;
    }
  }
 else {
    if (mode.getOtherAction().implies(access)) {
      return;
    }
  }
  throw new AccessControlException(toAccessControlString(inode,path,access,mode));
}
