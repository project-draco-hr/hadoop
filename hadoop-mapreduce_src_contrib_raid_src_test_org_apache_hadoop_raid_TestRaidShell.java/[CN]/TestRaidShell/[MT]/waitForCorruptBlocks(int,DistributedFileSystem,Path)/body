{
  String path=file.toUri().getPath();
  FileStatus stat=dfs.getFileStatus(file);
  long start=System.currentTimeMillis();
  long actual=0;
  do {
    actual=RaidDFSUtil.corruptBlocksInFile(dfs,path,0,stat.getLen()).size();
    if (actual == numCorruptBlocks)     break;
    if (System.currentTimeMillis() - start > 120000)     break;
    LOG.info("Waiting for " + numCorruptBlocks + " corrupt blocks in "+ path+ ", found "+ actual);
    Thread.sleep(1000);
  }
 while (true);
  assertEquals(numCorruptBlocks,actual);
}
