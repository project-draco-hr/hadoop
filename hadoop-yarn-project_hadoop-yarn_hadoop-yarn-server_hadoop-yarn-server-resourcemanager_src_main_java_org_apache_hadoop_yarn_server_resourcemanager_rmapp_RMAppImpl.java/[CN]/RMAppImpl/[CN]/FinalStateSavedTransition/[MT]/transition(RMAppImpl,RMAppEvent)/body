{
  RMAppUpdateSavedEvent storeEvent=(RMAppUpdateSavedEvent)event;
  if (storeEvent.getUpdatedException() != null) {
    LOG.error("Failed to update the final state of application" + storeEvent.getApplicationId(),storeEvent.getUpdatedException());
    ExitUtil.terminate(1,storeEvent.getUpdatedException());
  }
  if (app.transitionTodo instanceof SingleArcTransition) {
    ((SingleArcTransition)app.transitionTodo).transition(app,app.eventCausingFinalSaving);
  }
 else   if (app.transitionTodo instanceof MultipleArcTransition) {
    ((MultipleArcTransition)app.transitionTodo).transition(app,app.eventCausingFinalSaving);
  }
  return app.targetedFinalState;
}
