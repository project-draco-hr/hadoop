{
  Map<ApplicationTimeoutType,Long> timeouts=app.submissionContext.getApplicationTimeouts();
  if (timeouts != null && timeouts.size() > 0) {
    app.rmContext.getRMAppLifetimeMonitor().unregisterApp(app.getApplicationId(),timeouts.keySet());
  }
  if (app.transitionTodo instanceof SingleArcTransition) {
    ((SingleArcTransition)app.transitionTodo).transition(app,app.eventCausingFinalSaving);
  }
 else   if (app.transitionTodo instanceof MultipleArcTransition) {
    ((MultipleArcTransition)app.transitionTodo).transition(app,app.eventCausingFinalSaving);
  }
  return app.targetedFinalState;
}
