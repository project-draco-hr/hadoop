{
  Set<NodeId> nodes=getNodesOnWhichAttemptRan(app);
  for (  NodeId nodeId : nodes) {
    app.handler.handle(new RMNodeCleanAppEvent(nodeId,app.applicationId));
  }
  if (app.getState() != RMAppState.FINISHING) {
    app.finishTime=System.currentTimeMillis();
  }
  app.removeApplicationState();
  app.handler.handle(new RMAppManagerEvent(app.applicationId,RMAppManagerEventType.APP_COMPLETED));
}
