{
  Set<NodeId> nodes=getNodesOnWhichAttemptRan(app);
  for (  NodeId nodeId : nodes) {
    app.handler.handle(new RMNodeCleanAppEvent(nodeId,app.applicationId));
  }
  app.finishTime=app.storedFinishTime;
  if (app.finishTime == 0) {
    app.finishTime=System.currentTimeMillis();
  }
  app.handler.handle(new AppRemovedSchedulerEvent(app.applicationId,app.getState()));
  app.handler.handle(new RMAppManagerEvent(app.applicationId,RMAppManagerEventType.APP_COMPLETED));
  app.rmContext.getRMApplicationHistoryWriter().applicationFinished(app);
}
