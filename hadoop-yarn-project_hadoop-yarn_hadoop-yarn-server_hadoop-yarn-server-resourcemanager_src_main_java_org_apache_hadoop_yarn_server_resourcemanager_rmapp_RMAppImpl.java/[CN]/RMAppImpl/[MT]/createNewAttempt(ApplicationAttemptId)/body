{
  BlacklistManager currentAMBlacklistManager;
  if (currentAttempt != null) {
    currentAMBlacklistManager=currentAttempt.getAMBlacklistManager();
  }
 else {
    if (amBlacklistingEnabled) {
      currentAMBlacklistManager=new SimpleBlacklistManager(scheduler.getNumClusterNodes(),blacklistDisableThreshold);
    }
 else {
      currentAMBlacklistManager=new DisabledBlacklistManager();
    }
  }
  RMAppAttempt attempt=new RMAppAttemptImpl(appAttemptId,rmContext,scheduler,masterService,submissionContext,conf,maxAppAttempts == (getNumFailedAppAttempts() + 1),amReq,currentAMBlacklistManager);
  attempts.put(appAttemptId,attempt);
  currentAttempt=attempt;
}
