{
  if (report.getDiagnosticMessage() != null && !report.getDiagnosticMessage().isEmpty()) {
    if (report.getLogAggregationStatus() == LogAggregationStatus.RUNNING) {
      List<String> diagnostics=logAggregationDiagnosticsForNMs.get(nodeId);
      if (diagnostics == null) {
        diagnostics=new ArrayList<String>();
        logAggregationDiagnosticsForNMs.put(nodeId,diagnostics);
      }
 else {
        if (diagnostics.size() == maxLogAggregationDiagnosticsInMemory) {
          diagnostics.remove(0);
        }
      }
      diagnostics.add(report.getDiagnosticMessage());
      this.logAggregationStatus.get(nodeId).setDiagnosticMessage(StringUtils.join(diagnostics,"\n"));
    }
 else     if (report.getLogAggregationStatus() == LogAggregationStatus.RUNNING_WITH_FAILURE) {
      List<String> failureMessages=logAggregationFailureMessagesForNMs.get(nodeId);
      if (failureMessages == null) {
        failureMessages=new ArrayList<String>();
        logAggregationFailureMessagesForNMs.put(nodeId,failureMessages);
      }
 else {
        if (failureMessages.size() == maxLogAggregationDiagnosticsInMemory) {
          failureMessages.remove(0);
        }
      }
      failureMessages.add(report.getDiagnosticMessage());
    }
  }
}
