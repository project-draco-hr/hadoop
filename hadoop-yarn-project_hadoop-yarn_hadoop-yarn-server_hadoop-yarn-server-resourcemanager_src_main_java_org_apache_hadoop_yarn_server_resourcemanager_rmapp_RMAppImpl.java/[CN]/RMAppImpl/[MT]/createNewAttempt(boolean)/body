{
  ApplicationAttemptId appAttemptId=Records.newRecord(ApplicationAttemptId.class);
  appAttemptId.setApplicationId(applicationId);
  appAttemptId.setAttemptId(attempts.size() + 1);
  RMAppAttempt attempt=new RMAppAttemptImpl(appAttemptId,rmContext,scheduler,masterService,submissionContext,conf,user);
  attempts.put(appAttemptId,attempt);
  currentAttempt=attempt;
  if (startAttempt) {
    handler.handle(new RMAppAttemptEvent(appAttemptId,RMAppAttemptEventType.START));
  }
}
