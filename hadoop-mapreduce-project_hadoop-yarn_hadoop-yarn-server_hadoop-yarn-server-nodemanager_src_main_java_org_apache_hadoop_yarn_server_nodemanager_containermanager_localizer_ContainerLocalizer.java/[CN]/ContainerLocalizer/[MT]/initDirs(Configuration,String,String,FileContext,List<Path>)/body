{
  if (null == localDirs || 0 == localDirs.size()) {
    throw new IOException("Cannot initialize without local dirs");
  }
  String[] appsFileCacheDirs=new String[localDirs.size()];
  String[] usersFileCacheDirs=new String[localDirs.size()];
  for (int i=0, n=localDirs.size(); i < n; ++i) {
    Path base=lfs.makeQualified(new Path(new Path(localDirs.get(i),USERCACHE),user));
    Path userFileCacheDir=new Path(base,FILECACHE);
    usersFileCacheDirs[i]=userFileCacheDir.toString();
    lfs.mkdir(userFileCacheDir,null,false);
    Path appBase=new Path(base,new Path(APPCACHE,appId));
    Path appFileCacheDir=new Path(appBase,FILECACHE);
    appsFileCacheDirs[i]=appFileCacheDir.toString();
    lfs.mkdir(appFileCacheDir,null,false);
  }
  conf.setStrings(String.format(APPCACHE_CTXT_FMT,appId),appsFileCacheDirs);
  conf.setStrings(String.format(USERCACHE_CTXT_FMT,appId),usersFileCacheDirs);
}
