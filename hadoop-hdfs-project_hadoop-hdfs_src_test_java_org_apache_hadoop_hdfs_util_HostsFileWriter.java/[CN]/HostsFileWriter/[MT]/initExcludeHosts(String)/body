{
  StringBuilder excludeHosts=new StringBuilder();
  if (isLegacyHostsFile) {
    for (    String hostNameAndPort : hostNameAndPorts) {
      excludeHosts.append(hostNameAndPort).append("\n");
    }
    DFSTestUtil.writeFile(localFileSys,excludeFile,excludeHosts.toString());
  }
 else {
    HashSet<DatanodeAdminProperties> allDNs=new HashSet<>();
    for (    String hostNameAndPort : hostNameAndPorts) {
      DatanodeAdminProperties dn=new DatanodeAdminProperties();
      String[] hostAndPort=hostNameAndPort.split(":");
      dn.setHostName(hostAndPort[0]);
      dn.setPort(Integer.parseInt(hostAndPort[1]));
      dn.setAdminState(AdminStates.DECOMMISSIONED);
      allDNs.add(dn);
    }
    CombinedHostsFileWriter.writeFile(combinedFile.toString(),allDNs);
  }
}
