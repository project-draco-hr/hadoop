{
  StringBuilder includeHosts=new StringBuilder();
  if (isLegacyHostsFile) {
    for (    String hostNameAndPort : hostNameAndPorts) {
      includeHosts.append(hostNameAndPort).append("\n");
    }
    DFSTestUtil.writeFile(localFileSys,includeFile,includeHosts.toString());
  }
 else {
    HashSet<DatanodeAdminProperties> allDNs=new HashSet<>();
    for (    String hostNameAndPort : hostNameAndPorts) {
      String[] hostAndPort=hostNameAndPort.split(":");
      DatanodeAdminProperties dn=new DatanodeAdminProperties();
      dn.setHostName(hostAndPort[0]);
      dn.setPort(Integer.parseInt(hostAndPort[1]));
      allDNs.add(dn);
    }
    CombinedHostsFileWriter.writeFile(combinedFile.toString(),allDNs);
  }
}
