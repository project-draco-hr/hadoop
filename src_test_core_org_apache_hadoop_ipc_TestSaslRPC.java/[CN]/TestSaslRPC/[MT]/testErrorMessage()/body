{
  BadTokenSecretManager sm=new BadTokenSecretManager();
  final Server server=RPC.getServer(TestSaslProtocol.class,new TestSaslImpl(),ADDRESS,0,5,true,conf,sm);
  boolean succeeded=false;
  try {
    doDigestRpc(server,sm);
  }
 catch (  RemoteException e) {
    LOG.info("LOGGING MESSAGE: " + e.getLocalizedMessage());
    assertTrue(ERROR_MESSAGE.equals(e.getLocalizedMessage()));
    assertTrue(e.unwrapRemoteException() instanceof InvalidToken);
    succeeded=true;
  }
  assertTrue(succeeded);
}
