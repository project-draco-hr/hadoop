{
  if ("file".equals(getScheme())) {
    return;
  }
  Path dir=new Path(testBaseDir1(),"dir");
  Path link=new Path(testBaseDir1(),"linkToDir");
  fc.mkdir(dir,FileContext.DEFAULT_PERM,false);
  fc.createSymlink(dir,link,false);
  try {
    fc.rename(link,dir);
    fail("Renamed symlink to its target");
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof FileAlreadyExistsException);
  }
  assertTrue(fc.isDirectory(dir));
  assertTrue(fc.exists(link));
  assertTrue(fc.getFileLinkStatus(link).isSymlink());
  assertEquals(dir,fc.getLinkTarget(link));
  try {
    fc.rename(link,dir,Rename.OVERWRITE);
    fail("Renamed symlink to its target");
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof FileAlreadyExistsException);
  }
  assertTrue(fc.isDirectory(dir));
  assertTrue(fc.exists(link));
  assertTrue(fc.getFileLinkStatus(link).isSymlink());
  assertEquals(dir,fc.getLinkTarget(link));
}
