{
  Path link=new Path(testBaseDir1(),"link");
  Path file1=new Path(testBaseDir1(),"file1");
  Path file2=new Path(testBaseDir1(),"file2");
  Path file3=new Path(link,"file3");
  Path dir2=new Path(testBaseDir2());
  fc.createSymlink(dir2,link,false);
  createAndWriteFile(file1);
  fc.rename(file1,file3);
  assertFalse(exists(fc,file1));
  assertTrue(exists(fc,file3));
  fc.rename(file3,file1);
  fc.delete(link,false);
  fc.createSymlink(file2,link,false);
  try {
    fc.rename(file1,file3);
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof FileNotFoundException);
  }
  createAndWriteFile(file2);
  try {
    fc.rename(file1,file3);
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof ParentNotDirectoryException);
  }
}
