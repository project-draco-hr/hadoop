{
  final DFSOutputStream dfsos=dfs.primitiveCreate(getUriPath(f),absolutePermission,createFlag,createParent,replication,blockSize,progress,bufferSize,checksumOpt);
  final byte[] key=dfsos.getKey();
  final byte[] iv=dfsos.getIv();
  Preconditions.checkState(!(key == null ^ iv == null),"Only one of the Key and IV were found.");
  if (false && key != null) {
    final CryptoOutputStream cbos=new CryptoOutputStream(dfsos,factory,key,iv);
    return new HdfsDataOutputStream(cbos,getStatistics());
  }
 else {
    return new HdfsDataOutputStream(dfsos,getStatistics());
  }
}
