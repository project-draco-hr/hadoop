{
  FSImageTransactionalStorageInspector inspector=new FSImageTransactionalStorageInspector();
  storage.inspectStorageDirs(inspector);
  long minImageTxId=getImageTxIdToRetain(inspector);
  purgeCheckpointsOlderThan(inspector,minImageTxId);
  long purgeLogsFrom=Math.max(0,minImageTxId + 1 - numExtraEditsToRetain);
  purgeableLogs.purgeLogsOlderThan(purgeLogsFrom);
}
