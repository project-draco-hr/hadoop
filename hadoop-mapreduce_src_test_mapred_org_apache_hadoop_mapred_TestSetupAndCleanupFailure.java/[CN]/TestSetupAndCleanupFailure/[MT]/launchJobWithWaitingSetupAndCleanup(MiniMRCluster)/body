{
  JobConf jobConf=mr.createJobConf();
  jobConf.setOutputCommitter(CommitterWithLongSetupAndCommit.class);
  RunningJob job=UtilsForTests.runJob(jobConf,inDir,outDir);
  JobTracker jt=mr.getJobTrackerRunner().getJobTracker();
  JobInProgress jip=jt.getJob(job.getID());
  while (!jip.inited()) {
    try {
      Thread.sleep(10);
    }
 catch (    InterruptedException ie) {
    }
  }
  return job;
}
