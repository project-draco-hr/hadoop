{
  long q=0;
  int i=DIV_VALID_BIT - 1;
  for (r<<=1; r < n; r<<=1)   i--;
  for (; i >= 0; ) {
    r-=n;
    q|=(1L << i);
    if (r <= 0)     break;
    for (; r < n; r<<=1)     i--;
  }
  sum+=q;
  return sum < DIV_LIMIT ? sum : sum - DIV_LIMIT;
}
