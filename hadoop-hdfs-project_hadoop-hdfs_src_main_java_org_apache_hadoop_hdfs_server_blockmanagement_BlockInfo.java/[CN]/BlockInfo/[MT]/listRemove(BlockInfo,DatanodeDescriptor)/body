{
  if (head == null)   return null;
  int dnIndex=this.findDatanode(dn);
  if (dnIndex < 0)   return head;
  BlockInfo next=this.getNext(dnIndex);
  BlockInfo prev=this.getPrevious(dnIndex);
  this.setNext(dnIndex,null);
  this.setPrevious(dnIndex,null);
  if (prev != null)   prev.setNext(prev.findDatanode(dn),next);
  if (next != null)   next.setPrevious(next.findDatanode(dn),prev);
  if (this == head)   head=next;
  return head;
}
