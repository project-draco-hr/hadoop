{
  boolean added=true;
  int idx=findDatanode(storage.getDatanodeDescriptor());
  if (idx >= 0) {
    if (getStorageInfo(idx) == storage) {
      return false;
    }
 else {
      removeStorage(storage);
      added=false;
    }
  }
  int lastNode=ensureCapacity(1);
  setStorageInfo(lastNode,storage);
  setNext(lastNode,null);
  setPrevious(lastNode,null);
  return added;
}
