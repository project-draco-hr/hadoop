{
  if (remainingCacheTries > 0) {
    Peer peer=clientContext.getPeerCache().get(datanode,false);
    if (peer != null) {
      if (LOG.isTraceEnabled()) {
        LOG.trace("nextTcpPeer: reusing existing peer " + peer);
      }
      return new BlockReaderPeer(peer,true);
    }
  }
  try {
    Peer peer=remotePeerFactory.newConnectedPeer(inetSocketAddress,token,datanode);
    if (LOG.isTraceEnabled()) {
      LOG.trace("nextTcpPeer: created newConnectedPeer " + peer);
    }
    return new BlockReaderPeer(peer,false);
  }
 catch (  IOException e) {
    if (LOG.isTraceEnabled()) {
      LOG.trace("nextTcpPeer: failed to create newConnectedPeer " + "connected to " + datanode);
    }
    throw e;
  }
}
