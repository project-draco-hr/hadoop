{
  peer.setReadTimeout(conf.getInt(DFSConfigKeys.DFS_CLIENT_SOCKET_TIMEOUT_KEY,HdfsServerConstants.READ_TIMEOUT));
  peer.setWriteTimeout(HdfsServerConstants.WRITE_TIMEOUT);
  if (conf.getBoolean(DFSConfigKeys.DFS_CLIENT_USE_LEGACY_BLOCKREADER,DFSConfigKeys.DFS_CLIENT_USE_LEGACY_BLOCKREADER_DEFAULT)) {
    return RemoteBlockReader.newBlockReader(file,block,blockToken,startOffset,len,conf.getInt(DFSConfigKeys.IO_FILE_BUFFER_SIZE_KEY,DFSConfigKeys.IO_FILE_BUFFER_SIZE_DEFAULT),verifyChecksum,clientName,peer,datanodeID);
  }
 else {
    return RemoteBlockReader2.newBlockReader(file,block,blockToken,startOffset,len,verifyChecksum,clientName,peer,datanodeID);
  }
}
