{
  final long MAX_PAGE_BLOB_SIZE=1024L * 1024L * 1024L* 1024L;
  if (currentBlobSize == MAX_PAGE_BLOB_SIZE) {
    return;
  }
  if (currentBlobSize - currentBlobOffset <= MAX_RAW_BYTES_PER_REQUEST) {
    CloudPageBlob cloudPageBlob=(CloudPageBlob)blob.getBlob();
    long newSize=currentBlobSize + configuredPageBlobExtensionSize;
    if (newSize > MAX_PAGE_BLOB_SIZE) {
      newSize=MAX_PAGE_BLOB_SIZE;
    }
    final int MAX_RETRIES=3;
    int retries=1;
    boolean resizeDone=false;
    while (!resizeDone && retries <= MAX_RETRIES) {
      try {
        cloudPageBlob.resize(newSize);
        resizeDone=true;
        currentBlobSize=newSize;
      }
 catch (      StorageException e) {
        LOG.warn("Failed to extend size of " + cloudPageBlob.getUri());
        try {
          Thread.sleep(2000 * retries * retries);
        }
 catch (        InterruptedException e1) {
          Thread.currentThread().interrupt();
        }
      }
 finally {
        retries++;
      }
    }
  }
}
