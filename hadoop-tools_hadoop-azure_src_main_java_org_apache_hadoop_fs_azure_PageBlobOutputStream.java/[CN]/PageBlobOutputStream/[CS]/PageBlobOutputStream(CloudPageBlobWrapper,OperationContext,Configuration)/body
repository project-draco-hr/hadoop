{
  this.blob=blob;
  this.outBuffer=new ByteArrayOutputStream();
  this.opContext=opContext;
  this.lastQueuedTask=null;
  this.ioQueue=new LinkedBlockingQueue<Runnable>();
  this.ioThreadPool=new ThreadPoolExecutor(1,1,2,TimeUnit.SECONDS,ioQueue);
  long pageBlobConfigSize=conf.getLong("fs.azure.page.blob.size",0);
  LOG.debug("Read value of fs.azure.page.blob.size as " + pageBlobConfigSize + " from configuration (0 if not present).");
  long pageBlobSize=Math.max(PAGE_BLOB_MIN_SIZE,pageBlobConfigSize);
  if (pageBlobSize % PAGE_SIZE != 0) {
    pageBlobSize+=PAGE_SIZE - pageBlobSize % PAGE_SIZE;
  }
  blob.create(pageBlobSize,new BlobRequestOptions(),opContext);
  currentBlobSize=pageBlobSize;
  configuredPageBlobExtensionSize=conf.getLong("fs.azure.page.blob.extension.size",0);
  if (configuredPageBlobExtensionSize < PAGE_BLOB_DEFAULT_EXTENSION_SIZE) {
    configuredPageBlobExtensionSize=PAGE_BLOB_DEFAULT_EXTENSION_SIZE;
  }
  if (configuredPageBlobExtensionSize % PAGE_SIZE != 0) {
    configuredPageBlobExtensionSize+=PAGE_SIZE - configuredPageBlobExtensionSize % PAGE_SIZE;
  }
}
