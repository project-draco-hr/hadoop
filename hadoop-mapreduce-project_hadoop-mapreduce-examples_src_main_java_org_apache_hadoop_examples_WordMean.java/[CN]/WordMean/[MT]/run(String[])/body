{
  if (args.length != 2) {
    System.err.println("Usage: wordmean <in> <out>");
    return 0;
  }
  Configuration conf=getConf();
  Job job=Job.getInstance(conf,"word mean");
  job.setJarByClass(WordMean.class);
  job.setMapperClass(WordMeanMapper.class);
  job.setCombinerClass(WordMeanReducer.class);
  job.setReducerClass(WordMeanReducer.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(LongWritable.class);
  FileInputFormat.addInputPath(job,new Path(args[0]));
  Path outputpath=new Path(args[1]);
  FileOutputFormat.setOutputPath(job,outputpath);
  boolean result=job.waitForCompletion(true);
  mean=readAndCalcMean(outputpath,conf);
  return (result ? 0 : 1);
}
