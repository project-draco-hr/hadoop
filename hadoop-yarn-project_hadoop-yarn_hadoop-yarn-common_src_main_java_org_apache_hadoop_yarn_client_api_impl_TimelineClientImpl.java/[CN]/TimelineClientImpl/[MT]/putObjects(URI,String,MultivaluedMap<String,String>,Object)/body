{
  ClientResponse resp;
  try {
    resp=client.resource(base).path(path).queryParams(params).accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON).put(ClientResponse.class,obj);
  }
 catch (  RuntimeException re) {
    String msg="Failed to get the response from the timeline server.";
    LOG.error(msg,re);
    throw new IOException(re);
  }
  if (resp == null || resp.getClientResponseStatus() != ClientResponse.Status.OK) {
    String msg="Response from the timeline server is " + ((resp == null) ? "null" : "not successful," + " HTTP error code: " + resp.getStatus() + ", Server response:\n"+ resp.getEntity(String.class));
    LOG.error(msg);
    throw new YarnException(msg);
  }
}
