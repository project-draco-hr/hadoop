{
  final String httpAddress=getHttpAddressForToken(token,conf);
  LOG.info("address to renew=" + httpAddress + "; tok="+ token.getService());
  Long expDate=(Long)UserGroupInformation.getLoginUser().doAs(new PrivilegedExceptionAction<Long>(){
    public Long run() throws IOException {
      return DelegationTokenFetcher.renewDelegationToken(httpAddress,token);
    }
  }
);
  LOG.info("Renew over HTTP done. addr=" + httpAddress + ";res="+ expDate);
  return expDate;
}
