{
  getMockServer().setDispatcher(testData.getDispatcher());
  FSDataInputStream in=getMockAdlFileSystem().open(new Path("/test"));
  ByteArrayInputStream actualData=new ByteArrayInputStream(testData.getActualData());
  Random random=new Random();
  for (int i=0; i < testData.getIntensityOfTest(); ++i) {
    int offset=random.nextInt(testData.getActualData().length);
    int length=testData.getActualData().length - offset;
    byte[] expectedData=new byte[length];
    byte[] actualDataSubset=new byte[length];
    actualData.reset();
    actualData.skip(offset);
    actualData.read(actualDataSubset,0,length);
    in.readFully(offset,expectedData,0,length);
    Assert.assertArrayEquals(expectedData,actualDataSubset);
  }
  for (int i=0; i < testData.getIntensityOfTest(); ++i) {
    int offset=random.nextInt(testData.getActualData().length);
    int length=random.nextInt(testData.getActualData().length - offset);
    byte[] expectedData=new byte[length];
    byte[] actualDataSubset=new byte[length];
    actualData.reset();
    actualData.skip(offset);
    actualData.read(actualDataSubset,0,length);
    in.readFully(offset,expectedData,0,length);
    Assert.assertArrayEquals(expectedData,actualDataSubset);
  }
  in.close();
  if (testData.isCheckOfNoOfCalls()) {
    Assert.assertEquals(testData.getExpectedNoNetworkCall(),getMockServer().getRequestCount());
  }
}
