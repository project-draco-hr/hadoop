{
  final Configuration conf=new Configuration();
  final File file=tempDir.newFile("test.jks");
  final URI jks=ProviderUtils.nestURIForLocalJavaKeyStoreProvider(file.toURI());
  conf.set(CredentialProviderFactory.CREDENTIAL_PROVIDER_PATH,jks.toString());
  final CredentialProvider provider=CredentialProviderFactory.getProviders(conf).get(0);
  provider.createCredentialEntry("fs.s3.awsSecretAccessKey",EXAMPLE_KEY.toCharArray());
  provider.flush();
  S3Credentials s3Credentials=new S3Credentials();
  conf.set("fs.s3.awsAccessKeyId",EXAMPLE_ID);
  s3Credentials.initialize(new URI("s3://foobar"),conf);
  assertEquals("Could not retrieve proper access key",EXAMPLE_ID,s3Credentials.getAccessKey());
  assertEquals("Could not retrieve proper secret",EXAMPLE_KEY,s3Credentials.getSecretAccessKey());
}
