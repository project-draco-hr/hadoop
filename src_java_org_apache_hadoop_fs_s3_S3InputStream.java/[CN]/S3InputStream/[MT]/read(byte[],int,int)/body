{
  if (closed) {
    throw new IOException("Stream closed");
  }
  if (pos < fileLength) {
    if (pos > blockEnd) {
      blockSeekTo(pos);
    }
    int realLen=(int)Math.min((long)len,(blockEnd - pos + 1L));
    int result=blockStream.read(buf,off,realLen);
    if (result >= 0) {
      pos+=result;
    }
    if (stats != null && result > 0) {
      stats.incrementBytesRead(result);
    }
    return result;
  }
  return -1;
}
