{
  File[] retVal=new File[parents.length];
  Path bpCurDir=new Path(MiniDFSCluster.getBPDir(datanodeStorage,bpid,Storage.STORAGE_DIR_CURRENT));
  for (int i=0; i < parents.length; i++) {
    File newDir=new File(parents[i] + "/current/" + bpid,dirName);
    createEmptyDirs(new String[]{newDir.toString()});
    LocalFileSystem localFS=FileSystem.getLocal(new HdfsConfiguration());
    localFS.copyToLocalFile(bpCurDir,new Path(newDir.toString()),false);
    retVal[i]=newDir;
  }
  return retVal;
}
