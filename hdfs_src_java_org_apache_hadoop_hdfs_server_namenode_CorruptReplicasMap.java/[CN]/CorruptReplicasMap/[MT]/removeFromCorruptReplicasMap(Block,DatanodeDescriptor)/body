{
  Collection<DatanodeDescriptor> datanodes=corruptReplicasMap.get(blk);
  if (datanodes == null)   return false;
  if (datanodes.remove(datanode)) {
    if (datanodes.isEmpty()) {
      corruptReplicasMap.remove(blk);
    }
    return true;
  }
  return false;
}
