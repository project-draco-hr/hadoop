{
  NetworkTopology invalCluster=new NetworkTopology();
  DatanodeDescriptor invalDataNodes[]=new DatanodeDescriptor[]{new DatanodeDescriptor(new DatanodeID("1.1.1.1",5020),"/d1/r1"),new DatanodeDescriptor(new DatanodeID("2.2.2.2",5020),"/d1/r1"),new DatanodeDescriptor(new DatanodeID("3.3.3.3",5020),"/d1")};
  invalCluster.add(invalDataNodes[0]);
  invalCluster.add(invalDataNodes[1]);
  try {
    invalCluster.add(invalDataNodes[2]);
    fail("expected InvalidTopologyException");
  }
 catch (  NetworkTopology.InvalidTopologyException e) {
    assertEquals(e.getMessage(),"Invalid network topology. " + "You cannot have a rack and a non-rack node at the same " + "level of the network topology.");
  }
}
