{
  Configuration conf=new Configuration();
  configureDummyDistCacheFiles(conf);
  File ws=new File("target" + File.separator + this.getClass().getName());
  Path ioPath=new Path(ws.getAbsolutePath());
  DistributedCacheEmulator dce=new DistributedCacheEmulator(conf,ioPath);
  JobConf jobConf=new JobConf(conf);
  jobConf.setUser(UserGroupInformation.getCurrentUser().getShortUserName());
  File fin=new File("src" + File.separator + "test"+ File.separator+ "resources"+ File.separator+ "data"+ File.separator+ "wordcount.json");
  dce.init(fin.getAbsolutePath(),JobCreator.LOADJOB,true);
  dce.configureDistCacheFiles(conf,jobConf);
  String[] caches=conf.getStrings(MRJobConfig.CACHE_FILES);
  String[] tmpfiles=conf.getStrings("tmpfiles");
  assertEquals(6,((caches == null ? 0 : caches.length) + (tmpfiles == null ? 0 : tmpfiles.length)));
}
