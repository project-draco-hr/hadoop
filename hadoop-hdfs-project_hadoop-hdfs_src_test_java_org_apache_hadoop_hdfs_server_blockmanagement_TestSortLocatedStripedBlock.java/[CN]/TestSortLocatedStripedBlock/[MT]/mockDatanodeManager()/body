{
  Configuration conf=new Configuration();
  conf.setBoolean(DFSConfigKeys.DFS_NAMENODE_AVOID_STALE_DATANODE_FOR_READ_KEY,true);
  conf.setLong(DFSConfigKeys.DFS_NAMENODE_STALE_DATANODE_INTERVAL_KEY,STALE_INTERVAL);
  FSNamesystem fsn=Mockito.mock(FSNamesystem.class);
  BlockManager bm=Mockito.mock(BlockManager.class);
  BlockReportLeaseManager blm=new BlockReportLeaseManager(conf);
  Mockito.when(bm.getBlockReportLeaseManager()).thenReturn(blm);
  DatanodeManager dm=new DatanodeManager(bm,fsn,conf);
  return dm;
}
