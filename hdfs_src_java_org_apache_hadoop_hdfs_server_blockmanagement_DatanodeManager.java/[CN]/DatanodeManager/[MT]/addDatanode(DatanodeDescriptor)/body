{
synchronized (namesystem.datanodeMap) {
    host2DatanodeMap.remove(namesystem.datanodeMap.put(node.getStorageID(),node));
  }
  host2DatanodeMap.add(node);
  networktopology.add(node);
  if (LOG.isDebugEnabled()) {
    LOG.debug(getClass().getSimpleName() + ".addDatanode: " + "node "+ node.getName()+ " is added to datanodeMap.");
  }
}
