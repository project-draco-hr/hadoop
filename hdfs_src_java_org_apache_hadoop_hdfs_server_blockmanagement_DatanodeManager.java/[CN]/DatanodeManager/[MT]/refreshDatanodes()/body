{
  for (  DatanodeDescriptor node : namesystem.datanodeMap.values()) {
    if (!inHostsList(node,null)) {
      node.setDisallowed(true);
    }
 else {
      if (inExcludedHostsList(node,null)) {
        namesystem.getBlockManager().startDecommission(node);
      }
 else {
        namesystem.getBlockManager().stopDecommission(node);
      }
    }
  }
}
