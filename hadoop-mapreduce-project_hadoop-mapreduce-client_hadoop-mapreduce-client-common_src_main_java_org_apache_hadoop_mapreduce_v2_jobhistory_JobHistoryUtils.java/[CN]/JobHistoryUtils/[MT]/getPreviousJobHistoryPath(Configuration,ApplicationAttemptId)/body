{
  String jobId=TypeConverter.fromYarn(applicationAttemptId.getApplicationId()).toString();
  String jobhistoryDir=JobHistoryUtils.getConfiguredHistoryStagingDirPrefix(conf,jobId);
  Path histDirPath=FileContext.getFileContext(conf).makeQualified(new Path(jobhistoryDir));
  FileContext fc=FileContext.getFileContext(histDirPath.toUri(),conf);
  return fc.makeQualified(JobHistoryUtils.getStagingJobHistoryFile(histDirPath,jobId,(applicationAttemptId.getAttemptId() - 1)));
}
