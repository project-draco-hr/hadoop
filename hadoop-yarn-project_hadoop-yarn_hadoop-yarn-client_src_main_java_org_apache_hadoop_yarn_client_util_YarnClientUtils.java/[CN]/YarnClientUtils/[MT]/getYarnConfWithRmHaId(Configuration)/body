{
  YarnConfiguration yarnConf=new YarnConfiguration(conf);
  if (yarnConf.get(YarnConfiguration.RM_HA_ID) == null) {
    String[] rmIds=yarnConf.getStrings(YarnConfiguration.RM_HA_IDS);
    if ((rmIds != null) && (rmIds.length > 0)) {
      yarnConf.set(YarnConfiguration.RM_HA_ID,rmIds[0]);
    }
 else {
      throw new IOException("RM_HA_IDS property is not set for HA resource " + "manager");
    }
  }
  return yarnConf;
}
