{
  boolean commaSeperated=false;
  for (int i=0; i < 1 || matcher.end() < modeStr.length(); i++) {
    if (i > 0 && (!commaSeperated || !matcher.find())) {
      throw new IllegalArgumentException(modeStr);
    }
    String str=matcher.group(2);
    char type=str.charAt(str.length() - 1);
    boolean user, group, others, stickyBit;
    user=group=others=stickyBit=false;
    for (    char c : matcher.group(1).toCharArray()) {
switch (c) {
case 'u':
        user=true;
      break;
case 'g':
    group=true;
  break;
case 'o':
others=true;
break;
case 'a':
break;
default :
throw new RuntimeException("Unexpected");
}
}
if (!(user || group || others)) {
user=group=others=true;
}
short mode=0;
for (char c : matcher.group(3).toCharArray()) {
switch (c) {
case 'r':
mode|=4;
break;
case 'w':
mode|=2;
break;
case 'x':
mode|=1;
break;
case 'X':
mode|=8;
break;
case 't':
stickyBit=true;
break;
default :
throw new RuntimeException("Unexpected");
}
}
if (user) {
userMode=mode;
userType=type;
}
if (group) {
groupMode=mode;
groupType=type;
}
if (others) {
othersMode=mode;
othersType=type;
stickyMode=(short)(stickyBit ? 1 : 0);
stickyBitType=type;
}
commaSeperated=matcher.group(4).contains(",");
}
}
