{
  LOG.info("nNameNodes=" + nNameNodes + ", nDataNodes="+ nDataNodes);
  conf.setBoolean(DFSConfigKeys.DFS_WEBHDFS_ENABLED_KEY,true);
  cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleFederatedTopology(nNameNodes)).numDataNodes(nDataNodes).build();
  cluster.waitActive();
  webhdfs=new WebHdfsFileSystem[nNameNodes];
  for (int i=0; i < webhdfs.length; i++) {
    final InetSocketAddress addr=cluster.getNameNode(i).getHttpAddress();
    final String uri=WebHdfsFileSystem.SCHEME + "://" + addr.getHostName()+ ":"+ addr.getPort()+ "/";
    webhdfs[i]=(WebHdfsFileSystem)FileSystem.get(new URI(uri),conf);
  }
}
