{
  TaskAttemptID[] taskAttemptID=new TaskAttemptID[1500];
  JobConf conf=new JobConf();
  conf.setSpeculativeExecution(true);
  conf.setNumMapTasks(totalTasks);
  conf.setNumReduceTasks(0);
  jobTracker.setNumSlots(slots);
  FakeJobInProgress job=new FakeJobInProgress(conf,jobTracker);
  job.initTasks();
  int i;
  for (i=0; i < totalTasks; i++) {
    taskAttemptID[i]=job.findMapTask(trackers[0]);
  }
  clock.advance(5000);
  for (i=0; i < numEarlyComplete; i++) {
    job.finishTask(taskAttemptID[i]);
  }
  clock.advanceBySpeculativeLag();
  for (i=numEarlyComplete; i < totalTasks; i++) {
    job.progressMade(taskAttemptID[i],0.85f);
  }
  clock.advance(50000);
  for (i=0; i < (totalTasks - numEarlyComplete); i++) {
    taskAttemptID[i]=job.findMapTask(trackers[1]);
    clock.advance(2000);
    if (taskAttemptID[i] != null) {
      job.progressMade(taskAttemptID[i],0.99f);
    }
 else {
      break;
    }
  }
  return i;
}
