{
  TaskAttemptID[] taskAttemptID=new TaskAttemptID[20];
  JobConf conf=new JobConf();
  conf.setSpeculativeExecution(true);
  conf.setNumMapTasks(5);
  conf.setNumReduceTasks(0);
  conf.setFloat(JobContext.SPECULATIVE_SLOWTASK_THRESHOLD,0.5f);
  FakeJobInProgress job=new FakeJobInProgress(conf,jobTracker);
  job.initTasks();
  taskAttemptID[0]=job.findMapTask(trackers[0]);
  taskAttemptID[1]=job.findMapTask(trackers[1]);
  taskAttemptID[2]=job.findMapTask(trackers[2]);
  taskAttemptID[3]=job.findMapTask(trackers[3]);
  clock.advance(2000);
  job.finishTask(taskAttemptID[0]);
  job.finishTask(taskAttemptID[1]);
  job.finishTask(taskAttemptID[2]);
  clock.advance(250000);
  taskAttemptID[4]=job.findMapTask(trackers[3]);
  clock.advanceBySpeculativeLag();
  job.progressMade(taskAttemptID[3],0.85f);
  job.progressMade(taskAttemptID[4],0.20f);
  taskAttemptID[5]=job.findMapTask(trackers[4]);
  assertEquals(taskAttemptID[5].getTaskID().getId(),4);
  assertEquals("Total speculative maps",2,fakeInst.numSpeculativeMaps);
  assertEquals("Total speculative reduces",3,fakeInst.numSpeculativeReduces);
  LOG.info("Total speculative maps = " + fakeInst.numSpeculativeMaps);
  LOG.info("Total speculative reduces = " + fakeInst.numSpeculativeReduces);
}
