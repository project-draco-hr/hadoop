{
  FileSplit fileSplit=(FileSplit)split;
  FileSystem fs=FileSystem.get(fileSplit.getPath().toUri(),job);
  FSDataInputStream is=fs.open(fileSplit.getPath());
  byte[] header=new byte[3];
  RecordReader reader=null;
  try {
    is.readFully(header);
  }
 catch (  EOFException eof) {
    reader=textInputFormat.getRecordReader(split,job,reporter);
  }
 finally {
    is.close();
  }
  if (header[0] == 'S' && header[1] == 'E' && header[2] == 'Q') {
    reader=seqFileInputFormat.getRecordReader(split,job,reporter);
  }
 else {
    reader=textInputFormat.getRecordReader(split,job,reporter);
  }
  return reader;
}
