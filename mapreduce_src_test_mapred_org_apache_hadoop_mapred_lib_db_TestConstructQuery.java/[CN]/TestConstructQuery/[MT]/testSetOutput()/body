{
  JobConf job=new JobConf();
  DBOutputFormat.setOutput(job,"hadoop_output",fieldNames);
  DBConfiguration dbConf=new DBConfiguration(job);
  String actual=format.constructQuery(dbConf.getOutputTableName(),dbConf.getOutputFieldNames());
  assertEquals(expected,actual);
  job=new JobConf();
  dbConf=new DBConfiguration(job);
  DBOutputFormat.setOutput(job,"hadoop_output",nullFieldNames.length);
  assertNull(dbConf.getOutputFieldNames());
  assertEquals(nullFieldNames.length,dbConf.getOutputFieldCount());
  actual=format.constructQuery(dbConf.getOutputTableName(),new String[dbConf.getOutputFieldCount()]);
  assertEquals(nullExpected,actual);
}
