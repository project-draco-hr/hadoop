{
  cluster.shutdown();
  if (StartupOption.ROLLBACK == o)   NameNode.doRollback(conf,false);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(DATANODE_NUM).format(false).nameNodePort(ServerSocketUtil.getPort(HdfsClientConfigKeys.DFS_NAMENODE_RPC_PORT_DEFAULT,10)).startupOption(o == StartupOption.ROLLBACK ? StartupOption.REGULAR : o).dnStartupOption(o != StartupOption.ROLLBACK ? StartupOption.REGULAR : o).build();
  fs=cluster.getFileSystem();
}
