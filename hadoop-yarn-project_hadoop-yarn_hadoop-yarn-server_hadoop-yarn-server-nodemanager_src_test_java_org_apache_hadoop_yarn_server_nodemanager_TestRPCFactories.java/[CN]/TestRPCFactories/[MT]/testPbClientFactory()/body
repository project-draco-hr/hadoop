{
  InetSocketAddress addr=new InetSocketAddress(0);
  System.err.println(addr.getHostName() + addr.getPort());
  Configuration conf=new Configuration();
  LocalizationProtocol instance=new LocalizationProtocolTestImpl();
  Server server=null;
  try {
    server=RpcServerFactoryPBImpl.get().getServer(LocalizationProtocol.class,instance,addr,conf,null,1);
    server.start();
    System.err.println(server.getListenerAddress());
    System.err.println(NetUtils.getConnectAddress(server));
    try {
      LocalizationProtocol client=(LocalizationProtocol)RpcClientFactoryPBImpl.get().getClient(LocalizationProtocol.class,1,NetUtils.getConnectAddress(server),conf);
      Assert.assertNotNull(client);
    }
 catch (    YarnException e) {
      e.printStackTrace();
      Assert.fail("Failed to create client");
    }
  }
 catch (  YarnException e) {
    e.printStackTrace();
    Assert.fail("Failed to create server");
  }
 finally {
    server.stop();
  }
}
