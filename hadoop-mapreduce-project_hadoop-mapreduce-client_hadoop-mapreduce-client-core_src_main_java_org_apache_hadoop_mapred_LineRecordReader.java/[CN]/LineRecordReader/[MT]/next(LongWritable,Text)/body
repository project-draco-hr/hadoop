{
  while (getFilePosition() <= end || in.needAdditionalRecordAfterSplit()) {
    key.set(pos);
    int newSize=in.readLine(value,maxLineLength,Math.max(maxBytesToConsume(pos),maxLineLength));
    if (newSize == 0) {
      return false;
    }
    pos+=newSize;
    if (newSize < maxLineLength) {
      return true;
    }
    LOG.info("Skipped line of size " + newSize + " at pos "+ (pos - newSize));
  }
  return false;
}
