{
  while (getFilePosition() <= end || in.needAdditionalRecordAfterSplit()) {
    key.set(pos);
    int newSize=0;
    if (pos == 0) {
      newSize=skipUtfByteOrderMark(value);
    }
 else {
      newSize=in.readLine(value,maxLineLength,maxBytesToConsume(pos));
      pos+=newSize;
    }
    if (newSize == 0) {
      return false;
    }
    if (newSize < maxLineLength) {
      return true;
    }
    LOG.info("Skipped line of size " + newSize + " at pos "+ (pos - newSize));
  }
  return false;
}
