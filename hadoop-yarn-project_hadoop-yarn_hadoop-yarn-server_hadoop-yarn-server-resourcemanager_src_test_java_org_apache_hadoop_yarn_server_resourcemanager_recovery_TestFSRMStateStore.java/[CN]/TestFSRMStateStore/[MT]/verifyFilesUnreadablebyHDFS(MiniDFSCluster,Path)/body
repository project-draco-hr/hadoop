{
  DistributedFileSystem fs=cluster.getFileSystem();
  Queue<Path> paths=new LinkedList<>();
  paths.add(root);
  while (!paths.isEmpty()) {
    Path p=paths.poll();
    FileStatus stat=fs.getFileStatus(p);
    if (!stat.isDirectory()) {
      try {
        LOG.warn("\n\n ##Testing path [" + p + "]\n\n");
        fs.open(p);
        Assert.fail("Super user should not be able to read [" + UserGroupInformation.getCurrentUser() + "] ["+ p.getName()+ "]");
      }
 catch (      AccessControlException e) {
        Assert.assertTrue(e.getMessage().contains("superuser is not allowed to perform this operation"));
      }
catch (      Exception e) {
        Assert.fail("Should get an AccessControlException here");
      }
    }
    if (stat.isDirectory()) {
      FileStatus[] ls=fs.listStatus(p);
      for (      FileStatus f : ls) {
        paths.add(f.getPath());
      }
    }
  }
}
