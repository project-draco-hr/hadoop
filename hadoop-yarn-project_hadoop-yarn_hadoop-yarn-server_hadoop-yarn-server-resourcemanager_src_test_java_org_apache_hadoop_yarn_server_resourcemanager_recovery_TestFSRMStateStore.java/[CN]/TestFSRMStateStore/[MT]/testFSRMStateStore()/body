{
  HdfsConfiguration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
  try {
    TestFSRMStateStoreTester fsTester=new TestFSRMStateStoreTester(cluster);
    FSDataOutputStream fsOut=null;
    FileSystemRMStateStore fileSystemRMStateStore=(FileSystemRMStateStore)fsTester.getRMStateStore();
    String appAttemptIdStr3="appattempt_1352994193343_0001_000003";
    ApplicationAttemptId attemptId3=ConverterUtils.toApplicationAttemptId(appAttemptIdStr3);
    Path rootDir=new Path(fileSystemRMStateStore.fsWorkingPath,"FSRMStateRoot");
    Path appRootDir=new Path(rootDir,"RMAppRoot");
    Path appDir=new Path(appRootDir,attemptId3.getApplicationId().toString());
    Path tempAppAttemptFile=new Path(appDir,attemptId3.toString() + ".tmp");
    fsOut=fileSystemRMStateStore.fs.create(tempAppAttemptFile,false);
    fsOut.write("Some random data ".getBytes());
    fsOut.close();
    testRMAppStateStore(fsTester);
    Assert.assertFalse(fileSystemRMStateStore.fsWorkingPath.getFileSystem(conf).exists(tempAppAttemptFile));
    testRMDTSecretManagerStateStore(fsTester);
    testCheckVersion(fsTester);
  }
  finally {
    cluster.shutdown();
  }
}
