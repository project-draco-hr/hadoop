{
  ClientProtocol client;
  String tracker=conf.get("mapreduce.jobtracker.address","local");
  if ("local".equals(tracker)) {
    conf.setInt("mapreduce.job.maps",1);
    client=new LocalJobRunner(conf);
  }
 else {
    client=createRPCProxy(JobTracker.getAddress(conf),conf);
  }
  return client;
}
