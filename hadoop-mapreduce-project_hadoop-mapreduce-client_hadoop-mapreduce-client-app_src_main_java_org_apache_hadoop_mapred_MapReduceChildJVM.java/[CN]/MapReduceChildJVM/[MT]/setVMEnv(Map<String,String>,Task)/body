{
  JobConf conf=task.conf;
  String mapredChildEnv=getChildEnv(conf,task.isMapTask());
  MRApps.setEnvFromInputString(environment,mapredChildEnv,conf);
  environment.put("HADOOP_ROOT_LOGGER",getChildLogLevel(conf,task.isMapTask()) + ",CLA");
  String hadoopClientOpts=System.getenv("HADOOP_CLIENT_OPTS");
  if (hadoopClientOpts == null) {
    hadoopClientOpts="";
  }
 else {
    hadoopClientOpts=hadoopClientOpts + " ";
  }
  long logSize=TaskLog.getTaskLogLength(conf);
  Vector<String> logProps=new Vector<String>(4);
  setupLog4jProperties(task,logProps,logSize);
  Iterator<String> it=logProps.iterator();
  StringBuffer buffer=new StringBuffer();
  while (it.hasNext()) {
    buffer.append(" " + it.next());
  }
  hadoopClientOpts=hadoopClientOpts + buffer.toString();
  environment.put("HADOOP_CLIENT_OPTS",hadoopClientOpts);
  environment.put(MRJobConfig.STDOUT_LOGFILE_ENV,getTaskLogFile(TaskLog.LogName.STDOUT));
  environment.put(MRJobConfig.STDERR_LOGFILE_ENV,getTaskLogFile(TaskLog.LogName.STDERR));
}
