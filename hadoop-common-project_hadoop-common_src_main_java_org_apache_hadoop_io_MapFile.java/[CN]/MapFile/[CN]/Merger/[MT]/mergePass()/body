{
  WritableComparable[] keys=new WritableComparable[inReaders.length];
  Writable[] values=new Writable[inReaders.length];
  for (int i=0; i < inReaders.length; i++) {
    keys[i]=ReflectionUtils.newInstance(keyClass,null);
    values[i]=ReflectionUtils.newInstance(valueClass,null);
    if (!inReaders[i].next(keys[i],values[i])) {
      keys[i]=null;
      values[i]=null;
    }
  }
  do {
    int currentEntry=-1;
    WritableComparable currentKey=null;
    Writable currentValue=null;
    for (int i=0; i < keys.length; i++) {
      if (keys[i] == null) {
        continue;
      }
      if (currentKey == null || comparator.compare(currentKey,keys[i]) > 0) {
        currentEntry=i;
        currentKey=keys[i];
        currentValue=values[i];
      }
    }
    if (currentKey == null) {
      break;
    }
    outWriter.append(currentKey,currentValue);
    if (!inReaders[currentEntry].next(keys[currentEntry],values[currentEntry])) {
      keys[currentEntry]=null;
      values[currentEntry]=null;
    }
  }
 while (true);
}
