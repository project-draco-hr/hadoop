{
  String parent=n.getNetworkLocation();
  String currentPath=getPath(this);
  if (!isAncestor(n))   throw new IllegalArgumentException(n.getName() + ", which is located at " + parent+ ", is not a descendent of "+ currentPath);
  if (isParent(n)) {
    if (childrenMap.containsKey(n.getName())) {
      for (int i=0; i < children.size(); i++) {
        if (children.get(i).getName().equals(n.getName())) {
          children.remove(i);
          childrenMap.remove(n.getName());
          numOfLeaves--;
          n.setParent(null);
          return true;
        }
      }
    }
    return false;
  }
 else {
    String parentName=getNextAncestorName(n);
    InnerNode parentNode=null;
    int i;
    for (i=0; i < children.size(); i++) {
      if (children.get(i).getName().equals(parentName)) {
        parentNode=(InnerNode)children.get(i);
        break;
      }
    }
    if (parentNode == null) {
      return false;
    }
    boolean isRemoved=parentNode.remove(n);
    if (isRemoved) {
      if (parentNode.getNumOfChildren() == 0) {
        Node prev=children.remove(i);
        childrenMap.remove(prev.getName());
      }
      numOfLeaves--;
    }
    return isRemoved;
  }
}
