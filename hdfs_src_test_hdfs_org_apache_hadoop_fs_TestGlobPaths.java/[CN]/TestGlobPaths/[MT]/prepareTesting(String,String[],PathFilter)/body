{
  for (int i=0; i < Math.min(NUM_OF_PATHS,files.length); i++) {
    path[i]=fs.makeQualified(new Path(files[i]));
    if (!fs.mkdirs(path[i])) {
      throw new IOException("Mkdirs failed to create " + path[i].toString());
    }
  }
  Path patternPath=new Path(pattern);
  Path[] globResults=FileUtil.stat2Paths(fs.globStatus(patternPath,filter),patternPath);
  for (int i=0; i < globResults.length; i++) {
    globResults[i]=globResults[i].makeQualified(fs.getUri(),fs.getWorkingDirectory());
  }
  return globResults;
}
