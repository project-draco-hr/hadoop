{
  Class<?> klazz=getClassFromMetadata(metadata);
  if (null == klazz) {
    throw new IllegalArgumentException("Cannot get comparator without " + SerializationBase.CLASS_KEY + " set in metadata");
  }
  return (RawComparator)WritableComparator.get((Class<WritableComparable>)klazz);
}
