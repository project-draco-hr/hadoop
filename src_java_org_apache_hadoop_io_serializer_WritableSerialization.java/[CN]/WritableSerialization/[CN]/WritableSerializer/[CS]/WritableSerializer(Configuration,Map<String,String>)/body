{
  this.metadata=metadata;
  String className=this.metadata.get(CLASS_KEY);
  if (null != className) {
    try {
      this.serializedClass=conf.getClassByName(className);
    }
 catch (    ClassNotFoundException cnfe) {
      throw new RuntimeException(cnfe);
    }
  }
 else {
    throw new UnsupportedOperationException("the " + CLASS_KEY + " metadata is missing, but is required.");
  }
}
