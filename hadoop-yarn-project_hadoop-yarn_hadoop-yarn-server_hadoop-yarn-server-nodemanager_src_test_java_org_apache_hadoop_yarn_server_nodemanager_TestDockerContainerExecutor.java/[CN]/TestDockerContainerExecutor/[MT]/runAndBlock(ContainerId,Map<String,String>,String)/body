{
  String appId="APP_" + System.currentTimeMillis();
  Container container=mock(Container.class);
  ContainerLaunchContext context=mock(ContainerLaunchContext.class);
  when(container.getContainerId()).thenReturn(cId);
  when(container.getLaunchContext()).thenReturn(context);
  when(cId.getApplicationAttemptId().getApplicationId().toString()).thenReturn(appId);
  when(context.getEnvironment()).thenReturn(launchCtxEnv);
  String script=writeScriptFile(launchCtxEnv,cmd);
  Path scriptPath=new Path(script);
  Path tokensPath=new Path("/dev/null");
  Path workDir=new Path(workSpace.getAbsolutePath());
  Path pidFile=new Path(workDir,"pid.txt");
  exec.activateContainer(cId,pidFile);
  return exec.launchContainer(new ContainerStartContext.Builder().setContainer(container).setNmPrivateContainerScriptPath(scriptPath).setNmPrivateTokensPath(tokensPath).setUser(appSubmitter).setAppId(appId).setContainerWorkDir(workDir).setLocalDirs(dirsHandler.getLocalDirs()).setLogDirs(dirsHandler.getLogDirs()).build());
}
