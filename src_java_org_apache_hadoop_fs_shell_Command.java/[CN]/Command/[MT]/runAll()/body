{
  int exitCode=0;
  for (  String src : args) {
    try {
      Path srcPath=new Path(src);
      FileSystem fs=srcPath.getFileSystem(getConf());
      FileStatus[] statuses=fs.globStatus(srcPath);
      if (statuses == null) {
        System.err.println("Can not find listing for " + src);
        exitCode=-1;
      }
 else {
        for (        FileStatus s : statuses) {
          run(s.getPath());
        }
      }
    }
 catch (    RemoteException re) {
      exitCode=-1;
      String content=re.getLocalizedMessage();
      int eol=content.indexOf('\n');
      if (eol >= 0) {
        content=content.substring(0,eol);
      }
      System.err.println(getCommandName() + ": " + content);
    }
catch (    IOException e) {
      exitCode=-1;
      System.err.println(getCommandName() + ": " + e.getLocalizedMessage());
    }
  }
  return exitCode;
}
