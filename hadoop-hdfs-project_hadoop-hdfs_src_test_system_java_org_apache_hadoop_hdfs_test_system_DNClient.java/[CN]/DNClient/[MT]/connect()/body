{
  if (isConnected()) {
    return;
  }
  String sockAddrStr=getConf().get(DFSConfigKeys.DFS_DATANODE_IPC_ADDRESS_KEY);
  if (sockAddrStr == null) {
    throw new IllegalArgumentException("Datenode IPC address is not set." + "Check if " + DFSConfigKeys.DFS_DATANODE_IPC_ADDRESS_KEY + " is configured.");
  }
  String[] splits=sockAddrStr.split(":");
  if (splits.length != 2) {
    throw new IllegalArgumentException("Datanode IPC address is not correctly configured");
  }
  String port=splits[1];
  String sockAddr=getHostName() + ":" + port;
  InetSocketAddress bindAddr=NetUtils.createSocketAddr(sockAddr);
  proxy=(DNProtocol)RPC.getProxy(DNProtocol.class,DNProtocol.versionID,bindAddr,getConf());
  setConnected(true);
}
