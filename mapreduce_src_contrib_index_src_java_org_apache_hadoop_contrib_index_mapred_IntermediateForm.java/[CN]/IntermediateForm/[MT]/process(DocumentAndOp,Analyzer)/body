{
  if (doc.getOp() == DocumentAndOp.Op.DELETE || doc.getOp() == DocumentAndOp.Op.UPDATE) {
    deleteList.add(doc.getTerm());
  }
  if (doc.getOp() == DocumentAndOp.Op.INSERT || doc.getOp() == DocumentAndOp.Op.UPDATE) {
    if (writer == null) {
      writer=createWriter();
    }
    writer.addDocument(doc.getDocument(),analyzer);
    numDocs++;
  }
}
