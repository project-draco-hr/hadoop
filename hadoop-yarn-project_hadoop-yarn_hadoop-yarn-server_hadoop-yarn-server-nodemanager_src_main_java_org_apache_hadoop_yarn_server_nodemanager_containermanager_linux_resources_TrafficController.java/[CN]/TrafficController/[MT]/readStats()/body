{
  BatchBuilder builder=new BatchBuilder(PrivilegedOperation.OperationType.TC_READ_STATS).readClasses();
  PrivilegedOperation op=builder.commitBatchToTempFile();
  try {
    String output=privilegedOperationExecutor.executePrivilegedOperation(op,true);
    if (LOG.isDebugEnabled()) {
      LOG.debug("TC stats output:" + output);
    }
    Map<Integer,Integer> classIdBytesStats=parseStatsString(output);
    if (LOG.isDebugEnabled()) {
      LOG.debug("classId -> bytes sent %n" + classIdBytesStats);
    }
    return classIdBytesStats;
  }
 catch (  PrivilegedOperationException e) {
    LOG.warn("Failed to get tc stats");
    throw new ResourceHandlerException("Failed to get tc stats",e);
  }
}
