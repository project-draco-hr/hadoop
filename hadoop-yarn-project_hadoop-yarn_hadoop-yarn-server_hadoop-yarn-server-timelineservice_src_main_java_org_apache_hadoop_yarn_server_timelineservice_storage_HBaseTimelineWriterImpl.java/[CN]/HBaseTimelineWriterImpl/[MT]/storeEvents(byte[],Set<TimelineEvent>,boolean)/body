{
  if (events != null) {
    for (    TimelineEvent event : events) {
      if (event != null) {
        String eventId=event.getId();
        if (eventId != null) {
          long eventTimestamp=event.getTimestamp();
          if (eventTimestamp == TimelineEvent.INVALID_TIMESTAMP) {
            LOG.warn("timestamp is not set for event " + eventId + "! Using the current timestamp");
            eventTimestamp=System.currentTimeMillis();
          }
          EventColumnNameConverter converter=EventColumnNameConverter.getInstance();
          Map<String,Object> eventInfo=event.getInfo();
          if ((eventInfo == null) || (eventInfo.size() == 0)) {
            byte[] columnQualifierBytes=converter.encode(new EventColumnName(eventId,eventTimestamp,null));
            if (isApplication) {
              ApplicationColumnPrefix.EVENT.store(rowKey,applicationTable,columnQualifierBytes,null,Separator.EMPTY_BYTES);
            }
 else {
              EntityColumnPrefix.EVENT.store(rowKey,entityTable,columnQualifierBytes,null,Separator.EMPTY_BYTES);
            }
          }
 else {
            for (            Map.Entry<String,Object> info : eventInfo.entrySet()) {
              byte[] columnQualifierBytes=converter.encode(new EventColumnName(eventId,eventTimestamp,info.getKey()));
              if (isApplication) {
                ApplicationColumnPrefix.EVENT.store(rowKey,applicationTable,columnQualifierBytes,null,info.getValue());
              }
 else {
                EntityColumnPrefix.EVENT.store(rowKey,entityTable,columnQualifierBytes,null,info.getValue());
              }
            }
          }
        }
      }
    }
  }
}
