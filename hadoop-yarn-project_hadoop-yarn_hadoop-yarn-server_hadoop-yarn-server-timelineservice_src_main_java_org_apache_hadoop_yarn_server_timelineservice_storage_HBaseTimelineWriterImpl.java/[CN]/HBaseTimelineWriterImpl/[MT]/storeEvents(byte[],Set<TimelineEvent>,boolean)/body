{
  if (events != null) {
    for (    TimelineEvent event : events) {
      if (event != null) {
        String eventId=event.getId();
        if (eventId != null) {
          long eventTimestamp=event.getTimestamp();
          if (eventTimestamp == TimelineEvent.INVALID_TIMESTAMP) {
            LOG.warn("timestamp is not set for event " + eventId + "! Using the current timestamp");
            eventTimestamp=System.currentTimeMillis();
          }
          byte[] columnQualifierFirst=Bytes.toBytes(Separator.VALUES.encode(eventId));
          byte[] columnQualifierWithTsBytes=Separator.VALUES.join(columnQualifierFirst,Bytes.toBytes(TimelineWriterUtils.invert(eventTimestamp)));
          Map<String,Object> eventInfo=event.getInfo();
          if ((eventInfo == null) || (eventInfo.size() == 0)) {
            byte[] compoundColumnQualifierBytes=Separator.VALUES.join(columnQualifierWithTsBytes,null);
            if (isApplication) {
              ApplicationColumnPrefix.EVENT.store(rowKey,applicationTable,compoundColumnQualifierBytes,null,TimelineWriterUtils.EMPTY_BYTES);
            }
 else {
              EntityColumnPrefix.EVENT.store(rowKey,entityTable,compoundColumnQualifierBytes,null,TimelineWriterUtils.EMPTY_BYTES);
            }
          }
 else {
            for (            Map.Entry<String,Object> info : eventInfo.entrySet()) {
              byte[] compoundColumnQualifierBytes=Separator.VALUES.join(columnQualifierWithTsBytes,Bytes.toBytes(info.getKey()));
              if (isApplication) {
                ApplicationColumnPrefix.EVENT.store(rowKey,applicationTable,compoundColumnQualifierBytes,null,info.getValue());
              }
 else {
                EntityColumnPrefix.EVENT.store(rowKey,entityTable,compoundColumnQualifierBytes,null,info.getValue());
              }
            }
          }
        }
      }
    }
  }
}
