{
  if (events != null) {
    for (    TimelineEvent event : events) {
      if (event != null) {
        String eventId=event.getId();
        if (eventId != null) {
          long eventTimestamp=event.getTimestamp();
          if (eventTimestamp == TimelineEvent.INVALID_TIMESTAMP) {
            LOG.warn("timestamp is not set for event " + eventId + "! Using the current timestamp");
            eventTimestamp=System.currentTimeMillis();
          }
          byte[] eventTs=Bytes.toBytes(TimelineStorageUtils.invertLong(eventTimestamp));
          Map<String,Object> eventInfo=event.getInfo();
          if ((eventInfo == null) || (eventInfo.size() == 0)) {
            if (isApplication) {
              byte[] compoundColumnQualifierBytes=ApplicationColumnPrefix.EVENT.getCompoundColQualBytes(eventId,eventTs,null);
              ApplicationColumnPrefix.EVENT.store(rowKey,applicationTable,compoundColumnQualifierBytes,null,TimelineStorageUtils.EMPTY_BYTES);
            }
 else {
              byte[] compoundColumnQualifierBytes=EntityColumnPrefix.EVENT.getCompoundColQualBytes(eventId,eventTs,null);
              EntityColumnPrefix.EVENT.store(rowKey,entityTable,compoundColumnQualifierBytes,null,TimelineStorageUtils.EMPTY_BYTES);
            }
          }
 else {
            for (            Map.Entry<String,Object> info : eventInfo.entrySet()) {
              byte[] infoKey=Bytes.toBytes(info.getKey());
              if (isApplication) {
                byte[] compoundColumnQualifierBytes=ApplicationColumnPrefix.EVENT.getCompoundColQualBytes(eventId,eventTs,infoKey);
                ApplicationColumnPrefix.EVENT.store(rowKey,applicationTable,compoundColumnQualifierBytes,null,info.getValue());
              }
 else {
                byte[] compoundColumnQualifierBytes=EntityColumnPrefix.EVENT.getCompoundColQualBytes(eventId,eventTs,infoKey);
                EntityColumnPrefix.EVENT.store(rowKey,entityTable,compoundColumnQualifierBytes,null,info.getValue());
              }
            }
          }
        }
      }
    }
  }
}
