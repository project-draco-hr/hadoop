{
  byte[] rowKeyPrefix=TimelineWriterUtils.getRowKeyPrefix(clusterId,userId,flowName,flowRunId,appId);
  TimelineWriteResponse putStatus=new TimelineWriteResponse();
  for (  TimelineEntity te : data.getEntities()) {
    if (te == null) {
      continue;
    }
    byte[] row=TimelineWriterUtils.join(TimelineEntitySchemaConstants.ROW_KEY_SEPARATOR_BYTES,rowKeyPrefix,Bytes.toBytes(te.getType()),Bytes.toBytes(te.getId()));
    storeInfo(row,te,flowVersion);
    storeEvents(row,te.getEvents());
    storeConfig(row,te.getConfigs());
    storeMetrics(row,te.getMetrics());
    storeRelations(row,te.getIsRelatedToEntities(),EntityColumnDetails.PREFIX_IS_RELATED_TO);
    storeRelations(row,te.getRelatesToEntities(),EntityColumnDetails.PREFIX_RELATES_TO);
  }
  return putStatus;
}
