{
  TimelineWriteResponse putStatus=new TimelineWriteResponse();
  for (  TimelineEntity te : data.getEntities()) {
    if (te == null) {
      continue;
    }
    byte[] rowKey=EntityRowKey.getRowKey(clusterId,userId,flowName,flowRunId,appId,te.getType(),te.getId());
    storeInfo(rowKey,te,flowVersion);
    storeEvents(rowKey,te.getEvents());
    storeConfig(rowKey,te.getConfigs());
    storeMetrics(rowKey,te.getMetrics());
    storeRelations(rowKey,te.getIsRelatedToEntities(),EntityColumnPrefix.IS_RELATED_TO);
    storeRelations(rowKey,te.getRelatesToEntities(),EntityColumnPrefix.RELATES_TO);
    if (isApplicationCreated(te)) {
      onApplicationCreated(clusterId,userId,flowName,flowVersion,flowRunId,appId,te);
    }
  }
  return putStatus;
}
