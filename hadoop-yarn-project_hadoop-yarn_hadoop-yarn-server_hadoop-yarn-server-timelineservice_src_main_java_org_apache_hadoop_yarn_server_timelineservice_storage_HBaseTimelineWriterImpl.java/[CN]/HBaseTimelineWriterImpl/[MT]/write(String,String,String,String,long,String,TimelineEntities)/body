{
  TimelineWriteResponse putStatus=new TimelineWriteResponse();
  for (  TimelineEntity te : data.getEntities()) {
    if (te == null) {
      continue;
    }
    boolean isApplication=TimelineWriterUtils.isApplicationEntity(te);
    byte[] rowKey=isApplication ? ApplicationRowKey.getRowKey(clusterId,userId,flowName,flowRunId,appId) : EntityRowKey.getRowKey(clusterId,userId,flowName,flowRunId,appId,te.getType(),te.getId());
    storeInfo(rowKey,te,flowVersion,isApplication);
    storeEvents(rowKey,te.getEvents(),isApplication);
    storeConfig(rowKey,te.getConfigs(),isApplication);
    storeMetrics(rowKey,te.getMetrics(),isApplication);
    storeRelations(rowKey,te,isApplication);
    if (isApplication) {
      if (TimelineWriterUtils.isApplicationCreated(te)) {
        onApplicationCreated(clusterId,userId,flowName,flowVersion,flowRunId,appId,te);
      }
      storeFlowMetricsAppRunning(clusterId,userId,flowName,flowRunId,appId,te);
      if (TimelineWriterUtils.isApplicationFinished(te)) {
        onApplicationFinished(clusterId,userId,flowName,flowVersion,flowRunId,appId,te);
      }
    }
  }
  return putStatus;
}
