@staticmethod
def get_clusters_with_role(role, state='running', driver=None):
    driver = (driver or RackspaceNodeDriver(RACKSPACE_KEY, RACKSPACE_SECRET))
    all_nodes = RackspaceCluster._list_nodes(driver)
    clusters = set()
    for node in all_nodes:
        try:
            if (node.extra['metadata'].has_key('cluster') and (role in node.extra['metadata']['roles'].split(','))):
                if (node.state == STATE_MAP[state]):
                    clusters.add(node.extra['metadata']['cluster'])
        except KeyError:
            pass
    return clusters
