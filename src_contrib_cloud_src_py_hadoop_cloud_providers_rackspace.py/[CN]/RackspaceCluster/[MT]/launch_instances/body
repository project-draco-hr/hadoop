def launch_instances(self, roles, number, image_id, size_id, instance_user_data, **kwargs):
    metadata = {'cluster': self.name, 'roles': ','.join(roles), }
    node_ids = []
    files = {USER_DATA_FILENAME: instance_user_data.read(), }
    if ('public_key' in kwargs):
        files['/root/.ssh/authorized_keys'] = open(kwargs['public_key']).read()
    for dummy in range(number):
        node = self._launch_instance(roles, image_id, size_id, metadata, files)
        node_ids.append(node.id)
    return node_ids
