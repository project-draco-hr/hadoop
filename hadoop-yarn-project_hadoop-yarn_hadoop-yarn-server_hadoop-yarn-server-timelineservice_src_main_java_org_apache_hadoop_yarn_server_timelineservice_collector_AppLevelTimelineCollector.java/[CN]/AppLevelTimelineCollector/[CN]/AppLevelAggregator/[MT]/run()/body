{
  if (LOG.isDebugEnabled()) {
    LOG.debug("App-level real-time aggregating");
  }
  try {
    TimelineCollectorContext currContext=getTimelineEntityContext();
    TimelineEntity resultEntity=TimelineCollector.aggregateWithoutGroupId(getAggregationGroups(),currContext.getAppId(),TimelineEntityType.YARN_APPLICATION.toString());
    TimelineEntities entities=new TimelineEntities();
    entities.addEntity(resultEntity);
    getWriter().write(currContext.getClusterId(),currContext.getUserId(),currContext.getFlowName(),currContext.getFlowVersion(),currContext.getFlowRunId(),currContext.getAppId(),entities);
  }
 catch (  Exception e) {
    LOG.error("Error aggregating timeline metrics",e);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("App-level real-time aggregation complete");
  }
}
