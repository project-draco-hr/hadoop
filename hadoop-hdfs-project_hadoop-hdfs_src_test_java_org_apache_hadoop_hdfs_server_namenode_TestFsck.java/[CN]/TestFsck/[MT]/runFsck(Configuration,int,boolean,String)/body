{
  ByteArrayOutputStream bStream=new ByteArrayOutputStream();
  PrintStream out=new PrintStream(bStream,true);
  ((Log4JLogger)FSPermissionChecker.LOG).getLogger().setLevel(Level.ALL);
  int errCode=ToolRunner.run(new DFSck(conf,out),path);
  if (checkErrorCode) {
    assertEquals(expectedErrCode,errCode);
  }
  ((Log4JLogger)FSPermissionChecker.LOG).getLogger().setLevel(Level.INFO);
  FSImage.LOG.error("OUTPUT = " + bStream.toString());
  return bStream.toString();
}
