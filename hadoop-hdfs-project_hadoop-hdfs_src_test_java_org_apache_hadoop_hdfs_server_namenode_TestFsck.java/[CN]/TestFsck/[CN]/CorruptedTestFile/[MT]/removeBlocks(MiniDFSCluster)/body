{
  for (  int corruptIdx : blocksToCorrupt) {
    ExtendedBlock block=dfsClient.getNamenode().getBlockLocations(name,blockSize * corruptIdx,Long.MAX_VALUE).get(0).getBlock();
    for (int i=0; i < numDataNodes; i++) {
      File blockFile=cluster.getBlockFile(i,block);
      if (blockFile != null && blockFile.exists()) {
        assertTrue(blockFile.delete());
      }
    }
  }
}
