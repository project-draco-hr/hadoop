{
  new File(TEST_DIR).mkdirs();
  conf=new Configuration();
  conf.set("raid.config.file",CONFIG_FILE);
  conf.set(RaidNode.RAID_LOCATION_KEY,"/destraid");
  conf.setBoolean("raid.config.reload",true);
  conf.setLong("raid.config.reload.interval",RELOAD_INTERVAL);
  conf.setBoolean("dfs.permissions.enabled",true);
  conf.setLong("raid.policy.rescan.interval",5000);
  conf.set("fs.shell.delete.classname","org.apache.hadoop.hdfs.DFSClient");
  if (local) {
    conf.set("raid.classname","org.apache.hadoop.raid.LocalRaidNode");
  }
 else {
    conf.set("raid.classname","org.apache.hadoop.raid.DistRaidNode");
  }
  conf.set("raid.server.address","localhost:0");
  MiniDFSCluster.Builder builder=new MiniDFSCluster.Builder(conf);
  builder.numDataNodes(6);
  builder.format(true);
  dfs=builder.build();
  dfs.waitActive();
  fileSys=dfs.getFileSystem();
  namenode=fileSys.getUri().toString();
  final int taskTrackers=4;
  mr=new MiniMRCluster(taskTrackers,namenode,3);
  jobTrackerName="localhost:" + mr.getJobTrackerPort();
  hftp="hftp://localhost.localdomain:" + dfs.getNameNodePort();
  FileSystem.setDefaultUri(conf,namenode);
  conf.set("mapred.job.tracker",jobTrackerName);
}
