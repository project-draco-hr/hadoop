{
  final ChannelFuture mockFuture=Mockito.mock(ChannelFuture.class);
  Mockito.when(mockFuture.getChannel()).thenReturn(mockCh);
  Mockito.doReturn(true).when(mockFuture).isSuccess();
  Mockito.doAnswer(new Answer(){
    @Override public Object answer(    InvocationOnMock invocation) throws Throwable {
      if (invocation.getArguments()[0].getClass() == ShuffleHandler.ReduceMapFileCount.class)       listenerList.add((ShuffleHandler.ReduceMapFileCount)invocation.getArguments()[0]);
      return null;
    }
  }
).when(mockFuture).addListener(Mockito.any(ShuffleHandler.ReduceMapFileCount.class));
  return mockFuture;
}
