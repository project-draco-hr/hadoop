{
  DebugGridmix client=new DebugGridmix();
  Configuration conf=new Configuration();
  conf.setEnum(GridmixJobSubmissionPolicy.JOB_SUBMISSION_POLICY,policy);
  conf.set("mapreduce.job.hdfs-servers","");
  if (useDefaultQueue) {
    conf.setBoolean(GridmixJob.GRIDMIX_USE_QUEUE_IN_TRACE,false);
    conf.set(GridmixJob.GRIDMIX_DEFAULT_QUEUE,"q1");
  }
 else {
    conf.setBoolean(GridmixJob.GRIDMIX_USE_QUEUE_IN_TRACE,true);
  }
  conf=GridmixTestUtils.mrCluster.createJobConf(new JobConf(conf));
  int res=ToolRunner.run(conf,client,argv);
  assertEquals("Gridmix exited with wrong exit status",expectedExitCode,res);
  if (expectedExitCode == 0) {
    client.checkMonitor(conf);
    FsPermission perm=GridmixTestUtils.dfs.getFileStatus(ioPath).getPermission();
    assertEquals("Wrong permissions of ioPath",new FsPermission((short)0777),perm);
  }
}
