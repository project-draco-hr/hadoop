{
  ProducerConsumer<Integer,Integer> workers=new ProducerConsumer<Integer,Integer>(10);
  for (int i=0; i < 10; i++) {
    workers.addWorker(new CopyProcessor());
  }
  int sum=0;
  int numRequests=2000;
  for (int i=0; i < numRequests; i++) {
    workers.put(new WorkRequest<Integer>(i + 42));
    sum+=i + 42;
  }
  int numReports=0;
  while (workers.getWorkCnt() > 0) {
    WorkReport<Integer> report=workers.blockingTake();
    sum-=report.getItem().intValue();
    numReports++;
  }
  Assert.assertEquals(0,sum);
  Assert.assertEquals(numRequests,numReports);
  workers.shutdown();
}
