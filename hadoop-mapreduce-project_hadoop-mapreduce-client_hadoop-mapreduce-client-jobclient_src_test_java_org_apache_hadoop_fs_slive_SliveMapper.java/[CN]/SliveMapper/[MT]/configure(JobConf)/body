{
  try {
    config=new ConfigExtractor(conf);
    ConfigExtractor.dumpOptions(config);
    filesystem=config.getBaseDirectory().getFileSystem(conf);
  }
 catch (  Exception e) {
    LOG.error("Unable to setup slive " + StringUtils.stringifyException(e));
    throw new RuntimeException("Unable to setup slive configuration",e);
  }
  if (conf.get(MRJobConfig.TASK_ATTEMPT_ID) != null) {
    this.taskId=TaskAttemptID.forName(conf.get(MRJobConfig.TASK_ATTEMPT_ID)).getTaskID().getId();
  }
 else {
    this.taskId=TaskAttemptID.forName(conf.get("mapred.task.id")).getTaskID().getId();
  }
}
