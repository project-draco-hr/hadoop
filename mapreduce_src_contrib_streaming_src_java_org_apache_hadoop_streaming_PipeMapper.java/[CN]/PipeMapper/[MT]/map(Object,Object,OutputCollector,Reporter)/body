{
  if (outerrThreadsThrowable != null) {
    mapRedFinished();
    throw new IOException("MROutput/MRErrThread failed:",outerrThreadsThrowable);
  }
  try {
    numRecRead_++;
    maybeLogRecord();
    if (numExceptions_ == 0) {
      if (!this.ignoreKey) {
        inWriter_.writeKey(key);
      }
      inWriter_.writeValue(value);
      if (skipping) {
        clientOut_.flush();
      }
    }
 else {
      numRecSkipped_++;
    }
  }
 catch (  IOException io) {
    numExceptions_++;
    if (numExceptions_ > 1 || numRecWritten_ < minRecWrittenToEnableSkip_) {
      LOG.info(getContext(),io);
      mapRedFinished();
      throw io;
    }
 else {
    }
  }
}
