{
  if (endSeen) {
    return -1;
  }
  input.mark(10000);
  int result=input.read();
  if (result < 0) {
    endSeen=true;
    return result;
  }
  if (result == markerBytes[0]) {
    input.reset();
    int markerReadResult=input.read(fileMarkerBuffer,0,fileMarkerBuffer.length);
    input.reset();
    if (markerReadResult < fileMarkerBuffer.length || !fileMarker.equals(new String(fileMarkerBuffer))) {
      return input.read();
    }
    return -1;
  }
  return result;
}
