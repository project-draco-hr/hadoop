{
  try {
    visitor.start(inputStream.getVersion());
    while (true) {
      FSEditLogOp op=inputStream.readOp();
      if (op == null)       break;
      if (fixTxIds) {
        if (nextTxId <= 0) {
          nextTxId=op.getTransactionId();
          if (nextTxId <= 0) {
            nextTxId=1;
          }
        }
        op.setTransactionId(nextTxId);
        nextTxId++;
      }
      visitor.visitOp(op);
    }
    visitor.close(null);
  }
 catch (  IOException e) {
    visitor.close(e);
    throw e;
  }
}
