{
  final byte[] localName=FSImageSerialization.readLocalName(in);
  INode inode=loadINode(localName,isSnapshotINode,in);
  if (LayoutVersion.supports(Feature.ADD_INODE_ID,getLayoutVersion())) {
    if (!inode.isReference()) {
      namesystem.dir.addToInodeMapUnprotected(inode);
    }
  }
  return inode;
}
