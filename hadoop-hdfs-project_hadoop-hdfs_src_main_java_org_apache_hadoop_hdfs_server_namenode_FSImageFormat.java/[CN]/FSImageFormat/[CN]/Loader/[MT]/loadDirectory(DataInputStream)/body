{
  String parentPath=FSImageSerialization.readString(in);
  FSDirectory fsDir=namesystem.dir;
  final INodeDirectory parent=INodeDirectory.valueOf(fsDir.rootDir.getNode(parentPath,true),parentPath);
  int numChildren=in.readInt();
  for (int i=0; i < numChildren; i++) {
    byte[] localName=new byte[in.readShort()];
    in.readFully(localName);
    INode newNode=loadINode(in);
    namesystem.dir.addToParent(localName,parent,newNode,false);
  }
  return numChildren;
}
