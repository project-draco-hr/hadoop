{
  SecurityUtilTestHelper.setTokenServiceUseIp(true);
  Configuration conf=new Configuration();
  conf.setClass("fs.hftp.impl",MyHftpFileSystem.class,FileSystem.class);
  URI fsUri=URI.create("hftp://localhost");
  MyHftpFileSystem fs=(MyHftpFileSystem)FileSystem.get(fsUri,conf);
  checkTokenSelection(fs,conf);
  fsUri=URI.create("hftp://localhost:" + fs.getDefaultPort());
  fs=(MyHftpFileSystem)FileSystem.get(fsUri,conf);
  checkTokenSelection(fs,conf);
  fsUri=URI.create("hftp://localhost:" + (fs.getDefaultPort() - 1));
  fs=(MyHftpFileSystem)FileSystem.get(fsUri,conf);
  checkTokenSelection(fs,conf);
}
