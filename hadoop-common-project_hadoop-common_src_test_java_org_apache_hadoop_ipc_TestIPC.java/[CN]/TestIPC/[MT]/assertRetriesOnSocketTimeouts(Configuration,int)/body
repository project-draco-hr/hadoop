{
  SocketFactory mockFactory=Mockito.mock(SocketFactory.class);
  doThrow(new ConnectTimeoutException("fake")).when(mockFactory).createSocket();
  Client client=new Client(IntWritable.class,conf,mockFactory);
  InetSocketAddress address=new InetSocketAddress("127.0.0.1",9090);
  try {
    client.call(new IntWritable(RANDOM.nextInt()),address,null,null,0,conf);
    fail("Not throwing the SocketTimeoutException");
  }
 catch (  SocketTimeoutException e) {
    Mockito.verify(mockFactory,Mockito.times(maxTimeoutRetries)).createSocket();
  }
  client.stop();
}
