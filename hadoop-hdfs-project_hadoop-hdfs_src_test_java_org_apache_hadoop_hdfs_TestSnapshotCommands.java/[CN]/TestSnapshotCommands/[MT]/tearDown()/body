{
  if (fs.exists(new Path("/sub1"))) {
    if (fs.exists(new Path("/sub1/.snapshot"))) {
      for (      FileStatus st : fs.listStatus(new Path("/sub1/.snapshot"))) {
        fs.deleteSnapshot(new Path("/sub1"),st.getPath().getName());
      }
      fs.disallowSnapshot(new Path("/sub1"));
    }
    fs.delete(new Path("/sub1"),true);
  }
}
