{
  if (!closed.compareAndSet(false,true)) {
    DFSClient.LOG.debug("DFSInputStream has been closed already");
    return;
  }
  dfsClient.checkOpen();
  if ((extendedReadBuffers != null) && (!extendedReadBuffers.isEmpty())) {
    final StringBuilder builder=new StringBuilder();
    extendedReadBuffers.visitAll(new IdentityHashStore.Visitor<ByteBuffer,Object>(){
      private String prefix="";
      @Override public void accept(      ByteBuffer k,      Object v){
        builder.append(prefix).append(k);
        prefix=", ";
      }
    }
);
    DFSClient.LOG.warn("closing file " + src + ", but there are still "+ "unreleased ByteBuffers allocated by read().  "+ "Please release "+ builder.toString()+ ".");
  }
  closeCurrentBlockReaders();
  super.close();
}
