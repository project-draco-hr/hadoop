{
  this.worker=worker;
  this.datanode=worker.getDatanode();
  this.conf=worker.getConf();
  ecPolicy=reconstructionInfo.getErasureCodingPolicy();
  blockGroup=reconstructionInfo.getExtendedBlock();
  byte[] liveIndices=reconstructionInfo.getLiveBlockIndices();
  liveBitSet=new BitSet(ecPolicy.getNumDataUnits() + ecPolicy.getNumParityUnits());
  for (int i=0; i < liveIndices.length; i++) {
    liveBitSet.set(liveIndices[i]);
  }
  stripedReader=new StripedReader(this,datanode,conf,reconstructionInfo);
  stripedWriter=new StripedWriter(this,datanode,conf,reconstructionInfo);
  cachingStrategy=CachingStrategy.newDefaultStrategy();
  positionInBlock=0L;
}
