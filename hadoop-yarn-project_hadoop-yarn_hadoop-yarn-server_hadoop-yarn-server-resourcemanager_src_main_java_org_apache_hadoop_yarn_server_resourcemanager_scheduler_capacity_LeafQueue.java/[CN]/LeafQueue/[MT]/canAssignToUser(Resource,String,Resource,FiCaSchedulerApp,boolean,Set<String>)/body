{
  User user=getUser(userName);
  String label=CommonNodeLabelsManager.NO_LABEL;
  if (requestLabels != null && !requestLabels.isEmpty()) {
    label=requestLabels.iterator().next();
  }
  if (Resources.greaterThan(resourceCalculator,clusterResource,user.getUsed(label),limit)) {
    if (this.reservationsContinueLooking && checkReservations && label.equals(CommonNodeLabelsManager.NO_LABEL)) {
      if (Resources.lessThanOrEqual(resourceCalculator,clusterResource,Resources.subtract(user.getUsed(),application.getCurrentReservation()),limit)) {
        if (LOG.isDebugEnabled()) {
          LOG.debug("User " + userName + " in queue "+ getQueueName()+ " will exceed limit based on reservations - "+ " consumed: "+ user.getUsed()+ " reserved: "+ application.getCurrentReservation()+ " limit: "+ limit);
        }
        return true;
      }
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("User " + userName + " in queue "+ getQueueName()+ " will exceed limit - "+ " consumed: "+ user.getUsed()+ " limit: "+ limit);
    }
    return false;
  }
  return true;
}
