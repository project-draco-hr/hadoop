{
  boolean wasActive=activeApplications.remove(application);
  if (!wasActive) {
    pendingApplications.remove(application);
  }
 else {
    queueUsage.decAMUsed(application.getAMResource());
    user.getResourceUsage().decAMUsed(application.getAMResource());
  }
  applicationAttemptMap.remove(application.getApplicationAttemptId());
  user.finishApplication(wasActive);
  if (user.getTotalApplications() == 0) {
    users.remove(application.getUser());
  }
  activateApplications();
  LOG.info("Application removed -" + " appId: " + application.getApplicationId() + " user: "+ application.getUser()+ " queue: "+ getQueueName()+ " #user-pending-applications: "+ user.getPendingApplications()+ " #user-active-applications: "+ user.getActiveApplications()+ " #queue-pending-applications: "+ getNumPendingApplications()+ " #queue-active-applications: "+ getNumActiveApplications());
}
