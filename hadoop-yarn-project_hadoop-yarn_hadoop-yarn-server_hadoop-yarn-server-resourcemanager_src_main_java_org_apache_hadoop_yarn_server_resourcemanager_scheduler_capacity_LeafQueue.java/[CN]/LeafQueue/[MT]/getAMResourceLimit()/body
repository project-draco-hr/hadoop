{
  Resource queueMaxCap;
synchronized (queueHeadroomInfo) {
    queueMaxCap=queueHeadroomInfo.getQueueMaxCap();
  }
  Resource queueCap=Resources.max(resourceCalculator,lastClusterResource,absoluteCapacityResource,queueMaxCap);
  return Resources.multiplyAndNormalizeUp(resourceCalculator,queueCap,maxAMResourcePerQueuePercent,minimumAllocation);
}
