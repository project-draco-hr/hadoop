{
  Resource queueCurrentLimit;
synchronized (queueResourceLimitsInfo) {
    queueCurrentLimit=queueResourceLimitsInfo.getQueueCurrentLimit();
  }
  Resource queueCap=Resources.max(resourceCalculator,lastClusterResource,absoluteCapacityResource,queueCurrentLimit);
  Resource amResouceLimit=Resources.multiplyAndNormalizeUp(resourceCalculator,queueCap,maxAMResourcePerQueuePercent,minimumAllocation);
  metrics.setAMResouceLimit(amResouceLimit);
  return amResouceLimit;
}
