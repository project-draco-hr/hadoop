{
  Resource queueCurrentLimit;
synchronized (queueResourceLimitsInfo) {
    queueCurrentLimit=queueResourceLimitsInfo.getQueueCurrentLimit();
  }
  Resource queueCap=Resources.max(resourceCalculator,lastClusterResource,absoluteCapacityResource,queueCurrentLimit);
  return Resources.multiplyAndNormalizeUp(resourceCalculator,queueCap,maxAMResourcePerQueuePercent,minimumAllocation);
}
