{
  super(cs,queueName,parent,old);
  this.scheduler=cs;
  this.activeUsersManager=new ActiveUsersManager(metrics);
  this.minimumAllocationFactor=Resources.ratio(resourceCalculator,Resources.subtract(maximumAllocation,minimumAllocation),maximumAllocation);
  float capacity=getCapacityFromConf();
  float absoluteCapacity=parent.getAbsoluteCapacity() * capacity;
  float maximumCapacity=(float)cs.getConfiguration().getMaximumCapacity(getQueuePath()) / 100;
  float absoluteMaxCapacity=CSQueueUtils.computeAbsoluteMaximumCapacity(maximumCapacity,parent);
  int userLimit=cs.getConfiguration().getUserLimit(getQueuePath());
  float userLimitFactor=cs.getConfiguration().getUserLimitFactor(getQueuePath());
  int maxApplications=cs.getConfiguration().getMaximumApplicationsPerQueue(getQueuePath());
  if (maxApplications < 0) {
    int maxSystemApps=cs.getConfiguration().getMaximumSystemApplications();
    maxApplications=(int)(maxSystemApps * absoluteCapacity);
  }
  maxApplicationsPerUser=(int)(maxApplications * (userLimit / 100.0f) * userLimitFactor);
  float maxAMResourcePerQueuePercent=cs.getConfiguration().getMaximumApplicationMasterResourcePerQueuePercent(getQueuePath());
  QueueState state=cs.getConfiguration().getState(getQueuePath());
  Map<QueueACL,AccessControlList> acls=cs.getConfiguration().getAcls(getQueuePath());
  setupQueueConfigs(cs.getClusterResource(),capacity,absoluteCapacity,maximumCapacity,absoluteMaxCapacity,userLimit,userLimitFactor,maxApplications,maxAMResourcePerQueuePercent,maxApplicationsPerUser,state,acls,cs.getConfiguration().getNodeLocalityDelay(),accessibleLabels,defaultLabelExpression,this.capacitiyByNodeLabels,this.maxCapacityByNodeLabels,cs.getConfiguration().getReservationContinueLook());
  if (LOG.isDebugEnabled()) {
    LOG.debug("LeafQueue:" + " name=" + queueName + ", fullname="+ getQueuePath());
  }
  Comparator<FiCaSchedulerApp> applicationComparator=cs.getApplicationComparator();
  this.pendingApplications=new TreeSet<FiCaSchedulerApp>(applicationComparator);
  this.activeApplications=new TreeSet<FiCaSchedulerApp>(applicationComparator);
}
