{
  this.conf=conf;
  InetSocketAddress socAddr=RaidNode.getAddress(conf);
  int handlerCount=conf.getInt("fs.raidnode.handler.count",10);
  configMgr=new ConfigManager(conf);
  this.server=RPC.getServer(this,socAddr.getHostName(),socAddr.getPort(),handlerCount,false,conf);
  this.serverAddress=this.server.getListenerAddress();
  LOG.info("RaidNode up at: " + this.serverAddress);
  initialized=true;
  running=true;
  this.server.start();
  this.blockFixer=BlockFixer.createBlockFixer(conf);
  this.blockFixerThread=new Daemon(this.blockFixer);
  this.blockFixerThread.start();
  this.triggerThread=new Daemon(new TriggerMonitor());
  this.triggerThread.start();
  this.purgeMonitor=new PurgeMonitor();
  this.purgeThread=new Daemon(purgeMonitor);
  this.purgeThread.start();
  this.harThread=new Daemon(new HarMonitor());
  this.harThread.start();
}
