{
  this.writeLock.lock();
  try {
    LOG.info("Rolling master-key for amrm-tokens");
    this.nextMasterKey=createNewMasterKey();
    AMRMTokenSecretManagerState state=AMRMTokenSecretManagerState.newInstance(this.currentMasterKey.getMasterKey(),this.nextMasterKey.getMasterKey());
    rmContext.getStateStore().storeOrUpdateAMRMTokenSecretManagerState(state,true);
    this.timer.schedule(new NextKeyActivator(),this.activationDelay);
  }
  finally {
    this.writeLock.unlock();
  }
}
