{
  if (b == null) {
    throw new NullPointerException();
  }
  if (off < 0 || len < 0 || off > b.length - len) {
    throw new ArrayIndexOutOfBoundsException();
  }
  int n=0;
  n=uncompressedDirectBuf.remaining();
  if (n > 0) {
    n=Math.min(n,len);
    ((ByteBuffer)uncompressedDirectBuf).get(b,off,n);
    return n;
  }
  if (compressedDirectBufLen > 0) {
    uncompressedDirectBuf.rewind();
    uncompressedDirectBuf.limit(directBufferSize);
    n=decompressBytesDirect();
    uncompressedDirectBuf.limit(n);
    if (userBufLen <= 0) {
      finished=true;
    }
    n=Math.min(n,len);
    ((ByteBuffer)uncompressedDirectBuf).get(b,off,n);
  }
  return n;
}
