{
  String cluster="cluster1";
  String user="user1";
  String flow="flow_name";
  String flowVersion="CF7022C10F1354";
  Long runid=1002345678919L;
  Long runid1=1002345678920L;
  TimelineEntities te=new TimelineEntities();
  TimelineEntity entity=new TimelineEntity();
  String id="flowRunMetrics_test";
  String type=TimelineEntityType.YARN_APPLICATION.toString();
  entity.setId(id);
  entity.setType(type);
  Long cTime=1425016501000L;
  entity.setCreatedTime(cTime);
  Set<TimelineMetric> metrics=new HashSet<>();
  TimelineMetric m1=new TimelineMetric();
  m1.setId("MAP_SLOT_MILLIS");
  Map<Long,Number> metricValues=new HashMap<Long,Number>();
  metricValues.put(ts - 100000,2);
  metricValues.put(ts - 80000,40);
  m1.setType(Type.TIME_SERIES);
  m1.setValues(metricValues);
  metrics.add(m1);
  m1=new TimelineMetric();
  m1.setId("HDFS_BYTES_READ");
  metricValues=new HashMap<Long,Number>();
  metricValues.put(ts - 100000,31);
  metricValues.put(ts - 80000,57);
  m1.setType(Type.TIME_SERIES);
  m1.setValues(metricValues);
  metrics.add(m1);
  entity.addMetrics(metrics);
  TimelineEvent event=new TimelineEvent();
  event.setId(ApplicationMetricsConstants.CREATED_EVENT_TYPE);
  Long expTs=1436512802000L;
  event.setTimestamp(expTs);
  String expKey="foo_event";
  Object expVal="test";
  event.addInfo(expKey,expVal);
  entity.addEvent(event);
  te.addEntity(entity);
  TimelineEntities te1=new TimelineEntities();
  TimelineEntity entity1=new TimelineEntity();
  id="flowRunMetrics_test";
  type=TimelineEntityType.YARN_APPLICATION.toString();
  entity1.setId(id);
  entity1.setType(type);
  cTime=1425016501000L;
  entity1.setCreatedTime(cTime);
  metrics.clear();
  TimelineMetric m2=new TimelineMetric();
  m2.setId("MAP_SLOT_MILLIS");
  metricValues=new HashMap<Long,Number>();
  metricValues.put(ts - 100000,5L);
  metricValues.put(ts - 80000,101L);
  m2.setType(Type.TIME_SERIES);
  m2.setValues(metricValues);
  metrics.add(m2);
  entity1.addMetrics(metrics);
  te1.addEntity(entity1);
  String flow2="flow_name2";
  String flowVersion2="CF7022C10F1454";
  Long runid2=2102356789046L;
  TimelineEntities te3=new TimelineEntities();
  TimelineEntity entity3=new TimelineEntity();
  id="flowRunMetrics_test1";
  entity3.setId(id);
  entity3.setType(type);
  cTime=1425016501030L;
  entity3.setCreatedTime(cTime);
  TimelineEvent event2=new TimelineEvent();
  event2.setId(ApplicationMetricsConstants.CREATED_EVENT_TYPE);
  event2.setTimestamp(1436512802030L);
  event2.addInfo("foo_event","test");
  entity3.addEvent(event2);
  te3.addEntity(entity3);
  HBaseTimelineWriterImpl hbi=null;
  Configuration c1=util.getConfiguration();
  try {
    hbi=new HBaseTimelineWriterImpl(c1);
    hbi.init(c1);
    String appName="application_11111111111111_1111";
    hbi.write(cluster,user,flow,flowVersion,runid,appName,te);
    appName="application_11111111111111_2222";
    hbi.write(cluster,user,flow,flowVersion,runid,appName,te1);
    hbi.write(cluster,user,flow,flowVersion,runid1,appName,te);
    appName="application_11111111111111_2223";
    hbi.write(cluster,user,flow2,flowVersion2,runid2,appName,te3);
    hbi.flush();
  }
  finally {
    hbi.close();
  }
}
