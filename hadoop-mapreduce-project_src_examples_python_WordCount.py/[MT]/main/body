def main(args):
    conf = JobConf(WordCountMap)
    conf.setJobName('wordcount')
    conf.setOutputKeyClass(Text)
    conf.setOutputValueClass(IntWritable)
    conf.setMapperClass(WordCountMap)
    conf.setCombinerClass(Summer)
    conf.setReducerClass(Summer)
    try:
        (flags, other_args) = getopt.getopt(args[1:], 'm:r:')
    except getopt.GetoptError:
        printUsage(1)
    if (len(other_args) != 2):
        printUsage(1)
    for (f, v) in flags:
        if (f == '-m'):
            conf.setNumMapTasks(int(v))
        elif (f == '-r'):
            conf.setNumReduceTasks(int(v))
    conf.setInputPath(Path(other_args[0]))
    conf.setOutputPath(Path(other_args[1]))
    JobClient.runJob(conf)
