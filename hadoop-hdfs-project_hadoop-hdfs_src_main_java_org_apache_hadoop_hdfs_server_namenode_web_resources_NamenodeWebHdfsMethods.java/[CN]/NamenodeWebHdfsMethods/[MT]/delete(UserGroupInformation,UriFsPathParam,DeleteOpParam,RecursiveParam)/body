{
  if (LOG.isTraceEnabled()) {
    LOG.trace(op + ": " + path+ ", ugi="+ ugi+ Param.toSortedString(", ",recursive));
  }
  return ugi.doAs(new PrivilegedExceptionAction<Response>(){
    @Override public Response run() throws IOException {
      REMOTE_ADDRESS.set(request.getRemoteAddr());
      try {
        final NameNode namenode=(NameNode)context.getAttribute("name.node");
        final String fullpath=path.getAbsolutePath();
switch (op.getValue()) {
case DELETE:
{
            final boolean b=namenode.getRpcServer().delete(fullpath,recursive.getValue());
            final String js=JsonUtil.toJsonString("boolean",b);
            return Response.ok(js).type(MediaType.APPLICATION_JSON).build();
          }
default :
        throw new UnsupportedOperationException(op + " is not supported");
    }
  }
  finally {
    REMOTE_ADDRESS.set(null);
  }
}
}
);
}
