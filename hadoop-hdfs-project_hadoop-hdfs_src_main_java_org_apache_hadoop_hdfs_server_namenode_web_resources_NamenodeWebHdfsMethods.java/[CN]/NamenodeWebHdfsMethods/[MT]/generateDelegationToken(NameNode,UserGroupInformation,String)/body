{
  final Credentials c=DelegationTokenSecretManager.createCredentials(namenode,ugi,renewer != null ? renewer : request.getUserPrincipal().getName());
  final Token<? extends TokenIdentifier> t=c.getAllTokens().iterator().next();
  t.setService(new Text(SecurityUtil.buildDTServiceName(NameNode.getUri(namenode.getNameNodeAddress()),NameNode.DEFAULT_PORT)));
  return t;
}
