{
  final NameNode namenode=(NameNode)context.getAttribute("name.node");
switch (op.getValue()) {
case APPEND:
{
      final URI uri=redirectURI(namenode,ugi,delegation,username,doAsUser,fullpath,op.getValue(),-1L,-1L,bufferSize);
      return Response.temporaryRedirect(uri).type(MediaType.APPLICATION_OCTET_STREAM).build();
    }
case CONCAT:
{
    getRPCServer(namenode).concat(fullpath,concatSrcs.getAbsolutePaths());
    return Response.ok().build();
  }
default :
throw new UnsupportedOperationException(op + " is not supported");
}
}
