{
  final DatanodeInfo dn=chooseDatanode(namenode,path,op);
  final String query=op.toQueryString() + Param.toSortedString("&",parameters);
  final String uripath="/" + WebHdfsFileSystem.PATH_PREFIX + path;
  final URI uri=new URI("http",null,dn.getHostName(),dn.getInfoPort(),uripath,query,null);
  if (LOG.isTraceEnabled()) {
    LOG.trace("redirectURI=" + uri);
  }
  return uri;
}
