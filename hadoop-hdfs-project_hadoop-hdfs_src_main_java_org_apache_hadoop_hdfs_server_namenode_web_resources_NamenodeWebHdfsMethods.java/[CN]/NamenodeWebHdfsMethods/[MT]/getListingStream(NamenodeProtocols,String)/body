{
  final DirectoryListing first=getDirectoryListing(np,p,HdfsFileStatus.EMPTY_NAME);
  return new StreamingOutput(){
    @Override public void write(    final OutputStream outstream) throws IOException {
      final PrintStream out=new PrintStream(outstream);
      out.println("{\"" + HdfsFileStatus.class.getSimpleName() + "es\":{\""+ HdfsFileStatus.class.getSimpleName()+ "\":[");
      final HdfsFileStatus[] partial=first.getPartialListing();
      if (partial.length > 0) {
        out.print(JsonUtil.toJsonString(partial[0],false));
      }
      for (int i=1; i < partial.length; i++) {
        out.println(',');
        out.print(JsonUtil.toJsonString(partial[i],false));
      }
      for (DirectoryListing curr=first; curr.hasMore(); ) {
        curr=getDirectoryListing(np,p,curr.getLastName());
        for (        HdfsFileStatus s : curr.getPartialListing()) {
          out.println(',');
          out.print(JsonUtil.toJsonString(s,false));
        }
      }
      out.println();
      out.println("]}}");
    }
  }
;
}
