{
  if (LOG.isTraceEnabled()) {
    LOG.trace(op + ", " + path+ Param.toSortedString(", ",offset,length,bufferSize));
  }
  final NameNode namenode=(NameNode)context.getAttribute("name.node");
  final String fullpath=path.getAbsolutePath();
  final NamenodeProtocols np=namenode.getRpcServer();
switch (op.getValue()) {
case OPEN:
{
      final URI uri=redirectURI(namenode,fullpath,op.getValue(),offset.getValue(),offset,length,bufferSize);
      return Response.temporaryRedirect(uri).build();
    }
case GETFILESTATUS:
{
    final HdfsFileStatus status=np.getFileInfo(fullpath);
    final String js=JsonUtil.toJsonString(status);
    return Response.ok(js).type(MediaType.APPLICATION_JSON).build();
  }
case LISTSTATUS:
{
  final StreamingOutput streaming=getListingStream(np,fullpath);
  return Response.ok(streaming).type(MediaType.APPLICATION_JSON).build();
}
default :
throw new UnsupportedOperationException(op + " is not supported");
}
}
