{
  String configPrefix=authHandler.getType() + ".";
  Configuration conf=new Configuration(false);
  for (  Map.Entry entry : config.entrySet()) {
    conf.set((String)entry.getKey(),(String)entry.getValue());
  }
  String tokenKind=conf.get(TOKEN_KIND);
  if (tokenKind == null) {
    throw new IllegalArgumentException("The configuration does not define the token kind");
  }
  tokenKind=tokenKind.trim();
  long updateInterval=conf.getLong(configPrefix + UPDATE_INTERVAL,UPDATE_INTERVAL_DEFAULT);
  long maxLifeTime=conf.getLong(configPrefix + MAX_LIFETIME,MAX_LIFETIME_DEFAULT);
  long renewInterval=conf.getLong(configPrefix + RENEW_INTERVAL,RENEW_INTERVAL_DEFAULT);
  long removalScanInterval=conf.getLong(configPrefix + REMOVAL_SCAN_INTERVAL,REMOVAL_SCAN_INTERVAL_DEFAULT);
  tokenManager=new DelegationTokenManager(new Text(tokenKind),updateInterval * 1000,maxLifeTime * 1000,renewInterval * 1000,removalScanInterval * 1000);
  tokenManager.init();
}
