{
  Configuration conf=new Configuration(false);
  for (  Map.Entry entry : config.entrySet()) {
    conf.set((String)entry.getKey(),(String)entry.getValue());
  }
  String tokenKind=conf.get(TOKEN_KIND);
  if (tokenKind == null) {
    throw new IllegalArgumentException("The configuration does not define the token kind");
  }
  tokenKind=tokenKind.trim();
  tokenManager=new DelegationTokenManager(conf,new Text(tokenKind));
  tokenManager.init();
}
