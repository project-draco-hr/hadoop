{
  int requiredSize=((dataLen + bytesPerChecksum - 1) / bytesPerChecksum) * checksumSize;
  if (checksumBytes == null || requiredSize > checksumBytes.capacity()) {
    checksumBytes=ByteBuffer.wrap(new byte[requiredSize]);
  }
 else {
    checksumBytes.clear();
  }
  checksumBytes.limit(requiredSize);
}
