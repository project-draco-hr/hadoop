{
  UUID randomId=(LOG.isTraceEnabled() ? UUID.randomUUID() : null);
  LOG.trace("Starting read #{} file {} from datanode {}",randomId,filename,datanodeID.getHostName());
  if (curDataSlice == null || curDataSlice.remaining() == 0 && bytesNeededToFinish > 0) {
    TraceScope scope=tracer.newScope("RemoteBlockReader2#readNextPacket(" + blockId + ")");
    try {
      readNextPacket();
    }
  finally {
      scope.close();
    }
  }
  LOG.trace("Finishing read #{}",randomId);
  if (curDataSlice.remaining() == 0) {
    return -1;
  }
  int nRead=Math.min(curDataSlice.remaining(),len);
  curDataSlice.get(buf,off,nRead);
  return nRead;
}
