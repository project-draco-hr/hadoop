{
  if (curDataSlice == null || curDataSlice.remaining() == 0 && bytesNeededToFinish > 0) {
    TraceScope scope=tracer.newScope("RemoteBlockReader2#readNextPacket(" + blockId + ")");
    try {
      readNextPacket();
    }
  finally {
      scope.close();
    }
  }
  if (curDataSlice.remaining() == 0) {
    return -1;
  }
  int nRead=Math.min(curDataSlice.remaining(),buf.remaining());
  ByteBuffer writeSlice=curDataSlice.duplicate();
  writeSlice.limit(writeSlice.position() + nRead);
  buf.put(writeSlice);
  curDataSlice.position(writeSlice.position());
  return nRead;
}
