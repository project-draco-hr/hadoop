{
  dispatcher=new DrainDispatcher();
  this.rm=new MockRM(){
    @Override public void init(    Configuration conf){
      conf.set(CapacitySchedulerConfiguration.MAXIMUM_APPLICATION_MASTERS_RESOURCE_PERCENT,"1.0");
      super.init(conf);
    }
    @Override protected EventHandler<SchedulerEvent> createSchedulerEventDispatcher(){
      return new EventDispatcher<SchedulerEvent>(this.scheduler,this.scheduler.getClass().getName()){
        @Override public void handle(        SchedulerEvent event){
          super.handle(event);
        }
      }
;
    }
    @Override protected Dispatcher createDispatcher(){
      return dispatcher;
    }
  }
;
  rm.start();
  amService=rm.getApplicationMasterService();
}
