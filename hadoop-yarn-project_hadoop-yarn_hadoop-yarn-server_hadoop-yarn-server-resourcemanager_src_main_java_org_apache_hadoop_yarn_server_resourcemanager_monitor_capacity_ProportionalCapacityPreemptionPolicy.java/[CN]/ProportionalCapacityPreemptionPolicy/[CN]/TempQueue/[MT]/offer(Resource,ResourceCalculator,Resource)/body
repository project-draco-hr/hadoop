{
  Resource accepted=Resources.min(rc,clusterResource,Resources.subtract(maxCapacity,idealAssigned),Resources.min(rc,clusterResource,avail,Resources.subtract(Resources.add(current,pending),idealAssigned)));
  Resource remain=Resources.subtract(avail,accepted);
  Resources.addTo(idealAssigned,accepted);
  return remain;
}
