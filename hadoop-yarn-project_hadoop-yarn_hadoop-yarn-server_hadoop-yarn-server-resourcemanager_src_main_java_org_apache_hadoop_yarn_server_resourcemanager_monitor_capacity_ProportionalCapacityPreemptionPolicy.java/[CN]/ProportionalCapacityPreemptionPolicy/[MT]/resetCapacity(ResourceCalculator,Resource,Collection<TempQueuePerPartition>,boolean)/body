{
  Resource activeCap=Resource.newInstance(0,0);
  if (ignoreGuar) {
    for (    TempQueuePerPartition q : queues) {
      q.normalizedGuarantee=(float)1.0f / ((float)queues.size());
    }
  }
 else {
    for (    TempQueuePerPartition q : queues) {
      Resources.addTo(activeCap,q.guaranteed);
    }
    for (    TempQueuePerPartition q : queues) {
      q.normalizedGuarantee=Resources.divide(rc,clusterResource,q.guaranteed,activeCap);
    }
  }
}
