{
  for (  RMContainer c : skippedAMContainerlist) {
    if (Resources.lessThanOrEqual(rc,clusterResource,resToObtain,Resources.none())) {
      break;
    }
    if (Resources.lessThanOrEqual(rc,clusterResource,skippedAMSize,maxAMCapacityForThisQueue)) {
      break;
    }
    Set<RMContainer> contToPrempt=preemptMap.get(c.getApplicationAttemptId());
    if (null == contToPrempt) {
      contToPrempt=new HashSet<RMContainer>();
      preemptMap.put(c.getApplicationAttemptId(),contToPrempt);
    }
    contToPrempt.add(c);
    Resources.subtractFrom(resToObtain,c.getContainer().getResource());
    Resources.subtractFrom(skippedAMSize,c.getContainer().getResource());
  }
  skippedAMContainerlist.clear();
}
