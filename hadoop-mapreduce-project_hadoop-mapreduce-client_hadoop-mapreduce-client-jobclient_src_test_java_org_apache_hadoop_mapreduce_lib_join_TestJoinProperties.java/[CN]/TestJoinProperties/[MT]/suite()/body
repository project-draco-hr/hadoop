{
  TestSetup setup=new TestSetup(new TestSuite(TestJoinProperties.class)){
    protected void setUp() throws Exception {
      Configuration conf=new Configuration();
      cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
      base=cluster.getFileSystem().makeQualified(new Path("/nested"));
      src=generateSources(conf);
    }
    protected void tearDown() throws Exception {
      if (cluster != null) {
        cluster.shutdown();
      }
    }
  }
;
  return setup;
}
