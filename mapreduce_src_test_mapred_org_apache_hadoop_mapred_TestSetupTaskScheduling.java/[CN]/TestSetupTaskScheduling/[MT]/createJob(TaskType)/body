{
  JobConf conf=new JobConf();
  conf.setSpeculativeExecution(false);
  conf.setNumMapTasks(2);
  conf.setNumReduceTasks(2);
  conf.set(JobContext.REDUCE_FAILURES_MAXPERCENT,".70");
  conf.set(JobContext.MAP_FAILURES_MAX_PERCENT,".70");
  FakeJobInProgress job=null;
  if (taskType == null) {
    conf.setBoolean(JobContext.SETUP_CLEANUP_NEEDED,false);
    job=new FakeJobInProgress(conf,jobTracker);
  }
 else   if (taskType == TaskType.JOB_SETUP) {
    job=new FakeJobWithSetupTask(conf,jobTracker);
  }
 else   if (taskType == TaskType.TASK_CLEANUP) {
    job=new FakeJobWithTaskCleanupTask(conf,jobTracker);
  }
  job.setClusterSize(trackers.length);
  job.initTasks();
  return job;
}
