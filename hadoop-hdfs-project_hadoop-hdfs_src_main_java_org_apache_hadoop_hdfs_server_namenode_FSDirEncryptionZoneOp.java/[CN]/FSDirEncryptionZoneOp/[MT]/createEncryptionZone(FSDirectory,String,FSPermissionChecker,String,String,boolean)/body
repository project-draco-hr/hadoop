{
  final byte[][] pathComponents=FSDirectory.getPathComponentsForReservedPath(srcArg);
  final CipherSuite suite=CipherSuite.convert(cipher);
  List<XAttr> xAttrs=Lists.newArrayListWithCapacity(1);
  final String src;
  final CryptoProtocolVersion version=CryptoProtocolVersion.ENCRYPTION_ZONES;
  fsd.writeLock();
  try {
    src=fsd.resolvePath(pc,srcArg,pathComponents);
    final XAttr ezXAttr=fsd.ezManager.createEncryptionZone(src,suite,version,keyName);
    xAttrs.add(ezXAttr);
  }
  finally {
    fsd.writeUnlock();
  }
  fsd.getEditLog().logSetXAttrs(src,xAttrs,logRetryCache);
  final INodesInPath iip=fsd.getINodesInPath4Write(src,false);
  return fsd.getAuditFileInfo(iip);
}
