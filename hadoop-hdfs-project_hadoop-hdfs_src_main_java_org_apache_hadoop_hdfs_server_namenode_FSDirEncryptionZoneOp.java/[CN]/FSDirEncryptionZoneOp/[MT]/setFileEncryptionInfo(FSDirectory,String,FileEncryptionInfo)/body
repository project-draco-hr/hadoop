{
  final HdfsProtos.PerFileEncryptionInfoProto proto=PBHelperClient.convertPerFileEncInfo(info);
  final byte[] protoBytes=proto.toByteArray();
  final XAttr fileEncryptionAttr=XAttrHelper.buildXAttr(CRYPTO_XATTR_FILE_ENCRYPTION_INFO,protoBytes);
  final List<XAttr> xAttrs=Lists.newArrayListWithCapacity(1);
  xAttrs.add(fileEncryptionAttr);
  fsd.writeLock();
  try {
    FSDirXAttrOp.unprotectedSetXAttrs(fsd,src,xAttrs,EnumSet.of(XAttrSetFlag.CREATE));
  }
  finally {
    fsd.writeUnlock();
  }
}
