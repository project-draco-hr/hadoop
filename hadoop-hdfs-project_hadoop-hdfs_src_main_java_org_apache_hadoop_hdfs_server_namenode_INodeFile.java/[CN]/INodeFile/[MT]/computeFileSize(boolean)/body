{
  if (blocks == null || blocks.length == 0) {
    return 0;
  }
  final int last=blocks.length - 1;
  long bytes=blocks[last] instanceof BlockInfoUnderConstruction && !includesBlockInfoUnderConstruction ? 0 : blocks[last].getNumBytes();
  for (int i=0; i < last; i++) {
    bytes+=blocks[i].getNumBytes();
  }
  return bytes;
}
