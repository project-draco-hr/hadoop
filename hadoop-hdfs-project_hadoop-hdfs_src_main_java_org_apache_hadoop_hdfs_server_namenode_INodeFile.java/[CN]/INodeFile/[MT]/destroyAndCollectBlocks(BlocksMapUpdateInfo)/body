{
  int total=1;
  if (blocks != null && collectedBlocks != null) {
    for (    BlockInfo blk : blocks) {
      collectedBlocks.addDeleteBlock(blk);
      blk.setBlockCollection(null);
    }
  }
  setBlocks(null);
  clearReferences();
  if (this instanceof FileWithSnapshot) {
    total+=((FileWithSnapshot)this).getDiffs().clear();
  }
  return total;
}
