{
  QuotaCounts counts=new QuotaCounts.Builder().build();
  if (blocks == null || blocks.length == 0) {
    return counts;
  }
  for (  BlockInfo b : blocks) {
    Preconditions.checkState(b.isStriped());
    long blockSize=b.isComplete() ? ((BlockInfoStriped)b).spaceConsumed() : getPreferredBlockSize() * ((BlockInfoStriped)b).getTotalBlockNum();
    counts.addStorageSpace(blockSize);
  }
  return counts;
}
