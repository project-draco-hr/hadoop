{
  FileWithSnapshotFeature sf=getFileWithSnapshotFeature();
  if (sf != null) {
    return sf.cleanFile(reclaimContext,this,snapshot,priorSnapshotId);
  }
  QuotaCounts counts=new QuotaCounts.Builder().build();
  if (snapshot == CURRENT_STATE_ID) {
    if (priorSnapshotId == NO_SNAPSHOT_ID) {
      computeQuotaUsage(reclaimContext.bsps,counts,false);
      destroyAndCollectBlocks(reclaimContext);
    }
 else {
      FileUnderConstructionFeature uc=getFileUnderConstructionFeature();
      if (uc != null) {
        uc.cleanZeroSizeBlock(this,reclaimContext.collectedBlocks);
        if (reclaimContext.removedUCFiles != null) {
          reclaimContext.removedUCFiles.add(getId());
        }
      }
    }
  }
  return counts;
}
