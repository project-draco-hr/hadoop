{
  while (multimap.size() != 0) {
    Iterator<Entry<DatanodeID,Value>> iter=multimap.entries().iterator();
    Entry<DatanodeID,Value> entry=iter.next();
    if (entry == null || Time.monotonicNow() - entry.getValue().getTime() < expiryPeriod) {
      break;
    }
    IOUtils.cleanup(LOG,entry.getValue().getPeer());
    iter.remove();
  }
}
