{
  Server server=new RPC.Builder(conf).setProtocol(TestProtocol.class).setInstance(new TestImpl()).setBindAddress(ADDRESS).setPort(0).setNumHandlers(5).setVerbose(true).build();
  InetSocketAddress bindAddr=null;
  try {
    bindAddr=NetUtils.getConnectAddress(server);
  }
  finally {
    server.stop();
  }
  assertEquals(InetAddress.getLocalHost(),bindAddr.getAddress());
}
