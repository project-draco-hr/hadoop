{
  DistributedFileSystem dfs=null;
  try {
    final URI uri=new URI(SCHEME + "://" + token.getService().toString());
    dfs=UserGroupInformation.getLoginUser().doAs(new PrivilegedExceptionAction<DistributedFileSystem>(){
      public DistributedFileSystem run() throws IOException {
        return (DistributedFileSystem)FileSystem.get(uri,conf);
      }
    }
);
  }
 catch (  Exception e) {
    LOG.warn("Failed to create a dfs to renew/cancel for:" + token.getService(),e);
    throw e;
  }
  return dfs;
}
