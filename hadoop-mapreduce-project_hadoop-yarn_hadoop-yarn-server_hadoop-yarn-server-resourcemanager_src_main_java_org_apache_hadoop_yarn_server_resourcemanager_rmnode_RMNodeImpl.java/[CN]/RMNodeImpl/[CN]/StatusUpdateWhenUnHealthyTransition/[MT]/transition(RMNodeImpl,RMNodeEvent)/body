{
  RMNodeStatusEvent statusEvent=(RMNodeStatusEvent)event;
  rmNode.latestHeartBeatResponse=statusEvent.getLatestResponse();
  NodeHealthStatus remoteNodeHealthStatus=statusEvent.getNodeHealthStatus();
  rmNode.setNodeHealthStatus(remoteNodeHealthStatus);
  if (remoteNodeHealthStatus.getIsNodeHealthy()) {
    rmNode.context.getDispatcher().getEventHandler().handle(new NodeAddedSchedulerEvent(rmNode));
    ClusterMetrics.getMetrics().decrNumUnhealthyNMs();
    return RMNodeState.RUNNING;
  }
  return RMNodeState.UNHEALTHY;
}
