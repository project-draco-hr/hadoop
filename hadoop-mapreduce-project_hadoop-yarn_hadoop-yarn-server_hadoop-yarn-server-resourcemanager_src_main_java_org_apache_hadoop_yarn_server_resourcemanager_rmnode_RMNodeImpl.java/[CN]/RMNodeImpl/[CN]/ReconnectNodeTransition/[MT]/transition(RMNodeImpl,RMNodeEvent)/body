{
  rmNode.context.getDispatcher().getEventHandler().handle(new NodeRemovedSchedulerEvent(rmNode));
  RMNode newNode=((RMNodeReconnectEvent)event).getReconnectedNode();
  if (rmNode.getTotalCapability().equals(newNode.getTotalCapability()) && rmNode.getHttpPort() == newNode.getHttpPort()) {
    rmNode.getLastHeartBeatResponse().setResponseId(0);
    rmNode.context.getDispatcher().getEventHandler().handle(new NodeAddedSchedulerEvent(rmNode));
  }
 else {
switch (rmNode.getState()) {
case RUNNING:
      ClusterMetrics.getMetrics().decrNumActiveNodes();
    break;
case UNHEALTHY:
  ClusterMetrics.getMetrics().decrNumUnhealthyNMs();
break;
}
rmNode.context.getRMNodes().put(newNode.getNodeID(),newNode);
rmNode.context.getDispatcher().getEventHandler().handle(new RMNodeEvent(newNode.getNodeID(),RMNodeEventType.STARTED));
}
}
