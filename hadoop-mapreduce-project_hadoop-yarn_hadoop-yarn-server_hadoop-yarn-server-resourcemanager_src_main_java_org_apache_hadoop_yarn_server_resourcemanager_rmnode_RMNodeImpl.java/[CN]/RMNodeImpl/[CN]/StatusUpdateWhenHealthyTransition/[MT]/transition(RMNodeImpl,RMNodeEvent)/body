{
  RMNodeStatusEvent statusEvent=(RMNodeStatusEvent)event;
  rmNode.latestHeartBeatResponse=statusEvent.getLatestResponse();
  NodeHealthStatus remoteNodeHealthStatus=statusEvent.getNodeHealthStatus();
  rmNode.setNodeHealthStatus(remoteNodeHealthStatus);
  if (!remoteNodeHealthStatus.getIsNodeHealthy()) {
    rmNode.context.getDispatcher().getEventHandler().handle(new NodeRemovedSchedulerEvent(rmNode));
    return RMNodeState.UNHEALTHY;
  }
  List<ContainerStatus> newlyLaunchedContainers=new ArrayList<ContainerStatus>();
  List<ContainerStatus> completedContainers=new ArrayList<ContainerStatus>();
  for (  ContainerStatus remoteContainer : statusEvent.getContainers()) {
    ContainerId containerId=remoteContainer.getContainerId();
    if (remoteContainer.getState() == ContainerState.RUNNING) {
      if (!rmNode.justLaunchedContainers.containsKey(containerId)) {
        rmNode.justLaunchedContainers.put(containerId,remoteContainer);
        newlyLaunchedContainers.add(remoteContainer);
      }
    }
 else {
      rmNode.justLaunchedContainers.remove(containerId);
      completedContainers.add(remoteContainer);
    }
  }
  rmNode.context.getDispatcher().getEventHandler().handle(new NodeUpdateSchedulerEvent(rmNode,newlyLaunchedContainers,completedContainers));
  return RMNodeState.RUNNING;
}
