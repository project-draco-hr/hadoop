{
  if (protocol != null) {
    throw new HadoopIllegalArgumentException("Redundant -protocol command");
  }
  if (index + 1 >= args.length) {
    throw new HadoopIllegalArgumentException("-protocol needs one parameter");
  }
  protocol=args[index + 1];
  if (!isValidProtocol(protocol)) {
    throw new HadoopIllegalArgumentException("Invalid protocol: " + protocol);
  }
  return index + 2;
}
