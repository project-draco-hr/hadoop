{
  List<NodeLabel> nodeLabels=new ArrayList<>();
  for (  String p : args.split(",")) {
    if (!p.trim().isEmpty()) {
      String labelName=p;
      boolean exclusive=NodeLabel.DEFAULT_NODE_LABEL_EXCLUSIVITY;
      int leftParenthesisIdx=p.indexOf("(");
      int rightParenthesisIdx=p.indexOf(")");
      if ((leftParenthesisIdx == -1 && rightParenthesisIdx != -1) || (leftParenthesisIdx != -1 && rightParenthesisIdx == -1)) {
        throw new IllegalArgumentException(ADD_LABEL_FORMAT_ERR_MSG);
      }
      if (leftParenthesisIdx > 0 && rightParenthesisIdx > 0) {
        if (leftParenthesisIdx > rightParenthesisIdx) {
          throw new IllegalArgumentException(ADD_LABEL_FORMAT_ERR_MSG);
        }
        String property=p.substring(p.indexOf("(") + 1,p.indexOf(")"));
        if (property.contains("=")) {
          String key=property.substring(0,property.indexOf("=")).trim();
          String value=property.substring(property.indexOf("=") + 1,property.length()).trim();
          if (key.equals("exclusive") && ImmutableSet.of("true","false").contains(value)) {
            exclusive=Boolean.parseBoolean(value);
          }
 else {
            throw new IllegalArgumentException(ADD_LABEL_FORMAT_ERR_MSG);
          }
        }
 else         if (!property.trim().isEmpty()) {
          throw new IllegalArgumentException(ADD_LABEL_FORMAT_ERR_MSG);
        }
      }
      if (labelName.contains("(")) {
        labelName=labelName.substring(0,labelName.indexOf("(")).trim();
      }
      nodeLabels.add(NodeLabel.newInstance(labelName,exclusive));
    }
  }
  if (nodeLabels.isEmpty()) {
    throw new IllegalArgumentException(NO_LABEL_ERR_MSG);
  }
  return nodeLabels;
}
