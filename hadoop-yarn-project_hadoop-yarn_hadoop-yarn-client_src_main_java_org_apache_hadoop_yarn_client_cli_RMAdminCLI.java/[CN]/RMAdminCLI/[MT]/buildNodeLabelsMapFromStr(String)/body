{
  Map<NodeId,Set<String>> map=new HashMap<NodeId,Set<String>>();
  for (  String nodeToLabels : args.split("[ \n]")) {
    nodeToLabels=nodeToLabels.trim();
    if (nodeToLabels.isEmpty() || nodeToLabels.startsWith("#")) {
      continue;
    }
    String[] splits=nodeToLabels.split("=");
    int index=0;
    if (splits.length != 2) {
      splits=nodeToLabels.split(",");
      index=1;
    }
    String nodeIdStr=splits[0];
    if (index == 0) {
      splits=splits[1].split(",");
    }
    Preconditions.checkArgument(!nodeIdStr.trim().isEmpty(),"node name cannot be empty");
    NodeId nodeId=ConverterUtils.toNodeIdWithDefaultPort(nodeIdStr);
    map.put(nodeId,new HashSet<String>());
    for (int i=index; i < splits.length; i++) {
      if (!splits[i].trim().isEmpty()) {
        map.get(nodeId).add(splits[i].trim());
      }
    }
    int nLabels=map.get(nodeId).size();
    Preconditions.checkArgument(nLabels <= 1,"%d labels specified on host=%s" + ", please note that we do not support specifying multiple" + " labels on a single host for now.",nLabels,nodeIdStr);
  }
  if (map.isEmpty()) {
    throw new IllegalArgumentException(NO_MAPPING_ERR_MSG);
  }
  return map;
}
