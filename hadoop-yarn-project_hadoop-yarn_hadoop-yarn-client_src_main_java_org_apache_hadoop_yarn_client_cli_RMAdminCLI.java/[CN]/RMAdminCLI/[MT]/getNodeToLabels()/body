{
  Map<NodeId,Set<String>> nodeToLabels=null;
  if (directlyAccessNodeLabelStore) {
    nodeToLabels=getNodeLabelManagerInstance(getConf()).getNodeLabels();
  }
 else {
    ResourceManagerAdministrationProtocol adminProtocol=createAdminProtocol();
    nodeToLabels=adminProtocol.getNodeToLabels(GetNodesToLabelsRequest.newInstance()).getNodeToLabels();
  }
  for (  NodeId host : sortNodeIdSet(nodeToLabels.keySet())) {
    System.out.println(String.format("Host=%s, Node-labels=[%s]",(host.getPort() == 0 ? host.getHost() : host.toString()),StringUtils.join(sortStrSet(nodeToLabels.get(host)),",")));
  }
  return 0;
}
