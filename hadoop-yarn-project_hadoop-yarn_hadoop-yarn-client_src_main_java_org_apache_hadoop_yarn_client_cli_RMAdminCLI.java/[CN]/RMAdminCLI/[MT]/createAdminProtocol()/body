{
  final YarnConfiguration conf=new YarnConfiguration(getConf());
  final InetSocketAddress addr=conf.getSocketAddr(YarnConfiguration.RM_ADMIN_ADDRESS,YarnConfiguration.DEFAULT_RM_ADMIN_ADDRESS,YarnConfiguration.DEFAULT_RM_ADMIN_PORT);
  final YarnRPC rpc=YarnRPC.create(conf);
  ResourceManagerAdministrationProtocol adminProtocol=getUGI(conf).doAs(new PrivilegedAction<ResourceManagerAdministrationProtocol>(){
    @Override public ResourceManagerAdministrationProtocol run(){
      return (ResourceManagerAdministrationProtocol)rpc.getProxy(ResourceManagerAdministrationProtocol.class,addr,conf);
    }
  }
);
  return adminProtocol;
}
