{
  if (directlyAccessNodeLabelStore) {
    getNodeLabelManagerInstance(getConf()).replaceLabelsOnNode(map);
  }
 else {
    ResourceManagerAdministrationProtocol adminProtocol=createAdminProtocol();
    ReplaceLabelsOnNodeRequest request=ReplaceLabelsOnNodeRequest.newInstance(map);
    adminProtocol.replaceLabelsOnNode(request);
  }
  return 0;
}
