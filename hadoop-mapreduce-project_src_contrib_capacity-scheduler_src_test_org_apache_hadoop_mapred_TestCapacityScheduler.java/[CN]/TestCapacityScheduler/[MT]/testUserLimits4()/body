{
  String[] qs={"default"};
  taskTrackerManager.addQueues(qs);
  ArrayList<FakeQueueInfo> queues=new ArrayList<FakeQueueInfo>();
  queues.add(new FakeQueueInfo("default",100.0f,true,25));
  taskTrackerManager.setFakeQueues(queues);
  scheduler.start();
  taskTrackerManager.addTaskTracker("tt3");
  taskTrackerManager.addTaskTracker("tt4");
  taskTrackerManager.addTaskTracker("tt5");
  FakeJobInProgress j1=taskTrackerManager.submitJobAndInit(JobStatus.PREP,10,10,null,"u1");
  Map<String,String> expectedTaskStrings=new HashMap<String,String>();
  for (int i=0; i < 5; i++) {
    String ttName="tt" + (i + 1);
    populateExpectedStrings(expectedTaskStrings,"attempt_test_0001_m_00000" + (i + 1) + "_0 on "+ ttName,"attempt_test_0001_r_00000" + (i + 1) + "_0 on "+ ttName);
    checkMultipleTaskAssignment(taskTrackerManager,scheduler,ttName,expectedTaskStrings);
  }
  FakeJobInProgress j2=taskTrackerManager.submitJobAndInit(JobStatus.PREP,4,4,null,"u2");
  for (int i=0; i < 4; i++) {
    String ttName="tt" + (i + 1);
    checkAssignment(taskTrackerManager,scheduler,ttName,"attempt_test_0002_m_00000" + (i + 1) + "_0 on "+ ttName);
  }
  checkAssignment(taskTrackerManager,scheduler,"tt5","attempt_test_0001_m_000006_0 on tt5");
  taskTrackerManager.finishTask("attempt_test_0001_m_000006_0",j1);
  taskTrackerManager.finishTask("attempt_test_0001_r_000005_0",j1);
  taskTrackerManager.submitJobAndInit(JobStatus.PREP,10,10,null,"u1");
  taskTrackerManager.submitJobAndInit(JobStatus.PREP,10,10,null,"u1");
  taskTrackerManager.submitJobAndInit(JobStatus.PREP,10,10,null,"u1");
  taskTrackerManager.submitJobAndInit(JobStatus.PREP,10,10,null,"u2");
  taskTrackerManager.submitJobAndInit(JobStatus.PREP,2,2,null,"u3");
  populateExpectedStrings(expectedTaskStrings,"attempt_test_0007_m_000001_0 on tt5","attempt_test_0002_r_000001_0 on tt5");
  checkMultipleTaskAssignment(taskTrackerManager,scheduler,"tt5",expectedTaskStrings);
  taskTrackerManager.finishTask("attempt_test_0002_m_000004_0",j1);
  checkAssignment(taskTrackerManager,scheduler,"tt4","attempt_test_0007_m_000002_0 on tt4");
  taskTrackerManager.finishTask("attempt_test_0002_m_000002_0",j1);
  checkAssignment(taskTrackerManager,scheduler,"tt2","attempt_test_0001_m_000007_0 on tt2");
}
