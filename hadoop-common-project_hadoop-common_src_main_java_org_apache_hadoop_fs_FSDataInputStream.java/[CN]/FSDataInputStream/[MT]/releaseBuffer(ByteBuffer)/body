{
  try {
    ((HasEnhancedByteBufferAccess)in).releaseBuffer(buffer);
  }
 catch (  ClassCastException e) {
    ByteBufferPool bufferPool=extendedReadBuffers.remove(buffer);
    if (bufferPool == null) {
      throw new IllegalArgumentException("tried to release a buffer " + "that was not created by this stream.");
    }
    bufferPool.putBuffer(buffer);
  }
}
