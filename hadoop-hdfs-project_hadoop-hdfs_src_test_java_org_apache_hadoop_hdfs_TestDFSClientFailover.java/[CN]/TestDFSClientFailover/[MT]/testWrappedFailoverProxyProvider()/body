{
  Configuration config=new HdfsConfiguration(conf);
  String logicalName=HATestUtil.getLogicalHostname(cluster);
  HATestUtil.setFailoverConfigurations(cluster,config,logicalName);
  config.set(DFS_CLIENT_FAILOVER_PROXY_PROVIDER_KEY_PREFIX + "." + logicalName,DummyLegacyFailoverProxyProvider.class.getName());
  Path p=new Path("hdfs://" + logicalName + "/");
  SecurityUtil.setTokenServiceUseIp(false);
  assertTrue("Legacy proxy providers should use logical URI.",HAUtil.useLogicalUri(config,p.toUri()));
}
