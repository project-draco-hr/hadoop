{
  namesystem.writeLock();
  try {
    bm.getDatanodeManager().getHeartbeatManager().heartbeatCheck();
    return bm.getUnderReplicatedNotMissingBlocks();
  }
  finally {
    namesystem.writeUnlock();
  }
}
