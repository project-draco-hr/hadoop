{
  final BlockManager bm=namesystem.getBlockManager();
  namesystem.readLock();
  try {
    final BlockInfo storedBlock=bm.getStoredBlock(b);
    return new int[]{getNumberOfRacks(bm,b),bm.countNodes(storedBlock).liveReplicas(),bm.neededReplications.contains(storedBlock) ? 1 : 0};
  }
  finally {
    namesystem.readUnlock();
  }
}
