{
  final BlockManager bm=namesystem.getBlockManager();
  namesystem.readLock();
  try {
    return new int[]{getNumberOfRacks(bm,b),bm.countNodes(b).liveReplicas(),bm.neededReplications.contains(b) ? 1 : 0};
  }
  finally {
    namesystem.readUnlock();
  }
}
