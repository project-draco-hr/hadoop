{
  try {
    boolean ssl=keyStore != null;
    String host="localhost";
    Server server=new Server(inPort);
    if (!ssl) {
      server.getConnectors()[0].setHost(host);
    }
 else {
      SslSocketConnector c=new SslSocketConnectorSecure();
      c.setHost(host);
      c.setNeedClientAuth(false);
      c.setKeystore(keyStore);
      c.setKeystoreType("jks");
      c.setKeyPassword(password);
      server.setConnectors(new Connector[]{c});
    }
    return server;
  }
 catch (  Exception ex) {
    throw new RuntimeException("Could not start embedded servlet container, " + ex.getMessage(),ex);
  }
}
