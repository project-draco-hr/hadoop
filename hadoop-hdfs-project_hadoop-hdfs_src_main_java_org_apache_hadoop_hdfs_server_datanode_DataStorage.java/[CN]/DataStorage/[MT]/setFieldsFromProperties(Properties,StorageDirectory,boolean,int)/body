{
  if (overrideLayoutVersion) {
    this.layoutVersion=toLayoutVersion;
  }
 else {
    setLayoutVersion(props,sd);
  }
  setcTime(props,sd);
  setStorageType(props,sd);
  setClusterId(props,layoutVersion,sd);
  if (!LayoutVersion.supports(Feature.FEDERATION,layoutVersion)) {
    setNamespaceID(props,sd);
  }
  String ssid=props.getProperty("storageID");
  if (ssid == null) {
    throw new InconsistentFSStateException(sd.getRoot(),"file " + STORAGE_FILE_VERSION + " is invalid.");
  }
  String sid=getStorageID();
  if (!(sid.equals("") || ssid.equals("") || sid.equals(ssid))) {
    throw new InconsistentFSStateException(sd.getRoot(),"has incompatible storage Id.");
  }
  if (sid.equals("")) {
    setStorageID(ssid);
  }
}
