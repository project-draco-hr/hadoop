{
  if (this.initialized) {
    LOG.info("DataNode version: " + HdfsConstants.DATANODE_LAYOUT_VERSION + " and NameNode layout version: "+ nsInfo.getLayoutVersion());
    this.storageDirs=new ArrayList<StorageDirectory>(dataDirs.size());
    this.initialized=true;
  }
  if (addStorageLocations(datanode,nsInfo,dataDirs,startOpt).isEmpty()) {
    throw new IOException("All specified directories are failed to load.");
  }
}
