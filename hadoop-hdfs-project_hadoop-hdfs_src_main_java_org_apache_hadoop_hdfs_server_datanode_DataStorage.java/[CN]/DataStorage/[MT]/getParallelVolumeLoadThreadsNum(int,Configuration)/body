{
  final String key=DFSConfigKeys.DFS_DATANODE_PARALLEL_VOLUME_LOAD_THREADS_NUM_KEY;
  final int n=conf.getInt(key,dataDirs);
  if (n < 1) {
    throw new HadoopIllegalArgumentException(key + " = " + n+ " < 1");
  }
  final int min=Math.min(n,dataDirs);
  LOG.info("Using " + min + " threads to upgrade data directories ("+ key+ "="+ n+ ", dataDirs="+ dataDirs+ ")");
  return min;
}
