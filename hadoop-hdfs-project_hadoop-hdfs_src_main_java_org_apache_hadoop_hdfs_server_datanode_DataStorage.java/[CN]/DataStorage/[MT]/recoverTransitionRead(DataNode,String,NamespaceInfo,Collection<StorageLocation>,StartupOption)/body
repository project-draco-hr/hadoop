{
  recoverTransitionRead(datanode,nsInfo,dataDirs,startOpt);
  Collection<File> bpDataDirs=new ArrayList<File>();
  for (Iterator<StorageLocation> it=dataDirs.iterator(); it.hasNext(); ) {
    File dnRoot=it.next().getFile();
    File bpRoot=BlockPoolSliceStorage.getBpRoot(bpID,new File(dnRoot,STORAGE_DIR_CURRENT));
    bpDataDirs.add(bpRoot);
  }
  makeBlockPoolDataDir(bpDataDirs,null);
  BlockPoolSliceStorage bpStorage=new BlockPoolSliceStorage(nsInfo.getNamespaceID(),bpID,nsInfo.getCTime(),nsInfo.getClusterID());
  bpStorage.recoverTransitionRead(datanode,nsInfo,bpDataDirs,startOpt);
  addBlockPoolStorage(bpID,bpStorage);
}
