{
  final List<StorageLocation> success=Lists.newArrayList();
  for (  StorageLocation dataDir : dataDirs) {
    File root=dataDir.getFile();
    if (!containsStorageDir(root)) {
      try {
        final StorageDirectory sd=loadStorageDirectory(datanode,nsInfo,root,startOpt);
        addStorageDir(sd);
      }
 catch (      IOException e) {
        LOG.warn("Failed to add storage directory " + dataDir,e);
        continue;
      }
    }
 else {
      LOG.info("Storage directory " + dataDir + " has already been used.");
    }
    success.add(dataDir);
  }
  return success;
}
