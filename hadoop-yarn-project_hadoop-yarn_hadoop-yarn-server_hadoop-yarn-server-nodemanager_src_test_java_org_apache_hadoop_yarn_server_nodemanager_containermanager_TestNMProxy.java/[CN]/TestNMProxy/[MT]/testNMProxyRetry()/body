{
  conf.setLong(YarnConfiguration.CLIENT_NM_CONNECT_MAX_WAIT_MS,10000);
  conf.setLong(YarnConfiguration.CLIENT_NM_CONNECT_RETRY_INTERVAL_MS,100);
  StartContainersRequest allRequests=Records.newRecord(StartContainersRequest.class);
  ContainerManagementProtocol proxy=getNMProxy(conf);
  retryCount=0;
  shouldThrowNMNotYetReadyException=false;
  proxy.startContainers(allRequests);
  Assert.assertEquals(5,retryCount);
  retryCount=0;
  shouldThrowNMNotYetReadyException=false;
  proxy.stopContainers(Records.newRecord(StopContainersRequest.class));
  Assert.assertEquals(5,retryCount);
  retryCount=0;
  shouldThrowNMNotYetReadyException=false;
  proxy.getContainerStatuses(Records.newRecord(GetContainerStatusesRequest.class));
  Assert.assertEquals(5,retryCount);
  retryCount=0;
  shouldThrowNMNotYetReadyException=true;
  proxy.startContainers(allRequests);
  Assert.assertEquals(5,retryCount);
}
