{
  List<String> args=new ArrayList<String>();
  for (  Map.Entry<String,String> entry : mr.createJobConf()) {
    args.add("-jobconf");
    args.add(entry.getKey() + "=" + entry.getValue());
  }
  String[] argv=new String[]{"-input",inputPath.toString(),"-output",outputPath.toString(),"-mapper",map,"-reducer",StreamJob.REDUCE_NONE,"-jobconf","mapred.map.tasks=1","-jobconf","keep.failed.task.files=true","-jobconf","mapreduce.task.userlog.limit.kb=" + USERLOG_LIMIT_KB,"-jobconf","stream.tmpdir=" + System.getProperty("test.build.data","/tmp"),"-jobconf","mapred.jar=" + TestStreaming.STREAMING_JAR};
  for (  String arg : argv) {
    args.add(arg);
  }
  argv=args.toArray(new String[args.size()]);
  return argv;
}
