{
  Server server=new TestServer(1,false);
  InetSocketAddress addr=NetUtils.getConnectAddress(server);
  server.start();
  Client client=new Client(LongRTEWritable.class,conf);
  try {
    client.call(new LongRTEWritable(RANDOM.nextLong()),addr,null,null);
    fail("Expected an exception to have been thrown");
  }
 catch (  IOException e) {
    Throwable cause=e.getCause();
    assertTrue(cause instanceof IOException);
    Throwable cause2=cause.getCause();
    assertTrue(cause2 instanceof RuntimeException);
    assertEquals(LongRTEWritable.ERR_MSG,cause2.getMessage());
  }
}
