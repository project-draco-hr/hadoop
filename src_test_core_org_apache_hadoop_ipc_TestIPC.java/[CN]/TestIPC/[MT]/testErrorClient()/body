{
  Server server=new TestServer(1,false);
  InetSocketAddress addr=NetUtils.getConnectAddress(server);
  server.start();
  Client client=new Client(LongErrorWritable.class,conf);
  try {
    client.call(new LongErrorWritable(RANDOM.nextLong()),addr,null,null,0);
    fail("Expected an exception to have been thrown");
  }
 catch (  IOException e) {
    Throwable cause=e.getCause();
    assertTrue(cause instanceof IOException);
    assertEquals(LongErrorWritable.ERR_MSG,cause.getMessage());
  }
}
