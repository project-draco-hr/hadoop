{
  org.apache.log4j.Logger.getRootLogger().setLevel(org.apache.log4j.Level.DEBUG);
  conf=new CapacitySchedulerConfiguration(new Configuration(false));
  conf.setLong(CapacitySchedulerConfiguration.PREEMPTION_WAIT_TIME_BEFORE_KILL,10000);
  conf.setLong(CapacitySchedulerConfiguration.PREEMPTION_MONITORING_INTERVAL,3000);
  conf.setFloat(CapacitySchedulerConfiguration.TOTAL_PREEMPTION_PER_ROUND,(float)1.0);
  conf.setFloat(CapacitySchedulerConfiguration.PREEMPTION_NATURAL_TERMINATION_FACTOR,(float)1.0);
  mClock=mock(Clock.class);
  cs=mock(CapacityScheduler.class);
  when(cs.getResourceCalculator()).thenReturn(rc);
  when(cs.getPreemptionManager()).thenReturn(new PreemptionManager());
  when(cs.getConfiguration()).thenReturn(conf);
  nlm=mock(RMNodeLabelsManager.class);
  mDisp=mock(EventHandler.class);
  rmContext=mock(RMContext.class);
  when(rmContext.getNodeLabelManager()).thenReturn(nlm);
  Dispatcher disp=mock(Dispatcher.class);
  when(rmContext.getDispatcher()).thenReturn(disp);
  when(disp.getEventHandler()).thenReturn(mDisp);
  when(cs.getRMContext()).thenReturn(rmContext);
  partitionToResource=new HashMap<>();
  nodeIdToSchedulerNodes=new HashMap<>();
  nameToCSQueues=new HashMap<>();
}
