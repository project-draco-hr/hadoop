{
  String[] partitionConfigArr=nodeLabelsConfigStr.split(";");
  clusterResource=Resources.createResource(0);
  for (  String p : partitionConfigArr) {
    String partitionName=p.substring(0,p.indexOf("="));
    Resource res=parseResourceFromString(p.substring(p.indexOf("=") + 1,p.indexOf(",")));
    boolean exclusivity=Boolean.valueOf(p.substring(p.indexOf(",") + 1,p.length()));
    when(nlm.getResourceByLabel(eq(partitionName),any(Resource.class))).thenReturn(res);
    when(nlm.isExclusiveNodeLabel(eq(partitionName))).thenReturn(exclusivity);
    partitionToResource.put(partitionName,res);
    LOG.debug("add partition=" + partitionName + " totalRes="+ res+ " exclusivity="+ exclusivity);
    Resources.addTo(clusterResource,res);
  }
  when(nlm.getClusterNodeLabelNames()).thenReturn(partitionToResource.keySet());
}
