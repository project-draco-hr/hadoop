{
  req.setResponseId(++responseId);
  try {
    return ugi.doAs(new PrivilegedExceptionAction<AllocateResponse>(){
      @Override public AllocateResponse run() throws Exception {
        return amRMProtocol.allocate(req);
      }
    }
);
  }
 catch (  UndeclaredThrowableException e) {
    throw (Exception)e.getCause();
  }
}
