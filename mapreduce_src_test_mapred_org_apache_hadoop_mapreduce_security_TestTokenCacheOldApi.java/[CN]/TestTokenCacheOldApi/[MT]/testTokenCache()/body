{
  jConf=mrCluster.createJobConf();
  NameNode nn=dfsCluster.getNameNode();
  URI nnUri=NameNode.getUri(nn.getNameNodeAddress());
  jConf.set(JobContext.JOB_NAMENODES,nnUri + "," + nnUri.toString());
  jConf.set(JobTracker.JT_USER_NAME,"jt_id");
  String[] args={"-tokenCacheFile",tokenFileName.toString(),"-m","1","-r","1","-mt","1","-rt","1"};
  int res=-1;
  try {
    res=ToolRunner.run(jConf,new MyDummyJob(),args);
  }
 catch (  Exception e) {
    System.out.println("Job failed with" + e.getLocalizedMessage());
    e.printStackTrace(System.out);
    Assert.fail("Job failed");
  }
  assertEquals("dist job res is not 0",res,0);
}
