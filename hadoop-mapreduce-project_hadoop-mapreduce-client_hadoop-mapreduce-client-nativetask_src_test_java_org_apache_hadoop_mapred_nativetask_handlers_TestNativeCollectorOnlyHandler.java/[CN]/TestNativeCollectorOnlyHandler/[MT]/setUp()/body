{
  this.nativeHandler=Mockito.mock(INativeHandler.class);
  this.pusher=Mockito.mock(BufferPusher.class);
  this.combiner=Mockito.mock(ICombineHandler.class);
  JobConf jobConf=new JobConf();
  jobConf.set(OutputUtil.NATIVE_TASK_OUTPUT_MANAGER,"org.apache.hadoop.mapred.nativetask.util.LocalJobOutputFiles");
  jobConf.set("mapred.local.dir",LOCAL_DIR);
  this.taskContext=new TaskContext(jobConf,BytesWritable.class,BytesWritable.class,BytesWritable.class,BytesWritable.class,null,null);
  Mockito.when(nativeHandler.getInputBuffer()).thenReturn(new InputBuffer(BufferType.HEAP_BUFFER,100));
}
