{
  TimelineEntities te=new TimelineEntities();
  TimelineEntity entity=new TimelineEntity();
  String id="hello";
  String type="world";
  entity.setId(id);
  entity.setType(type);
  entity.setCreatedTime(1425016501000L);
  entity.setModifiedTime(1425016502000L);
  te.addEntity(entity);
  try (FileSystemTimelineWriterImpl fsi=new FileSystemTimelineWriterImpl()){
    fsi.serviceInit(new Configuration());
    fsi.write(te);
    String fileName=fsi.getOutputRoot() + "/" + type+ "/"+ id+ FileSystemTimelineWriterImpl.TIMELINE_SERVICE_STORAGE_EXTENSION;
    Path path=Paths.get(fileName);
    File f=new File(fileName);
    assertTrue(f.exists() && !f.isDirectory());
    List<String> data=Files.readAllLines(path,StandardCharsets.UTF_8);
    assertTrue(data.size() == 2);
    String d=data.get(0);
    assertEquals(d,TimelineUtils.dumpTimelineRecordtoJSON(entity));
    File outputDir=new File(fsi.getOutputRoot());
    FileUtils.deleteDirectory(outputDir);
    assertTrue(!(f.exists()));
  }
 }
