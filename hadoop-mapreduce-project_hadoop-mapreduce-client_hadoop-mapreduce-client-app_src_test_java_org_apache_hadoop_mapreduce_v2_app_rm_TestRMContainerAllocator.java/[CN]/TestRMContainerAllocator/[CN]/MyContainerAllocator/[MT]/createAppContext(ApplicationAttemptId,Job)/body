{
  AppContext context=mock(AppContext.class);
  ApplicationId appId=appAttemptId.getApplicationId();
  when(context.getApplicationID()).thenReturn(appId);
  when(context.getApplicationAttemptId()).thenReturn(appAttemptId);
  when(context.getJob(isA(JobId.class))).thenReturn(job);
  when(context.getClock()).thenReturn(new ControlledClock());
  when(context.getClusterInfo()).thenReturn(new ClusterInfo(Resource.newInstance(10240,1)));
  when(context.getEventHandler()).thenReturn(new EventHandler(){
    @Override public void handle(    Event event){
      if (event instanceof TaskAttemptContainerAssignedEvent) {
        events.add((TaskAttemptContainerAssignedEvent)event);
      }
 else       if (event instanceof TaskAttemptKillEvent) {
        taskAttemptKillEvents.add((TaskAttemptKillEvent)event);
      }
 else       if (event instanceof JobUpdatedNodesEvent) {
        jobUpdatedNodeEvents.add((JobUpdatedNodesEvent)event);
      }
 else       if (event instanceof JobEvent) {
        jobEvents.add((JobEvent)event);
      }
    }
  }
);
  return context;
}
