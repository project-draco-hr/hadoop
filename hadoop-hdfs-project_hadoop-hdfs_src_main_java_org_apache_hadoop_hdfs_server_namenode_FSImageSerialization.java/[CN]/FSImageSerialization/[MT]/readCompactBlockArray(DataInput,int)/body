{
  int num=WritableUtils.readVInt(in);
  if (num < 0) {
    throw new IOException("Invalid block array length: " + num);
  }
  Block prev=null;
  Block[] ret=new Block[num];
  for (int i=0; i < num; i++) {
    long id=in.readLong();
    long sz=WritableUtils.readVLong(in) + ((prev != null) ? prev.getNumBytes() : 0);
    long gs=WritableUtils.readVLong(in) + ((prev != null) ? prev.getGenerationStamp() : 0);
    ret[i]=new Block(id,sz,gs);
    prev=ret[i];
  }
  return ret;
}
