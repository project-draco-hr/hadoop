{
  WebApp app=WebApps.$for("test",TestWebApp.class,this,"ws").start(new WebApp(){
    @Override public void setup(){
      bind(MyTestJAXBContextResolver.class);
      bind(MyTestWebService.class);
      route("/:foo",FooController.class);
      route("/bar/foo",FooController.class,"bar");
      route("/foo/:foo",DefaultController.class);
      route("/foo/bar/:foo",DefaultController.class,"index");
    }
  }
);
  String baseUrl=baseUrl(app);
  try {
    assertEquals("foo",getContent(baseUrl).trim());
    assertEquals("foo",getContent(baseUrl + "test").trim());
    assertEquals("foo1",getContent(baseUrl + "test/1").trim());
    assertEquals("bar",getContent(baseUrl + "test/bar/foo").trim());
    assertEquals("default",getContent(baseUrl + "test/foo/bar").trim());
    assertEquals("default1",getContent(baseUrl + "test/foo/1").trim());
    assertEquals("default2",getContent(baseUrl + "test/foo/bar/2").trim());
    assertEquals(404,getResponseCode(baseUrl + "test/goo"));
    assertEquals(200,getResponseCode(baseUrl + "ws/v1/test"));
    assertTrue(getContent(baseUrl + "ws/v1/test").contains("myInfo"));
  }
  finally {
    app.stop();
  }
}
