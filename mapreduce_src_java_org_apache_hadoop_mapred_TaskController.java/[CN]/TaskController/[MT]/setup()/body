{
  FileSystem localFs=FileSystem.getLocal(conf);
  for (  String localDir : this.mapredLocalDirs) {
    File mapredlocalDir=new File(localDir);
    if (!mapredlocalDir.isDirectory() && !mapredlocalDir.mkdirs()) {
      LOG.warn("Unable to create mapreduce.cluster.local.directory : " + mapredlocalDir.getPath());
    }
 else {
      localFs.setPermission(new Path(mapredlocalDir.getCanonicalPath()),new FsPermission((short)0755));
    }
  }
  File taskLog=TaskLog.getUserLogDir();
  if (!taskLog.isDirectory() && !taskLog.mkdirs()) {
    LOG.warn("Unable to create taskLog directory : " + taskLog.getPath());
  }
 else {
    localFs.setPermission(new Path(taskLog.getCanonicalPath()),new FsPermission((short)0755));
  }
  DiskChecker.checkDir(TaskLog.getUserLogDir());
}
