{
  if (envString != null && envString.length() > 0) {
    Matcher varValMatcher=VARVAL_SPLITTER.matcher(envString);
    while (varValMatcher.find()) {
      String envVar=varValMatcher.group(1);
      Matcher m=VAR_SUBBER.matcher(varValMatcher.group(2));
      StringBuffer sb=new StringBuffer();
      while (m.find()) {
        String var=m.group(1);
        String replace=env.get(var);
        if (replace == null)         replace=System.getenv(var);
        if (replace == null)         replace="";
        m.appendReplacement(sb,Matcher.quoteReplacement(replace));
      }
      m.appendTail(sb);
      addToEnvironment(env,envVar,sb.toString(),classPathSeparator);
    }
  }
}
