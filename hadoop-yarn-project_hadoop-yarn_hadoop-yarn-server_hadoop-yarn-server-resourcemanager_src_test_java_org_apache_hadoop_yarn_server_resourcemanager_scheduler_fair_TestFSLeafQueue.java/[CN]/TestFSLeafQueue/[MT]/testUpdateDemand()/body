{
  conf.set(FairSchedulerConfiguration.ASSIGN_MULTIPLE,"false");
  resourceManager=new MockRM(conf);
  resourceManager.start();
  scheduler=(FairScheduler)resourceManager.getResourceScheduler();
  scheduler.allocConf=mock(AllocationConfiguration.class);
  String queueName="root.queue1";
  when(scheduler.allocConf.getMaxResources(queueName)).thenReturn(maxResource);
  when(scheduler.allocConf.getMinResources(queueName)).thenReturn(Resources.none());
  when(scheduler.allocConf.getQueueMaxApps(queueName)).thenReturn(Integer.MAX_VALUE);
  when(scheduler.allocConf.getSchedulingPolicy(queueName)).thenReturn(SchedulingPolicy.DEFAULT_POLICY);
  FSLeafQueue schedulable=new FSLeafQueue(queueName,scheduler,null);
  assertEquals(schedulable.getMetrics().getMaxApps(),Integer.MAX_VALUE);
  assertEquals(schedulable.getMetrics().getSchedulingPolicy(),SchedulingPolicy.DEFAULT_POLICY.getName());
  FSAppAttempt app=mock(FSAppAttempt.class);
  Mockito.when(app.getDemand()).thenReturn(maxResource);
  schedulable.addAppSchedulable(app);
  schedulable.addAppSchedulable(app);
  schedulable.updateDemand();
  assertTrue("Demand is greater than max allowed ",Resources.equals(schedulable.getDemand(),maxResource));
}
