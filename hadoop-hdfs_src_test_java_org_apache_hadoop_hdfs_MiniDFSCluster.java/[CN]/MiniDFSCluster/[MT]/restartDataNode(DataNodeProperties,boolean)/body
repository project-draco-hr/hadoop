{
  Configuration conf=dnprop.conf;
  String[] args=dnprop.dnArgs;
  Configuration newconf=new HdfsConfiguration(conf);
  if (keepPort) {
    InetSocketAddress addr=dnprop.datanode.getSelfAddr();
    conf.set("dfs.datanode.address",addr.getAddress().getHostAddress() + ":" + addr.getPort());
  }
  dataNodes.add(new DataNodeProperties(DataNode.createDataNode(args,conf),newconf,args));
  numDataNodes++;
  return true;
}
