{
  if (nameNodes.length == 0 || nameNodes[nnIndex] == null) {
    return;
  }
  InetSocketAddress addr=nameNodes[nnIndex].nameNode.getServiceRpcAddress();
  DFSClient client=new DFSClient(addr,conf);
  while (shouldWait(client.datanodeReport(DatanodeReportType.LIVE),addr)) {
    try {
      LOG.info("Waiting for cluster to become active");
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
    }
  }
  client.close();
}
