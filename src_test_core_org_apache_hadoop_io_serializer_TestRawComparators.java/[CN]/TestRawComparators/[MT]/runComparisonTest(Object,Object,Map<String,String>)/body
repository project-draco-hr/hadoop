{
  DataOutputBuffer out1=new DataOutputBuffer();
  DataOutputBuffer out2=new DataOutputBuffer();
  DataInputBuffer in1=new DataInputBuffer();
  DataInputBuffer in2=new DataInputBuffer();
  SerializationFactory factory=new SerializationFactory(conf);
  SerializerBase serializer=factory.getSerializer(metadata);
  assertNotNull("Serializer is null!",serializer);
  serializer.open(out1);
  serializer.serialize(low);
  serializer.close();
  serializer.open(out2);
  serializer.serialize(high);
  serializer.close();
  in1.reset(out1.getData(),out1.getLength());
  in2.reset(out2.getData(),out2.getLength());
  SerializationBase serializationBase=factory.getSerialization(metadata);
  assertNotNull("Null SerializationBase!",serializationBase);
  RawComparator rawComparator=serializationBase.getRawComparator(metadata);
  assertNotNull("Null raw comparator!",rawComparator);
  int actual=rawComparator.compare(in1.getData(),0,in1.getLength(),in2.getData(),0,in2.getLength());
  assertTrue("Did not compare FooWritable correctly",actual < 0);
}
