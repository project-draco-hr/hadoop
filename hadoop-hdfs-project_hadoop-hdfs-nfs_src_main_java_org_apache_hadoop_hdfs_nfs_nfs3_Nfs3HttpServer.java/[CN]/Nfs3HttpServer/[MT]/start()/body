{
  final InetSocketAddress httpAddr=getHttpAddress(conf);
  final String httpsAddrString=conf.get(NfsConfigKeys.NFS_HTTPS_ADDRESS_KEY,NfsConfigKeys.NFS_HTTPS_ADDRESS_DEFAULT);
  InetSocketAddress httpsAddr=NetUtils.createSocketAddr(httpsAddrString);
  HttpServer2.Builder builder=DFSUtil.httpServerTemplateForNNAndJN(conf,httpAddr,httpsAddr,"nfs3",NfsConfigKeys.DFS_NFS_KERBEROS_PRINCIPAL_KEY,NfsConfigKeys.DFS_NFS_KEYTAB_FILE_KEY);
  this.httpServer=builder.build();
  this.httpServer.start();
  HttpConfig.Policy policy=DFSUtil.getHttpPolicy(conf);
  int connIdx=0;
  if (policy.isHttpEnabled()) {
    infoPort=httpServer.getConnectorAddress(connIdx++).getPort();
  }
  if (policy.isHttpsEnabled()) {
    infoSecurePort=httpServer.getConnectorAddress(connIdx).getPort();
  }
}
