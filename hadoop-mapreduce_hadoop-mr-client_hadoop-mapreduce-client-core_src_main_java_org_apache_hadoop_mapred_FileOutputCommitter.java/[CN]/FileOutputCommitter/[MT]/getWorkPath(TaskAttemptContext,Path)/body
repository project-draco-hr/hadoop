{
  Path jobTmpDir=new Path(basePath,FileOutputCommitter.TEMP_DIR_NAME);
  FileSystem fs=jobTmpDir.getFileSystem(taskContext.getJobConf());
  if (!fs.exists(jobTmpDir)) {
    throw new IOException("The temporary job-output directory " + jobTmpDir.toString() + " doesn't exist!");
  }
  String taskid=taskContext.getTaskAttemptID().toString();
  Path taskTmpDir=new Path(jobTmpDir,"_" + taskid);
  if (!fs.mkdirs(taskTmpDir)) {
    throw new IOException("Mkdirs failed to create " + taskTmpDir.toString());
  }
  return taskTmpDir;
}
