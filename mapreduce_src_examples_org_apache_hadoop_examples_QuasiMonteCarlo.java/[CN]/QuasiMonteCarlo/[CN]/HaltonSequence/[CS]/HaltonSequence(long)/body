{
  index=startindex;
  x=new double[K.length];
  q=new double[K.length][];
  d=new int[K.length][];
  for (int i=0; i < K.length; i++) {
    q[i]=new double[K[i]];
    d[i]=new int[K[i]];
  }
  for (int i=0; i < K.length; i++) {
    long k=index;
    x[i]=0;
    for (int j=0; j < K[i]; j++) {
      q[i][j]=(j == 0 ? 1.0 : q[i][j - 1]) / P[i];
      d[i][j]=(int)(k % P[i]);
      k=(k - d[i][j]) / P[i];
      x[i]+=d[i][j] * q[i][j];
    }
  }
}
