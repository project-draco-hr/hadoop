{
  QueueManager modifiedQueueManager=new QueueManager();
  assertFalse("Hierarchy changed after refresh!",originalQManager.getRoot().isHierarchySameAs(modifiedQueueManager.getRoot()));
  try {
    originalQManager.refreshQueues(null,null);
    fail("Queue-refresh should have failed!");
  }
 catch (  Exception e) {
    assertTrue("Exception message should point to a change in queue hierarchy!",e.getMessage().contains(QueueManager.MSG_REFRESH_FAILURE_WITH_CHANGE_OF_HIERARCHY));
  }
  List<JobQueueInfo> rootQueues=originalQManager.getRoot().getJobQueueInfo().getChildren();
  assertTrue(rootQueues.size() == 1);
}
