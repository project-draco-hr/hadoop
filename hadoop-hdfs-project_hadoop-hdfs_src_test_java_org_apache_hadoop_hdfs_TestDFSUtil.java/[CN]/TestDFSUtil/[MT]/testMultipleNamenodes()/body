{
  HdfsConfiguration conf=new HdfsConfiguration();
  conf.set(DFS_FEDERATION_NAMESERVICES,"nn1,nn2");
  final String NN1_ADDRESS="localhost:9000";
  final String NN2_ADDRESS="localhost:9001";
  final String NN3_ADDRESS="localhost:9002";
  conf.set(DFSUtil.addKeySuffixes(DFS_NAMENODE_RPC_ADDRESS_KEY,"nn1"),NN1_ADDRESS);
  conf.set(DFSUtil.addKeySuffixes(DFS_NAMENODE_RPC_ADDRESS_KEY,"nn2"),NN2_ADDRESS);
  Collection<InetSocketAddress> nnAddresses=DFSUtil.getNNServiceRpcAddresses(conf);
  assertEquals(2,nnAddresses.size());
  Iterator<InetSocketAddress> iterator=nnAddresses.iterator();
  InetSocketAddress addr=iterator.next();
  assertEquals("localhost",addr.getHostName());
  assertEquals(9000,addr.getPort());
  addr=iterator.next();
  assertEquals("localhost",addr.getHostName());
  assertEquals(9001,addr.getPort());
  checkNameServiceId(conf,NN1_ADDRESS,"nn1");
  checkNameServiceId(conf,NN2_ADDRESS,"nn2");
  checkNameServiceId(conf,NN3_ADDRESS,null);
}
