{
  HdfsConfiguration conf=new HdfsConfiguration();
  final String NS1_NN1_HOST="ns1-nn1.example.com:8020";
  final String NS1_NN2_HOST="ns1-nn1.example.com:8020";
  final String NS2_NN_HOST="ns2-nn.example.com:8020";
  final String NN_HOST="nn.example.com:8020";
  conf.set(DFS_FEDERATION_NAMESERVICES,"ns1,ns2");
  conf.set(DFSUtil.addKeySuffixes(DFS_HA_NAMENODES_KEY_PREFIX,"ns1"),"nn1,nn2");
  conf.set(DFSUtil.addKeySuffixes(DFS_NAMENODE_RPC_ADDRESS_KEY,"ns1","nn1"),NS1_NN1_HOST);
  conf.set(DFSUtil.addKeySuffixes(DFS_NAMENODE_RPC_ADDRESS_KEY,"ns1","nn2"),NS1_NN2_HOST);
  conf.set(DFSUtil.addKeySuffixes(DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY,"ns2"),NS2_NN_HOST);
  conf.set(DFS_NAMENODE_RPC_ADDRESS_KEY,"hdfs://" + NN_HOST);
  Collection<URI> uris=DFSUtil.getNameServiceUris(conf,DFS_NAMENODE_RPC_ADDRESS_KEY,DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY);
  assertEquals(3,uris.size());
  assertTrue(uris.contains(new URI("hdfs://ns1")));
  assertTrue(uris.contains(new URI("hdfs://" + NS2_NN_HOST)));
  assertTrue(uris.contains(new URI("hdfs://" + NN_HOST)));
}
