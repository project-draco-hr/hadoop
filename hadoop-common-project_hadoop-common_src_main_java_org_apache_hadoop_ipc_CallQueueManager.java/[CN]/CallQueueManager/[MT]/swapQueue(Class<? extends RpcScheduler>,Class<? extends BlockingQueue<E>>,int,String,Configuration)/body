{
  int priorityLevels=parseNumLevels(ns,conf);
  RpcScheduler newScheduler=createScheduler(schedulerClass,priorityLevels,ns,conf);
  BlockingQueue<E> newQ=createCallQueueInstance(queueClassToUse,priorityLevels,maxSize,ns,conf);
  BlockingQueue<E> oldQ=putRef.get();
  putRef.set(newQ);
  while (!queueIsReallyEmpty(oldQ)) {
  }
  takeRef.set(newQ);
  this.scheduler=newScheduler;
  LOG.info("Old Queue: " + stringRepr(oldQ) + ", "+ "Replacement: "+ stringRepr(newQ));
}
