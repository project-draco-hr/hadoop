{
  int index=signedStr.lastIndexOf(SIGNATURE);
  if (index == -1) {
    throw new SignerException("Invalid signed text: " + signedStr);
  }
  String originalSignature=signedStr.substring(index + SIGNATURE.length());
  String rawValue=signedStr.substring(0,index);
  String currentSignature=computeSignature(rawValue);
  if (!originalSignature.equals(currentSignature)) {
    throw new SignerException("Invalid signature");
  }
  return rawValue;
}
