{
  URI clusterJson=getClass().getResource("/diskBalancer/data-cluster-3node-3disk.json").toURI();
  ClusterConnector jsonConnector=ConnectorFactory.getCluster(clusterJson,null);
  DiskBalancerCluster diskBalancerCluster=new DiskBalancerCluster(jsonConnector);
  diskBalancerCluster.readClusterInfo();
  Assert.assertEquals(3,diskBalancerCluster.getNodes().size());
  diskBalancerCluster.setNodesToProcess(diskBalancerCluster.getNodes());
  DiskBalancerDataNode node=diskBalancerCluster.getNodes().get(0);
  GreedyPlanner planner=new GreedyPlanner(10.0f,node);
  NodePlan plan=new NodePlan(node.getDataNodeName(),node.getDataNodePort());
  planner.balanceVolumeSet(node,node.getVolumeSets().get("SSD"),plan);
  final int dnIndex=0;
  final int planVersion=0;
  DataNode dataNode=cluster.getDataNodes().get(dnIndex);
  String planHash=DigestUtils.sha512Hex(plan.toJson());
  thrown.expect(DiskbalancerException.class);
  dataNode.submitDiskBalancerPlan(planHash,planVersion,10,plan.toJson());
}
