{
  String[] editsDirs=cluster.getConfiguration(0).getTrimmedStrings(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY);
  shutDownMiniCluster();
  Configuration conf=new HdfsConfiguration();
  conf.set(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_REQUIRED_KEY,editsDirs[1]);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_MINIMUM_KEY,0);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_CHECKED_VOLUMES_MINIMUM_KEY,0);
  setUpMiniCluster(conf,true);
  assertTrue(doAnEdit());
  invalidateEditsDirAtIndex(1,false,false);
  assertExitInvocations(0);
  doAnEdit();
  assertExitInvocations(atLeast(1));
}
