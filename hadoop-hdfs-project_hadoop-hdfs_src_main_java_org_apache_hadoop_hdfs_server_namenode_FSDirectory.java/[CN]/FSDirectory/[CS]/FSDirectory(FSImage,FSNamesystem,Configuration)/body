{
  this.dirLock=new ReentrantReadWriteLock(true);
  this.cond=dirLock.writeLock().newCondition();
  rootDir=createRoot(ns);
  inodeMap=INodeMap.newInstance(rootDir);
  this.fsImage=fsImage;
  int configuredLimit=conf.getInt(DFSConfigKeys.DFS_LIST_LIMIT,DFSConfigKeys.DFS_LIST_LIMIT_DEFAULT);
  this.lsLimit=configuredLimit > 0 ? configuredLimit : DFSConfigKeys.DFS_LIST_LIMIT_DEFAULT;
  this.maxComponentLength=conf.getInt(DFSConfigKeys.DFS_NAMENODE_MAX_COMPONENT_LENGTH_KEY,DFSConfigKeys.DFS_NAMENODE_MAX_COMPONENT_LENGTH_DEFAULT);
  this.maxDirItems=conf.getInt(DFSConfigKeys.DFS_NAMENODE_MAX_DIRECTORY_ITEMS_KEY,DFSConfigKeys.DFS_NAMENODE_MAX_DIRECTORY_ITEMS_DEFAULT);
  int threshold=conf.getInt(DFSConfigKeys.DFS_NAMENODE_NAME_CACHE_THRESHOLD_KEY,DFSConfigKeys.DFS_NAMENODE_NAME_CACHE_THRESHOLD_DEFAULT);
  NameNode.LOG.info("Caching file names occuring more than " + threshold + " times");
  nameCache=new NameCache<ByteArray>(threshold);
  namesystem=ns;
}
