{
  readLock();
  try {
    INode inode=rootDir.getNode(filename,false);
    if (inode == null) {
      throw new FileNotFoundException("File does not exist: " + filename);
    }
    if (inode.isDirectory() || inode.isSymlink()) {
      throw new IOException("Getting block size of non-file: " + filename);
    }
    return ((INodeFile)inode).getPreferredBlockSize();
  }
  finally {
    readUnlock();
  }
}
