{
  waitForReady();
  writeLock();
  try {
    final Block[] fileBlocks=unprotectedSetReplication(src,replication,blockRepls);
    if (fileBlocks != null)     fsImage.getEditLog().logSetReplication(src,replication);
    return fileBlocks;
  }
  finally {
    writeUnlock();
  }
}
