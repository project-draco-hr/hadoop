{
  final int latestSnapshot=iip.getLatestSnapshotId();
  final INode last=iip.getLastINode();
  final INodeDirectory parent=iip.getINode(-2).asDirectory();
  if (!parent.removeChild(last,latestSnapshot)) {
    return -1;
  }
  return (!last.isInLatestSnapshot(latestSnapshot) && INodeReference.tryRemoveReference(last) > 0) ? 0 : 1;
}
