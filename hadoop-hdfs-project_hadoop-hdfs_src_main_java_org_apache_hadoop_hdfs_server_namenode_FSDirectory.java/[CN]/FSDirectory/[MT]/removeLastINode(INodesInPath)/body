{
  final INode[] inodes=inodesInPath.getINodes();
  final int pos=inodes.length - 1;
  INode removedNode=((INodeDirectory)inodes[pos - 1]).removeChild(inodes[pos],inodesInPath.getLatestSnapshot());
  if (removedNode != null) {
    inodesInPath.setINode(pos - 1,removedNode.getParent());
    INode.DirCounts counts=new INode.DirCounts();
    removedNode.spaceConsumedInTree(counts);
    updateCountNoQuotaCheck(inodesInPath,pos,-counts.getNsCount(),-counts.getDsCount());
  }
  return removedNode;
}
