{
  INode node=FSDirectory.resolveLastINode(iip);
  int snapshot=iip.getPathSnapshotId();
  INodeAttributes nodeAttrs=node.getSnapshotINode(snapshot);
  if (attributeProvider != null) {
    byte[][] components=iip.getPathComponents();
    components=Arrays.copyOfRange(components,1,components.length);
    nodeAttrs=attributeProvider.getAttributes(components,nodeAttrs);
  }
  return nodeAttrs;
}
