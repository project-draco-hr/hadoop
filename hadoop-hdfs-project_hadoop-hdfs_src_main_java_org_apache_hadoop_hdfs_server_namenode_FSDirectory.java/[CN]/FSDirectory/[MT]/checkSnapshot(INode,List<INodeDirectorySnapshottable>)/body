{
  if (target.isDirectory()) {
    INodeDirectory targetDir=target.asDirectory();
    if (targetDir.isSnapshottable()) {
      INodeDirectorySnapshottable ssTargetDir=(INodeDirectorySnapshottable)targetDir;
      if (ssTargetDir.getNumSnapshots() > 0) {
        throw new IOException("The directory " + ssTargetDir.getFullPathName() + " cannot be deleted since "+ ssTargetDir.getFullPathName()+ " is snapshottable and already has snapshots");
      }
 else {
        if (snapshottableDirs != null) {
          snapshottableDirs.add(ssTargetDir);
        }
      }
    }
    for (    INode child : targetDir.getChildrenList(Snapshot.CURRENT_STATE_ID)) {
      checkSnapshot(child,snapshottableDirs);
    }
  }
}
