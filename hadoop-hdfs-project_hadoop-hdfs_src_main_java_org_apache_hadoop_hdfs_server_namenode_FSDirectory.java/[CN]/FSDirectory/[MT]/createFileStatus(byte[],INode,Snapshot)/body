{
  long size=0;
  short replication=0;
  long blocksize=0;
  if (node instanceof INodeFile) {
    INodeFile fileNode=(INodeFile)node;
    size=fileNode.computeFileSize(true,snapshot);
    replication=fileNode.getFileReplication(snapshot);
    blocksize=fileNode.getPreferredBlockSize();
  }
  return new HdfsFileStatus(size,node.isDirectory(),replication,blocksize,node.getModificationTime(snapshot),node.getAccessTime(snapshot),node.getFsPermission(snapshot),node.getUserName(snapshot),node.getGroupName(snapshot),node.isSymlink() ? ((INodeSymlink)node).getSymlink() : null,path);
}
