{
  if (!getFSNamesystem().isImageLoaded() || shouldSkipQuotaChecks()) {
    return;
  }
  final BlockStoragePolicy policy=getBlockStoragePolicySuite().getPolicy(file.getStoragePolicyID());
  file.computeQuotaDeltaForTruncate(newLength,policy,delta);
  readLock();
  try {
    verifyQuota(iip,iip.length() - 1,delta,null);
  }
  finally {
    readUnlock();
  }
}
