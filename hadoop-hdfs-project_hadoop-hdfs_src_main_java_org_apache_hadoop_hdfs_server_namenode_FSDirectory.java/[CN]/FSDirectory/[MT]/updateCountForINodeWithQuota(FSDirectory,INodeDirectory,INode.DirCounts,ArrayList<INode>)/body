{
  long parentNamespace=counts.nsCount;
  long parentDiskspace=counts.dsCount;
  counts.nsCount=1L;
  counts.dsCount=0L;
  nodesInPath.add(dir);
  for (  INode child : dir.getChildrenList()) {
    fsd.inodeMap.put(child);
    if (child.isDirectory()) {
      updateCountForINodeWithQuota(fsd,(INodeDirectory)child,counts,nodesInPath);
    }
 else     if (child.isSymlink()) {
      counts.nsCount+=1;
    }
 else {
      counts.nsCount+=1;
      counts.dsCount+=((INodeFile)child).diskspaceConsumed();
    }
  }
}
