{
  waitForReady();
  writeLock();
  try {
    fileNode.removeLastBlock(block);
    getBlockManager().removeBlockFromMap(block);
    fsImage.getEditLog().logOpenFile(path,fileNode);
    if (NameNode.stateChangeLog.isDebugEnabled()) {
      NameNode.stateChangeLog.debug("DIR* FSDirectory.removeBlock: " + path + " with "+ block+ " block is removed from the file system");
    }
    INode[] pathINodes=getExistingPathINodes(path);
    updateCount(pathINodes,pathINodes.length - 1,0,-fileNode.getPreferredBlockSize() * fileNode.getReplication(),true);
  }
  finally {
    writeUnlock();
  }
  return true;
}
