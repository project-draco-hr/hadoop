{
  Preconditions.checkArgument(fileNode.isUnderConstruction());
  boolean removed=fileNode.removeLastBlock(block);
  if (!removed) {
    return false;
  }
  getBlockManager().removeBlockFromMap(block);
  if (NameNode.stateChangeLog.isDebugEnabled()) {
    NameNode.stateChangeLog.debug("DIR* FSDirectory.removeBlock: " + path + " with "+ block+ " block is removed from the file system");
  }
  final INodesInPath iip=rootDir.getINodesInPath4Write(path,true);
  updateCount(iip,0,-fileNode.getBlockDiskspace(),true);
  return true;
}
