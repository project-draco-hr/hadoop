{
  String srcs=normalizePath(src);
  readLock();
  try {
    final INodesInPath inodesInPath=rootDir.getINodesInPath(srcs,true);
    final INode targetNode=inodesInPath.getINode(0);
    if (targetNode == null)     return null;
    if (!targetNode.isDirectory()) {
      return new DirectoryListing(new HdfsFileStatus[]{createFileStatus(HdfsFileStatus.EMPTY_NAME,targetNode,needLocation)},0);
    }
    INodeDirectory dirInode=(INodeDirectory)targetNode;
    final ReadOnlyList<INode> contents=dirInode.getChildrenList(inodesInPath.getPathSnapshot());
    int startChild=dirInode.nextChild(startAfter);
    int totalNumChildren=contents.size();
    int numOfListing=Math.min(totalNumChildren - startChild,this.lsLimit);
    HdfsFileStatus listing[]=new HdfsFileStatus[numOfListing];
    for (int i=0; i < numOfListing; i++) {
      INode cur=contents.get(startChild + i);
      listing[i]=createFileStatus(cur.name,cur,needLocation);
    }
    return new DirectoryListing(listing,totalNumChildren - startChild - numOfListing);
  }
  finally {
    readUnlock();
  }
}
