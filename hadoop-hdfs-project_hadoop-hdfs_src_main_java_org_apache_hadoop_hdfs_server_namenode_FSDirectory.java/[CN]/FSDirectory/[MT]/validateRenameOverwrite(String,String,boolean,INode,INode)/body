{
  String error;
  if (dstInode.isDirectory() != srcInode.isDirectory()) {
    error="Source " + src + " and destination "+ dst+ " must both be directories";
    NameNode.stateChangeLog.warn("DIR* FSDirectory.unprotectedRenameTo: " + error);
    throw new IOException(error);
  }
  if (!overwrite) {
    error="rename destination " + dst + " already exists";
    NameNode.stateChangeLog.warn("DIR* FSDirectory.unprotectedRenameTo: " + error);
    throw new FileAlreadyExistsException(error);
  }
  if (dstInode.isDirectory()) {
    final ReadOnlyList<INode> children=dstInode.asDirectory().getChildrenList(Snapshot.CURRENT_STATE_ID);
    if (!children.isEmpty()) {
      error="rename destination directory is not empty: " + dst;
      NameNode.stateChangeLog.warn("DIR* FSDirectory.unprotectedRenameTo: " + error);
      throw new IOException(error);
    }
  }
}
