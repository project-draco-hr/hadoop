{
  fileNode.removeLastBlock(block);
  getBlockManager().removeBlockFromMap(block);
  if (NameNode.stateChangeLog.isDebugEnabled()) {
    NameNode.stateChangeLog.debug("DIR* FSDirectory.removeBlock: " + path + " with "+ block+ " block is removed from the file system");
  }
  final INodesInPath inodesInPath=rootDir.getExistingPathINodes(path,true);
  final INode[] inodes=inodesInPath.getINodes();
  updateCount(inodesInPath,inodes.length - 1,0,-fileNode.getPreferredBlockSize() * fileNode.getFileReplication(),true);
}
