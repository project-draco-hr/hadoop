{
  final INode[] inodes=inodesInPath.getINodes();
  if (checkQuota) {
    verifyFsLimits(inodes,pos,child);
  }
  final Quota.Counts counts=child.computeQuotaUsage();
  updateCount(inodesInPath,pos,counts.get(Quota.NAMESPACE),counts.get(Quota.DISKSPACE),checkQuota);
  final boolean added=((INodeDirectory)inodes[pos - 1]).addChild(child,true,inodesInPath.getLatestSnapshot());
  if (!added) {
    updateCountNoQuotaCheck(inodesInPath,pos,-counts.get(Quota.NAMESPACE),-counts.get(Quota.DISKSPACE));
  }
  return added;
}
