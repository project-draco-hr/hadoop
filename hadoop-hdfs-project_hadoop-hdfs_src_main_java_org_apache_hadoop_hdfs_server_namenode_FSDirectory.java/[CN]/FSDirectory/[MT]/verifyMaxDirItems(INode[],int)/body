{
  final INodeDirectory parent=pathComponents[pos - 1].asDirectory();
  final int count=parent.getChildrenList(Snapshot.CURRENT_STATE_ID).size();
  if (count >= maxDirItems) {
    final MaxDirectoryItemsExceededException e=new MaxDirectoryItemsExceededException(maxDirItems,count);
    if (namesystem.isImageLoaded()) {
      e.setPathName(getFullPathName(pathComponents,pos - 1));
      throw e;
    }
 else {
      NameNode.LOG.error("FSDirectory.verifyMaxDirItems: " + e.getLocalizedMessage());
    }
  }
}
