{
  writeLock();
  try {
    if (isNonEmptyDirectory(src)) {
      throw new IOException("Attempt to create an encryption zone for a non-empty directory.");
    }
    final XAttr keyIdXAttr=XAttrHelper.buildXAttr(CRYPTO_XATTR_KEY_ID,keyId.getBytes());
    unprotectedSetXAttr(src,keyIdXAttr,EnumSet.of(XAttrSetFlag.CREATE));
    return keyIdXAttr;
  }
  finally {
    writeUnlock();
  }
}
