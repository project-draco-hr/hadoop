{
  Preconditions.checkState(hasWriteLock());
  final INodeDirectory parent=oldnode.getParent();
  final INode removed=parent.removeChild(oldnode,latest);
  Preconditions.checkState(removed == oldnode,"removed != oldnode=%s, removed=%s",oldnode,removed);
  oldnode.setParent(null);
  parent.addChild(newnode,true,latest);
  int index=0;
  for (  BlockInfo b : newnode.getBlocks()) {
    BlockInfo info=getBlockManager().addBlockCollection(b,newnode);
    newnode.setBlock(index,info);
    index++;
  }
}
