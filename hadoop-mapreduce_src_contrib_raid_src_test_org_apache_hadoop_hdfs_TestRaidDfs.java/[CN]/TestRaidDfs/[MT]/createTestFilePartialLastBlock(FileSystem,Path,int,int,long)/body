{
  CRC32 crc=new CRC32();
  Random rand=new Random();
  FSDataOutputStream stm=fileSys.create(name,true,fileSys.getConf().getInt("io.file.buffer.size",4096),(short)repl,blocksize);
  byte[] b=new byte[(int)blocksize];
  for (int i=1; i < numBlocks; i++) {
    rand.nextBytes(b);
    stm.write(b);
    crc.update(b);
  }
  b=new byte[(int)blocksize / 2 - 1];
  rand.nextBytes(b);
  stm.write(b);
  crc.update(b);
  stm.close();
  return crc.getValue();
}
