{
  this.datanode=datanode;
  this.dataset=dataset;
  this.blockPoolId=bpid;
  long hours=conf.getInt(DFSConfigKeys.DFS_DATANODE_SCAN_PERIOD_HOURS_KEY,DFSConfigKeys.DFS_DATANODE_SCAN_PERIOD_HOURS_DEFAULT);
  if (hours <= 0) {
    hours=DEFAULT_SCAN_PERIOD_HOURS;
  }
  this.scanPeriod=hours * 3600 * 1000;
  LOG.info("Periodic Block Verification Scanner initialized with interval " + hours + " hours for block pool "+ bpid);
  List<FinalizedReplica> arr=dataset.getFinalizedBlocksOnPersistentStorage(blockPoolId);
  Collections.shuffle(arr);
  long scanTime=-1;
  for (  Block block : arr) {
    BlockScanInfo info=new BlockScanInfo(block);
    info.lastScanTime=scanTime--;
    addBlockInfo(info,false);
  }
  RollingLogs rollingLogs=null;
  try {
    rollingLogs=dataset.createRollingLogs(blockPoolId,VERIFICATION_PREFIX);
  }
 catch (  IOException e) {
    LOG.warn("Could not open verfication log. " + "Verification times are not stored.");
  }
  verificationLog=rollingLogs == null ? null : new LogFileHandler(rollingLogs);
}
