{
  long timeLeft=Math.max(1L,currentPeriodStart + scanPeriod - Time.monotonicNow());
  long bw=Math.max((bytesLeft * 1000) / timeLeft,MIN_SCAN_RATE);
  throttler.setBandwidth(Math.min(bw,MAX_SCAN_RATE));
}
