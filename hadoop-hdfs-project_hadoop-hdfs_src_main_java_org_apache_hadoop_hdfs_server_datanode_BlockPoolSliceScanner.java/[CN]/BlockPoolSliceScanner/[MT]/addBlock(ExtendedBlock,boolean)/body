{
  BlockScanInfo info=blockMap.get(block.getLocalBlock());
  long lastScanTime=0;
  if (info != null) {
    lastScanTime=info.lastScanTime;
  }
  if (scanNow && Time.monotonicNow() - lastScanTime < lastScanTimeDifference) {
    return;
  }
  if (info != null) {
    LOG.warn("Adding an already existing block " + block);
    delBlockInfo(info);
  }
  info=new BlockScanInfo(block.getLocalBlock());
  info.lastScanTime=getNewBlockScanTime();
  if (scanNow) {
    LOG.info("Adding block for immediate verification " + block);
    info.nextScanType=ScanType.IMMEDIATE_SCAN;
  }
  addBlockInfo(info,true);
  adjustThrottler();
}
