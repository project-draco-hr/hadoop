{
  if (!shouldRun()) {
    return;
  }
  startCluster();
  jobOwner.doAs(new PrivilegedExceptionAction<Object>(){
    public Object run() throws Exception {
      Path inDir=new Path("input");
      Path outDir=new Path("output");
      RunningJob job;
      job=UtilsForTests.runJob(getClusterConf(),inDir,outDir,0,0);
      job.waitForCompletion();
      assertTrue("Job failed",job.isSuccessful());
      assertOwnerShip(outDir);
      job=UtilsForTests.runJob(getClusterConf(),inDir,outDir,1,0);
      job.waitForCompletion();
      assertTrue("Job failed",job.isSuccessful());
      assertOwnerShip(outDir);
      job=UtilsForTests.runJob(getClusterConf(),inDir,outDir,1,1);
      job.waitForCompletion();
      assertTrue("Job failed",job.isSuccessful());
      assertOwnerShip(outDir);
      JobConf myConf=getClusterConf();
      myConf.set(JobContext.JVM_NUMTASKS_TORUN,"-1");
      String[] args={"-m","6","-r","3","-mt","1000","-rt","1000"};
      assertEquals(0,ToolRunner.run(myConf,new SleepJob(),args));
      return null;
    }
  }
);
}
