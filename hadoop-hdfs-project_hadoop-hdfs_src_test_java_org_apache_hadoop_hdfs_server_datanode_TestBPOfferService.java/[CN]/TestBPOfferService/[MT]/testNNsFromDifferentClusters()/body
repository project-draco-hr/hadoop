{
  Mockito.doReturn(new NamespaceInfo(1,"fake foreign cluster",FAKE_BPID,0,HdfsConstants.LAYOUT_VERSION)).when(mockNN1).versionRequest();
  BPOfferService bpos=setupBPOSForNNs(mockNN1,mockNN2);
  bpos.start();
  try {
    waitForOneToFail(bpos);
  }
  finally {
    bpos.stop();
  }
}
