{
  DatanodeProtocolClientSideTranslatorPB mock=Mockito.mock(DatanodeProtocolClientSideTranslatorPB.class);
  Mockito.doReturn(new NamespaceInfo(1,FAKE_CLUSTERID,FAKE_BPID,0)).when(mock).versionRequest();
  Mockito.doReturn(DFSTestUtil.getLocalDatanodeRegistration()).when(mock).registerDatanode(Mockito.any(DatanodeRegistration.class));
  Mockito.doAnswer(new HeartbeatAnswer(nnIdx)).when(mock).sendHeartbeat(Mockito.any(DatanodeRegistration.class),Mockito.any(StorageReport[].class),Mockito.anyInt(),Mockito.anyInt(),Mockito.anyInt());
  mockHaStatuses[nnIdx]=new NNHAStatusHeartbeat(HAServiceState.STANDBY,0);
  return mock;
}
