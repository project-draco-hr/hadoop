{
  Configuration conf=new Configuration();
  conf.set(YarnConfiguration.RM_PRINCIPAL,"mapred/host@REALM");
  String renewer=Master.getMasterPrincipal(conf);
  Credentials credentials=new Credentials();
  final MockFileSystem fs=new MockFileSystem();
  final MockFileSystem mockFs=(MockFileSystem)fs.getRawFileSystem();
  when(mockFs.getCanonicalServiceName()).thenReturn("host:0");
  when(mockFs.getUri()).thenReturn(new URI("mockfs://host:0"));
  Path mockPath=mock(Path.class);
  when(mockPath.getFileSystem(conf)).thenReturn(mockFs);
  Path[] paths=new Path[]{mockPath,mockPath};
  when(mockFs.addDelegationTokens("me",credentials)).thenReturn(null);
  TokenCache.obtainTokensForNamenodesInternal(credentials,paths,conf);
  verify(mockFs,times(1)).addDelegationTokens(renewer,credentials);
}
