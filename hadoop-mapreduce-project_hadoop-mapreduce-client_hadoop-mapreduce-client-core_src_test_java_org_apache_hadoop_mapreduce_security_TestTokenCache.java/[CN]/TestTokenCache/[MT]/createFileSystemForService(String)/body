{
  FileSystem mockFs=mock(FileSystem.class);
  when(mockFs.getCanonicalServiceName()).thenReturn(service);
  when(mockFs.getDelegationToken(any(String.class))).thenAnswer(new Answer<Token<?>>(){
    int unique=0;
    @Override public Token<?> answer(    InvocationOnMock invocation) throws Throwable {
      Token<?> token=new Token<TokenIdentifier>();
      token.setService(new Text(service));
      token.setKind(new Text("token" + unique++));
      return token;
    }
  }
);
  return mockFs;
}
