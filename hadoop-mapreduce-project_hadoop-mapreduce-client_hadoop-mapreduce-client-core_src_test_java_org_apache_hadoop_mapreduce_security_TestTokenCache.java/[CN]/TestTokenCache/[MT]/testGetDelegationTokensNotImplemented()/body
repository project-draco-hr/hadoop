{
  Credentials credentials=new Credentials();
  Configuration conf=new Configuration();
  conf.set(YarnConfiguration.RM_PRINCIPAL,"mapred/host@REALM");
  String renewer=Master.getMasterPrincipal(conf);
  FileSystem fs=setupSingleFsWithoutGetDelegationTokens();
  TokenCache.obtainTokensForNamenodesInternal(fs,credentials,conf);
  assertEquals(1,credentials.getAllTokens().size());
  verify(fs).getDelegationTokens(renewer,credentials);
  verify(fs).getDelegationToken(renewer);
}
