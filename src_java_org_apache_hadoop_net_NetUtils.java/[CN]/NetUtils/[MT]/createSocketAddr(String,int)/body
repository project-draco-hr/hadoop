{
  int colonIndex=target.indexOf(':');
  if (colonIndex < 0 && defaultPort == -1) {
    throw new RuntimeException("Not a host:port pair: " + target);
  }
  String hostname;
  int port=-1;
  if (!target.contains("/")) {
    if (colonIndex == -1) {
      hostname=target;
    }
 else {
      hostname=target.substring(0,colonIndex);
      port=Integer.parseInt(target.substring(colonIndex + 1));
    }
  }
 else {
    URI addr=new Path(target).toUri();
    hostname=addr.getHost();
    port=addr.getPort();
  }
  if (port == -1) {
    port=defaultPort;
  }
  if (getStaticResolution(hostname) != null) {
    hostname=getStaticResolution(hostname);
  }
  return new InetSocketAddress(hostname,port);
}
