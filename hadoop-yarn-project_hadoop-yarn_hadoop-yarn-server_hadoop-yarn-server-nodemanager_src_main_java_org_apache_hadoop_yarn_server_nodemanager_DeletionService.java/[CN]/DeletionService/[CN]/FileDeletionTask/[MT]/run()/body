{
  if (LOG.isDebugEnabled()) {
    LOG.debug(this);
  }
  boolean error=false;
  if (null == user) {
    if (baseDirs == null || baseDirs.size() == 0) {
      LOG.debug("NM deleting absolute path : " + subDir);
      try {
        lfs.delete(subDir,true);
      }
 catch (      IOException e) {
        error=true;
        LOG.warn("Failed to delete " + subDir);
      }
    }
 else {
      for (      Path baseDir : baseDirs) {
        Path del=subDir == null ? baseDir : new Path(baseDir,subDir);
        LOG.debug("NM deleting path : " + del);
        try {
          lfs.delete(del,true);
        }
 catch (        IOException e) {
          error=true;
          LOG.warn("Failed to delete " + subDir);
        }
      }
    }
  }
 else {
    try {
      LOG.debug("Deleting path: [" + subDir + "] as user: ["+ user+ "]");
      if (baseDirs == null || baseDirs.size() == 0) {
        delService.exec.deleteAsUser(new DeletionAsUserContext.Builder().setUser(user).setSubDir(subDir).build());
      }
 else {
        delService.exec.deleteAsUser(new DeletionAsUserContext.Builder().setUser(user).setSubDir(subDir).setBasedirs(baseDirs.toArray(new Path[0])).build());
      }
    }
 catch (    IOException e) {
      error=true;
      LOG.warn("Failed to delete as user " + user,e);
    }
catch (    InterruptedException e) {
      error=true;
      LOG.warn("Failed to delete as user " + user,e);
    }
  }
  if (error) {
    setSuccess(!error);
  }
  fileDeletionTaskFinished();
}
