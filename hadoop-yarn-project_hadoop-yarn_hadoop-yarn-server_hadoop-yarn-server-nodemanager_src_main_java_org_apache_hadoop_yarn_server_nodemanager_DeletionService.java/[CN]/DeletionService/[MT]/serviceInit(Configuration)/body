{
  ThreadFactory tf=new ThreadFactoryBuilder().setNameFormat("DeletionService #%d").build();
  if (conf != null) {
    sched=new ScheduledThreadPoolExecutor(conf.getInt(YarnConfiguration.NM_DELETE_THREAD_COUNT,YarnConfiguration.DEFAULT_NM_DELETE_THREAD_COUNT),tf);
    debugDelay=conf.getInt(YarnConfiguration.DEBUG_NM_DELETE_DELAY_SEC,0);
  }
 else {
    sched=new ScheduledThreadPoolExecutor(YarnConfiguration.DEFAULT_NM_DELETE_THREAD_COUNT,tf);
  }
  sched.setExecuteExistingDelayedTasksAfterShutdownPolicy(false);
  sched.setKeepAliveTime(60L,SECONDS);
  if (stateStore.canRecover()) {
    recover(stateStore.loadDeletionServiceState());
  }
  super.serviceInit(conf);
}
