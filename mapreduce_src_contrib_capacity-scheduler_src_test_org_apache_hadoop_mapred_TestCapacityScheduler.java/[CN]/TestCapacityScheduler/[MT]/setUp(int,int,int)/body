{
  jobCounter=0;
  taskTrackerManager=new FakeTaskTrackerManager(numTaskTrackers,numMapTasksPerTracker,numReduceTasksPerTracker);
  clock=new FakeClock();
  scheduler=new CapacityTaskScheduler(clock);
  scheduler.setTaskTrackerManager(taskTrackerManager);
  conf=new JobConf();
  conf.set("mapred.queue.names","default");
  controlledInitializationPoller=new ControlledInitializationPoller(scheduler.jobQueuesManager,taskTrackerManager);
  scheduler.setInitializationPoller(controlledInitializationPoller);
  scheduler.setConf(conf);
  conf.setMapSpeculativeExecution(false);
  conf.setReduceSpeculativeExecution(false);
}
