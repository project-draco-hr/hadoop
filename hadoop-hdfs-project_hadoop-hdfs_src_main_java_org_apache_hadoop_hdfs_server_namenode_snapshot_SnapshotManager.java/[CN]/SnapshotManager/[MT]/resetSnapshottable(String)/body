{
  final INodesInPath inodesInPath=fsdir.getINodesInPath(path);
  final INodeDirectorySnapshottable s=INodeDirectorySnapshottable.valueOf(inodesInPath.getINode(0),path);
  if (s.getNumSnapshots() > 0) {
    throw new SnapshotException("The directory " + path + " has snapshot(s). "+ "Please redo the operation after removing all the snapshots.");
  }
  final INodeDirectory d=new INodeDirectory(s);
  fsdir.replaceINodeDirectory(path,s,d,inodesInPath.getLatestSnapshot());
  snapshottables.remove(s);
  numSnapshottableDirs.getAndDecrement();
}
