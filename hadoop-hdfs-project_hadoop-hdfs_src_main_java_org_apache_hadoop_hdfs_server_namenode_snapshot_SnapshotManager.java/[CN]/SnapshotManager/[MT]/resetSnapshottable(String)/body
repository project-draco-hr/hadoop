{
  final INodesInPath iip=fsdir.getINodesInPath4Write(path);
  final INodeDirectory d=INodeDirectory.valueOf(iip.getLastINode(),path);
  DirectorySnapshottableFeature sf=d.getDirectorySnapshottableFeature();
  if (sf == null) {
    return;
  }
  if (sf.getNumSnapshots() > 0) {
    throw new SnapshotException("The directory " + path + " has snapshot(s). "+ "Please redo the operation after removing all the snapshots.");
  }
  if (d == fsdir.getRoot()) {
    d.setSnapshotQuota(0);
  }
 else {
    d.removeSnapshottableFeature();
  }
  removeSnapshottable(d);
}
