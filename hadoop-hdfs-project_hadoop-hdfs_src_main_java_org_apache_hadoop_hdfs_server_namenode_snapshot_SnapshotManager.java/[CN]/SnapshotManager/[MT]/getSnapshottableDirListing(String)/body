{
  if (snapshottables.isEmpty()) {
    return null;
  }
  List<SnapshottableDirectoryStatus> statusList=new ArrayList<SnapshottableDirectoryStatus>();
  for (  INodeDirectory dir : snapshottables.values()) {
    if (userName == null || userName.equals(dir.getUserName())) {
      SnapshottableDirectoryStatus status=new SnapshottableDirectoryStatus(dir.getModificationTime(),dir.getAccessTime(),dir.getFsPermission(),dir.getUserName(),dir.getGroupName(),dir.getLocalNameBytes(),dir.getId(),dir.getChildrenNum(Snapshot.CURRENT_STATE_ID),dir.getDirectorySnapshottableFeature().getNumSnapshots(),dir.getDirectorySnapshottableFeature().getSnapshotQuota(),dir.getParent() == null ? DFSUtil.EMPTY_BYTES : DFSUtil.string2Bytes(dir.getParent().getFullPathName()));
      statusList.add(status);
    }
  }
  Collections.sort(statusList,SnapshottableDirectoryStatus.COMPARATOR);
  return statusList.toArray(new SnapshottableDirectoryStatus[statusList.size()]);
}
