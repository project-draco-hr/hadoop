{
  INodeDirectory srcRoot=getSnapshottableRoot(path);
  if (snapshotCounter == getMaxSnapshotID()) {
    throw new SnapshotException("Failed to create the snapshot. The FileSystem has run out of " + "snapshot IDs and ID rollover is not supported.");
  }
  srcRoot.addSnapshot(snapshotCounter,snapshotName);
  snapshotCounter++;
  numSnapshots.getAndIncrement();
  return Snapshot.getSnapshotPath(path,snapshotName);
}
