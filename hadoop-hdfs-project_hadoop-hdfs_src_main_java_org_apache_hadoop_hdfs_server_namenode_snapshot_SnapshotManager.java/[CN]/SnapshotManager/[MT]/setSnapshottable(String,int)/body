{
  namesystem.writeLock();
  try {
    final INodeDirectory d=INodeDirectory.valueOf(fsdir.getINode(path),path);
    if (d.isSnapshottable()) {
      return;
    }
    final INodeDirectorySnapshottable s=INodeDirectorySnapshottable.newInstance(d,snapshotQuota);
    fsdir.replaceINodeDirectory(path,d,s);
    snapshottables.add(s);
  }
  finally {
    namesystem.writeUnlock();
  }
  numSnapshottableDirs.getAndIncrement();
}
