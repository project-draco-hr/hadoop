{
  final INodesInPath inodesInPath=fsdir.getINodesInPath(path);
  final INodeDirectory d=INodeDirectory.valueOf(inodesInPath.getINode(0),path);
  if (d.isSnapshottable()) {
    ((INodeDirectorySnapshottable)d).setSnapshotQuota(snapshotQuota);
    return;
  }
  final INodeDirectorySnapshottable s=INodeDirectorySnapshottable.newInstance(d,snapshotQuota);
  fsdir.replaceINodeDirectory(path,d,s,inodesInPath.getLatestSnapshot());
  snapshottables.add(s);
  numSnapshottableDirs.getAndIncrement();
}
