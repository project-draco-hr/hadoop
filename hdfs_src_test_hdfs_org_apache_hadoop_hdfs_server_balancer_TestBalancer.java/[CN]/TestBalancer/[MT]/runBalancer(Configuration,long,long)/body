{
  waitForHeartBeat(totalUsedSpace,totalCapacity);
  final List<InetSocketAddress> namenodes=new ArrayList<InetSocketAddress>();
  namenodes.add(NameNode.getServiceAddress(conf,true));
  final int r=Balancer.run(namenodes,Balancer.Parameters.DEFALUT,conf);
  assertEquals(Balancer.ReturnStatus.SUCCESS.code,r);
  waitForHeartBeat(totalUsedSpace,totalCapacity);
  LOG.info("Rebalancing with default ctor.");
  waitForBalancer(totalUsedSpace,totalCapacity);
}
