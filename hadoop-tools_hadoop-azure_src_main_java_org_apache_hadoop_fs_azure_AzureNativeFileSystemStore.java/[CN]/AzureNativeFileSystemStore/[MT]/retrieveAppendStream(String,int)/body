{
  try {
    if (isPageBlobKey(key)) {
      throw new UnsupportedOperationException("Append not supported for Page Blobs");
    }
    CloudBlobWrapper blob=this.container.getBlockBlobReference(key);
    BlockBlobAppendStream appendStream=new BlockBlobAppendStream((CloudBlockBlobWrapper)blob,key,bufferSize,getInstrumentedContext());
    appendStream.initialize();
    return new DataOutputStream(appendStream);
  }
 catch (  Exception ex) {
    throw new AzureException(ex);
  }
}
