{
  InputStream in=null;
  DataInputStream inDataStream=null;
  try {
    try {
      if (null == storageInteractionLayer) {
        final String errMsg=String.format("Storage session expected for URI '%s' but does not exist.",sessionUri);
        throw new AssertionError(errMsg);
      }
      checkContainer(ContainerAccessType.PureRead);
      CloudBlockBlobWrapper blob=getBlobReference(key);
      in=blob.openInputStream(getDownloadOptions(),getInstrumentedContext(isConcurrentOOBAppendAllowed()));
      inDataStream=new DataInputStream(in);
      long skippedBytes=inDataStream.skip(startByteOffset);
      if (skippedBytes != startByteOffset) {
        throw new IOException("Couldn't skip the requested number of bytes");
      }
      return inDataStream;
    }
 catch (    Exception e) {
      if (inDataStream != null) {
        inDataStream.close();
      }
      if (in != null) {
        inDataStream.close();
      }
      throw e;
    }
  }
 catch (  Exception e) {
    throw new AzureException(e);
  }
}
