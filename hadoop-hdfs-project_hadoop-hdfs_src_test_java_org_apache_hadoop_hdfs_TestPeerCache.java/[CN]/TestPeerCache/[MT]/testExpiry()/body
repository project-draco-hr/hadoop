{
  DatanodeID dnIds[]=new DatanodeID[CAPACITY];
  FakePeer peers[]=new FakePeer[CAPACITY];
  for (int i=0; i < CAPACITY; ++i) {
    dnIds[i]=new DatanodeID("192.168.0.1","fakehostname_" + i,"fake_storage_id",100,101,102);
    peers[i]=new FakePeer(dnIds[i]);
  }
  for (int i=0; i < CAPACITY; ++i) {
    cache.put(dnIds[i],peers[i]);
  }
  assertEquals(CAPACITY,cache.size());
  Thread.sleep(EXPIRY_PERIOD * 50);
  assertEquals(0,cache.size());
  for (int i=0; i < CAPACITY; ++i) {
    assertTrue(peers[i].isClosed());
  }
  Thread.sleep(EXPIRY_PERIOD * 50);
  cache.clear();
}
