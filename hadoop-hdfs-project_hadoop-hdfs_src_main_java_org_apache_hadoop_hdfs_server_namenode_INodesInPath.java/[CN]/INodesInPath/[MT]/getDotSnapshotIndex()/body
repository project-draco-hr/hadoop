{
  if (isSnapshot) {
    for (int i=0; i < path.length; i++) {
      if (isDotSnapshotDir(path[i])) {
        return i;
      }
    }
    throw new IllegalStateException("The path " + getPath() + " is a snapshot path but does not contain "+ HdfsConstants.DOT_SNAPSHOT_DIR);
  }
 else {
    return -1;
  }
}
