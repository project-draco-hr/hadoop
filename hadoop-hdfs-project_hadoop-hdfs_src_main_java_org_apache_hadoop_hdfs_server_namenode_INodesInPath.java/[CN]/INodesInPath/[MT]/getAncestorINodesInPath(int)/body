{
  Preconditions.checkArgument(length >= 0 && length < inodes.length);
  final INode[] anodes=new INode[length];
  final byte[][] apath;
  final boolean isSnapshot;
  final int snapshotId;
  int dotSnapshotIndex=getDotSnapshotIndex();
  if (this.isSnapshot && length >= dotSnapshotIndex + 1) {
    apath=new byte[length + 1][];
    isSnapshot=true;
    snapshotId=this.snapshotId;
  }
 else {
    apath=new byte[length][];
    isSnapshot=false;
    snapshotId=this.isSnapshot ? CURRENT_STATE_ID : this.snapshotId;
  }
  System.arraycopy(this.inodes,0,anodes,0,length);
  System.arraycopy(this.path,0,apath,0,apath.length);
  return new INodesInPath(anodes,apath,isSnapshot,snapshotId);
}
