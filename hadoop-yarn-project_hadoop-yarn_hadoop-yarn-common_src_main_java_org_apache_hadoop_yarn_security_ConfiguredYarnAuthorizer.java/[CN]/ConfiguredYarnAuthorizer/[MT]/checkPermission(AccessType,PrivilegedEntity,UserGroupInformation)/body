{
  boolean ret=false;
  Map<AccessType,AccessControlList> acls=allAcls.get(target);
  if (acls != null) {
    AccessControlList list=acls.get(accessType);
    if (list != null) {
      ret=list.isUserAllowed(user);
    }
  }
  if (target.getType() == EntityType.QUEUE && !ret) {
    String queueName=target.getName();
    if (!queueName.contains(".")) {
      return ret;
    }
    String parentQueueName=queueName.substring(0,queueName.lastIndexOf("."));
    return checkPermission(accessType,new PrivilegedEntity(target.getType(),parentQueueName),user);
  }
  return ret;
}
