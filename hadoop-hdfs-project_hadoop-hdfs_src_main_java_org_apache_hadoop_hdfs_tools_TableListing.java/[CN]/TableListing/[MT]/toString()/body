{
  StringBuilder builder=new StringBuilder();
  int width=(columns.length - 1) * 2;
  for (int i=0; i < columns.length; i++) {
    width+=columns[i].maxWidth;
  }
  while (width > wrapWidth) {
    boolean modified=false;
    for (int i=0; i < columns.length; i++) {
      Column column=columns[i];
      if (column.wrap) {
        int maxWidth=column.getMaxWidth();
        if (maxWidth > 4) {
          column.setWrapWidth(maxWidth - 1);
          modified=true;
          width-=1;
          if (width <= wrapWidth) {
            break;
          }
        }
      }
    }
    if (!modified) {
      break;
    }
  }
  int startrow=0;
  if (!showHeader) {
    startrow=1;
  }
  String[][] columnLines=new String[columns.length][];
  for (int i=startrow; i < numRows + 1; i++) {
    int maxColumnLines=0;
    for (int j=0; j < columns.length; j++) {
      columnLines[j]=columns[j].getRow(i);
      if (columnLines[j].length > maxColumnLines) {
        maxColumnLines=columnLines[j].length;
      }
    }
    for (int c=0; c < maxColumnLines; c++) {
      String prefix="";
      for (int j=0; j < columns.length; j++) {
        builder.append(prefix);
        prefix=" ";
        if (columnLines[j].length > c) {
          builder.append(columnLines[j][c]);
        }
 else {
          builder.append(StringUtils.repeat(" ",columns[j].maxWidth));
        }
      }
      builder.append("\n");
    }
  }
  return builder.toString();
}
