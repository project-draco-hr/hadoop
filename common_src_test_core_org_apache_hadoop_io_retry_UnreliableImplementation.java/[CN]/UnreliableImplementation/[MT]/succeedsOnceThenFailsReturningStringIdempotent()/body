{
  if (succeedsOnceThenFailsIdempotentCount++ < 1) {
    return identifier;
  }
 else {
switch (exceptionToFailWith) {
case STANDBY_EXCEPTION:
      throw new StandbyException(identifier);
case UNRELIABLE_EXCEPTION:
    throw new UnreliableException(identifier);
case IO_EXCEPTION:
  throw new IOException(identifier);
default :
throw new RuntimeException(identifier);
}
}
}
