{
  if (size <= 0) {
    return 0;
  }
  if (type == CHECKSUM_CRC32) {
    int checksum=(int)summer.getValue();
    buf[offset + 0]=(byte)((checksum >>> 24) & 0xff);
    buf[offset + 1]=(byte)((checksum >>> 16) & 0xff);
    buf[offset + 2]=(byte)((checksum >>> 8) & 0xff);
    buf[offset + 3]=(byte)(checksum & 0xff);
  }
 else {
    throw new IOException("Unknown Checksum " + type);
  }
  if (reset) {
    reset();
  }
  return size;
}
