{
  final int TOT_SPLITS=15;
  final int NUM_SPLITS=5;
  final int STEP_SAMPLE=5;
  final int NUM_SAMPLES=NUM_SPLITS * STEP_SAMPLE;
  org.apache.hadoop.mapred.lib.InputSampler.Sampler<IntWritable,NullWritable> sampler=new org.apache.hadoop.mapred.lib.InputSampler.SplitSampler<IntWritable,NullWritable>(NUM_SAMPLES,NUM_SPLITS);
  int inits[]=new int[TOT_SPLITS];
  for (int i=0; i < TOT_SPLITS; ++i) {
    inits[i]=i * STEP_SAMPLE;
  }
  Object[] samples=sampler.getSample(new TestMapredInputSamplerIF(100000,TOT_SPLITS,inits),new JobConf());
  assertEquals(NUM_SAMPLES,samples.length);
  Arrays.sort(samples,new IntWritable.Comparator());
  for (int i=0; i < NUM_SAMPLES; ++i) {
    assertEquals(i % STEP_SAMPLE + TOT_SPLITS * (i / STEP_SAMPLE),((IntWritable)samples[i]).get());
  }
}
