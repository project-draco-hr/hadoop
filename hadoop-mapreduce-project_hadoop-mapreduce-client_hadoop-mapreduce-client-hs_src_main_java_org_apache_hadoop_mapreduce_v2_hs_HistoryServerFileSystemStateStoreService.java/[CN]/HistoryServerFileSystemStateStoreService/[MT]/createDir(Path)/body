{
  try {
    FileStatus status=fs.getFileStatus(dir);
    if (!status.isDirectory()) {
      throw new FileAlreadyExistsException("Unexpected file in store: " + dir);
    }
    if (!status.getPermission().equals(DIR_PERMISSIONS)) {
      fs.setPermission(dir,DIR_PERMISSIONS);
    }
  }
 catch (  FileNotFoundException e) {
    fs.mkdirs(dir,DIR_PERMISSIONS);
  }
}
