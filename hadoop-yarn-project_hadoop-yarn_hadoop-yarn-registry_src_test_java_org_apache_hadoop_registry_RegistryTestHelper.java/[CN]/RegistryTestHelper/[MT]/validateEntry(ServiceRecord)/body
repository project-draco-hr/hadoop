{
  assertNotNull("null service record",record);
  List<Endpoint> endpoints=record.external;
  assertEquals(2,endpoints.size());
  Endpoint webhdfs=findEndpoint(record,API_WEBHDFS,true,1,1);
  assertEquals(API_WEBHDFS,webhdfs.api);
  assertEquals(AddressTypes.ADDRESS_URI,webhdfs.addressType);
  assertEquals(ProtocolTypes.PROTOCOL_REST,webhdfs.protocolType);
  List<Map<String,String>> addressList=webhdfs.addresses;
  Map<String,String> url=addressList.get(0);
  String addr=url.get("uri");
  assertTrue(addr.contains("http"));
  assertTrue(addr.contains(":8020"));
  Endpoint nnipc=findEndpoint(record,NNIPC,false,1,2);
  assertEquals("wrong protocol in " + nnipc,ProtocolTypes.PROTOCOL_THRIFT,nnipc.protocolType);
  Endpoint ipc2=findEndpoint(record,IPC2,false,1,2);
  assertNotNull(ipc2);
  Endpoint web=findEndpoint(record,HTTP_API,true,1,1);
  assertEquals(1,web.addresses.size());
  assertEquals(1,web.addresses.get(0).size());
}
