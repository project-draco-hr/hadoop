{
  conf.setBoolean(DFSConfigKeys.DFS_NAMENODE_DELEGATION_TOKEN_ALWAYS_USE_KEY,true);
  conf.set("hadoop.security.auth_to_local","RULE:[2:$1@$0](JobTracker@.*FOO.COM)s/@.*//" + "DEFAULT");
  cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleHATopology()).numDataNodes(0).build();
  cluster.waitActive();
  nn0=cluster.getNameNode(0);
  nn1=cluster.getNameNode(1);
  fs=HATestUtil.configureFailoverFs(cluster,conf);
  dfs=(DistributedFileSystem)fs;
  cluster.transitionToActive(0);
  dtSecretManager=NameNodeAdapter.getDtSecretManager(nn0.getNamesystem());
}
