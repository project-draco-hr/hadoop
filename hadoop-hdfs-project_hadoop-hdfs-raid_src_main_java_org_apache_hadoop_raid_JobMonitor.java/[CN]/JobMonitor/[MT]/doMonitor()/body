{
  while (running) {
    String[] keys=null;
synchronized (jobs) {
      keys=jobs.keySet().toArray(new String[0]);
    }
    Map<String,List<DistRaid>> finishedJobs=new HashMap<String,List<DistRaid>>();
    for (    String key : keys) {
      DistRaid[] jobListCopy=null;
synchronized (jobs) {
        List<DistRaid> jobList=jobs.get(key);
synchronized (jobList) {
          jobListCopy=jobList.toArray(new DistRaid[jobList.size()]);
        }
      }
      for (      DistRaid job : jobListCopy) {
        try {
          boolean complete=job.checkComplete();
          if (complete) {
            addJob(finishedJobs,key,job);
            if (job.successful()) {
              jobsSucceeded++;
            }
          }
        }
 catch (        IOException ioe) {
          addJob(finishedJobs,key,job);
          LOG.error("JobMonitor exception",ioe);
        }
      }
    }
    if (finishedJobs.size() > 0) {
      for (      String key : finishedJobs.keySet()) {
        List<DistRaid> finishedJobList=finishedJobs.get(key);
        for (        DistRaid job : finishedJobList) {
          removeJob(jobs,key,job);
        }
      }
    }
    try {
      Thread.sleep(jobMonitorInterval);
    }
 catch (    InterruptedException ie) {
    }
  }
}
