{
  this.context=context;
  this.reduceId=context.getReduceId();
  this.jobConf=context.getJobConf();
  this.umbilical=context.getUmbilical();
  this.reporter=context.getReporter();
  this.metrics=new ShuffleClientMetrics(reduceId,jobConf);
  this.copyPhase=context.getCopyPhase();
  this.taskStatus=context.getStatus();
  this.reduceTask=context.getReduceTask();
  scheduler=new ShuffleScheduler<K,V>(jobConf,taskStatus,this,copyPhase,context.getShuffledMapsCounter(),context.getReduceShuffleBytes(),context.getFailedShuffleCounter());
  merger=new MergeManager<K,V>(reduceId,jobConf,context.getLocalFS(),context.getLocalDirAllocator(),reporter,context.getCodec(),context.getCombinerClass(),context.getCombineCollector(),context.getSpilledRecordsCounter(),context.getReduceCombineInputCounter(),context.getMergedMapOutputsCounter(),this,context.getMergePhase(),context.getMapOutputFile());
}
