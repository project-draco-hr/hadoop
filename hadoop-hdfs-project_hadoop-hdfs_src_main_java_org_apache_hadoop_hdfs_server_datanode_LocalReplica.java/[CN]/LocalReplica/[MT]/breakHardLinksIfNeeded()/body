{
  File file=getBlockFile();
  if (file == null || getVolume() == null) {
    throw new IOException("detachBlock:Block not found. " + this);
  }
  File meta=getMetaFile();
  int linkCount=HardLink.getLinkCount(file);
  if (linkCount > 1) {
    DataNode.LOG.info("Breaking hardlink for " + linkCount + "x-linked "+ "block "+ this);
    breakHardlinks(file,this);
  }
  if (HardLink.getLinkCount(meta) > 1) {
    breakHardlinks(meta,this);
  }
  return true;
}
