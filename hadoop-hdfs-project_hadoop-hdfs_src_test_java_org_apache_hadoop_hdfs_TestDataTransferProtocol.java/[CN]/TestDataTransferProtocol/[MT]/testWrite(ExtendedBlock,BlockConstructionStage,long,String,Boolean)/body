{
  sendBuf.reset();
  recvBuf.reset();
  sender.writeBlock(block,BlockTokenSecretManager.DUMMY_TOKEN,"cl",new DatanodeInfo[1],null,stage,0,block.getNumBytes(),block.getNumBytes(),newGS,DEFAULT_CHECKSUM,CachingStrategy.newDefaultStrategy());
  if (eofExcepted) {
    sendResponse(Status.ERROR,null,null,recvOut);
    sendRecvData(description,true);
  }
 else   if (stage == BlockConstructionStage.PIPELINE_CLOSE_RECOVERY) {
    sendResponse(Status.SUCCESS,"",null,recvOut);
    sendRecvData(description,false);
  }
 else {
    writeZeroLengthPacket(block,description);
  }
}
