{
  keyVal=key.get();
  while (values.hasNext()) {
    Text value=values.next();
    String towrite=value.toString() + "\n";
    indexStream.write(towrite.getBytes(Charsets.UTF_8));
    written++;
    if (written > numIndexes - 1) {
      reporter.setStatus("Creating index for archives");
      reporter.progress();
      endIndex=keyVal;
      String masterWrite=startIndex + " " + endIndex+ " "+ startPos+ " "+ indexStream.getPos()+ " \n";
      outStream.write(masterWrite.getBytes(Charsets.UTF_8));
      startPos=indexStream.getPos();
      startIndex=endIndex;
      written=0;
    }
  }
}
