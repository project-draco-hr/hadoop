{
  this.conf=conf;
  tmpOutputDir=FileOutputFormat.getWorkOutputPath(this.conf);
  masterIndex=new Path(tmpOutputDir,"_masterindex");
  index=new Path(tmpOutputDir,"_index");
  try {
    fs=masterIndex.getFileSystem(conf);
    if (fs.exists(masterIndex)) {
      fs.delete(masterIndex,false);
    }
    if (fs.exists(index)) {
      fs.delete(index,false);
    }
    indexStream=fs.create(index);
    outStream=fs.create(masterIndex);
    String version=VERSION + " \n";
    outStream.write(version.getBytes(Charsets.UTF_8));
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
