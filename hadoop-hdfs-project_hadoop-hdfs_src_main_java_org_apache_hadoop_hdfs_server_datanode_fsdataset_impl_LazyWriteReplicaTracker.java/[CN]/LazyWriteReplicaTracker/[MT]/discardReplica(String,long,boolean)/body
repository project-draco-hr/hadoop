{
  Map<Long,ReplicaState> map=replicaMaps.get(bpid);
  if (map == null) {
    return;
  }
  ReplicaState replicaState=map.get(blockId);
  if (replicaState == null) {
    if (force) {
      return;
    }
    throw new IllegalStateException("Unknown replica bpid=" + bpid + "; blockId="+ blockId);
  }
  if (replicaState.state != State.LAZY_PERSIST_COMPLETE && !force) {
    throw new IllegalStateException("Discarding replica without " + "saving it to disk bpid=" + bpid + "; blockId="+ blockId);
  }
  map.remove(blockId);
  replicasPersisted.remove(replicaState);
}
