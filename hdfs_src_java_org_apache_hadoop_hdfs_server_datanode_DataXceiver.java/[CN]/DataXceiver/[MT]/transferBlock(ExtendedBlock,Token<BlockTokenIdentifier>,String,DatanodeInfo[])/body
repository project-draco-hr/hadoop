{
  checkAccess(null,true,blk,blockToken,Op.TRANSFER_BLOCK,BlockTokenSecretManager.AccessMode.COPY);
  updateCurrentThreadName(Op.TRANSFER_BLOCK + " " + blk);
  final DataOutputStream out=new DataOutputStream(NetUtils.getOutputStream(s,datanode.socketWriteTimeout));
  try {
    datanode.transferReplicaForPipelineRecovery(blk,targets,clientName);
    writeResponse(Status.SUCCESS,out);
  }
  finally {
    IOUtils.closeStream(out);
  }
}
