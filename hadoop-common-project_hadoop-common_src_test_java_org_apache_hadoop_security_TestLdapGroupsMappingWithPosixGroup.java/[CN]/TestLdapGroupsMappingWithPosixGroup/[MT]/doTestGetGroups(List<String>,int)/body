{
  Configuration conf=new Configuration();
  conf.set(LdapGroupsMapping.LDAP_URL_KEY,"ldap://test");
  conf.set(LdapGroupsMapping.GROUP_SEARCH_FILTER_KEY,"(objectClass=posixGroup)(cn={0})");
  conf.set(LdapGroupsMapping.USER_SEARCH_FILTER_KEY,"(objectClass=posixAccount)");
  conf.set(LdapGroupsMapping.GROUP_MEMBERSHIP_ATTR_KEY,"memberUid");
  conf.set(LdapGroupsMapping.POSIX_UID_ATTR_KEY,"uidNumber");
  conf.set(LdapGroupsMapping.POSIX_GID_ATTR_KEY,"gidNumber");
  conf.set(LdapGroupsMapping.GROUP_NAME_ATTR_KEY,"cn");
  LdapGroupsMapping groupsMapping=getGroupsMapping();
  groupsMapping.setConf(conf);
  List<String> groups=groupsMapping.getGroups("some_user");
  Assert.assertEquals(expectedGroups,groups);
  groupsMapping.getConf().set(LdapGroupsMapping.POSIX_UID_ATTR_KEY,"uid");
  Assert.assertEquals(expectedGroups,groups);
  verify(getContext(),times(searchTimes)).search(anyString(),anyString(),any(Object[].class),any(SearchControls.class));
}
