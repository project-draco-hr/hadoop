{
  Set<String> allRacks=new HashSet<String>();
  if (req.racks != null) {
    allRacks.addAll(req.racks);
  }
  allRacks.addAll(resolveRacks(req.nodes));
  if (req.nodes != null) {
    for (    String node : new HashSet<String>(req.nodes)) {
      decResourceRequest(req.priority,node,req.capability,req.containerCount,req);
    }
  }
  for (  String rack : allRacks) {
    decResourceRequest(req.priority,rack,req.capability,req.containerCount,req);
  }
  decResourceRequest(req.priority,ResourceRequest.ANY,req.capability,req.containerCount,req);
}
