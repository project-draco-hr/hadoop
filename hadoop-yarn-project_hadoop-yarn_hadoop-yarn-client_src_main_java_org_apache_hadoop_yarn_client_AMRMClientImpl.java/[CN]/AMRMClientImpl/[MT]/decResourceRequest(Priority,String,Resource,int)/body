{
  Map<String,Map<Resource,ResourceRequest>> remoteRequests=this.remoteRequestsTable.get(priority);
  if (remoteRequests == null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Not decrementing resource as priority " + priority + " is not present in request table");
    }
    return;
  }
  Map<Resource,ResourceRequest> reqMap=remoteRequests.get(resourceName);
  if (reqMap == null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Not decrementing resource as " + resourceName + " is not present in request table");
    }
    return;
  }
  ResourceRequest remoteRequest=reqMap.get(capability);
  if (LOG.isDebugEnabled()) {
    LOG.debug("BEFORE decResourceRequest:" + " applicationId=" + appAttemptId + " priority="+ priority.getPriority()+ " resourceName="+ resourceName+ " numContainers="+ remoteRequest.getNumContainers()+ " #asks="+ ask.size());
  }
  remoteRequest.setNumContainers(remoteRequest.getNumContainers() - containerCount);
  if (remoteRequest.getNumContainers() < 0) {
    remoteRequest.setNumContainers(0);
  }
  addResourceRequestToAsk(remoteRequest);
  if (remoteRequest.getNumContainers() == 0) {
    reqMap.remove(capability);
    if (reqMap.size() == 0) {
      remoteRequests.remove(resourceName);
    }
    if (remoteRequests.size() == 0) {
      remoteRequestsTable.remove(priority);
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.info("AFTER decResourceRequest:" + " applicationId=" + appAttemptId + " priority="+ priority.getPriority()+ " resourceName="+ resourceName+ " numContainers="+ remoteRequest.getNumContainers()+ " #asks="+ ask.size());
  }
}
