{
  DataNodeMessage m=queue.peek();
  if (m != null && m.getTargetGs() <= gs) {
    return queue.remove();
  }
 else {
    return null;
  }
}
