{
  for (int i=1; i < pipeline.length; i++) {
    DatanodeDescriptor dn=pipeline[i];
    Iterator<DatanodeStorageInfo> iterator=dn.getStorageInfos().iterator();
    if (iterator.hasNext()) {
      DatanodeStorageInfo storage=iterator.next();
      bm.addBlock(dn,storage.getStorageID(),blockInfo,null);
      blockInfo.addStorage(storage);
    }
 else {
      throw new RuntimeException("Storage info on node: " + dn.getHostName() + " is invalid.");
    }
  }
}
