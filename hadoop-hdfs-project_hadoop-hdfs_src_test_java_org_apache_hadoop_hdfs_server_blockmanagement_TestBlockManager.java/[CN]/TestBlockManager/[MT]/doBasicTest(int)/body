{
  List<DatanodeDescriptor> origNodes=nodes(0,1);
  BlockInfo blockInfo=addBlockOnNodes((long)testIndex,origNodes);
  DatanodeDescriptor[] pipeline=scheduleSingleReplication(blockInfo);
  assertEquals(2,pipeline.length);
  assertTrue("Source of replication should be one of the nodes the block " + "was on. Was: " + pipeline[0],origNodes.contains(pipeline[0]));
  assertTrue("Destination of replication should be on the other rack. " + "Was: " + pipeline[1],rackB.contains(pipeline[1]));
}
