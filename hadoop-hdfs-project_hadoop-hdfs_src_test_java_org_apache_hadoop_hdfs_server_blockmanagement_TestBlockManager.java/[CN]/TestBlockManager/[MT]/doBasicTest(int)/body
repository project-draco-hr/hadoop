{
  List<DatanodeStorageInfo> origStorages=getStorages(0,1);
  List<DatanodeDescriptor> origNodes=getNodes(origStorages);
  BlockInfoContiguous blockInfo=addBlockOnNodes(testIndex,origNodes);
  DatanodeStorageInfo[] pipeline=scheduleSingleReplication(blockInfo);
  assertEquals(2,pipeline.length);
  assertTrue("Source of replication should be one of the nodes the block " + "was on. Was: " + pipeline[0],origStorages.contains(pipeline[0]));
  assertTrue("Destination of replication should be on the other rack. " + "Was: " + pipeline[1],rackB.contains(pipeline[1].getDatanodeDescriptor()));
}
