{
  conf=new HdfsConfiguration();
  conf.set(DFSConfigKeys.NET_TOPOLOGY_SCRIPT_FILE_NAME_KEY,"need to set a dummy value here so it assumes a multi-rack cluster");
  fsn=Mockito.mock(FSNamesystem.class);
  Mockito.doReturn(true).when(fsn).hasWriteLock();
  bm=new BlockManager(fsn,fsn,conf);
  nodes=ImmutableList.of(new DatanodeDescriptor(new DatanodeID("1.1.1.1",5020),"/rackA"),new DatanodeDescriptor(new DatanodeID("2.2.2.2",5020),"/rackA"),new DatanodeDescriptor(new DatanodeID("3.3.3.3",5020),"/rackA"),new DatanodeDescriptor(new DatanodeID("4.4.4.4",5020),"/rackB"),new DatanodeDescriptor(new DatanodeID("5.5.5.5",5020),"/rackB"),new DatanodeDescriptor(new DatanodeID("6.6.6.6",5020),"/rackB"));
  rackA=nodes.subList(0,3);
  rackB=nodes.subList(3,6);
}
