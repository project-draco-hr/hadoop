{
  SchedulerNode node=getSchedulerNode(nm.getNodeID());
  Resource newResource=resourceOption.getResource();
  Resource oldResource=node.getTotalResource();
  if (!oldResource.equals(newResource)) {
    rmContext.getNodeLabelManager().updateNodeResource(nm.getNodeID(),newResource);
    LOG.info("Update resource on node: " + node.getNodeName() + " from: "+ oldResource+ ", to: "+ newResource);
    nodes.remove(nm.getNodeID());
    updateMaximumAllocation(node,false);
    node.setTotalResource(newResource);
    nodes.put(nm.getNodeID(),(N)node);
    updateMaximumAllocation(node,true);
    Resources.subtractFrom(clusterResource,oldResource);
    Resources.addTo(clusterResource,newResource);
  }
 else {
    LOG.warn("Update resource on node: " + node.getNodeName() + " with the same resource: "+ newResource);
  }
}
