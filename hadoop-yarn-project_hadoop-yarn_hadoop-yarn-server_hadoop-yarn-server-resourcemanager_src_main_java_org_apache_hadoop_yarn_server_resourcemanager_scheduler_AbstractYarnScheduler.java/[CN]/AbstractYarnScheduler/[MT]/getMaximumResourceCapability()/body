{
  Resource maxResource;
  maxAllocReadLock.lock();
  try {
    if (useConfiguredMaximumAllocationOnly) {
      if (System.currentTimeMillis() - ResourceManager.getClusterTimeStamp() > configuredMaximumAllocationWaitTime) {
        useConfiguredMaximumAllocationOnly=false;
      }
      maxResource=Resources.clone(configuredMaximumAllocation);
    }
 else {
      maxResource=Resources.clone(maximumAllocation);
    }
  }
  finally {
    maxAllocReadLock.unlock();
  }
  return maxResource;
}
