{
  final Path dir=new Path("/TestSnapshot");
  hdfs.mkdirs(dir);
  SnapshotTestHelper.createSnapshot(hdfs,dir,"s1");
  Path sub=new Path(dir,"sub");
  hdfs.mkdirs(sub);
  Path fileInSub=new Path(sub,"file");
  DFSTestUtil.createFile(hdfs,fileInSub,BLOCKSIZE,REPLICATION,seed);
  INodeDirectory subNode=INodeDirectory.valueOf(fsdir.getINode(sub.toString()),sub);
  assertFalse(subNode instanceof INodeDirectoryWithSnapshot);
  hdfs.setQuota(sub,Long.MAX_VALUE - 1,Long.MAX_VALUE - 1);
  subNode=INodeDirectory.valueOf(fsdir.getINode(sub.toString()),sub);
  assertTrue(subNode.isQuotaSet());
  assertFalse(subNode instanceof INodeDirectoryWithSnapshot);
}
