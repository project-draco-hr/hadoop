{
  ZooKeeper zk=BKJMUtil.connectZooKeeper();
  BookKeeper bkc=new BookKeeper(new ClientConfiguration(),zk);
  try {
    LedgerHandle lh=bkc.createLedger(BookKeeper.DigestType.CRC32,"foobar".getBytes());
    lh.close();
    EditLogLedgerMetadata metadata=new EditLogLedgerMetadata("/foobar",HdfsConstants.NAMENODE_LAYOUT_VERSION,lh.getId(),0x1234);
    try {
      new BookKeeperEditLogInputStream(lh,metadata,-1);
      fail("Shouldn't get this far, should have thrown");
    }
 catch (    IOException ioe) {
      assertTrue(ioe.getMessage().contains("Invalid first bk entry to read"));
    }
    metadata=new EditLogLedgerMetadata("/foobar",HdfsConstants.NAMENODE_LAYOUT_VERSION,lh.getId(),0x1234);
    try {
      new BookKeeperEditLogInputStream(lh,metadata,0);
      fail("Shouldn't get this far, should have thrown");
    }
 catch (    IOException ioe) {
      assertTrue(ioe.getMessage().contains("Invalid first bk entry to read"));
    }
  }
  finally {
    bkc.close();
    zk.close();
  }
}
