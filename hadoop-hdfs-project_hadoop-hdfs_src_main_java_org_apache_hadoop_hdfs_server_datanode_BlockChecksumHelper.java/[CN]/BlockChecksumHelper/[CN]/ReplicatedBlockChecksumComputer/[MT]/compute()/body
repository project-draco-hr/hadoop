{
  try {
    readHeader();
    MD5Hash md5out;
    if (isPartialBlk() && getCrcPerBlock() > 0) {
      md5out=checksumPartialBlock();
    }
 else {
      md5out=checksumWholeBlock();
    }
    setOutBytes(md5out.getDigest());
    LOG.debug("block={}, bytesPerCRC={}, crcPerBlock={}, md5out={}",getBlock(),getBytesPerCRC(),getCrcPerBlock(),md5out);
  }
  finally {
    IOUtils.closeStream(getChecksumIn());
    IOUtils.closeStream(getMetadataIn());
  }
}
