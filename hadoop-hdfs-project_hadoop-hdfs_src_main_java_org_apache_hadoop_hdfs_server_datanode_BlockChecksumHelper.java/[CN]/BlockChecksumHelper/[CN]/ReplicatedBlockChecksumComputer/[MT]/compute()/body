{
  try {
    readHeader();
    MD5Hash md5out;
    if (isPartialBlk() && getCrcPerBlock() > 0) {
      md5out=checksumPartialBlock();
    }
 else {
      md5out=checksumWholeBlock();
    }
    setOutBytes(md5out.getDigest());
    if (LOG.isDebugEnabled()) {
      LOG.debug("block=" + getBlock() + ", bytesPerCRC="+ getBytesPerCRC()+ ", crcPerBlock="+ getCrcPerBlock()+ ", md5out="+ md5out);
    }
  }
  finally {
    IOUtils.closeStream(getChecksumIn());
    IOUtils.closeStream(getMetadataIn());
  }
}
