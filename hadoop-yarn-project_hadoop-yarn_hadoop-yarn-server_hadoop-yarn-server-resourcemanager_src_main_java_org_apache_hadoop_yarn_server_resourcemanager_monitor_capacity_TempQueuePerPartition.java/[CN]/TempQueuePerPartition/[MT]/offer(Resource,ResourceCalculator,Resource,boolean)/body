{
  Resource absMaxCapIdealAssignedDelta=Resources.componentwiseMax(Resources.subtract(getMax(),idealAssigned),Resource.newInstance(0,0));
  Resource accepted=Resources.min(rc,clusterResource,absMaxCapIdealAssignedDelta,Resources.min(rc,clusterResource,avail,Resources.subtract(Resources.add((considersReservedResource ? getUsed() : getUsedDeductReservd()),pending),idealAssigned)));
  Resource remain=Resources.subtract(avail,accepted);
  Resources.addTo(idealAssigned,accepted);
  return remain;
}
