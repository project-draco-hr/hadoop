{
  this.in=in;
  this.logVersion=logVersion;
  this.checksum=checksum;
  opInstances=new EnumMap<FSEditLogOpCodes,FSEditLogOp>(FSEditLogOpCodes.class);
  opInstances.put(OP_ADD,new AddCloseOp(OP_ADD));
  opInstances.put(OP_CLOSE,new AddCloseOp(OP_CLOSE));
  opInstances.put(OP_SET_REPLICATION,new SetReplicationOp());
  opInstances.put(OP_CONCAT_DELETE,new ConcatDeleteOp());
  opInstances.put(OP_RENAME_OLD,new RenameOldOp());
  opInstances.put(OP_DELETE,new DeleteOp());
  opInstances.put(OP_MKDIR,new MkdirOp());
  opInstances.put(OP_SET_GENSTAMP,new SetGenstampOp());
  opInstances.put(OP_DATANODE_ADD,new DatanodeAddOp());
  opInstances.put(OP_DATANODE_REMOVE,new DatanodeRemoveOp());
  opInstances.put(OP_SET_PERMISSIONS,new SetPermissionsOp());
  opInstances.put(OP_SET_OWNER,new SetOwnerOp());
  opInstances.put(OP_SET_NS_QUOTA,new SetNSQuotaOp());
  opInstances.put(OP_CLEAR_NS_QUOTA,new ClearNSQuotaOp());
  opInstances.put(OP_SET_QUOTA,new SetQuotaOp());
  opInstances.put(OP_TIMES,new TimesOp());
  opInstances.put(OP_SYMLINK,new SymlinkOp());
  opInstances.put(OP_RENAME,new RenameOp());
  opInstances.put(OP_REASSIGN_LEASE,new ReassignLeaseOp());
  opInstances.put(OP_GET_DELEGATION_TOKEN,new GetDelegationTokenOp());
  opInstances.put(OP_RENEW_DELEGATION_TOKEN,new RenewDelegationTokenOp());
  opInstances.put(OP_CANCEL_DELEGATION_TOKEN,new CancelDelegationTokenOp());
  opInstances.put(OP_UPDATE_MASTER_KEY,new UpdateMasterKeyOp());
}
