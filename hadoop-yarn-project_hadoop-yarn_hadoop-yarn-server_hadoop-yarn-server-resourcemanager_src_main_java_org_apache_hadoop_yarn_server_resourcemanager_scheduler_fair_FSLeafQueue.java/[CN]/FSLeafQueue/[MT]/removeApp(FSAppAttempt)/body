{
  boolean runnable=false;
  writeLock.lock();
  try {
    if (runnableApps.remove(app)) {
      runnable=true;
    }
 else     if (nonRunnableApps.remove(app)) {
      runnable=false;
    }
 else {
      throw new IllegalStateException("Given app to remove " + app + " does not exist in queue "+ this);
    }
  }
  finally {
    writeLock.unlock();
  }
  if (runnable && app.isAmRunning() && app.getAMResource() != null) {
    Resources.subtractFrom(amResourceUsage,app.getAMResource());
  }
  return runnable;
}
