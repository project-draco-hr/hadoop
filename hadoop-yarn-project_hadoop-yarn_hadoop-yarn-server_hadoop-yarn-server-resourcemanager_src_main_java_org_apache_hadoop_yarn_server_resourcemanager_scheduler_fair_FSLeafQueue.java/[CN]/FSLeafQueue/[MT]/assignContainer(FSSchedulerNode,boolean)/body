{
  LOG.debug("Node offered to queue: " + getName() + " reserved: "+ reserved);
  if (Resources.greaterThan(getResourceUsage(),queueMgr.getMaxResources(getName()))) {
    return Resources.none();
  }
  if (reserved) {
    for (    AppSchedulable sched : appScheds) {
      if (sched.getApp().getApplicationAttemptId() == node.getReservedContainer().getApplicationAttemptId()) {
        return sched.assignContainer(node,reserved);
      }
    }
    return Resources.none();
  }
 else {
    Comparator<Schedulable> comparator=schedulingMode.getComparator();
    Collections.sort(appScheds,comparator);
    for (    AppSchedulable sched : appScheds) {
      if (sched.getRunnable()) {
        Resource assignedResource=sched.assignContainer(node,reserved);
        if (!assignedResource.equals(Resources.none())) {
          return assignedResource;
        }
      }
    }
    return Resources.none();
  }
}
