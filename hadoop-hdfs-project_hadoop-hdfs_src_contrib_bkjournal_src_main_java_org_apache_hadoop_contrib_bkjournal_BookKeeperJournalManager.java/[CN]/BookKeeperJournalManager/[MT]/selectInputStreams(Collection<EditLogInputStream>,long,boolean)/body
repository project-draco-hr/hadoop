{
  while (true) {
    EditLogInputStream elis;
    try {
      elis=getInputStream(fromTxId,inProgressOk);
    }
 catch (    IOException e) {
      LOG.error(e);
      return;
    }
    if (elis == null) {
      return;
    }
    streams.add(elis);
    if (elis.getLastTxId() == HdfsConstants.INVALID_TXID) {
      return;
    }
    fromTxId=elis.getLastTxId() + 1;
  }
}
