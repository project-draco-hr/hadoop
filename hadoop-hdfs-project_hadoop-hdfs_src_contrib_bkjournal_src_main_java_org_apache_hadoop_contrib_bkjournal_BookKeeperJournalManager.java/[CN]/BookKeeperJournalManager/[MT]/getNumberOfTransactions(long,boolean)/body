{
  long count=0;
  long expectedStart=0;
  for (  EditLogLedgerMetadata l : getLedgerList()) {
    if (l.isInProgress()) {
      long endTxId=recoverLastTxId(l);
      if (endTxId == HdfsConstants.INVALID_TXID) {
        break;
      }
      count+=(endTxId - l.getFirstTxId()) + 1;
      break;
    }
    if (l.getFirstTxId() < fromTxnId) {
      continue;
    }
 else     if (l.getFirstTxId() == fromTxnId) {
      count=(l.getLastTxId() - l.getFirstTxId()) + 1;
      expectedStart=l.getLastTxId() + 1;
    }
 else {
      if (expectedStart != l.getFirstTxId()) {
        if (count == 0) {
          throw new CorruptionException("StartTxId " + l.getFirstTxId() + " is not as expected "+ expectedStart+ ". Gap in transaction log?");
        }
 else {
          break;
        }
      }
      count+=(l.getLastTxId() - l.getFirstTxId()) + 1;
      expectedStart=l.getLastTxId() + 1;
    }
  }
  return count;
}
