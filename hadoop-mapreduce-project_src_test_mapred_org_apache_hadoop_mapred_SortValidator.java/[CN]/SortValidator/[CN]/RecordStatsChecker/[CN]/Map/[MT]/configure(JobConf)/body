{
  key=deduceInputFile(job);
  if (key == sortOutput) {
    partitioner=new HashPartitioner<WritableComparable,Writable>();
    try {
      URI inputURI=new URI(job.get(JobContext.MAP_INPUT_FILE));
      String inputFile=inputURI.getPath();
      partition=Integer.valueOf(inputFile.substring(inputFile.lastIndexOf("part") + 7)).intValue();
      noSortReducers=job.getInt(SORT_REDUCES,-1);
    }
 catch (    Exception e) {
      System.err.println("Caught: " + e);
      System.exit(-1);
    }
  }
}
