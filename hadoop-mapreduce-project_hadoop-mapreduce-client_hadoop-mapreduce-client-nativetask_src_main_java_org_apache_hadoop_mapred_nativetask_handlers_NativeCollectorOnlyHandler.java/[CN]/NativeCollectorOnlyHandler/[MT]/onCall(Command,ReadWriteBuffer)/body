{
  Path p=null;
  if (null == command) {
    return null;
  }
  if (command.equals(GET_OUTPUT_PATH)) {
    p=output.getOutputFileForWrite(-1);
  }
 else   if (command.equals(GET_OUTPUT_INDEX_PATH)) {
    p=output.getOutputIndexFileForWrite(-1);
  }
 else   if (command.equals(GET_SPILL_PATH)) {
    p=output.getSpillFileForWrite(spillNumber++,-1);
  }
 else   if (command.equals(GET_COMBINE_HANDLER)) {
    if (null == combinerHandler) {
      return null;
    }
    final ReadWriteBuffer result=new ReadWriteBuffer(8);
    result.writeLong(combinerHandler.getId());
    return result;
  }
 else {
    throw new IOException("Illegal command: " + command.toString());
  }
  if (p != null) {
    final ReadWriteBuffer result=new ReadWriteBuffer();
    result.writeString(p.toUri().getPath());
    return result;
  }
 else {
    throw new IOException("MapOutputFile can't allocate spill/output file");
  }
}
