{
  ApplicationAttemptId appAttemptId=containerStatus.getContainerId().getApplicationAttemptId();
  RMApp rmApp=rmContext.getRMApps().get(appAttemptId.getApplicationId());
  if (rmApp == null) {
    LOG.error("Received finished container : " + containerStatus.getContainerId() + "for unknown application "+ appAttemptId.getApplicationId()+ " Skipping.");
    return;
  }
  if (rmApp.getApplicationSubmissionContext().getUnmanagedAM()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Ignoring container completion status for unmanaged AM" + rmApp.getApplicationId());
    }
    return;
  }
  RMAppAttempt rmAppAttempt=rmApp.getRMAppAttempt(appAttemptId);
  Container masterContainer=rmAppAttempt.getMasterContainer();
  if (masterContainer.getId().equals(containerStatus.getContainerId()) && containerStatus.getContainerState() == ContainerState.COMPLETE) {
    ContainerStatus status=ContainerStatus.newInstance(containerStatus.getContainerId(),containerStatus.getContainerState(),containerStatus.getDiagnostics(),containerStatus.getContainerExitStatus());
    RMAppAttemptContainerFinishedEvent evt=new RMAppAttemptContainerFinishedEvent(appAttemptId,status,nodeId);
    rmContext.getDispatcher().getEventHandler().handle(evt);
  }
}
