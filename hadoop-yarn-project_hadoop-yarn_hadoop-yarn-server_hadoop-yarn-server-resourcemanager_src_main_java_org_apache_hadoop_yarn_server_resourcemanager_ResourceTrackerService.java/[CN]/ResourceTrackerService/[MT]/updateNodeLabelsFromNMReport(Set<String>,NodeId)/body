{
  try {
    Map<NodeId,Set<String>> labelsUpdate=new HashMap<NodeId,Set<String>>();
    labelsUpdate.put(nodeId,nodeLabels);
    this.rmContext.getNodeLabelManager().replaceLabelsOnNode(labelsUpdate);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Node Labels {" + StringUtils.join(",",nodeLabels) + "} from Node "+ nodeId+ " were Accepted from RM");
    }
  }
 catch (  IOException ex) {
    StringBuilder errorMessage=new StringBuilder();
    errorMessage.append("Node Labels {").append(StringUtils.join(",",nodeLabels)).append("} reported from NM with ID ").append(nodeId).append(" was rejected from RM with exception message as : ").append(ex.getMessage());
    LOG.error(errorMessage,ex);
    throw new IOException(errorMessage.toString(),ex);
  }
}
