{
  if (!canShuffleToMemory(requestedSize)) {
    LOG.info(mapId + ": Shuffling to disk since " + requestedSize+ " is greater than maxSingleShuffleLimit ("+ maxSingleShuffleLimit+ ")");
    return new OnDiskMapOutput<K,V>(mapId,this,requestedSize,jobConf,fetcher,true,FileSystem.getLocal(jobConf).getRaw(),mapOutputFile.getInputFileForWrite(mapId.getTaskID(),requestedSize));
  }
  if (usedMemory > memoryLimit) {
    LOG.debug(mapId + ": Stalling shuffle since usedMemory (" + usedMemory+ ") is greater than memoryLimit ("+ memoryLimit+ ")."+ " CommitMemory is ("+ commitMemory+ ")");
    return null;
  }
  LOG.debug(mapId + ": Proceeding with shuffle since usedMemory (" + usedMemory+ ") is lesser than memoryLimit ("+ memoryLimit+ ")."+ "CommitMemory is ("+ commitMemory+ ")");
  return unconditionalReserve(mapId,requestedSize,true);
}
