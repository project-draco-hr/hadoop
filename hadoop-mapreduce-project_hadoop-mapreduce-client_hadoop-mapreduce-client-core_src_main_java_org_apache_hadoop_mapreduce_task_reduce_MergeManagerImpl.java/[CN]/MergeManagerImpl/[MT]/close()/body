{
  if (memToMemMerger != null) {
    memToMemMerger.close();
  }
  inMemoryMerger.close();
  onDiskMerger.close();
  List<InMemoryMapOutput<K,V>> memory=new ArrayList<InMemoryMapOutput<K,V>>(inMemoryMergedMapOutputs);
  inMemoryMergedMapOutputs.clear();
  memory.addAll(inMemoryMapOutputs);
  inMemoryMapOutputs.clear();
  List<CompressAwarePath> disk=new ArrayList<CompressAwarePath>(onDiskMapOutputs);
  onDiskMapOutputs.clear();
  return finalMerge(jobConf,rfs,memory,disk);
}
