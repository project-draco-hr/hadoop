{
  Map<Path,FsPermission> pathPermissionMap=getLocalDirsPathPermissionsMap(localDir);
  for (  Map.Entry<Path,FsPermission> entry : pathPermissionMap.entrySet()) {
    FileStatus status;
    try {
      status=lfs.getFileStatus(entry.getKey());
    }
 catch (    Exception e) {
      String msg="Could not carry out resource dir checks for " + localDir + ", which was marked as good";
      LOG.warn(msg,e);
      throw new YarnRuntimeException(msg,e);
    }
    if (!status.getPermission().equals(entry.getValue())) {
      String msg="Permissions incorrectly set for dir " + entry.getKey() + ", should be "+ entry.getValue()+ ", actual value = "+ status.getPermission();
      LOG.warn(msg);
      throw new YarnRuntimeException(msg);
    }
  }
  return true;
}
