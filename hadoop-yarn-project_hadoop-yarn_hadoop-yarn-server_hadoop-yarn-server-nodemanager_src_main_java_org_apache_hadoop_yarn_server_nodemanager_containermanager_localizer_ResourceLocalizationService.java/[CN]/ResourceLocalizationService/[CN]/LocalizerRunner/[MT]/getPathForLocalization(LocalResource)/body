{
  String user=context.getUser();
  ApplicationId appId=context.getContainerId().getApplicationAttemptId().getApplicationId();
  LocalResourceVisibility vis=rsrc.getVisibility();
  LocalResourcesTracker tracker=getLocalResourcesTracker(vis,user,appId);
  String cacheDirectory=null;
  if (vis == LocalResourceVisibility.PRIVATE) {
    cacheDirectory=getUserFileCachePath(user);
  }
 else {
    cacheDirectory=getAppFileCachePath(user,appId.toString());
  }
  Path dirPath=dirsHandler.getLocalPathForWrite(cacheDirectory,ContainerLocalizer.getEstimatedSize(rsrc),false);
  dirPath=tracker.getPathForLocalization(new LocalResourceRequest(rsrc),dirPath);
  return new Path(dirPath,Long.toString(tracker.nextUniqueNumber()));
}
