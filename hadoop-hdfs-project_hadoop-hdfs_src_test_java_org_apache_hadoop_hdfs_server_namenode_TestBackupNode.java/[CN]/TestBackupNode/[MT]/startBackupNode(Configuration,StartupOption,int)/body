{
  Configuration c=new HdfsConfiguration(conf);
  String dirs=getBackupNodeDir(startupOpt,idx);
  c.set(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY,dirs);
  c.set(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_KEY,"${" + DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY + "}");
  c.set(DFSConfigKeys.DFS_NAMENODE_BACKUP_ADDRESS_KEY,"127.0.0.1:0");
  BackupNode bn=(BackupNode)NameNode.createNameNode(new String[]{startupOpt.getName()},c);
  assertTrue(bn.getRole() + " must be in SafeMode.",bn.isInSafeMode());
  assertTrue(bn.getRole() + " must be in StandbyState",bn.getNamesystem().getHAState().equalsIgnoreCase(HAServiceState.STANDBY.name()));
  return bn;
}
