{
  Map<String,String> map=new HashMap<String,String>();
  StringTokenizer st=new StringTokenizer(tokenStr,ATTR_SEPARATOR);
  while (st.hasMoreTokens()) {
    String part=st.nextToken();
    int separator=part.indexOf('=');
    if (separator == -1) {
      throw new AuthenticationException("Invalid authentication token");
    }
    String key=part.substring(0,separator);
    String value=part.substring(separator + 1);
    map.put(key,value);
  }
  return map;
}
