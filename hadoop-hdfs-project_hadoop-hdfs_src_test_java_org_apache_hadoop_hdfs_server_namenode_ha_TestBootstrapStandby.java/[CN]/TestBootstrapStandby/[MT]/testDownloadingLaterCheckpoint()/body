{
  nn0.getRpcServer().rollEditLog();
  nn0.getRpcServer().rollEditLog();
  NameNodeAdapter.enterSafeMode(nn0,false);
  NameNodeAdapter.saveNamespace(nn0);
  NameNodeAdapter.leaveSafeMode(nn0);
  long expectedCheckpointTxId=NameNodeAdapter.getNamesystem(nn0).getFSImage().getMostRecentCheckpointTxId();
  assertEquals(6,expectedCheckpointTxId);
  for (int i=1; i < maxNNCount; i++) {
    assertEquals(0,forceBootstrap(i));
    LOG.info("Checking namenode: " + i);
    FSImageTestUtil.assertNNHasCheckpoints(cluster,i,ImmutableList.of((int)expectedCheckpointTxId));
  }
  FSImageTestUtil.assertNNFilesMatch(cluster);
  restartNameNodesFromIndex(1);
}
