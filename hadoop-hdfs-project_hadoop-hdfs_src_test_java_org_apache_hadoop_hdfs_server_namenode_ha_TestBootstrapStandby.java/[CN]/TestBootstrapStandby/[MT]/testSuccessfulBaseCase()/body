{
  removeStandbyNameDirs();
  try {
    cluster.restartNameNode(1);
    fail("Did not throw");
  }
 catch (  IOException ioe) {
    GenericTestUtils.assertExceptionContains("Cannot start an HA namenode with name dirs that need recovery",ioe);
  }
  int rc=BootstrapStandby.run(new String[]{"-nonInteractive"},cluster.getConfiguration(1));
  assertEquals(0,rc);
  FSImageTestUtil.assertNNHasCheckpoints(cluster,1,ImmutableList.of(0));
  assertNNFilesMatch();
  cluster.restartNameNode(1);
}
