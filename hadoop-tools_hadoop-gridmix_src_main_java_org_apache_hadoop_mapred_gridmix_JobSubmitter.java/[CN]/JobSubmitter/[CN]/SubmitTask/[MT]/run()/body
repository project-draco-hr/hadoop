{
  JobStats stats=Statistics.generateJobStats(job.getJob(),job.getJobDesc());
  try {
    try {
      long start=System.currentTimeMillis();
      job.buildSplits(inputDir);
      long end=System.currentTimeMillis();
      LOG.info("[JobSubmitter] Time taken to build splits for job " + job.getJob().getJobID() + ": "+ (end - start)+ " ms.");
    }
 catch (    IOException e) {
      LOG.warn("Failed to submit " + job.getJob().getJobName() + " as "+ job.getUgi(),e);
      monitor.submissionFailed(stats);
      return;
    }
catch (    Exception e) {
      LOG.warn("Failed to submit " + job.getJob().getJobName() + " as "+ job.getUgi(),e);
      monitor.submissionFailed(stats);
      return;
    }
    long nsDelay=job.getDelay(TimeUnit.NANOSECONDS);
    while (nsDelay > 0) {
      TimeUnit.NANOSECONDS.sleep(nsDelay);
      nsDelay=job.getDelay(TimeUnit.NANOSECONDS);
    }
    try {
      long start=System.currentTimeMillis();
      job.call();
      long end=System.currentTimeMillis();
      LOG.info("[JobSubmitter] Time taken to submit the job " + job.getJob().getJobID() + ": "+ (end - start)+ " ms.");
      job.setSubmitted();
      monitor.add(stats);
      statistics.addJobStats(stats);
      if (LOG.isDebugEnabled()) {
        String jobID=job.getJob().getConfiguration().get(Gridmix.ORIGINAL_JOB_ID);
        LOG.debug("Original job '" + jobID + "' is being simulated as '"+ job.getJob().getJobID()+ "'");
        LOG.debug("SUBMIT " + job + "@"+ System.currentTimeMillis()+ " ("+ job.getJob().getJobID()+ ")");
      }
    }
 catch (    IOException e) {
      LOG.warn("Failed to submit " + job.getJob().getJobName() + " as "+ job.getUgi(),e);
      if (e.getCause() instanceof ClosedByInterruptException) {
        throw new InterruptedException("Failed to submit " + job.getJob().getJobName());
      }
      monitor.submissionFailed(stats);
    }
catch (    ClassNotFoundException e) {
      LOG.warn("Failed to submit " + job.getJob().getJobName(),e);
      monitor.submissionFailed(stats);
    }
  }
 catch (  InterruptedException e) {
    GridmixJob.pullDescription(job.id());
    Thread.currentThread().interrupt();
    monitor.submissionFailed(stats);
  }
catch (  Exception e) {
    LOG.info(" Job " + job.getJob().getJobID() + " submission failed ",e);
    monitor.submissionFailed(stats);
  }
 finally {
    sem.release();
  }
}
