{
  CSAssignment assignment=new CSAssignment(Resources.createResource(0),NodeType.NODE_LOCAL);
  while (canAssign(node)) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Trying to assign containers to child-queue of " + getQueueName());
    }
    if (!assignToQueue(clusterResource)) {
      break;
    }
    CSAssignment assignedToChild=assignContainersToChildQueues(clusterResource,node);
    assignment.setType(assignedToChild.getType());
    if (Resources.greaterThan(assignedToChild.getResource(),Resources.none())) {
      allocateResource(clusterResource,assignedToChild.getResource());
      Resources.addTo(assignment.getResource(),assignedToChild.getResource());
      LOG.info("assignedContainer" + " queue=" + getQueueName() + " usedCapacity="+ getUsedCapacity()+ " absoluteUsedCapacity="+ getAbsoluteUsedCapacity()+ " used="+ usedResources+ " cluster="+ clusterResource);
    }
 else {
      break;
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("ParentQ=" + getQueueName() + " assignedSoFarInThisIteration="+ assignment.getResource()+ " usedCapacity="+ getUsedCapacity()+ " absoluteUsedCapacity="+ getAbsoluteUsedCapacity());
    }
    if (!rootQueue || assignment.getType() == NodeType.OFF_SWITCH) {
      if (LOG.isDebugEnabled()) {
        if (rootQueue && assignment.getType() == NodeType.OFF_SWITCH) {
          LOG.debug("Not assigning more than one off-switch container," + " assignments so far: " + assignment);
        }
      }
      break;
    }
  }
  return assignment;
}
