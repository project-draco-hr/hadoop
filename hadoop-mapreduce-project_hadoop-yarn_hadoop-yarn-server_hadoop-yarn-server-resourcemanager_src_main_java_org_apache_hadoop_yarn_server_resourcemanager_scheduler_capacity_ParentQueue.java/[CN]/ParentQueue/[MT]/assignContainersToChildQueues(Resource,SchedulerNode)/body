{
  Resource assigned=Resources.createResource(0);
  printChildQueues();
  for (Iterator<CSQueue> iter=childQueues.iterator(); iter.hasNext(); ) {
    CSQueue childQueue=iter.next();
    if (LOG.isDebugEnabled()) {
      LOG.debug("Trying to assign to queue: " + childQueue.getQueuePath() + " stats: "+ childQueue);
    }
    assigned=childQueue.assignContainers(cluster,node);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Assignedto queue: " + childQueue.getQueuePath() + " stats: "+ childQueue+ " --> "+ assigned.getMemory());
    }
    if (Resources.greaterThan(assigned,Resources.none())) {
      iter.remove();
      LOG.info("Re-sorting queues since queue: " + childQueue.getQueuePath() + " stats: "+ childQueue);
      childQueues.add(childQueue);
      printChildQueues();
      break;
    }
  }
  return assigned;
}
