{
  final int writtenSize=32 * 1024;
  final int slack=4 * 1024;
  File file=new File(DU_DIR,"data");
  createFile(file,writtenSize);
  Thread.sleep(5000);
  DU du=new DU(file,10000);
  du.start();
  long duSize=du.getUsed();
  du.shutdown();
  assertTrue("Invalid on-disk size",duSize >= writtenSize && writtenSize <= (duSize + slack));
  du=new DU(file,0);
  du.start();
  duSize=du.getUsed();
  du.shutdown();
  assertTrue("Invalid on-disk size",duSize >= writtenSize && writtenSize <= (duSize + slack));
  du=new DU(file,10000);
  duSize=du.getUsed();
  assertTrue("Invalid on-disk size",duSize >= writtenSize && writtenSize <= (duSize + slack));
}
