{
  String keyStr=key.toString();
  int pos=keyStr.indexOf(ValueAggregatorDescriptor.TYPE_SEPARATOR);
  String type=keyStr.substring(0,pos);
  long uniqCount=context.getConfiguration().getLong(UniqValueCount.MAX_NUM_UNIQUE_VALUES,Long.MAX_VALUE);
  ValueAggregator aggregator=ValueAggregatorBaseDescriptor.generateValueAggregator(type,uniqCount);
  for (  Text val : values) {
    aggregator.addNextValue(val);
  }
  Iterator<?> outputs=aggregator.getCombinerOutput().iterator();
  while (outputs.hasNext()) {
    Object v=outputs.next();
    if (v instanceof Text) {
      context.write(key,(Text)v);
    }
 else {
      context.write(key,new Text(v.toString()));
    }
  }
}
