{
  Check.notEmpty(user,"user");
  Check.notNull(conf,"conf");
  try {
    validateNamenode(new URI(conf.get(NAME_NODE_PROPERTY)).getAuthority());
    UserGroupInformation ugi=getUGI(user);
    return ugi.doAs(new PrivilegedExceptionAction<FileSystem>(){
      public FileSystem run() throws Exception {
        Configuration namenodeConf=createNameNodeConf(conf);
        return createFileSystem(namenodeConf);
      }
    }
);
  }
 catch (  IOException ex) {
    throw ex;
  }
catch (  FileSystemAccessException ex) {
    throw ex;
  }
catch (  Exception ex) {
    throw new FileSystemAccessException(FileSystemAccessException.ERROR.H08,ex.getMessage(),ex);
  }
}
