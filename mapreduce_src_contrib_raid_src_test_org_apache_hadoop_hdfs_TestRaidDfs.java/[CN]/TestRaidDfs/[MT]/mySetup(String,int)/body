{
  new File(TEST_DIR).mkdirs();
  conf=new Configuration();
  conf.set("fs.raid.recoverylogdir",LOG_DIR);
  conf.setInt(RaidNode.RS_PARITY_LENGTH_KEY,rsParityLength);
  conf.setLong("raid.policy.rescan.interval",5000);
  conf.set("fs.shell.delete.classname","org.apache.hadoop.hdfs.DFSClient");
  conf.set("raid.classname","org.apache.hadoop.raid.LocalRaidNode");
  conf.set("raid.server.address","localhost:0");
  conf.setInt("hdfs.raid.stripeLength",stripeLength);
  conf.set("xor".equals(erasureCode) ? RaidNode.RAID_LOCATION_KEY : RaidNode.RAIDRS_LOCATION_KEY,"/destraid");
  dfs=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATANODES).build();
  dfs.waitActive();
  fileSys=dfs.getFileSystem();
  namenode=fileSys.getUri().toString();
  hftp="hftp://localhost.localdomain:" + dfs.getNameNodePort();
  FileSystem.setDefaultUri(conf,namenode);
}
