{
  int numDeleted=0;
  int numCorrupted=0;
  for (int i=0; i < numDataNodes; i++) {
    File block=MiniDFSCluster.getBlockFile(i,blockNum);
    if (block == null || !block.exists()) {
      continue;
    }
    if (delete) {
      block.delete();
      LOG.info("Deleted block " + block);
      numDeleted++;
    }
 else {
      long seekPos=block.length() / 2;
      RandomAccessFile raf=new RandomAccessFile(block,"rw");
      raf.seek(seekPos);
      int data=raf.readInt();
      raf.seek(seekPos);
      raf.writeInt(data + 1);
      LOG.info("Corrupted block " + block);
      numCorrupted++;
    }
  }
  assertTrue("Nothing corrupted or deleted",(numCorrupted + numDeleted) > 0);
}
