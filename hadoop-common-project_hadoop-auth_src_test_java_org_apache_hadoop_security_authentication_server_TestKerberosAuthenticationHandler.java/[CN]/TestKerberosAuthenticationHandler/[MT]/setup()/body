{
  File keytabFile=new File(KerberosTestUtils.getKeytabFile());
  String clientPrincipal=KerberosTestUtils.getClientPrincipal();
  String serverPrincipal=KerberosTestUtils.getServerPrincipal();
  clientPrincipal=clientPrincipal.substring(0,clientPrincipal.lastIndexOf("@"));
  serverPrincipal=serverPrincipal.substring(0,serverPrincipal.lastIndexOf("@"));
  getKdc().createPrincipal(keytabFile,clientPrincipal,serverPrincipal);
  handler=getNewAuthenticationHandler();
  Properties props=getDefaultProperties();
  try {
    handler.init(props);
  }
 catch (  Exception ex) {
    handler=null;
    throw ex;
  }
}
