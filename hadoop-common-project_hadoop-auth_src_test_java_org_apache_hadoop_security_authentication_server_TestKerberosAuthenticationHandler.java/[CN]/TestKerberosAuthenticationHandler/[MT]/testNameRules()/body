{
  KerberosName kn=new KerberosName(KerberosTestUtils.getServerPrincipal());
  assertEquals(KerberosTestUtils.getRealm(),kn.getRealm());
  handler.destroy();
  KerberosName.setRules("RULE:[1:$1@$0](.*@FOO)s/@.*//\nDEFAULT");
  handler=getNewAuthenticationHandler();
  Properties props=getDefaultProperties();
  props.setProperty(KerberosAuthenticationHandler.NAME_RULES,"RULE:[1:$1@$0](.*@BAR)s/@.*//\nDEFAULT");
  try {
    handler.init(props);
  }
 catch (  Exception ex) {
  }
  kn=new KerberosName("bar@BAR");
  assertEquals("bar",kn.getShortName());
  kn=new KerberosName("bar@FOO");
  try {
    kn.getShortName();
    fail();
  }
 catch (  Exception ex) {
  }
}
