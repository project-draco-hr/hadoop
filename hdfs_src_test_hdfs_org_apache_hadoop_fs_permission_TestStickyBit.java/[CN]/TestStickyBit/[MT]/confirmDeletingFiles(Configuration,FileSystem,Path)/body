{
  Path p=new Path(baseDir,"contemporary");
  hdfs.mkdirs(p);
  hdfs.setPermission(p,new FsPermission((short)01777));
  hdfs=DFSTestUtil.getFileSystemAs(user1,conf);
  Path file=new Path(p,"foo");
  writeFile(hdfs,file);
  assertEquals(user1.getShortUserName(),hdfs.getFileStatus(file).getOwner());
  FileSystem hdfs2=DFSTestUtil.getFileSystemAs(user2,conf);
  try {
    hdfs2.delete(file,false);
    fail("Shouldn't be able to delete someone else's file with SB on");
  }
 catch (  IOException ioe) {
    assertTrue(ioe instanceof AccessControlException);
    assertTrue(ioe.getMessage().contains("sticky bit"));
  }
}
