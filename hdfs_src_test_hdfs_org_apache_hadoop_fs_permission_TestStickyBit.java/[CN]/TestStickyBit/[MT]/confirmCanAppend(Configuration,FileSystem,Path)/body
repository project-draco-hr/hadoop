{
  Path p=new Path(baseDir,"tmp");
  hdfs.mkdirs(p);
  hdfs.setPermission(p,new FsPermission((short)01777));
  hdfs=DFSTestUtil.getFileSystemAs(user1,conf);
  Path file=new Path(p,"foo");
  writeFile(hdfs,file);
  hdfs.setPermission(file,new FsPermission((short)0777));
  hdfs=DFSTestUtil.getFileSystemAs(user2,conf);
  Path file2=new Path(p,"foo");
  FSDataOutputStream h=hdfs.append(file2);
  h.write("Some more data".getBytes());
  h.close();
}
