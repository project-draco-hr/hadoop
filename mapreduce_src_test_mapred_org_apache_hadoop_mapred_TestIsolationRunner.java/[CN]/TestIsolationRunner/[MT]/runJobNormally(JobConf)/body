{
  final Path inDir=new Path(TEST_ROOT_DIR + "/isolationrunnerjob/input");
  final Path outDir=new Path(TEST_ROOT_DIR + "/isolationrunnerjob/output");
  FileSystem fs=FileSystem.get(conf);
  fs.delete(outDir,true);
  if (!fs.exists(inDir)) {
    fs.mkdirs(inDir);
  }
  String input="The quick brown fox jumps over lazy dog\n";
  DataOutputStream file=fs.create(new Path(inDir,"file"));
  file.writeBytes(input);
  file.close();
  conf.setInputFormat(TextInputFormat.class);
  conf.setMapperClass(SideEffectMapper.class);
  conf.setReducerClass(SideEffectReducer.class);
  FileInputFormat.setInputPaths(conf,inDir);
  FileOutputFormat.setOutputPath(conf,outDir);
  conf.setNumMapTasks(1);
  conf.setNumReduceTasks(1);
  JobClient jobClient=new JobClient(conf);
  RunningJob job=jobClient.submitJob(conf);
  job.waitForCompletion();
  return job.getID();
}
