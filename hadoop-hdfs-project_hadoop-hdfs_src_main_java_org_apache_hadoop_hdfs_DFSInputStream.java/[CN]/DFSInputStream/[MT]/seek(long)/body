{
  if (targetPos > getFileLength()) {
    throw new IOException("Cannot seek after EOF");
  }
  if (closed) {
    throw new IOException("Stream is closed!");
  }
  boolean done=false;
  if (pos <= targetPos && targetPos <= blockEnd) {
    int diff=(int)(targetPos - pos);
    if (diff <= DFSClient.TCP_WINDOW_SIZE) {
      try {
        pos+=blockReader.skip(diff);
        if (pos == targetPos) {
          done=true;
        }
      }
 catch (      IOException e) {
        if (DFSClient.LOG.isDebugEnabled()) {
          DFSClient.LOG.debug("Exception while seek to " + targetPos + " from "+ getCurrentBlock()+ " of "+ src+ " from "+ currentNode,e);
        }
      }
    }
  }
  if (!done) {
    pos=targetPos;
    blockEnd=-1;
  }
}
