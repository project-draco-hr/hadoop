{
  if (offset >= getFileLength()) {
    throw new IOException("Offset: " + offset + " exceeds file length: "+ getFileLength());
  }
synchronized (infoLock) {
    final List<LocatedBlock> blocks;
    final long lengthOfCompleteBlk=locatedBlocks.getFileLength();
    final boolean readOffsetWithinCompleteBlk=offset < lengthOfCompleteBlk;
    final boolean readLengthPastCompleteBlk=offset + length > lengthOfCompleteBlk;
    if (readOffsetWithinCompleteBlk) {
      blocks=getFinalizedBlockRange(offset,Math.min(length,lengthOfCompleteBlk - offset));
    }
 else {
      blocks=new ArrayList<LocatedBlock>(1);
    }
    if (readLengthPastCompleteBlk) {
      blocks.add(locatedBlocks.getLastLocatedBlock());
    }
    return blocks;
  }
}
