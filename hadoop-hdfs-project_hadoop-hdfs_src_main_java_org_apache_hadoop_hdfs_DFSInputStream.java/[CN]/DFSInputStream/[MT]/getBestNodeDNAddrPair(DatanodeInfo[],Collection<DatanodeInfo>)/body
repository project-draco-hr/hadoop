{
  DatanodeInfo chosenNode=bestNode(nodes,deadNodes,ignoredNodes);
  final String dnAddr=chosenNode.getXferAddr(dfsClient.getConf().connectToDnViaHostname);
  if (DFSClient.LOG.isDebugEnabled()) {
    DFSClient.LOG.debug("Connecting to datanode " + dnAddr);
  }
  InetSocketAddress targetAddr=NetUtils.createSocketAddr(dnAddr);
  return new DNAddrPair(chosenNode,targetAddr);
}
