{
  if (args.length == 0) {
    System.err.println("Too few arguments!");
    printUsage();
    return 1;
  }
  Path pattern=new Path(args[0]);
  FileSystem fs=pattern.getFileSystem(getConf());
  fs.setVerifyChecksum(true);
  for (  Path p : FileUtil.stat2Paths(fs.globStatus(pattern),pattern)) {
    List<FileStatus> inputFiles=new ArrayList<FileStatus>();
    FileStatus status=fs.getFileStatus(p);
    if (status.isDirectory()) {
      FileStatus[] files=fs.listStatus(p);
      Collections.addAll(inputFiles,files);
    }
 else {
      inputFiles.add(status);
    }
    return dumpTypedBytes(inputFiles);
  }
  return -1;
}
