{
  Arrays.sort(diffs,DiffInfo.sourceComparator);
  Random random=new Random();
  for (  DiffInfo diff : diffs) {
    Path tmpTarget=new Path(tmpDir,diff.source.getName());
    while (targetFs.exists(tmpTarget)) {
      tmpTarget=new Path(tmpDir,diff.source.getName() + random.nextInt());
    }
    diff.setTmp(tmpTarget);
    targetFs.rename(diff.source,tmpTarget);
  }
}
