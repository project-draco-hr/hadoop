{
  conf.set(DFSConfigKeys.DFS_NAMESERVICES,"ns1");
  conf.set(DFSConfigKeys.DFS_HA_NAMENODE_ID_KEY,"nn1");
  conf.set(DFSUtil.addKeySuffixes(DFSConfigKeys.DFS_HA_NAMENODES_KEY_PREFIX,"ns1"),"nn1,nn2");
  String baseDir=GenericTestUtils.getTestDir("setupRecoveryTestConf").getAbsolutePath();
  File nameDir=new File(baseDir,"nameR");
  File secondaryDir=new File(baseDir,"namesecondaryR");
  conf.set(DFSUtil.addKeySuffixes(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY,"ns1","nn1"),nameDir.getCanonicalPath());
  conf.set(DFSUtil.addKeySuffixes(DFSConfigKeys.DFS_NAMENODE_CHECKPOINT_DIR_KEY,"ns1","nn1"),secondaryDir.getCanonicalPath());
  conf.unset(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY);
  conf.unset(DFSConfigKeys.DFS_NAMENODE_CHECKPOINT_DIR_KEY);
  FileUtils.deleteQuietly(nameDir);
  if (!nameDir.mkdirs()) {
    throw new RuntimeException("failed to make directory " + nameDir.getAbsolutePath());
  }
  FileUtils.deleteQuietly(secondaryDir);
  if (!secondaryDir.mkdirs()) {
    throw new RuntimeException("failed to make directory " + secondaryDir.getAbsolutePath());
  }
}
