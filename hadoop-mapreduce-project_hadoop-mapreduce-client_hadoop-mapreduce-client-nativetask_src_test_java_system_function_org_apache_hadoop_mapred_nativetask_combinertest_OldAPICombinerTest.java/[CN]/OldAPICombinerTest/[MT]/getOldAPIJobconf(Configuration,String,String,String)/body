{
  final JobConf jobConf=new JobConf(configuration);
  final FileSystem fs=FileSystem.get(configuration);
  if (fs.exists(new Path(output))) {
    fs.delete(new Path(output),true);
  }
  fs.close();
  jobConf.setJobName(name);
  jobConf.setOutputKeyClass(Text.class);
  jobConf.setOutputValueClass(IntWritable.class);
  jobConf.setMapperClass(WordCountWithOldAPI.TokenizerMapperWithOldAPI.class);
  jobConf.setCombinerClass(WordCountWithOldAPI.IntSumReducerWithOldAPI.class);
  jobConf.setReducerClass(WordCountWithOldAPI.IntSumReducerWithOldAPI.class);
  jobConf.setInputFormat(SequenceFileInputFormat.class);
  jobConf.setOutputFormat(TextOutputFormat.class);
  FileInputFormat.setInputPaths(jobConf,new Path(input));
  FileOutputFormat.setOutputPath(jobConf,new Path(output));
  return jobConf;
}
