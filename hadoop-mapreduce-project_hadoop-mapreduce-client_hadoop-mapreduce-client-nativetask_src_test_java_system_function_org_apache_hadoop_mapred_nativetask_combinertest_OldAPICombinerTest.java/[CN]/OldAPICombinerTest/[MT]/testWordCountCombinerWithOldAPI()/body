{
  final Configuration nativeConf=ScenarioConfiguration.getNativeConfiguration();
  nativeConf.addResource(TestConstants.COMBINER_CONF_PATH);
  final String nativeoutput=nativeConf.get(TestConstants.OLDAPI_NATIVETASK_TEST_COMBINER_OUTPUTPATH);
  final JobConf nativeJob=getOldAPIJobconf(nativeConf,"nativeCombinerWithOldAPI",inputpath,nativeoutput);
  RunningJob nativeRunning=JobClient.runJob(nativeJob);
  Counter nativeReduceGroups=nativeRunning.getCounters().findCounter(Task.Counter.REDUCE_INPUT_RECORDS);
  final Configuration normalConf=ScenarioConfiguration.getNormalConfiguration();
  normalConf.addResource(TestConstants.COMBINER_CONF_PATH);
  final String normaloutput=normalConf.get(TestConstants.OLDAPI_NORMAL_TEST_COMBINER_OUTPUTPATH);
  final JobConf normalJob=getOldAPIJobconf(normalConf,"normalCombinerWithOldAPI",inputpath,normaloutput);
  RunningJob normalRunning=JobClient.runJob(normalJob);
  Counter normalReduceGroups=normalRunning.getCounters().findCounter(Task.Counter.REDUCE_INPUT_RECORDS);
  final boolean compareRet=ResultVerifier.verify(nativeoutput,normaloutput);
  assertEquals("file compare result: if they are the same ,then return true",true,compareRet);
  assertEquals("The input reduce record count must be same",nativeReduceGroups.getValue(),normalReduceGroups.getValue());
}
