{
  if (!changed) {
    return;
  }
  for (  Map.Entry<String,Metadata> entry : cache.entrySet()) {
    try {
      keyStore.setKeyEntry(entry.getKey(),new KeyMetadata(entry.getValue()),password,null);
    }
 catch (    KeyStoreException e) {
      throw new IOException("Can't set metadata key " + entry.getKey(),e);
    }
  }
  FSDataOutputStream out=fs.create(path,true);
  try {
    keyStore.store(out,password);
  }
 catch (  KeyStoreException e) {
    throw new IOException("Can't store keystore " + this,e);
  }
catch (  NoSuchAlgorithmException e) {
    throw new IOException("No such algorithm storing keystore " + this,e);
  }
catch (  CertificateException e) {
    throw new IOException("Certificate exception storing keystore " + this,e);
  }
  out.close();
  changed=false;
}
