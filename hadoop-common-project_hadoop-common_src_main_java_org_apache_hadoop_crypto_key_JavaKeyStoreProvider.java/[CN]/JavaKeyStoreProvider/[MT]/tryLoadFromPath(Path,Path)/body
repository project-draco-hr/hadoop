{
  FsPermission perm=null;
  try {
    perm=loadFromPath(path,password);
    if (fs.exists(backupPath)) {
      fs.delete(backupPath,true);
    }
    LOG.debug("KeyStore loaded successfully !!");
  }
 catch (  IOException ioe) {
    if (!isBadorWrongPassword(ioe)) {
      perm=loadFromPath(backupPath,password);
      renameOrFail(path,new Path(path.toString() + "_CORRUPTED_" + System.currentTimeMillis()));
      renameOrFail(backupPath,path);
      LOG.debug(String.format("KeyStore loaded successfully from '%s' since '%s'" + "was corrupted !!",backupPath,path));
    }
 else {
      throw ioe;
    }
  }
  return perm;
}
