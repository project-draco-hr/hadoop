{
  this.uri=uri;
  path=unnestUri(uri);
  fs=path.getFileSystem(conf);
  String pw=System.getenv(KEYSTORE_PASSWORD_NAME);
  if (pw == null) {
    pw=KEYSTORE_PASSWORD_DEFAULT;
  }
  password=pw.toCharArray();
  try {
    keyStore=KeyStore.getInstance(SCHEME_NAME);
    if (fs.exists(path)) {
      FileStatus s=fs.getFileStatus(path);
      permissions=s.getPermission();
      keyStore.load(fs.open(path),password);
    }
 else {
      permissions=new FsPermission("700");
      keyStore.load(null,password);
    }
  }
 catch (  KeyStoreException e) {
    throw new IOException("Can't create keystore",e);
  }
catch (  NoSuchAlgorithmException e) {
    throw new IOException("Can't load keystore " + path,e);
  }
catch (  CertificateException e) {
    throw new IOException("Can't load keystore " + path,e);
  }
  ReadWriteLock lock=new ReentrantReadWriteLock(true);
  readLock=lock.readLock();
  writeLock=lock.writeLock();
}
