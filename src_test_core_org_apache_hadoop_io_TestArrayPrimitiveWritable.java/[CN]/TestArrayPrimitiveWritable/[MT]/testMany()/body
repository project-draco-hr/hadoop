{
  for (  Object x : bigSet) {
    ObjectWritable.writeObject(out,x,x.getClass(),null,true);
    (new ArrayPrimitiveWritable(x)).write(out);
  }
  in.reset(out.getData(),out.getLength());
  for (int x=0; x < resultSet.length; ) {
    resultSet[x++]=ObjectWritable.readObject(in,null);
    ArrayPrimitiveWritable apw=new ArrayPrimitiveWritable();
    apw.readFields(in);
    resultSet[x++]=apw.get();
  }
  assertEquals(expectedResultSet.length,resultSet.length);
  for (int x=0; x < resultSet.length; x++) {
    assertEquals("ComponentType of array " + x,expectedResultSet[x].getClass().getComponentType(),resultSet[x].getClass().getComponentType());
  }
  assertTrue("In and Out arrays didn't match values",Arrays.deepEquals(expectedResultSet,resultSet));
}
