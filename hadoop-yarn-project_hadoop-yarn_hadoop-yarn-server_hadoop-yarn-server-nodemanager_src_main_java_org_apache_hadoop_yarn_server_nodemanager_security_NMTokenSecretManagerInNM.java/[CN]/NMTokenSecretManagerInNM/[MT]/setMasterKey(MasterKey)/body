{
  LOG.info("Rolling master-key for nm-tokens, got key with id :" + masterKey.getKeyId());
  if (super.currentMasterKey == null) {
    super.currentMasterKey=new MasterKeyData(masterKey,createSecretKey(masterKey.getBytes().array()));
  }
 else {
    if (super.currentMasterKey.getMasterKey().getKeyId() != masterKey.getKeyId()) {
      this.previousMasterKey=super.currentMasterKey;
      super.currentMasterKey=new MasterKeyData(masterKey,createSecretKey(masterKey.getBytes().array()));
    }
  }
}
