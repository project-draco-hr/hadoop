{
  QueueConfigurationParser cp=getQueueConfigurationParser(conf,true,areAclsEnabled);
  if (!root.isHierarchySameAs(cp.getRoot())) {
    LOG.warn(MSG_REFRESH_FAILURE_WITH_CHANGE_OF_HIERARCHY);
    throw new IOException(MSG_REFRESH_FAILURE_WITH_CHANGE_OF_HIERARCHY);
  }
  if (schedulerRefresher != null) {
    try {
      schedulerRefresher.refreshQueues(cp.getRoot().getJobQueueInfo().getChildren());
    }
 catch (    Throwable e) {
      StringBuilder msg=new StringBuilder("Scheduler's refresh-queues failed with the exception : " + StringUtils.stringifyException(e));
      msg.append("\n");
      msg.append(MSG_REFRESH_FAILURE_WITH_SCHEDULER_FAILURE);
      LOG.error(msg.toString());
      throw new IOException(msg.toString());
    }
  }
  cp.getRoot().copySchedulingInfo(this.root);
  initialize(cp);
  LOG.info("Queue configuration is refreshed successfully.");
}
