{
  tasks=job.getAllTasks();
  for (  JobHistoryParser.TaskInfo task : tasks.values()) {
    Map<TaskAttemptID,JobHistoryParser.TaskAttemptInfo> attempts=task.getAllTaskAttempts();
    for (    JobHistoryParser.TaskAttemptInfo attempt : attempts.values()) {
      long startTime=attempt.getStartTime();
      long finishTime=attempt.getFinishTime();
      if (attempt.getTaskType().equals(TaskType.MAP)) {
        if (mapStarted == 0 || mapStarted > startTime) {
          mapStarted=startTime;
        }
        if (mapFinished < finishTime) {
          mapFinished=finishTime;
        }
        totalMaps++;
        if (attempt.getTaskStatus().equals(TaskStatus.State.FAILED.toString())) {
          numFailedMaps++;
        }
 else         if (attempt.getTaskStatus().equals(TaskStatus.State.KILLED.toString())) {
          numKilledMaps++;
        }
      }
 else       if (attempt.getTaskType().equals(TaskType.REDUCE)) {
        if (reduceStarted == 0 || reduceStarted > startTime) {
          reduceStarted=startTime;
        }
        if (reduceFinished < finishTime) {
          reduceFinished=finishTime;
        }
        totalReduces++;
        if (attempt.getTaskStatus().equals(TaskStatus.State.FAILED.toString())) {
          numFailedReduces++;
        }
 else         if (attempt.getTaskStatus().equals(TaskStatus.State.KILLED.toString())) {
          numKilledReduces++;
        }
      }
 else       if (attempt.getTaskType().equals(TaskType.JOB_CLEANUP)) {
        if (cleanupStarted == 0 || cleanupStarted > startTime) {
          cleanupStarted=startTime;
        }
        if (cleanupFinished < finishTime) {
          cleanupFinished=finishTime;
        }
        totalCleanups++;
        if (attempt.getTaskStatus().equals(TaskStatus.State.SUCCEEDED.toString())) {
          numFinishedCleanups++;
        }
 else         if (attempt.getTaskStatus().equals(TaskStatus.State.FAILED.toString())) {
          numFailedCleanups++;
        }
 else         if (attempt.getTaskStatus().equals(TaskStatus.State.KILLED.toString())) {
          numKilledCleanups++;
        }
      }
 else       if (attempt.getTaskType().equals(TaskType.JOB_SETUP)) {
        if (setupStarted == 0 || setupStarted > startTime) {
          setupStarted=startTime;
        }
        if (setupFinished < finishTime) {
          setupFinished=finishTime;
        }
        totalSetups++;
        if (attempt.getTaskStatus().equals(TaskStatus.State.SUCCEEDED.toString())) {
          numFinishedSetups++;
        }
 else         if (attempt.getTaskStatus().equals(TaskStatus.State.FAILED.toString())) {
          numFailedSetups++;
        }
 else         if (attempt.getTaskStatus().equals(TaskStatus.State.KILLED.toString())) {
          numKilledSetups++;
        }
      }
    }
  }
}
