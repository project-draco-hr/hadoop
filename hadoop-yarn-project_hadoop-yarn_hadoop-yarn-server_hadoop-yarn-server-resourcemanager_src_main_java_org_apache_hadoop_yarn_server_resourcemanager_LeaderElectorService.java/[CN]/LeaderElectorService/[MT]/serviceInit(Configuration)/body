{
  String zkHostPort=conf.get(YarnConfiguration.RM_ZK_ADDRESS);
  Preconditions.checkNotNull(zkHostPort,YarnConfiguration.RM_ZK_ADDRESS + " is not set");
  rmId=HAUtil.getRMHAId(conf);
  String clusterId=YarnConfiguration.getClusterId(conf);
  int zkSessionTimeout=conf.getInt(YarnConfiguration.RM_ZK_TIMEOUT_MS,YarnConfiguration.DEFAULT_RM_ZK_TIMEOUT_MS);
  int maxRetryNum=conf.getInt(YarnConfiguration.RM_ZK_NUM_RETRIES,YarnConfiguration.DEFAULT_ZK_RM_NUM_RETRIES);
  String zkBasePath=conf.get(YarnConfiguration.AUTO_FAILOVER_ZK_BASE_PATH,YarnConfiguration.DEFAULT_AUTO_FAILOVER_ZK_BASE_PATH);
  latchPath=zkBasePath + "/" + clusterId;
  curator=CuratorFrameworkFactory.builder().connectString(zkHostPort).retryPolicy(new RetryNTimes(maxRetryNum,zkSessionTimeout)).build();
  curator.start();
  initAndStartLeaderLatch();
  super.serviceInit(conf);
}
