{
  HttpServletRequest request=Mockito.mock(HttpServletRequest.class);
  HttpServletResponse response=Mockito.mock(HttpServletResponse.class);
  Token<DelegationTokenIdentifier> dToken=HttpFSServerWebApp.get().get(DelegationTokenManager.class).createToken(UserGroupInformation.getCurrentUser(),"user");
  Mockito.when(request.getParameter(HttpFSKerberosAuthenticator.DELEGATION_PARAM)).thenReturn(dToken.encodeToUrlString());
  AuthenticationToken token=handler.authenticate(request,response);
  Assert.assertEquals(UserGroupInformation.getCurrentUser().getShortUserName(),token.getUserName());
  Assert.assertEquals(0,token.getExpires());
  Assert.assertEquals(HttpFSKerberosAuthenticationHandler.TYPE,token.getType());
  Assert.assertTrue(token.isExpired());
}
