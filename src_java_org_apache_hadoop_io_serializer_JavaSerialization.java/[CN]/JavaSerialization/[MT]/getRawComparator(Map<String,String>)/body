{
  Class<?> klazz=getClassFromMetadata(metadata);
  if (null == klazz) {
    throw new IllegalArgumentException("Cannot get comparator without " + SerializationBase.CLASS_KEY + " set in metadata");
  }
  if (Serializable.class.isAssignableFrom(klazz)) {
    try {
      return (RawComparator<Serializable>)new JavaSerializationComparator();
    }
 catch (    IOException ioe) {
      throw new IllegalArgumentException("Could not instantiate JavaSerializationComparator for type " + klazz.getName(),ioe);
    }
  }
 else {
    throw new IllegalArgumentException("Class " + klazz.getName() + " is incompatible with JavaSerialization");
  }
}
