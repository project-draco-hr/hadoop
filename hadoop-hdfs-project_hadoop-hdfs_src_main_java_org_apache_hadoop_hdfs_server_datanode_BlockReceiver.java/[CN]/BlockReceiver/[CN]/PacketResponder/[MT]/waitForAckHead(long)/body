{
synchronized (ackQueue) {
    while (isRunning() && ackQueue.size() == 0) {
      if (LOG.isDebugEnabled()) {
        LOG.debug(myString + ": seqno=" + seqno+ " waiting for local datanode to finish write.");
      }
      ackQueue.wait();
    }
    return isRunning() ? ackQueue.getFirst() : null;
  }
}
