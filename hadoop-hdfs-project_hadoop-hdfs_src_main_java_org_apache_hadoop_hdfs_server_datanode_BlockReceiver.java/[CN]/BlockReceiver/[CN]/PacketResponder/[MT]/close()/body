{
  while (running && ackQueue.size() != 0 && datanode.shouldRun) {
    try {
      wait();
    }
 catch (    InterruptedException e) {
      running=false;
      Thread.currentThread().interrupt();
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug(myString + ": closing");
  }
  running=false;
  notifyAll();
}
