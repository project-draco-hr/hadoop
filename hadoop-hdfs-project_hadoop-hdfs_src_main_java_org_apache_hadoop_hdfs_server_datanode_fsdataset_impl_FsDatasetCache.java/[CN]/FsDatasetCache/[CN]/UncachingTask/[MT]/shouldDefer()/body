{
  if (revocationTimeMs == 0) {
    return false;
  }
  boolean anchored=!dataset.datanode.getShortCircuitRegistry().processBlockMunlockRequest(key);
  if (!anchored) {
    LOG.debug("Uncaching {} now that it is no longer in use " + "by any clients.",key);
    return false;
  }
  long delta=revocationTimeMs - Time.monotonicNow();
  if (delta < 0) {
    LOG.warn("Forcibly uncaching {} after {} " + "because client(s) {} refused to stop using it.",key,DurationFormatUtils.formatDurationHMS(revocationTimeMs),dataset.datanode.getShortCircuitRegistry().getClientNames(key));
    return false;
  }
  LOG.info("Replica {} still can't be uncached because some " + "clients continue to use it.  Will wait for {}",key,DurationFormatUtils.formatDurationHMS(delta));
  return true;
}
