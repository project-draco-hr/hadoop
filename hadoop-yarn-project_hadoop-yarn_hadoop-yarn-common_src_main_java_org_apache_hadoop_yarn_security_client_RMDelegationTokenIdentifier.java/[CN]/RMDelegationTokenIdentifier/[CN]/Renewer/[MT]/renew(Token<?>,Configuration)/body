{
  final ClientRMProtocol rmClient=getRmClient(token,conf);
  if (rmClient != null) {
    try {
      RenewDelegationTokenRequest request=Records.newRecord(RenewDelegationTokenRequest.class);
      request.setDelegationToken(convertToProtoToken(token));
      return rmClient.renewDelegationToken(request).getNextExpirationTime();
    }
 catch (    YarnRemoteException e) {
      throw new IOException(e);
    }
 finally {
      RPC.stopProxy(rmClient);
    }
  }
 else {
    return localSecretManager.renewToken((Token<RMDelegationTokenIdentifier>)token,getRenewer(token));
  }
}
