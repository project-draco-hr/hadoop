{
  int n=5;
  String bpid=cluster.getNamesystem(0).getBlockPoolId();
  DataNode dn=cluster.getDataNodes().get(0);
  long blocksScanned, total;
  do {
    try {
      Thread.sleep(SLEEP_PERIOD_MS);
    }
 catch (    InterruptedException e) {
      fail("Interrupted: " + e);
    }
    blocksScanned=dn.blockScanner.getBlocksScannedInLastRun(bpid);
    total=dn.blockScanner.getTotalScans(bpid);
    LOG.info("bpid = " + bpid + " blocksScanned = "+ blocksScanned+ " total="+ total);
  }
 while (n-- > 0 && (blocksScanned != scansLastRun || scansTotal != total));
  Assert.assertEquals(scansTotal,total);
  Assert.assertEquals(scansLastRun,blocksScanned);
}
