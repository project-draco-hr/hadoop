{
  hdfs.mkdirs(sub1);
  hdfs.allowSnapshot(sub1);
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPL,SEED);
  hdfs.createSnapshot(sub1,snap1);
  hdfs.rename(file1,file2);
  hdfs.createSnapshot(sub1,snap2);
  hdfs.rename(file2,file3);
  SnapshotDiffReport diffReport;
  diffReport=hdfs.getSnapshotDiffReport(sub1,snap1,snap2);
  LOG.info("DiffList is " + diffReport.toString());
  List<DiffReportEntry> entries=diffReport.getDiffList();
  assertTrue(entries.size() == 3);
  assertTrue(existsInDiffReport(entries,DiffType.MODIFY,""));
  assertTrue(existsInDiffReport(entries,DiffType.CREATE,file2.getName()));
  assertTrue(existsInDiffReport(entries,DiffType.DELETE,file1.getName()));
  diffReport=hdfs.getSnapshotDiffReport(sub1,snap2,"");
  LOG.info("DiffList is " + diffReport.toString());
  entries=diffReport.getDiffList();
  assertTrue(entries.size() == 3);
  assertTrue(existsInDiffReport(entries,DiffType.MODIFY,""));
  assertTrue(existsInDiffReport(entries,DiffType.CREATE,file3.getName()));
  assertTrue(existsInDiffReport(entries,DiffType.DELETE,file2.getName()));
  diffReport=hdfs.getSnapshotDiffReport(sub1,snap1,"");
  LOG.info("DiffList is " + diffReport.toString());
  entries=diffReport.getDiffList();
  assertTrue(entries.size() == 3);
  assertTrue(existsInDiffReport(entries,DiffType.MODIFY,""));
  assertTrue(existsInDiffReport(entries,DiffType.CREATE,file3.getName()));
  assertTrue(existsInDiffReport(entries,DiffType.DELETE,file1.getName()));
}
