{
  Thread.currentThread().setContextClassLoader(new ClusterWithCapacityScheduler.MyClassLoader());
  JobConf clusterConf=new JobConf();
  if (clusterProperties != null) {
    for (Enumeration<?> e=clusterProperties.propertyNames(); e.hasMoreElements(); ) {
      String key=(String)e.nextElement();
      clusterConf.set(key,(String)clusterProperties.get(key));
    }
  }
  if (schedulerProperties != null) {
    setUpSchedulerConfigFile(schedulerProperties);
  }
  clusterConf.set(JTConfig.JT_TASK_SCHEDULER,CapacityTaskScheduler.class.getName());
  mrCluster=new MiniMRCluster(numTaskTrackers,"file:///",1,null,null,clusterConf);
  this.jobConf=mrCluster.createJobConf(clusterConf);
}
