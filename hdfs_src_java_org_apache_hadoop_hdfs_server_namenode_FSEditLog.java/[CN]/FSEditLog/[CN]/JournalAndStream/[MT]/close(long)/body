{
  Preconditions.checkArgument(lastTxId >= segmentStartsAtTxId,"invalid segment: lastTxId %s >= " + "segment starting txid %s",lastTxId,segmentStartsAtTxId);
  if (stream == null)   return;
  stream.close();
  manager.finalizeLogSegment(segmentStartsAtTxId,lastTxId);
  stream=null;
}
