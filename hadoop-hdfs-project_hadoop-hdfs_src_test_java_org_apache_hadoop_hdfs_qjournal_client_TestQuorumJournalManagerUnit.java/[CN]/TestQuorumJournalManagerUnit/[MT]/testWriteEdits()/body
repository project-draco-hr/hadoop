{
  EditLogOutputStream stm=createLogSegment();
  writeOp(stm,1);
  writeOp(stm,2);
  stm.setReadyToFlush();
  writeOp(stm,3);
  futureReturns(null).when(spyLoggers.get(0)).sendEdits(eq(1L),eq(2),Mockito.<byte[]>any());
  futureReturns(null).when(spyLoggers.get(1)).sendEdits(eq(1L),eq(2),Mockito.<byte[]>any());
  futureReturns(null).when(spyLoggers.get(2)).sendEdits(eq(1L),eq(2),Mockito.<byte[]>any());
  stm.flush();
  stm.setReadyToFlush();
  futureReturns(null).when(spyLoggers.get(0)).sendEdits(eq(3L),eq(1),Mockito.<byte[]>any());
  futureReturns(null).when(spyLoggers.get(1)).sendEdits(eq(3L),eq(1),Mockito.<byte[]>any());
  futureReturns(null).when(spyLoggers.get(2)).sendEdits(eq(3L),eq(1),Mockito.<byte[]>any());
  stm.flush();
}
