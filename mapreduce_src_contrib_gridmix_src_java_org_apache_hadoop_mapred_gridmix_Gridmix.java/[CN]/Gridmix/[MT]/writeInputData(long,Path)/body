{
  final Configuration conf=getConf();
  CompressionEmulationUtil.setupDataGeneratorConfig(conf);
  final GenerateData genData=new GenerateData(conf,inputDir,genbytes);
  LOG.info("Generating " + StringUtils.humanReadableInt(genbytes) + " of test data...");
  launchGridmixJob(genData);
  FsShell shell=new FsShell(conf);
  try {
    LOG.info("Changing the permissions for inputPath " + inputDir.toString());
    shell.run(new String[]{"-chmod","-R","777",inputDir.toString()});
  }
 catch (  Exception e) {
    LOG.error("Couldnt change the file permissions ",e);
    throw new IOException(e);
  }
  LOG.info("Input data generation successful.");
}
