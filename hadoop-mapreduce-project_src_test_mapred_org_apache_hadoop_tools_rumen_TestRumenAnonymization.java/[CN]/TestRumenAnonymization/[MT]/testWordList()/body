{
  WordList wordList=new WordList();
  assertFalse("Word list state incorrect",wordList.isUpdated());
  String test="abbracadabra";
  wordList.add(test);
  assertTrue("Word list failed to store",wordList.contains(test));
  assertEquals("Word list index failed",0,wordList.indexOf(test));
  assertEquals("Word list size failed",1,wordList.getSize());
  assertTrue("Word list state incorrect",wordList.isUpdated());
  wordList.add(test);
  assertEquals("Word list index failed",0,wordList.indexOf(test));
  assertEquals("Word list size failed",1,wordList.getSize());
  assertTrue("Word list state incorrect",wordList.isUpdated());
  String test2="hakuna-matata";
  wordList.add(test2);
  assertTrue("Word list failed to store",wordList.contains(test2));
  assertEquals("Word list index failed",1,wordList.indexOf(test2));
  assertEquals("Word list size failed",2,wordList.getSize());
  assertTrue("Word list state incorrect",wordList.isUpdated());
  Configuration conf=new Configuration();
  FileSystem lfs=FileSystem.getLocal(conf);
  Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp"));
  Path tempDir=new Path(rootTempDir,"testWordList");
  tempDir=lfs.makeQualified(tempDir);
  lfs.delete(tempDir,true);
  StatePool pool=new StatePool();
  try {
    conf.set(StatePool.DIR_CONFIG,tempDir.toString());
    conf.setBoolean(StatePool.PERSIST_CONFIG,true);
    pool.initialize(conf);
    pool.addState(getClass(),wordList);
    pool.persist();
    pool=new StatePool();
    conf.setBoolean(StatePool.RELOAD_CONFIG,true);
    pool.initialize(conf);
    State state=pool.getState(getClass());
    assertNotNull("Missing state!",state);
    assertEquals("Incorrect state class!",WordList.class,state.getClass());
    WordList pList=(WordList)state;
    assertEquals("Word list size on reload failed",2,pList.getSize());
    assertFalse("Word list state incorrect",pList.isUpdated());
    pList.add(test);
    assertEquals("Word list index on reload failed",0,pList.indexOf(test));
    assertEquals("Word list size on reload failed",2,pList.getSize());
    assertFalse("Word list state on reload incorrect",pList.isUpdated());
    String test3="disco-dancer";
    assertFalse("Word list failed to after reload",pList.contains(test3));
    pList.add(test3);
    assertTrue("Word list failed to store on reload",pList.contains(test3));
    assertEquals("Word list index on reload failed",2,pList.indexOf(test3));
    assertEquals("Word list size on reload failed",3,pList.getSize());
    assertTrue("Word list state on reload incorrect",pList.isUpdated());
    assertTrue("Word list failed to store on reload",pList.contains(test2));
    assertEquals("Word list index on reload failed",1,pList.indexOf(test2));
  }
  finally {
    lfs.delete(tempDir,true);
  }
}
