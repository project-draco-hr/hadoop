{
  JsonSerializer<?> defaultSerializer=new DefaultRumenSerializer();
  JsonSerializer<?> anonymizingSerializer=new DefaultAnonymizingRumenSerializer(new StatePool(),new Configuration());
  ClassName cName=new ClassName(TestRumenAnonymization.class.getName());
  assertEquals("Classname error!",TestRumenAnonymization.class.getName(),cName.getValue());
  testSerializer(new ClassName("org.apache.hadoop.Test"),"org.apache.hadoop.Test",defaultSerializer);
  testSerializer(new ClassName("org.apache.hadoop.Test2"),"org.apache.hadoop.Test2",defaultSerializer);
  testSerializer(new ClassName("org.apache.hadoop.Test1"),"class0",anonymizingSerializer);
  testSerializer(new ClassName("org.apache.hadoop.Test2"),"class1",anonymizingSerializer);
  Configuration conf=new Configuration();
  conf.set(ClassName.CLASSNAME_PRESERVE_CONFIG,"org.apache.hadoop.");
  anonymizingSerializer=new DefaultAnonymizingRumenSerializer(new StatePool(),conf);
  testSerializer(new ClassName("org.apache.hadoop.Test3"),"org.apache.hadoop.Test3",anonymizingSerializer);
  testSerializer(new ClassName("org.apache.hadoop2.Test4"),"class0",anonymizingSerializer);
}
