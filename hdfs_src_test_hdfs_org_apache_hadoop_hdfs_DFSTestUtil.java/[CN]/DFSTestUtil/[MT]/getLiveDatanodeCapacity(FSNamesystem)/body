{
  ArrayList<DatanodeDescriptor> live=new ArrayList<DatanodeDescriptor>();
  ArrayList<DatanodeDescriptor> dead=new ArrayList<DatanodeDescriptor>();
  ns.DFSNodesStatus(live,dead);
  long capacity=0;
  for (  final DatanodeDescriptor dn : live) {
    capacity+=dn.getCapacity();
  }
  return capacity;
}
