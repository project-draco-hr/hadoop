{
  Path root=new Path(topdir);
  for (int idx=0; idx < nFiles; idx++) {
    Path fPath=new Path(root,files[idx].getName());
    FSDataInputStream in=fs.open(fPath);
    byte[] toRead=new byte[files[idx].getSize()];
    byte[] toCompare=new byte[files[idx].getSize()];
    Random rb=new Random(files[idx].getSeed());
    rb.nextBytes(toCompare);
    in.readFully(0,toRead);
    in.close();
    for (int i=0; i < toRead.length; i++) {
      if (toRead[i] != toCompare[i]) {
        return false;
      }
    }
    toRead=null;
    toCompare=null;
  }
  return true;
}
