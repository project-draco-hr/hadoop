def __setupClusterState(self, clusterStateMap, verifyDirIsAbsent=True):
    for clusterDir in clusterStateMap.keys():
        if verifyDirIsAbsent:
            self.assertFalse(os.path.exists(clusterDir))
    self.state.write(TEST_CLUSTER_DATA_FILE, clusterStateMap)
    state = self.state.read(TEST_CLUSTER_DATA_FILE)
    for clusterDir in clusterStateMap.keys():
        self.assertTrue((clusterDir in state.keys()))
        self.assertEquals(clusterStateMap[clusterDir], state[clusterDir])
