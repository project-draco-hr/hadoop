def testOperationWithInvalidStateFile(self):
    jobid = '1234.hadoop.apache.org'
    stateFile = open(self.statePath, 'w')
    os.chmod(self.statePath, 0)
    self.client._hodRunner__cfg['hod']['operation'] = ('info %s' % self.clusterDir)
    ret = self.client.operation()
    os.chmod(self.statePath, 700)
    stateFile.close()
    os.remove(self.statePath)
    self.assertTrue(self.log.hasMessage((INVALID_STATE_FILE_MSGS[0] % os.path.realpath(self.statePath)), 'critical'))
    self.assertEquals(ret, 1)
