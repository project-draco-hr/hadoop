def setUp(self):
    self.rootDir = ('/tmp/hod-%s' % getpass.getuser())
    self.cfg = setupConf()
    self.cfg['hod']['user_state'] = tempfile.mkdtemp(dir=self.rootDir, prefix='HodTestSuite.test_InvalidHodStateFiles_')
    self.log = MockLogger()
    self.cluster = MockHadoopCluster()
    self.client = hodRunner(self.cfg, log=self.log, cluster=self.cluster)
    self.state = hodState(self.cfg['hod']['user_state'])
    self.statePath = os.path.join(self.cfg['hod']['user_state'], ('%s.state' % TEST_CLUSTER_DATA_FILE))
    self.clusterDir = tempfile.mkdtemp(dir=self.rootDir, prefix='HodTestSuite.test_InvalidHodStateFiles_')
