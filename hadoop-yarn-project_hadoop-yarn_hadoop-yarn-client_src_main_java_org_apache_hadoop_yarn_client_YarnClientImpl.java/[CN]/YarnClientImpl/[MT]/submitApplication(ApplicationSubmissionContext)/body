{
  ApplicationId applicationId=appContext.getApplicationId();
  appContext.setApplicationId(applicationId);
  SubmitApplicationRequest request=Records.newRecord(SubmitApplicationRequest.class);
  request.setApplicationSubmissionContext(appContext);
  rmClient.submitApplication(request);
  int pollCount=0;
  while (true) {
    YarnApplicationState state=getApplicationReport(applicationId).getYarnApplicationState();
    if (!state.equals(YarnApplicationState.NEW) && !state.equals(YarnApplicationState.NEW_SAVING)) {
      break;
    }
    if (++pollCount % 10 == 0) {
      LOG.info("Application submission is not finished, " + "submitted application " + applicationId + " is still in "+ state);
    }
    try {
      Thread.sleep(statePollIntervalMillis);
    }
 catch (    InterruptedException ie) {
    }
  }
  LOG.info("Submitted application " + applicationId + " to ResourceManager"+ " at "+ rmAddress);
  return applicationId;
}
