{
  TreeMap<JobSchedulingInfo,JobInProgress> jobsList=jobsPerQueue.get(queue);
synchronized (jobsList) {
    if (jobsList.isEmpty()) {
      return null;
    }
    Iterator<JobInProgress> jobIterator=jobsList.values().iterator();
    JobInProgress job=jobIterator.next();
    jobIterator.remove();
    currentJobCount.getAndDecrement();
    return job;
  }
}
