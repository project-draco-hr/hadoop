{
  if (!table.toString().equals(writerTable))   throw new IOException("Writing to different table " + table.toString() + ". Expecting "+ writerTable);
  if (LOG.isDebugEnabled()) {
    LOG.debug("writing " + record.toString());
  }
  ByteArrayInputStream bais=new ByteArrayInputStream(record.getBytes());
  try {
    if (statement == null) {
      statement=connection.createStatement();
      startCopyIn.invoke(statement,copyStmt,bais);
    }
 else     addStreamToCopyIn.invoke(statement,bais);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
