{
  String nodeRemovePath=getNodePath(ZK_DTSM_MASTER_KEY_ROOT,DELEGATION_KEY_PREFIX + key.getKeyId());
  if (LOG.isDebugEnabled()) {
    LOG.debug("Removing ZKDTSMDelegationKey_" + key.getKeyId());
  }
  try {
    if (zkClient.checkExists().forPath(nodeRemovePath) != null) {
      while (zkClient.checkExists().forPath(nodeRemovePath) != null) {
        try {
          zkClient.delete().guaranteed().forPath(nodeRemovePath);
        }
 catch (        NoNodeException nne) {
          LOG.debug("Node already deleted by peer " + nodeRemovePath);
        }
      }
    }
 else {
      LOG.debug("Attempted to delete a non-existing znode " + nodeRemovePath);
    }
  }
 catch (  Exception e) {
    LOG.debug(nodeRemovePath + " znode could not be removed!!");
  }
}
