{
  if (token == null) {
    throw new InvalidToken("No NMToken sent for " + containerManagerBindAddr);
  }
  final InetSocketAddress cmAddr=NetUtils.createSocketAddr(containerManagerBindAddr);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Opening proxy : " + containerManagerBindAddr);
  }
  UserGroupInformation user=UserGroupInformation.createRemoteUser(containerId.getApplicationAttemptId().toString());
  org.apache.hadoop.security.token.Token<NMTokenIdentifier> nmToken=ConverterUtils.convertFromYarn(token,cmAddr);
  user.addToken(nmToken);
  return NMProxy.createNMProxy(conf,ContainerManagementProtocol.class,user,rpc,cmAddr);
}
