{
  this.conf=conf;
  this.nmTokenCache=nmTokenCache;
  maxConnectedNMs=conf.getInt(YarnConfiguration.NM_CLIENT_MAX_NM_PROXIES,YarnConfiguration.DEFAULT_NM_CLIENT_MAX_NM_PROXIES);
  if (maxConnectedNMs < 0) {
    throw new YarnRuntimeException(YarnConfiguration.NM_CLIENT_MAX_NM_PROXIES + " (" + maxConnectedNMs+ ") can not be less than 0.");
  }
  LOG.info(YarnConfiguration.NM_CLIENT_MAX_NM_PROXIES + " : " + maxConnectedNMs);
  if (maxConnectedNMs > 0) {
    cmProxy=new LinkedHashMap<String,ContainerManagementProtocolProxyData>();
  }
 else {
    cmProxy=Collections.emptyMap();
    conf.setInt(CommonConfigurationKeysPublic.IPC_CLIENT_CONNECTION_MAXIDLETIME_KEY,0);
  }
  rpc=YarnRPC.create(conf);
}
