{
  JobID jobID=JobID.forName("job_1234567890000_0001");
  JobId jobId=TypeConverter.toYarn(jobID);
  if (appContext == null) {
    appContext=mock(AppContext.class);
    when(appContext.hasSuccessfullyUnregistered()).thenReturn(true);
  }
  StubbedJob job=new StubbedJob(jobId,ApplicationAttemptId.newInstance(ApplicationId.newInstance(0,0),0),conf,dispatcher.getEventHandler(),true,"somebody",numSplits,appContext);
  dispatcher.register(JobEventType.class,job);
  EventHandler mockHandler=mock(EventHandler.class);
  dispatcher.register(TaskEventType.class,mockHandler);
  dispatcher.register(org.apache.hadoop.mapreduce.jobhistory.EventType.class,mockHandler);
  dispatcher.register(JobFinishEvent.Type.class,mockHandler);
  return job;
}
