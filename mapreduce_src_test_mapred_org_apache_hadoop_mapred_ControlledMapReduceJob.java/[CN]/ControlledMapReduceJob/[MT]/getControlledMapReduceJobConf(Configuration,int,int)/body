{
  setConf(clusterConf);
  initialize();
  JobConf conf=new JobConf(getConf(),ControlledMapReduceJob.class);
  conf.setJobName("ControlledJob");
  conf.set("signal.dir.path",signalFileDir.toString());
  conf.setNumMapTasks(numMapper);
  conf.setNumReduceTasks(numReducer);
  conf.setMapperClass(ControlledMapReduceJob.class);
  conf.setMapOutputKeyClass(IntWritable.class);
  conf.setMapOutputValueClass(NullWritable.class);
  conf.setReducerClass(ControlledMapReduceJob.class);
  conf.setOutputKeyClass(NullWritable.class);
  conf.setOutputValueClass(NullWritable.class);
  conf.setInputFormat(ControlledMapReduceJob.class);
  FileInputFormat.addInputPath(conf,new Path("ignored"));
  conf.setOutputFormat(NullOutputFormat.class);
  conf.setMapSpeculativeExecution(false);
  conf.setReduceSpeculativeExecution(false);
  conf.set(JobContext.COMPLETED_MAPS_FOR_REDUCE_SLOWSTART,String.valueOf(0));
  return conf;
}
