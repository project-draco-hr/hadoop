{
  if (connectToDnViaHostname != dn.getDnConf().connectToDnViaHostname) {
    throw new AssertionError("Unexpected DN hostname configuration");
  }
  return DataNode.createInterDataNodeProtocolProxy(datanodeid,conf,dn.getDnConf().socketTimeout,dn.getDnConf().connectToDnViaHostname);
}
