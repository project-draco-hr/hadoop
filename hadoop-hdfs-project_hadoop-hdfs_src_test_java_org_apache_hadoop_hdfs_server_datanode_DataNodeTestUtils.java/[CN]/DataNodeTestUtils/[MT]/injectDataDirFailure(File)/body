{
  for (  File dir : dirs) {
    File renamedTo=new File(dir.getPath() + DIR_FAILURE_SUFFIX);
    if (renamedTo.exists()) {
      throw new IOException(String.format("Can not inject failure to dir: %s because %s exists.",dir,renamedTo));
    }
    if (!dir.renameTo(renamedTo)) {
      throw new IOException(String.format("Failed to rename %s to %s.",dir,renamedTo));
    }
    if (!dir.createNewFile()) {
      throw new IOException(String.format("Failed to create file %s to inject disk failure.",dir));
    }
  }
}
