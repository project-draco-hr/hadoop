{
  for (  File dir : dirs) {
    File renamedDir=new File(dir.getPath() + DIR_FAILURE_SUFFIX);
    if (renamedDir.exists()) {
      if (dir.exists()) {
        if (!dir.isFile()) {
          throw new IOException("Injected failure data dir is supposed to be file: " + dir);
        }
        if (!dir.delete()) {
          throw new IOException("Failed to delete injected failure data dir: " + dir);
        }
      }
      if (!renamedDir.renameTo(dir)) {
        throw new IOException(String.format("Failed to recover injected failure data dir %s to %s.",renamedDir,dir));
      }
    }
  }
}
