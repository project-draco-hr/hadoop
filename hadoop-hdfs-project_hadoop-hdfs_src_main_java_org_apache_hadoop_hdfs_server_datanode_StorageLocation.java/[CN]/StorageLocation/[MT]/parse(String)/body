{
  Matcher matcher=compile(rawStringRegex).matcher(rawLocation);
  StorageType storageType=StorageType.DISK;
  String location=rawLocation;
  if (matcher.matches()) {
    String classString=matcher.group(1);
    location=matcher.group(2);
    if (!classString.isEmpty()) {
      try {
        storageType=StorageType.valueOf(classString.toUpperCase());
      }
 catch (      RuntimeException re) {
        LOG.error("Unable to parse storage type: " + re.toString() + ". Using the default storage type for directory "+ location);
      }
    }
  }
  return new StorageLocation(storageType,Util.stringAsURI(location));
}
