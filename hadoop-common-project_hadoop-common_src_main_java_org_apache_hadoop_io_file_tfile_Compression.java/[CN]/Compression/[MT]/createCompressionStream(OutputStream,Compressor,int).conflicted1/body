{
  if (!isSupported()) {
    throw new IOException("LZO codec class not specified. Did you forget to set property " + CONF_LZO_CLASS + "?");
  }
  OutputStream bos1=null;
  if (downStreamBufferSize > 0) {
    bos1=new BufferedOutputStream(downStream,downStreamBufferSize);
  }
 else {
    bos1=downStream;
  }
  conf.setInt(IO_COMPRESSION_CODEC_LZO_BUFFERSIZE_KEY,IO_COMPRESSION_CODEC_LZO_BUFFERSIZE_DEFAULT);
  CompressionOutputStream cos=codec.createOutputStream(bos1,compressor);
  BufferedOutputStream bos2=new BufferedOutputStream(new FinishOnFlushCompressionStream(cos),DATA_OBUF_SIZE);
  return bos2;
}
