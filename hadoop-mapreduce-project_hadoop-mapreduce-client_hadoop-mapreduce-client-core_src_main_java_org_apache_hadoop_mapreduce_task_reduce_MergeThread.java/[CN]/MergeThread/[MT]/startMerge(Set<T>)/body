{
  if (!closed) {
    numPending.incrementAndGet();
    List<T> toMergeInputs=new ArrayList<T>();
    Iterator<T> iter=inputs.iterator();
    for (int ctr=0; iter.hasNext() && ctr < mergeFactor; ++ctr) {
      toMergeInputs.add(iter.next());
      iter.remove();
    }
    LOG.info(getName() + ": Starting merge with " + toMergeInputs.size()+ " segments, while ignoring "+ inputs.size()+ " segments");
synchronized (pendingToBeMerged) {
      pendingToBeMerged.addLast(toMergeInputs);
      pendingToBeMerged.notifyAll();
    }
  }
}
