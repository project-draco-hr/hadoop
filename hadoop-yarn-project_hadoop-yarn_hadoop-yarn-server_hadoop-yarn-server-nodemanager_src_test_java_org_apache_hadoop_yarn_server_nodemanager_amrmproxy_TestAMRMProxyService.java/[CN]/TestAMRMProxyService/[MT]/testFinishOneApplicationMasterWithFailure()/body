{
  int testAppId=1;
  RegisterApplicationMasterResponse registerResponse=registerApplicationMaster(testAppId);
  Assert.assertNotNull(registerResponse);
  Assert.assertEquals(Integer.toString(testAppId),registerResponse.getQueue());
  FinishApplicationMasterResponse finshResponse=finishApplicationMaster(testAppId,FinalApplicationStatus.FAILED);
  Assert.assertNotNull(finshResponse);
  Assert.assertEquals(false,finshResponse.getIsUnregistered());
  try {
    finishApplicationMaster(testAppId,FinalApplicationStatus.SUCCEEDED);
    Assert.fail("The request to finish application master should have failed");
  }
 catch (  Throwable ex) {
    LOG.info("Finish registration failed as expected because it was not registered");
  }
}
