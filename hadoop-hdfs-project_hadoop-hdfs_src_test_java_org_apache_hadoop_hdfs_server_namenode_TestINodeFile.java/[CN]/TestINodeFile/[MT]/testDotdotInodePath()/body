{
  final Configuration conf=new Configuration();
  MiniDFSCluster cluster=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
    cluster.waitActive();
    final DistributedFileSystem hdfs=cluster.getFileSystem();
    final FSDirectory fsdir=cluster.getNamesystem().getFSDirectory();
    final Path dir=new Path("/dir");
    hdfs.mkdirs(dir);
    long dirId=fsdir.getINode(dir.toString()).getId();
    long parentId=fsdir.getINode("/").getId();
    String testPath="/.reserved/.inodes/" + dirId + "/..";
    DFSClient client=new DFSClient(NameNode.getAddress(conf),conf);
    HdfsFileStatus status=client.getFileInfo(testPath);
    assertTrue(parentId == status.getFileId());
    testPath="/.reserved/.inodes/" + parentId + "/..";
    status=client.getFileInfo(testPath);
    assertTrue(parentId == status.getFileId());
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}
