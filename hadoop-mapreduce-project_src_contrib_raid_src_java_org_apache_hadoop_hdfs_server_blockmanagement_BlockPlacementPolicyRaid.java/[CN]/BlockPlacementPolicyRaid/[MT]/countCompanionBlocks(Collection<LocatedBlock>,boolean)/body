{
  Map<String,Integer> result=new HashMap<String,Integer>();
  for (  LocatedBlock block : companionBlocks) {
    for (    DatanodeInfo d : block.getLocations()) {
      String name=doRackCount ? d.getParent().getName() : d.getName();
      if (result.containsKey(name)) {
        int count=result.get(name) + 1;
        result.put(name,count);
      }
 else {
        result.put(name,1);
      }
    }
  }
  return result;
}
