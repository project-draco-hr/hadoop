{
  InputFormat<Text,BytesWritable> format=new SequenceFileInputFilter<Text,BytesWritable>();
  Text key=new Text();
  BytesWritable value=new BytesWritable();
  if (numSplits == 0) {
    numSplits=random.nextInt(MAX_LENGTH / (SequenceFile.SYNC_INTERVAL / 20)) + 1;
  }
  InputSplit[] splits=format.getSplits(job,numSplits);
  int count=0;
  LOG.info("Generated " + splits.length + " splits.");
  for (int j=0; j < splits.length; j++) {
    RecordReader<Text,BytesWritable> reader=format.getRecordReader(splits[j],job,reporter);
    try {
      while (reader.next(key,value)) {
        LOG.info("Accept record " + key.toString());
        count++;
      }
    }
  finally {
      reader.close();
    }
  }
  return count;
}
