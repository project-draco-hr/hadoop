{
  ApplicationSubmissionContextInfo app=new ApplicationSubmissionContextInfo();
  String appid="application_123_0";
  app.setApplicationId(appid);
  String requestBody=TestRMWebServicesDelegationTokenAuthentication.getMarshalledAppInfo(app);
  URL url=new URL("http://localhost:8088/ws/v1/cluster/apps/new-application");
  HttpURLConnection conn=(HttpURLConnection)url.openConnection();
  TestRMWebServicesDelegationTokenAuthentication.setupConn(conn,"POST","application/xml",requestBody);
  try {
    conn.getInputStream();
    fail("Anonymous users should not be allowed to get new application ids in secure mode.");
  }
 catch (  IOException ie) {
    assertEquals(Status.FORBIDDEN.getStatusCode(),conn.getResponseCode());
  }
  url=new URL("http://localhost:8088/ws/v1/cluster/apps");
  conn=(HttpURLConnection)url.openConnection();
  TestRMWebServicesDelegationTokenAuthentication.setupConn(conn,"POST","application/xml",requestBody);
  try {
    conn.getInputStream();
    fail("Anonymous users should not be allowed to submit apps in secure mode.");
  }
 catch (  IOException ie) {
    assertEquals(Status.FORBIDDEN.getStatusCode(),conn.getResponseCode());
  }
  requestBody="{ \"state\": \"KILLED\"}";
  url=new URL("http://localhost:8088/ws/v1/cluster/apps/application_123_0/state");
  conn=(HttpURLConnection)url.openConnection();
  TestRMWebServicesDelegationTokenAuthentication.setupConn(conn,"PUT","application/json",requestBody);
  try {
    conn.getInputStream();
    fail("Anonymous users should not be allowed to kill apps in secure mode.");
  }
 catch (  IOException ie) {
    assertEquals(Status.FORBIDDEN.getStatusCode(),conn.getResponseCode());
  }
}
