{
  VerticaConfiguration config=new VerticaConfiguration(context.getConfiguration());
  String name=context.getJobName();
  String table=config.getOutputTableName();
  String copyStmt="COPY " + table + " FROM STDIN"+ " DELIMITER '"+ delimiter+ "' RECORD TERMINATOR '"+ terminator+ "' STREAM NAME '"+ name+ "' DIRECT";
  try {
    Connection conn=config.getConnection(true);
    return new VerticaRecordWriter(conn,copyStmt,table,delimiter,terminator);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
