{
  String filename=pathPattern.toUri().getPath();
  List<String> filePatterns=GlobExpander.expand(filename);
  if (filePatterns.size() == 1) {
    Path p=fixRelativePart(pathPattern);
    FileSystem fs=getFSofPath(p);
    URI uri=fs.getUri();
    return globStatusInternal(uri,p,filter);
  }
 else {
    List<FileStatus> results=new ArrayList<FileStatus>();
    for (    String filePattern : filePatterns) {
      Path p=new Path(filePattern);
      p=fixRelativePart(p);
      FileSystem fs=getFSofPath(p);
      URI uri=fs.getUri();
      FileStatus[] files=globStatusInternal(uri,p,filter);
      for (      FileStatus file : files) {
        results.add(file);
      }
    }
    return results.toArray(new FileStatus[results.size()]);
  }
}
