{
  LOG.debug("Creating a HadoopYarnRpc server for protocol " + protocol + " with "+ numHandlers+ " handlers");
  RPC.setProtocolEngine(conf,protocol,AvroSpecificRpcEngine.class);
  final RPC.Server hadoopServer;
  try {
    hadoopServer=RPC.getServer(protocol,instance,addr.getHostName(),addr.getPort(),numHandlers,false,conf,secretManager);
  }
 catch (  IOException e) {
    throw new YarnException(e);
  }
  return hadoopServer;
}
