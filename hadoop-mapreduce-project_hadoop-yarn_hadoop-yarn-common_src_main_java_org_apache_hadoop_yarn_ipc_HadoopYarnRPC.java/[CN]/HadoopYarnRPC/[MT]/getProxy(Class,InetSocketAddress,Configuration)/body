{
  LOG.debug("Creating a HadoopYarnRpc proxy for protocol " + protocol);
  RPC.setProtocolEngine(conf,protocol,AvroSpecificRpcEngine.class);
  try {
    return RPC.getProxy(protocol,1,addr,conf);
  }
 catch (  IOException e) {
    throw new YarnException(e);
  }
}
