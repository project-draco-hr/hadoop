{
  final HdfsAdmin dfsAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
  FileSystem.mkdirs(fs,TEST_PATH,new FsPermission((short)0777));
  dfsAdmin.createEncryptionZone(TEST_PATH,null);
  FileSystem.create(fs,new Path("/test/foo"),new FsPermission((short)0777));
  try {
    dfsAdmin.deleteEncryptionZone(TEST_PATH);
    fail("Directory not empty");
  }
 catch (  IOException e) {
    GenericTestUtils.assertExceptionContains("non-empty directory",e);
  }
}
