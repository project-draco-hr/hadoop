{
  final HdfsAdmin dfsAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
  final UserGroupInformation user=UserGroupInformation.createUserForTesting("user",new String[]{"mygroup"});
  FileSystem.mkdirs(fs,TEST_PATH,new FsPermission((short)0700));
  user.doAs(new PrivilegedExceptionAction<Object>(){
    @Override public Object run() throws Exception {
      final HdfsAdmin userAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
      try {
        userAdmin.createEncryptionZone(TEST_PATH,null);
        fail("createEncryptionZone is superuser-only operation");
      }
 catch (      AccessControlException e) {
        GenericTestUtils.assertExceptionContains("Superuser privilege is required",e);
      }
      return null;
    }
  }
);
  dfsAdmin.createEncryptionZone(TEST_PATH,null);
  user.doAs(new PrivilegedExceptionAction<Object>(){
    @Override public Object run() throws Exception {
      final HdfsAdmin userAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
      try {
        userAdmin.deleteEncryptionZone(TEST_PATH);
        fail("deleteEncryptionZone is superuser-only operation");
      }
 catch (      AccessControlException e) {
        GenericTestUtils.assertExceptionContains("Superuser privilege is required",e);
      }
      return null;
    }
  }
);
}
