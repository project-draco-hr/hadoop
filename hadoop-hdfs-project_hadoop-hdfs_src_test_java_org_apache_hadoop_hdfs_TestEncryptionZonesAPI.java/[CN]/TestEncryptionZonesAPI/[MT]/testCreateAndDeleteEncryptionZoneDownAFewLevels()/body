{
  final HdfsAdmin dfsAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
  FileSystem.mkdirs(fs,TEST_PATH,new FsPermission((short)0777));
  dfsAdmin.createEncryptionZone(TEST_PATH,null);
  FileSystem.mkdirs(fs,TEST_PATH_WITH_MULTIPLE_CHILDREN,new FsPermission((short)0777));
  try {
    dfsAdmin.deleteEncryptionZone(TEST_PATH_WITH_MULTIPLE_CHILDREN);
    fail("EZ in an EZ");
  }
 catch (  IOException e) {
    GenericTestUtils.assertExceptionContains("is not the root of an encryption zone",e);
  }
  final List<EncryptionZone> zones=dfsAdmin.listEncryptionZones();
  Preconditions.checkState(zones.size() == 1,"More than one zone found?");
  final EncryptionZone ez=zones.get(0);
  GenericTestUtils.assertMatches(ez.toString(),"EncryptionZone \\[path=/test, keyId=");
}
