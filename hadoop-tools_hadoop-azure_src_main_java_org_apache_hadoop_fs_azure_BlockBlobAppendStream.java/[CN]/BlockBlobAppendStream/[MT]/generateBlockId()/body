{
  if (nextBlockCount == UNSET_BLOCKS_COUNT) {
    throw new IOException("Append Stream in invalid state. nextBlockCount not set correctly");
  }
  if (this.blockIdPrefix == null) {
    throw new IOException("Append Stream in invalid state. blockIdPrefix not set correctly");
  }
  if (!this.blockIdPrefix.equals("")) {
    return generateNewerVersionBlockId(this.blockIdPrefix,nextBlockCount++);
  }
 else {
    return generateOlderVersionBlockId(nextBlockCount++);
  }
}
