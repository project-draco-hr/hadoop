{
  long cutoffMillis=System.currentTimeMillis() - retentionMillis;
  LOG.info("aggregated log deletion started.");
  try {
    FileSystem fs=remoteRootLogDir.getFileSystem(conf);
    for (    FileStatus userDir : fs.listStatus(remoteRootLogDir)) {
      if (userDir.isDirectory()) {
        Path userDirPath=new Path(userDir.getPath(),suffix);
        deleteOldLogDirsFrom(userDirPath,cutoffMillis,fs,rmClient);
      }
    }
  }
 catch (  IOException e) {
    logIOException("Error reading root log dir this deletion " + "attempt is being aborted",e);
  }
  LOG.info("aggregated log deletion finished.");
}
