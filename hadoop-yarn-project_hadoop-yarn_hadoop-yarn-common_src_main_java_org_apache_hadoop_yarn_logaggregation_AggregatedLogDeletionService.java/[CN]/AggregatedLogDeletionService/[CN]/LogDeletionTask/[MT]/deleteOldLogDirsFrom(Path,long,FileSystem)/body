{
  try {
    for (    FileStatus appDir : fs.listStatus(dir)) {
      if (appDir.isDirectory() && appDir.getModificationTime() < cutoffMillis) {
        if (shouldDeleteLogDir(appDir,cutoffMillis,fs)) {
          try {
            LOG.info("Deleting aggregated logs in " + appDir.getPath());
            fs.delete(appDir.getPath(),true);
          }
 catch (          IOException e) {
            logIOException("Could not delete " + appDir.getPath(),e);
          }
        }
      }
    }
  }
 catch (  IOException e) {
    logIOException("Could not read the contents of " + dir,e);
  }
}
