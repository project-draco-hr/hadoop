{
  if (fileStatus.getPath().equals(sourcePathRoot) && fileStatus.isDirectory())   return;
  if (LOG.isDebugEnabled()) {
    LOG.debug("REL PATH: " + DistCpUtils.getRelativePath(sourcePathRoot,fileStatus.getPath()) + ", FULL PATH: "+ fileStatus.getPath());
  }
  FileStatus status=fileStatus;
  if (localFile) {
    status=getFileStatus(fileStatus);
  }
  fileListWriter.append(new Text(DistCpUtils.getRelativePath(sourcePathRoot,fileStatus.getPath())),status);
  fileListWriter.sync();
  if (!fileStatus.isDirectory()) {
    totalBytesToCopy+=fileStatus.getLen();
  }
  totalPaths++;
}
