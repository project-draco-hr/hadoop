{
  FileSystem sourceFS=sourcePathRoot.getFileSystem(getConf());
  Stack<FileStatus> pathStack=new Stack<FileStatus>();
  pathStack.push(sourceStatus);
  while (!pathStack.isEmpty()) {
    for (    FileStatus child : getChildren(sourceFS,pathStack.pop())) {
      if (LOG.isDebugEnabled())       LOG.debug("Recording source-path: " + sourceStatus.getPath() + " for copy.");
      writeToFileListing(fileListWriter,child,sourcePathRoot,localFile,options);
      if (isDirectoryAndNotEmpty(sourceFS,child)) {
        if (LOG.isDebugEnabled())         LOG.debug("Traversing non-empty source dir: " + sourceStatus.getPath());
        pathStack.push(child);
      }
    }
  }
}
