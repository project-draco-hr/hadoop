{
  if (LOG.isDebugEnabled()) {
    LOG.debug("REL PATH: " + DistCpUtils.getRelativePath(sourcePathRoot,fileStatus.getPath()) + ", FULL PATH: "+ fileStatus.getPath());
  }
  FileStatus status=fileStatus;
  if (!shouldCopy(fileStatus.getPath(),options)) {
    return;
  }
  fileListWriter.append(new Text(DistCpUtils.getRelativePath(sourcePathRoot,fileStatus.getPath())),status);
  fileListWriter.sync();
  if (!fileStatus.isDirectory()) {
    totalBytesToCopy+=fileStatus.getLen();
  }
 else {
    totalDirs++;
  }
  totalPaths++;
}
