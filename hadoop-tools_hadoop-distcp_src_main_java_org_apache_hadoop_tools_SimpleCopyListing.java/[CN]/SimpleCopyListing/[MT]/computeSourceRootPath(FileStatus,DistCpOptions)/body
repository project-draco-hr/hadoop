{
  Path target=options.getTargetPath();
  FileSystem targetFS=target.getFileSystem(getConf());
  final boolean targetPathExists=options.getTargetPathExists();
  boolean solitaryFile=options.getSourcePaths().size() == 1 && !sourceStatus.isDirectory();
  if (solitaryFile) {
    if (targetFS.isFile(target) || !targetPathExists) {
      return sourceStatus.getPath();
    }
 else {
      return sourceStatus.getPath().getParent();
    }
  }
 else {
    boolean specialHandling=(options.getSourcePaths().size() == 1 && !targetPathExists) || options.shouldSyncFolder() || options.shouldOverwrite();
    if ((specialHandling && sourceStatus.isDirectory()) || sourceStatus.getPath().isRoot()) {
      return sourceStatus.getPath();
    }
 else {
      return sourceStatus.getPath().getParent();
    }
  }
}
