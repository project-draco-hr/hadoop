{
  this(dfsClient,src,blockSize,progress,bytesPerChecksum,replication);
  computePacketChunkSize(dfsClient.writePacketSize,bytesPerChecksum);
  try {
    dfsClient.namenode.create(src,masked,dfsClient.clientName,new EnumSetWritable<CreateFlag>(flag),createParent,replication,blockSize);
  }
 catch (  RemoteException re) {
    throw re.unwrapRemoteException(AccessControlException.class,DSQuotaExceededException.class,FileAlreadyExistsException.class,FileNotFoundException.class,ParentNotDirectoryException.class,NSQuotaExceededException.class,SafeModeException.class,UnresolvedPathException.class);
  }
  streamer=new DataStreamer();
  streamer.start();
}
