{
  super(new PureJavaCrc32(),bytesPerChecksum,4);
  this.dfsClient=dfsClient;
  this.conf=dfsClient.conf;
  this.src=src;
  this.blockSize=blockSize;
  this.blockReplication=replication;
  this.progress=progress;
  if ((progress != null) && DFSClient.LOG.isDebugEnabled()) {
    DFSClient.LOG.debug("Set non-null progress callback on DFSOutputStream " + src);
  }
  if (bytesPerChecksum < 1 || blockSize % bytesPerChecksum != 0) {
    throw new IOException("io.bytes.per.checksum(" + bytesPerChecksum + ") and blockSize("+ blockSize+ ") do not match. "+ "blockSize should be a "+ "multiple of io.bytes.per.checksum");
  }
  checksum=DataChecksum.newDataChecksum(DataChecksum.CHECKSUM_CRC32,bytesPerChecksum);
}
