{
  if (DFSClient.LOG.isDebugEnabled()) {
    DFSClient.LOG.debug("Waiting for ack for: " + seqno);
  }
synchronized (dataQueue) {
    while (!closed) {
      isClosed();
      if (lastAckedSeqno >= seqno) {
        break;
      }
      try {
        dataQueue.wait(1000);
      }
 catch (      InterruptedException ie) {
        throw new InterruptedIOException("Interrupted while waiting for data to be acknowledged by pipeline");
      }
    }
  }
  isClosed();
}
