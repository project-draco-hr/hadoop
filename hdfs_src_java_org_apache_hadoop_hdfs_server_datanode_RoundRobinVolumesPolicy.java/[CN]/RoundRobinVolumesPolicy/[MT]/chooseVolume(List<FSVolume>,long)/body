{
  if (volumes.size() < 1) {
    throw new DiskOutOfSpaceException("No more available volumes");
  }
  if (curVolume >= volumes.size()) {
    curVolume=0;
  }
  int startVolume=curVolume;
  while (true) {
    FSVolume volume=volumes.get(curVolume);
    curVolume=(curVolume + 1) % volumes.size();
    if (volume.getAvailable() > blockSize) {
      return volume;
    }
    if (curVolume == startVolume) {
      throw new DiskOutOfSpaceException("Insufficient space for an additional block");
    }
  }
}
