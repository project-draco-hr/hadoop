{
  for (  String partition : context.getAllPartitions()) {
    TempQueuePerPartition tRoot=context.getQueueByPartition(CapacitySchedulerConfiguration.ROOT,partition);
    tRoot.idealAssigned=tRoot.guaranteed;
    recursivelyComputeIdealAssignment(tRoot,totalPreemptionAllowed);
  }
  calculateResToObtainByPartitionForLeafQueues(context.getLeafQueueNames(),clusterResource);
}
