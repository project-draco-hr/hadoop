{
  for (int r=0; r < reports.length; r++) {
    LOG.info("Sending block report for storage " + reports[r].getStorage().getStorageID());
    StorageBlockReport[] singletonReport={reports[r]};
    if (r != reports.length - 1) {
      cluster.getNameNodeRpc().blockReport(dnR,poolId,singletonReport,new BlockReportContext(reports.length,r,System.nanoTime(),0L,true));
    }
 else {
      StorageBlockReport[] lastSplitReport=new StorageBlockReport[reports.length];
      for (int i=0; i <= r; i++) {
        if (i == r) {
          lastSplitReport[i]=reports[r];
          break;
        }
        lastSplitReport[i]=new StorageBlockReport(reports[i].getStorage(),BlockListAsLongs.STORAGE_REPORT);
      }
      cluster.getNameNodeRpc().blockReport(dnR,poolId,lastSplitReport,new BlockReportContext(reports.length,r,System.nanoTime(),0L,true));
    }
  }
}
