def removeMRSystemDirectory(self):
    jtActive = isProcessRunning(self.__jtPid)
    count = 0
    while (jtActive and (count < self.__retries)):
        time.sleep(0.5)
        jtActive = isProcessRunning(self.__jtPid)
        count += 1
    if (count == self.__retries):
        self.__log.warn('Job Tracker did not exit even after a minute. Not going to try and cleanup the system directory')
        return
    self.__log.debug('jt is now inactive')
    cmd = ('%s dfs -fs hdfs://%s -rmr %s' % (self.__hadoopPath, self.__fsName, self.__mrSysDir))
    self.__log.debug(('Command to run to remove system directory: %s' % cmd))
    try:
        hadoopCommand = simpleCommand('mr-sys-dir-cleaner', cmd)
        hadoopCommand.start()
        hadoopCommand.wait()
        hadoopCommand.join()
        ret = hadoopCommand.exit_code()
        if (ret != 0):
            self.__log.warn(("Error in removing MapReduce system directory '%s' from '%s' using path '%s'" % (self.__mrSysDir, self.__fsName, self.__hadoopPath)))
            self.__log.warn(pprint.pformat(hadoopCommand.output()))
        else:
            self.__log.info('Removed MapReduce system directory successfully.')
    except:
        self.__log.error('Exception while cleaning up MapReduce system directory. May not be cleaned up. %s', get_exception_error_string())
        self.__log.debug(get_exception_string())
