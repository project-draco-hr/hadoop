def _createHadoopSiteXml(self):
    if self.restart:
        if (not os.path.exists(self.confdir)):
            os.makedirs(self.confdir)
    else:
        assert (os.path.exists(self.confdir) == False)
        os.makedirs(self.confdir)
    implementation = getDOMImplementation()
    doc = implementation.createDocument('', 'configuration', None)
    comment = doc.createComment('This is an auto generated hadoop-site.xml, do not modify')
    topElement = doc.documentElement
    topElement.appendChild(comment)
    finalAttr = self.desc.getfinalAttrs()
    self.createXML(doc, finalAttr, topElement, True)
    attr = {}
    attr1 = self.desc.getAttrs()
    for (k, v) in attr1.iteritems():
        if (not finalAttr.has_key(k)):
            attr[k] = v
    self.createXML(doc, attr, topElement, False)
    siteName = os.path.join(self.confdir, 'hadoop-site.xml')
    sitefile = file(siteName, 'w')
    print  >> sitefile, topElement.toxml()
    sitefile.close()
    self.log.debug(('created %s' % siteName))
