def __fetch(self, url, spath):
    retry = 3
    success = False
    while ((retry != 0) and (success != True)):
        try:
            input = urllib.urlopen(url)
            bufsz = 81920
            buf = input.read(bufsz)
            out = open(spath, 'w')
            while (len(buf) > 0):
                out.write(buf)
                buf = input.read(bufsz)
            input.close()
            out.close()
            success = True
        except:
            self.log.debug('Failed to copy file')
            retry = (retry - 1)
    if ((retry == 0) and (success != True)):
        raise IOError, 'Failed to copy the files'
