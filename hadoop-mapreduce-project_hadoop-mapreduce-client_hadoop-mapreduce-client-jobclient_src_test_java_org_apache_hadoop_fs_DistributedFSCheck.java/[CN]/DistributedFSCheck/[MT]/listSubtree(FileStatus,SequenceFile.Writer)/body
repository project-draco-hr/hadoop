{
  Path rootFile=rootStatus.getPath();
  if (rootStatus.isFile()) {
    nrFiles++;
    long blockSize=fs.getDefaultBlockSize(rootFile);
    long fileLength=rootStatus.getLen();
    for (long offset=0; offset < fileLength; offset+=blockSize)     writer.append(new Text(rootFile.toString()),new LongWritable(offset));
    return;
  }
  FileStatus[] children=null;
  try {
    children=fs.listStatus(rootFile);
  }
 catch (  FileNotFoundException fnfe) {
    throw new IOException("Could not get listing for " + rootFile);
  }
  for (int i=0; i < children.length; i++)   listSubtree(children[i],writer);
}
