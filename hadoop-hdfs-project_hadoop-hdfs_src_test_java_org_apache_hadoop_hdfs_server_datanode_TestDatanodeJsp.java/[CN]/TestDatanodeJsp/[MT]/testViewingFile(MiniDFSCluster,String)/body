{
  FileSystem fs=cluster.getFileSystem();
  Path testPath=new Path(filePath);
  if (!fs.exists(testPath)) {
    DFSTestUtil.writeFile(fs,testPath,FILE_DATA);
  }
  InetSocketAddress nnIpcAddress=cluster.getNameNode().getNameNodeAddress();
  InetSocketAddress nnHttpAddress=cluster.getNameNode().getHttpAddress();
  String base=JspHelper.Url.url("http",cluster.getDataNodes().get(0).getDatanodeId());
  URL url=new URL(base + "/" + "browseDirectory.jsp"+ JspHelper.getUrlParam("dir",URLEncoder.encode(testPath.toString(),"UTF-8"),true)+ JspHelper.getUrlParam("namenodeInfoPort",Integer.toString(nnHttpAddress.getPort()))+ JspHelper.getUrlParam("nnaddr","localhost:" + nnIpcAddress.getPort()));
  viewFilePage=StringEscapeUtils.unescapeHtml(DFSTestUtil.urlGet(url));
  assertTrue("page should show preview of file contents, got: " + viewFilePage,viewFilePage.contains(FILE_DATA));
  assertTrue("page should show link to download file",viewFilePage.contains("/streamFile" + ServletUtil.encodePath(filePath) + "?nnaddr=localhost:"+ nnIpcAddress.getPort()));
  String regex="<a.+href=\"(.+?)\">Tail\\s*this\\s*file\\<\\/a\\>";
  assertFileContents(regex,"Tail this File");
  regex="<a.+href=\"(.+?)\">Go\\s*Back\\s*to\\s*File\\s*View\\<\\/a\\>";
  assertFileContents(regex,"Go Back to File View");
  regex="<a href=\"///localhost:" + nnHttpAddress.getPort() + "/dfshealth.jsp\">Go back to DFS home</a>";
  assertTrue("page should generate DFS home scheme without explicit scheme",viewFilePage.contains(regex));
}
