{
  init(res);
  TimelineReaderManager timelineReaderManager=getTimelineReaderManager();
  Set<TimelineEntity> entities=null;
  try {
    entities=timelineReaderManager.getEntities(null,parseStr(clusterId),null,null,null,TimelineEntityType.YARN_FLOW_ACTIVITY.toString(),parseLongStr(limit),null,null,null,null,null,null,null,null,null,null,parseFieldsStr(fields,COMMA_DELIMITER));
  }
 catch (  NumberFormatException e) {
    throw new BadRequestException("limit is not a numeric value.");
  }
catch (  Exception e) {
    handleException(e);
  }
  if (entities == null) {
    entities=Collections.emptySet();
  }
  return entities;
}
