{
  String url=req.getRequestURI() + (req.getQueryString() == null ? "" : QUERY_STRING_SEP + req.getQueryString());
  UserGroupInformation callerUGI=getUser(req);
  LOG.info("Received URL " + url + " from user "+ getUserName(callerUGI));
  long startTime=Time.monotonicNow();
  init(res);
  TimelineReaderManager timelineReaderManager=getTimelineReaderManager();
  TimelineEntity entity=null;
  try {
    entity=timelineReaderManager.getEntity(parseStr(userId),parseStr(clusterId),parseStr(flowId),parseLongStr(flowRunId),parseStr(appId),parseStr(entityType),parseStr(entityId),parseFieldsStr(fields,COMMA_DELIMITER));
  }
 catch (  Exception e) {
    handleException(e,url,startTime,"flowrunid");
  }
  long endTime=Time.monotonicNow();
  if (entity == null) {
    LOG.info("Processed URL " + url + " but entity not found"+ " (Took "+ (endTime - startTime)+ " ms.)");
    throw new NotFoundException("Timeline entity {id: " + parseStr(entityId) + ", type: "+ parseStr(entityType)+ " } is not found");
  }
  LOG.info("Processed URL " + url + " (Took "+ (endTime - startTime)+ " ms.)");
  return entity;
}
