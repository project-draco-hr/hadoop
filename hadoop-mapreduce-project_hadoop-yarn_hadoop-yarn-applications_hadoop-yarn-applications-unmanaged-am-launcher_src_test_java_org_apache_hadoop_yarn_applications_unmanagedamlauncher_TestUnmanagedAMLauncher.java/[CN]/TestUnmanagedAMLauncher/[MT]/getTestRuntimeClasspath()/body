{
  InputStream classpathFileStream=null;
  BufferedReader reader=null;
  String envClassPath="";
  LOG.info("Trying to generate classpath for app master from current thread's classpath");
  try {
    ClassLoader thisClassLoader=Thread.currentThread().getContextClassLoader();
    String generatedClasspathFile="yarn-apps-am-generated-classpath";
    classpathFileStream=thisClassLoader.getResourceAsStream(generatedClasspathFile);
    if (classpathFileStream == null) {
      LOG.info("Could not classpath resource from class loader");
      return envClassPath;
    }
    LOG.info("Readable bytes from stream=" + classpathFileStream.available());
    reader=new BufferedReader(new InputStreamReader(classpathFileStream));
    String cp=reader.readLine();
    if (cp != null) {
      envClassPath+=cp.trim() + File.pathSeparator;
    }
    URL url=thisClassLoader.getResource("yarn-site.xml");
    envClassPath+=new File(url.getFile()).getParent();
  }
 catch (  IOException e) {
    LOG.info("Could not find the necessary resource to generate class path for tests. Error=" + e.getMessage());
  }
  try {
    if (classpathFileStream != null) {
      classpathFileStream.close();
    }
    if (reader != null) {
      reader.close();
    }
  }
 catch (  IOException e) {
    LOG.info("Failed to close class path file stream or reader. Error=" + e.getMessage());
  }
  return envClassPath;
}
