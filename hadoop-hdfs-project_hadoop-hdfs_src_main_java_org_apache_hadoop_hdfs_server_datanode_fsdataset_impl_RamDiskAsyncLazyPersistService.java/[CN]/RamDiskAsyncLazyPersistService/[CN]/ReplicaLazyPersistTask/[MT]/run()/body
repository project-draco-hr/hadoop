{
  boolean succeeded=false;
  try {
    File targetFiles[]=FsDatasetImpl.copyBlockFiles(blockId,genStamp,metaFile,blockFile,lazyPersistDir);
    datanode.getFSDataset().onCompleteLazyPersist(bpId,blockId,creationTime,targetFiles,targetVolume);
    succeeded=true;
  }
 catch (  Exception e) {
    FsDatasetImpl.LOG.warn("LazyWriter failed to async persist RamDisk block pool id: " + bpId + "block Id: "+ blockId,e);
  }
 finally {
    if (!succeeded) {
      datanode.getFSDataset().onFailLazyPersist(bpId,blockId);
    }
  }
}
