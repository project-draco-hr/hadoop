{
  if (LOG.isDebugEnabled()) {
    LOG.debug("LazyWriter schedule async task to persist RamDisk block pool id: " + bpId + " block id: "+ blockId);
  }
  File lazyPersistDir=targetVolume.getLazyPersistDir(bpId);
  if (!lazyPersistDir.exists() && !lazyPersistDir.mkdirs()) {
    FsDatasetImpl.LOG.warn("LazyWriter failed to create " + lazyPersistDir);
    throw new IOException("LazyWriter fail to find or create lazy persist dir: " + lazyPersistDir.toString());
  }
  ReplicaLazyPersistTask lazyPersistTask=new ReplicaLazyPersistTask(bpId,blockId,genStamp,creationTime,blockFile,metaFile,targetVolume,lazyPersistDir);
  execute(targetVolume.getCurrentDir(),lazyPersistTask);
}
