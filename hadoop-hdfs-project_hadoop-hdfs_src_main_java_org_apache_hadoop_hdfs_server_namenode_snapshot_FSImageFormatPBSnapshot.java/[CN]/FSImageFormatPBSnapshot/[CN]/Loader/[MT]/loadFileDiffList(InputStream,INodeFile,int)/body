{
  final FileDiffList diffs=new FileDiffList();
  for (int i=0; i < size; i++) {
    SnapshotDiffSection.FileDiff pbf=SnapshotDiffSection.FileDiff.parseDelimitedFrom(in);
    INodeFileAttributes copy=null;
    if (pbf.hasSnapshotCopy()) {
      INodeSection.INodeFile fileInPb=pbf.getSnapshotCopy();
      PermissionStatus permission=loadPermission(fileInPb.getPermission(),parent.getLoaderContext().getStringTable());
      copy=new INodeFileAttributes.SnapshotCopy(pbf.getName().toByteArray(),permission,fileInPb.getModificationTime(),fileInPb.getAccessTime(),(short)fileInPb.getReplication(),fileInPb.getPreferredBlockSize());
    }
    FileDiff diff=new FileDiff(pbf.getSnapshotId(),copy,null,pbf.getFileSize());
    diffs.addFirst(diff);
  }
  file.addSnapshotFeature(diffs);
}
