{
  if (this.reporter == null) {
    this.reporter=reporter;
  }
  SortedMap<Object,ResetableIterator> groups=regroup(key,values,reporter);
  Object[] tags=groups.keySet().toArray();
  ResetableIterator[] groupValues=new ResetableIterator[tags.length];
  for (int i=0; i < tags.length; i++) {
    groupValues[i]=groups.get(tags[i]);
  }
  joinAndCollect(tags,groupValues,key,output,reporter);
  addLongValue("groupCount",1);
  for (int i=0; i < tags.length; i++) {
    groupValues[i].close();
  }
}
