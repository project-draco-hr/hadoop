{
  Configuration conf=new Configuration(true);
  Cluster cluster=new Cluster(conf);
  Job job=Job.getInstance(cluster);
  conf=job.getConfiguration();
  conf.set("mapreduce.job.tracker","local");
  job.setJarByClass(TestExample.class);
  job.setJobName("vertica test");
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(VerticaRecord.class);
  job.setInputFormatClass(VerticaInputFormat.class);
  job.setOutputFormatClass(VerticaOutputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(DoubleWritable.class);
  job.setMapperClass(Map.class);
  job.setReducerClass(Reduce.class);
  VerticaOutputFormat.setOutput(job,"mrtarget",true,"a int","b boolean","c char(1)","d date","f float","t timestamp","v varchar","z varbinary");
  VerticaConfiguration.configureVertica(conf,new String[]{AllTests.getHostname()},AllTests.getDatabase(),AllTests.getUsername(),AllTests.getPassword());
  return job;
}
