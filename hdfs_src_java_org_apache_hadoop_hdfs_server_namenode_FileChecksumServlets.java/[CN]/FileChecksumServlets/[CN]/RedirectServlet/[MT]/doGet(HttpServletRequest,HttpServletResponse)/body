{
  final ServletContext context=getServletContext();
  final Configuration conf=NameNodeHttpServer.getConfFromContext(context);
  final UserGroupInformation ugi=getUGI(request,conf);
  final NameNode namenode=NameNodeHttpServer.getNameNodeFromContext(context);
  final DatanodeID datanode=NamenodeJspHelper.getRandomDatanode(namenode);
  try {
    response.sendRedirect(createRedirectURL(ugi,datanode,request,namenode).toString());
  }
 catch (  URISyntaxException e) {
    throw new ServletException(e);
  }
catch (  IOException e) {
    response.sendError(400,e.getMessage());
  }
}
