{
  if (fs.getScheme().equals("s3") || fs.getScheme().equals("s3n")) {
    return;
  }
  Configuration conf=fs.getConf();
  String oldUmask=conf.get(CommonConfigurationKeys.FS_PERMISSIONS_UMASK_KEY);
  try {
    conf.set(CommonConfigurationKeys.FS_PERMISSIONS_UMASK_KEY,TEST_UMASK);
    final Path dir=new Path("/test/newDir");
    assertTrue(fs.mkdirs(dir,new FsPermission((short)0777)));
    FileStatus status=fs.getFileStatus(dir);
    assertTrue(status.isDirectory());
    assertEquals((short)0715,status.getPermission().toShort());
  }
  finally {
    conf.set(CommonConfigurationKeys.FS_PERMISSIONS_UMASK_KEY,oldUmask);
  }
}
