{
  final Configuration conf=new Configuration();
  MiniDFSCluster cluster=null;
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(DATANODE_NUM).build();
    cluster.waitActive();
{
      final long blocksize=1L << 20;
      final long filesize=2 * blocksize + 100;
      runTestHftpOpen(cluster,"/foo",blocksize,filesize);
    }
{
      final long blocksize=1L << 10;
      final long filesize=2 * blocksize + 100;
      runTestHftpOpen(cluster,"/small",blocksize,filesize);
    }
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}
