{
  if (ckptState != CheckpointStates.ROLLED_EDITS) {
    throw new IOException("Namenode is not expecting an new image " + ckptState);
  }
  long modtime=getEditLog().getFsEditTime();
  if (sig.editsTime != modtime) {
    throw new IOException("Namenode has an edit log with timestamp of " + DATE_FORM.format(new Date(modtime)) + " but new checkpoint was created using editlog "+ " with timestamp "+ DATE_FORM.format(new Date(sig.editsTime))+ ". Checkpoint Aborted.");
  }
  sig.validateStorageInfo(this);
  ckptState=FSImage.CheckpointStates.UPLOAD_START;
}
