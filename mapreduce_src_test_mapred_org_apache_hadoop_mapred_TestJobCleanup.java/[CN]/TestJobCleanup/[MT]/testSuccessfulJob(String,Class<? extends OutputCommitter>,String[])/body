{
  JobConf jc=mr.createJobConf();
  Path outDir=getNewOutputDir();
  configureJob(jc,"job with cleanup()",1,0,outDir);
  jc.setOutputCommitter(committer);
  JobClient jobClient=new JobClient(jc);
  RunningJob job=jobClient.submitJob(jc);
  JobID id=job.getID();
  job.waitForCompletion();
  Path testFile=new Path(outDir,filename);
  assertTrue("Done file missing for job " + id,fileSys.exists(testFile));
  for (  String ex : exclude) {
    Path file=new Path(outDir,ex);
    assertFalse("File " + file + " should not be present for successful job "+ id,fileSys.exists(file));
  }
}
