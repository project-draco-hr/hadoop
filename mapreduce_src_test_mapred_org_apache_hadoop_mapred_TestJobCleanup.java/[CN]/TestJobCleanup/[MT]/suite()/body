{
  TestSetup setup=new TestSetup(new TestSuite(TestJobCleanup.class)){
    protected void setUp() throws Exception {
      JobConf conf=new JobConf();
      fileSys=FileSystem.get(conf);
      fileSys.delete(new Path(TEST_ROOT_DIR),true);
      conf.set("mapred.job.tracker.handler.count","1");
      conf.set("mapred.job.tracker","127.0.0.1:0");
      conf.set("mapred.job.tracker.http.address","127.0.0.1:0");
      conf.set("mapred.task.tracker.http.address","127.0.0.1:0");
      mr=new MiniMRCluster(1,"file:///",1,null,null,conf);
      inDir=new Path(TEST_ROOT_DIR,"test-input");
      String input="The quick brown fox\n" + "has many silly\n" + "red fox sox\n";
      DataOutputStream file=fileSys.create(new Path(inDir,"part-" + 0));
      file.writeBytes(input);
      file.close();
      emptyInDir=new Path(TEST_ROOT_DIR,"empty-input");
      fileSys.mkdirs(emptyInDir);
    }
    protected void tearDown() throws Exception {
      if (fileSys != null) {
        fileSys.delete(new Path(TEST_ROOT_DIR),true);
        fileSys.close();
      }
      if (mr != null) {
        mr.shutdown();
      }
    }
  }
;
  return setup;
}
