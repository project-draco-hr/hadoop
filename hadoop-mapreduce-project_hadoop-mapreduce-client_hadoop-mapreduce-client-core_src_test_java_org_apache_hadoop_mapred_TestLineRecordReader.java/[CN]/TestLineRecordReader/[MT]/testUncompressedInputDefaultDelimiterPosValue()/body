{
  Configuration conf=new Configuration();
  String inputData="1234567890\r\n12\r\n345";
  Path inputFile=createInputFile(conf,inputData);
  conf.setInt("io.file.buffer.size",10);
  conf.setInt(org.apache.hadoop.mapreduce.lib.input.LineRecordReader.MAX_LINE_LENGTH,Integer.MAX_VALUE);
  FileSplit split=new FileSplit(inputFile,0,15,(String[])null);
  LineRecordReader reader=new LineRecordReader(conf,split,null);
  LongWritable key=new LongWritable();
  Text value=new Text();
  reader.next(key,value);
  assertEquals(10,value.getLength());
  assertEquals(12,reader.getPos());
  reader.next(key,value);
  assertEquals(2,value.getLength());
  assertEquals(16,reader.getPos());
  assertFalse(reader.next(key,value));
  split=new FileSplit(inputFile,15,4,(String[])null);
  reader=new LineRecordReader(conf,split,null);
  assertEquals(16,reader.getPos());
  reader.next(key,value);
  assertEquals(3,value.getLength());
  assertEquals(19,reader.getPos());
  assertFalse(reader.next(key,value));
  assertEquals(19,reader.getPos());
  inputData="123456789\r\r\n";
  inputFile=createInputFile(conf,inputData);
  split=new FileSplit(inputFile,0,12,(String[])null);
  reader=new LineRecordReader(conf,split,null);
  reader.next(key,value);
  assertEquals(9,value.getLength());
  assertEquals(10,reader.getPos());
  reader.next(key,value);
  assertEquals(0,value.getLength());
  assertEquals(12,reader.getPos());
  assertFalse(reader.next(key,value));
  assertEquals(12,reader.getPos());
}
