{
  URL testFileUrl=getClass().getClassLoader().getResource("recordSpanningMultipleSplits.txt.bz2");
  assertNotNull("Cannot find recordSpanningMultipleSplits.txt.bz2",testFileUrl);
  File testFile=new File(testFileUrl.getFile());
  Path testFilePath=new Path(testFile.getAbsolutePath());
  long testFileSize=testFile.length();
  Configuration conf=new Configuration();
  conf.setInt(org.apache.hadoop.mapreduce.lib.input.LineRecordReader.MAX_LINE_LENGTH,Integer.MAX_VALUE);
  FileSplit split=new FileSplit(testFilePath,0,testFileSize,(String[])null);
  LineRecordReader reader=new LineRecordReader(conf,split);
  LongWritable key=new LongWritable();
  Text value=new Text();
  while (reader.next(key,value))   ;
  reader.close();
  reader.close();
  BZip2Codec codec=new BZip2Codec();
  codec.setConf(conf);
  Set<Decompressor> decompressors=new HashSet<Decompressor>();
  for (int i=0; i < 10; ++i) {
    decompressors.add(CodecPool.getDecompressor(codec));
  }
  assertEquals(10,decompressors.size());
}
