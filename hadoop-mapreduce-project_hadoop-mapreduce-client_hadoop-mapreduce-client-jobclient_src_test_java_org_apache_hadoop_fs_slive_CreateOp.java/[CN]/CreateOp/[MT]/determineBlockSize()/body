{
  Range<Long> blockSizeRange=getConfig().getBlockSize();
  long blockSize=Range.betweenPositive(getRandom(),blockSizeRange);
  Long byteChecksum=getConfig().getByteCheckSum();
  if (byteChecksum == null) {
    return blockSize;
  }
  long full=(blockSize / byteChecksum) * byteChecksum;
  long toFull=blockSize - full;
  if (toFull >= (byteChecksum / 2)) {
    full+=byteChecksum;
  }
  if (full > blockSizeRange.getUpper()) {
    full=blockSizeRange.getUpper();
  }
  if (full < blockSizeRange.getLower()) {
    full=blockSizeRange.getLower();
  }
  return full;
}
