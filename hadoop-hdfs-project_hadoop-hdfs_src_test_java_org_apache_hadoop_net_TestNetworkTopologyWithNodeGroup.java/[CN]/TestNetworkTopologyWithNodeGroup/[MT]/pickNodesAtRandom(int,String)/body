{
  Map<Node,Integer> frequency=new HashMap<Node,Integer>();
  for (  DatanodeDescriptor dnd : dataNodes) {
    frequency.put(dnd,0);
  }
  for (int j=0; j < numNodes; j++) {
    Node random=cluster.chooseRandom(excludedScope);
    frequency.put(random,frequency.get(random) + 1);
  }
  return frequency;
}
