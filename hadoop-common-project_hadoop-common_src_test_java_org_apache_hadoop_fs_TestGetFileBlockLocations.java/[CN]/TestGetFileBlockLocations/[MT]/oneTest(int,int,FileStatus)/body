{
  if (offBegin > offEnd) {
    int tmp=offBegin;
    offBegin=offEnd;
    offEnd=tmp;
  }
  BlockLocation[] locations=fs.getFileBlockLocations(status,offBegin,offEnd - offBegin);
  if (offBegin < status.getLen()) {
    Arrays.sort(locations,new Comparator<BlockLocation>(){
      @Override public int compare(      BlockLocation arg0,      BlockLocation arg1){
        long cmprv=arg0.getOffset() - arg1.getOffset();
        if (cmprv < 0)         return -1;
        if (cmprv > 0)         return 1;
        cmprv=arg0.getLength() - arg1.getLength();
        if (cmprv < 0)         return -1;
        if (cmprv > 0)         return 1;
        return 0;
      }
    }
);
    offBegin=(int)Math.min(offBegin,status.getLen() - 1);
    offEnd=(int)Math.min(offEnd,status.getLen());
    BlockLocation first=locations[0];
    BlockLocation last=locations[locations.length - 1];
    assertTrue(first.getOffset() <= offBegin);
    assertTrue(offEnd <= last.getOffset() + last.getLength());
  }
 else {
    assertTrue(locations.length == 0);
  }
}
