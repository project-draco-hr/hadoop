{
  Configuration conf=new HdfsConfiguration();
  conf.set(DFS_NAMENODE_AUDIT_LOGGERS_KEY,BrokenAuditLogger.class.getName());
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).build();
  try {
    cluster.waitClusterUp();
    FileSystem fs=cluster.getFileSystem();
    long time=System.currentTimeMillis();
    fs.setTimes(new Path("/"),time,time);
    fail("Expected exception due to broken audit logger.");
  }
 catch (  RemoteException re) {
  }
 finally {
    cluster.shutdown();
  }
}
