{
  int testBufferSize=fs.getConf().getInt(IO_CHUNK_BUFFER_SIZE,DEFAULT_IO_CHUNK_BUFFER_SIZE);
  int modulus=fs.getConf().getInt(IO_CHUNK_MODULUS_SIZE,DEFAULT_IO_CHUNK_MODULUS_SIZE);
  final String objectName=UUID.randomUUID().toString();
  final Path objectPath=new Path(parent,objectName);
  assertEquals(fileSize,generateTestFile(fs,objectPath,fileSize,testBufferSize,modulus));
  assertPathExists(fs,"not created successful",objectPath);
  try {
    verifyReceivedData(fs,objectPath,fileSize,testBufferSize,modulus);
  }
  finally {
    fs.delete(objectPath,false);
  }
}
