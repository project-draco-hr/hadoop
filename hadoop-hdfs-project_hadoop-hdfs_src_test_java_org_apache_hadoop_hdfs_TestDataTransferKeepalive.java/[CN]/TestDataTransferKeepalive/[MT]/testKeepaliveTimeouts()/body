{
  DFSTestUtil.createFile(fs,TEST_FILE,1L,(short)1,0L);
  assertEquals(0,dfsClient.peerCache.size());
  assertXceiverCount(0);
  DFSTestUtil.readFile(fs,TEST_FILE);
  assertEquals(1,dfsClient.peerCache.size());
  assertXceiverCount(1);
  Thread.sleep(KEEPALIVE_TIMEOUT * 2);
  assertXceiverCount(0);
  assertEquals(1,dfsClient.peerCache.size());
  Peer peer=dfsClient.peerCache.get(dn.getDatanodeId(),false);
  assertNotNull(peer);
  assertEquals(-1,peer.getInputStream().read());
}
