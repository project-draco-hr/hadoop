{
  FileSystem fs=dir.getFileSystem(conf);
  for (  FileStatus f : fs.listStatus(dir)) {
    System.out.println("Reading " + f.getPath() + ": ");
    if (f.isDirectory()) {
      System.out.println("  it is a map file.");
      printSequenceFile(fs,new Path(f.getPath(),"data"),conf);
    }
 else     if (isSequenceFile(fs,f.getPath())) {
      System.out.println("  it is a sequence file.");
      printSequenceFile(fs,f.getPath(),conf);
    }
 else {
      System.out.println("  it is a text file.");
      printTextFile(fs,f.getPath());
    }
  }
}
