{
  JobEndStatusInfo notification=null;
  String uri=conf.getJobEndNotificationURI();
  if (uri != null) {
    int retryAttempts=conf.getInt(JobContext.MR_JOB_END_RETRY_ATTEMPTS,0);
    long retryInterval=conf.getInt(JobContext.MR_JOB_END_RETRY_INTERVAL,30000);
    int timeout=conf.getInt(JobContext.MR_JOB_END_NOTIFICATION_TIMEOUT,JobContext.DEFAULT_MR_JOB_END_NOTIFICATION_TIMEOUT);
    if (uri.contains("$jobId")) {
      uri=uri.replace("$jobId",status.getJobID().toString());
    }
    if (uri.contains("$jobStatus")) {
      String statusStr=(status.getRunState() == JobStatus.SUCCEEDED) ? "SUCCEEDED" : (status.getRunState() == JobStatus.FAILED) ? "FAILED" : "KILLED";
      uri=uri.replace("$jobStatus",statusStr);
    }
    notification=new JobEndStatusInfo(uri,retryAttempts,retryInterval,timeout);
  }
  return notification;
}
