{
  boolean failed=false;
  try {
    mgr.updateNodeLabels(Arrays.asList(NodeLabel.newInstance("p1",false)));
  }
 catch (  YarnException e) {
    failed=true;
  }
  Assert.assertTrue("Should fail since the node label doesn't exist",failed);
  mgr.addToCluserNodeLabels(toSet("p1","p2","p3"));
  mgr.updateNodeLabels(Arrays.asList(NodeLabel.newInstance("p1",false),NodeLabel.newInstance("p2",true)));
  Assert.assertEquals("p1",mgr.lastUpdatedNodeLabels.get(0).getNodeLabel());
  Assert.assertFalse(mgr.lastUpdatedNodeLabels.get(0).getIsExclusive());
  Assert.assertTrue(mgr.lastUpdatedNodeLabels.get(1).getIsExclusive());
  Assert.assertFalse(mgr.isExclusiveNodeLabel("p1"));
  Assert.assertTrue(mgr.isExclusiveNodeLabel("p2"));
}
