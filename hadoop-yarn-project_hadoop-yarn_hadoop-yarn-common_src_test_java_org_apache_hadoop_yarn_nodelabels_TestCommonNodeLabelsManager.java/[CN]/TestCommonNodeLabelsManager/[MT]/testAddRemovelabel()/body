{
  mgr.addToCluserNodeLabels(ImmutableSet.of("hello"));
  assertCollectionEquals(mgr.lastAddedlabels,Arrays.asList("hello"));
  mgr.addToCluserNodeLabels(ImmutableSet.of("world"));
  mgr.addToCluserNodeLabels(toSet("hello1","world1"));
  assertCollectionEquals(mgr.lastAddedlabels,Sets.newHashSet("hello1","world1"));
  Assert.assertTrue(mgr.getClusterNodeLabels().containsAll(Sets.newHashSet("hello","world","hello1","world1")));
  for (  String p : Arrays.asList(null,CommonNodeLabelsManager.NO_LABEL,"xx")) {
    boolean caught=false;
    try {
      mgr.removeFromClusterNodeLabels(Arrays.asList(p));
    }
 catch (    IOException e) {
      caught=true;
    }
    Assert.assertTrue("remove label should fail " + "when label is null/empty/non-existed",caught);
  }
  mgr.removeFromClusterNodeLabels(Arrays.asList("hello"));
  assertCollectionEquals(mgr.lastRemovedlabels,Arrays.asList("hello"));
  Assert.assertTrue(mgr.getClusterNodeLabels().containsAll(Arrays.asList("world","hello1","world1")));
  mgr.removeFromClusterNodeLabels(Arrays.asList("hello1","world1","world"));
  Assert.assertTrue(mgr.lastRemovedlabels.containsAll(Sets.newHashSet("hello1","world1","world")));
  Assert.assertTrue(mgr.getClusterNodeLabels().isEmpty());
}
