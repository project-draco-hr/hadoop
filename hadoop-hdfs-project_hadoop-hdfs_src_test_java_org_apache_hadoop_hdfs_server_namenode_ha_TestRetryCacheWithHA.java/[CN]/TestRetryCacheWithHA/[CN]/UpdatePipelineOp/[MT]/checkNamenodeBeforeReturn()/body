{
  INodeFile fileNode=cluster.getNamesystem(0).getFSDirectory().getINode4Write(file).asFile();
  BlockInfoContiguousUnderConstruction blkUC=(BlockInfoContiguousUnderConstruction)(fileNode.getBlocks())[1];
  int datanodeNum=blkUC.getExpectedStorageLocations().length;
  for (int i=0; i < CHECKTIMES && datanodeNum != 2; i++) {
    Thread.sleep(1000);
    datanodeNum=blkUC.getExpectedStorageLocations().length;
  }
  return datanodeNum == 2;
}
