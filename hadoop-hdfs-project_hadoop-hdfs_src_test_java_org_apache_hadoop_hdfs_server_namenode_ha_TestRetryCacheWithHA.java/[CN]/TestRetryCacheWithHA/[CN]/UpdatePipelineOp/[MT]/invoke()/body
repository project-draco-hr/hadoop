{
  DatanodeInfo[] newNodes=new DatanodeInfo[2];
  newNodes[0]=nodes[0];
  newNodes[1]=nodes[1];
  final DatanodeManager dm=cluster.getNamesystem(0).getBlockManager().getDatanodeManager();
  final String storageID1=dm.getDatanode(newNodes[0]).getStorageInfos()[0].getStorageID();
  final String storageID2=dm.getDatanode(newNodes[1]).getStorageInfos()[0].getStorageID();
  String[] storageIDs={storageID1,storageID2};
  client.getNamenode().updatePipeline(client.getClientName(),oldBlock,newBlock,newNodes,storageIDs);
  DFSTestUtil.abortStream((DFSOutputStream)out.getWrappedStream());
}
