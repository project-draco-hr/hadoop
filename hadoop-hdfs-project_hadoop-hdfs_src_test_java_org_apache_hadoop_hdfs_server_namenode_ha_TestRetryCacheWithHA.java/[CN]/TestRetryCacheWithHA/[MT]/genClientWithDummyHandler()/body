{
  URI nnUri=dfs.getUri();
  Class<FailoverProxyProvider<ClientProtocol>> failoverProxyProviderClass=NameNodeProxies.getFailoverProxyProviderClass(conf,nnUri,ClientProtocol.class);
  FailoverProxyProvider<ClientProtocol> failoverProxyProvider=NameNodeProxies.createFailoverProxyProvider(conf,failoverProxyProviderClass,ClientProtocol.class,nnUri);
  InvocationHandler dummyHandler=new DummyRetryInvocationHandler(failoverProxyProvider,RetryPolicies.failoverOnNetworkException(RetryPolicies.TRY_ONCE_THEN_FAIL,Integer.MAX_VALUE,DFSConfigKeys.DFS_CLIENT_FAILOVER_SLEEPTIME_BASE_DEFAULT,DFSConfigKeys.DFS_CLIENT_FAILOVER_SLEEPTIME_MAX_DEFAULT));
  ClientProtocol proxy=(ClientProtocol)Proxy.newProxyInstance(failoverProxyProvider.getInterface().getClassLoader(),new Class[]{ClientProtocol.class},dummyHandler);
  DFSClient client=new DFSClient(null,proxy,conf,null);
  return client;
}
