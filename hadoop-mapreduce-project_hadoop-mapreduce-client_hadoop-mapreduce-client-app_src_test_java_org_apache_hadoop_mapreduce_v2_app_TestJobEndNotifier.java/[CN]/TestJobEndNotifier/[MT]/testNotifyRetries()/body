{
  Configuration conf=new Configuration();
  conf.set(MRJobConfig.MR_JOB_END_NOTIFICATION_URL,"http://nonexistent");
  JobReport jobReport=mock(JobReport.class);
  long startTime=System.currentTimeMillis();
  this.notificationCount=0;
  this.setConf(conf);
  this.notify(jobReport);
  long endTime=System.currentTimeMillis();
  Assert.assertEquals("Only 1 try was expected but was : " + this.notificationCount,this.notificationCount,1);
  Assert.assertTrue("Should have taken more than 5 seconds it took " + (endTime - startTime),endTime - startTime > 5000);
  conf.set(MRJobConfig.MR_JOB_END_NOTIFICATION_MAX_ATTEMPTS,"3");
  conf.set(MRJobConfig.MR_JOB_END_RETRY_ATTEMPTS,"3");
  conf.set(MRJobConfig.MR_JOB_END_RETRY_INTERVAL,"3000");
  conf.set(MRJobConfig.MR_JOB_END_NOTIFICATION_MAX_RETRY_INTERVAL,"3000");
  startTime=System.currentTimeMillis();
  this.notificationCount=0;
  this.setConf(conf);
  this.notify(jobReport);
  endTime=System.currentTimeMillis();
  Assert.assertEquals("Only 3 retries were expected but was : " + this.notificationCount,this.notificationCount,3);
  Assert.assertTrue("Should have taken more than 9 seconds it took " + (endTime - startTime),endTime - startTime > 9000);
}
