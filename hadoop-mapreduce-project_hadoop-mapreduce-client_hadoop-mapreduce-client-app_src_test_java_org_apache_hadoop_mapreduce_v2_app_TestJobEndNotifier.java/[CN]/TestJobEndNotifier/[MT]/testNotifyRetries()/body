{
  JobConf conf=new JobConf();
  conf.set(MRJobConfig.MR_JOB_END_RETRY_ATTEMPTS,"0");
  conf.set(MRJobConfig.MR_JOB_END_NOTIFICATION_MAX_ATTEMPTS,"1");
  conf.set(MRJobConfig.MR_JOB_END_NOTIFICATION_URL,"http://nonexistent");
  conf.set(MRJobConfig.MR_JOB_END_RETRY_INTERVAL,"5000");
  conf.set(MRJobConfig.MR_JOB_END_NOTIFICATION_MAX_RETRY_INTERVAL,"5000");
  JobReport jobReport=mock(JobReport.class);
  long startTime=System.currentTimeMillis();
  this.notificationCount=0;
  this.setConf(conf);
  this.notify(jobReport);
  long endTime=System.currentTimeMillis();
  Assert.assertEquals("Only 1 try was expected but was : " + this.notificationCount,1,this.notificationCount);
  Assert.assertTrue("Should have taken more than 5 seconds it took " + (endTime - startTime),endTime - startTime > 5000);
  conf.set(MRJobConfig.MR_JOB_END_NOTIFICATION_MAX_ATTEMPTS,"3");
  conf.set(MRJobConfig.MR_JOB_END_RETRY_ATTEMPTS,"3");
  conf.set(MRJobConfig.MR_JOB_END_RETRY_INTERVAL,"3000");
  conf.set(MRJobConfig.MR_JOB_END_NOTIFICATION_MAX_RETRY_INTERVAL,"3000");
  startTime=System.currentTimeMillis();
  this.notificationCount=0;
  this.setConf(conf);
  this.notify(jobReport);
  endTime=System.currentTimeMillis();
  Assert.assertEquals("Only 3 retries were expected but was : " + this.notificationCount,3,this.notificationCount);
  Assert.assertTrue("Should have taken more than 9 seconds it took " + (endTime - startTime),endTime - startTime > 9000);
}
