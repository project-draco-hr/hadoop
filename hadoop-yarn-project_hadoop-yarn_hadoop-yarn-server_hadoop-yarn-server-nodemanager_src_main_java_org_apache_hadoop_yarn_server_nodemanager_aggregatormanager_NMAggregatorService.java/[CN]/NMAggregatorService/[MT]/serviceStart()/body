{
  Configuration conf=getConfig();
  InetSocketAddress aggregatorServerAddress=conf.getSocketAddr(YarnConfiguration.NM_BIND_HOST,YarnConfiguration.NM_AGGREGATOR_SERVICE_ADDRESS,YarnConfiguration.DEFAULT_NM_AGGREGATOR_SERVICE_ADDRESS,YarnConfiguration.DEFAULT_NM_AGGREGATOR_SERVICE_PORT);
  Configuration serverConf=new Configuration(conf);
  YarnRPC rpc=YarnRPC.create(conf);
  server=rpc.getServer(AggregatorNodemanagerProtocol.class,this,aggregatorServerAddress,serverConf,this.context.getNMTokenSecretManager(),conf.getInt(YarnConfiguration.NM_AGGREGATOR_SERVICE_THREAD_COUNT,YarnConfiguration.DEFAULT_NM_AGGREGATOR_SERVICE_THREAD_COUNT));
  server.start();
  super.serviceStart();
  LOG.info("NMAggregatorService started at " + aggregatorServerAddress);
}
