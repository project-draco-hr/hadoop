{
  Builder<ApplicationMasterService> builder=WebApps.$for("cluster",ApplicationMasterService.class,masterService,"ws").at(this.conf.get(YarnConfiguration.RM_WEBAPP_ADDRESS,YarnConfiguration.DEFAULT_RM_WEBAPP_ADDRESS));
  if (YarnConfiguration.getRMWebAppHostAndPort(conf).equals(YarnConfiguration.getProxyHostAndPort(conf))) {
    AppReportFetcher fetcher=new AppReportFetcher(conf,getClientRMService());
    builder.withServlet(ProxyUriUtils.PROXY_SERVLET_NAME,ProxyUriUtils.PROXY_PATH_SPEC,WebAppProxyServlet.class);
    builder.withAttribute(WebAppProxy.FETCHER_ATTRIBUTE,fetcher);
    String proxy=YarnConfiguration.getProxyHostAndPort(conf);
    String[] proxyParts=proxy.split(":");
    builder.withAttribute(WebAppProxy.PROXY_HOST_ATTRIBUTE,proxyParts[0]);
  }
  webApp=builder.start(new RMWebApp(this));
}
