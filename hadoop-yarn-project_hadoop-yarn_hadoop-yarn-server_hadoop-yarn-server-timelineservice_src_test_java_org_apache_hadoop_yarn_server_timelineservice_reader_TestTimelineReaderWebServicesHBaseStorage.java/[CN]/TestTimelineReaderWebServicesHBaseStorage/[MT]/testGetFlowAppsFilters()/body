{
  Client client=createClient();
  try {
    String entityType=TimelineEntityType.YARN_APPLICATION.toString();
    URI uri=URI.create("http://localhost:" + serverPort + "/ws/v2/"+ "timeline/flowapps/cluster1/flow_name?userid=user1&eventfilters="+ ApplicationMetricsConstants.FINISHED_EVENT_TYPE);
    ClientResponse resp=getResponse(client,uri);
    Set<TimelineEntity> entities=resp.getEntity(new GenericType<Set<TimelineEntity>>(){
    }
);
    assertNotNull(entities);
    assertEquals(1,entities.size());
    assertTrue("Unexpected app in result",entities.contains(newEntity(entityType,"application_1111111111_1111")));
    uri=URI.create("http://localhost:" + serverPort + "/ws/v2/"+ "timeline/flowapps/cluster1/flow_name?userid=user1&metricfilters="+ "HDFS_BYTES_READ");
    resp=getResponse(client,uri);
    entities=resp.getEntity(new GenericType<Set<TimelineEntity>>(){
    }
);
    assertNotNull(entities);
    assertEquals(1,entities.size());
    assertTrue("Unexpected app in result",entities.contains(newEntity(entityType,"application_1111111111_1111")));
    uri=URI.create("http://localhost:" + serverPort + "/ws/v2/"+ "timeline/flowapps/cluster1/flow_name?userid=user1&conffilters="+ "cfg1:value1");
    resp=getResponse(client,uri);
    entities=resp.getEntity(new GenericType<Set<TimelineEntity>>(){
    }
);
    assertNotNull(entities);
    assertEquals(1,entities.size());
    assertTrue("Unexpected app in result",entities.contains(newEntity(entityType,"application_1111111111_2222")));
  }
  finally {
    client.destroy();
  }
}
