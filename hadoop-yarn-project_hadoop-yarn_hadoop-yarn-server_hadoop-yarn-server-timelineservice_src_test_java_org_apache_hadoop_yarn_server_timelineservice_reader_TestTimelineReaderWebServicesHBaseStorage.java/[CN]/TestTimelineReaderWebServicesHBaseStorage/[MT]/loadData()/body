{
  String cluster="cluster1";
  String user="user1";
  String flow="flow_name";
  String flowVersion="CF7022C10F1354";
  Long runid=1002345678919L;
  Long runid1=1002345678920L;
  TimelineEntities te=new TimelineEntities();
  TimelineEntity entity=new TimelineEntity();
  String id="application_1111111111_1111";
  String type=TimelineEntityType.YARN_APPLICATION.toString();
  entity.setId(id);
  entity.setType(type);
  Long cTime=1425016501000L;
  entity.setCreatedTime(cTime);
  entity.addConfig("cfg2","value1");
  Set<TimelineMetric> metrics=new HashSet<>();
  TimelineMetric m1=new TimelineMetric();
  m1.setId("MAP_SLOT_MILLIS");
  Map<Long,Number> metricValues=new HashMap<Long,Number>();
  metricValues.put(ts - 100000,2);
  metricValues.put(ts - 80000,40);
  m1.setType(Type.TIME_SERIES);
  m1.setValues(metricValues);
  metrics.add(m1);
  m1=new TimelineMetric();
  m1.setId("HDFS_BYTES_READ");
  metricValues=new HashMap<Long,Number>();
  metricValues.put(ts - 100000,31);
  metricValues.put(ts - 80000,57);
  m1.setType(Type.TIME_SERIES);
  m1.setValues(metricValues);
  metrics.add(m1);
  entity.addMetrics(metrics);
  TimelineEvent event=new TimelineEvent();
  event.setId(ApplicationMetricsConstants.CREATED_EVENT_TYPE);
  Long expTs=1436512802000L;
  event.setTimestamp(expTs);
  String expKey="foo_event";
  Object expVal="test";
  event.addInfo(expKey,expVal);
  entity.addEvent(event);
  TimelineEvent event11=new TimelineEvent();
  event11.setId(ApplicationMetricsConstants.FINISHED_EVENT_TYPE);
  expTs=1436512802010L;
  event11.setTimestamp(expTs);
  entity.addEvent(event11);
  te.addEntity(entity);
  TimelineEntities te1=new TimelineEntities();
  TimelineEntity entity1=new TimelineEntity();
  id="application_1111111111_2222";
  type=TimelineEntityType.YARN_APPLICATION.toString();
  entity1.setId(id);
  entity1.setType(type);
  cTime=1425016501000L;
  entity1.setCreatedTime(cTime);
  entity1.addConfig("cfg1","value1");
  metrics.clear();
  TimelineMetric m2=new TimelineMetric();
  m2.setId("MAP_SLOT_MILLIS");
  metricValues=new HashMap<Long,Number>();
  metricValues.put(ts - 100000,5L);
  metricValues.put(ts - 80000,101L);
  m2.setType(Type.TIME_SERIES);
  m2.setValues(metricValues);
  metrics.add(m2);
  entity1.addMetrics(metrics);
  TimelineEvent event1=new TimelineEvent();
  event1.setId(ApplicationMetricsConstants.CREATED_EVENT_TYPE);
  event1.setTimestamp(expTs);
  event1.addInfo(expKey,expVal);
  entity1.addEvent(event1);
  te1.addEntity(entity1);
  String flow2="flow_name2";
  String flowVersion2="CF7022C10F1454";
  Long runid2=2102356789046L;
  TimelineEntities te3=new TimelineEntities();
  TimelineEntity entity3=new TimelineEntity();
  id="application_11111111111111_2223";
  entity3.setId(id);
  entity3.setType(type);
  cTime=1425016501037L;
  entity3.setCreatedTime(cTime);
  TimelineEvent event2=new TimelineEvent();
  event2.setId(ApplicationMetricsConstants.CREATED_EVENT_TYPE);
  event2.setTimestamp(1436512802037L);
  event2.addInfo("foo_event","test");
  entity3.addEvent(event2);
  te3.addEntity(entity3);
  TimelineEntities te4=new TimelineEntities();
  TimelineEntity entity4=new TimelineEntity();
  id="application_1111111111_2224";
  entity4.setId(id);
  entity4.setType(type);
  cTime=1425016501034L;
  entity4.setCreatedTime(cTime);
  TimelineEvent event4=new TimelineEvent();
  event4.setId(ApplicationMetricsConstants.CREATED_EVENT_TYPE);
  event4.setTimestamp(1436512802037L);
  event4.addInfo("foo_event","test");
  entity4.addEvent(event4);
  te4.addEntity(entity4);
  HBaseTimelineWriterImpl hbi=null;
  Configuration c1=util.getConfiguration();
  try {
    hbi=new HBaseTimelineWriterImpl(c1);
    hbi.init(c1);
    hbi.write(cluster,user,flow,flowVersion,runid,entity.getId(),te);
    hbi.write(cluster,user,flow,flowVersion,runid,entity1.getId(),te1);
    hbi.write(cluster,user,flow,flowVersion,runid1,entity4.getId(),te4);
    hbi.write(cluster,user,flow2,flowVersion2,runid2,entity3.getId(),te3);
    hbi.flush();
  }
  finally {
    hbi.close();
  }
}
