{
  if (allowAllOrigins) {
    return true;
  }
  for (  String allowedOrigin : allowedOrigins) {
    if (allowedOrigin.contains("*")) {
      String regex=allowedOrigin.replace(".","\\.").replace("*",".*");
      Pattern p=Pattern.compile(regex);
      Matcher m=p.matcher(origin);
      if (m.matches()) {
        return true;
      }
    }
 else     if (allowedOrigin.equals(origin)) {
      return true;
    }
  }
  return false;
}
