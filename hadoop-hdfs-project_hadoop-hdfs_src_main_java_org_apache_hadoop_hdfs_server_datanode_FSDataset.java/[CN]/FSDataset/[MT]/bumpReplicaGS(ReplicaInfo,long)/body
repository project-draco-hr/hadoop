{
  long oldGS=replicaInfo.getGenerationStamp();
  File oldmeta=replicaInfo.getMetaFile();
  replicaInfo.setGenerationStamp(newGS);
  File newmeta=replicaInfo.getMetaFile();
  if (DataNode.LOG.isDebugEnabled()) {
    DataNode.LOG.debug("Renaming " + oldmeta + " to "+ newmeta);
  }
  if (!oldmeta.renameTo(newmeta)) {
    replicaInfo.setGenerationStamp(oldGS);
    throw new IOException("Block " + replicaInfo + " reopen failed. "+ " Unable to move meta file  "+ oldmeta+ " to "+ newmeta);
  }
}
