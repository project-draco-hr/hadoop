{
  long startTime=Time.monotonicNow();
  NodePlan plan=new NodePlan(node.getDataNodeName(),node.getDataNodePort());
  LOG.info("Starting plan for Node : {}:{}",node.getDataNodeName(),node.getDataNodePort());
  while (node.isBalancingNeeded(this.threshold)) {
    for (    DiskBalancerVolumeSet vSet : node.getVolumeSets().values()) {
      balanceVolumeSet(node,vSet,plan);
    }
  }
  long endTime=Time.monotonicNow();
  String message=String.format("Compute Plan for Node : %s:%d took %d ms ",node.getDataNodeName(),node.getDataNodePort(),endTime - startTime);
  LOG.info(message);
  return plan;
}
