{
  YarnConfiguration conf=new YarnConfiguration();
  conf.set(YarnConfiguration.NM_LOCAL_CACHE_MAX_FILES_PER_DIRECTORY,"37");
  LocalCacheDirectoryManager hDir=new LocalCacheDirectoryManager(conf);
  Assert.assertTrue(hDir.getRelativePathForLocalization().isEmpty());
  for (int i=1; i <= 37 * 36 * 36; i++) {
    StringBuffer sb=new StringBuffer();
    String num=Integer.toString(i - 1,36);
    if (num.length() == 1) {
      sb.append(num.charAt(0));
    }
 else {
      sb.append(Integer.toString(Integer.parseInt(num.substring(0,1),36) - 1,36));
    }
    for (int j=1; j < num.length(); j++) {
      sb.append(Path.SEPARATOR).append(num.charAt(j));
    }
    Assert.assertEquals(sb.toString(),hDir.getRelativePathForLocalization());
  }
  String testPath1="4";
  String testPath2="2";
  hDir.decrementFileCountForPath(testPath1);
  hDir.decrementFileCountForPath(testPath2);
  Assert.assertEquals(testPath1,hDir.getRelativePathForLocalization());
  Assert.assertEquals(testPath2,hDir.getRelativePathForLocalization());
}
