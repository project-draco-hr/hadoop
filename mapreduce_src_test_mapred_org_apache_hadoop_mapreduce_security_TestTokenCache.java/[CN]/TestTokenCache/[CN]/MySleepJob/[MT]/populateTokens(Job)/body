{
  try {
    Credentials ts=job.getCredentials();
    Path p1=new Path("file1");
    p1=p1.getFileSystem(job.getConfiguration()).makeQualified(p1);
    Credentials cred=new Credentials();
    TokenCache.obtainTokensForNamenodesInternal(cred,new Path[]{p1},job.getConfiguration());
    for (    Token<? extends TokenIdentifier> t : cred.getAllTokens()) {
      ts.addToken(new Text("Hdfs"),t);
    }
  }
 catch (  IOException e) {
    Assert.fail("Exception " + e);
  }
}
