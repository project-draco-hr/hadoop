{
  Path outputDir=getOutputPath();
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.getLocal(conf);
  FileStatus[] stats=fs.listStatus(outputDir);
  int valueSum=0;
  for (  FileStatus f : stats) {
    FSDataInputStream istream=fs.open(f.getPath());
    BufferedReader r=new BufferedReader(new InputStreamReader(istream));
    String line=null;
    while ((line=r.readLine()) != null) {
      valueSum+=Integer.valueOf(line.trim());
    }
    r.close();
  }
  int maxVal=NUMBER_FILE_VAL - 1;
  int expectedPerMapper=maxVal * (maxVal + 1) / 2;
  int expectedSum=expectedPerMapper * numMaps;
  LOG.info("expected sum: " + expectedSum + ", got "+ valueSum);
  assertEquals("Didn't get all our results back",expectedSum,valueSum);
}
