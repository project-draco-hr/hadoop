{
  RMApp application=null;
  if (submissionContext != null && submissionContext.getUnmanagedAM()) {
    application=testCreateAppRunning(submissionContext);
  }
 else {
    application=testCreateAppFinishing(submissionContext);
  }
  RMAppEvent finishedEvent=new RMAppEvent(application.getApplicationId(),RMAppEventType.ATTEMPT_FINISHED);
  application.handle(finishedEvent);
  assertAppState(RMAppState.FINISHED,application);
  assertTimesAtFinish(application);
  assertFinalAppStatus(FinalApplicationStatus.FAILED,application);
  return application;
}
