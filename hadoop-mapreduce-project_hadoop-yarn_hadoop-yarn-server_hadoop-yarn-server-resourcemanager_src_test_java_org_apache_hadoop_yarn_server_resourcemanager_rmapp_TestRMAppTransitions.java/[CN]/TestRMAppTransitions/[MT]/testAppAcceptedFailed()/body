{
  LOG.info("--- START: testAppAcceptedFailed ---");
  RMApp application=testCreateAppAccepted();
  for (int i=1; i < maxRetries; i++) {
    RMAppEvent event=new RMAppEvent(application.getApplicationId(),RMAppEventType.ATTEMPT_FAILED);
    application.handle(event);
    assertAppState(RMAppState.SUBMITTED,application);
    event=new RMAppEvent(application.getApplicationId(),RMAppEventType.APP_ACCEPTED);
    application.handle(event);
    assertAppState(RMAppState.ACCEPTED,application);
  }
  RMAppEvent event=new RMAppEvent(application.getApplicationId(),RMAppEventType.ATTEMPT_FAILED);
  application.handle(event);
  assertFailed(application,".*Failing the application.*");
}
