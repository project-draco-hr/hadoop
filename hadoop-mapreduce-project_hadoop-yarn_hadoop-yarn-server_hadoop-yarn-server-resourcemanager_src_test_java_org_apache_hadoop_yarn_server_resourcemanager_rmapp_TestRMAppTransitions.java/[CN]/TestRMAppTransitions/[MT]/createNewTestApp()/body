{
  ApplicationId applicationId=MockApps.newAppID(appId++);
  String user=MockApps.newUserName();
  String name=MockApps.newAppName();
  String queue=MockApps.newQueue();
  Configuration conf=new YarnConfiguration();
  conf.setInt(YarnConfiguration.RM_AM_MAX_RETRIES,maxRetries);
  ApplicationSubmissionContext submissionContext=null;
  String clientTokenStr="bogusstring";
  ApplicationStore appStore=mock(ApplicationStore.class);
  YarnScheduler scheduler=mock(YarnScheduler.class);
  ApplicationMasterService masterService=new ApplicationMasterService(rmContext,scheduler);
  RMApp application=new RMAppImpl(applicationId,rmContext,conf,name,user,queue,submissionContext,clientTokenStr,appStore,scheduler,masterService,System.currentTimeMillis());
  testAppStartState(applicationId,user,name,queue,application);
  return application;
}
