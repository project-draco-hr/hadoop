{
  ApplicationId applicationId=MockApps.newAppID(appId++);
  String user=MockApps.newUserName();
  String name=MockApps.newAppName();
  String queue=MockApps.newQueue();
  Configuration conf=new YarnConfiguration();
  conf.setInt("yarn.server.resourcemanager.application.max.retries",maxRetries);
  ApplicationSubmissionContext submissionContext=null;
  String clientTokenStr="bogusstring";
  ApplicationStore appStore=mock(ApplicationStore.class);
  YarnScheduler scheduler=mock(YarnScheduler.class);
  ApplicationMasterService masterService=new ApplicationMasterService(rmContext,new ApplicationTokenSecretManager(),scheduler);
  RMApp application=new RMAppImpl(applicationId,rmContext,conf,name,user,queue,submissionContext,clientTokenStr,appStore,rmContext.getAMLivelinessMonitor(),scheduler,masterService);
  testAppStartState(applicationId,user,name,queue,application);
  return application;
}
