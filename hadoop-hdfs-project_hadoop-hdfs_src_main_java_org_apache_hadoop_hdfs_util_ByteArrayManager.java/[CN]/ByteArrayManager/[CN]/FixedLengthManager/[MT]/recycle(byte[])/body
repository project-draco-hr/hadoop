{
  Preconditions.checkNotNull(array);
  Preconditions.checkArgument(array.length == byteArrayLength);
  if (LOG.isDebugEnabled()) {
    debugMessage.get().append(", ").append(this);
  }
  if (numAllocated == maxAllocated) {
    if (LOG.isDebugEnabled()) {
      debugMessage.get().append(", notifyAll");
    }
    notifyAll();
  }
  numAllocated--;
  if (numAllocated < 0) {
    numAllocated=0;
  }
  if (freeQueue.size() < maxAllocated - numAllocated) {
    if (LOG.isDebugEnabled()) {
      debugMessage.get().append(", freeQueue.offer");
    }
    freeQueue.offer(array);
  }
  return freeQueue.size();
}
