{
  Configuration conf=getConf();
  if ("local".equals(conf.get(JTConfig.JT_IPC_ADDRESS,"local"))) {
    displayUsage();
  }
  String[] otherArgs=new GenericOptionsParser(conf,args).getRemainingArgs();
  if (otherArgs.length == 2) {
    if (otherArgs[0].equals("-scratchdir")) {
      dir=otherArgs[1];
    }
 else {
      displayUsage();
    }
  }
 else   if (otherArgs.length == 0) {
    dir=System.getProperty("user.dir");
  }
 else {
    displayUsage();
  }
  conf.setInt(JobContext.MAP_MAX_ATTEMPTS,10);
  conf.setInt(JobContext.REDUCE_MAX_ATTEMPTS,10);
  runSleepJobTest(new JobClient(new JobConf(conf)),conf);
  runSortJobTests(new JobClient(new JobConf(conf)),conf);
  return 0;
}
