{
  String[] baseDirs=conf.getStrings(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY);
  UpgradeUtilities.createEmptyDirs(baseDirs);
  if (state[0])   UpgradeUtilities.createNameNodeStorageDirs(baseDirs,"current");
  if (state[1])   UpgradeUtilities.createNameNodeStorageDirs(baseDirs,"previous");
  if (state[2])   UpgradeUtilities.createNameNodeStorageDirs(baseDirs,"previous.tmp");
  if (state[3])   UpgradeUtilities.createNameNodeStorageDirs(baseDirs,"removed.tmp");
  if (state[4])   UpgradeUtilities.createNameNodeStorageDirs(baseDirs,"lastcheckpoint.tmp");
  return baseDirs;
}
