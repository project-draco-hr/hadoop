{
  final InetSocketAddress address=SecurityUtil.getTokenServiceAddr(token);
  Text kind=token.getKind();
  final URI uri;
  if (kind.equals(HftpFileSystem.TOKEN_KIND)) {
    uri=DFSUtil.createUri(HftpFileSystem.SCHEME,address);
  }
 else   if (kind.equals(HsftpFileSystem.TOKEN_KIND)) {
    uri=DFSUtil.createUri(HsftpFileSystem.SCHEME,address);
  }
 else   if (kind.equals(WebHdfsFileSystem.TOKEN_KIND)) {
    uri=DFSUtil.createUri(WebHdfsFileSystem.SCHEME,address);
  }
 else {
    throw new IllegalArgumentException("Unsupported scheme");
  }
  return (TokenManagementDelegator)FileSystem.get(uri,conf);
}
