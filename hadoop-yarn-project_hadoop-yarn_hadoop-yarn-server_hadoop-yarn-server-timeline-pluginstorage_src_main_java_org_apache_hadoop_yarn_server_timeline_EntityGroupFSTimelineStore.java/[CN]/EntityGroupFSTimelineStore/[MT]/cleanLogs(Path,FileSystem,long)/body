{
  long now=Time.now();
  RemoteIterator<FileStatus> iter=fs.listStatusIterator(dirpath);
  while (iter.hasNext()) {
    FileStatus stat=iter.next();
    if (stat.isDirectory()) {
      ApplicationId appId=parseApplicationId(dirpath.getName());
      if (appId != null) {
        if (shouldCleanAppLogDir(dirpath,now,fs,retainMillis)) {
          try {
            LOG.info("Deleting {}",dirpath);
            if (!fs.delete(dirpath,true)) {
              LOG.error("Unable to remove " + dirpath);
            }
          }
 catch (          IOException e) {
            LOG.error("Unable to remove " + dirpath,e);
          }
        }
      }
 else {
        cleanLogs(stat.getPath(),fs,retainMillis);
      }
    }
  }
}
