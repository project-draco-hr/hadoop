{
  LOG.info("Stopping {}",getName());
  if (executor != null) {
    executor.shutdown();
    if (executor.isTerminating()) {
      LOG.info("Waiting for executor to terminate");
      boolean terminated=executor.awaitTermination(10,TimeUnit.SECONDS);
      if (terminated) {
        LOG.info("Executor terminated");
      }
 else {
        LOG.warn("Executor did not terminate");
        executor.shutdownNow();
      }
    }
  }
  if (summaryTdm != null) {
    summaryTdm.stop();
  }
  if (summaryStore != null) {
    summaryStore.stop();
  }
  if (yarnClient != null) {
    yarnClient.stop();
  }
synchronized (cachedLogs) {
    for (    EntityCacheItem cacheItem : cachedLogs.values()) {
      cacheItem.getStore().close();
    }
  }
  super.serviceStop();
}
