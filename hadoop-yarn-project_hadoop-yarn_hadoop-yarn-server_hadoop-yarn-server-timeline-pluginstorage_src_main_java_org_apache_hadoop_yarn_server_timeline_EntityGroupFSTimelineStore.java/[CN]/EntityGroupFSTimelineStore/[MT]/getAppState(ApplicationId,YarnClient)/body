{
  AppState appState=AppState.ACTIVE;
  try {
    ApplicationReport report=yarnClient.getApplicationReport(appId);
    YarnApplicationState yarnState=report.getYarnApplicationState();
    if (APP_FINAL_STATES.contains(yarnState)) {
      appState=AppState.COMPLETED;
    }
  }
 catch (  ApplicationNotFoundException e) {
    appState=AppState.UNKNOWN;
  }
catch (  YarnException e) {
    throw new IOException(e);
  }
  return appState;
}
