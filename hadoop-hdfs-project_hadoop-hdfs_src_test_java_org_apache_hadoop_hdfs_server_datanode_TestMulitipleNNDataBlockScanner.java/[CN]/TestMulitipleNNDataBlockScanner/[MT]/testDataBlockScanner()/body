{
  setUp(9923);
  try {
    DataNode dn=cluster.getDataNodes().get(0);
    for (int i=0; i < 3; i++) {
      long blocksScanned=0;
      while (blocksScanned != 20) {
        blocksScanned=dn.blockScanner.getBlocksScannedInLastRun(bpids[i]);
        LOG.info("Waiting for all blocks to be scanned for bpid=" + bpids[i] + "; Scanned so far="+ blocksScanned);
        Thread.sleep(5000);
      }
    }
    StringBuilder buffer=new StringBuilder();
    dn.blockScanner.printBlockReport(buffer,false);
    LOG.info("Block Report\n" + buffer.toString());
  }
  finally {
    cluster.shutdown();
  }
}
