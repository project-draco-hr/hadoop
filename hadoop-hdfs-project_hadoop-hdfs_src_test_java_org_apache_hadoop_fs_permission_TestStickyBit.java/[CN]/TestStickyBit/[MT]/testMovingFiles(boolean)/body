{
  Path tmpPath=new Path("/tmp");
  Path tmpPath2=new Path("/tmp2");
  hdfs.mkdirs(tmpPath);
  hdfs.mkdirs(tmpPath2);
  hdfs.setPermission(tmpPath,new FsPermission((short)01777));
  if (useAcl) {
    applyAcl(tmpPath);
  }
  hdfs.setPermission(tmpPath2,new FsPermission((short)01777));
  if (useAcl) {
    applyAcl(tmpPath2);
  }
  Path file=new Path(tmpPath,"foo");
  writeFile(hdfsAsUser1,file);
  try {
    hdfsAsUser2.rename(file,new Path(tmpPath2,"renamed"));
    fail("Shouldn't be able to rename someone else's file with SB on");
  }
 catch (  IOException ioe) {
    assertTrue(ioe instanceof AccessControlException);
    assertTrue(ioe.getMessage().contains("sticky bit"));
  }
}
