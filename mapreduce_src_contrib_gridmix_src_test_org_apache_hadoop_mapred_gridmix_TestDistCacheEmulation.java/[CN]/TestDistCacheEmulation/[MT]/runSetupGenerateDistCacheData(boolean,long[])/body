{
  Configuration conf=new Configuration();
  long[] fileSizes=configureDummyDistCacheFiles(conf,false);
  System.arraycopy(fileSizes,0,sortedFileSizes,0,fileSizes.length);
  final int numJobs=3;
  DebugJobProducer jobProducer=new DebugJobProducer(numJobs,conf);
  JobConf jobConf=GridmixTestUtils.mrCluster.createJobConf(new JobConf(conf));
  Path ioPath=new Path("testSetupGenerateDistCacheData").makeQualified(GridmixTestUtils.dfs);
  FileSystem fs=FileSystem.get(jobConf);
  if (fs.exists(ioPath)) {
    fs.delete(ioPath,true);
  }
  FileSystem.mkdirs(fs,ioPath,new FsPermission((short)0777));
  dce=createDistributedCacheEmulator(jobConf,ioPath,generate);
  int exitCode=dce.setupGenerateDistCacheData(jobProducer);
  int expectedExitCode=generate ? 0 : dce.MISSING_DIST_CACHE_FILES_ERROR;
  assertEquals("setupGenerateDistCacheData failed.",expectedExitCode,exitCode);
  resetDistCacheConfigProperties(jobConf);
  return jobConf;
}
