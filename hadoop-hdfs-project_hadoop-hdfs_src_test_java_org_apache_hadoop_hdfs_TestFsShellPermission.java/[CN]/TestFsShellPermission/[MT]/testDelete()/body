{
  Configuration conf=null;
  MiniDFSCluster cluster=null;
  try {
    conf=new Configuration();
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
    String nnUri=FileSystem.getDefaultUri(conf).toString();
    FileSystem fs=FileSystem.get(URI.create(nnUri),conf);
    ArrayList<TestDeleteHelper> ta=new ArrayList<TestDeleteHelper>();
    ta.add(genRmrEmptyDirWithReadPerm());
    ta.add(genRmrEmptyDirWithNoPerm());
    ta.add(genRmrfEmptyDirWithNoPerm());
    ta.add(genRmrNonEmptyDirWithReadPerm());
    ta.add(genRmrNonEmptyDirWithNoPerm());
    ta.add(genRmrNonEmptyDirWithAllPerm());
    ta.add(genRmrfNonEmptyDirWithNoPerm());
    ta.add(genDeleteSingleFileNotAsOwner());
    for (    TestDeleteHelper t : ta) {
      t.execute(conf,fs);
    }
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}
