{
  DatanodeDescriptor nodeNotInMap=DFSTestUtil.getDatanodeDescriptor("3.3.3.3","/d1/r4");
  assertFalse(map.remove(nodeNotInMap));
  assertTrue(map.remove(dataNodes[0]));
  assertTrue(map.getDatanodeByHost("1.1.1.1.") == null);
  assertTrue(map.getDatanodeByHost("2.2.2.2") == dataNodes[1]);
  DatanodeDescriptor node=map.getDatanodeByHost("3.3.3.3");
  assertTrue(node == dataNodes[2] || node == dataNodes[3]);
  assertNull(map.getDatanodeByHost("4.4.4.4"));
  assertTrue(map.remove(dataNodes[2]));
  assertNull(map.getDatanodeByHost("1.1.1.1"));
  assertEquals(map.getDatanodeByHost("2.2.2.2"),dataNodes[1]);
  assertEquals(map.getDatanodeByHost("3.3.3.3"),dataNodes[3]);
  assertTrue(map.remove(dataNodes[3]));
  assertNull(map.getDatanodeByHost("1.1.1.1"));
  assertEquals(map.getDatanodeByHost("2.2.2.2"),dataNodes[1]);
  assertNull(map.getDatanodeByHost("3.3.3.3"));
  assertFalse(map.remove(null));
  assertTrue(map.remove(dataNodes[1]));
  assertFalse(map.remove(dataNodes[1]));
}
