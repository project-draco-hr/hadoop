{
  if (fsd.isPermissionEnabled()) {
    String actualdst=fsd.isDir(dst) ? dst + Path.SEPARATOR + new Path(src).getName() : dst;
    INodesInPath srcIIP=fsd.getINodesInPath(src,false);
    fsd.checkPermission(pc,srcIIP,false,null,FsAction.WRITE,null,null,false);
    INodesInPath dstIIP=fsd.getINodesInPath(actualdst,false);
    fsd.checkPermission(pc,dstIIP,false,FsAction.WRITE,null,null,null,false);
  }
  long mtime=now();
  @SuppressWarnings("deprecation") final boolean stat=renameTo(fsd,src,dst,mtime);
  if (stat) {
    fsd.getEditLog().logRename(src,dst,mtime,logRetryCache);
    return true;
  }
  return false;
}
