{
  Preconditions.checkState(oldDstChild != null);
  List<INode> removedINodes=new ChunkedArrayList<>();
  final boolean filesDeleted;
  if (!oldDstChild.isInLatestSnapshot(dstIIP.getLatestSnapshotId())) {
    oldDstChild.destroyAndCollectBlocks(collectedBlocks,removedINodes);
    filesDeleted=true;
  }
 else {
    filesDeleted=oldDstChild.cleanSubtree(Snapshot.CURRENT_STATE_ID,dstIIP.getLatestSnapshotId(),collectedBlocks,removedINodes,true).get(Quota.NAMESPACE) >= 0;
  }
  fsd.getFSNamesystem().removePathAndBlocks(src,null,removedINodes,false);
  return filesDeleted;
}
