{
  KeyVersion keyVer=keyProvider.getKeyVersion(keyVersion.getVersionName());
  Preconditions.checkNotNull(keyVer,"KeyVersion name '%s' does not exist",keyVersion.getVersionName());
  byte[] newKey=new byte[keyVer.getMaterial().length];
  SecureRandom.getInstance("SHA1PRNG").nextBytes(newKey);
  Cipher cipher=Cipher.getInstance("AES/CTR/NoPadding");
  byte[] iv=SecureRandom.getSeed(cipher.getBlockSize());
  cipher.init(Cipher.ENCRYPT_MODE,new SecretKeySpec(keyVer.getMaterial(),"AES"),new IvParameterSpec(flipIV(iv)));
  byte[] ek=cipher.doFinal(newKey);
  return new EncryptedKeyVersion(keyVersion.getName(),keyVersion.getVersionName(),iv,new KeyVersion(keyVer.getName(),EEK,ek));
}
