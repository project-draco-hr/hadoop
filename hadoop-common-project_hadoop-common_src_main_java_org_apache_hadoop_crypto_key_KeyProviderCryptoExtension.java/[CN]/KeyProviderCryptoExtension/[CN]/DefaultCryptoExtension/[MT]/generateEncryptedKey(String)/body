{
  KeyVersion encryptionKey=keyProvider.getCurrentKey(encryptionKeyName);
  Preconditions.checkNotNull(encryptionKey,"No KeyVersion exists for key '%s' ",encryptionKeyName);
  Cipher cipher=Cipher.getInstance("AES/CTR/NoPadding");
  SecureRandom random=SecureRandom.getInstance("SHA1PRNG");
  final byte[] newKey=new byte[encryptionKey.getMaterial().length];
  random.nextBytes(newKey);
  final byte[] iv=random.generateSeed(cipher.getBlockSize());
  final byte[] encryptionIV=EncryptedKeyVersion.deriveIV(iv);
  cipher.init(Cipher.ENCRYPT_MODE,new SecretKeySpec(encryptionKey.getMaterial(),"AES"),new IvParameterSpec(encryptionIV));
  final byte[] encryptedKey=cipher.doFinal(newKey);
  return new EncryptedKeyVersion(encryptionKeyName,encryptionKey.getVersionName(),iv,new KeyVersion(encryptionKey.getName(),EEK,encryptedKey));
}
