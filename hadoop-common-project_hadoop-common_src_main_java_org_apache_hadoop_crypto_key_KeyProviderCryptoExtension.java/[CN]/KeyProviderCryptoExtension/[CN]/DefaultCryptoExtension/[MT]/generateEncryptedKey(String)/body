{
  KeyVersion encryptionKey=keyProvider.getCurrentKey(encryptionKeyName);
  Preconditions.checkNotNull(encryptionKey,"No KeyVersion exists for key '%s' ",encryptionKeyName);
  Cipher cipher=Cipher.getInstance("AES/CTR/NoPadding");
  final byte[] newKey=new byte[encryptionKey.getMaterial().length];
  RANDOM.get().nextBytes(newKey);
  final byte[] iv=new byte[cipher.getBlockSize()];
  RANDOM.get().nextBytes(iv);
  final byte[] encryptionIV=EncryptedKeyVersion.deriveIV(iv);
  cipher.init(Cipher.ENCRYPT_MODE,new SecretKeySpec(encryptionKey.getMaterial(),"AES"),new IvParameterSpec(encryptionIV));
  final byte[] encryptedKey=cipher.doFinal(newKey);
  return new EncryptedKeyVersion(encryptionKeyName,encryptionKey.getVersionName(),iv,new KeyVersion(encryptionKey.getName(),EEK,encryptedKey));
}
