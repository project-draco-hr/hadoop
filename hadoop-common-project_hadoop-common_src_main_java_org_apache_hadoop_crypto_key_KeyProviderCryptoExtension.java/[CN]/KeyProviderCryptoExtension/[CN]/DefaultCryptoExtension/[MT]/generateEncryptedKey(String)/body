{
  KeyVersion keyVer=keyProvider.getCurrentKey(encryptionKeyName);
  Preconditions.checkNotNull(keyVer,"No KeyVersion exists for key '%s' ",encryptionKeyName);
  byte[] newKey=new byte[keyVer.getMaterial().length];
  SecureRandom.getInstance("SHA1PRNG").nextBytes(newKey);
  Cipher cipher=Cipher.getInstance("AES/CTR/NoPadding");
  byte[] iv=SecureRandom.getSeed(cipher.getBlockSize());
  cipher.init(Cipher.ENCRYPT_MODE,new SecretKeySpec(keyVer.getMaterial(),"AES"),new IvParameterSpec(flipIV(iv)));
  byte[] ek=cipher.doFinal(newKey);
  return new EncryptedKeyVersion(encryptionKeyName,keyVer.getVersionName(),iv,new KeyVersion(keyVer.getName(),EEK,ek));
}
