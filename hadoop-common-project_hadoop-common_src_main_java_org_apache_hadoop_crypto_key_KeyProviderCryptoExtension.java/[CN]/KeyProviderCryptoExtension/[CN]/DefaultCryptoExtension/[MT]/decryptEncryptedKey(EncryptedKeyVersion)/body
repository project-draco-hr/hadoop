{
  KeyVersion keyVer=keyProvider.getKeyVersion(encryptedKeyVersion.getKeyVersionName());
  Preconditions.checkNotNull(keyVer,"KeyVersion name '%s' does not exist",encryptedKeyVersion.getKeyVersionName());
  KeyVersion keyVersion=encryptedKeyVersion.getEncryptedKey();
  Cipher cipher=Cipher.getInstance("AES/CTR/NoPadding");
  cipher.init(Cipher.DECRYPT_MODE,new SecretKeySpec(keyVersion.getMaterial(),"AES"),new IvParameterSpec(flipIV(encryptedKeyVersion.getIv())));
  byte[] ek=cipher.doFinal(encryptedKeyVersion.getEncryptedKey().getMaterial());
  return new KeyVersion(keyVer.getName(),EK,ek);
}
