{
  mockDnConf=mock(DNConf.class);
  doReturn(VersionInfo.getVersion()).when(mockDnConf).getMinimumNameNodeVersion();
  DataNode mockDN=mock(DataNode.class);
  doReturn(true).when(mockDN).shouldRun();
  doReturn(mockDnConf).when(mockDN).getDnConf();
  BPOfferService mockBPOS=mock(BPOfferService.class);
  doReturn(mockDN).when(mockBPOS).getDataNode();
  actor=new BPServiceActor(INVALID_ADDR,mockBPOS);
  fakeNsInfo=mock(NamespaceInfo.class);
  doReturn(VersionInfo.getVersion()).when(fakeNsInfo).getSoftwareVersion();
  doReturn(HdfsConstants.DATANODE_LAYOUT_VERSION).when(fakeNsInfo).getLayoutVersion();
  DatanodeProtocolClientSideTranslatorPB fakeDnProt=mock(DatanodeProtocolClientSideTranslatorPB.class);
  when(fakeDnProt.versionRequest()).thenReturn(fakeNsInfo);
  actor.setNameNode(fakeDnProt);
}
