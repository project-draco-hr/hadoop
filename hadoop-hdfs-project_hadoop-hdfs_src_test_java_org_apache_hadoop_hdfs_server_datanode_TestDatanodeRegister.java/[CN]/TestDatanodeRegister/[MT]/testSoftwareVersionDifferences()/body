{
  assertEquals(VersionInfo.getVersion(),actor.retrieveNamespaceInfo().getSoftwareVersion());
  doReturn("4.0.0").when(fakeNsInfo).getSoftwareVersion();
  doReturn("3.0.0").when(mockDnConf).getMinimumNameNodeVersion();
  assertEquals("4.0.0",actor.retrieveNamespaceInfo().getSoftwareVersion());
  doReturn("3.0.0").when(fakeNsInfo).getSoftwareVersion();
  doReturn("4.0.0").when(mockDnConf).getMinimumNameNodeVersion();
  try {
    actor.retrieveNamespaceInfo();
    fail("Should have thrown an exception for NN with too-low version");
  }
 catch (  IncorrectVersionException ive) {
    GenericTestUtils.assertExceptionContains("The reported NameNode version is too low",ive);
    LOG.info("Got expected exception",ive);
  }
}
