{
  DataNode mockDN=mock(DataNode.class);
  Mockito.doReturn(true).when(mockDN).shouldRun();
  BPOfferService mockBPOS=Mockito.mock(BPOfferService.class);
  Mockito.doReturn(mockDN).when(mockBPOS).getDataNode();
  BPServiceActor actor=new BPServiceActor(INVALID_ADDR,mockBPOS);
  NamespaceInfo fakeNSInfo=mock(NamespaceInfo.class);
  when(fakeNSInfo.getBuildVersion()).thenReturn("NSBuildVersion");
  DatanodeProtocol fakeDNProt=mock(DatanodeProtocol.class);
  when(fakeDNProt.versionRequest()).thenReturn(fakeNSInfo);
  actor.setNameNode(fakeDNProt);
  try {
    actor.retrieveNamespaceInfo();
    fail("register() did not throw exception! " + "Expected: IncorrectVersionException");
  }
 catch (  IncorrectVersionException ie) {
    LOG.info("register() returned correct Exception: IncorrectVersionException");
  }
}
