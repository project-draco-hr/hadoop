{
  DataNode mockDN=mock(DataNode.class);
  Mockito.doReturn(true).when(mockDN).shouldRun();
  BPOfferService bpos=new BPOfferService(INVALID_ADDR,mockDN);
  NamespaceInfo fakeNSInfo=mock(NamespaceInfo.class);
  when(fakeNSInfo.getBuildVersion()).thenReturn("NSBuildVersion");
  DatanodeProtocol fakeDNProt=mock(DatanodeProtocol.class);
  when(fakeDNProt.versionRequest()).thenReturn(fakeNSInfo);
  bpos.setNameNode(fakeDNProt);
  bpos.bpNSInfo=fakeNSInfo;
  try {
    bpos.retrieveNamespaceInfo();
    fail("register() did not throw exception! " + "Expected: IncorrectVersionException");
  }
 catch (  IncorrectVersionException ie) {
    LOG.info("register() returned correct Exception: IncorrectVersionException");
  }
}
