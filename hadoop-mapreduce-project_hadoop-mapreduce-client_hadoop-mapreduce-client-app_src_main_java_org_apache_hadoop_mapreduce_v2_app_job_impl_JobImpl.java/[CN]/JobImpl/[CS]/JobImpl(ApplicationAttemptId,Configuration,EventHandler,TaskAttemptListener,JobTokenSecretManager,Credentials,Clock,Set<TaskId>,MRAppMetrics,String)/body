{
  this.applicationAttemptId=applicationAttemptId;
  this.jobId=recordFactory.newRecordInstance(JobId.class);
  this.jobName=conf.get(JobContext.JOB_NAME,"<missing job name>");
  this.conf=conf;
  this.metrics=metrics;
  this.clock=clock;
  this.completedTasksFromPreviousRun=completedTasksFromPreviousRun;
  this.userName=userName;
  ApplicationId applicationId=applicationAttemptId.getApplicationId();
  jobId.setAppId(applicationId);
  jobId.setId(applicationId.getId());
  oldJobId=TypeConverter.fromYarn(jobId);
  LOG.info("Job created" + " appId=" + applicationId + " jobId="+ jobId+ " oldJobId="+ oldJobId);
  this.taskAttemptListener=taskAttemptListener;
  this.eventHandler=eventHandler;
  ReadWriteLock readWriteLock=new ReentrantReadWriteLock();
  this.readLock=readWriteLock.readLock();
  this.writeLock=readWriteLock.writeLock();
  this.fsTokens=fsTokenCredentials;
  this.jobTokenSecretManager=jobTokenSecretManager;
  this.aclsManager=new JobACLsManager(conf);
  this.username=System.getProperty("user.name");
  this.jobACLs=aclsManager.constructJobACLs(conf);
  stateMachine=stateMachineFactory.make(this);
}
