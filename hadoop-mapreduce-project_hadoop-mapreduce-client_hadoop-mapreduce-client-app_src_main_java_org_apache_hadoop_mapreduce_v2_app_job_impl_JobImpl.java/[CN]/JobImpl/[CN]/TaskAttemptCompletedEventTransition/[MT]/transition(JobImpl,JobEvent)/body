{
  TaskAttemptCompletionEvent tce=((JobTaskAttemptCompletedEvent)event).getCompletionEvent();
  tce.setEventId(job.taskAttemptCompletionEvents.size());
  job.taskAttemptCompletionEvents.add(tce);
  Object successEventNo=job.successAttemptCompletionEventNoMap.remove(tce.getAttemptId().getTaskId());
  if (successEventNo != null) {
    TaskAttemptCompletionEvent successEvent=job.taskAttemptCompletionEvents.get((Integer)successEventNo);
    successEvent.setStatus(TaskAttemptCompletionEventStatus.OBSOLETE);
  }
  if (TaskAttemptCompletionEventStatus.SUCCEEDED.equals(tce.getStatus())) {
    job.successAttemptCompletionEventNoMap.put(tce.getAttemptId().getTaskId(),tce.getEventId());
  }
}
