{
  this.readLock.lock();
  try {
    float mapProgress=0f;
    float reduceProgress=0f;
    for (    Task task : this.tasks.values()) {
      if (task.getType() == TaskType.MAP) {
        mapProgress+=task.getProgress();
      }
 else {
        reduceProgress+=task.getProgress();
      }
    }
    if (this.numMapTasks != 0) {
      mapProgress=mapProgress / this.numMapTasks;
    }
    if (this.numReduceTasks != 0) {
      reduceProgress=reduceProgress / this.numReduceTasks;
    }
    this.mapProgress=mapProgress;
    this.reduceProgress=reduceProgress;
  }
  finally {
    this.readLock.unlock();
  }
}
