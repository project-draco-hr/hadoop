{
  if (job.completedTaskCount == job.tasks.size()) {
    try {
      job.getCommitter().commitJob(job.getJobContext());
    }
 catch (    IOException e) {
      LOG.error("Could not do commit for Job",e);
      job.logJobHistoryFinishedEvent();
      return job.finished(JobState.FAILED);
    }
    job.logJobHistoryFinishedEvent();
    return job.finished(JobState.SUCCEEDED);
  }
  return null;
}
