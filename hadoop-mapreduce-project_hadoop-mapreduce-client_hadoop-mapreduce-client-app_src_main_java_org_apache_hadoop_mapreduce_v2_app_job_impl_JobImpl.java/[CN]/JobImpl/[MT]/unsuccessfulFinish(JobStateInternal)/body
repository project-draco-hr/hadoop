{
  if (finishTime == 0)   setFinishTime();
  cleanupProgress=1.0f;
  JobUnsuccessfulCompletionEvent unsuccessfulJobEvent=new JobUnsuccessfulCompletionEvent(oldJobId,finishTime,succeededMapTaskCount,succeededReduceTaskCount,finalState.toString(),diagnostics);
  eventHandler.handle(new JobHistoryEvent(jobId,unsuccessfulJobEvent));
  finished(finalState);
}
