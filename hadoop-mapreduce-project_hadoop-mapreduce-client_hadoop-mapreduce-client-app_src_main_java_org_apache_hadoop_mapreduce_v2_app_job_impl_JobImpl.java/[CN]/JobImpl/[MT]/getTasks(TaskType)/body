{
  Map<TaskId,Task> localTasksCopy=tasks;
  Map<TaskId,Task> result=new HashMap<TaskId,Task>();
  Set<TaskId> tasksOfGivenType=null;
  readLock.lock();
  try {
    if (TaskType.MAP == taskType) {
      tasksOfGivenType=mapTasks;
    }
 else {
      tasksOfGivenType=reduceTasks;
    }
    for (    TaskId taskID : tasksOfGivenType)     result.put(taskID,localTasksCopy.get(taskID));
    return result;
  }
  finally {
    readLock.unlock();
  }
}
