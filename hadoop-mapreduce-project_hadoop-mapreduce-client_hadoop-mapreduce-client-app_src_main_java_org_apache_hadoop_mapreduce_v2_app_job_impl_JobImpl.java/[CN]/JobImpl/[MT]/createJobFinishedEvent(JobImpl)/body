{
  Counters mapCounters=new Counters();
  Counters reduceCounters=new Counters();
  for (  Task t : job.tasks.values()) {
    Counters counters=t.getCounters();
switch (t.getType()) {
case MAP:
      mapCounters.incrAllCounters(counters);
    break;
case REDUCE:
  reduceCounters.incrAllCounters(counters);
break;
}
}
JobFinishedEvent jfe=new JobFinishedEvent(job.oldJobId,job.finishTime,job.succeededMapTaskCount,job.succeededReduceTaskCount,job.failedMapTaskCount,job.failedReduceTaskCount,mapCounters,reduceCounters,job.getAllCounters());
return jfe;
}
