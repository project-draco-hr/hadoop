{
  readLock.lock();
  try {
    JobStateInternal state=getInternalState();
    if (state == JobStateInternal.ERROR || state == JobStateInternal.FAILED || state == JobStateInternal.KILLED || state == JobStateInternal.SUCCEEDED) {
      this.mayBeConstructFinalFullCounters();
      return fullCounters;
    }
    Counters counters=new Counters();
    counters.incrAllCounters(jobCounters);
    return incrTaskCounters(counters,tasks.values());
  }
  finally {
    readLock.unlock();
  }
}
