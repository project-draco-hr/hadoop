{
  MockMoverHelper mockMoverHelper=new MockMoverHelper().invoke();
  NodePlan plan=mockMoverHelper.getPlan();
  final DiskBalancer balancer=mockMoverHelper.getBalancer();
  executeSubmitPlan(plan,balancer);
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      try {
        return balancer.queryWorkStatus().getResult() == DiskBalancerWorkStatus.Result.PLAN_DONE;
      }
 catch (      IOException ex) {
        return false;
      }
    }
  }
,1000,100000);
  assertTrue(mockMoverHelper.getBlockMover().getRunCount() == 1);
}
