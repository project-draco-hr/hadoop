{
  final int ATTEMPTS=10;
  int count=0;
  do {
    Thread.sleep(1000);
    count++;
  }
 while (dn.isDatanodeUp() && count < ATTEMPTS);
  if (count == ATTEMPTS) {
    throw new TimeoutException("Timed out waiting for DN to die");
  }
}
