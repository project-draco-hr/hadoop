{
  boolean good;
  do {
    good=true;
    BlockLocation locs[]=fs.getFileBlockLocations(fs.getFileStatus(fileName),0,Long.MAX_VALUE);
    for (int j=0; j < locs.length; j++) {
      String[] hostnames=locs[j].getNames();
      if (hostnames.length != replFactor) {
        String hostNameList="";
        for (        String h : hostnames)         hostNameList+=h + " ";
        System.out.println("Block " + j + " of file "+ fileName+ " has replication factor "+ hostnames.length+ "; locations "+ hostNameList);
        good=false;
        try {
          System.out.println("Waiting for replication factor to drain");
          Thread.sleep(100);
        }
 catch (        InterruptedException e) {
        }
        break;
      }
    }
    if (good) {
      System.out.println("All blocks of file " + fileName + " verified to have replication factor "+ replFactor);
    }
  }
 while (!good);
}
