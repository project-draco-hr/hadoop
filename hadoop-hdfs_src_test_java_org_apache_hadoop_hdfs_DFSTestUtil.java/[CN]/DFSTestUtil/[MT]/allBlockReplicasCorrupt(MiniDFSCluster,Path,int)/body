{
  DFSClient client=new DFSClient(new InetSocketAddress("localhost",cluster.getNameNodePort()),cluster.getConfiguration(0));
  LocatedBlocks blocks;
  try {
    blocks=client.getNamenode().getBlockLocations(file.toString(),0,Long.MAX_VALUE);
  }
  finally {
    client.close();
  }
  return blocks.get(blockNo).isCorrupt();
}
