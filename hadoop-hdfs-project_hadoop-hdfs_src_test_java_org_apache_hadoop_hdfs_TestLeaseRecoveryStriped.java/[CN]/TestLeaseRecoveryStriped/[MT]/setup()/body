{
  conf=new HdfsConfiguration();
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,BLOCK_SIZE);
  conf.setLong(HdfsClientConfigKeys.DFS_CLIENT_SOCKET_TIMEOUT_KEY,6000L);
  conf.setBoolean(DFSConfigKeys.DFS_NAMENODE_REPLICATION_CONSIDERLOAD_KEY,false);
  conf.setInt(DFSConfigKeys.DFS_HEARTBEAT_INTERVAL_KEY,1);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_REPLICATION_MAX_STREAMS_KEY,0);
  final int numDNs=NUM_DATA_BLOCKS + NUM_PARITY_BLOCKS;
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDNs).build();
  cluster.waitActive();
  dfs=cluster.getFileSystem();
  dfs.mkdirs(dir);
  dfs.setErasureCodingPolicy(dir,ecPolicy);
}
