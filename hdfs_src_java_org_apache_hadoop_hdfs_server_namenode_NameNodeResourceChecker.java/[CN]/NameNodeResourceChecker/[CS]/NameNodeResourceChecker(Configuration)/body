{
  this.conf=conf;
  volumes=new HashMap<String,DF>();
  duReserved=conf.getLong(DFSConfigKeys.DFS_NAMENODE_DU_RESERVED_KEY,DFSConfigKeys.DFS_NAMENODE_DU_RESERVED_DEFAULT);
  Collection<URI> extraCheckedVolumes=Util.stringCollectionAsURIs(conf.getTrimmedStringCollection(DFSConfigKeys.DFS_NAMENODE_CHECKED_VOLUMES_KEY));
  addDirsToCheck(FSNamesystem.getNamespaceDirs(conf));
  addDirsToCheck(FSNamesystem.getNamespaceEditsDirs(conf));
  addDirsToCheck(extraCheckedVolumes);
}
