{
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser(user);
  AccessControlList acl=null;
  lock.readLock().lock();
  try {
    acl=acls.get(type);
  }
  finally {
    lock.readLock().unlock();
  }
  return acl.isUserAllowed(ugi);
}
