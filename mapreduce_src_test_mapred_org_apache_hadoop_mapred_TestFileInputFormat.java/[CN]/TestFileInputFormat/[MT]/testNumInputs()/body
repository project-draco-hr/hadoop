{
  JobConf job=new JobConf(conf);
  dfs=newDFSCluster(job);
  FileSystem fs=dfs.getFileSystem();
  System.out.println("FileSystem " + fs.getUri());
  Path inputDir=new Path("/foo/");
  final int numFiles=10;
  String fileNameBase="part-0000";
  for (int i=0; i < numFiles; ++i) {
    createInputs(fs,inputDir,fileNameBase + String.valueOf(i));
  }
  createInputs(fs,inputDir,"_meta");
  createInputs(fs,inputDir,"_temp");
  TextInputFormat.addInputPath(job,inputDir);
  TextInputFormat inFormat=new TextInputFormat();
  inFormat.configure(job);
  InputSplit[] splits=inFormat.getSplits(job,1);
  assertEquals("Expected value of " + FileInputFormat.NUM_INPUT_FILES,numFiles,job.getLong(FileInputFormat.NUM_INPUT_FILES,0));
}
