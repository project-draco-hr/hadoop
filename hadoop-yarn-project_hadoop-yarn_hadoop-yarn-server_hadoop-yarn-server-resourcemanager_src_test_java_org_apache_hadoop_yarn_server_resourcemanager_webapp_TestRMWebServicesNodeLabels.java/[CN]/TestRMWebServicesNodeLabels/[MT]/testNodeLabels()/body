{
  WebResource r=resource();
  ClientResponse response;
  JSONObject json;
  JSONArray jarr;
  String responseString;
  response=r.path("ws").path("v1").path("cluster").path("add-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\":\"a\"}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  response=r.path("ws").path("v1").path("cluster").path("get-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  assertEquals("a",json.getString("nodeLabels"));
  response=r.path("ws").path("v1").path("cluster").path("add-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\":\"b\"}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  response=r.path("ws").path("v1").path("cluster").path("get-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  jarr=json.getJSONArray("nodeLabels");
  assertEquals(2,jarr.length());
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("replace-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\": [\"a\"]}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  LOG.info("posted node nodelabel");
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("get-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  assertEquals("a",json.getString("nodeLabels"));
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("replace-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\":\"b\"}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  LOG.info("posted node nodelabel");
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("get-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  assertEquals("b",json.getString("nodeLabels"));
  NodeToLabelsInfo ntli=new NodeToLabelsInfo();
  NodeLabelsInfo nli=new NodeLabelsInfo();
  nli.getNodeLabels().add("a");
  ntli.getNodeToLabels().put("nid:0",nli);
  response=r.path("ws").path("v1").path("cluster").path("replace-node-to-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity(toJson(ntli,NodeToLabelsInfo.class),MediaType.APPLICATION_JSON).post(ClientResponse.class);
  response=r.path("ws").path("v1").path("cluster").path("get-node-to-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  ntli=response.getEntity(NodeToLabelsInfo.class);
  nli=ntli.getNodeToLabels().get("nid:0");
  assertEquals(1,nli.getNodeLabels().size());
  assertTrue(nli.getNodeLabels().contains("a"));
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("replace-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\"}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  LOG.info("posted node nodelabel");
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("get-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  assertEquals("",json.getString("nodeLabels"));
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("replace-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\": \"a\"}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  LOG.info("posted node nodelabel");
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("get-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  assertEquals("a",json.getString("nodeLabels"));
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("replace-labels").queryParam("user.name",notUserName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\": [\"b\"]}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  response=r.path("ws").path("v1").path("cluster").path("nodes").path("nid:0").path("get-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  assertEquals("a",json.getString("nodeLabels"));
  response=r.path("ws").path("v1").path("cluster").path("add-node-labels").queryParam("user.name",notUserName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\":\"c\"}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  response=r.path("ws").path("v1").path("cluster").path("get-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  jarr=json.getJSONArray("nodeLabels");
  assertEquals(2,jarr.length());
  response=r.path("ws").path("v1").path("cluster").path("remove-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\":\"b\"}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  response=r.path("ws").path("v1").path("cluster").path("get-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  json=response.getEntity(JSONObject.class);
  assertEquals("a",json.getString("nodeLabels"));
  response=r.path("ws").path("v1").path("cluster").path("remove-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).entity("{\"nodeLabels\":\"a\"}",MediaType.APPLICATION_JSON).post(ClientResponse.class);
  response=r.path("ws").path("v1").path("cluster").path("get-node-labels").queryParam("user.name",userName).accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  assertEquals(MediaType.APPLICATION_JSON_TYPE,response.getType());
  String res=response.getEntity(String.class);
  assertTrue(res.equals("null"));
}
