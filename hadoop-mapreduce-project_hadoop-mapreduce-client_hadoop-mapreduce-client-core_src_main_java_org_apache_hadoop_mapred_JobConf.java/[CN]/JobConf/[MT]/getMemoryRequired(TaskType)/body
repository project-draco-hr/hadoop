{
  int memory=1024;
  int heapSize=parseMaximumHeapSizeMB(getConfiguredTaskJavaOpts(taskType));
  float heapRatio=getFloat(MRJobConfig.HEAP_MEMORY_MB_RATIO,MRJobConfig.DEFAULT_HEAP_MEMORY_MB_RATIO);
  if (taskType == TaskType.MAP) {
    return getMemoryRequiredHelper(MRJobConfig.MAP_MEMORY_MB,MRJobConfig.DEFAULT_MAP_MEMORY_MB,heapSize,heapRatio);
  }
 else   if (taskType == TaskType.REDUCE) {
    return getMemoryRequiredHelper(MRJobConfig.REDUCE_MEMORY_MB,MRJobConfig.DEFAULT_REDUCE_MEMORY_MB,heapSize,heapRatio);
  }
 else {
    return memory;
  }
}
