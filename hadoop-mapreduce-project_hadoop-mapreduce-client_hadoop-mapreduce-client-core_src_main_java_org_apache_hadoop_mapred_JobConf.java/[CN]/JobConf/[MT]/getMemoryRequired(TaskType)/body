{
  int memory=1024;
  int heapSize=parseMaximumHeapSizeMB(getConfiguredTaskJavaOpts(taskType));
  float heapRatio=getFloat(MRJobConfig.HEAP_MEMORY_MB_RATIO,MRJobConfig.DEFAULT_HEAP_MEMORY_MB_RATIO);
  if (taskType == TaskType.MAP) {
    if (get(MRJobConfig.MAP_MEMORY_MB) == null && heapSize > 0) {
      memory=(int)Math.ceil(heapSize / heapRatio);
      LOG.info(MRJobConfig.MAP_MEMORY_MB + " not specified. Derived from javaOpts = " + memory);
    }
 else {
      memory=getInt(MRJobConfig.MAP_MEMORY_MB,MRJobConfig.DEFAULT_MAP_MEMORY_MB);
    }
  }
 else   if (taskType == TaskType.REDUCE) {
    if (get(MRJobConfig.REDUCE_MEMORY_MB) == null && heapSize > 0) {
      memory=(int)Math.ceil(heapSize / heapRatio);
      LOG.info(MRJobConfig.REDUCE_MEMORY_MB + " not specified. Derived from javaOpts = " + memory);
    }
 else {
      memory=getInt(MRJobConfig.REDUCE_MEMORY_MB,MRJobConfig.DEFAULT_REDUCE_MEMORY_MB);
    }
  }
  return memory;
}
