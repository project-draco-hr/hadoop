{
  if (!table.toString().equals(writerTable))   throw new IOException("Writing to different table " + table.toString() + ". Expecting "+ writerTable);
  String strRecord=record.toSQLString(delimiter,terminator);
  ByteArrayInputStream bais=new ByteArrayInputStream(strRecord.getBytes());
  try {
    if (statement == null) {
      statement=connection.createStatement();
      startCopyIn.invoke(statement,copyStmt,bais);
    }
 else     addStreamToCopyIn.invoke(statement,bais);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
