{
  String mapredConf=null;
  String localDirPath=null;
  File localFolderObj=null;
  File xmlFileObj=null;
  String confXMLFile=null;
  Configuration initConf=new Configuration(getConf());
  Enumeration<String> e=props.keys();
  while (e.hasMoreElements()) {
    String propKey=e.nextElement();
    Object propValue=props.get(propKey);
    initConf.set(propKey,propValue.toString());
  }
  localDirPath=getHadoopLocalConfDir();
  localFolderObj=new File(localDirPath);
  if (!localFolderObj.exists()) {
    localFolderObj.mkdir();
  }
  confXMLFile=localDirPath + File.separator + configFile;
  xmlFileObj=new File(confXMLFile);
  initConf.writeXml(new FileOutputStream(xmlFileObj));
  newConfDir=clusterManager.pushConfig(localDirPath);
  stop();
  waitForClusterToStop();
  clusterManager.start(newConfDir);
  waitForClusterToStart();
  localFolderObj.delete();
}
