{
  startUpCluster(true,-1);
  final String METHOD_NAME=GenericTestUtils.getMethodName();
  FsDatasetTestUtil.stopLazyWriter(cluster.getDataNodes().get(0));
  Path path=new Path("/" + METHOD_NAME + ".dat");
  makeTestFile(path,BLOCK_SIZE,true);
  LocatedBlocks locatedBlocks=ensureFileReplicasOnStorageType(path,RAM_DISK);
  client.delete(path.toString(),false);
  Assert.assertFalse(fs.exists(path));
  assertThat(verifyDeletedBlocks(locatedBlocks),is(true));
  verifyRamDiskJMXMetric("RamDiskBlocksDeletedBeforeLazyPersisted",1);
}
