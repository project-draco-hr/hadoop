{
  final int numBlocks=4;
  DFSTestUtil.createECFile(cluster,filePath,dirPath,numBlocks,NUM_STRIPE_PER_BLOCK);
  LocatedBlocks lbs=fs.getClient().namenode.getBlockLocations(filePath.toString(),0,BLOCKSIZE * numBlocks);
  assertEquals(4,lbs.locatedBlockCount());
  List<LocatedBlock> lbList=lbs.getLocatedBlocks();
  for (  LocatedBlock lb : lbList) {
    assertTrue(lb.isStriped());
  }
  for (int i=0; i < numBlocks; i++) {
    LocatedStripedBlock lsb=(LocatedStripedBlock)(lbs.get(i));
    LocatedBlock[] blks=DFSStripedInputStream.parseStripedBlockGroup(lsb,GROUP_SIZE,CELLSIZE);
    assertEquals(GROUP_SIZE,blks.length);
    for (int j=0; j < GROUP_SIZE; j++) {
      assertFalse(blks[j].isStriped());
      assertEquals(j,BlockIdManager.getBlockIndex(blks[j].getBlock().getLocalBlock()));
      assertEquals(i * BLOCKSIZE + j * CELLSIZE,blks[j].getStartOffset());
    }
  }
}
