{
  List<VolumeBlockLocationCallable> callables=new ArrayList<VolumeBlockLocationCallable>();
  for (  Map.Entry<DatanodeInfo,List<LocatedBlock>> entry : datanodeBlocks.entrySet()) {
    DatanodeInfo datanode=entry.getKey();
    List<LocatedBlock> locatedBlocks=entry.getValue();
    List<ExtendedBlock> extendedBlocks=new ArrayList<ExtendedBlock>(locatedBlocks.size());
    List<Token<BlockTokenIdentifier>> dnTokens=new ArrayList<Token<BlockTokenIdentifier>>(locatedBlocks.size());
    for (    LocatedBlock b : locatedBlocks) {
      extendedBlocks.add(b.getBlock());
      dnTokens.add(b.getBlockToken());
    }
    VolumeBlockLocationCallable callable=new VolumeBlockLocationCallable(conf,datanode,extendedBlocks,dnTokens,timeout,connectToDnViaHostname);
    callables.add(callable);
  }
  return callables;
}
