{
  HdfsBlocksMetadata metadata=null;
  ClientDatanodeProtocol cdp=null;
  try {
    cdp=DFSUtil.createClientDatanodeProtocolProxy(datanode,configuration,timeout,connectToDnViaHostname);
    metadata=cdp.getHdfsBlocksMetadata(poolId,blockIds,dnTokens);
  }
 catch (  IOException e) {
    throw e;
  }
 finally {
    if (cdp != null) {
      RPC.stopProxy(cdp);
    }
  }
  return metadata;
}
