{
  if (!doneWithRecovery)   return new ZKApplicationStore(application);
  ApplicationSubmissionContextPBImpl contextPBImpl=(ApplicationSubmissionContextPBImpl)context;
  String appString=APPS + ConverterUtils.toString(application);
  ApplicationMasterPBImpl masterPBImpl=new ApplicationMasterPBImpl();
  ContainerPBImpl container=new ContainerPBImpl();
  try {
    zkClient.create(appString,contextPBImpl.getProto().toByteArray(),null,CreateMode.PERSISTENT);
    zkClient.create(appString + ZK_PATH_SEPARATOR + APP_MASTER,masterPBImpl.getProto().toByteArray(),null,CreateMode.PERSISTENT);
    zkClient.create(appString + ZK_PATH_SEPARATOR + APP_MASTER_CONTAINER,container.getProto().toByteArray(),null,CreateMode.PERSISTENT);
  }
 catch (  InterruptedException ie) {
    LOG.info("Interrupted",ie);
    throw new InterruptedIOException(ie.getMessage());
  }
catch (  KeeperException ke) {
    LOG.info("Keeper exception",ke);
    throw convertToIOException(ke);
  }
  return new ZKApplicationStore(application);
}
