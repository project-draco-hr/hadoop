{
  allocate(container);
  nodeLocalRequest.setNumContainers(nodeLocalRequest.getNumContainers() - 1);
  if (nodeLocalRequest.getNumContainers() == 0) {
    this.requests.get(priority).remove(node.getHostName());
  }
  ResourceRequest rackLocalRequest=requests.get(priority).get(node.getRackName());
  rackLocalRequest.setNumContainers(rackLocalRequest.getNumContainers() - 1);
  if (rackLocalRequest.getNumContainers() == 0) {
    this.requests.get(priority).remove(node.getRackName());
  }
  ResourceRequest offSwitchRequest=requests.get(priority).get(RMNode.ANY);
  offSwitchRequest.setNumContainers(offSwitchRequest.getNumContainers() - 1);
}
