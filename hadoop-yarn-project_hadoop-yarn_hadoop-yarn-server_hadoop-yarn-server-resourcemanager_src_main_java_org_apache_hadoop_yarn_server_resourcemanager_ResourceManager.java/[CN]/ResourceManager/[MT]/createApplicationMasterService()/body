{
  if (this.rmContext.getYarnConfiguration().getBoolean(YarnConfiguration.DIST_SCHEDULING_ENABLED,YarnConfiguration.DIST_SCHEDULING_ENABLED_DEFAULT)) {
    DistributedSchedulingService distributedSchedulingService=new DistributedSchedulingService(this.rmContext,scheduler);
    EventDispatcher distSchedulerEventDispatcher=new EventDispatcher(distributedSchedulingService,DistributedSchedulingService.class.getName());
    addService(distSchedulerEventDispatcher);
    rmDispatcher.register(SchedulerEventType.class,distSchedulerEventDispatcher);
    return distributedSchedulingService;
  }
  return new ApplicationMasterService(this.rmContext,scheduler);
}
