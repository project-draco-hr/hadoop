{
  if (this.rmContext.getYarnConfiguration().getBoolean(YarnConfiguration.DIST_SCHEDULING_ENABLED,YarnConfiguration.DIST_SCHEDULING_ENABLED_DEFAULT)) {
    return new DistributedSchedulingService(this.rmContext,scheduler);
  }
  return new ApplicationMasterService(this.rmContext,scheduler);
}
