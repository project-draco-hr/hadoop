{
  SystemMetricsPublisher publisher;
  if (YarnConfiguration.timelineServiceEnabled(conf) && YarnConfiguration.systemMetricsPublisherEnabled(conf)) {
    if (YarnConfiguration.timelineServiceV2Enabled(conf)) {
      LOG.info("system metrics publisher with the timeline service V2 is " + "configured");
      publisher=new TimelineServiceV2Publisher(rmContext);
    }
 else {
      LOG.info("system metrics publisher with the timeline service V1 is " + "configured");
      publisher=new TimelineServiceV1Publisher();
    }
  }
 else {
    LOG.info("TimelineServicePublisher is not configured");
    publisher=new NoOpSystemMetricPublisher();
  }
  return publisher;
}
