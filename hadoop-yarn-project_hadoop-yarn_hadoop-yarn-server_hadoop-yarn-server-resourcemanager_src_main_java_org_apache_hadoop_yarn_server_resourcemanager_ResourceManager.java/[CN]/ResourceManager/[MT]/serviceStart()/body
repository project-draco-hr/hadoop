{
  try {
    doSecureLogin();
  }
 catch (  IOException ie) {
    throw new YarnRuntimeException("Failed to login",ie);
  }
  this.appTokenSecretManager.start();
  this.containerTokenSecretManager.start();
  this.nmTokenSecretManager.start();
  if (recoveryEnabled) {
    try {
      RMStateStore rmStore=rmContext.getStateStore();
      RMState state=rmStore.loadState();
      recover(state);
    }
 catch (    Exception e) {
      LOG.error("Failed to load/recover state",e);
      ExitUtil.terminate(1,e);
    }
  }
  startWepApp();
  try {
    rmDTSecretManager.startThreads();
  }
 catch (  IOException ie) {
    throw new YarnRuntimeException("Failed to start secret manager threads",ie);
  }
  if (getConfig().getBoolean(YarnConfiguration.IS_MINI_YARN_CLUSTER,false)) {
    String hostname=getConfig().get(YarnConfiguration.RM_WEBAPP_ADDRESS,YarnConfiguration.DEFAULT_RM_WEBAPP_ADDRESS);
    hostname=(hostname.contains(":")) ? hostname.substring(0,hostname.indexOf(":")) : hostname;
    int port=webApp.port();
    String resolvedAddress=hostname + ":" + port;
    conf.set(YarnConfiguration.RM_WEBAPP_ADDRESS,resolvedAddress);
  }
  super.serviceStart();
}
