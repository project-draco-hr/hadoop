{
  FileContext fc;
  if (readLocally) {
    fc=FileContext.getLocalFSFileContext();
  }
 else {
    fc=FileContext.getFileContext();
  }
  DataInputStream in=null;
  try {
    in=fc.open(new Path(filename));
  }
 catch (  IOException e) {
    System.err.println("Unable to open scriptFile: " + filename);
    System.exit(-1);
  }
  InputStreamReader inr=new InputStreamReader(in);
  BufferedReader br=new BufferedReader(inr);
  ArrayList<Long> duration=new ArrayList<Long>();
  ArrayList<Double> readProb=new ArrayList<Double>();
  ArrayList<Double> writeProb=new ArrayList<Double>();
  int lineNum=0;
  String line;
  try {
    while ((line=br.readLine()) != null) {
      lineNum++;
      if (line.startsWith("#") || line.isEmpty())       continue;
      parseScriptLine(line,duration,readProb,writeProb);
    }
  }
 catch (  IllegalArgumentException e) {
    System.err.println("Line: " + lineNum + ", "+ e.getMessage());
    return -1;
  }
 finally {
    IOUtils.cleanup(LOG,br);
  }
  durations=new long[duration.size()];
  readProbs=new double[readProb.size()];
  writeProbs=new double[writeProb.size()];
  for (int i=0; i < durations.length; i++) {
    durations[i]=duration.get(i);
    readProbs[i]=readProb.get(i);
    writeProbs[i]=writeProb.get(i);
  }
  if (durations[0] == 0)   System.err.println("Initial duration set to 0.  " + "Will loop until stopped manually.");
  return 0;
}
