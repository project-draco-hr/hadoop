{
  long startTime=Time.now();
  FSDataOutputStream out=null;
  try {
    out=fc.create(file,EnumSet.of(CreateFlag.CREATE,CreateFlag.OVERWRITE),CreateOpts.createParent(),CreateOpts.bufferSize(4096),CreateOpts.repFac((short)3));
    executionTime[CREATE]+=(Time.now() - startTime);
    numOfOps[CREATE]++;
    long i=fileSize;
    while (i > 0) {
      long s=Math.min(fileSize,WRITE_CONTENTS.length);
      out.write(WRITE_CONTENTS,0,(int)s);
      i-=s;
    }
    startTime=Time.now();
    executionTime[WRITE_CLOSE]+=(Time.now() - startTime);
    numOfOps[WRITE_CLOSE]++;
  }
  finally {
    IOUtils.cleanup(LOG,out);
  }
}
