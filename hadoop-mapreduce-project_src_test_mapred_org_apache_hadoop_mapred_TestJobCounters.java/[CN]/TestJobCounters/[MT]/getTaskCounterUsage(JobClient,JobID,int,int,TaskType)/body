{
  TaskReport[] reports=null;
  if (TaskType.MAP.equals(type)) {
    reports=client.getMapTaskReports(id);
  }
 else   if (TaskType.REDUCE.equals(type)) {
    reports=client.getReduceTaskReports(id);
  }
  assertNotNull("No reports found for task type '" + type.name() + "' in job "+ id,reports);
  assertEquals("Mismatch in task id",numReports,reports.length);
  Counters counters=reports[taskId].getCounters();
  return counters.getCounter(TaskCounter.COMMITTED_HEAP_BYTES);
}
