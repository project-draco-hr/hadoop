{
  for (  BalancerDatanode loc : block.getLocations()) {
    if (cluster.isOnSameRack(loc.getDatanode(),target.getDatanode())) {
      if (loc.addPendingBlock(this)) {
        proxySource=loc;
        return true;
      }
    }
  }
  for (  BalancerDatanode loc : block.getLocations()) {
    if (loc.addPendingBlock(this)) {
      proxySource=loc;
      return true;
    }
  }
  return false;
}
