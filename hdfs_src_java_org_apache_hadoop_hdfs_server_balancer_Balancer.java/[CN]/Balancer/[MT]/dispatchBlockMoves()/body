{
  long bytesLastMoved=bytesMoved.get();
  Future<?>[] futures=new Future<?>[sources.size()];
  int i=0;
  for (  Source source : sources) {
    futures[i++]=dispatcherExecutor.submit(source.new BlockMoveDispatcher());
  }
  for (  Future<?> future : futures) {
    try {
      future.get();
    }
 catch (    ExecutionException e) {
      LOG.warn("Dispatcher thread failed",e.getCause());
    }
  }
  waitForMoveCompletion();
  return bytesMoved.get() - bytesLastMoved;
}
