{
  this.conf=conf;
  partId=conf.getInt(MRJobConfig.TASK_PARTITION,-1);
  tmpOutputDir=FileOutputFormat.getWorkOutputPath(conf);
  blockSize=conf.getLong(HAR_BLOCKSIZE_LABEL,blockSize);
  partname="part-" + partId;
  tmpOutput=new Path(tmpOutputDir,partname);
  rootPath=(conf.get(SRC_PARENT_LABEL,null) == null) ? null : new Path(conf.get(SRC_PARENT_LABEL));
  if (rootPath == null) {
    throw new RuntimeException("Unable to read parent " + "path for har from config");
  }
  try {
    destFs=tmpOutput.getFileSystem(conf);
    if (destFs.exists(tmpOutput)) {
      destFs.delete(tmpOutput,false);
    }
    partStream=destFs.create(tmpOutput,false,conf.getInt("io.file.buffer.size",4096),destFs.getDefaultReplication(),blockSize);
  }
 catch (  IOException ie) {
    throw new RuntimeException("Unable to open output file " + tmpOutput,ie);
  }
  buffer=new byte[buf_size];
}
