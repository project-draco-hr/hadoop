{
  Configuration conf=new Configuration();
  conf.set(KEY_1,AccessControlList.WILDCARD_ACL_VALUE);
  conf.set(KEY_2,USER1 + " " + GROUPS1[0]);
  ConfiguredPolicy policy=new ConfiguredPolicy(conf,new TestPolicyProvider());
  SecurityUtil.setPolicy(policy);
  Subject user1=SecurityUtil.getSubject(new UnixUserGroupInformation(USER1,GROUPS1));
  ServiceAuthorizationManager.authorize(user1,Protocol1.class);
  Subject user2=SecurityUtil.getSubject(new UnixUserGroupInformation(USER2,GROUPS2));
  boolean failed=false;
  try {
    ServiceAuthorizationManager.authorize(user2,Protocol2.class);
  }
 catch (  AuthorizationException ae) {
    failed=true;
  }
  assertTrue(failed);
}
