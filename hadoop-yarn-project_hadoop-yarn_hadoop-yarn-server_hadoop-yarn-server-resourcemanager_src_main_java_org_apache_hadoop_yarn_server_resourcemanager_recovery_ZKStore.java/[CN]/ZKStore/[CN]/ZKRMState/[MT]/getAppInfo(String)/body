{
  ApplicationInfoImpl info=null;
  Stat stat=new Stat();
  try {
    ApplicationSubmissionContext context=null;
    byte[] data=zkClient.getData(APPS + app,false,stat);
    context=new ApplicationSubmissionContextPBImpl(ApplicationSubmissionContextProto.parseFrom(data));
    info=new ApplicationInfoImpl(context);
    List<String> children=zkClient.getChildren(APPS + app,false,stat);
    ApplicationMaster master=null;
    for (    String child : children) {
      byte[] childdata=zkClient.getData(APPS + app + ZK_PATH_SEPARATOR+ child,false,stat);
      if (APP_MASTER.equals(child)) {
        master=new ApplicationMasterPBImpl(ApplicationMasterProto.parseFrom(childdata));
        info.setApplicationMaster(master);
      }
 else       if (APP_MASTER_CONTAINER.equals(child)) {
        Container masterContainer=new ContainerPBImpl(ContainerProto.parseFrom(data));
        info.setMasterContainer(masterContainer);
      }
 else {
        Container container=new ContainerPBImpl(ContainerProto.parseFrom(data));
        info.addContainer(container);
      }
    }
  }
 catch (  InterruptedException ie) {
    LOG.info("Interrupted",ie);
    throw new InterruptedIOException(ie.getMessage());
  }
catch (  KeeperException ke) {
    throw convertToIOException(ke);
  }
  return info;
}
