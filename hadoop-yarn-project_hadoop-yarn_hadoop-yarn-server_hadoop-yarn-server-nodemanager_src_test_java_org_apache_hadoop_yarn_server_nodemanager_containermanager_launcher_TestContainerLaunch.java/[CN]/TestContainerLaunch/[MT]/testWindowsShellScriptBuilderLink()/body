{
  Assume.assumeTrue(Shell.WINDOWS);
  String linkCmd="@" + Shell.getWinUtilsPath() + " symlink \"\" \"\"";
  assertEquals(8191,Shell.WINDOWS_MAX_SHELL_LENGTH);
  ShellScriptBuilder builder=ShellScriptBuilder.create();
  builder.link(new Path(org.apache.commons.lang.StringUtils.repeat("A",1024)),new Path(org.apache.commons.lang.StringUtils.repeat("B",1024)));
  builder.link(new Path(org.apache.commons.lang.StringUtils.repeat("E",(Shell.WINDOWS_MAX_SHELL_LENGTH - linkCmd.length()) / 2)),new Path(org.apache.commons.lang.StringUtils.repeat("F",(Shell.WINDOWS_MAX_SHELL_LENGTH - linkCmd.length()) / 2)));
  try {
    builder.link(new Path(org.apache.commons.lang.StringUtils.repeat("X",(Shell.WINDOWS_MAX_SHELL_LENGTH - linkCmd.length()) / 2 + 1)),new Path(org.apache.commons.lang.StringUtils.repeat("Y",(Shell.WINDOWS_MAX_SHELL_LENGTH - linkCmd.length()) / 2) + 1));
    fail("long link was expected to throw");
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(expectedMessage));
  }
}
