{
  if (null != fromReplica && fromReplica.getState() == ReplicaState.RWR) {
    return new ReplicaWaitingToBeRecovered((ReplicaWaitingToBeRecovered)fromReplica);
  }
 else   if (null != fromReplica) {
    throw new IllegalArgumentException("Incompatible fromReplica " + "state: " + fromReplica.getState());
  }
 else {
    if (null != block) {
      return new ReplicaWaitingToBeRecovered(block,volume,directoryUsed);
    }
 else {
      return new ReplicaWaitingToBeRecovered(blockId,length,genStamp,volume,directoryUsed);
    }
  }
}
