{
  if (null == fromReplica) {
    throw new IllegalArgumentException("Missing a valid replica to recover from");
  }
  if (null != writer || null != block) {
    throw new IllegalArgumentException("Invalid state for " + "recovering from replica with blk id " + fromReplica.getBlockId());
  }
  if (fromReplica.getState() == ReplicaState.RUR) {
    return new ReplicaUnderRecovery((ReplicaUnderRecovery)fromReplica);
  }
 else {
    return new ReplicaUnderRecovery(fromReplica,recoveryId);
  }
}
