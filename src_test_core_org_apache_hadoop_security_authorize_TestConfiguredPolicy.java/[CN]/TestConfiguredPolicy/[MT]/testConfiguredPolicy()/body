{
  ConfiguredPolicy policy=createConfiguredPolicy();
  SecurityUtil.setPolicy(policy);
  Subject user1=SecurityUtil.getSubject(new UnixUserGroupInformation(USER1,GROUPS1));
  ServiceAuthorizationManager.authorize(user1,Protocol1.class);
  Subject user2=SecurityUtil.getSubject(new UnixUserGroupInformation(USER2,GROUPS2));
  boolean failed=false;
  try {
    ServiceAuthorizationManager.authorize(user2,Protocol2.class);
  }
 catch (  AuthorizationException ae) {
    failed=true;
  }
  assertTrue(failed);
}
