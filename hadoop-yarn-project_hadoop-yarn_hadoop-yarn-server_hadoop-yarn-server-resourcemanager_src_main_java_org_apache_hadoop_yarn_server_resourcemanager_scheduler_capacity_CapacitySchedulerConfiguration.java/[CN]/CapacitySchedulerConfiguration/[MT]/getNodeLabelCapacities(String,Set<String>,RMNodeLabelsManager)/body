{
  Map<String,Float> nodeLabelCapacities=new HashMap<String,Float>();
  if (labels == null) {
    return nodeLabelCapacities;
  }
  for (  String label : labels.contains(CommonNodeLabelsManager.ANY) ? mgr.getClusterNodeLabels() : labels) {
    String capacityPropertyName=getNodeLabelPrefix(queue,label) + CAPACITY;
    float capacity=getFloat(capacityPropertyName,0f);
    if (capacity < MINIMUM_CAPACITY_VALUE || capacity > MAXIMUM_CAPACITY_VALUE) {
      throw new IllegalArgumentException("Illegal capacity of " + capacity + " for node-label="+ label+ " in queue="+ queue+ ", valid capacity should in range of [0, 100].");
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("CSConf - getCapacityOfLabel: prefix=" + getNodeLabelPrefix(queue,label) + ", capacity="+ capacity);
    }
    nodeLabelCapacities.put(label,capacity / 100f);
  }
  return nodeLabelCapacities;
}
