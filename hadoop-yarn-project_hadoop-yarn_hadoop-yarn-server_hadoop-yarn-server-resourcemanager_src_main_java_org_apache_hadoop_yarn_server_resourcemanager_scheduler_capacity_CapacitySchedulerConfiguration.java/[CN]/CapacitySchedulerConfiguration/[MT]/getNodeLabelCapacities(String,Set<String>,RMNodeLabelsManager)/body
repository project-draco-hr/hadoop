{
  Map<String,Float> nodeLabelCapacities=new HashMap<String,Float>();
  if (labels == null) {
    return nodeLabelCapacities;
  }
  for (  String label : labels.contains(CommonNodeLabelsManager.ANY) ? mgr.getClusterNodeLabels() : labels) {
    if (org.apache.commons.lang.StringUtils.equals(ROOT,queue)) {
      nodeLabelCapacities.put(label,1.0f);
      continue;
    }
    String capacityPropertyName=getNodeLabelPrefix(queue,label) + CAPACITY;
    float capacity=getFloat(capacityPropertyName,UNDEFINED);
    if (capacity == UNDEFINED) {
      throw new IllegalArgumentException("Configuration issue: " + " node-label=" + label + " is accessible from queue="+ queue+ " but has no capacity set, you should set "+ capacityPropertyName+ " in range of [0, 100].");
    }
    if (capacity < MINIMUM_CAPACITY_VALUE || capacity > MAXIMUM_CAPACITY_VALUE) {
      throw new IllegalArgumentException("Illegal capacity of " + capacity + " for node-label="+ label+ " in queue="+ queue+ ", valid capacity should in range of [0, 100].");
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("CSConf - getCapacityOfLabel: prefix=" + getNodeLabelPrefix(queue,label) + ", capacity="+ capacity);
    }
    nodeLabelCapacities.put(label,capacity / 100f);
  }
  return nodeLabelCapacities;
}
