{
  Map<String,Float> nodeLabelCapacities=new HashMap<String,Float>();
  if (labels == null) {
    return nodeLabelCapacities;
  }
  for (  String label : labels.contains(CommonNodeLabelsManager.ANY) ? mgr.getClusterNodeLabels() : labels) {
    if (org.apache.commons.lang.StringUtils.equals(ROOT,queue)) {
      nodeLabelCapacities.put(label,1.0f);
      continue;
    }
    float capacity=getFloat(getNodeLabelPrefix(queue,label) + CAPACITY,UNDEFINED);
    if (capacity < MINIMUM_CAPACITY_VALUE || capacity > MAXIMUM_CAPACITY_VALUE) {
      throw new IllegalArgumentException("Illegal " + "capacity of " + capacity + " for label="+ label+ " in queue="+ queue);
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("CSConf - getCapacityOfLabel: prefix=" + getNodeLabelPrefix(queue,label) + ", capacity="+ capacity);
    }
    nodeLabelCapacities.put(label,capacity / 100f);
  }
  return nodeLabelCapacities;
}
