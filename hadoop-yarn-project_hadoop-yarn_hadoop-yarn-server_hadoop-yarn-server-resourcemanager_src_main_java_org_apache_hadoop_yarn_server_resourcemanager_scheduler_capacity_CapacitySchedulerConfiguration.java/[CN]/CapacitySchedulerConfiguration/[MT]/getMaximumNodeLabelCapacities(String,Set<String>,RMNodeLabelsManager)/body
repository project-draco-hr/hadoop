{
  Map<String,Float> maximumNodeLabelCapacities=new HashMap<String,Float>();
  if (labels == null) {
    return maximumNodeLabelCapacities;
  }
  for (  String label : labels.contains(CommonNodeLabelsManager.ANY) ? mgr.getClusterNodeLabels() : labels) {
    float maxCapacity=getFloat(getNodeLabelPrefix(queue,label) + MAXIMUM_CAPACITY,UNDEFINED);
    maxCapacity=(maxCapacity == DEFAULT_MAXIMUM_CAPACITY_VALUE) ? MAXIMUM_CAPACITY_VALUE : maxCapacity;
    if (maxCapacity < MINIMUM_CAPACITY_VALUE || maxCapacity > MAXIMUM_CAPACITY_VALUE) {
      throw new IllegalArgumentException("Illegal " + "capacity of " + maxCapacity + " for label="+ label+ " in queue="+ queue);
    }
    LOG.debug("CSConf - getCapacityOfLabel: prefix=" + getNodeLabelPrefix(queue,label) + ", capacity="+ maxCapacity);
    maximumNodeLabelCapacities.put(label,maxCapacity / 100f);
  }
  return maximumNodeLabelCapacities;
}
