{
  if (!tasksInited.get() || !jobSetupCleanupNeeded) {
    return null;
  }
synchronized (this) {
    if (!canLaunchSetupTask()) {
      return null;
    }
    String taskTracker=tts.getTrackerName();
    this.clusterSize=clusterSize;
    if (!shouldRunOnTaskTracker(taskTracker)) {
      return null;
    }
    List<TaskInProgress> setupTaskList=new ArrayList<TaskInProgress>();
    if (isMapSlot) {
      setupTaskList.add(setup[0]);
    }
 else {
      setupTaskList.add(setup[1]);
    }
    TaskInProgress tip=findTaskFromList(setupTaskList,tts,numUniqueHosts,false);
    if (tip == null) {
      return null;
    }
    Task result=tip.getTaskToRun(tts.getTrackerName());
    if (result != null) {
      addRunningTaskToTIP(tip,result.getTaskID(),tts,true);
    }
    return result;
  }
}
