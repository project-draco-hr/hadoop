{
  Path jobDir=jobtracker.getSystemDirectoryForJob(jobId);
  Path keysFile=new Path(jobDir,TokenCache.JOB_TOKEN_HDFS_FILE);
  if (tokenStorage == null) {
    tokenStorage=new Credentials();
  }
  JobTokenIdentifier identifier=new JobTokenIdentifier(new Text(jobId.toString()));
  Token<JobTokenIdentifier> token=new Token<JobTokenIdentifier>(identifier,jobtracker.getJobTokenSecretManager());
  token.setService(identifier.getJobId());
  TokenCache.setJobToken(token,tokenStorage);
  tokenStorage.writeTokenStorageFile(keysFile,jobtracker.getConf());
  LOG.info("jobToken generated and stored with users keys in " + keysFile.toUri().getPath());
}
