{
  InetSocketAddress targetAddr=null;
  Socket sock=null;
  ExtendedBlock block=testBlock.getBlock();
  DatanodeInfo[] nodes=testBlock.getLocations();
  targetAddr=NetUtils.createSocketAddr(nodes[0].getName());
  sock=new Socket();
  sock.connect(targetAddr,HdfsConstants.READ_TIMEOUT);
  sock.setSoTimeout(HdfsConstants.READ_TIMEOUT);
  return BlockReader.newBlockReader(sock,targetAddr.toString() + ":" + block.getBlockId(),block,testBlock.getBlockToken(),offset,lenToRead,conf.getInt("io.file.buffer.size",4096));
}
