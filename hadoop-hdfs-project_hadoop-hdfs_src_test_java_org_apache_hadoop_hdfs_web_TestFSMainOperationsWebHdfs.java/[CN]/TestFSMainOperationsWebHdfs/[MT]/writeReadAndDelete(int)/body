{
  Path path=getTestRootPath(fSys,"test/hadoop/file");
  fSys.mkdirs(path.getParent());
  FSDataOutputStream out=fSys.create(path,false,4096,(short)1,getDefaultBlockSize());
  out.write(data,0,len);
  out.close();
  Assert.assertTrue("Exists",exists(fSys,path));
  Assert.assertEquals("Length",len,fSys.getFileStatus(path).getLen());
  FSDataInputStream in=fSys.open(path);
  for (int i=0; i < len; i++) {
    final int b=in.read();
    Assert.assertEquals("Position " + i,data[i],b);
  }
  in.close();
  Assert.assertTrue("Deleted",fSys.delete(path,false));
  Assert.assertFalse("No longer exists",exists(fSys,path));
}
