{
  KMSWebApp.getAdminCallsMeter().mark();
  UserGroupInformation user=HttpUserGroupInformation.get();
  final String[] keyNames=keyNamesList.toArray(new String[keyNamesList.size()]);
  assertAccess(KMSACLs.Type.GET_METADATA,user,KMSOp.GET_KEYS_METADATA);
  KeyProvider.Metadata[] keysMeta=user.doAs(new PrivilegedExceptionAction<KeyProvider.Metadata[]>(){
    @Override public KeyProvider.Metadata[] run() throws Exception {
      return provider.getKeysMetadata(keyNames);
    }
  }
);
  Object json=KMSServerJSONUtils.toJSON(keyNames,keysMeta);
  kmsAudit.ok(user,KMSOp.GET_KEYS_METADATA,"");
  return Response.ok().type(MediaType.APPLICATION_JSON).entity(json).build();
}
