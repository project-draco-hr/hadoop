{
  if (!KMSWebApp.getACLs().hasAccess(aclType,principal.getName())) {
    KMSWebApp.getUnauthorizedCallsMeter().mark();
    kmsAudit.unauthorized(principal,operation,key);
    throw new AuthorizationException(String.format((key != null) ? UNAUTHORIZED_MSG_WITH_KEY : UNAUTHORIZED_MSG_WITHOUT_KEY,principal.getName(),operation,key));
  }
}
