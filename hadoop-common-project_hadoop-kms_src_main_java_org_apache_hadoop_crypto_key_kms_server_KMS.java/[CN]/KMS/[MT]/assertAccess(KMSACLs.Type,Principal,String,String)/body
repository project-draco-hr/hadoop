{
  if (!KMSWebApp.getACLs().hasAccess(aclType,principal.getName())) {
    KMSWebApp.getUnauthorizedCallsMeter().mark();
    KMSAudit.unauthorized(principal,operation,key);
    throw new AuthorizationException(MessageFormat.format("User:{0} not allowed to do ''{1}'' on ''{2}''",principal.getName(),operation,key));
  }
}
