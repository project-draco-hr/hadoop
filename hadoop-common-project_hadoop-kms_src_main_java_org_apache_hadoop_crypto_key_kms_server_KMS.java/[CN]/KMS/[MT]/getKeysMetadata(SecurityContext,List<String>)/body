{
  KMSWebApp.getAdminCallsMeter().mark();
  Principal user=getPrincipal(securityContext);
  String[] keyNames=keyNamesList.toArray(new String[keyNamesList.size()]);
  String names=StringUtils.arrayToString(keyNames);
  assertAccess(KMSACLs.Type.GET_METADATA,user,GET_KEYS_METADATA,names);
  KeyProvider.Metadata[] keysMeta=provider.getKeysMetadata(keyNames);
  Object json=KMSServerJSONUtils.toJSON(keyNames,keysMeta);
  KMSAudit.ok(user,GET_KEYS_METADATA,names,"");
  return Response.ok().type(MediaType.APPLICATION_JSON).entity(json).build();
}
