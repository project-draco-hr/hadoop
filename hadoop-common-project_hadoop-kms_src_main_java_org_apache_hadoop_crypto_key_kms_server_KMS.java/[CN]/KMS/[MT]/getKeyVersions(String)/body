{
  UserGroupInformation user=HttpUserGroupInformation.get();
  KMSClientProvider.checkNotEmpty(name,"name");
  KMSWebApp.getKeyCallsMeter().mark();
  assertAccess(KMSACLs.Type.GET,user,KMSOp.GET_KEY_VERSIONS,name);
  List<KeyVersion> ret=user.doAs(new PrivilegedExceptionAction<List<KeyVersion>>(){
    @Override public List<KeyVersion> run() throws Exception {
      return provider.getKeyVersions(name);
    }
  }
);
  Object json=KMSServerJSONUtils.toJSON(ret);
  kmsAudit.ok(user,KMSOp.GET_KEY_VERSIONS,name,"");
  return Response.ok().type(MediaType.APPLICATION_JSON).entity(json).build();
}
