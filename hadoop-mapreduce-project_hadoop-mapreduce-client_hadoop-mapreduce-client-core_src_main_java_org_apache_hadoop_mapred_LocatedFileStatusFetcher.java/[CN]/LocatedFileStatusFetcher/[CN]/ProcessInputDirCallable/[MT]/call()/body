{
  Result result=new Result();
  result.fs=fs;
  if (fileStatus.isDirectory()) {
    RemoteIterator<LocatedFileStatus> iter=fs.listLocatedStatus(fileStatus.getPath());
    while (iter.hasNext()) {
      LocatedFileStatus stat=iter.next();
      if (inputFilter.accept(stat.getPath())) {
        if (recursive && stat.isDirectory()) {
          result.dirsNeedingRecursiveCalls.add(stat);
        }
 else {
          result.locatedFileStatuses.add(stat);
        }
      }
    }
  }
 else {
    result.locatedFileStatuses.add(fileStatus);
  }
  return result;
}
