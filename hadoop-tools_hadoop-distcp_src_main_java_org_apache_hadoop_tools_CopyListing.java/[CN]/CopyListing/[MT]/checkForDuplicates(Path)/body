{
  Configuration config=getConf();
  FileSystem fs=pathToListFile.getFileSystem(config);
  Path sortedList=DistCpUtils.sortListing(fs,config,pathToListFile);
  SequenceFile.Reader reader=new SequenceFile.Reader(config,SequenceFile.Reader.file(sortedList));
  try {
    Text lastKey=new Text("*");
    FileStatus lastFileStatus=new FileStatus();
    Text currentKey=new Text();
    while (reader.next(currentKey)) {
      if (currentKey.equals(lastKey)) {
        FileStatus currentFileStatus=new FileStatus();
        reader.getCurrentValue(currentFileStatus);
        throw new DuplicateFileException("File " + lastFileStatus.getPath() + " and "+ currentFileStatus.getPath()+ " would cause duplicates. Aborting");
      }
      reader.getCurrentValue(lastFileStatus);
      lastKey.set(currentKey);
    }
  }
  finally {
    IOUtils.closeStream(reader);
  }
}
