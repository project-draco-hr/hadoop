{
  JobID jid=new JobID();
  TaskID test=new TaskID(jid,true,1);
  assertEquals(test.getTaskType(),TaskType.MAP);
  test=new TaskID(jid,false,1);
  assertEquals(test.getTaskType(),TaskType.REDUCE);
  test=new TaskID("001",1,false,1);
  assertEquals(test.getTaskType(),TaskType.REDUCE);
  test=new TaskID("001",1,true,1);
  assertEquals(test.getTaskType(),TaskType.MAP);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  test.write(new DataOutputStream(out));
  TaskID ti=TaskID.read(new DataInputStream(new ByteArrayInputStream(out.toByteArray())));
  assertEquals(ti.toString(),test.toString());
  assertEquals("task_001_0001_m_000002",TaskID.getTaskIDsPattern("001",1,true,2));
  assertEquals("task_003_0001_m_000004",TaskID.getTaskIDsPattern("003",1,TaskType.MAP,4));
  assertEquals("003_0001_m_000004",TaskID.getTaskIDsPatternWOPrefix("003",1,TaskType.MAP,4).toString());
}
