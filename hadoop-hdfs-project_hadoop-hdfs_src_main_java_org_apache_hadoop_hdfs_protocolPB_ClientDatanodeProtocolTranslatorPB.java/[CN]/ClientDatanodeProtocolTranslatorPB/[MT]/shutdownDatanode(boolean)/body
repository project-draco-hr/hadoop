{
  ShutdownDatanodeRequestProto request=ShutdownDatanodeRequestProto.newBuilder().setForUpgrade(forUpgrade).build();
  try {
    rpcProxy.shutdownDatanode(NULL_CONTROLLER,request);
  }
 catch (  ServiceException e) {
    throw ProtobufHelper.getRemoteException(e);
  }
}
