{
  String containerIdStr=container.getContainerId().toString();
  int classId=trafficController.getNextClassId();
  String classIdStr=trafficController.getStringForNetClsClassId(classId);
  cGroupsHandler.createCGroup(CGroupsHandler.CGroupController.NET_CLS,containerIdStr);
  cGroupsHandler.updateCGroupParam(CGroupsHandler.CGroupController.NET_CLS,containerIdStr,CGroupsHandler.CGROUP_PARAM_CLASSID,classIdStr);
  containerIdClassIdMap.put(container.getContainerId(),classId);
  String tasksFile=cGroupsHandler.getPathForCGroupTasks(CGroupsHandler.CGroupController.NET_CLS,containerIdStr);
  String opArg=new StringBuffer(PrivilegedOperation.CGROUP_ARG_PREFIX).append(tasksFile).toString();
  List<PrivilegedOperation> ops=new ArrayList<>();
  ops.add(new PrivilegedOperation(PrivilegedOperation.OperationType.ADD_PID_TO_CGROUP,opArg));
  TrafficController.BatchBuilder builder=trafficController.new BatchBuilder(PrivilegedOperation.OperationType.TC_MODIFY_STATE);
  builder.addContainerClass(classId,containerBandwidthMbit,strictMode);
  ops.add(builder.commitBatchToTempFile());
  return ops;
}
