{
  FSDataInputStream i=(FSDataInputStream)super.getInputStream(item);
  CompressionCodecFactory cf=new CompressionCodecFactory(getConf());
  CompressionCodec codec=cf.getCodec(item.path);
  if (codec != null) {
    return codec.createInputStream(i);
  }
switch (i.readShort()) {
case 0x1f8b:
{
      i.seek(0);
      return new GZIPInputStream(i);
    }
case 0x5345:
{
    if (i.readByte() == 'Q') {
      i.close();
      return new TextRecordInputStream(item.stat);
    }
    break;
  }
}
i.seek(0);
return i;
}
