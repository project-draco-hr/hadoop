{
  Long ts=TimelineStorageUtils.getTopOfTheDayTimestamp(1459900830000L);
  byte[] byteRowKey=FlowActivityRowKeyConverter.getInstance().encode(new FlowActivityRowKey(CLUSTER,ts,USER,FLOW_NAME));
  FlowActivityRowKey rowKey=FlowActivityRowKeyConverter.getInstance().decode(byteRowKey);
  assertEquals(CLUSTER,rowKey.getClusterId());
  assertEquals(ts,rowKey.getDayTimestamp());
  assertEquals(USER,rowKey.getUserId());
  assertEquals(FLOW_NAME,rowKey.getFlowName());
  byte[] byteRowKeyPrefix=FlowActivityRowKeyConverter.getInstance().encode(new FlowActivityRowKey(CLUSTER,null,null,null));
  byte[][] splits=Separator.QUALIFIERS.split(byteRowKeyPrefix,new int[]{Separator.VARIABLE_SIZE,Separator.VARIABLE_SIZE});
  assertEquals(2,splits.length);
  assertEquals(0,splits[1].length);
  assertEquals(CLUSTER,Separator.QUALIFIERS.decode(Bytes.toString(splits[0])));
  verifyRowPrefixBytes(byteRowKeyPrefix);
  byteRowKeyPrefix=FlowActivityRowKeyConverter.getInstance().encode(new FlowActivityRowKey(CLUSTER,ts,null,null));
  splits=Separator.QUALIFIERS.split(byteRowKeyPrefix,new int[]{Separator.VARIABLE_SIZE,Bytes.SIZEOF_LONG,Separator.VARIABLE_SIZE});
  assertEquals(3,splits.length);
  assertEquals(0,splits[2].length);
  assertEquals(CLUSTER,Separator.QUALIFIERS.decode(Bytes.toString(splits[0])));
  assertEquals(ts,(Long)TimelineStorageUtils.invertLong(Bytes.toLong(splits[1])));
  verifyRowPrefixBytes(byteRowKeyPrefix);
}
