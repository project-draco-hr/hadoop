{
  lock.lock();
  try {
    checkDiskBalancerEnabled();
    if ((this.planID == null) || (!this.planID.equals(planID))) {
      LOG.error("Disk Balancer - No such plan. Cancel plan failed. PlanID: " + planID);
      throw new DiskBalancerException("No such plan.",DiskBalancerException.Result.NO_SUCH_PLAN);
    }
    if (!this.future.isDone()) {
      this.blockMover.setExitFlag();
      shutdownExecutor();
    }
  }
  finally {
    lock.unlock();
  }
}
