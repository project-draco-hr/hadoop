{
  Map<String,String> storageIDToVolBasePathMap=new HashMap<>();
  FsDatasetSpi.FsVolumeReferences references;
  try {
    try (AutoCloseableLock lock=this.dataset.acquireDatasetLock()){
      references=this.dataset.getFsVolumeReferences();
      for (int ndx=0; ndx < references.size(); ndx++) {
        FsVolumeSpi vol=references.get(ndx);
        storageIDToVolBasePathMap.put(vol.getStorageID(),vol.getBasePath());
      }
      references.close();
    }
   }
 catch (  IOException ex) {
    LOG.error("Disk Balancer - Internal Error.",ex);
    throw new DiskBalancerException("Internal error",ex,DiskBalancerException.Result.INTERNAL_ERROR);
  }
  return storageIDToVolBasePathMap;
}
