{
  if (source.getStorageID().equals(dest.getStorageID())) {
    LOG.info("Disk Balancer - source & destination volumes are same.");
    throw new DiskBalancerException("source and destination volumes are " + "same.",DiskBalancerException.Result.INVALID_MOVE);
  }
  VolumePair pair=new VolumePair(source,dest);
  long bytesToMove=step.getBytesToMove();
  if (workMap.containsKey(pair)) {
    bytesToMove+=workMap.get(pair).getBytesToCopy();
  }
  DiskBalancerWorkItem work=new DiskBalancerWorkItem(bytesToMove,0);
  work.setBandwidth(step.getBandwidth());
  work.setTolerancePercent(step.getTolerancePercent());
  work.setMaxDiskErrors(step.getMaxDiskErrors());
  workMap.put(pair,work);
}
