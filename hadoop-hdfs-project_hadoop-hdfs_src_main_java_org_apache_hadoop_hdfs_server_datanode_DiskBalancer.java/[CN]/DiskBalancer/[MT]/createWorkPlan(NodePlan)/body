{
  Preconditions.checkState(lock.isHeldByCurrentThread());
  workMap.clear();
  Map<String,FsVolumeSpi> pathMap=getStorageIDToVolumeMap();
  for (  Step step : plan.getVolumeSetPlans()) {
    String sourceuuid=step.getSourceVolume().getUuid();
    String destinationuuid=step.getDestinationVolume().getUuid();
    FsVolumeSpi sourceVol=pathMap.get(sourceuuid);
    if (sourceVol == null) {
      LOG.error("Disk Balancer - Unable to find source volume. submitPlan " + "failed.");
      throw new DiskBalancerException("Unable to find source volume.",DiskBalancerException.Result.INVALID_VOLUME);
    }
    FsVolumeSpi destVol=pathMap.get(destinationuuid);
    if (destVol == null) {
      LOG.error("Disk Balancer - Unable to find destination volume. " + "submitPlan failed.");
      throw new DiskBalancerException("Unable to find destination volume.",DiskBalancerException.Result.INVALID_VOLUME);
    }
    createWorkPlan(sourceVol,destVol,step.getBytesToMove());
  }
}
