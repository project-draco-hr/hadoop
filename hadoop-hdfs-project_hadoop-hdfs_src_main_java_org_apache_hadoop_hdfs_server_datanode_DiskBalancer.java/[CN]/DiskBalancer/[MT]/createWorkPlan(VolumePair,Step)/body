{
  if (volumePair.getSourceVolUuid().equals(volumePair.getDestVolUuid())) {
    final String errMsg="Disk Balancer - Source and destination volumes " + "are same: " + volumePair.getSourceVolUuid();
    LOG.warn(errMsg);
    throw new DiskBalancerException(errMsg,DiskBalancerException.Result.INVALID_MOVE);
  }
  long bytesToMove=step.getBytesToMove();
  if (workMap.containsKey(volumePair)) {
    bytesToMove+=workMap.get(volumePair).getBytesToCopy();
  }
  DiskBalancerWorkItem work=new DiskBalancerWorkItem(bytesToMove,0);
  work.setBandwidth(step.getBandwidth());
  work.setTolerancePercent(step.getTolerancePercent());
  work.setMaxDiskErrors(step.getMaxDiskErrors());
  workMap.put(volumePair,work);
}
