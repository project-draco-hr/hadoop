{
  String suffix="";
  Preconditions.checkState(refCount == 0,"tried to close replica with refCount " + refCount + ": "+ this);
  refCount=-1;
  Preconditions.checkState(purged,"tried to close unpurged replica " + this);
  if (hasMmap()) {
    munmap();
    suffix+="  munmapped.";
  }
  IOUtils.cleanup(LOG,dataStream,metaStream);
  if (slot != null) {
    cache.scheduleSlotReleaser(slot);
    suffix+="  scheduling " + slot + " for later release.";
  }
  if (LOG.isTraceEnabled()) {
    LOG.trace("closed " + this + suffix);
  }
}
