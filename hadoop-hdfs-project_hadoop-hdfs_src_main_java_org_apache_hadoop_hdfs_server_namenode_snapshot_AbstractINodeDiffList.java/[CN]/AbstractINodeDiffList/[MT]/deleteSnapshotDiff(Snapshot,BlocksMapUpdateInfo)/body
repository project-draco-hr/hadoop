{
  int snapshotIndex=Collections.binarySearch(diffs,snapshot);
  if (snapshotIndex < 0) {
    return null;
  }
 else {
    final D removed=diffs.remove(snapshotIndex);
    if (snapshotIndex > 0) {
      final AbstractINodeDiff<N,D> previous=diffs.get(snapshotIndex - 1);
      if (previous.snapshotINode == null) {
        previous.snapshotINode=removed.snapshotINode;
      }
      previous.combinePosteriorAndCollectBlocks(removed,collectedBlocks);
      previous.setPosterior(removed.getPosterior());
    }
    removed.setPosterior(null);
    return removed;
  }
}
