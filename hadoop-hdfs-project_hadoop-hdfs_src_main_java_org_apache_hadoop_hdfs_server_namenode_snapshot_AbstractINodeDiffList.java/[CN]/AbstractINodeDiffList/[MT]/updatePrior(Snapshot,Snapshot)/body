{
  int id=snapshot == null ? Snapshot.INVALID_ID : snapshot.getId();
  Snapshot s=getPrior(id,true);
  if (s != null && (prior == null || Snapshot.ID_COMPARATOR.compare(s,prior) > 0)) {
    return s;
  }
  return prior;
}
