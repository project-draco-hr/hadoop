{
  manageOsCache=conf.getBoolean(SHUFFLE_MANAGE_OS_CACHE,DEFAULT_SHUFFLE_MANAGE_OS_CACHE);
  readaheadLength=conf.getInt(SHUFFLE_READAHEAD_BYTES,DEFAULT_SHUFFLE_READAHEAD_BYTES);
  maxShuffleConnections=conf.getInt(MAX_SHUFFLE_CONNECTIONS,DEFAULT_MAX_SHUFFLE_CONNECTIONS);
  ThreadFactory bossFactory=new ThreadFactoryBuilder().setNameFormat("ShuffleHandler Netty Boss #%d").build();
  ThreadFactory workerFactory=new ThreadFactoryBuilder().setNameFormat("ShuffleHandler Netty Worker #%d").build();
  selector=new NioServerSocketChannelFactory(Executors.newCachedThreadPool(bossFactory),Executors.newCachedThreadPool(workerFactory));
  super.serviceInit(new Configuration(conf));
}
