{
  Set<String> labelCanAccess=new HashSet<String>(accessibleLabels.contains(CommonNodeLabelsManager.ANY) ? nodeLabels : Sets.intersection(accessibleLabels,nodeLabels));
  if (nodeLabels.isEmpty()) {
    labelCanAccess.add(RMNodeLabelsManager.NO_LABEL);
  }
  boolean canAssign=true;
  for (  String label : labelCanAccess) {
    if (!usedResourcesByNodeLabels.containsKey(label)) {
      usedResourcesByNodeLabels.put(label,Resources.createResource(0));
    }
    float currentAbsoluteLabelUsedCapacity=Resources.divide(resourceCalculator,clusterResource,usedResourcesByNodeLabels.get(label),labelManager.getResourceByLabel(label,clusterResource));
    if (currentAbsoluteLabelUsedCapacity >= getAbsoluteMaximumCapacityByNodeLabel(label)) {
      if (LOG.isDebugEnabled()) {
        LOG.debug(getQueueName() + " used=" + usedResources+ " current-capacity ("+ usedResourcesByNodeLabels.get(label)+ ") "+ " >= max-capacity ("+ labelManager.getResourceByLabel(label,clusterResource)+ ")");
      }
      canAssign=false;
      break;
    }
  }
  return canAssign;
}
