{
  Resource parentMaxAvailableResource=Resources.subtract(parentLimits.getLimit(),getUsedResources());
  Resource childLimit=Resources.add(parentMaxAvailableResource,child.getUsedResources());
  Resource childConfiguredMaxResource=Resources.multiplyAndNormalizeDown(resourceCalculator,labelManager.getResourceByLabel(RMNodeLabelsManager.NO_LABEL,clusterResource),child.getAbsoluteMaximumCapacity(),minimumAllocation);
  childLimit=Resources.min(resourceCalculator,clusterResource,childLimit,childConfiguredMaxResource);
  childLimit=Resources.roundDown(resourceCalculator,childLimit,minimumAllocation);
  return new ResourceLimits(childLimit);
}
