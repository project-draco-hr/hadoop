{
  try {
    writeLock.lock();
    if (queue.equals(queueName)) {
      throw new AccessControlException("Cannot submit application " + "to non-leaf queue: " + queueName);
    }
    if (state != QueueState.RUNNING) {
      throw new AccessControlException("Queue " + getQueuePath() + " is STOPPED. Cannot accept submission of application: "+ applicationId);
    }
    addApplication(applicationId,user);
  }
  finally {
    writeLock.unlock();
  }
  if (parent != null) {
    try {
      parent.submitApplication(applicationId,user,queue);
    }
 catch (    AccessControlException ace) {
      LOG.info("Failed to submit application to parent-queue: " + parent.getQueuePath(),ace);
      removeApplication(applicationId,user);
      throw ace;
    }
  }
}
