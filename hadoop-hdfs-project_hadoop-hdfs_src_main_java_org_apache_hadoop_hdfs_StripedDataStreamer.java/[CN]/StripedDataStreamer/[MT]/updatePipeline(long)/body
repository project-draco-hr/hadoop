{
  final MultipleBlockingQueue<ExtendedBlock> updateBlocks=coordinator.getUpdateBlocks();
  return new ConcurrentPoll<ExtendedBlock>(updateBlocks){
    @Override void populate() throws IOException {
      final ExtendedBlock bg=coordinator.getBlockGroup();
      final ExtendedBlock newBG=newBlock(bg,newGS);
      final ExtendedBlock updated=callUpdatePipeline(bg,newBG);
      for (int i=0; i < NUM_DATA_BLOCKS + NUM_PARITY_BLOCKS; i++) {
        final ExtendedBlock bi=coordinator.getStripedDataStreamer(i).getBlock();
        updateBlocks.offer(i,newBlock(bi,updated.getGenerationStamp()));
      }
    }
  }
.poll(index);
}
