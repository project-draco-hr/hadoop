{
  List<BlockProto> blockProtoList=blkCmd.getBlocksList();
  List<DatanodeInfosProto> targetList=blkCmd.getTargetsList();
  DatanodeInfo[][] targets=new DatanodeInfo[blockProtoList.size()][];
  Block[] blocks=new Block[blockProtoList.size()];
  for (int i=0; i < blockProtoList.size(); i++) {
    targets[i]=PBHelper.convert(targetList.get(i));
    blocks[i]=PBHelper.convert(blockProtoList.get(i));
  }
  int action=DatanodeProtocol.DNA_UNKNOWN;
switch (blkCmd.getAction()) {
case TRANSFER:
    action=DatanodeProtocol.DNA_TRANSFER;
  break;
case INVALIDATE:
action=DatanodeProtocol.DNA_INVALIDATE;
break;
}
return new BlockCommand(action,blkCmd.getBlockPoolId(),blocks,targets);
}
