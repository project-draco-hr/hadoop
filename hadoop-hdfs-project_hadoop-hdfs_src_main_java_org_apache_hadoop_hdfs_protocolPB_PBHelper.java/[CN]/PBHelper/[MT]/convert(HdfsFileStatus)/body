{
  if (fs == null)   return null;
  FileType fType=FileType.IS_FILE;
  if (fs.isDir()) {
    fType=FileType.IS_DIR;
  }
 else   if (fs.isSymlink()) {
    fType=FileType.IS_SYMLINK;
  }
  HdfsFileStatusProto.Builder builder=HdfsFileStatusProto.newBuilder().setLength(fs.getLen()).setFileType(fType).setBlockReplication(fs.getReplication()).setBlocksize(fs.getBlockSize()).setModificationTime(fs.getModificationTime()).setAccessTime(fs.getAccessTime()).setPermission(PBHelper.convert(fs.getPermission())).setOwner(fs.getOwner()).setGroup(fs.getGroup()).setFileId(fs.getFileId()).setChildrenNum(fs.getChildrenNum()).setPath(ByteString.copyFrom(fs.getLocalNameInBytes()));
  if (fs.isSymlink()) {
    builder.setSymlink(ByteString.copyFrom(fs.getSymlinkInBytes()));
  }
  if (fs.getKey() != null) {
    builder.setKey(ByteString.copyFrom(fs.getKey()));
  }
  if (fs.getIv() != null) {
    builder.setIv(ByteString.copyFrom(fs.getIv()));
  }
  if (fs instanceof HdfsLocatedFileStatus) {
    LocatedBlocks locations=((HdfsLocatedFileStatus)fs).getBlockLocations();
    if (locations != null) {
      builder.setLocations(PBHelper.convert(locations));
    }
  }
  return builder.build();
}
