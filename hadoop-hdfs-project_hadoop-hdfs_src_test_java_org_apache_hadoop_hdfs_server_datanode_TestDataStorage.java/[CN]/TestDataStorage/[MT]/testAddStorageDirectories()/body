{
  final int numLocations=3;
  final int numNamespace=3;
  List<StorageLocation> locations=createStorageLocations(numLocations);
  List<NamespaceInfo> namespaceInfos=createNamespaceInfos(numNamespace);
  for (  NamespaceInfo ni : namespaceInfos) {
    storage.addStorageLocations(mockDN,ni,locations,START_OPT);
    for (    StorageLocation sl : locations) {
      checkDir(sl.getFile());
      checkDir(sl.getFile(),ni.getBlockPoolID());
    }
  }
  assertEquals(numLocations,storage.getNumStorageDirs());
  locations=createStorageLocations(numLocations);
  try {
    storage.addStorageLocations(mockDN,namespaceInfos.get(0),locations,START_OPT);
    fail("Expected to throw IOException: adding active directories.");
  }
 catch (  IOException e) {
    GenericTestUtils.assertExceptionContains("All specified directories are not accessible or do not exist.",e);
  }
  assertEquals(numLocations,storage.getNumStorageDirs());
  locations=createStorageLocations(6);
  storage.addStorageLocations(mockDN,nsInfo,locations,START_OPT);
  assertEquals(6,storage.getNumStorageDirs());
}
