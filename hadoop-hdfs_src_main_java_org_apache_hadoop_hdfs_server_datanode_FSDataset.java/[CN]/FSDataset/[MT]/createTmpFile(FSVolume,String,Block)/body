{
  if (vol == null) {
    ReplicaInfo replica=volumeMap.get(bpid,blk);
    if (replica != null) {
      vol=volumeMap.get(bpid,blk).getVolume();
    }
    if (vol == null) {
      throw new IOException("Could not find volume for block " + blk);
    }
  }
  return vol.createTmpFile(bpid,blk);
}
