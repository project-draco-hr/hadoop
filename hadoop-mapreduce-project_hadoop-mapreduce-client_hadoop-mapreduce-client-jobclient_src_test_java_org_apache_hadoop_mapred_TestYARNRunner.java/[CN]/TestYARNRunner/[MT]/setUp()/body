{
  resourceMgrDelegate=mock(ResourceMgrDelegate.class);
  conf=new YarnConfiguration();
  conf.set(YarnConfiguration.RM_PRINCIPAL,"mapred/host@REALM");
  clientCache=new ClientCache(conf,resourceMgrDelegate);
  clientCache=spy(clientCache);
  yarnRunner=new YARNRunner(conf,resourceMgrDelegate,clientCache);
  yarnRunner=spy(yarnRunner);
  submissionContext=mock(ApplicationSubmissionContext.class);
  doAnswer(new Answer<ApplicationSubmissionContext>(){
    @Override public ApplicationSubmissionContext answer(    InvocationOnMock invocation) throws Throwable {
      return submissionContext;
    }
  }
).when(yarnRunner).createApplicationSubmissionContext(any(Configuration.class),any(String.class),any(Credentials.class));
  appId=ApplicationId.newInstance(System.currentTimeMillis(),1);
  jobId=TypeConverter.fromYarn(appId);
  if (testWorkDir.exists()) {
    FileContext.getLocalFSFileContext().delete(new Path(testWorkDir.toString()),true);
  }
  testWorkDir.mkdirs();
}
