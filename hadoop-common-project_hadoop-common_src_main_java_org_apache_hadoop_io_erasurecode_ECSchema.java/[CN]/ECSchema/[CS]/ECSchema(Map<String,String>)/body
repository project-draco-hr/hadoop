{
  if (allOptions == null || allOptions.isEmpty()) {
    throw new IllegalArgumentException("No schema options are provided");
  }
  this.codecName=allOptions.get(CODEC_NAME_KEY);
  if (codecName == null || codecName.isEmpty()) {
    throw new IllegalArgumentException("No codec option is provided");
  }
  int tmpNumDataUnits=extractIntOption(NUM_DATA_UNITS_KEY,allOptions);
  int tmpNumParityUnits=extractIntOption(NUM_PARITY_UNITS_KEY,allOptions);
  if (tmpNumDataUnits < 0 || tmpNumParityUnits < 0) {
    throw new IllegalArgumentException("No good option for numDataUnits or numParityUnits found ");
  }
  this.numDataUnits=tmpNumDataUnits;
  this.numParityUnits=tmpNumParityUnits;
  allOptions.remove(CODEC_NAME_KEY);
  allOptions.remove(NUM_DATA_UNITS_KEY);
  allOptions.remove(NUM_PARITY_UNITS_KEY);
  this.extraOptions=Collections.unmodifiableMap(allOptions);
}
