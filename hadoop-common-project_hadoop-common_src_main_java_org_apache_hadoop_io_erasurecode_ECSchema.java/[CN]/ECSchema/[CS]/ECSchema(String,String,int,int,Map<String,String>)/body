{
  assert(schemaName != null && !schemaName.isEmpty());
  assert(codecName != null && !codecName.isEmpty());
  assert(numDataUnits > 0 && numParityUnits > 0);
  this.schemaName=schemaName;
  this.codecName=codecName;
  this.numDataUnits=numDataUnits;
  this.numParityUnits=numParityUnits;
  if (extraOptions == null) {
    extraOptions=new HashMap<>();
  }
  int tmpChunkSize=extractIntOption(CHUNK_SIZE_KEY,extraOptions);
  if (tmpChunkSize > 0) {
    this.chunkSize=tmpChunkSize;
  }
 else {
    this.chunkSize=DEFAULT_CHUNK_SIZE;
  }
  extraOptions.remove(CHUNK_SIZE_KEY);
  this.extraOptions=Collections.unmodifiableMap(extraOptions);
}
