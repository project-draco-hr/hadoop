{
  byte[] saslToken=null;
  if (saslResponse.hasToken()) {
    saslToken=saslResponse.getToken().toByteArray();
    saslToken=saslClient.evaluateChallenge(saslToken);
  }
 else   if (!done) {
    throw new SaslException("Challenge contains no token");
  }
  if (done && !saslClient.isComplete()) {
    throw new SaslException("Client is out of sync with server");
  }
  return saslToken;
}
