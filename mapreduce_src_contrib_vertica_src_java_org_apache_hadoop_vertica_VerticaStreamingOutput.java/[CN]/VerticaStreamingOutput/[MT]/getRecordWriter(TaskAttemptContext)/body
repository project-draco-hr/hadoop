{
  Configuration conf=context.getConfiguration();
  VerticaConfiguration vtconfig=new VerticaConfiguration(conf);
  String name=context.getJobName();
  delimiter=vtconfig.getOutputDelimiter();
  terminator=vtconfig.getOutputRecordTerminator();
  String table=vtconfig.getOutputTableName();
  String copyStmt="COPY " + table + " FROM STDIN"+ " DELIMITER '"+ delimiter+ "' RECORD TERMINATOR '"+ terminator+ "' STREAM NAME '"+ name+ "' DIRECT";
  try {
    Connection conn=vtconfig.getConnection(true);
    return new VerticaStreamingRecordWriter(conn,copyStmt,table);
  }
 catch (  Exception e) {
    throw new IOException(e);
  }
}
