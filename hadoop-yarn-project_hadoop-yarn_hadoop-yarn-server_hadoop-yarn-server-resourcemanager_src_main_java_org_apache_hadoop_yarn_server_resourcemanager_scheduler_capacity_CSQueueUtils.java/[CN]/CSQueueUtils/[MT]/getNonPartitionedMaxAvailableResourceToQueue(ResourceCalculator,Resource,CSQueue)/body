{
  Resource queueLimit=Resources.none();
  Resource usedResources=queue.getUsedResources();
  if (Resources.greaterThan(rc,totalNonPartitionedResource,totalNonPartitionedResource,Resources.none())) {
    queueLimit=Resources.multiply(totalNonPartitionedResource,queue.getAbsoluteCapacity());
  }
  Resource available=Resources.subtract(queueLimit,usedResources);
  return Resources.max(rc,totalNonPartitionedResource,available,Resources.none());
}
