{
  QueueCapacities queueCapacities=childQueue.getQueueCapacities();
  ResourceUsage queueResourceUsage=childQueue.getQueueResourceUsage();
  if (nodePartition == null) {
    for (    String partition : Sets.union(queueCapacities.getNodePartitionsSet(),queueResourceUsage.getNodePartitionsSet())) {
      updateUsedCapacity(rc,nlm.getResourceByLabel(partition,cluster),minimumAllocation,queueResourceUsage,queueCapacities,partition);
    }
  }
 else {
    updateUsedCapacity(rc,nlm.getResourceByLabel(nodePartition,cluster),minimumAllocation,queueResourceUsage,queueCapacities,nodePartition);
  }
  childQueue.getMetrics().setAvailableResourcesToQueue(getMaxAvailableResourceToQueue(rc,nlm,childQueue,cluster));
}
