{
  final int clusterMemory=clusterResource.getMemory();
  final int usedMemory=childQueue.getUsedResources().getMemory();
  float queueLimit=0.0f;
  float absoluteUsedCapacity=0.0f;
  float usedCapacity=0.0f;
  if (clusterMemory > 0) {
    queueLimit=clusterMemory * childQueue.getAbsoluteCapacity();
    absoluteUsedCapacity=((float)usedMemory / (float)clusterMemory);
    usedCapacity=(queueLimit == 0) ? 0 : (usedMemory / queueLimit);
  }
  childQueue.setUsedCapacity(usedCapacity);
  childQueue.setAbsoluteUsedCapacity(absoluteUsedCapacity);
  int available=Math.max((roundUp(minimumAllocation,(int)queueLimit) - usedMemory),0);
  childQueue.getMetrics().setAvailableResourcesToQueue(Resources.createResource(available));
}
