{
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser(user);
  ugi.addToken(ProtoUtils.convertFromProtoFormat(token,rmAddress));
  final YarnRPC rpc=YarnRPC.create(conf);
  ApplicationClientProtocol clientRMWithDT=ugi.doAs(new PrivilegedAction<ApplicationClientProtocol>(){
    @Override public ApplicationClientProtocol run(){
      return (ApplicationClientProtocol)rpc.getProxy(ApplicationClientProtocol.class,rmAddress,conf);
    }
  }
);
  return clientRMWithDT;
}
