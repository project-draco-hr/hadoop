{
  final Path inDir;
  final Path outDir;
  FileSystem fs=FileSystem.getLocal(conf);
  FileSystem tempFs=FileSystem.get(conf);
  if (!tempFs.getUri().toASCIIString().equals(fs.getUri().toASCIIString())) {
    inDir=new Path("killjob/input");
    outDir=new Path("killjob/output");
  }
 else {
    inDir=new Path(TEST_ROOT_DIR,"input");
    outDir=new Path(TEST_ROOT_DIR,"output");
  }
  if (fs.exists(scriptDir)) {
    fs.delete(scriptDir,true);
  }
  conf.setNumMapTasks(1);
  conf.setNumReduceTasks(0);
  conf.set(JobConf.MAPRED_MAP_TASK_JAVA_OPTS,conf.get(JobConf.MAPRED_MAP_TASK_JAVA_OPTS,conf.get(JobConf.MAPRED_TASK_JAVA_OPTS)) + " -Dtest.build.data=" + BASE_TEST_ROOT_DIR);
  conf.set(JobConf.MAPRED_REDUCE_TASK_JAVA_OPTS,conf.get(JobConf.MAPRED_REDUCE_TASK_JAVA_OPTS,conf.get(JobConf.MAPRED_TASK_JAVA_OPTS)) + " -Dtest.build.data=" + BASE_TEST_ROOT_DIR);
  return UtilsForTests.runJob(conf,inDir,outDir);
}
