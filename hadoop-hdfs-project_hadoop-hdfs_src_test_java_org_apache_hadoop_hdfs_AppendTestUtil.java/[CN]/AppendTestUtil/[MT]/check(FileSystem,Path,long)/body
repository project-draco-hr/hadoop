{
  int i=-1;
  try {
    final FileStatus status=fs.getFileStatus(p);
    FSDataInputStream in=fs.open(p);
    if (in.getWrappedStream() instanceof DFSInputStream) {
      long len=((DFSInputStream)in.getWrappedStream()).getFileLength();
      TestCase.assertEquals(length,len);
    }
 else {
      TestCase.assertEquals(length,status.getLen());
    }
    for (i++; i < length; i++) {
      TestCase.assertEquals((byte)i,(byte)in.read());
    }
    i=-(int)length;
    TestCase.assertEquals(-1,in.read());
    in.close();
  }
 catch (  IOException ioe) {
    throw new IOException("p=" + p + ", length="+ length+ ", i="+ i,ioe);
  }
}
