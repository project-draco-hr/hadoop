{
  Path outputPath=getOutputPath(conf);
  if (outputPath == null) {
    throw new IOException("Undefined job output-path");
  }
  OutputCommitter committer=conf.getOutputCommitter();
  Path workPath=outputPath;
  TaskAttemptContext context=new TaskAttemptContextImpl(conf,TaskAttemptID.forName(conf.get(JobContext.TASK_ATTEMPT_ID)));
  if (committer instanceof FileOutputCommitter) {
    workPath=((FileOutputCommitter)committer).getWorkPath(context,outputPath);
  }
  return new Path(workPath,name);
}
