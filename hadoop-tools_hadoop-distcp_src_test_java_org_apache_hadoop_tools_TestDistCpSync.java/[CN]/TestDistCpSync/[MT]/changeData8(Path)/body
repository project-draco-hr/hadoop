{
  final Path foo=new Path(dir,"foo");
  final Path createdDir=new Path(dir,"c");
  final Path d1=new Path(dir,"d1");
  final Path d1_f1=new Path(d1,"f1");
  final Path createdDir_f1=new Path(createdDir,"f1");
  final Path foo_f3=new Path(foo,"f3");
  final Path new_foo=new Path(createdDir,"foo");
  final Path foo_f4=new Path(foo,"f4");
  final Path foo_d1=new Path(foo,"d1");
  final Path bar=new Path(dir,"bar");
  final Path bar1=new Path(dir,"bar1");
  int numCreatedModified=0;
  DFSTestUtil.createFile(dfs,foo_f3,BLOCK_SIZE,DATA_NUM,0L);
  numCreatedModified+=1;
  DFSTestUtil.createFile(dfs,createdDir_f1,BLOCK_SIZE,DATA_NUM,0L);
  numCreatedModified+=1;
  dfs.rename(createdDir_f1,foo_f4);
  numCreatedModified+=1;
  dfs.rename(d1_f1,createdDir_f1);
  numCreatedModified+=1;
  dfs.rename(d1,foo_d1);
  numCreatedModified+=1;
  dfs.rename(foo,new_foo);
  dfs.rename(bar,bar1);
  return numCreatedModified;
}
