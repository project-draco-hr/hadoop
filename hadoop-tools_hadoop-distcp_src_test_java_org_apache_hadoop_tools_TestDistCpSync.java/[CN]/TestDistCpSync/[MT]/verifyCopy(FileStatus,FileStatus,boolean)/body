{
  Assert.assertEquals(s.isDirectory(),t.isDirectory());
  if (compareName) {
    Assert.assertEquals(s.getPath().getName(),t.getPath().getName());
  }
  if (!s.isDirectory()) {
    byte[] sbytes=DFSTestUtil.readFileBuffer(dfs,s.getPath());
    byte[] tbytes=DFSTestUtil.readFileBuffer(dfs,t.getPath());
    Assert.assertArrayEquals(sbytes,tbytes);
  }
 else {
    FileStatus[] slist=dfs.listStatus(s.getPath());
    FileStatus[] tlist=dfs.listStatus(t.getPath());
    Assert.assertEquals(slist.length,tlist.length);
    for (int i=0; i < slist.length; i++) {
      verifyCopy(slist[i],tlist[i],true);
    }
  }
}
