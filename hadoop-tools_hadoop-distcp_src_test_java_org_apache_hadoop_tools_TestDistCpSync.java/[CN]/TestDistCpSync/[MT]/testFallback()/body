{
  Assert.assertFalse(DistCpSync.sync(options,conf));
  dfs.allowSnapshot(source);
  dfs.allowSnapshot(target);
  Assert.assertFalse(DistCpSync.sync(options,conf));
  dfs.createSnapshot(source,"s1");
  dfs.createSnapshot(source,"s2");
  dfs.createSnapshot(target,"s1");
  Assert.assertTrue(DistCpSync.sync(options,conf));
  options.setSourcePaths(Arrays.asList(source));
  final Path subTarget=new Path(target,"sub");
  dfs.mkdirs(subTarget);
  Assert.assertFalse(DistCpSync.sync(options,conf));
  dfs.delete(subTarget,true);
  Assert.assertTrue(DistCpSync.sync(options,conf));
}
