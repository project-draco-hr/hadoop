{
  Preconditions.checkState(commitOffset >= nextOffset,"commitOffset " + commitOffset + " less than nextOffset "+ nextOffset);
  long offset=nextOffset;
  Iterator<OffsetRange> it=pendingWrites.descendingKeySet().iterator();
  while (it.hasNext()) {
    OffsetRange range=it.next();
    if (range.getMin() != offset) {
      return false;
    }
    offset=range.getMax();
    if (offset > commitOffset) {
      return true;
    }
  }
  return false;
}
