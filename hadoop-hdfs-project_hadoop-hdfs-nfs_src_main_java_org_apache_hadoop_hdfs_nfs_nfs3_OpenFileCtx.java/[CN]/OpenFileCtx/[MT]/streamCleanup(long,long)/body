{
  if (streamTimeout < WriteManager.MINIMIUM_STREAM_TIMEOUT) {
    throw new InvalidParameterException("StreamTimeout" + streamTimeout + "ms is less than MINIMIUM_STREAM_TIMEOUT "+ WriteManager.MINIMIUM_STREAM_TIMEOUT+ "ms");
  }
  boolean flag=false;
  if (!ctxLock.tryLock()) {
    if (LOG.isTraceEnabled()) {
      LOG.trace("Another thread is working on it" + ctxLock.toString());
    }
    return flag;
  }
  try {
    if (checkStreamTimeout(streamTimeout)) {
      LOG.info("closing stream for fileId:" + fileId);
      cleanup();
      flag=true;
    }
  }
  finally {
    unlockCtx();
  }
  return flag;
}
