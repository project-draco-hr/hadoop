{
  Exception lastException;
  long endtime=System.currentTimeMillis() + timeout;
  do {
    try {
      callback.call();
      return;
    }
 catch (    InterruptedException|FailFastException e) {
      throw e;
    }
catch (    Exception e) {
      lastException=e;
    }
    Thread.sleep(500);
  }
 while (endtime > System.currentTimeMillis());
  throw lastException;
}
