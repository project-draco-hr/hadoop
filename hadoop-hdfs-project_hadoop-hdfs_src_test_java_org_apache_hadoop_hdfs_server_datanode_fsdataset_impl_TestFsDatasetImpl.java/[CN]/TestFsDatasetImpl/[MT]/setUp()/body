{
  final DataNode datanode=Mockito.mock(DataNode.class);
  storage=Mockito.mock(DataStorage.class);
  Configuration conf=new Configuration();
  final DNConf dnConf=new DNConf(conf);
  when(datanode.getConf()).thenReturn(conf);
  when(datanode.getDnConf()).thenReturn(dnConf);
  createStorageDirs(storage,conf,NUM_INIT_VOLUMES);
  dataset=new FsDatasetImpl(datanode,storage,conf);
  assertEquals(NUM_INIT_VOLUMES,dataset.getVolumes().size());
  assertEquals(0,dataset.getNumFailedVolumes());
}
