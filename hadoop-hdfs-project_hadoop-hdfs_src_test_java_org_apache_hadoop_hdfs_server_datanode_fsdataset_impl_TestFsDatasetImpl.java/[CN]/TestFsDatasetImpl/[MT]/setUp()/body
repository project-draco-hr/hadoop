{
  datanode=mock(DataNode.class);
  storage=mock(DataStorage.class);
  this.conf=new Configuration();
  this.conf.setLong(DFS_DATANODE_SCAN_PERIOD_HOURS_KEY,0);
  final DNConf dnConf=new DNConf(conf);
  when(datanode.getConf()).thenReturn(conf);
  when(datanode.getDnConf()).thenReturn(dnConf);
  final BlockScanner disabledBlockScanner=new BlockScanner(datanode,conf);
  when(datanode.getBlockScanner()).thenReturn(disabledBlockScanner);
  createStorageDirs(storage,conf,NUM_INIT_VOLUMES);
  dataset=new FsDatasetImpl(datanode,storage,conf);
  for (  String bpid : BLOCK_POOL_IDS) {
    dataset.addBlockPool(bpid,conf);
  }
  assertEquals(NUM_INIT_VOLUMES,dataset.getVolumes().size());
  assertEquals(0,dataset.getNumFailedVolumes());
}
