{
  CapBasedLoadManager manager=new CapBasedLoadManager();
  Configuration conf=new Configuration();
  conf.setFloat("mapred.fairscheduler.load.max.diff",maxDiff);
  manager.setConf(conf);
  TaskTrackerStatus ts=getTaskTrackerStatus(mapCap,1,runningMap,1);
  assertEquals("When maxDiff=" + maxDiff + ", with totalRunnableMap="+ totalRunnableMap+ " and totalMapSlots="+ totalMapSlots+ ", a tracker with runningMap="+ runningMap+ " and mapCap="+ mapCap+ " should "+ (expected ? "" : "not ")+ "be able to take more Maps.",expected,manager.canAssignMap(ts,totalRunnableMap,totalMapSlots));
}
