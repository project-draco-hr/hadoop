{
  CapBasedLoadManager manager=new CapBasedLoadManager();
  Configuration conf=new Configuration();
  conf.setFloat("mapred.fairscheduler.load.max.diff",maxDiff);
  manager.setConf(conf);
  TaskTrackerStatus ts=getTaskTrackerStatus(1,ReduceCap,1,runningReduce);
  assertEquals("When maxDiff=" + maxDiff + ", with totalRunnableReduce="+ totalRunnableReduce+ " and totalReduceSlots="+ totalReduceSlots+ ", a tracker with runningReduce="+ runningReduce+ " and ReduceCap="+ ReduceCap+ " should "+ (expected ? "" : "not ")+ "be able to take more Reduces.",expected,manager.canAssignReduce(ts,totalRunnableReduce,totalReduceSlots));
}
