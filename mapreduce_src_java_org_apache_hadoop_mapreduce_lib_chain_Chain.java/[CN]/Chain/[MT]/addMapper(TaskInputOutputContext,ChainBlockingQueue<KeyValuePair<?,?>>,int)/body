{
  Configuration conf=getConf(index);
  Class<?> keyOutClass=conf.getClass(MAPPER_OUTPUT_KEY_CLASS,Object.class);
  Class<?> valueOutClass=conf.getClass(MAPPER_OUTPUT_VALUE_CLASS,Object.class);
  RecordReader rr=new ChainRecordReader(inputContext);
  RecordWriter rw=new ChainRecordWriter(keyOutClass,valueOutClass,output,conf);
  Mapper.Context mapperContext=createMapContext(rr,rw,(MapContext)inputContext,getConf(index));
  MapRunner runner=new MapRunner(mappers.get(index),mapperContext,rr,rw);
  threads.add(runner);
}
