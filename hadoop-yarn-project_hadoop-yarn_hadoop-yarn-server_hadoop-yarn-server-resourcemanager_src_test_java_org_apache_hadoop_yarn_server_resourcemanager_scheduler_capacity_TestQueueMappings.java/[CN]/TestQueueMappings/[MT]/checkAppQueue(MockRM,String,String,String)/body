{
  RMApp app=resourceManager.submitApp(200,"name",user,new HashMap<ApplicationAccessType,String>(),false,submissionQueue,-1,null,"MAPREDUCE",false);
  RMAppState expectedState=expected.isEmpty() ? RMAppState.FAILED : RMAppState.ACCEPTED;
  resourceManager.waitForState(app.getApplicationId(),expectedState);
  CapacityScheduler cs=(CapacityScheduler)resourceManager.getResourceScheduler();
  SchedulerApplication schedulerApp=cs.getSchedulerApplications().get(app.getApplicationId());
  String queue="";
  if (schedulerApp != null) {
    queue=schedulerApp.getQueue().getQueueName();
  }
  Assert.assertTrue("expected " + expected + " actual "+ queue,expected.equals(queue));
  Assert.assertEquals(expected,app.getQueue());
}
