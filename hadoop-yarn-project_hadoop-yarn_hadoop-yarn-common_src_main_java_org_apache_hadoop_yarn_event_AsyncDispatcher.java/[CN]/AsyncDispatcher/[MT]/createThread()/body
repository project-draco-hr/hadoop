{
  return new Runnable(){
    @Override public void run(){
      while (!stopped && !Thread.currentThread().isInterrupted()) {
        drained=eventQueue.isEmpty();
        if (blockNewEvents) {
synchronized (waitForDrained) {
            if (drained) {
              waitForDrained.notify();
            }
          }
        }
        Event event;
        try {
          event=eventQueue.take();
        }
 catch (        InterruptedException ie) {
          if (!stopped) {
            LOG.warn("AsyncDispatcher thread interrupted",ie);
          }
          return;
        }
        if (event != null) {
          dispatch(event);
        }
      }
    }
  }
;
}
