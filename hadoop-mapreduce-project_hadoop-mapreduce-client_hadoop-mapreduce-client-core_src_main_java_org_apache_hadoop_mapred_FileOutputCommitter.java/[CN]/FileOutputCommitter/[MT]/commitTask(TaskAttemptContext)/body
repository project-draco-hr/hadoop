{
  Path taskOutputPath=getTempTaskOutputPath(context);
  TaskAttemptID attemptId=context.getTaskAttemptID();
  JobConf job=context.getJobConf();
  if (taskOutputPath != null) {
    FileSystem fs=taskOutputPath.getFileSystem(job);
    context.getProgressible().progress();
    if (fs.exists(taskOutputPath)) {
      JobConf conf=context.getJobConf();
      Path outputPath=FileOutputFormat.getOutputPath(conf);
      FileSystem outputFileSystem=outputPath.getFileSystem(conf);
      Path jobOutputPath=new Path(outputPath,getJobTempDirName(context));
      moveTaskOutputs(context,outputFileSystem,jobOutputPath,taskOutputPath);
      if (!fs.delete(taskOutputPath,true)) {
        LOG.info("Failed to delete the temporary output" + " directory of task: " + attemptId + " - "+ taskOutputPath);
      }
      LOG.info("Saved output of task '" + attemptId + "' to "+ jobOutputPath);
    }
  }
}
