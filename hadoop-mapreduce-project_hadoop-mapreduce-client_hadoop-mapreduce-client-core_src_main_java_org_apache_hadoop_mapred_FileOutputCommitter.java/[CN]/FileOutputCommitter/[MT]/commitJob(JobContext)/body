{
  JobConf conf=context.getJobConf();
  Path outputPath=FileOutputFormat.getOutputPath(conf);
  if (outputPath != null) {
    FileSystem outputFileSystem=outputPath.getFileSystem(conf);
    Path tmpDir=new Path(outputPath,getJobAttemptBaseDirName(context) + Path.SEPARATOR + FileOutputCommitter.TEMP_DIR_NAME);
    FileSystem fileSys=tmpDir.getFileSystem(context.getConfiguration());
    if (fileSys.exists(tmpDir)) {
      fileSys.delete(tmpDir,true);
    }
 else {
      LOG.warn("Task temp dir could not be deleted " + tmpDir);
    }
    Path jobOutputPath=new Path(outputPath,getJobAttemptBaseDirName(context));
    moveJobOutputs(outputFileSystem,jobOutputPath,outputPath,jobOutputPath);
    cleanupJob(context);
    if (shouldMarkOutputDir(context.getJobConf())) {
      markOutputDirSuccessful(context);
    }
  }
}
