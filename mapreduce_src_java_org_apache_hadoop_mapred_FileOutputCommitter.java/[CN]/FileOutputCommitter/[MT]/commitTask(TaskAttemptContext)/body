{
  Path taskOutputPath=getTempTaskOutputPath(context);
  TaskAttemptID attemptId=context.getTaskAttemptID();
  JobConf job=context.getJobConf();
  if (taskOutputPath != null) {
    FileSystem fs=taskOutputPath.getFileSystem(job);
    context.getProgressible().progress();
    if (fs.exists(taskOutputPath)) {
      Path jobOutputPath=taskOutputPath.getParent().getParent();
      moveTaskOutputs(context,fs,jobOutputPath,taskOutputPath);
      if (!fs.delete(taskOutputPath,true)) {
        LOG.info("Failed to delete the temporary output" + " directory of task: " + attemptId + " - "+ taskOutputPath);
      }
      LOG.info("Saved output of task '" + attemptId + "' to "+ jobOutputPath);
    }
  }
}
