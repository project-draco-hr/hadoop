{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Creating IOStreamPair of CryptoInputStream and " + "CryptoOutputStream.");
  }
  CryptoCodec codec=CryptoCodec.getInstance(conf,cipherOption.getCipherSuite());
  byte[] inKey=cipherOption.getInKey();
  byte[] inIv=cipherOption.getInIv();
  byte[] outKey=cipherOption.getOutKey();
  byte[] outIv=cipherOption.getOutIv();
  InputStream cIn=new CryptoInputStream(in,codec,isServer ? inKey : outKey,isServer ? inIv : outIv);
  OutputStream cOut=new CryptoOutputStream(out,codec,isServer ? outKey : inKey,isServer ? outIv : inIv);
  return new IOStreamPair(cIn,cOut);
}
