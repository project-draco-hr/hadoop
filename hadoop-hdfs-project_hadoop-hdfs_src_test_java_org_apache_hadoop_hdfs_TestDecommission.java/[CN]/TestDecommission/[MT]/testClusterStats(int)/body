{
  LOG.info("Starting test testClusterStats");
  int numDatanodes=1;
  startCluster(numNameNodes,numDatanodes,conf);
  for (int i=0; i < numNameNodes; i++) {
    FileSystem fileSys=cluster.getFileSystem(i);
    Path file=new Path("testClusterStats.dat");
    writeFile(fileSys,file,1);
    FSNamesystem fsn=cluster.getNamesystem(i);
    NameNode namenode=cluster.getNameNode(i);
    DatanodeInfo decomInfo=decommissionNode(i,null,null,AdminStates.DECOMMISSION_INPROGRESS);
    DataNode decomNode=getDataNode(decomInfo);
    verifyStats(namenode,fsn,decomInfo,decomNode,true);
    writeConfigFile(excludeFile,null);
    refreshNodes(fsn,conf);
    DatanodeInfo retInfo=NameNodeAdapter.getDatanode(fsn,decomInfo);
    DataNode retNode=getDataNode(decomInfo);
    waitNodeState(retInfo,AdminStates.NORMAL);
    verifyStats(namenode,fsn,retInfo,retNode,false);
  }
}
