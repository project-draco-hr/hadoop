{
  LOG.info("Starting test testClusterStats");
  int numDatanodes=1;
  startCluster(numNameNodes,numDatanodes);
  for (int i=0; i < numNameNodes; i++) {
    FileSystem fileSys=getCluster().getFileSystem(i);
    Path file=new Path("testClusterStats.dat");
    writeFile(fileSys,file,1);
    FSNamesystem fsn=getCluster().getNamesystem(i);
    NameNode namenode=getCluster().getNameNode(i);
    DatanodeInfo decomInfo=takeNodeOutofService(i,null,0,null,AdminStates.DECOMMISSION_INPROGRESS);
    DataNode decomNode=getDataNode(decomInfo);
    verifyStats(namenode,fsn,decomInfo,decomNode,true);
    DatanodeInfo retInfo=NameNodeAdapter.getDatanode(fsn,decomInfo);
    putNodeInService(i,retInfo);
    DataNode retNode=getDataNode(decomInfo);
    verifyStats(namenode,fsn,retInfo,retNode,false);
  }
}
