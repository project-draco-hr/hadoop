{
  LOG.info("Starting test testClusterStats");
  int numDatanodes=1;
  startCluster(numNameNodes,numDatanodes,conf);
  for (int i=0; i < numNameNodes; i++) {
    FileSystem fileSys=cluster.getFileSystem(i);
    Path file=new Path("testClusterStats.dat");
    writeFile(fileSys,file,1);
    FSNamesystem fsn=cluster.getNamesystem(i);
    NameNode namenode=cluster.getNameNode(i);
    DatanodeInfo downnode=decommissionNode(i,null,null,AdminStates.DECOMMISSION_INPROGRESS);
    verifyStats(namenode,fsn,downnode,true);
    writeConfigFile(excludeFile,null);
    refreshNodes(fsn,conf);
    DatanodeInfo ret=NameNodeAdapter.getDatanode(fsn,downnode);
    waitNodeState(ret,AdminStates.NORMAL);
    verifyStats(namenode,fsn,ret,false);
  }
}
