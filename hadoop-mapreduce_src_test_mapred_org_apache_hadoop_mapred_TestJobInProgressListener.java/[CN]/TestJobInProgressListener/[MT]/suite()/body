{
  TestSetup setup=new TestSetup(new TestSuite(TestJobInProgressListener.class)){
    @Override protected void setUp() throws Exception {
      conf=new JobConf();
      conf.setClass(JTConfig.JT_TASK_SCHEDULER,MyScheduler.class,TaskScheduler.class);
      mr=new MiniMRCluster(1,"file:///",1,null,null,conf);
      jobtracker=mr.getJobTrackerRunner().getJobTracker();
      myScheduler=(MyScheduler)jobtracker.getScheduler();
      conf=mr.createJobConf();
    }
    @Override protected void tearDown() throws Exception {
      conf=null;
      try {
        mr.shutdown();
      }
 catch (      Exception e) {
        LOG.info("Error in shutting down the MR cluster",e);
      }
      jobtracker=null;
      myScheduler.terminate();
    }
  }
;
  return setup;
}
