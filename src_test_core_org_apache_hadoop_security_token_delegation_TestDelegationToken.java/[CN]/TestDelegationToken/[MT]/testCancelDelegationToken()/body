{
  TestDelegationTokenSecretManager dtSecretManager=new TestDelegationTokenSecretManager(24 * 60 * 60* 1000,10 * 1000,1 * 1000,3600000);
  try {
    dtSecretManager.startThreads();
    Token<TestDelegationTokenIdentifier> token=generateDelegationToken(dtSecretManager,"SomeUser","JobTracker");
    Assert.assertFalse(dtSecretManager.cancelToken(token,"FakeCanceller"));
    Assert.assertTrue(dtSecretManager.cancelToken(token,"JobTracker"));
    Assert.assertFalse(dtSecretManager.renewToken(token,"JobTracker"));
  }
  finally {
    dtSecretManager.stopThreads();
  }
}
