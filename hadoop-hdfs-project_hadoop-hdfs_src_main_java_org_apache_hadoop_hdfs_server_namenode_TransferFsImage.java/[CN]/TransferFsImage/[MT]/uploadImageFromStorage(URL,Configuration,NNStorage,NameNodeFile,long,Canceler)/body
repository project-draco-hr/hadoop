{
  URL url=new URL(fsName,ImageServlet.PATH_SPEC);
  long startTime=Time.monotonicNow();
  try {
    uploadImage(url,conf,storage,nnf,txid,canceler);
  }
 catch (  HttpPutFailedException e) {
    if (e.getResponseCode() == HttpServletResponse.SC_CONFLICT) {
      LOG.info("Image upload with txid " + txid + " conflicted with a previous image upload to the "+ "same NameNode. Continuing...",e);
      return;
    }
 else {
      throw e;
    }
  }
  double xferSec=Math.max(((float)(Time.monotonicNow() - startTime)) / 1000.0,0.001);
  LOG.info("Uploaded image with txid " + txid + " to namenode at "+ fsName+ " in "+ xferSec+ " seconds");
}
