{
  URL url=new URL(fsName,ImageServlet.PATH_SPEC);
  long startTime=Time.monotonicNow();
  try {
    uploadImage(url,conf,storage,nnf,txid,canceler);
  }
 catch (  HttpPutFailedException e) {
    TransferResult result=TransferResult.getResultForCode(e.getResponseCode());
    if (result.shouldReThrowException) {
      throw e;
    }
    return result;
  }
  double xferSec=Math.max(((float)(Time.monotonicNow() - startTime)) / 1000.0,0.001);
  LOG.info("Uploaded image with txid " + txid + " to namenode at "+ fsName+ " in "+ xferSec+ " seconds");
  return TransferResult.SUCCESS;
}
