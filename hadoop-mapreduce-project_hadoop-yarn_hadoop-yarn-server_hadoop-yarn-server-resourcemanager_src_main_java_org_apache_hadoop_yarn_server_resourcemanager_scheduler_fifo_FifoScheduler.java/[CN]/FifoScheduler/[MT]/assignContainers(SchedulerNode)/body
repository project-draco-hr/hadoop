{
  LOG.debug("assignContainers:" + " node=" + node.getRMNode().getNodeAddress() + " #applications="+ applications.size());
  for (  Map.Entry<ApplicationAttemptId,SchedulerApp> e : applications.entrySet()) {
    SchedulerApp application=e.getValue();
    LOG.debug("pre-assignContainers");
    application.showRequests();
synchronized (application) {
      for (      Priority priority : application.getPriorities()) {
        int maxContainers=getMaxAllocatableContainers(application,priority,node,NodeType.OFF_SWITCH);
        if (maxContainers > 0) {
          int assignedContainers=assignContainersOnNode(node,application,priority);
          if (assignedContainers == 0) {
            break;
          }
        }
      }
    }
    application.setHeadroom(clusterResource);
    LOG.debug("post-assignContainers");
    application.showRequests();
    if (Resources.lessThan(node.getAvailableResource(),minimumAllocation)) {
      return;
    }
  }
}
