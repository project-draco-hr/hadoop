{
  SchedulerNode node=getNode(rmNode.getNodeID());
  for (  ContainerStatus launchedContainer : newlyLaunchedContainers) {
    containerLaunchedOnNode(launchedContainer.getContainerId(),node);
  }
  for (  ContainerStatus completedContainer : completedContainers) {
    ContainerId containerId=completedContainer.getContainerId();
    LOG.info("DEBUG --- Container FINISHED: " + containerId);
    containerCompleted(getRMContainer(containerId),completedContainer,RMContainerEventType.FINISHED);
  }
  if (Resources.greaterThanOrEqual(node.getAvailableResource(),minimumAllocation)) {
    LOG.info("Node heartbeat " + rmNode.getNodeID() + " available resource = "+ node.getAvailableResource());
    assignContainers(node);
    LOG.info("Node after allocation " + rmNode.getNodeID() + " resource = "+ node.getAvailableResource());
  }
  metrics.setAvailableResourcesToQueue(Resources.subtract(clusterResource,usedResource));
}
