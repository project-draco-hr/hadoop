{
  for (  FileMetadata file : this.getFiles()) {
    if (file.getBlobMaterialization() == BlobMaterialization.Explicit) {
      String srcName=file.getKey();
      String suffix=srcName.substring((this.getSrcKey()).length());
      String dstName=this.getDstKey() + suffix;
      boolean acquireLease=fs.getStoreInterface().isAtomicRenameKey(srcName);
      fs.getStoreInterface().rename(srcName,dstName,acquireLease,null);
    }
  }
  FileMetadata srcMetadata2=this.getSourceMetadata();
  if (srcMetadata2.getBlobMaterialization() == BlobMaterialization.Explicit) {
    fs.getStoreInterface().rename(this.getSrcKey(),this.getDstKey(),false,folderLease);
  }
  fs.updateParentFolderLastModifiedTime(srcKey);
  fs.updateParentFolderLastModifiedTime(dstKey);
}
