{
  Path srcFile=fullPath(srcKey,fileName);
  Path dstFile=fullPath(dstKey,fileName);
  boolean srcExists=fs.exists(srcFile);
  boolean dstExists=fs.exists(dstFile);
  if (srcExists && !dstExists) {
    String srcName=fs.pathToKey(srcFile);
    String dstName=fs.pathToKey(dstFile);
    fs.getStoreInterface().rename(srcName,dstName,true,null);
  }
 else   if (srcExists && dstExists) {
    String srcName=fs.pathToKey(srcFile);
    SelfRenewingLease lease=fs.acquireLease(srcFile);
    fs.getStoreInterface().delete(srcName,lease);
  }
 else   if (!srcExists && dstExists) {
    ;
  }
 else {
    throw new IOException("Attempting to complete rename of file " + srcKey + "/"+ fileName+ " during folder rename redo, and file was not found in source "+ "or destination.");
  }
}
