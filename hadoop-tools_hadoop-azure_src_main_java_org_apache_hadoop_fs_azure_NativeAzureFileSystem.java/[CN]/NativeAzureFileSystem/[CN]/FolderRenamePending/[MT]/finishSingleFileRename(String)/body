{
  Path srcFile=fullPath(srcKey,fileName);
  Path dstFile=fullPath(dstKey,fileName);
  boolean srcExists=fs.exists(srcFile);
  boolean dstExists=fs.exists(dstFile);
  if (srcExists && !dstExists) {
    String srcName=fs.pathToKey(srcFile);
    String dstName=fs.pathToKey(dstFile);
    fs.getStoreInterface().rename(srcName,dstName,true,null);
  }
 else   if (srcExists && dstExists) {
    String srcName=fs.pathToKey(srcFile);
    SelfRenewingLease lease=null;
    try {
      lease=fs.acquireLease(srcFile);
      fs.getStoreInterface().delete(srcName,lease);
    }
 catch (    AzureException e) {
      String errorCode="";
      try {
        StorageException e2=(StorageException)e.getCause();
        errorCode=e2.getErrorCode();
      }
 catch (      Exception e3) {
      }
      if (!errorCode.equals("BlobNotFound")) {
        throw e;
      }
    }
 finally {
      try {
        if (lease != null) {
          lease.free();
        }
      }
 catch (      StorageException e) {
        LOG.warn("Unable to free lease because: " + e.getMessage());
      }
    }
  }
 else   if (!srcExists && dstExists) {
    ;
  }
 else {
    throw new IOException("Attempting to complete rename of file " + srcKey + "/"+ fileName+ " during folder rename redo, and file was not found in source "+ "or destination.");
  }
}
