{
  Path path=getRenamePendingFilePath();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Preparing to write atomic rename state to " + path.toString());
  }
  OutputStream output=null;
  String contents=makeRenamePendingFileContents();
  try {
    output=fs.create(path);
    output.write(contents.getBytes(Charset.forName("UTF-8")));
  }
 catch (  IOException e) {
    throw new IOException("Unable to write RenamePending file for folder rename from " + srcKey + " to "+ dstKey,e);
  }
 finally {
    IOUtils.cleanup(LOG,output);
  }
}
