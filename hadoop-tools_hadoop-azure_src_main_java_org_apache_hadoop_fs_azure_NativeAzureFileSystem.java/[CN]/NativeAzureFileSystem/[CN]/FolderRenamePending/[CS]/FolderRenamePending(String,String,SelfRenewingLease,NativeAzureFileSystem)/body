{
  this.srcKey=srcKey;
  this.dstKey=dstKey;
  this.folderLease=lease;
  this.fs=fs;
  ArrayList<FileMetadata> fileMetadataList=new ArrayList<FileMetadata>();
  String priorLastKey=null;
  do {
    PartialListing listing=fs.getStoreInterface().listAll(srcKey,AZURE_LIST_ALL,AZURE_UNBOUNDED_DEPTH,priorLastKey);
    for (    FileMetadata file : listing.getFiles()) {
      fileMetadataList.add(file);
    }
    priorLastKey=listing.getPriorLastKey();
  }
 while (priorLastKey != null);
  fileMetadata=fileMetadataList.toArray(new FileMetadata[fileMetadataList.size()]);
  this.committed=true;
}
