{
  LOG.debug("Getting the file status for {}",f.toString());
  Path absolutePath=makeAbsolute(f);
  String key=pathToKey(absolutePath);
  if (key.length() == 0) {
    return newDirectory(null,absolutePath);
  }
  FileMetadata meta=null;
  try {
    meta=store.retrieveMetadata(key);
  }
 catch (  Exception ex) {
    Throwable innerException=NativeAzureFileSystem.checkForAzureStorageException(ex);
    if (innerException instanceof StorageException && NativeAzureFileSystem.isFileNotFoundException((StorageException)innerException)) {
      throw new FileNotFoundException(String.format("%s is not found",key));
    }
    throw ex;
  }
  if (meta != null) {
    if (meta.isDir()) {
      LOG.debug("Path {} is a folder.",f.toString());
      if (conditionalRedoFolderRename(f)) {
        throw new FileNotFoundException(absolutePath + ": No such file or directory.");
      }
      return newDirectory(meta,absolutePath);
    }
    LOG.debug("Found the path: {} as a file.",f.toString());
    return newFile(meta,absolutePath);
  }
  throw new FileNotFoundException(absolutePath + ": No such file or directory.");
}
