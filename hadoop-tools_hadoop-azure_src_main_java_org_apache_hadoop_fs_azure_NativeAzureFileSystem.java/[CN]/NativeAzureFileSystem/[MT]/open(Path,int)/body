{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Opening file: " + f.toString());
  }
  Path absolutePath=makeAbsolute(f);
  String key=pathToKey(absolutePath);
  FileMetadata meta=store.retrieveMetadata(key);
  if (meta == null) {
    throw new FileNotFoundException(f.toString());
  }
  if (meta.isDir()) {
    throw new FileNotFoundException(f.toString() + " is a directory not a file.");
  }
  return new FSDataInputStream(new BufferedFSInputStream(new NativeAzureFsInputStream(store.retrieve(key),key,meta.getLength()),bufferSize));
}
