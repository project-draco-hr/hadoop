{
  conf=new FairSchedulerConfiguration();
  FairScheduler scheduler=mock(FairScheduler.class);
  AllocationConfiguration allocConf=new AllocationConfiguration(conf);
  when(scheduler.getAllocationConfiguration()).thenReturn(allocConf);
  when(scheduler.getConf()).thenReturn(conf);
  SystemClock clock=new SystemClock();
  when(scheduler.getClock()).thenReturn(clock);
  notEmptyQueues=new HashSet<FSQueue>();
  queueManager=new QueueManager(scheduler){
    @Override public boolean isEmpty(    FSQueue queue){
      return !notEmptyQueues.contains(queue);
    }
  }
;
  FSQueueMetrics.forQueue("root",null,true,conf);
  queueManager.initialize(conf);
}
