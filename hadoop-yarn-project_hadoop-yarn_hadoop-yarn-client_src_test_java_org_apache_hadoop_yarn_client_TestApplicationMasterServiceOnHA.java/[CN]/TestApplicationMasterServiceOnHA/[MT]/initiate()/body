{
  startHACluster(0,false,false,true);
  attemptId=this.cluster.createFakeApplicationAttemptId();
  amClient=ClientRMProxy.createRMProxy(this.conf,ApplicationMasterProtocol.class);
  AMRMTokenIdentifier id=new AMRMTokenIdentifier(attemptId);
  Token<AMRMTokenIdentifier> appToken=new Token<AMRMTokenIdentifier>(id,this.cluster.getResourceManager().getRMContext().getAMRMTokenSecretManager());
  appToken.setService(new Text("appToken service"));
  UserGroupInformation.setLoginUser(UserGroupInformation.createRemoteUser(UserGroupInformation.getCurrentUser().getUserName()));
  UserGroupInformation.getCurrentUser().addToken(appToken);
  syncToken(appToken);
}
