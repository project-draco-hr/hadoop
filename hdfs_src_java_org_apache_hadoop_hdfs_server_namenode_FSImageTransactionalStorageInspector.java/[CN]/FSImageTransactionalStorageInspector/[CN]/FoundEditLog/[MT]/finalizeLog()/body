{
  long numTransactions=validateLog().numTransactions;
  long lastTxId=startTxId + numTransactions - 1;
  File dst=new File(file.getParentFile(),NNStorage.getFinalizedEditsFileName(startTxId,lastTxId));
  LOG.info("Finalizing edits log " + file + " by renaming to "+ dst.getName());
  if (!file.renameTo(dst)) {
    throw new IOException("Couldn't finalize log " + file + " to "+ dst);
  }
  this.lastTxId=lastTxId;
  file=dst;
}
