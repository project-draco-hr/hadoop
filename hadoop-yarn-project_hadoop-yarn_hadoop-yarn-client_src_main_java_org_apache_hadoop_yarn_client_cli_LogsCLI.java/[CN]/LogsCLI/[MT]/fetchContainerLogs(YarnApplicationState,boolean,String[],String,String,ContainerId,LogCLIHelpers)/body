{
  int resultCode=0;
  String appIdStr=containerId.getApplicationAttemptId().getApplicationId().toString();
  String containerIdStr=containerId.toString();
  if (nodeAddress != null && (!appStateObtainedSuccessfully || isApplicationFinished(appState))) {
    List<String> logs;
    if (logFiles == null) {
      logs=null;
    }
 else     if (fetchAllLogFiles(logFiles)) {
      logs=null;
    }
 else {
      logs=Arrays.asList(logFiles);
    }
    return logCliHelper.dumpAContainersLogsForALogType(appIdStr,containerIdStr,nodeAddress,appOwner,logs);
  }
  String nodeHttpAddress=null;
  String nodeId=null;
  try {
    ContainerReport report=getContainerReport(containerIdStr);
    nodeHttpAddress=report.getNodeHttpAddress().replaceFirst(WebAppUtils.getHttpSchemePrefix(getConf()),"");
    nodeId=report.getAssignedNode().toString();
  }
 catch (  IOException|YarnException ex) {
    if (!appStateObtainedSuccessfully || isApplicationFinished(appState)) {
      String[] requestedLogFiles=logFiles;
      if (fetchAllLogFiles(logFiles)) {
        requestedLogFiles=null;
      }
      return printContainerLogsForFinishedApplicationWithoutNodeId(appIdStr,containerIdStr,requestedLogFiles,logCliHelper,appOwner);
    }
 else     if (!isApplicationFinished(appState)) {
      System.err.println("Unable to get logs for this container:" + containerIdStr + "for the application:"+ appIdStr);
      System.err.println("The application: " + appIdStr + " is still running, and we can not get Container report "+ "for the container: "+ containerIdStr+ ". Please try later "+ "or after the application finishes.");
      return -1;
    }
  }
  if (!isApplicationFinished(appState)) {
    if (logFiles == null || logFiles.length == 0) {
      logFiles=new String[]{"syslog"};
    }
    printContainerLogsFromRunningApplication(getConf(),containerId,nodeHttpAddress,nodeId,logFiles,logCliHelper,appOwner);
  }
 else {
    String[] requestedLogFiles=logFiles;
    if (fetchAllLogFiles(logFiles)) {
      requestedLogFiles=null;
    }
    printContainerLogsForFinishedApplication(appIdStr,containerIdStr,nodeId,requestedLogFiles,logCliHelper,appOwner);
  }
  return resultCode;
}
