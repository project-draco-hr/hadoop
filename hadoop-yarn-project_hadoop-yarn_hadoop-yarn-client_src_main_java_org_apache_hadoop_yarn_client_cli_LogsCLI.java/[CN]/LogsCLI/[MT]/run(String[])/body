{
  Options opts=createCommandOpts();
  Options printOpts=createPrintOpts(opts);
  if (args.length < 1) {
    printHelpMessage(printOpts);
    return -1;
  }
  if (args[0].equals("-help")) {
    printHelpMessage(printOpts);
    return 0;
  }
  CommandLineParser parser=new GnuParser();
  String appIdStr=null;
  String containerIdStr=null;
  String nodeAddress=null;
  String appOwner=null;
  boolean getAMContainerLogs=false;
  boolean showMetaInfo=false;
  boolean nodesList=false;
  String[] logFiles=null;
  List<String> amContainersList=new ArrayList<String>();
  String localDir=null;
  long bytes=Long.MAX_VALUE;
  try {
    CommandLine commandLine=parser.parse(opts,args,true);
    appIdStr=commandLine.getOptionValue(APPLICATION_ID_OPTION);
    containerIdStr=commandLine.getOptionValue(CONTAINER_ID_OPTION);
    nodeAddress=commandLine.getOptionValue(NODE_ADDRESS_OPTION);
    appOwner=commandLine.getOptionValue(APP_OWNER_OPTION);
    getAMContainerLogs=commandLine.hasOption(AM_CONTAINER_OPTION);
    showMetaInfo=commandLine.hasOption(SHOW_META_INFO);
    nodesList=commandLine.hasOption(LIST_NODES_OPTION);
    localDir=commandLine.getOptionValue(OUT_OPTION);
    if (getAMContainerLogs) {
      try {
        amContainersList=parseAMContainer(commandLine,printOpts);
      }
 catch (      NumberFormatException ex) {
        System.err.println(ex.getMessage());
        return -1;
      }
    }
    if (commandLine.hasOption(CONTAINER_LOG_FILES)) {
      logFiles=commandLine.getOptionValues(CONTAINER_LOG_FILES);
    }
    if (commandLine.hasOption(SIZE_OPTION)) {
      bytes=Long.parseLong(commandLine.getOptionValue(SIZE_OPTION));
    }
  }
 catch (  ParseException e) {
    System.err.println("options parsing failed: " + e.getMessage());
    printHelpMessage(printOpts);
    return -1;
  }
  if (appIdStr == null) {
    System.err.println("ApplicationId cannot be null!");
    printHelpMessage(printOpts);
    return -1;
  }
  ApplicationId appId=null;
  try {
    appId=ApplicationId.fromString(appIdStr);
  }
 catch (  Exception e) {
    System.err.println("Invalid ApplicationId specified");
    return -1;
  }
  LogCLIHelpers logCliHelper=new LogCLIHelpers();
  logCliHelper.setConf(getConf());
  YarnApplicationState appState=YarnApplicationState.NEW;
  ApplicationReport appReport=null;
  try {
    appReport=getApplicationReport(appId);
    appState=appReport.getYarnApplicationState();
    if (appState == YarnApplicationState.NEW || appState == YarnApplicationState.NEW_SAVING || appState == YarnApplicationState.SUBMITTED) {
      System.err.println("Logs are not avaiable right now.");
      return -1;
    }
  }
 catch (  IOException|YarnException e) {
    appState=YarnApplicationState.FINISHED;
    System.err.println("Unable to get ApplicationState." + " Attempting to fetch logs directly from the filesystem.");
  }
  if (appOwner == null || appOwner.isEmpty()) {
    appOwner=guessAppOwner(appReport,appId);
    if (appOwner == null) {
      System.err.println("Can not find the appOwner. " + "Please specify the correct appOwner");
      System.err.println("Could not locate application logs for " + appId);
      return -1;
    }
  }
  List<String> logs=new ArrayList<String>();
  if (fetchAllLogFiles(logFiles)) {
    logs.add(".*");
  }
 else   if (logFiles != null && logFiles.length > 0) {
    logs=Arrays.asList(logFiles);
  }
  ContainerLogsRequest request=new ContainerLogsRequest(appId,isApplicationFinished(appState),appOwner,nodeAddress,null,containerIdStr,localDir,logs,bytes);
  if (showMetaInfo) {
    return showMetaInfo(request,logCliHelper);
  }
  if (nodesList) {
    return showNodeLists(request,logCliHelper);
  }
  if (getAMContainerLogs) {
    return fetchAMContainerLogs(request,amContainersList,logCliHelper);
  }
  int resultCode=0;
  if (containerIdStr != null) {
    ContainerId containerId=ContainerId.fromString(containerIdStr);
    if (!containerId.getApplicationAttemptId().getApplicationId().equals(appId)) {
      System.err.println("The Application:" + appId + " does not have the container:"+ containerId);
      return -1;
    }
    return fetchContainerLogs(request,logCliHelper);
  }
 else {
    if (nodeAddress == null) {
      resultCode=fetchApplicationLogs(request,logCliHelper);
    }
 else {
      System.err.println("Should at least provide ContainerId!");
      printHelpMessage(printOpts);
      resultCode=-1;
    }
  }
  return resultCode;
}
