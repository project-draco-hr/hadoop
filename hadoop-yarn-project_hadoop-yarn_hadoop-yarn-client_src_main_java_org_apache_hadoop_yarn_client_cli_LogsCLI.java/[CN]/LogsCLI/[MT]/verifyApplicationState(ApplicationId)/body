{
  YarnClient yarnClient=createYarnClient();
  try {
    ApplicationReport appReport=yarnClient.getApplicationReport(appId);
switch (appReport.getYarnApplicationState()) {
case NEW:
case NEW_SAVING:
case SUBMITTED:
      return -1;
case ACCEPTED:
case RUNNING:
case FAILED:
case FINISHED:
case KILLED:
default :
    break;
}
}
  finally {
yarnClient.close();
}
return 0;
}
