{
  final BlockStoragePolicy policy=blockStoragePolicies.getPolicy(status.getStoragePolicy());
  final List<StorageType> types=policy.chooseStorageTypes(status.getReplication());
  final LocatedBlocks locatedBlocks=status.getBlockLocations();
  boolean hasRemaining=false;
  for (  LocatedBlock lb : locatedBlocks.getLocatedBlocks()) {
    final StorageTypeDiff diff=new StorageTypeDiff(types,lb.getStorageTypes());
    if (!diff.removeOverlap()) {
      if (scheduleMoves4Block(diff,lb)) {
        hasRemaining|=(diff.existing.size() > 1 && diff.expected.size() > 1);
      }
    }
  }
  return hasRemaining;
}
