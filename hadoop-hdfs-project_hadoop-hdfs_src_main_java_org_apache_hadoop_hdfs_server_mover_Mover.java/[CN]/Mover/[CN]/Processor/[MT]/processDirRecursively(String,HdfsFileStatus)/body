{
  if (status.isSymlink()) {
    return;
  }
 else   if (status.isDir()) {
    String dir=status.getFullName(parent);
    if (!dir.endsWith(Path.SEPARATOR)) {
      dir=dir + Path.SEPARATOR;
    }
    for (byte[] lastReturnedName=HdfsFileStatus.EMPTY_NAME; ; ) {
      final DirectoryListing children;
      try {
        children=dfs.listPaths(dir,lastReturnedName,true);
      }
 catch (      IOException e) {
        LOG.warn("Failed to list directory " + dir + ".  Ignore the directory and continue.",e);
        return;
      }
      if (children == null) {
        return;
      }
      for (      HdfsFileStatus child : children.getPartialListing()) {
        processDirRecursively(dir,child);
      }
      if (!children.hasMore()) {
        lastReturnedName=children.getLastName();
      }
 else {
        return;
      }
    }
  }
 else {
    processFile(parent,(HdfsLocatedFileStatus)status);
  }
}
