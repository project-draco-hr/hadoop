{
  final BlockStoragePolicy policy=blockStoragePolicies.getPolicy(status.getStoragePolicy());
  final List<StorageType> types=policy.chooseStorageTypes(status.getReplication());
  final LocatedBlocks locations=status.getBlockLocations();
  for (  LocatedBlock lb : locations.getLocatedBlocks()) {
    final StorageTypeDiff diff=new StorageTypeDiff(types,lb.getStorageTypes());
    if (!diff.removeOverlap()) {
      scheduleMoves4Block(diff,lb);
    }
  }
}
