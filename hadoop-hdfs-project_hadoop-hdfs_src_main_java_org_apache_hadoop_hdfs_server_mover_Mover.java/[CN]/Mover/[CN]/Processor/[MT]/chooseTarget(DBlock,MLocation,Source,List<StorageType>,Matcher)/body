{
  final NetworkTopology cluster=dispatcher.getCluster();
  for (final Iterator<StorageType> i=targetTypes.iterator(); i.hasNext(); ) {
    final StorageType t=i.next();
    for (    StorageGroup target : storages.getTargetStorages(t)) {
      if (matcher.match(cluster,ml.datanode,target.getDatanodeInfo())) {
        final PendingMove pm=source.addPendingMove(db,target);
        if (pm != null) {
          i.remove();
          dispatcher.executePendingMove(pm);
          return true;
        }
      }
    }
  }
  return false;
}
