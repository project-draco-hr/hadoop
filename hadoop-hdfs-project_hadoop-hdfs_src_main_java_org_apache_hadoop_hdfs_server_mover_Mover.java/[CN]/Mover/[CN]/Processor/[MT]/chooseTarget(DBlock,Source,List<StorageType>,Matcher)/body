{
  final NetworkTopology cluster=dispatcher.getCluster();
  for (  StorageType t : targetTypes) {
    final List<StorageGroup> targets=storages.getTargetStorages(t);
    Collections.shuffle(targets);
    for (    StorageGroup target : targets) {
      if (matcher.match(cluster,source.getDatanodeInfo(),target.getDatanodeInfo())) {
        final PendingMove pm=source.addPendingMove(db,target);
        if (pm != null) {
          dispatcher.executePendingMove(pm);
          return true;
        }
      }
    }
  }
  return false;
}
