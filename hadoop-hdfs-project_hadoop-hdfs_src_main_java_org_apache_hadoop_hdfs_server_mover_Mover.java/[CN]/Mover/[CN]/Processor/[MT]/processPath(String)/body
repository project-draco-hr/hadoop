{
  boolean hasRemaining=false;
  for (byte[] lastReturnedName=HdfsFileStatus.EMPTY_NAME; ; ) {
    final DirectoryListing children;
    try {
      children=dfs.listPaths(fullPath,lastReturnedName,true);
    }
 catch (    IOException e) {
      LOG.warn("Failed to list directory " + fullPath + ". Ignore the directory and continue.",e);
      return hasRemaining;
    }
    if (children == null) {
      return hasRemaining;
    }
    for (    HdfsFileStatus child : children.getPartialListing()) {
      hasRemaining|=processRecursively(fullPath,child);
    }
    if (children.hasMore()) {
      lastReturnedName=children.getLastName();
    }
 else {
      return hasRemaining;
    }
  }
}
