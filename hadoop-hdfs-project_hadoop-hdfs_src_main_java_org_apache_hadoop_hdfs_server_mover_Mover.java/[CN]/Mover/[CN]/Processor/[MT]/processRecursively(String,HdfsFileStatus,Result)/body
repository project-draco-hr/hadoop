{
  String fullPath=status.getFullName(parent);
  if (status.isDir()) {
    if (!fullPath.endsWith(Path.SEPARATOR)) {
      fullPath=fullPath + Path.SEPARATOR;
    }
    processPath(fullPath,result);
    if (snapshottableDirs.contains(fullPath)) {
      final String dirSnapshot=fullPath + HdfsConstants.DOT_SNAPSHOT_DIR;
      processPath(dirSnapshot,result);
    }
  }
 else   if (!status.isSymlink()) {
    try {
      if (!isSnapshotPathInCurrent(fullPath)) {
        processFile(fullPath,(HdfsLocatedFileStatus)status,result);
      }
    }
 catch (    IOException e) {
      LOG.warn("Failed to check the status of " + parent + ". Ignore it and continue.",e);
    }
  }
}
