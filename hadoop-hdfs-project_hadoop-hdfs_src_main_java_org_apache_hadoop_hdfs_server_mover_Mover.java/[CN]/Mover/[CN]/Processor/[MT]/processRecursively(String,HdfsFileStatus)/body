{
  String fullPath=status.getFullName(parent);
  boolean hasRemaining=false;
  if (status.isDir()) {
    if (!fullPath.endsWith(Path.SEPARATOR)) {
      fullPath=fullPath + Path.SEPARATOR;
    }
    hasRemaining=processPath(fullPath);
    if (snapshottableDirs.contains(fullPath)) {
      final String dirSnapshot=fullPath + HdfsConstants.DOT_SNAPSHOT_DIR;
      hasRemaining|=processPath(dirSnapshot);
    }
  }
 else   if (!status.isSymlink()) {
    try {
      if (!isSnapshotPathInCurrent(fullPath)) {
        hasRemaining=processFile(fullPath,(HdfsLocatedFileStatus)status);
      }
    }
 catch (    IOException e) {
      LOG.warn("Failed to check the status of " + parent + ". Ignore it and continue.",e);
      return false;
    }
  }
  return hasRemaining;
}
