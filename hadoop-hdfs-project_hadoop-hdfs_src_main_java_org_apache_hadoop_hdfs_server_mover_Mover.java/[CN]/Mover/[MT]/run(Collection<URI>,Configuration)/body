{
  final long sleeptime=2000 * conf.getLong(DFSConfigKeys.DFS_HEARTBEAT_INTERVAL_KEY,DFSConfigKeys.DFS_HEARTBEAT_INTERVAL_DEFAULT);
  LOG.info("namenodes = " + namenodes);
  List<NameNodeConnector> connectors=Collections.emptyList();
  try {
    connectors=NameNodeConnector.newNameNodeConnectors(namenodes,Mover.class.getSimpleName(),MOVER_ID_PATH,conf);
    while (true) {
      Collections.shuffle(connectors);
      for (      NameNodeConnector nnc : connectors) {
        final Mover m=new Mover(nnc,conf);
        final ExitStatus r=m.run();
        if (r != ExitStatus.IN_PROGRESS) {
          return r.getExitCode();
        }
      }
      Thread.sleep(sleeptime);
    }
  }
  finally {
    for (    NameNodeConnector nnc : connectors) {
      IOUtils.cleanup(LOG,nnc);
    }
  }
}
