{
  boolean close=false;
  TaskStatus ts=taskStatuses.get(taskid);
  if ((ts != null) && (!tasksReportedClosed.contains(taskid)) && ((this.failed) || ((job.getStatus().getRunState() != JobStatus.RUNNING && (job.getStatus().getRunState() != JobStatus.PREP))))) {
    tasksReportedClosed.add(taskid);
    close=true;
  }
 else   if (isComplete() && !(isMapTask() && !jobSetup && !jobCleanup&& isComplete(taskid)) && !tasksReportedClosed.contains(taskid)) {
    tasksReportedClosed.add(taskid);
    close=true;
    if (isComplete() && !isComplete(taskid)) {
      addDiagnosticInfo(taskid,"Another (possibly speculative) attempt" + " already SUCCEEDED");
    }
  }
 else   if (isCommitPending(taskid) && !shouldCommit(taskid) && !tasksReportedClosed.contains(taskid)) {
    tasksReportedClosed.add(taskid);
    addDiagnosticInfo(taskid,"Another (possibly speculative) attempt" + " went to COMMIT_PENDING state earlier");
    close=true;
  }
 else {
    close=tasksToKill.keySet().contains(taskid);
  }
  return close;
}
