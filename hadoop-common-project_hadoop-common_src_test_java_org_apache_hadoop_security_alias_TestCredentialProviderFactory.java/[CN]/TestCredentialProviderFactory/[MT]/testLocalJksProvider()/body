{
  Configuration conf=new Configuration();
  final Path jksPath=new Path(tmpDir.toString(),"test.jks");
  final String ourUrl=LocalJavaKeyStoreProvider.SCHEME_NAME + "://file" + jksPath.toUri();
  File file=new File(tmpDir,"test.jks");
  file.delete();
  conf.set(CredentialProviderFactory.CREDENTIAL_PROVIDER_PATH,ourUrl);
  checkSpecificProvider(conf,ourUrl);
  Path path=ProviderUtils.unnestUri(new URI(ourUrl));
  FileSystem fs=path.getFileSystem(conf);
  FileStatus s=fs.getFileStatus(path);
  assertTrue("Unexpected permissions: " + s.getPermission().toString(),s.getPermission().toString().equals("rwx------"));
  assertTrue(file + " should exist",file.isFile());
  fs.setPermission(path,new FsPermission("777"));
  checkPermissionRetention(conf,ourUrl,path);
}
