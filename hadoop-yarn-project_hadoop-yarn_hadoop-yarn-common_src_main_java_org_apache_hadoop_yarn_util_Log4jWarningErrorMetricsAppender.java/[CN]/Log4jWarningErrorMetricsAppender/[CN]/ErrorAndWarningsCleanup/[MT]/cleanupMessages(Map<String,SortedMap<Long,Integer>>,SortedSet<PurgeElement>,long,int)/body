{
  PurgeElement el=new PurgeElement("",cutoff);
synchronized (lock) {
    SortedSet<PurgeElement> removeSet=purgeInformation.headSet(el);
    Iterator<PurgeElement> it=removeSet.iterator();
    while (it.hasNext()) {
      PurgeElement p=it.next();
      map.remove(p.message);
      it.remove();
    }
    if (purgeInformation.size() > mapTargetSize) {
      Object[] array=purgeInformation.toArray();
      int cutoffIndex=purgeInformation.size() - mapTargetSize;
      for (int i=0; i < cutoffIndex; ++i) {
        PurgeElement p=(PurgeElement)array[i];
        map.remove(p.message);
        purgeInformation.remove(p);
      }
    }
  }
}
