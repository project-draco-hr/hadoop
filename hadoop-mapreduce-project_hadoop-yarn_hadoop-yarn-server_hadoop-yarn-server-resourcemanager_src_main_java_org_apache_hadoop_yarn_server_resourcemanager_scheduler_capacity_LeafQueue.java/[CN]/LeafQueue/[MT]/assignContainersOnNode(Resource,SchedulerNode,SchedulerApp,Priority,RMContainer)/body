{
  Resource assigned=Resources.none();
  assigned=assignNodeLocalContainers(clusterResource,node,application,priority,reservedContainer);
  if (Resources.greaterThan(assigned,Resources.none())) {
    return new CSAssignment(assigned,NodeType.NODE_LOCAL);
  }
  assigned=assignRackLocalContainers(clusterResource,node,application,priority,reservedContainer);
  if (Resources.greaterThan(assigned,Resources.none())) {
    return new CSAssignment(assigned,NodeType.RACK_LOCAL);
  }
  return new CSAssignment(assignOffSwitchContainers(clusterResource,node,application,priority,reservedContainer),NodeType.OFF_SWITCH);
}
