{
  Container container=BuilderUtils.newContainer(this.recordFactory,application.getApplicationAttemptId(),application.getNewContainerId(),node.getNodeID(),node.getHttpAddress(),capability,priority);
  if (UserGroupInformation.isSecurityEnabled()) {
    ContainerToken containerToken=this.recordFactory.newRecordInstance(ContainerToken.class);
    ContainerTokenIdentifier tokenidentifier=new ContainerTokenIdentifier(container.getId(),container.getNodeId().toString(),container.getResource());
    containerToken.setIdentifier(ByteBuffer.wrap(tokenidentifier.getBytes()));
    containerToken.setKind(ContainerTokenIdentifier.KIND.toString());
    containerToken.setPassword(ByteBuffer.wrap(containerTokenSecretManager.createPassword(tokenidentifier)));
    containerToken.setService(container.getNodeId().toString());
    container.setContainerToken(containerToken);
  }
  return container;
}
