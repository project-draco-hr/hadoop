{
  NodeId nodeId=node.getRMNode().getNodeID();
  ContainerId containerId=BuilderUtils.newContainerId(application.getApplicationAttemptId(),application.getNewContainerId());
  ContainerToken containerToken=null;
  if (UserGroupInformation.isSecurityEnabled()) {
    ContainerTokenIdentifier tokenIdentifier=new ContainerTokenIdentifier(containerId,nodeId.toString(),capability);
    try {
      containerToken=BuilderUtils.newContainerToken(nodeId,ByteBuffer.wrap(containerTokenSecretManager.createPassword(tokenIdentifier)),tokenIdentifier);
    }
 catch (    IllegalArgumentException e) {
      LOG.error("Error trying to create new container",e);
      return null;
    }
  }
  Container container=BuilderUtils.newContainer(containerId,nodeId,node.getRMNode().getHttpAddress(),capability,priority,containerToken);
  return container;
}
