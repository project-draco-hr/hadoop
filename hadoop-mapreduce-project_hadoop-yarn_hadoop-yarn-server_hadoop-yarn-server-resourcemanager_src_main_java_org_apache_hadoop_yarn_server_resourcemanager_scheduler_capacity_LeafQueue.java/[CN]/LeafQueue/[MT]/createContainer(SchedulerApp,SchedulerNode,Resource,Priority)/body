{
  Container container=BuilderUtils.newContainer(this.recordFactory,application.getApplicationAttemptId(),application.getNewContainerId(),node.getNodeID(),node.getHttpAddress(),capability,priority);
  if (UserGroupInformation.isSecurityEnabled()) {
    ContainerToken containerToken=this.recordFactory.newRecordInstance(ContainerToken.class);
    NodeId nodeId=container.getNodeId();
    ContainerTokenIdentifier tokenidentifier=new ContainerTokenIdentifier(container.getId(),nodeId.toString(),container.getResource());
    containerToken.setIdentifier(ByteBuffer.wrap(tokenidentifier.getBytes()));
    containerToken.setKind(ContainerTokenIdentifier.KIND.toString());
    containerToken.setPassword(ByteBuffer.wrap(containerTokenSecretManager.createPassword(tokenidentifier)));
    InetSocketAddress addr=NetUtils.createSocketAddr(nodeId.getHost(),nodeId.getPort());
    containerToken.setService(addr.getAddress().getHostAddress() + ":" + addr.getPort());
    container.setContainerToken(containerToken);
  }
  return container;
}
