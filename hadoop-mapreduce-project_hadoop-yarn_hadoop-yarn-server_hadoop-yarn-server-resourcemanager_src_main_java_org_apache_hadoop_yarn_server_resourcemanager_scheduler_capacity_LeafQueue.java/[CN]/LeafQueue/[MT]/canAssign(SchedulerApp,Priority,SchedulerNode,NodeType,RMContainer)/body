{
  if (reservedContainer != null) {
    return true;
  }
  if (type == NodeType.OFF_SWITCH) {
    ResourceRequest offSwitchRequest=application.getResourceRequest(priority,RMNode.ANY);
    long missedOpportunities=application.getSchedulingOpportunities(priority);
    long requiredContainers=offSwitchRequest.getNumContainers();
    float localityWaitFactor=application.getLocalityWaitFactor(priority,scheduler.getNumClusterNodes());
    return ((requiredContainers * localityWaitFactor) < missedOpportunities);
  }
  ResourceRequest rackLocalRequest=application.getResourceRequest(priority,node.getRackName());
  if (rackLocalRequest == null || rackLocalRequest.getNumContainers() <= 0) {
    return false;
  }
  if (type == NodeType.RACK_LOCAL) {
    return true;
  }
  if (type == NodeType.NODE_LOCAL) {
    ResourceRequest nodeLocalRequest=application.getResourceRequest(priority,node.getHostName());
    if (nodeLocalRequest != null) {
      return nodeLocalRequest.getNumContainers() > 0;
    }
  }
  return false;
}
