{
  final Iterator<? extends Block> it=node.getBlockIterator();
  while (it.hasNext()) {
    removeStoredBlock(it.next(),node);
  }
  node.resetBlocks();
  removeFromInvalidates(node.getStorageID());
  datanodeManager.getNetworkTopology().remove(node);
  if (LOG.isDebugEnabled()) {
    LOG.debug("remove datanode " + node.getName());
  }
}
