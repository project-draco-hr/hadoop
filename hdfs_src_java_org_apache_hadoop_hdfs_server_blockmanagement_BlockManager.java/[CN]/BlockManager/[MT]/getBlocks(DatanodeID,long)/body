{
  namesystem.readLock();
  try {
    namesystem.checkSuperuserPrivilege();
    return getBlocksWithLocations(datanode,size);
  }
  finally {
    namesystem.readUnlock();
  }
}
