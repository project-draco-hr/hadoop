{
  if (targets.length == 0)   return true;
  Set<String> targetSet=new HashSet<String>();
  for (  DatanodeStorageInfo storage : targets) {
    final DatanodeDescriptor node=storage.getDatanodeDescriptor();
    String nodeGroup=NetworkTopology.getLastHalf(node.getNetworkLocation());
    if (targetSet.contains(nodeGroup)) {
      return false;
    }
 else {
      targetSet.add(nodeGroup);
    }
  }
  return true;
}
