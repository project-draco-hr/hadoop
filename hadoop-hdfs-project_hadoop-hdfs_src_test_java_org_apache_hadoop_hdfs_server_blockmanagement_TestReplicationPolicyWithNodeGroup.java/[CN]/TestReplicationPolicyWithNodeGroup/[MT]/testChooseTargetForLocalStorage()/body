{
  updateHeartbeatWithUsage(dataNodes[7],2 * HdfsServerConstants.MIN_BLOCKS_FOR_WRITE * BLOCK_SIZE,0L,(HdfsServerConstants.MIN_BLOCKS_FOR_WRITE - 1) * BLOCK_SIZE,0L,0L,0L,0,0);
  DatanodeStorageInfo[] targets;
  targets=chooseTarget(1,dataNodes[7]);
  assertEquals(targets.length,1);
  assertTrue(targets[0].getDatanodeDescriptor().equals(dataNodes[6]));
}
