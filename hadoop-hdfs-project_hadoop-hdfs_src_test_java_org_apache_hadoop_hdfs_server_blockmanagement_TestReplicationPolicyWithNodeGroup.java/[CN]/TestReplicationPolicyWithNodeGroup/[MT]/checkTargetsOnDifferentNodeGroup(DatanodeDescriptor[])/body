{
  if (targets.length == 0)   return true;
  Set<String> targetSet=new HashSet<String>();
  for (  DatanodeDescriptor node : targets) {
    String nodeGroup=NetworkTopology.getLastHalf(node.getNetworkLocation());
    if (targetSet.contains(nodeGroup)) {
      return false;
    }
 else {
      targetSet.add(nodeGroup);
    }
  }
  return true;
}
