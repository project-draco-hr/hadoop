{
  for (int i=0; i < NUM_OF_DATANODES_BOUNDARY; i++) {
    dataNodesInBoundaryCase[i].updateHeartbeat(2 * HdfsConstants.MIN_BLOCKS_FOR_WRITE * BLOCK_SIZE,0L,2 * HdfsConstants.MIN_BLOCKS_FOR_WRITE * BLOCK_SIZE,0L,0L,0L,0,0);
  }
  List<DatanodeDescriptor> chosenNodes=new ArrayList<DatanodeDescriptor>();
  chosenNodes.add(dataNodesInBoundaryCase[0]);
  chosenNodes.add(dataNodesInBoundaryCase[5]);
  DatanodeDescriptor[] targets;
  targets=replicator.chooseTarget(filename,1,dataNodesInBoundaryCase[0],chosenNodes,BLOCK_SIZE);
  assertFalse(cluster.isOnSameNodeGroup(targets[0],dataNodesInBoundaryCase[0]));
  assertFalse(cluster.isOnSameNodeGroup(targets[0],dataNodesInBoundaryCase[5]));
  assertTrue(checkTargetsOnDifferentNodeGroup(targets));
}
