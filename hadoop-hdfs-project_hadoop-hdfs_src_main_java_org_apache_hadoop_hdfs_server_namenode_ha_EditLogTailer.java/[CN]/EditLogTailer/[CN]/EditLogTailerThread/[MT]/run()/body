{
  while (shouldRun) {
    try {
      long lastTxnId=image.getLastAppliedTxId();
      if (LOG.isDebugEnabled()) {
        LOG.debug("lastTxnId: " + lastTxnId);
      }
      try {
        Collection<EditLogInputStream> streams=editLog.selectInputStreams(lastTxnId + 1,lastTxnId + 1,false);
        if (LOG.isDebugEnabled()) {
          LOG.debug("edit streams to load from: " + streams.size());
        }
        long editsLoaded=image.loadEdits(streams,namesystem);
        if (LOG.isDebugEnabled()) {
          LOG.debug("editsLoaded: " + editsLoaded);
        }
      }
 catch (      IOException e) {
        LOG.info("Got error, will try again.",e);
      }
    }
 catch (    Throwable t) {
      LOG.error("Edit log tailer received throwable",t);
    }
    try {
      Thread.sleep(sleepTime);
    }
 catch (    InterruptedException e) {
      LOG.warn("Edit log tailer interrupted",e);
    }
  }
}
