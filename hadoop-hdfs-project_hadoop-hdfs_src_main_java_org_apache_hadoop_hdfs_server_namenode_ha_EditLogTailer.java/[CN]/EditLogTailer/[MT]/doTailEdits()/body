{
  namesystem.writeLockInterruptibly();
  try {
    long lastTxnId=image.getLastAppliedTxId();
    if (LOG.isDebugEnabled()) {
      LOG.debug("lastTxnId: " + lastTxnId);
    }
    Collection<EditLogInputStream> streams=editLog.selectInputStreams(lastTxnId + 1,0,false);
    if (LOG.isDebugEnabled()) {
      LOG.debug("edit streams to load from: " + streams.size());
    }
    long editsLoaded=image.loadEdits(streams,namesystem);
    if (LOG.isDebugEnabled()) {
      LOG.debug("editsLoaded: " + editsLoaded);
    }
  }
  finally {
    namesystem.writeUnlock();
  }
}
