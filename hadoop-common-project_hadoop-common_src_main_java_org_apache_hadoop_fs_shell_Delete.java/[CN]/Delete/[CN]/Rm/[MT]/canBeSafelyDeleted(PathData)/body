{
  boolean shouldDelete=true;
  if (safeDelete) {
    final long deleteLimit=getConf().getLong(HADOOP_SHELL_SAFELY_DELETE_LIMIT_NUM_FILES,HADOOP_SHELL_SAFELY_DELETE_LIMIT_NUM_FILES_DEFAULT);
    if (deleteLimit > 0) {
      ContentSummary cs=item.fs.getContentSummary(item.path);
      final long numFiles=cs.getFileCount();
      if (numFiles > deleteLimit) {
        if (!ToolRunner.confirmPrompt("Proceed deleting " + numFiles + " files?")) {
          System.err.println("Delete aborted at user request.\n");
          shouldDelete=false;
        }
      }
    }
  }
  return shouldDelete;
}
