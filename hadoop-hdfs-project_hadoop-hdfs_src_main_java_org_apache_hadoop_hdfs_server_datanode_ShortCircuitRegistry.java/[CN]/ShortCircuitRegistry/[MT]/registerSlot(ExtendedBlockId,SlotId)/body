{
  if (!enabled) {
    if (LOG.isTraceEnabled()) {
      LOG.trace("registerSlot: ShortCircuitRegistry is " + "not enabled.");
    }
    throw new UnsupportedOperationException();
  }
  ShmId shmId=slotId.getShmId();
  RegisteredShm shm=segments.get(shmId);
  if (shm == null) {
    throw new InvalidRequestException("there is no shared memory segment " + "registered with shmId " + shmId);
  }
  Slot slot=shm.registerSlot(slotId.getSlotIdx(),blockId);
  boolean added=slots.put(blockId,slot);
  Preconditions.checkState(added);
}
