def __adjustMasterFailureCountConfig(self, nodeCount):
    maxFailures = self.__cfg['ringmaster']['max-master-failures']
    masters = 0
    if (not self.__cfg['gridservice-hdfs']['external']):
        masters += 1
    if (not self.__cfg['gridservice-mapred']['external']):
        masters += 1
    maxFailedNodes = (nodeCount - masters)
    self.__cfg['ringmaster']['max-master-failures'] = min(maxFailures, maxFailedNodes)
