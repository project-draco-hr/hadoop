{
  long oldOffset=currentOffset;
  flushSectionOutputStream();
  if (codec != null) {
    sectionOutputStream=codec.createOutputStream(underlyingOutputStream);
  }
 else {
    sectionOutputStream=underlyingOutputStream;
  }
  long length=fileChannel.position() - oldOffset;
  summary.addSections(FileSummary.Section.newBuilder().setName(name.name).setLength(length).setOffset(currentOffset));
  currentOffset+=length;
}
