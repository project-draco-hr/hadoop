{
  Counters cnt=Counters.fromEscapedCompactString(counters);
  for (java.util.Iterator<Counters.Group> grps=cnt.iterator(); grps.hasNext(); ) {
    Counters.Group grp=grps.next();
    for (java.util.Iterator<Counters.Counter> mycounters=grp.iterator(); mycounters.hasNext(); ) {
      Counters.Counter counter=mycounters.next();
      String countername=grp.getDisplayName() + "." + counter.getDisplayName();
      String value=(new Long(counter.getValue())).toString();
      String[] parts={countername,value};
      if (parts[0].equals("FileSystemCounters.FILE_BYTES_READ")) {
        mapTask.setValue(MapTaskKeys.FILE_BYTES_READ,parts[1]);
      }
 else       if (parts[0].equals("FileSystemCounters.FILE_BYTES_WRITTEN")) {
        mapTask.setValue(MapTaskKeys.FILE_BYTES_WRITTEN,parts[1]);
      }
 else       if (parts[0].equals("FileSystemCounters.HDFS_BYTES_READ")) {
        mapTask.setValue(MapTaskKeys.HDFS_BYTES_READ,parts[1]);
      }
 else       if (parts[0].equals("FileSystemCounters.HDFS_BYTES_WRITTEN")) {
        mapTask.setValue(MapTaskKeys.HDFS_BYTES_WRITTEN,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Map input records")) {
        mapTask.setValue(MapTaskKeys.INPUT_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Map output records")) {
        mapTask.setValue(MapTaskKeys.OUTPUT_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Map output bytes")) {
        mapTask.setValue(MapTaskKeys.OUTPUT_BYTES,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Combine input records")) {
        mapTask.setValue(MapTaskKeys.COMBINE_INPUT_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Combine output records")) {
        mapTask.setValue(MapTaskKeys.COMBINE_OUTPUT_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Spilled Records")) {
        mapTask.setValue(MapTaskKeys.SPILLED_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("FileInputFormatCounters.BYTES_READ")) {
        mapTask.setValue(MapTaskKeys.INPUT_BYTES,parts[1]);
      }
 else {
        System.err.println("MapCounterKey:<" + parts[0] + "> ==> NOT INCLUDED IN PERFORMANCE ADVISOR MAP TASK");
      }
    }
  }
}
