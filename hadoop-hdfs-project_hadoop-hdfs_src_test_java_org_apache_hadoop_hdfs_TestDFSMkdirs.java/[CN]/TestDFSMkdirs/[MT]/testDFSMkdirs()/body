{
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
  FileSystem fileSys=cluster.getFileSystem();
  try {
    Path myPath=new Path("/test/mkdirs");
    assertTrue(fileSys.mkdirs(myPath));
    assertTrue(fileSys.exists(myPath));
    assertTrue(fileSys.mkdirs(myPath));
    Path myFile=new Path("/test/mkdirs/myFile");
    writeFile(fileSys,myFile);
    Path myIllegalPath=new Path("/test/mkdirs/myFile/subdir");
    Boolean exist=true;
    try {
      fileSys.mkdirs(myIllegalPath);
    }
 catch (    IOException e) {
      exist=false;
    }
    assertFalse(exist);
    assertFalse(fileSys.exists(myIllegalPath));
    fileSys.delete(myFile,true);
  }
  finally {
    fileSys.close();
    cluster.shutdown();
  }
}
