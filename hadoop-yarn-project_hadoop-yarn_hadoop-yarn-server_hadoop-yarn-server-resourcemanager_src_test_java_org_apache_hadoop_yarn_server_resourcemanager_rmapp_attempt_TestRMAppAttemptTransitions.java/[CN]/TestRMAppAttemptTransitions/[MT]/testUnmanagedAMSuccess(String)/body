{
  unmanagedAM=true;
  when(submissionContext.getUnmanagedAM()).thenReturn(true);
  scheduleApplicationAttempt();
  testAppAttemptLaunchedState(null);
  verify(amLivelinessMonitor,times(1)).register(applicationAttempt.getAppAttemptId());
  runApplicationAttempt(null,"host",8042,url,true);
  applicationAttempt.handle(new RMAppAttemptContainerAcquiredEvent(applicationAttempt.getAppAttemptId(),mock(Container.class)));
  applicationAttempt.handle(new RMAppAttemptContainerFinishedEvent(applicationAttempt.getAppAttemptId(),mock(ContainerStatus.class)));
  String diagnostics="Successful";
  FinalApplicationStatus finalStatus=FinalApplicationStatus.SUCCEEDED;
  applicationAttempt.handle(new RMAppAttemptUnregistrationEvent(applicationAttempt.getAppAttemptId(),url,finalStatus,diagnostics));
  testAppAttemptFinishedState(null,finalStatus,url,diagnostics,1,true);
  assertFalse(transferStateFromPreviousAttempt);
}
