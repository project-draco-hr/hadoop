{
  Container amContainer=allocateApplicationAttempt();
  launchApplicationAttempt(amContainer);
  runApplicationAttempt(amContainer,"host",8042,"oldtrackingurl",false);
  FinalApplicationStatus finalStatus=FinalApplicationStatus.FAILED;
  String trackingUrl="newtrackingurl";
  String diagnostics="Job failed";
  unregisterApplicationAttempt(amContainer,finalStatus,trackingUrl,diagnostics);
  applicationAttempt.handle(new RMAppAttemptEvent(applicationAttempt.getAppAttemptId(),RMAppAttemptEventType.KILL));
  testAppAttemptFinishingState(amContainer,finalStatus,trackingUrl,diagnostics);
}
