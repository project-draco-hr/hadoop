{
  assumeTrue(isSecurityEnabled);
  Container amContainer=allocateApplicationAttempt();
  Token<ClientToAMTokenIdentifier> token=applicationAttempt.createClientToken(null);
  Assert.assertNull(token);
  token=applicationAttempt.createClientToken("clientuser");
  Assert.assertNull(token);
  launchApplicationAttempt(amContainer);
  token=applicationAttempt.createClientToken(null);
  Assert.assertNull(token);
  token=applicationAttempt.createClientToken("clientuser");
  Assert.assertNotNull(token);
  applicationAttempt.handle(new RMAppAttemptEvent(applicationAttempt.getAppAttemptId(),RMAppAttemptEventType.KILL));
  assertEquals(YarnApplicationAttemptState.LAUNCHED,applicationAttempt.createApplicationAttemptState());
  sendAttemptUpdateSavedEvent(applicationAttempt);
  token=applicationAttempt.createClientToken(null);
  Assert.assertNull(token);
  token=applicationAttempt.createClientToken("clientuser");
  Assert.assertNull(token);
}
