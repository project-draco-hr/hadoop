{
  EditLogFileInputStream in;
  try {
    in=new EditLogFileInputStream(file);
    in.getVersion(verifyVersion);
  }
 catch (  LogHeaderCorruptException e) {
    LOG.warn("Log file " + file + " has no valid header",e);
    return new FSEditLogLoader.EditLogValidation(0,HdfsServerConstants.INVALID_TXID,true);
  }
  try {
    return FSEditLogLoader.scanEditLog(in,maxTxIdToScan);
  }
  finally {
    IOUtils.closeStream(in);
  }
}
