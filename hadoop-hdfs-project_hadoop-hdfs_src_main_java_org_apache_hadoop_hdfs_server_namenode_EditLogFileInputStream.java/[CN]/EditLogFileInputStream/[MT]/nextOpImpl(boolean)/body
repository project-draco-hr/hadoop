{
  FSEditLogOp op=null;
switch (state) {
case UNINIT:
    try {
      init(true);
    }
 catch (    Throwable e) {
      LOG.error("caught exception initializing " + this,e);
      if (skipBrokenEdits) {
        return null;
      }
      Throwables.propagateIfPossible(e,IOException.class);
    }
  Preconditions.checkState(state != State.UNINIT);
return nextOpImpl(skipBrokenEdits);
case OPEN:
op=reader.readOp(skipBrokenEdits);
if ((op != null) && (op.hasTransactionId())) {
long txId=op.getTransactionId();
if ((txId >= lastTxId) && (lastTxId != HdfsConstants.INVALID_TXID)) {
long skipAmt=log.length() - tracker.getPos();
if (skipAmt > 0) {
  if (LOG.isDebugEnabled()) {
    LOG.debug("skipping " + skipAmt + " bytes at the end "+ "of edit log  '"+ getName()+ "': reached txid "+ txId+ " out of "+ lastTxId);
  }
  tracker.clearLimit();
  IOUtils.skipFully(tracker,skipAmt);
}
}
}
break;
case CLOSED:
break;
}
return op;
}
