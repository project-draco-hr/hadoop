{
  Map<String,ResourceRequest> rackLocalRequestMap=new HashMap<String,ResourceRequest>();
  Map<String,ResourceRequest> nodeLocalRequestMap=new HashMap<String,ResourceRequest>();
  ResourceRequest anyRequest=null;
  for (  ContainerSimulator cs : csList) {
    String rackHostNames[]=SLSUtils.getRackHostName(cs.getHostname());
    String rackname=rackHostNames[0];
    if (rackLocalRequestMap.containsKey(rackname)) {
      rackLocalRequestMap.get(rackname).setNumContainers(rackLocalRequestMap.get(rackname).getNumContainers() + 1);
    }
 else {
      ResourceRequest request=createResourceRequest(cs.getResource(),rackname,priority,1);
      rackLocalRequestMap.put(rackname,request);
    }
    String hostname=rackHostNames[1];
    if (nodeLocalRequestMap.containsKey(hostname)) {
      nodeLocalRequestMap.get(hostname).setNumContainers(nodeLocalRequestMap.get(hostname).getNumContainers() + 1);
    }
 else {
      ResourceRequest request=createResourceRequest(cs.getResource(),hostname,priority,1);
      nodeLocalRequestMap.put(hostname,request);
    }
    if (anyRequest == null) {
      anyRequest=createResourceRequest(cs.getResource(),ResourceRequest.ANY,priority,1);
    }
 else {
      anyRequest.setNumContainers(anyRequest.getNumContainers() + 1);
    }
  }
  List<ResourceRequest> ask=new ArrayList<ResourceRequest>();
  ask.addAll(nodeLocalRequestMap.values());
  ask.addAll(rackLocalRequestMap.values());
  if (anyRequest != null) {
    ask.add(anyRequest);
  }
  return ask;
}
