{
  if (monitoring && !DefaultMetricsSystem.inMiniClusterMode()) {
    LOG.warn(this.prefix + " metrics system already initialized!");
    return this;
  }
  this.prefix=checkNotNull(prefix,"prefix");
  ++refCount;
  if (monitoring) {
    LOG.info(this.prefix + " metrics system started (again)");
    return this;
  }
switch (initMode()) {
case NORMAL:
    try {
      start();
    }
 catch (    MetricsConfigException e) {
      LOG.warn("Metrics system not started: " + e.getMessage());
      LOG.debug("Stacktrace: ",e);
    }
  break;
case STANDBY:
LOG.info(prefix + " metrics system started in standby mode");
}
initSystemMBean();
return this;
}
