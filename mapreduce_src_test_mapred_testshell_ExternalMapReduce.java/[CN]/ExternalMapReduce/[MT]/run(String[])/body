{
  if (argv.length < 2) {
    System.out.println("ExternalMapReduce <input> <output>");
    return -1;
  }
  Path outDir=new Path(argv[1]);
  Path input=new Path(argv[0]);
  JobConf testConf=new JobConf(getConf(),ExternalMapReduce.class);
  try {
    testConf.getClassByName("testjar.ClassWordCount");
  }
 catch (  ClassNotFoundException e) {
    System.out.println("Could not find class from libjar");
    return -1;
  }
  testConf.setJobName("external job");
  FileInputFormat.setInputPaths(testConf,input);
  FileOutputFormat.setOutputPath(testConf,outDir);
  testConf.setMapperClass(MapClass.class);
  testConf.setReducerClass(Reduce.class);
  testConf.setNumReduceTasks(1);
  JobClient.runJob(testConf);
  return 0;
}
