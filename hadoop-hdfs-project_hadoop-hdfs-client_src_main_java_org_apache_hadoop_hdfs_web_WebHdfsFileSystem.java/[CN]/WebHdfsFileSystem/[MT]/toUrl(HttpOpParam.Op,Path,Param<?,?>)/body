{
  final String path=PATH_PREFIX + (fspath == null ? "/" : makeQualified(fspath).toUri().getRawPath());
  final String query=op.toQueryString() + Param.toSortedString("&",getAuthParameters(op)) + Param.toSortedString("&",parameters);
  final URL url=getNamenodeURL(path,query);
  if (LOG.isTraceEnabled()) {
    LOG.trace("url=" + url);
  }
  return url;
}
