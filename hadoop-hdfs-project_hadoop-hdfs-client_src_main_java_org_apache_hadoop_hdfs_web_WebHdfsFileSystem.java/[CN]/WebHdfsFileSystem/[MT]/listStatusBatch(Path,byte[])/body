{
  byte[] prevKey=EMPTY_ARRAY;
  if (token != null) {
    prevKey=token;
  }
  DirectoryListing listing=new FsPathResponseRunner<DirectoryListing>(GetOpParam.Op.LISTSTATUS_BATCH,f,new StartAfterParam(new String(prevKey,Charsets.UTF_8))){
    @Override DirectoryListing decodeResponse(    Map<?,?> json) throws IOException {
      return JsonUtilClient.toDirectoryListing(json);
    }
  }
.run();
  final HdfsFileStatus[] statuses=listing.getPartialListing();
  FileStatus[] qualified=new FileStatus[statuses.length];
  for (int i=0; i < statuses.length; i++) {
    qualified[i]=makeQualified(statuses[i],f);
  }
  return new DirectoryEntries(qualified,listing.getLastName(),listing.hasMore());
}
