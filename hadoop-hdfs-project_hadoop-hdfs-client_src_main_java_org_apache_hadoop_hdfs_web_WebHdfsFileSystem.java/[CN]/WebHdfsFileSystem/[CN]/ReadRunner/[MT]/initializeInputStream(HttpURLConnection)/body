{
  resolvedUrl=removeOffsetParam(conn.getURL());
  final String cl=conn.getHeaderField(HttpHeaders.CONTENT_LENGTH);
  InputStream inStream=conn.getInputStream();
  if (LOG.isDebugEnabled()) {
    LOG.debug("open file: " + conn.getURL());
  }
  if (cl != null) {
    long streamLength=Long.parseLong(cl);
    fileLength=pos + streamLength;
    inStream=new BoundedInputStream(inStream,streamLength);
  }
 else {
    fileLength=getHdfsFileStatus(path).getLen();
  }
  runnerState=RunnerState.OPEN;
  return new BufferedInputStream(inStream,bufferSize);
}
