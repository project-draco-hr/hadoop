{
  long filelen=conf.getLong("filebench.file.bytes",5 * 1024 * 1024* 1024);
  Text key=new Text();
  Text val=new Text();
  final String fn=conf.get("test.filebench.name","");
  final Path outd=FileOutputFormat.getOutputPath(conf);
  conf.set("mapred.work.output.dir",outd.toString());
  OutputFormat outf=conf.getOutputFormat();
  RecordWriter<Text,Text> rw=outf.getRecordWriter(outd.getFileSystem(conf),conf,fn,Reporter.NULL);
  try {
    long acc=0L;
    Date start=new Date();
    for (int i=0; acc < filelen; ++i) {
      i%=keys.length;
      key.set(keys[i]);
      val.set(values[i]);
      rw.write(key,val);
      acc+=keys[i].length();
      acc+=values[i].length();
    }
    Date end=new Date();
    return end.getTime() - start.getTime();
  }
  finally {
    rw.close(Reporter.NULL);
  }
}
