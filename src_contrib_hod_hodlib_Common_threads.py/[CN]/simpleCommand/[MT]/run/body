def run(self):
    ' Overridden run method.  Most of the work happens here.  start()\n            should be called in place of this method.'
    oldDir = None
    if self.__chdir:
        if os.path.exists(self.__chdir):
            oldDir = os.getcwd()
            os.chdir(self.__chdir)
        else:
            raise Exception(('simpleCommand: invalid chdir specified: %s' % self.__chdir))
    cmd = None
    if (self.__mode == 3):
        cmd = _Popen3Env(self.cmdString, env=self.__env)
    else:
        cmd = _Popen4Env(self.cmdString, env=self.__env)
    self.__pid = cmd.pid
    self.stdin = cmd.tochild
    if (self.__mode == 3):
        self.stderr = cmd.childerr
    while (cmd.fromchild == None):
        time.sleep(1)
    if (self.__buffer == True):
        output = cmd.fromchild.readline()
        while (output != ''):
            while (not self.running.isSet()):
                if self.stopFlag.isSet():
                    break
                time.sleep(1)
            self.__outputBuffer.append(output)
            output = cmd.fromchild.readline()
    elif (self.__wait == False):
        output = cmd.fromchild.readline()
        while (output != ''):
            while (not self.running.isSet()):
                if self.stopFlag.isSet():
                    break
                time.sleep(1)
            print output,
            if self.stopFlag.isSet():
                break
            output = cmd.fromchild.readline()
    else:
        self.stdout = cmd.fromchild
    self.__status = cmd.poll()
    while (self.__status == (-1)):
        while (not self.running.isSet()):
            if self.stopFlag.isSet():
                break
            time.sleep(1)
        self.__status = cmd.poll()
        time.sleep(1)
    if oldDir:
        os.chdir(oldDir)
    self.__isFinished.set()
    sys.exit(0)
