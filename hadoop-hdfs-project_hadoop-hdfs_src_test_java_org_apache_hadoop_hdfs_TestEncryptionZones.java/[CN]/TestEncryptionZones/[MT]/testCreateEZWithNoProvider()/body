{
  final Configuration clusterConf=cluster.getConfiguration(0);
  clusterConf.set(KeyProviderFactory.KEY_PROVIDER_PATH,"");
  cluster.restartNameNode(true);
  cluster.waitActive();
  final Path zone1=new Path("/zone1");
  fsWrapper.mkdir(zone1,FsPermission.getDirDefault(),true);
  try {
    dfsAdmin.createEncryptionZone(zone1,TEST_KEY);
    fail("expected exception");
  }
 catch (  IOException e) {
    assertExceptionContains("since no key provider is available",e);
  }
  final Path jksPath=new Path(testRootDir.toString(),"test.jks");
  clusterConf.set(KeyProviderFactory.KEY_PROVIDER_PATH,JavaKeyStoreProvider.SCHEME_NAME + "://file" + jksPath.toUri());
  assertNumZones(0);
}
