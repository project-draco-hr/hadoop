{
  final int len=8196;
  final Path zoneParent=new Path("/zones");
  final Path zone1=new Path(zoneParent,"zone1");
  final Path zone1File=new Path(zone1,"file");
  fsWrapper.mkdir(zone1,FsPermission.getDirDefault(),true);
  dfsAdmin.createEncryptionZone(zone1,TEST_KEY);
  DFSTestUtil.createFile(fs,zone1File,len,(short)1,0xFEED);
  ByteArrayOutputStream bStream=new ByteArrayOutputStream();
  PrintStream out=new PrintStream(bStream,true);
  int errCode=ToolRunner.run(new DFSck(conf,out),new String[]{"/"});
  assertEquals("Fsck ran with non-zero error code",0,errCode);
  String result=bStream.toString();
  assertTrue("Fsck did not return HEALTHY status",result.contains(NamenodeFsck.HEALTHY_STATUS));
  errCode=ToolRunner.run(new DFSck(conf,out),new String[]{zoneParent.toString()});
  assertEquals("Fsck ran with non-zero error code",0,errCode);
  result=bStream.toString();
  assertTrue("Fsck did not return HEALTHY status",result.contains(NamenodeFsck.HEALTHY_STATUS));
}
