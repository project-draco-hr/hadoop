{
  final int len=8192;
  final Path parent=new Path("/parent");
  final Path linkParent=new Path(parent,"symdir1");
  final Path targetParent=new Path(parent,"symdir2");
  final Path link=new Path(linkParent,"link");
  final Path target=new Path(targetParent,"target");
  fs.mkdirs(parent);
  dfsAdmin.createEncryptionZone(parent,TEST_KEY,NO_TRASH);
  fs.mkdirs(linkParent);
  fs.mkdirs(targetParent);
  DFSTestUtil.createFile(fs,target,len,(short)1,0xFEED);
  String content=DFSTestUtil.readFile(fs,target);
  fs.createSymlink(target,link,false);
  assertEquals("Contents read from link are not the same as target",content,DFSTestUtil.readFile(fs,link));
  fs.delete(parent,true);
  fs.mkdirs(linkParent);
  fs.mkdirs(targetParent);
  dfsAdmin.createEncryptionZone(linkParent,TEST_KEY,NO_TRASH);
  dfsAdmin.createEncryptionZone(targetParent,TEST_KEY,NO_TRASH);
  DFSTestUtil.createFile(fs,target,len,(short)1,0xFEED);
  content=DFSTestUtil.readFile(fs,target);
  fs.createSymlink(target,link,false);
  assertEquals("Contents read from link are not the same as target",content,DFSTestUtil.readFile(fs,link));
  fs.delete(link,true);
  fs.delete(target,true);
}
