{
  conf=new HdfsConfiguration();
  fsHelper=new FileSystemTestHelper();
  String testRoot=fsHelper.getTestRootDir();
  testRootDir=new File(testRoot).getAbsoluteFile();
  conf.set(KeyProviderFactory.KEY_PROVIDER_PATH,JavaKeyStoreProvider.SCHEME_NAME + "://file" + testRootDir+ "/test.jks");
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
  Logger.getLogger(EncryptionZoneManager.class).setLevel(Level.TRACE);
  fs=cluster.getFileSystem();
  fsWrapper=new FileSystemTestWrapper(fs);
  fcWrapper=new FileContextTestWrapper(FileContext.getFileContext(cluster.getURI(),conf));
  dfsAdmin=new HdfsAdmin(cluster.getURI(),conf);
  fs.getClient().provider=cluster.getNameNode().getNamesystem().getProvider();
  createKey(TEST_KEY);
}
