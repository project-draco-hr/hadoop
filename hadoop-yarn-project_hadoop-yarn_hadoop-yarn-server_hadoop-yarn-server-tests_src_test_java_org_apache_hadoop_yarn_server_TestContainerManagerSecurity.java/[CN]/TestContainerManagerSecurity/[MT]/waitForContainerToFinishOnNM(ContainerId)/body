{
  Context nmContet=yarnCluster.getNodeManager(0).getNMContext();
  int interval=4 * 60;
  Assert.assertNotNull(nmContet.getContainers().containsKey(containerId));
  while ((interval-- > 0) && !nmContet.getContainers().get(containerId).cloneAndGetContainerStatus().getState().equals(ContainerState.COMPLETE)) {
    try {
      LOG.info("Waiting for " + containerId + " to complete.");
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
    }
  }
  yarnCluster.getNodeManager(0).getNodeStatusUpdater().addCompletedContainer(containerId);
  nmContet.getContainers().remove(containerId);
}
