{
  ContainerManagementProtocol proxy;
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser(user);
  final InetSocketAddress addr=NetUtils.createSocketAddr(nodeId.getHost(),nodeId.getPort());
  if (nmToken != null) {
    ugi.addToken(ConverterUtils.convertFromYarn(nmToken,addr));
  }
  proxy=ugi.doAs(new PrivilegedAction<ContainerManagementProtocol>(){
    @Override public ContainerManagementProtocol run(){
      return (ContainerManagementProtocol)rpc.getProxy(ContainerManagementProtocol.class,addr,conf);
    }
  }
);
  return proxy;
}
