{
  if (volumes.size() < 1) {
    throw new DiskOutOfSpaceException("No more available volumes");
  }
  if (curVolume >= volumes.size()) {
    curVolume=0;
  }
  int startVolume=curVolume;
  long maxAvailable=0;
  while (true) {
    final V volume=volumes.get(curVolume);
    curVolume=(curVolume + 1) % volumes.size();
    long availableVolumeSize=volume.getAvailable();
    if (availableVolumeSize > blockSize) {
      return volume;
    }
    if (availableVolumeSize > maxAvailable) {
      maxAvailable=availableVolumeSize;
    }
    if (curVolume == startVolume) {
      throw new DiskOutOfSpaceException("Out of space: " + "The volume with the most available space (=" + maxAvailable + " B) is less than the block size (="+ blockSize+ " B).");
    }
  }
}
