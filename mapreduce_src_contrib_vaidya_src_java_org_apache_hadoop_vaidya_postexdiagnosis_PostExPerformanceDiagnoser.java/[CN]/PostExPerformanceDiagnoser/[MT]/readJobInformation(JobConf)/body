{
  URL jobConfFileUrl=new URL(this._jobConfFile);
  URL jobHistoryFileUrl=new URL(this._jobHistoryFile);
  jobConf.addResource(jobConfFileUrl);
  JobHistoryParser parser;
  JobInfo jobInfo;
  if (jobHistoryFileUrl.getProtocol().equals("hdfs")) {
    parser=new JobHistoryParser(FileSystem.get(jobConf),jobHistoryFileUrl.getPath());
    jobInfo=parser.parse();
  }
 else   if (jobHistoryFileUrl.getProtocol().equals("file")) {
    parser=new JobHistoryParser(FileSystem.getLocal(jobConf),jobHistoryFileUrl.getPath());
    jobInfo=parser.parse();
  }
 else {
    throw new Exception("Malformed URL. Protocol: " + jobHistoryFileUrl.getProtocol());
  }
  return jobInfo;
}
