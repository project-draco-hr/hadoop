{
  LinkedList<DatanodeDescriptor> possibilities=new LinkedList<DatanodeDescriptor>();
  for (  DatanodeDescriptor datanode : cached) {
    if (!pendingUncached.contains(datanode)) {
      possibilities.add(datanode);
    }
  }
  while (neededUncached > 0) {
    if (possibilities.isEmpty()) {
      LOG.warn("Logic error: we're trying to uncache more replicas than " + "actually exist for " + cachedBlock);
      return;
    }
    DatanodeDescriptor datanode=possibilities.remove(random.nextInt(possibilities.size()));
    pendingUncached.add(datanode);
    boolean added=datanode.getPendingUncached().add(cachedBlock);
    assert added;
    neededUncached--;
  }
}
