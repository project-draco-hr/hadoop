{
  scannedDirectives=0;
  scannedBlocks=0;
  namesystem.writeLock();
  try {
    rescanPathBasedCacheEntries();
  }
  finally {
    namesystem.writeUnlock();
  }
  namesystem.writeLock();
  try {
    rescanCachedBlockMap();
    blockManager.getDatanodeManager().resetLastCachingDirectiveSentTime();
  }
  finally {
    namesystem.writeUnlock();
  }
}
