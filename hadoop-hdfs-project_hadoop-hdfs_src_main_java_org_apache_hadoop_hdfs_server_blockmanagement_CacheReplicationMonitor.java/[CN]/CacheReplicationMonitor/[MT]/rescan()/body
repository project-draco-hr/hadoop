{
  scannedDirectives=0;
  scannedBlocks=0;
  namesystem.writeLock();
  try {
    if (shutdown) {
      throw new InterruptedException("CacheReplicationMonitor was " + "shut down.");
    }
    resetStatistics();
    rescanCacheDirectives();
    rescanCachedBlockMap();
    blockManager.getDatanodeManager().resetLastCachingDirectiveSentTime();
  }
  finally {
    namesystem.writeUnlock();
  }
}
