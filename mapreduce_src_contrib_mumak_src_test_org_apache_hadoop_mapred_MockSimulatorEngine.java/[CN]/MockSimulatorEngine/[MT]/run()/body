{
  startTime=System.currentTimeMillis();
  JobConf jobConf=createMumakConf();
  jobConf.set("mapred.queue.names",JobConf.DEFAULT_QUEUE_NAME);
  init(jobConf);
  validateInitialization();
  SimulatorEvent nextEvent;
  while ((nextEvent=queue.get()) != null && nextEvent.getTimeStamp() < terminateTime && !shutdown) {
    currentTime=nextEvent.getTimeStamp();
    SimulatorEventListener listener=nextEvent.getListener();
    if (nextEvent instanceof JobSubmissionEvent) {
      validateJobSubmission((JobSubmissionEvent)nextEvent);
    }
 else     if (nextEvent instanceof JobCompleteEvent) {
      validateJobComplete((JobCompleteEvent)nextEvent);
    }
    List<SimulatorEvent> response=listener.accept(nextEvent);
    queue.addAll(response);
  }
  validateEnd();
  summary(System.out);
}
