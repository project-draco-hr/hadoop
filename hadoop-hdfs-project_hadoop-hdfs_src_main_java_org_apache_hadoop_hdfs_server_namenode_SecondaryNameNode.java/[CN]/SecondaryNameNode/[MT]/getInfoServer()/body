{
  URI fsName=FileSystem.getDefaultUri(conf);
  if (!HdfsConstants.HDFS_URI_SCHEME.equalsIgnoreCase(fsName.getScheme())) {
    throw new IOException("This is not a DFS");
  }
  String configuredAddress=DFSUtil.getInfoServer(null,conf,true);
  InetSocketAddress sockAddr=NetUtils.createSocketAddr(configuredAddress);
  if (sockAddr.getAddress().isAnyLocalAddress()) {
    if (UserGroupInformation.isSecurityEnabled()) {
      throw new IOException("Cannot use a wildcard address with security. " + "Must explicitly set bind address for Kerberos");
    }
    return fsName.getHost() + ":" + sockAddr.getPort();
  }
 else {
    if (LOG.isDebugEnabled()) {
      LOG.debug("configuredAddress = " + configuredAddress);
    }
    return configuredAddress;
  }
}
