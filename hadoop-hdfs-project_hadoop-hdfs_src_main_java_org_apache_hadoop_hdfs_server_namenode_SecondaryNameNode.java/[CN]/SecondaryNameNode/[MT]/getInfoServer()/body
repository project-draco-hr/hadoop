{
  URI fsName=FileSystem.getDefaultUri(conf);
  if (!HdfsConstants.HDFS_URI_SCHEME.equalsIgnoreCase(fsName.getScheme())) {
    throw new IOException("This is not a DFS");
  }
  String configuredAddress=DFSUtil.getInfoServer(null,conf,true);
  String address=DFSUtil.substituteForWildcardAddress(configuredAddress,fsName.getHost());
  LOG.debug("Will connect to NameNode at HTTP address: " + address);
  return address;
}
