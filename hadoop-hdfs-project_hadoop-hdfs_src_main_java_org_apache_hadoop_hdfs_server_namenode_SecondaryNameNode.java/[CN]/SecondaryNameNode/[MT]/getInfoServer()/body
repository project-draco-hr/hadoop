{
  URI fsName=FileSystem.getDefaultUri(conf);
  if (!HdfsConstants.HDFS_URI_SCHEME.equalsIgnoreCase(fsName.getScheme())) {
    throw new IOException("This is not a DFS");
  }
  final String scheme=DFSUtil.getHttpClientScheme(conf);
  URI address=DFSUtil.getInfoServerWithDefaultHost(fsName.getHost(),conf,scheme);
  LOG.debug("Will connect to NameNode at " + address);
  return address.toURL();
}
