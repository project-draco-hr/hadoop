{
  Resource totalResource=node.getTotalResource();
  writeLock.lock();
  try {
    if (add) {
      int nodeMemory=totalResource.getMemory();
      if (nodeMemory > maxNodeMemory) {
        maxNodeMemory=nodeMemory;
      }
      int nodeVCores=totalResource.getVirtualCores();
      if (nodeVCores > maxNodeVCores) {
        maxNodeVCores=nodeVCores;
      }
    }
 else {
      if (maxNodeMemory == totalResource.getMemory()) {
        maxNodeMemory=-1;
      }
      if (maxNodeVCores == totalResource.getVirtualCores()) {
        maxNodeVCores=-1;
      }
      if (maxNodeMemory == -1 || maxNodeVCores == -1) {
        for (        N n : nodes.values()) {
          updateMaxResources(n,true);
        }
      }
    }
  }
  finally {
    writeLock.unlock();
  }
}
