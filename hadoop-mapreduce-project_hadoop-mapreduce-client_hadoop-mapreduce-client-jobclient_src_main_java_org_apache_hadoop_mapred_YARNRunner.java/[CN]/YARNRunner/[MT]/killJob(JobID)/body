{
  JobStatus status=clientCache.getClient(arg0).getJobStatus(arg0);
  ApplicationId appId=TypeConverter.toYarn(arg0).getAppId();
  if (status == null) {
    killUnFinishedApplication(appId);
    return;
  }
  if (status.getState() != JobStatus.State.RUNNING) {
    killApplication(appId);
    return;
  }
  try {
    clientCache.getClient(arg0).killJob(arg0);
    long currentTimeMillis=System.currentTimeMillis();
    long timeKillIssued=currentTimeMillis;
    long killTimeOut=conf.getLong(MRJobConfig.MR_AM_HARD_KILL_TIMEOUT_MS,MRJobConfig.DEFAULT_MR_AM_HARD_KILL_TIMEOUT_MS);
    while ((currentTimeMillis < timeKillIssued + killTimeOut) && !isJobInTerminalState(status)) {
      try {
        Thread.sleep(1000L);
      }
 catch (      InterruptedException ie) {
        break;
      }
      currentTimeMillis=System.currentTimeMillis();
      status=clientCache.getClient(arg0).getJobStatus(arg0);
      if (status == null) {
        killUnFinishedApplication(appId);
        return;
      }
    }
  }
 catch (  IOException io) {
    LOG.debug("Error when checking for application status",io);
  }
  if (status != null && !isJobInTerminalState(status)) {
    killApplication(appId);
  }
}
