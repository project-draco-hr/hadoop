{
  GetDelegationTokenRequest request=recordFactory.newRecordInstance(GetDelegationTokenRequest.class);
  request.setRenewer(Master.getMasterPrincipal(conf));
  DelegationToken mrDelegationToken;
  try {
    mrDelegationToken=hsProxy.getDelegationToken(request).getDelegationToken();
    return ProtoUtils.convertFromProtoFormat(mrDelegationToken,hsProxy.getConnectAddress());
  }
 catch (  YarnRemoteException e) {
    throw new IOException(e);
  }
}
