def _getNameNodeAdminCommand(self, adminCommand, wait=True, ignoreFailures=False):
    sd = self.serviceDesc
    parentDirs = self.workDirs
    workDirs = []
    attrs = sd.getfinalAttrs().copy()
    envs = sd.getEnvs().copy()
    nn = self.masterAddr
    if (nn == None):
        raise ValueError, "Can't get namenode address"
    attrs['fs.default.name'] = nn
    self._setWorkDirs(workDirs, envs, attrs, parentDirs, 'hdfs-nn')
    dict = {'name': 'dfsadmin', }
    dict['program'] = os.path.join('bin', 'hadoop')
    argv = ['dfsadmin']
    argv.append(adminCommand)
    dict['argv'] = argv
    dict['envs'] = envs
    dict['pkgdirs'] = sd.getPkgDirs()
    dict['workdirs'] = workDirs
    dict['final-attrs'] = attrs
    dict['attrs'] = sd.getAttrs()
    if wait:
        dict['fg'] = 'true'
        dict['stdin'] = 'Y'
    if ignoreFailures:
        dict['ignorefailures'] = 'Y'
    cmd = CommandDesc(dict)
    return cmd
