{
  rm.start();
  MockNM amNodeManager=rm.registerNode("127.0.0.1:1234",2048);
  String[] mediaTypes={MediaType.APPLICATION_JSON,MediaType.APPLICATION_XML};
  MediaType[] contentTypes={MediaType.APPLICATION_JSON_TYPE,MediaType.APPLICATION_XML_TYPE};
  String[] targetStates={YarnApplicationState.FINISHED.toString(),"blah"};
  for (  String mediaType : mediaTypes) {
    for (    MediaType contentType : contentTypes) {
      for (      String targetStateString : targetStates) {
        RMApp app=rm.submitApp(CONTAINER_MB,"",webserviceUserName);
        amNodeManager.nodeHeartbeat(true);
        ClientResponse response;
        AppState targetState=new AppState(targetStateString);
        Object entity;
        if (contentType == MediaType.APPLICATION_JSON_TYPE) {
          entity=appStateToJSON(targetState);
        }
 else {
          entity=targetState;
        }
        response=this.constructWebResource("apps",app.getApplicationId().toString(),"state").entity(entity,contentType).accept(mediaType).put(ClientResponse.class);
        if (!isAuthenticationEnabled()) {
          assertEquals(Status.UNAUTHORIZED,response.getClientResponseStatus());
          continue;
        }
        assertEquals(Status.BAD_REQUEST,response.getClientResponseStatus());
      }
    }
  }
  rm.stop();
  return;
}
