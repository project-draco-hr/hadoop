{
  rm.start();
  MockNM amNodeManager=rm.registerNode("127.0.0.1:1234",2048);
  String[] mediaTypes={MediaType.APPLICATION_JSON,MediaType.APPLICATION_XML};
  for (  String mediaType : mediaTypes) {
    RMApp app=rm.submitApp(CONTAINER_MB,"",webserviceUserName);
    amNodeManager.nodeHeartbeat(true);
    ClientResponse response=this.constructWebResource("apps",app.getApplicationId().toString(),"state").accept(mediaType).get(ClientResponse.class);
    assertEquals(Status.OK,response.getClientResponseStatus());
    if (mediaType.equals(MediaType.APPLICATION_JSON)) {
      verifyAppStateJson(response,RMAppState.ACCEPTED);
    }
 else     if (mediaType.equals(MediaType.APPLICATION_XML)) {
      verifyAppStateXML(response,RMAppState.ACCEPTED);
    }
  }
  rm.stop();
}
