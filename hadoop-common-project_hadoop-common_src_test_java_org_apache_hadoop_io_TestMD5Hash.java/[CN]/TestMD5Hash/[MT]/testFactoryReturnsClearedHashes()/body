{
  ByteArrayInputStream failingStream=new ByteArrayInputStream("xxxx".getBytes()){
    @Override public synchronized int read(    byte[] b) throws IOException {
      int ret=super.read(b);
      if (ret <= 0) {
        throw new IOException("Injected fault");
      }
      return ret;
    }
  }
;
  final String TEST_STRING="hello";
  MD5Hash expectedHash=MD5Hash.digest(TEST_STRING);
  assertEquals(expectedHash,MD5Hash.digest(TEST_STRING));
  try {
    MD5Hash.digest(failingStream);
    fail("didnt throw!");
  }
 catch (  Exception e) {
  }
  assertEquals(expectedHash,MD5Hash.digest(TEST_STRING));
}
