{
  if (snapshotId == Snapshot.CURRENT_STATE_ID) {
    return this.getParentReference() != null ? this.getParentReference() : this.getLastWithName();
  }
  for (int i=0; i < withNameList.size(); i++) {
    if (snapshotId <= withNameList.get(i).lastSnapshotId) {
      return withNameList.get(i);
    }
  }
  return this.getParentReference();
}
