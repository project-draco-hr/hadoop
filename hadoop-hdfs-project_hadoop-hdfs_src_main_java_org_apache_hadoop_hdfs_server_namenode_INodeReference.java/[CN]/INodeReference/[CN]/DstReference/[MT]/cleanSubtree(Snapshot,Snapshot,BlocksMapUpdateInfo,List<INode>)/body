{
  Quota.Counts counts=getReferredINode().cleanSubtree(snapshot,prior,collectedBlocks,removedINodes);
  if (snapshot != null) {
    WithCount wc=(WithCount)getReferredINode();
    wc.addSpaceConsumedToRenameSrc(-counts.get(Quota.NAMESPACE),-counts.get(Quota.DISKSPACE),true,snapshot.getId());
  }
  return counts;
}
