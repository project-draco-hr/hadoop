{
  while (datanode.shouldRun) {
    try {
      Socket s=ss.accept();
      s.setTcpNoDelay(true);
      new Daemon(datanode.threadGroup,new DataXceiver(s,datanode,this)).start();
    }
 catch (    SocketTimeoutException ignored) {
    }
catch (    IOException ie) {
      LOG.warn(datanode.getMachineName() + ":DataXceiveServer: " + StringUtils.stringifyException(ie));
    }
catch (    Throwable te) {
      LOG.error(datanode.getMachineName() + ":DataXceiveServer: Exiting due to:" + StringUtils.stringifyException(te));
      datanode.shouldRun=false;
    }
  }
  try {
    ss.close();
  }
 catch (  IOException ie) {
    LOG.warn(datanode.getMachineName() + ":DataXceiveServer: " + StringUtils.stringifyException(ie));
  }
}
