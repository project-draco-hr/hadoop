{
  FileSystem.mkdirs(fs,path,FsPermission.createImmutable((short)0755));
  List<AclEntry> aclSpec=Lists.newArrayList(aclEntry(DEFAULT,USER,"foo",ALL));
  fs.setAcl(path,aclSpec);
  Path filePath=new Path(path,"file1");
  int bufferSize=cluster.getConfiguration(0).getInt(CommonConfigurationKeys.IO_FILE_BUFFER_SIZE_KEY,CommonConfigurationKeys.IO_FILE_BUFFER_SIZE_DEFAULT);
  fs.create(filePath,new FsPermission((short)0740),false,bufferSize,fs.getDefaultReplication(filePath),fs.getDefaultBlockSize(path),null).close();
  AclStatus s=fs.getAclStatus(filePath);
  AclEntry[] returned=s.getEntries().toArray(new AclEntry[0]);
  assertArrayEquals(new AclEntry[]{aclEntry(ACCESS,USER,"foo",ALL),aclEntry(ACCESS,GROUP,READ_EXECUTE)},returned);
  assertPermission(filePath,(short)0740);
  assertAclFeature(filePath,true);
}
