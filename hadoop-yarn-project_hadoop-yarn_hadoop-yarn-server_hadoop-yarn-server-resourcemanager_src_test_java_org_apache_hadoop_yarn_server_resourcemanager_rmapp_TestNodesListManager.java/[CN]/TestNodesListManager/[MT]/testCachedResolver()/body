{
  Logger rootLogger=LogManager.getRootLogger();
  rootLogger.setLevel(Level.DEBUG);
  ControlledClock clock=new ControlledClock(new SystemClock());
  clock.setTime(0);
  final int CACHE_EXPIRY_INTERVAL_SECS=30;
  NodesListManager.CachedResolver resolver=new NodesListManager.CachedResolver(clock,CACHE_EXPIRY_INTERVAL_SECS);
  resolver.init(new YarnConfiguration());
  resolver.start();
  resolver.addToCache("testCachedResolverHost1","1.1.1.1");
  Assert.assertEquals("1.1.1.1",resolver.resolve("testCachedResolverHost1"));
  resolver.addToCache("testCachedResolverHost2","1.1.1.2");
  Assert.assertEquals("1.1.1.1",resolver.resolve("testCachedResolverHost1"));
  Assert.assertEquals("1.1.1.2",resolver.resolve("testCachedResolverHost2"));
  resolver.removeFromCache("testCachedResolverHost1");
  Assert.assertNotEquals("1.1.1.1",resolver.resolve("testCachedResolverHost1"));
  Assert.assertEquals("1.1.1.2",resolver.resolve("testCachedResolverHost2"));
  clock.tickMsec(CACHE_EXPIRY_INTERVAL_SECS * 1000 + 1);
  resolver.getExpireChecker().run();
  Assert.assertNotEquals("1.1.1.1",resolver.resolve("testCachedResolverHost1"));
  Assert.assertNotEquals("1.1.1.2",resolver.resolve("testCachedResolverHost2"));
}
