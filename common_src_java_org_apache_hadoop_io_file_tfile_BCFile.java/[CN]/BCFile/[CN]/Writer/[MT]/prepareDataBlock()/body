{
  if (blkInProgress == true) {
    throw new IllegalStateException("Cannot create Data Block until previous block is closed.");
  }
  if (metaBlkSeen == true) {
    throw new IllegalStateException("Cannot create Data Block after Meta Blocks.");
  }
  DataBlockRegister dbr=new DataBlockRegister();
  WBlockState wbs=new WBlockState(getDefaultCompressionAlgorithm(),out,fsOutputBuffer,conf);
  BlockAppender ba=new BlockAppender(dbr,wbs);
  blkInProgress=true;
  return ba;
}
