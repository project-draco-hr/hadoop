{
  if (blkInProgress == true) {
    throw new IllegalStateException("Cannot create Meta Block until previous block is closed.");
  }
  if (metaIndex.getMetaByName(name) != null) {
    throw new MetaBlockAlreadyExists("name=" + name);
  }
  MetaBlockRegister mbr=new MetaBlockRegister(name,compressAlgo);
  WBlockState wbs=new WBlockState(compressAlgo,out,fsOutputBuffer,conf);
  BlockAppender ba=new BlockAppender(mbr,wbs);
  blkInProgress=true;
  metaBlkSeen=true;
  return ba;
}
