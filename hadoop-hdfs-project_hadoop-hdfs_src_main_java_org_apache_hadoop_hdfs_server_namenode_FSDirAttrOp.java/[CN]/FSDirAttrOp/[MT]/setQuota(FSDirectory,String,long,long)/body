{
  if (fsd.isPermissionEnabled()) {
    FSPermissionChecker pc=fsd.getPermissionChecker();
    pc.checkSuperuserPrivilege();
  }
  fsd.writeLock();
  try {
    INodeDirectory changed=unprotectedSetQuota(fsd,src,nsQuota,dsQuota);
    if (changed != null) {
      final Quota.Counts q=changed.getQuotaCounts();
      fsd.getEditLog().logSetQuota(src,q.get(Quota.NAMESPACE),q.get(Quota.DISKSPACE));
    }
  }
  finally {
    fsd.writeUnlock();
  }
}
