{
  Preconditions.checkState(!isStarted(),"JN already running");
  validateAndCreateJournalDir(localDir);
  DefaultMetricsSystem.initialize("JournalNode");
  JvmMetrics.create("JournalNode",conf.get(DFSConfigKeys.DFS_METRICS_SESSION_ID_KEY),DefaultMetricsSystem.instance());
  InetSocketAddress socAddr=JournalNodeRpcServer.getAddress(conf);
  SecurityUtil.login(conf,DFSConfigKeys.DFS_JOURNALNODE_KEYTAB_FILE_KEY,DFSConfigKeys.DFS_JOURNALNODE_USER_NAME_KEY,socAddr.getHostName());
  registerJNMXBean();
  httpServer=new JournalNodeHttpServer(conf,this);
  httpServer.start();
  rpcServer=new JournalNodeRpcServer(conf,this);
  rpcServer.start();
}
