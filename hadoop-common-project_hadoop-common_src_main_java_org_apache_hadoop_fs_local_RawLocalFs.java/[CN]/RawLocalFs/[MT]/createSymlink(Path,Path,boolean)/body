{
  final String targetScheme=target.toUri().getScheme();
  if (targetScheme != null && !"file".equals(targetScheme)) {
    throw new IOException("Unable to create symlink to non-local file " + "system: " + target.toString());
  }
  if (createParent) {
    mkdir(link.getParent(),FsPermission.getDirDefault(),true);
  }
  try {
    Shell.execCommand(Shell.LINK_COMMAND,"-s",new URI(target.toString()).getPath(),new URI(link.toString()).getPath());
  }
 catch (  URISyntaxException x) {
    throw new IOException("Invalid symlink path: " + x.getMessage());
  }
catch (  IOException x) {
    throw new IOException("Unable to create symlink: " + x.getMessage());
  }
}
