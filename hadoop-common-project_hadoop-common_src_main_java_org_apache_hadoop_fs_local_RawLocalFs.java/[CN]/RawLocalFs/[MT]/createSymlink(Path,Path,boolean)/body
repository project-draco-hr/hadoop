{
  final String targetScheme=target.toUri().getScheme();
  if (targetScheme != null && !"file".equals(targetScheme)) {
    throw new IOException("Unable to create symlink to non-local file " + "system: " + target.toString());
  }
  if (createParent) {
    mkdir(link.getParent(),FsPermission.getDirDefault(),true);
  }
  try {
    Shell.execCommand(Shell.getSymlinkCommand(getPathWithoutSchemeAndAuthority(target).getPath(),getPathWithoutSchemeAndAuthority(link).getPath()));
  }
 catch (  IOException x) {
    throw new IOException("Unable to create symlink: " + x.getMessage());
  }
}
