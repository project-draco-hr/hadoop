{
  final String targetScheme=target.toUri().getScheme();
  if (targetScheme != null && !"file".equals(targetScheme)) {
    throw new IOException("Unable to create symlink to non-local file " + "system: " + target.toString());
  }
  if (createParent) {
    mkdir(link.getParent(),FsPermission.getDirDefault(),true);
  }
  int result=FileUtil.symLink(target.toString(),link.toString());
  if (result != 0) {
    throw new IOException("Error " + result + " creating symlink "+ link+ " to "+ target);
  }
}
