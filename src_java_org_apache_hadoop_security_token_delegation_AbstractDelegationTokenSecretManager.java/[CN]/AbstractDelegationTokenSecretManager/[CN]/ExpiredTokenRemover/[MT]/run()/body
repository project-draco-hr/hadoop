{
  LOG.info("Starting expired delegation token remover thread, " + "tokenRemoverScanInterval=" + tokenRemoverScanInterval / (60 * 1000) + " min(s)");
  try {
    while (running) {
      long now=System.currentTimeMillis();
      if (lastMasterKeyUpdate + keyUpdateInterval < now) {
        try {
          rollMasterKey();
          lastMasterKeyUpdate=now;
        }
 catch (        IOException e) {
          LOG.error("Master key updating failed. " + StringUtils.stringifyException(e));
        }
      }
      if (lastTokenCacheCleanup + tokenRemoverScanInterval < now) {
        removeExpiredToken();
        lastTokenCacheCleanup=now;
      }
      try {
        Thread.sleep(5000);
      }
 catch (      InterruptedException ie) {
        LOG.error("InterruptedExcpetion recieved for ExpiredTokenRemover thread " + ie);
      }
    }
  }
 catch (  Throwable t) {
    LOG.error("ExpiredTokenRemover thread received unexpected exception. " + t);
    Runtime.getRuntime().exit(-1);
  }
}
