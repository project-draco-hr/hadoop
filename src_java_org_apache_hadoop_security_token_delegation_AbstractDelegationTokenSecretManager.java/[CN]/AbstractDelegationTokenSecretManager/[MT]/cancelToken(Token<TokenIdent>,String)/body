{
  ByteArrayInputStream buf=new ByteArrayInputStream(token.getIdentifier());
  DataInputStream in=new DataInputStream(buf);
  TokenIdent id=createIdentifier();
  id.readFields(in);
  if (id.getRenewer() == null) {
    LOG.warn("Renewer is null: Invalid Identifier");
    return false;
  }
  if (id.getUser() == null) {
    LOG.warn("owner is null: Invalid Identifier");
    return false;
  }
  String owner=id.getUser().getUserName();
  String renewer=id.getRenewer().toString();
  if (!canceller.equals(owner) && !canceller.equals(renewer)) {
    LOG.warn(canceller + " is not authorized to cancel the token");
    return false;
  }
  DelegationTokenInformation info=null;
synchronized (currentTokens) {
    info=currentTokens.remove(id);
  }
  return info != null;
}
