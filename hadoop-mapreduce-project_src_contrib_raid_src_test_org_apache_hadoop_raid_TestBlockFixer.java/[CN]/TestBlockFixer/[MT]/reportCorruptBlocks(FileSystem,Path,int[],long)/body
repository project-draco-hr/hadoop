{
  FSDataInputStream in=fs.open(file);
  for (  int idx : idxs) {
    long offset=idx * blockSize;
    LOG.info("Reporting corrupt block " + file + ":"+ offset);
    in.seek(offset);
    try {
      in.readFully(new byte[(int)blockSize]);
      fail("Expected exception not thrown for " + file + ":"+ offset);
    }
 catch (    org.apache.hadoop.fs.ChecksumException e) {
    }
catch (    org.apache.hadoop.hdfs.BlockMissingException bme) {
    }
  }
}
