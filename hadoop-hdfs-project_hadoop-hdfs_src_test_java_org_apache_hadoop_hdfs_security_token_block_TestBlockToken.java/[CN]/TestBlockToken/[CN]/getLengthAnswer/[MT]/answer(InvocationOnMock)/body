{
  Object args[]=invocation.getArguments();
  assertEquals(1,args.length);
  org.apache.hadoop.hdfs.protocolR23Compatible.ExtendedBlockWritable block=(org.apache.hadoop.hdfs.protocolR23Compatible.ExtendedBlockWritable)args[0];
  Set<TokenIdentifier> tokenIds=UserGroupInformation.getCurrentUser().getTokenIdentifiers();
  assertEquals("Only one BlockTokenIdentifier expected",1,tokenIds.size());
  long result=0;
  for (  TokenIdentifier tokenId : tokenIds) {
    BlockTokenIdentifier id=(BlockTokenIdentifier)tokenId;
    LOG.info("Got: " + id.toString());
    assertTrue("Received BlockTokenIdentifier is wrong",ident.equals(id));
    sm.checkAccess(id,null,org.apache.hadoop.hdfs.protocolR23Compatible.ExtendedBlockWritable.convertExtendedBlock(block),BlockTokenSecretManager.AccessMode.WRITE);
    result=id.getBlockId();
  }
  return result;
}
