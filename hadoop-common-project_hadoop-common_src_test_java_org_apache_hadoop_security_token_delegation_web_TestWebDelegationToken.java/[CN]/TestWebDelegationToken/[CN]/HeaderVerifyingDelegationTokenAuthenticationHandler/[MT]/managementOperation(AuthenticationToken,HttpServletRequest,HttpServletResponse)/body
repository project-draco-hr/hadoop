{
  String op=ServletUtils.getParameter(request,KerberosDelegationTokenAuthenticator.OP_PARAM);
  if (op != null) {
    DelegationTokenOperation dtOp=DelegationTokenOperation.valueOf(op);
    if (dtOp == DelegationTokenOperation.RENEWDELEGATIONTOKEN || dtOp == DelegationTokenOperation.CANCELDELEGATIONTOKEN) {
      Assert.assertNotNull("Request header should have delegation token",request.getHeader(DelegationTokenAuthenticator.DELEGATION_TOKEN_HEADER));
    }
  }
  return super.managementOperation(token,request,response);
}
