{
  config=new JobConf(new Configuration());
  config.setClass(CommonConfigurationKeys.HADOOP_SECURITY_GROUP_MAPPING,TestMapredGroupMappingServiceRefresh.MockUnixGroupsMapping.class,GroupMappingServiceProvider.class);
  config.setLong(CommonConfigurationKeys.HADOOP_SECURITY_GROUPS_CACHE_SECS,groupRefreshTimeoutSec);
  LOG.info("GROUP MAPPING class name=" + config.getClass(CommonConfigurationKeys.HADOOP_SECURITY_GROUP_MAPPING,ShellBasedUnixGroupsMapping.class,GroupMappingServiceProvider.class).getName());
  Groups.getUserToGroupsMappingService(config);
  String namenodeUrl="hdfs://localhost:" + "0";
  FileSystem.setDefaultUri(config,namenodeUrl);
  cluster=new MiniDFSCluster(0,config,1,true,true,true,null,null,null,null);
  cluster.waitActive();
  URI uri=cluster.getURI();
  MiniMRCluster miniMRCluster=new MiniMRCluster(0,uri.toString(),3,null,null,config);
  config.set(JTConfig.JT_IPC_ADDRESS,"localhost:" + miniMRCluster.getJobTrackerPort());
  ProxyUsers.refreshSuperUserGroupsConfiguration(config);
}
