{
  if (!renameSupported())   return;
  Path src=getTestRootPath(fSys,"test/hadoop/dir");
  fSys.mkdirs(src);
  createFile(getTestRootPath(fSys,"test/hadoop/dir/file1"));
  createFile(getTestRootPath(fSys,"test/hadoop/dir/subdir/file2"));
  Path dst=getTestRootPath(fSys,"test/new/newdir");
  fSys.mkdirs(dst.getParent());
  rename(src,dst,true,false,true,options);
  Assert.assertFalse("Nested file1 exists",exists(fSys,getTestRootPath(fSys,"test/hadoop/dir/file1")));
  Assert.assertFalse("Nested file2 exists",exists(fSys,getTestRootPath(fSys,"test/hadoop/dir/subdir/file2")));
  Assert.assertTrue("Renamed nested file1 exists",exists(fSys,getTestRootPath(fSys,"test/new/newdir/file1")));
  Assert.assertTrue("Renamed nested exists",exists(fSys,getTestRootPath(fSys,"test/new/newdir/subdir/file2")));
}
