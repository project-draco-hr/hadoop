{
  Configuration conf=new Configuration();
  FileSystem fileSys=FileSystem.get(conf);
  Path file=new Path("test" + "/file");
  FSDataOutputStream out=fileSys.create(file,true,conf.getInt("io.file.buffer.size",4096),(short)1,(long)BLOCKSIZE);
  out.write(new byte[0]);
  out.close();
  DummyInputFormat inFormat=new DummyInputFormat();
  Job job=Job.getInstance(conf);
  FileInputFormat.setInputPaths(job,"test");
  List<InputSplit> splits=inFormat.getSplits(job);
  assertEquals(1,splits.size());
  CombineFileSplit fileSplit=(CombineFileSplit)splits.get(0);
  assertEquals(1,fileSplit.getNumPaths());
  assertEquals(file.getName(),fileSplit.getPath(0).getName());
  assertEquals(0,fileSplit.getOffset(0));
  assertEquals(0,fileSplit.getLength(0));
  fileSys.delete(file.getParent(),true);
}
