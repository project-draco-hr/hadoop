{
  RegisterApplicationMasterResponse response=registerApplicationMaster(request);
  RegisterDistributedSchedulingAMResponse dsResp=recordFactory.newRecordInstance(RegisterDistributedSchedulingAMResponse.class);
  dsResp.setRegisterResponse(response);
  dsResp.setMinContainerResource(Resource.newInstance(getConfig().getInt(YarnConfiguration.OPPORTUNISTIC_CONTAINERS_MIN_MEMORY_MB,YarnConfiguration.OPPORTUNISTIC_CONTAINERS_MIN_MEMORY_MB_DEFAULT),getConfig().getInt(YarnConfiguration.OPPORTUNISTIC_CONTAINERS_MIN_VCORES,YarnConfiguration.OPPORTUNISTIC_CONTAINERS_MIN_VCORES_DEFAULT)));
  dsResp.setMaxContainerResource(Resource.newInstance(getConfig().getInt(YarnConfiguration.OPPORTUNISTIC_CONTAINERS_MAX_MEMORY_MB,YarnConfiguration.OPPORTUNISTIC_CONTAINERS_MAX_MEMORY_MB_DEFAULT),getConfig().getInt(YarnConfiguration.OPPORTUNISTIC_CONTAINERS_MAX_VCORES,YarnConfiguration.OPPORTUNISTIC_CONTAINERS_MAX_VCORES_DEFAULT)));
  dsResp.setIncrContainerResource(Resource.newInstance(getConfig().getInt(YarnConfiguration.OPPORTUNISTIC_CONTAINERS_INCR_MEMORY_MB,YarnConfiguration.OPPORTUNISTIC_CONTAINERS_INCR_MEMORY_MB_DEFAULT),getConfig().getInt(YarnConfiguration.OPPORTUNISTIC_CONTAINERS_INCR_VCORES,YarnConfiguration.OPPORTUNISTIC_CONTAINERS_INCR_VCORES_DEFAULT)));
  dsResp.setContainerTokenExpiryInterval(getConfig().getInt(YarnConfiguration.OPPORTUNISTIC_CONTAINERS_TOKEN_EXPIRY_MS,YarnConfiguration.OPPORTUNISTIC_CONTAINERS_TOKEN_EXPIRY_MS_DEFAULT));
  dsResp.setContainerIdStart(this.rmContext.getEpoch() << ResourceManager.EPOCH_BIT_SHIFT);
  dsResp.setNodesForScheduling(this.nodeMonitor.selectLeastLoadedNodes(this.k));
  return dsResp;
}
