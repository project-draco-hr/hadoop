{
  RegisterApplicationMasterResponse response=registerApplicationMaster(request);
  RegisterDistributedSchedulingAMResponse dsResp=recordFactory.newRecordInstance(RegisterDistributedSchedulingAMResponse.class);
  dsResp.setRegisterResponse(response);
  dsResp.setMinContainerResource(createMinContainerResource());
  dsResp.setMaxContainerResource(createMaxContainerResource());
  dsResp.setIncrContainerResource(createIncrContainerResource());
  dsResp.setContainerTokenExpiryInterval(getConfig().getInt(YarnConfiguration.OPPORTUNISTIC_CONTAINERS_TOKEN_EXPIRY_MS,YarnConfiguration.OPPORTUNISTIC_CONTAINERS_TOKEN_EXPIRY_MS_DEFAULT));
  dsResp.setContainerIdStart(this.rmContext.getEpoch() << ResourceManager.EPOCH_BIT_SHIFT);
  dsResp.setNodesForScheduling(getLeastLoadedNodes());
  return dsResp;
}
