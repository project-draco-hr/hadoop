{
  Path testPath=new Path("/testfile");
  DFSTestUtil.writeFile(dfs,testPath,"hello, world!");
  LocatedBlocks lb=dfs.getClient().getLocatedBlocks(testPath.toString(),0);
  final long firstId=lb.get(0).getBlock().getBlockId();
  dfs.delete(testPath,true);
  DFSTestUtil.writeFile(dfs,testPath,"hello again");
  lb=dfs.getClient().getLocatedBlocks(testPath.toString(),0);
  final long secondId=lb.get(0).getBlock().getBlockId();
  Assert.assertEquals(firstId + HdfsConstants.MAX_BLOCKS_IN_GROUP,secondId);
}
