{
  final Path qualifiedPath=path.makeQualified(fs);
  FileStatus[] parentDirListing=fs.listStatus(qualifiedPath.getParent());
  StringBuilder listing=lsToString(parentDirListing);
  String parentDirLS=listing.toString();
  FileStatus status=fs.getFileStatus(qualifiedPath);
  assertEquals("Length of written file " + qualifiedPath + " from status check "+ status+ " in dir "+ listing,len,status.getLen());
  String fileInfo=qualifiedPath + "  " + status;
  assertFalse("File claims to be a directory " + fileInfo,status.isDir());
  FileStatus listedFileStat=resolveChild(parentDirListing,qualifiedPath);
  assertNotNull("Did not find " + path + " in "+ parentDirLS,listedFileStat);
  assertEquals("Wrong len for " + path + " in listing "+ parentDirLS,len,listedFileStat.getLen());
  listedFileStat.toString();
  return status;
}
