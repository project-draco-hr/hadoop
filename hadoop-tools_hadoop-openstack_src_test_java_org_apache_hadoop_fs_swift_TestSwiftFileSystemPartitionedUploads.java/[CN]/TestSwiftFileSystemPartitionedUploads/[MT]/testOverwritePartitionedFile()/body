{
  final Path path=new Path("/test/testOverwritePartitionedFile");
  final int len1=8192;
  final byte[] src1=SwiftTestUtils.dataset(len1,'A','Z');
  FSDataOutputStream out=fs.create(path,false,getBufferSize(),(short)1,1024);
  out.write(src1,0,len1);
  out.close();
  long expected=getExpectedPartitionsWritten(len1,PART_SIZE_BYTES,false);
  assertPartitionsWritten("initial upload",out,expected);
  assertExists("Exists",path);
  FileStatus status=fs.getFileStatus(path);
  assertEquals("Length",len1,status.getLen());
  final int len2=4095;
  final byte[] src2=SwiftTestUtils.dataset(len2,'a','z');
  out=fs.create(path,true,getBufferSize(),(short)1,1024);
  out.write(src2,0,len2);
  out.close();
  status=fs.getFileStatus(path);
  assertEquals("Length",len2,status.getLen());
  byte[] dest=readDataset(fs,path,len2);
  SwiftTestUtils.compareByteArrays(src2,dest,len2);
}
