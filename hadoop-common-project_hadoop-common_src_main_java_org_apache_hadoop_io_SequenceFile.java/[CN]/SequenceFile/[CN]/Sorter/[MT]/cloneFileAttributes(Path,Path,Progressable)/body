{
  Reader reader=new Reader(conf,Reader.file(inputFile),new Reader.OnlyHeaderOption());
  CompressionType compress=reader.getCompressionType();
  CompressionCodec codec=reader.getCompressionCodec();
  reader.close();
  Writer writer=createWriter(conf,Writer.file(outputFile),Writer.keyClass(keyClass),Writer.valueClass(valClass),Writer.compression(compress,codec),Writer.progressable(prog));
  return writer;
}
