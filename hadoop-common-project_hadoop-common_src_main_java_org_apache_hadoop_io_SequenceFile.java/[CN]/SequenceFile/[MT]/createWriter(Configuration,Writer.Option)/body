{
  Writer.CompressionOption compressionOption=Options.getOption(Writer.CompressionOption.class,opts);
  CompressionType kind;
  if (compressionOption != null) {
    kind=compressionOption.getValue();
  }
 else {
    kind=getDefaultCompressionType(conf);
    opts=Options.prependOptions(opts,Writer.compression(kind));
  }
switch (kind) {
default :
case NONE:
    return new Writer(conf,opts);
case RECORD:
  return new RecordCompressWriter(conf,opts);
case BLOCK:
return new BlockCompressWriter(conf,opts);
}
}
