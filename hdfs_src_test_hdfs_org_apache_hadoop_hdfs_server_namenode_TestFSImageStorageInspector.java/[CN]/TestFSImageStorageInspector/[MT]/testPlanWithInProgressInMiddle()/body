{
  FSImageTransactionalStorageInspector inspector=new FSImageTransactionalStorageInspector();
  StorageDirectory mockDir=FSImageTestUtil.mockStorageDirectory(NameNodeDirType.IMAGE_AND_EDITS,false,"/foo/current/" + getImageFileName(123),"/foo/current/" + getImageFileName(456),"/foo/current/" + getFinalizedEditsFileName(457,900),"/foo/current/" + getInProgressEditsFileName(901),"/foo/current/" + getFinalizedEditsFileName(952,1000));
  inspector.inspectDirectory(mockDir);
  mockLogValidation(inspector,"/foo/current/" + getInProgressEditsFileName(901),51);
  LoadPlan plan=inspector.createLoadPlan();
  LOG.info("Plan: " + plan);
  assertEquals(new File("/foo/current/" + getImageFileName(456)),plan.getImageFile());
  assertArrayEquals(new File[]{new File("/foo/current/" + getFinalizedEditsFileName(457,900)),new File("/foo/current/" + getInProgressEditsFileName(901)),new File("/foo/current/" + getFinalizedEditsFileName(952,1000))},plan.getEditsFiles().toArray(new File[0]));
}
