{
  FSImageTransactionalStorageInspector inspector=new FSImageTransactionalStorageInspector();
  StorageDirectory mockDir=FSImageTestUtil.mockStorageDirectory(NameNodeDirType.IMAGE_AND_EDITS,false,"/foo/current/" + getImageFileName(123),"/foo/current/" + getImageFileName(456),"/foo/current/" + getFinalizedEditsFileName(457,900),"/foo/current/" + getFinalizedEditsFileName(901,950),"/foo/current/" + getFinalizedEditsFileName(952,1000));
  inspector.inspectDirectory(mockDir);
  try {
    inspector.createLoadPlan();
    fail("Didn't throw IOE trying to load with gaps in edits");
  }
 catch (  IOException ioe) {
    assertTrue(ioe.getMessage().contains("would start at txid 951 but starts at txid 952"));
  }
}
