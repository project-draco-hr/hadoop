{
  LOG.info("Polling listDirectives{" + ((filter == null) ? "ALL" : filter.toString()) + " for "+ targetFilesAffected+ " targetFilesAffected, "+ targetBytesNeeded+ " targetBytesNeeded, "+ targetBytesCached+ " targetBytesCached");
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      RemoteIterator<CacheDirectiveEntry> iter=null;
      CacheDirectiveEntry entry=null;
      try {
        iter=dfs.listCacheDirectives(filter);
        entry=iter.next();
      }
 catch (      IOException e) {
        fail("got IOException while calling " + "listCacheDirectives: " + e.getMessage());
      }
      Assert.assertNotNull(entry);
      CacheDirectiveStats stats=entry.getStats();
      if ((targetFilesAffected == stats.getFilesAffected()) && (targetBytesNeeded == stats.getBytesNeeded()) && (targetBytesCached == stats.getBytesCached())) {
        return true;
      }
 else {
        LOG.info(infoString + ": filesAffected: " + stats.getFilesAffected()+ "/"+ targetFilesAffected+ ", bytesNeeded: "+ stats.getBytesNeeded()+ "/"+ targetBytesNeeded+ ", bytesCached: "+ stats.getBytesCached()+ "/"+ targetBytesCached);
        return false;
      }
    }
  }
,500,60000);
}
