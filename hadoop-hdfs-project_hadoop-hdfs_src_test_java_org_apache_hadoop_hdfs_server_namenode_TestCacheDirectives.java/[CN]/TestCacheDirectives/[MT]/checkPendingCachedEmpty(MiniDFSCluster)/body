{
  cluster.getNamesystem().readLock();
  try {
    final DatanodeManager datanodeManager=cluster.getNamesystem().getBlockManager().getDatanodeManager();
    for (    DataNode dn : cluster.getDataNodes()) {
      DatanodeDescriptor descriptor=datanodeManager.getDatanode(dn.getDatanodeId());
      Assert.assertTrue("Pending cached list of " + descriptor + " is not empty, "+ Arrays.toString(descriptor.getPendingCached().toArray()),descriptor.getPendingCached().isEmpty());
    }
  }
  finally {
    cluster.getNamesystem().readUnlock();
  }
}
