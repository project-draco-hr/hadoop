{
  cluster.getNamesystem().readLock();
  try {
    final DatanodeManager datanodeManager=cluster.getNamesystem().getBlockManager().getDatanodeManager();
    for (    DataNode dn : cluster.getDataNodes()) {
      DatanodeDescriptor descriptor=datanodeManager.getDatanode(dn.getDatanodeId());
      Assert.assertTrue(descriptor.getPendingCached().isEmpty());
    }
  }
  finally {
    cluster.getNamesystem().readUnlock();
  }
}
