{
  final Path filename=new Path("/noback");
  final short replication=(short)3;
  DFSTestUtil.createFile(dfs,filename,1,replication,0x0BAC);
  dfs.addCachePool(new CachePoolInfo("pool"));
  dfs.addCacheDirective(new CacheDirectiveInfo.Builder().setPool("pool").setPath(filename).setReplication(replication).build());
  waitForCachedBlocks(namenode,1,replication,"testNoBackingReplica:1");
  DataNodeTestUtils.setCacheReportsDisabledForTests(cluster,true);
  try {
    dfs.setReplication(filename,(short)1);
    DFSTestUtil.waitForReplication(dfs,filename,(short)1,30000);
    waitForCachedBlocks(namenode,1,(short)1,"testNoBackingReplica:2");
  }
  finally {
    DataNodeTestUtils.setCacheReportsDisabledForTests(cluster,false);
  }
}
