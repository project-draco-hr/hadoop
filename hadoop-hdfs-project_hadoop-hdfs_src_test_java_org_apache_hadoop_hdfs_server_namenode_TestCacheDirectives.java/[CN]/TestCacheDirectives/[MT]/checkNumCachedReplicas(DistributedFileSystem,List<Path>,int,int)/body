{
  int numCachedBlocks=0;
  int numCachedReplicas=0;
  for (  Path p : paths) {
    final FileStatus f=dfs.getFileStatus(p);
    final long len=f.getLen();
    final long blockSize=f.getBlockSize();
    final long numBlocks=(len + blockSize - 1) / blockSize;
    BlockLocation[] locs=dfs.getFileBlockLocations(p,0,len);
    assertEquals("Unexpected number of block locations for path " + p,numBlocks,locs.length);
    for (    BlockLocation l : locs) {
      if (l.getCachedHosts().length > 0) {
        numCachedBlocks++;
      }
      numCachedReplicas+=l.getCachedHosts().length;
    }
  }
  LOG.info("Found " + numCachedBlocks + " of "+ expectedBlocks+ " blocks");
  LOG.info("Found " + numCachedReplicas + " of "+ expectedReplicas+ " replicas");
  assertEquals("Unexpected number of cached blocks",expectedBlocks,numCachedBlocks);
  assertEquals("Unexpected number of cached replicas",expectedReplicas,numCachedReplicas);
}
