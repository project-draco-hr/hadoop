{
  if (WebHdfsFileSystem.isEnabled(conf,HttpServer.LOG)) {
    UserParam.setUserPattern(conf);
    final String name="SPNEGO";
    final String classname=AuthFilter.class.getName();
    final String pathSpec=WebHdfsFileSystem.PATH_PREFIX + "/*";
    Map<String,String> params=getAuthFilterParams(conf);
    HttpServer.defineFilter(httpServer.getWebAppContext(),name,classname,params,new String[]{pathSpec});
    HttpServer.LOG.info("Added filter '" + name + "' (class="+ classname+ ")");
    httpServer.addJerseyResourcePackage(NamenodeWebHdfsMethods.class.getPackage().getName() + ";" + Param.class.getPackage().getName(),pathSpec);
  }
}
