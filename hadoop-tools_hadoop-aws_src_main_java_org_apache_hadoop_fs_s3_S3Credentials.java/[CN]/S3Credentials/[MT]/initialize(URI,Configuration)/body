{
  if (uri.getHost() == null) {
    throw new IllegalArgumentException("Invalid hostname in URI " + uri);
  }
  S3xLoginHelper.Login login=S3xLoginHelper.extractLoginDetailsWithWarnings(uri);
  if (login.hasLogin()) {
    accessKey=login.getUser();
    secretAccessKey=login.getPassword();
  }
  String scheme=uri.getScheme();
  String accessKeyProperty=String.format("fs.%s.awsAccessKeyId",scheme);
  String secretAccessKeyProperty=String.format("fs.%s.awsSecretAccessKey",scheme);
  if (accessKey == null) {
    accessKey=conf.getTrimmed(accessKeyProperty);
  }
  if (secretAccessKey == null) {
    final char[] pass=conf.getPassword(secretAccessKeyProperty);
    if (pass != null) {
      secretAccessKey=(new String(pass)).trim();
    }
  }
  if (accessKey == null && secretAccessKey == null) {
    throw new IllegalArgumentException("AWS " + "Access Key ID and Secret Access " + "Key must be specified "+ "by setting the " + accessKeyProperty + " and "+ secretAccessKeyProperty+ " properties (respectively).");
  }
 else   if (accessKey == null) {
    throw new IllegalArgumentException("AWS " + "Access Key ID must be specified " + "by setting the " + accessKeyProperty + " property.");
  }
 else   if (secretAccessKey == null) {
    throw new IllegalArgumentException("AWS " + "Secret Access Key must be " + "specified by setting the " + secretAccessKeyProperty + " property.");
  }
}
