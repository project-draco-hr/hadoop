{
  Preconditions.checkState(isActiveWriter,"must recover segments before starting a new one");
  QuorumCall<AsyncLogger,Void> q=loggers.startLogSegment(txId,layoutVersion);
  loggers.waitForWriteQuorum(q,startSegmentTimeoutMs,"startLogSegment(" + txId + ")");
  return new QuorumOutputStream(loggers,txId,outputBufferCapacity,writeTxnsTimeoutMs);
}
