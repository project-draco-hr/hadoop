{
  Preconditions.checkState(!isActiveWriter,"already active writer");
  Map<AsyncLogger,NewEpochResponseProto> resps=createNewUniqueEpoch();
  LOG.info("newEpoch(" + loggers.getEpoch() + ") responses:\n"+ QuorumCall.mapToString(resps));
  long mostRecentSegmentTxId=Long.MIN_VALUE;
  for (  NewEpochResponseProto r : resps.values()) {
    if (r.hasLastSegmentTxId()) {
      mostRecentSegmentTxId=Math.max(mostRecentSegmentTxId,r.getLastSegmentTxId());
    }
  }
  if (mostRecentSegmentTxId != Long.MIN_VALUE) {
    recoverUnclosedSegment(mostRecentSegmentTxId);
  }
  isActiveWriter=true;
}
