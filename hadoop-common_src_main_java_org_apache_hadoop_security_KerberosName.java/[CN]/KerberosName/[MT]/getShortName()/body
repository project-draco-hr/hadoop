{
  String[] params;
  if (hostName == null) {
    if (realm == null) {
      return serviceName;
    }
    params=new String[]{realm,serviceName};
  }
 else {
    params=new String[]{realm,serviceName,hostName};
  }
  for (  Rule r : rules) {
    String result=r.apply(params);
    if (result != null) {
      return result;
    }
  }
  throw new NoMatchingRule("No rules applied to " + toString());
}
