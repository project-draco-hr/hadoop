{
  final String urlPart="browseDirectory.jsp?namenodeInfoPort=";
  ServletContext context=mock(ServletContext.class);
  HttpServletRequest request=mock(HttpServletRequest.class);
  HttpServletResponse resp=mock(HttpServletResponse.class);
  when(request.getScheme()).thenReturn("http");
  when(request.getParameter(UserParam.NAME)).thenReturn("localuser");
  when(context.getAttribute(NAMENODE_ATTRIBUTE_KEY)).thenReturn(cluster.getNameNode());
  when(context.getAttribute(JspHelper.CURRENT_CONF)).thenReturn(conf);
  ArgumentCaptor<String> captor=ArgumentCaptor.forClass(String.class);
  doAnswer(new Answer<String>(){
    @Override public String answer(    InvocationOnMock invocation) throws Throwable {
      return null;
    }
  }
).when(resp).sendRedirect(captor.capture());
  NamenodeJspHelper.redirectToRandomDataNode(context,request,resp);
  assertTrue(captor.getValue().contains(urlPart));
}
