{
  JspWriter out=mock(JspWriter.class);
  ArgumentCaptor<String> captor=ArgumentCaptor.forClass(String.class);
  NamenodeJspHelper.NodeListJsp nodelistjsp=new NamenodeJspHelper.NodeListJsp();
  final StringBuffer buffer=new StringBuffer();
  doAnswer(new Answer<String>(){
    @Override public String answer(    InvocationOnMock invok){
      Object[] args=invok.getArguments();
      buffer.append((String)args[0]);
      return null;
    }
  }
).when(out).print(captor.capture());
  HttpServletRequest request=mock(HttpServletRequest.class);
  when(request.getScheme()).thenReturn("http");
  when(request.getParameter("whatNodes")).thenReturn(dnStatus.name());
  nodelistjsp.generateNodesList(context,out,request);
  return buffer.toString();
}
