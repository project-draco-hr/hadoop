{
  if (next == this) {
    super.collectSubtreeBlocksAndClear(info);
  }
 else {
    long max=next.computeFileSize(true);
    short maxReplication=next.getFileReplication();
    INodeFileWithLink last=next;
    for (INodeFileWithLink i=next.getNext(); i != this; i=i.getNext()) {
      final long size=i.computeFileSize(true);
      if (size > max) {
        max=size;
      }
      final short rep=i.getFileReplication();
      if (rep > maxReplication) {
        maxReplication=rep;
      }
      last=i;
    }
    collectBlocksBeyondMaxAndClear(max,info);
    last.next=this.next;
    this.setFileReplication(maxReplication);
    this.next=null;
    parent=null;
  }
  return 1;
}
