{
  if (next == this) {
    super.collectSubtreeBlocksAndClear(v);
  }
 else {
    long max=next.computeFileSize(true);
    INodeFileWithLink last=next;
    for (INodeFileWithLink i=next.getNext(); i != this; i=i.getNext()) {
      final long size=i.computeFileSize(true);
      if (size > max) {
        max=size;
      }
      last=i;
    }
    collectBlocksBeyondMaxAndClear(max,v);
    last.next=this.next;
    this.next=null;
    parent=null;
  }
  return 1;
}
