{
  long completeTime=metaInfo.getJobIndexInfo().getFinishTime();
  if (completeTime == 0)   completeTime=System.currentTimeMillis();
  JobId jobId=metaInfo.getJobIndexInfo().getJobId();
  List<Path> paths=new ArrayList<Path>();
  Path historyFile=metaInfo.getHistoryFile();
  if (historyFile == null) {
    LOG.info("No file for job-history with " + jobId + " found in cache!");
  }
 else {
    paths.add(historyFile);
  }
  Path confFile=metaInfo.getConfFile();
  if (confFile == null) {
    LOG.info("No file for jobConf with " + jobId + " found in cache!");
  }
 else {
    paths.add(confFile);
  }
  Path summaryFile=metaInfo.getSummaryFile();
  if (summaryFile == null) {
    LOG.info("No summary file for job: " + jobId);
  }
 else {
    try {
      String jobSummaryString=getJobSummary(intermediateDoneDirFc,summaryFile);
      SUMMARY_LOG.info(jobSummaryString);
      LOG.info("Deleting JobSummary file: [" + summaryFile + "]");
      intermediateDoneDirFc.delete(summaryFile,false);
      metaInfo.setSummaryFile(null);
    }
 catch (    IOException e) {
      LOG.warn("Failed to process summary file: [" + summaryFile + "]");
      throw e;
    }
  }
  Path targetDir=canonicalHistoryLogPath(jobId,completeTime);
  addDirectoryToSerialNumberIndex(targetDir);
  try {
    maybeMakeSubdirectory(targetDir);
  }
 catch (  IOException e) {
    LOG.warn("Failed creating subdirectory: " + targetDir + " while attempting to move files for jobId: "+ jobId);
    throw e;
  }
synchronized (metaInfo) {
    if (historyFile != null) {
      Path toPath=doneDirFc.makeQualified(new Path(targetDir,historyFile.getName()));
      try {
        moveToDoneNow(historyFile,toPath);
      }
 catch (      IOException e) {
        LOG.warn("Failed to move file: " + historyFile + " for jobId: "+ jobId);
        throw e;
      }
      metaInfo.setHistoryFile(toPath);
    }
    if (confFile != null) {
      Path toPath=doneDirFc.makeQualified(new Path(targetDir,confFile.getName()));
      try {
        moveToDoneNow(confFile,toPath);
      }
 catch (      IOException e) {
        LOG.warn("Failed to move file: " + historyFile + " for jobId: "+ jobId);
        throw e;
      }
      metaInfo.setConfFile(toPath);
    }
  }
  addToJobListCache(jobId,metaInfo);
  intermediateListCache.remove(jobId);
}
