{
  moveIntermediateToDoneRunnable=new MoveIntermediateToDoneRunnable(moveThreadInterval,numMoveThreads);
  moveIntermediateToDoneThread=new Thread(moveIntermediateToDoneRunnable);
  moveIntermediateToDoneThread.setName("MoveIntermediateToDoneScanner");
  moveIntermediateToDoneThread.start();
  boolean startCleanerService=conf.getBoolean(JHConfig.RUN_HISTORY_CLEANER_KEY,true);
  if (startCleanerService) {
    long maxAgeOfHistoryFiles=conf.getLong(JHConfig.HISTORY_MAXAGE,DEFAULT_HISTORY_MAX_AGE);
    cleanerScheduledExecutor=new ScheduledThreadPoolExecutor(1);
    long runInterval=conf.getLong(JHConfig.HISTORY_CLEANER_RUN_INTERVAL,DEFAULT_RUN_INTERVAL);
    cleanerScheduledExecutor.scheduleAtFixedRate(new HistoryCleaner(maxAgeOfHistoryFiles),30 * 1000l,runInterval,TimeUnit.MILLISECONDS);
  }
  super.start();
}
