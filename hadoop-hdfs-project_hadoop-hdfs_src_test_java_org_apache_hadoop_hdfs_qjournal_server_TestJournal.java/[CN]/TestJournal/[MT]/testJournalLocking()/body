{
  Assume.assumeTrue(journal.getStorage().getStorageDir(0).isLockSupported());
  StorageDirectory sd=journal.getStorage().getStorageDir(0);
  File lockFile=new File(sd.getRoot(),Storage.STORAGE_FILE_LOCK);
  GenericTestUtils.assertExists(lockFile);
  journal.newEpoch(FAKE_NSINFO,1);
  try {
    new Journal(conf,TEST_LOG_DIR,JID,mockErrorReporter);
    fail("Did not fail to create another journal in same dir");
  }
 catch (  IOException ioe) {
    GenericTestUtils.assertExceptionContains("Cannot lock storage",ioe);
  }
  journal.close();
  Journal journal2=new Journal(conf,TEST_LOG_DIR,JID,mockErrorReporter);
  journal2.newEpoch(FAKE_NSINFO,2);
  journal2.close();
}
