{
  StorageDirectory sd=journal.getStorage().getStorageDir(0);
  File lockFile=new File(sd.getRoot(),Storage.STORAGE_FILE_LOCK);
  assertFalse(lockFile.exists());
  journal.newEpoch(FAKE_NSINFO,1);
  Assume.assumeTrue(journal.getStorage().getStorageDir(0).isLockSupported());
  GenericTestUtils.assertExists(lockFile);
  Journal journal2=new Journal(TEST_LOG_DIR,mockErrorReporter);
  try {
    journal2.newEpoch(FAKE_NSINFO,2);
    fail("Did not fail to create another journal in same dir");
  }
 catch (  IOException ioe) {
    GenericTestUtils.assertExceptionContains("Cannot lock storage",ioe);
  }
  journal.close();
  journal2.newEpoch(FAKE_NSINFO,2);
}
