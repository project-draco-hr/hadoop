{
  journal.newEpoch(FAKE_NSINFO,1);
  journal.startLogSegment(makeRI(1),1);
  journal.journal(makeRI(2),1,1,3,QJMTestUtil.createTxnData(1,3));
  try {
    journal.finalizeLogSegment(makeRI(3),1,6);
    fail("did not fail to finalize");
  }
 catch (  JournalOutOfSyncException e) {
    GenericTestUtils.assertExceptionContains("but current state of log is",e);
  }
  journal.close();
  journal=new Journal(TEST_LOG_DIR,JID,mockErrorReporter);
  try {
    journal.finalizeLogSegment(makeRI(4),1,6);
    fail("did not fail to finalize");
  }
 catch (  JournalOutOfSyncException e) {
    GenericTestUtils.assertExceptionContains("but current state of log is",e);
  }
}
