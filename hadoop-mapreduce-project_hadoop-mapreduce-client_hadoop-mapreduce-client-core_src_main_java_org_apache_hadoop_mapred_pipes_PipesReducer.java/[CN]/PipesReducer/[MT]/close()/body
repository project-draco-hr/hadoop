{
  if (isOk) {
    OutputCollector<K3,V3> nullCollector=new OutputCollector<K3,V3>(){
      public void collect(      K3 key,      V3 value) throws IOException {
      }
    }
;
    startApplication(nullCollector,Reporter.NULL);
  }
  try {
    if (isOk) {
      application.getDownlink().endOfInput();
    }
 else {
      application.getDownlink().abort();
    }
    LOG.info("waiting for finish");
    application.waitForFinish();
    LOG.info("got done");
  }
 catch (  Throwable t) {
    application.abort(t);
  }
 finally {
    application.cleanup();
  }
}
