{
  RegisterDatanodeRequestProto req=RegisterDatanodeRequestProto.newBuilder().setRegistration(PBHelper.convert(registration)).build();
  RegisterDatanodeResponseProto resp;
  try {
    resp=rpcProxy.registerDatanode(NULL_CONTROLLER,req);
  }
 catch (  ServiceException se) {
    throw ProtobufHelper.getRemoteException(se);
  }
  return PBHelper.convert(resp.getRegistration());
}
