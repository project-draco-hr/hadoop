{
  EventReader reader=new EventReader(new DataInputStream(new ByteArrayInputStream(getEvents())));
  HistoryEvent e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.JOB_PRIORITY_CHANGED));
  assertEquals("ID",((JobPriorityChange)e.getDatum()).jobid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.JOB_STATUS_CHANGED));
  assertEquals("ID",((JobStatusChanged)e.getDatum()).jobid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.TASK_UPDATED));
  assertEquals("ID",((TaskUpdated)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_KILLED));
  assertEquals("task_1_2_r03_4",((TaskAttemptUnsuccessfulCompletion)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.JOB_KILLED));
  assertEquals("ID",((JobUnsuccessfulCompletion)e.getDatum()).jobid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_STARTED));
  assertEquals("task_1_2_r03_4",((TaskAttemptStarted)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_FINISHED));
  assertEquals("task_1_2_r03_4",((TaskAttemptFinished)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_KILLED));
  assertEquals("task_1_2_r03_4",((TaskAttemptUnsuccessfulCompletion)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_KILLED));
  assertEquals("task_1_2_r03_4",((TaskAttemptUnsuccessfulCompletion)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_STARTED));
  assertEquals("task_1_2_r03_4",((TaskAttemptStarted)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_FINISHED));
  assertEquals("task_1_2_r03_4",((TaskAttemptFinished)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_KILLED));
  assertEquals("task_1_2_r03_4",((TaskAttemptUnsuccessfulCompletion)e.getDatum()).taskid.toString());
  e=reader.getNextEvent();
  assertTrue(e.getEventType().equals(EventType.REDUCE_ATTEMPT_KILLED));
  assertEquals("task_1_2_r03_4",((TaskAttemptUnsuccessfulCompletion)e.getDatum()).taskid.toString());
  reader.close();
}
