{
  Counters cnt=Counters.fromEscapedCompactString(counters);
  for (java.util.Iterator<Counters.Group> grps=cnt.iterator(); grps.hasNext(); ) {
    Counters.Group grp=grps.next();
    for (java.util.Iterator<Counters.Counter> mycounters=grp.iterator(); mycounters.hasNext(); ) {
      Counters.Counter counter=mycounters.next();
      String countername=grp.getDisplayName() + "." + counter.getDisplayName();
      String value=(new Long(counter.getValue())).toString();
      String[] parts={countername,value};
      if (parts[0].equals("FileSystemCounters.FILE_BYTES_READ")) {
        reduceTask.setValue(ReduceTaskKeys.FILE_BYTES_READ,parts[1]);
      }
 else       if (parts[0].equals("FileSystemCounters.FILE_BYTES_WRITTEN")) {
        reduceTask.setValue(ReduceTaskKeys.FILE_BYTES_WRITTEN,parts[1]);
      }
 else       if (parts[0].equals("FileSystemCounters.HDFS_BYTES_READ")) {
        reduceTask.setValue(ReduceTaskKeys.HDFS_BYTES_READ,parts[1]);
      }
 else       if (parts[0].equals("FileSystemCounters.HDFS_BYTES_WRITTEN")) {
        reduceTask.setValue(ReduceTaskKeys.HDFS_BYTES_WRITTEN,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Reduce input records")) {
        reduceTask.setValue(ReduceTaskKeys.INPUT_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Reduce output records")) {
        reduceTask.setValue(ReduceTaskKeys.OUTPUT_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Combine input records")) {
        reduceTask.setValue(ReduceTaskKeys.COMBINE_INPUT_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Combine output records")) {
        reduceTask.setValue(ReduceTaskKeys.COMBINE_OUTPUT_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Reduce input groups")) {
        reduceTask.setValue(ReduceTaskKeys.INPUT_GROUPS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Spilled Records")) {
        reduceTask.setValue(ReduceTaskKeys.SPILLED_RECORDS,parts[1]);
      }
 else       if (parts[0].equals("Map-Reduce Framework.Reduce shuffle bytes")) {
        reduceTask.setValue(ReduceTaskKeys.SHUFFLE_BYTES,parts[1]);
      }
 else {
        System.err.println("ReduceCounterKey:<" + parts[0] + "> ==> NOT INCLUDED IN PERFORMANCE ADVISOR REDUCE TASK");
      }
    }
  }
}
