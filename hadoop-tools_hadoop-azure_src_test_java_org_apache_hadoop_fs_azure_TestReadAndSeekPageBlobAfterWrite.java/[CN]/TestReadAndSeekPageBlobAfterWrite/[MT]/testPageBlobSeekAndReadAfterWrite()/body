{
  writeRandomData(PAGE_SIZE * MAX_PAGES);
  int recordSize=100;
  byte[] b=new byte[recordSize];
  FSDataInputStream stream=fs.open(PATH);
  int seekPosition=5 * PAGE_SIZE + 250;
  stream.seek(seekPosition);
  int bytesRead=stream.read(b);
  verifyReadRandomData(b,bytesRead,seekPosition,recordSize);
  seekPosition=10 * PAGE_SIZE + 250;
  stream.seek(seekPosition);
  recordSize=1000;
  b=new byte[recordSize];
  bytesRead=stream.read(b);
  verifyReadRandomData(b,bytesRead,seekPosition,recordSize);
  recordSize=100;
  seekPosition=PAGE_SIZE * MAX_PAGES - recordSize;
  stream.seek(seekPosition);
  b=new byte[recordSize];
  bytesRead=stream.read(b);
  verifyReadRandomData(b,bytesRead,seekPosition,recordSize);
  recordSize=100;
  seekPosition=PAGE_SIZE * MAX_PAGES - recordSize + 50;
  stream.seek(seekPosition);
  b=new byte[recordSize];
  bytesRead=stream.read(b);
  assertEquals(50,bytesRead);
  byte[] tail=Arrays.copyOfRange(randomData,seekPosition,randomData.length);
  assertTrue(comparePrefix(tail,b,50));
}
