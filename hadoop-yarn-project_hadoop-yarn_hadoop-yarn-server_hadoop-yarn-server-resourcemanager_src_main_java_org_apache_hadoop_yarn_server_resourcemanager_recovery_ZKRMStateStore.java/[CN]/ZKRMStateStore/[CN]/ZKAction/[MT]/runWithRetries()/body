{
  int retry=0;
  while (true) {
    try {
      return runWithCheck();
    }
 catch (    KeeperException.NoAuthException nae) {
      if (HAUtil.isHAEnabled(getConfig())) {
        throw new StoreFencedException();
      }
    }
catch (    KeeperException ke) {
      if (shouldRetry(ke.code()) && ++retry < numRetries) {
        LOG.info("Waiting for zookeeper to be connected, retry no. + " + retry);
        Thread.sleep(zkRetryInterval);
        continue;
      }
      LOG.error("Error while doing ZK operation.",ke);
      throw ke;
    }
  }
}
