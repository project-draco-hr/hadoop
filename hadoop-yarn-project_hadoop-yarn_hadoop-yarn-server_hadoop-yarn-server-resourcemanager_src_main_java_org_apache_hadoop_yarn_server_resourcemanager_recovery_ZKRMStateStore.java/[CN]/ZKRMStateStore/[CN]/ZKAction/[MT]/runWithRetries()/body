{
  int retry=0;
  while (true) {
    try {
      return runWithCheck();
    }
 catch (    KeeperException.NoAuthException nae) {
      if (HAUtil.isHAEnabled(getConfig())) {
        throw new StoreFencedException();
      }
    }
catch (    KeeperException ke) {
      if (ke.code() == Code.NODEEXISTS) {
        LOG.info("znode already exists!");
        return null;
      }
      if (hasDeleteNodeOp && ke.code() == Code.NONODE) {
        LOG.info("znode has already been deleted!");
        return null;
      }
      LOG.info("Exception while executing a ZK operation.",ke);
      if (shouldRetry(ke.code()) && ++retry < numRetries) {
        LOG.info("Retrying operation on ZK. Retry no. " + retry);
        Thread.sleep(zkRetryInterval);
        createConnection();
        continue;
      }
      LOG.info("Maxed out ZK retries. Giving up!");
      throw ke;
    }
  }
}
