{
  String nodeCreatePath=getNodePath(delegationTokensRootPath,DELEGATION_TOKEN_PREFIX + rmDTIdentifier.getSequenceNumber());
  ByteArrayOutputStream seqOs=new ByteArrayOutputStream();
  DataOutputStream seqOut=new DataOutputStream(seqOs);
  RMDelegationTokenIdentifierData identifierData=new RMDelegationTokenIdentifierData(rmDTIdentifier,renewDate);
  try {
    if (LOG.isDebugEnabled()) {
      LOG.debug((isUpdate ? "Storing " : "Updating ") + "RMDelegationToken_" + rmDTIdentifier.getSequenceNumber());
    }
    if (isUpdate) {
      opList.add(Op.setData(nodeCreatePath,identifierData.toByteArray(),-1));
    }
 else {
      opList.add(Op.create(nodeCreatePath,identifierData.toByteArray(),zkAcl,CreateMode.PERSISTENT));
    }
    seqOut.writeInt(latestSequenceNumber);
    if (LOG.isDebugEnabled()) {
      LOG.debug((isUpdate ? "Storing " : "Updating ") + dtSequenceNumberPath + ". SequenceNumber: "+ latestSequenceNumber);
    }
    opList.add(Op.setData(dtSequenceNumberPath,seqOs.toByteArray(),-1));
  }
  finally {
    seqOs.close();
  }
}
