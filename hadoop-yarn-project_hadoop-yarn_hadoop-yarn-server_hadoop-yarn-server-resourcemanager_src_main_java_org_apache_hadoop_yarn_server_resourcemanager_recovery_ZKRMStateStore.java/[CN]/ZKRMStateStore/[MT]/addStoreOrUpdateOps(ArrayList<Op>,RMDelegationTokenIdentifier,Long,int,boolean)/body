{
  String nodeCreatePath=getNodePath(delegationTokensRootPath,DELEGATION_TOKEN_PREFIX + rmDTIdentifier.getSequenceNumber());
  ByteArrayOutputStream tokenOs=new ByteArrayOutputStream();
  DataOutputStream tokenOut=new DataOutputStream(tokenOs);
  ByteArrayOutputStream seqOs=new ByteArrayOutputStream();
  DataOutputStream seqOut=new DataOutputStream(seqOs);
  try {
    rmDTIdentifier.write(tokenOut);
    tokenOut.writeLong(renewDate);
    if (LOG.isDebugEnabled()) {
      LOG.debug((isUpdate ? "Storing " : "Updating ") + "RMDelegationToken_" + rmDTIdentifier.getSequenceNumber());
    }
    if (isUpdate) {
      opList.add(Op.setData(nodeCreatePath,tokenOs.toByteArray(),-1));
    }
 else {
      opList.add(Op.create(nodeCreatePath,tokenOs.toByteArray(),zkAcl,CreateMode.PERSISTENT));
    }
    seqOut.writeInt(latestSequenceNumber);
    if (LOG.isDebugEnabled()) {
      LOG.debug((isUpdate ? "Storing " : "Updating ") + dtSequenceNumberPath + ". SequenceNumber: "+ latestSequenceNumber);
    }
    opList.add(Op.setData(dtSequenceNumberPath,seqOs.toByteArray(),-1));
  }
  finally {
    tokenOs.close();
    seqOs.close();
  }
}
