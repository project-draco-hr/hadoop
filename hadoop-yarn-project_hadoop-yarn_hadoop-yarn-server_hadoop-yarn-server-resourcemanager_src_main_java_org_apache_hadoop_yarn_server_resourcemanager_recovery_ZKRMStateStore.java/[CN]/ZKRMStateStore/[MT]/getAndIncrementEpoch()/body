{
  String epochNodePath=getNodePath(zkRootNodePath,EPOCH_NODE);
  long currentEpoch=0;
  if (existsWithRetries(epochNodePath,true) != null) {
    byte[] data=getDataWithRetries(epochNodePath,true);
    Epoch epoch=new EpochPBImpl(EpochProto.parseFrom(data));
    currentEpoch=epoch.getEpoch();
    byte[] storeData=Epoch.newInstance(currentEpoch + 1).getProto().toByteArray();
    setDataWithRetries(epochNodePath,storeData,-1);
  }
 else {
    byte[] storeData=Epoch.newInstance(currentEpoch + 1).getProto().toByteArray();
    createWithRetries(epochNodePath,storeData,zkAcl,CreateMode.PERSISTENT);
  }
  return currentEpoch;
}
