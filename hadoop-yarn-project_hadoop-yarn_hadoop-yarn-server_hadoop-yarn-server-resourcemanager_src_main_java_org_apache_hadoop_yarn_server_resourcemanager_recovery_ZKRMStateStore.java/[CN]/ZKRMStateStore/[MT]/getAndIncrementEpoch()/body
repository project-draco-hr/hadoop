{
  String epochNodePath=getNodePath(zkRootNodePath,EPOCH_NODE);
  long currentEpoch=0;
  if (exists(epochNodePath)) {
    byte[] data=getData(epochNodePath);
    Epoch epoch=new EpochPBImpl(EpochProto.parseFrom(data));
    currentEpoch=epoch.getEpoch();
    byte[] storeData=Epoch.newInstance(currentEpoch + 1).getProto().toByteArray();
    safeSetData(epochNodePath,storeData,-1);
  }
 else {
    byte[] storeData=Epoch.newInstance(currentEpoch + 1).getProto().toByteArray();
    safeCreate(epochNodePath,storeData,zkAcl,CreateMode.PERSISTENT);
  }
  return currentEpoch;
}
