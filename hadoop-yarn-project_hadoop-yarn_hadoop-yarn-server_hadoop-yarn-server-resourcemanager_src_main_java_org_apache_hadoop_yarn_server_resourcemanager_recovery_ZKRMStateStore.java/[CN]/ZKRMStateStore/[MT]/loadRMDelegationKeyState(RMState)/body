{
  List<String> childNodes=getChildrenWithRetries(dtMasterKeysRootPath,true);
  for (  String childNodeName : childNodes) {
    String childNodePath=getNodePath(dtMasterKeysRootPath,childNodeName);
    byte[] childData=getDataWithRetries(childNodePath,true);
    if (childData == null) {
      LOG.warn("Content of " + childNodePath + " is broken.");
      continue;
    }
    ByteArrayInputStream is=new ByteArrayInputStream(childData);
    DataInputStream fsIn=new DataInputStream(is);
    try {
      if (childNodeName.startsWith(DELEGATION_KEY_PREFIX)) {
        DelegationKey key=new DelegationKey();
        key.readFields(fsIn);
        rmState.rmSecretManagerState.masterKeyState.add(key);
        if (LOG.isDebugEnabled()) {
          LOG.debug("Loaded delegation key: keyId=" + key.getKeyId() + ", expirationDate="+ key.getExpiryDate());
        }
      }
    }
  finally {
      is.close();
    }
  }
}
