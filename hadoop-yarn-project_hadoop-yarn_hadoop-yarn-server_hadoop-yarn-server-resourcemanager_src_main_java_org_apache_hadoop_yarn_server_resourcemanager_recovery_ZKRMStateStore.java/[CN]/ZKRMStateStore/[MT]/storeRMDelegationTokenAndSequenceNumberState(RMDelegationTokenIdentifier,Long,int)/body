{
  ArrayList<Op> opList=new ArrayList<Op>();
  String nodeCreatePath=getNodePath(rmDTSecretManagerRoot,DELEGATION_TOKEN_PREFIX + rmDTIdentifier.getSequenceNumber());
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  DataOutputStream fsOut=new DataOutputStream(os);
  try {
    rmDTIdentifier.write(fsOut);
    fsOut.writeLong(renewDate);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Storing RMDelegationToken_" + rmDTIdentifier.getSequenceNumber());
    }
    opList.add(Op.create(nodeCreatePath,os.toByteArray(),zkAcl,CreateMode.PERSISTENT));
  }
  finally {
    os.close();
  }
  String latestSequenceNumberPath=getNodePath(rmDTSecretManagerRoot,DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX + latestSequenceNumber);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Storing " + DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX + latestSequenceNumber);
  }
  if (dtSequenceNumberPath != null) {
    opList.add(Op.delete(dtSequenceNumberPath,0));
  }
  opList.add(Op.create(latestSequenceNumberPath,null,zkAcl,CreateMode.PERSISTENT));
  dtSequenceNumberPath=latestSequenceNumberPath;
  doMultiWithRetries(opList);
}
