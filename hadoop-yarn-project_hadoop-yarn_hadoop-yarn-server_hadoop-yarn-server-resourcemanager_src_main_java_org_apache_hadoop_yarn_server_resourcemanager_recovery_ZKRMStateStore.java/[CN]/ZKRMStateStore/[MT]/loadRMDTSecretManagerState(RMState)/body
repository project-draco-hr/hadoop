{
  List<String> childNodes=getChildrenWithRetries(rmDTSecretManagerRoot,true);
  for (  String childNodeName : childNodes) {
    if (childNodeName.startsWith(DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX)) {
      rmState.rmSecretManagerState.dtSequenceNumber=Integer.parseInt(childNodeName.split("_")[1]);
      continue;
    }
    String childNodePath=getNodePath(rmDTSecretManagerRoot,childNodeName);
    byte[] childData=getDataWithRetries(childNodePath,true);
    ByteArrayInputStream is=new ByteArrayInputStream(childData);
    DataInputStream fsIn=new DataInputStream(is);
    try {
      if (childNodeName.startsWith(DELEGATION_KEY_PREFIX)) {
        DelegationKey key=new DelegationKey();
        key.readFields(fsIn);
        rmState.rmSecretManagerState.masterKeyState.add(key);
      }
 else       if (childNodeName.startsWith(DELEGATION_TOKEN_PREFIX)) {
        RMDelegationTokenIdentifier identifier=new RMDelegationTokenIdentifier();
        identifier.readFields(fsIn);
        long renewDate=fsIn.readLong();
        rmState.rmSecretManagerState.delegationTokenState.put(identifier,renewDate);
      }
    }
  finally {
      is.close();
    }
  }
}
