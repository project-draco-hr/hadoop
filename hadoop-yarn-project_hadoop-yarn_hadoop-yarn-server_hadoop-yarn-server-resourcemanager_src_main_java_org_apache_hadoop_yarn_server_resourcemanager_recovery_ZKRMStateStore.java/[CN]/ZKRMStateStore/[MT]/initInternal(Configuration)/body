{
  znodeWorkingPath=conf.get(YarnConfiguration.ZK_RM_STATE_STORE_PARENT_PATH,YarnConfiguration.DEFAULT_ZK_RM_STATE_STORE_PARENT_PATH);
  zkRootNodePath=getNodePath(znodeWorkingPath,ROOT_ZNODE_NAME);
  fencingNodePath=getNodePath(zkRootNodePath,FENCING_LOCK);
  rmAppRoot=getNodePath(zkRootNodePath,RM_APP_ROOT);
  zkSessionTimeout=conf.getInt(YarnConfiguration.RM_ZK_TIMEOUT_MS,YarnConfiguration.DEFAULT_RM_ZK_TIMEOUT_MS);
  zkAcl=RMZKUtils.getZKAcls(conf);
  if (HAUtil.isHAEnabled(conf)) {
    String zkRootNodeAclConf=HAUtil.getConfValueForRMInstance(YarnConfiguration.ZK_RM_STATE_STORE_ROOT_NODE_ACL,conf);
    if (zkRootNodeAclConf != null) {
      zkRootNodeAclConf=ZKUtil.resolveConfIndirection(zkRootNodeAclConf);
      try {
        zkRootNodeAcl=ZKUtil.parseACLs(zkRootNodeAclConf);
      }
 catch (      ZKUtil.BadAclFormatException bafe) {
        LOG.error("Invalid format for " + YarnConfiguration.ZK_RM_STATE_STORE_ROOT_NODE_ACL);
        throw bafe;
      }
    }
 else {
      zkRootNodeAcl=constructZkRootNodeACL(conf,zkAcl);
    }
  }
  rmDTSecretManagerRoot=getNodePath(zkRootNodePath,RM_DT_SECRET_MANAGER_ROOT);
  dtMasterKeysRootPath=getNodePath(rmDTSecretManagerRoot,RM_DT_MASTER_KEYS_ROOT_ZNODE_NAME);
  delegationTokensRootPath=getNodePath(rmDTSecretManagerRoot,RM_DELEGATION_TOKENS_ROOT_ZNODE_NAME);
  dtSequenceNumberPath=getNodePath(rmDTSecretManagerRoot,RM_DT_SEQUENTIAL_NUMBER_ZNODE_NAME);
  amrmTokenSecretManagerRoot=getNodePath(zkRootNodePath,AMRMTOKEN_SECRET_MANAGER_ROOT);
  reservationRoot=getNodePath(zkRootNodePath,RESERVATION_SYSTEM_ROOT);
  curatorFramework=resourceManager.getCurator();
  if (curatorFramework == null) {
    curatorFramework=resourceManager.createAndStartCurator(conf);
  }
}
