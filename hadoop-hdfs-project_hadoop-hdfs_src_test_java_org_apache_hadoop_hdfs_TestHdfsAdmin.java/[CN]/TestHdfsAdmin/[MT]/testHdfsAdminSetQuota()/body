{
  HdfsAdmin dfsAdmin=new HdfsAdmin(FileSystem.getDefaultUri(conf),conf);
  FileSystem fs=null;
  try {
    fs=FileSystem.get(conf);
    assertTrue(fs.mkdirs(TEST_PATH));
    assertEquals(-1,fs.getContentSummary(TEST_PATH).getQuota());
    assertEquals(-1,fs.getContentSummary(TEST_PATH).getSpaceQuota());
    dfsAdmin.setSpaceQuota(TEST_PATH,10);
    assertEquals(-1,fs.getContentSummary(TEST_PATH).getQuota());
    assertEquals(10,fs.getContentSummary(TEST_PATH).getSpaceQuota());
    dfsAdmin.setQuota(TEST_PATH,10);
    assertEquals(10,fs.getContentSummary(TEST_PATH).getQuota());
    assertEquals(10,fs.getContentSummary(TEST_PATH).getSpaceQuota());
    dfsAdmin.clearSpaceQuota(TEST_PATH);
    assertEquals(10,fs.getContentSummary(TEST_PATH).getQuota());
    assertEquals(-1,fs.getContentSummary(TEST_PATH).getSpaceQuota());
    dfsAdmin.clearQuota(TEST_PATH);
    assertEquals(-1,fs.getContentSummary(TEST_PATH).getQuota());
    assertEquals(-1,fs.getContentSummary(TEST_PATH).getSpaceQuota());
  }
  finally {
    if (fs != null) {
      fs.close();
    }
  }
}
