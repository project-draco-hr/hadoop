{
  this.conf=conf;
  this.fs=fs;
  this.codec=codec;
  this.comparator=comparator;
  this.reporter=reporter;
  if (taskType == TaskType.MAP) {
    considerFinalMergeForProgress();
  }
  for (  Path file : inputs) {
    LOG.debug("MergeQ: adding: " + file);
    segments.add(new Segment<K,V>(conf,fs,file,codec,!deleteInputs,(file.toString().endsWith(Task.MERGED_OUTPUT_PREFIX) ? null : mergedMapOutputsCounter)));
  }
  Collections.sort(segments,segmentComparator);
}
