{
  String[] subcountersArray=new String[subcounters.size()];
  String escapedName=escape(getName());
  String escapedDispName=escape(getDisplayName());
  int i=0;
  int length=escapedName.length() + escapedDispName.length();
  for (  Counter counter : subcounters.values()) {
    String escapedStr=counter.makeEscapedCompactString();
    subcountersArray[i++]=escapedStr;
    length+=escapedStr.length();
  }
  length+=6;
  StringBuilder builder=new StringBuilder(length);
  builder.append(GROUP_OPEN);
  builder.append(UNIT_OPEN);
  builder.append(escapedName);
  builder.append(UNIT_CLOSE);
  builder.append(UNIT_OPEN);
  builder.append(escapedDispName);
  builder.append(UNIT_CLOSE);
  for (  Counter counter : subcounters.values()) {
    builder.append(counter.makeEscapedCompactString());
  }
  builder.append(GROUP_CLOSE);
  return builder.toString();
}
