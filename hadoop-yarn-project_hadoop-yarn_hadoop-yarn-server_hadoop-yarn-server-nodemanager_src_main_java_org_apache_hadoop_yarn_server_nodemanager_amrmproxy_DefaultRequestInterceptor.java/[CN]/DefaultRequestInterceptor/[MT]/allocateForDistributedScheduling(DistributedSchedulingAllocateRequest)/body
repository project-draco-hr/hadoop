{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Forwarding allocateForDistributedScheduling request" + "to the real YARN RM");
  }
  if (getApplicationContext().getNMCotext().isDistributedSchedulingEnabled()) {
    DistributedSchedulingAllocateResponse allocateResponse=((DistributedSchedulingAMProtocol)rmClient).allocateForDistributedScheduling(request);
    if (allocateResponse.getAllocateResponse().getAMRMToken() != null) {
      updateAMRMToken(allocateResponse.getAllocateResponse().getAMRMToken());
    }
    return allocateResponse;
  }
 else {
    throw new YarnException("Distributed Scheduling is not enabled !!");
  }
}
