{
  super.init(appContext);
  try {
    user=UserGroupInformation.createProxyUser(appContext.getApplicationAttemptId().toString(),UserGroupInformation.getCurrentUser());
    user.addToken(appContext.getAMRMToken());
    final Configuration conf=this.getConf();
    rmClient=user.doAs(new PrivilegedExceptionAction<DistributedSchedulerProtocol>(){
      @Override public DistributedSchedulerProtocol run() throws Exception {
        setAMRMTokenService(conf);
        return ServerRMProxy.createRMProxy(conf,DistributedSchedulerProtocol.class);
      }
    }
);
  }
 catch (  IOException e) {
    String message="Error while creating of RM app master service proxy for attemptId:" + appContext.getApplicationAttemptId().toString();
    if (user != null) {
      message+=", user: " + user;
    }
    LOG.info(message);
    throw new YarnRuntimeException(message,e);
  }
catch (  Exception e) {
    throw new YarnRuntimeException(e);
  }
}
