{
  Map<String,String> map=split(tokenStr);
  if (!map.keySet().equals(ATTRIBUTES)) {
    throw new AuthenticationException("Invalid token string, missing attributes");
  }
  long expires=Long.parseLong(map.get(EXPIRES));
  AuthenticationToken token=new AuthenticationToken(map.get(USER_NAME),map.get(PRINCIPAL),map.get(TYPE));
  token.setExpires(expires);
  return token;
}
