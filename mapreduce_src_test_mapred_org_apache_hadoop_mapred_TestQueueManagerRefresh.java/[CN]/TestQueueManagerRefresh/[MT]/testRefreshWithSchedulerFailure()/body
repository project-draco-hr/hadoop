{
  JobQueueInfo[] queues=getSimpleQueueHierarchy();
  writeQueueConfigurationFile(QUEUES_CONFIG_FILE_PATH,new JobQueueInfo[]{queues[0]});
  QueueManager qManager=new QueueManager();
  try {
    qManager.refreshQueues(null,new MyTaskScheduler().new MyFailingQueueRefresher());
    fail("Queue-refresh should have failed!");
  }
 catch (  Exception e) {
    assertTrue("Exception message should point to a refresh-failure in scheduler!",e.getMessage().contains(QueueManager.MSG_REFRESH_FAILURE_WITH_SCHEDULER_FAILURE));
  }
}
