{
  final StorageType[] storageTypes=readStorageTypes(id,DFS_BLOCK_STORAGE_POLICY_KEY_PREFIX,conf);
  if (storageTypes.length == 0) {
    throw new IllegalArgumentException(DFS_BLOCK_STORAGE_POLICY_KEY_PREFIX + id + " is missing or is empty.");
  }
  final StorageType[] creationFallbacks=readStorageTypes(id,DFS_BLOCK_STORAGE_POLICY_CREATION_FALLBACK_KEY_PREFIX,conf);
  final StorageType[] replicationFallbacks=readStorageTypes(id,DFS_BLOCK_STORAGE_POLICY_REPLICATION_FALLBACK_KEY_PREFIX,conf);
  return new BlockStoragePolicy(id,name,storageTypes,creationFallbacks,replicationFallbacks);
}
