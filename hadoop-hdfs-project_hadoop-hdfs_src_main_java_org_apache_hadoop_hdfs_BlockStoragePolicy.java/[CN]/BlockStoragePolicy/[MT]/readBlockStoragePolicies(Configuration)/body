{
  final BlockStoragePolicy[] policies=new BlockStoragePolicy[ID_MAX + 1];
  final String[] values=conf.getStrings(DFS_BLOCK_STORAGE_POLICIES_KEY);
  for (  String v : values) {
    v=v.trim();
    final int i=v.indexOf(':');
    final String name=v.substring(0,i);
    final byte id=parseID(v.substring(i + 1));
    if (policies[id] != null) {
      throw new IllegalArgumentException("Policy duplication: ID " + id + " appears more than once in "+ DFS_BLOCK_STORAGE_POLICIES_KEY);
    }
    policies[id]=readBlockStoragePolicy(id,name,conf);
    LOG.info(policies[id]);
  }
  return policies;
}
