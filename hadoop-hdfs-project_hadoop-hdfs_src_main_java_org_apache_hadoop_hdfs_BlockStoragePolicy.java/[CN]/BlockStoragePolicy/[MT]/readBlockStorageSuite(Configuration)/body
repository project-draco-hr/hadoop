{
  final BlockStoragePolicy[] policies=new BlockStoragePolicy[1 << ID_BIT_LENGTH];
  final String[] values=conf.getStrings(DFS_BLOCK_STORAGE_POLICIES_KEY);
  if (values == null) {
    return DEFAULT_SUITE;
  }
  byte firstID=-1;
  for (  String v : values) {
    v=v.trim();
    final int i=v.indexOf(':');
    if (i < 0) {
      throwIllegalArgumentException("Failed to parse element \"" + v + "\" (expected format is NAME:ID)",conf);
    }
 else     if (i == 0) {
      throwIllegalArgumentException("Policy name is missing in \"" + v + "\"",conf);
    }
 else     if (i == v.length() - 1) {
      throwIllegalArgumentException("Policy ID is missing in \"" + v + "\"",conf);
    }
    final String name=v.substring(0,i).trim();
    for (int j=1; j < policies.length; j++) {
      if (policies[j] != null && policies[j].name.equals(name)) {
        throwIllegalArgumentException("Policy name duplication: \"" + name + "\" appears more than once",conf);
      }
    }
    final byte id=parseID(v.substring(i + 1).trim(),v,conf);
    if (policies[id] != null) {
      throwIllegalArgumentException("Policy duplication: ID " + id + " appears more than once",conf);
    }
    policies[id]=readBlockStoragePolicy(id,name,conf);
    String prefix="";
    if (firstID == -1) {
      firstID=id;
      prefix="(default) ";
    }
    LOG.info(prefix + policies[id]);
  }
  if (firstID == -1) {
    throwIllegalArgumentException("Empty list is not allowed",conf);
  }
  return new Suite(firstID,policies);
}
