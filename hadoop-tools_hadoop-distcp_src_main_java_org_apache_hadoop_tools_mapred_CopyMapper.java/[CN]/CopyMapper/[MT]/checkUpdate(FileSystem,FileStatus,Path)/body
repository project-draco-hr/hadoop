{
  final FileStatus targetFileStatus;
  try {
    targetFileStatus=targetFS.getFileStatus(target);
  }
 catch (  FileNotFoundException e) {
    return FileAction.OVERWRITE;
  }
  if (targetFileStatus != null && !overWrite) {
    if (canSkip(sourceFS,source,targetFileStatus)) {
      return FileAction.SKIP;
    }
 else     if (append) {
      long targetLen=targetFileStatus.getLen();
      if (targetLen < source.getLen()) {
        FileChecksum sourceChecksum=sourceFS.getFileChecksum(source.getPath(),targetLen);
        if (sourceChecksum != null && sourceChecksum.equals(targetFS.getFileChecksum(target))) {
          return FileAction.APPEND;
        }
      }
    }
  }
  return FileAction.OVERWRITE;
}
