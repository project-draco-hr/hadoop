{
  long initialTime=Time.monotonicNow();
  long totalWait=TimeUnit.MILLISECONDS.convert(time,tu);
  long nextWait=INITIAL_WAIT_MS;
  Event next=null;
  while ((next=poll()) == null) {
    long timeLeft=totalWait - (Time.monotonicNow() - initialTime);
    if (timeLeft <= 0) {
      LOG.debug("timed poll(): timed out");
      break;
    }
 else     if (timeLeft < nextWait * 2) {
      nextWait=timeLeft;
    }
 else {
      nextWait*=2;
    }
    LOG.debug("timed poll(): poll() returned null, sleeping for {} ms",nextWait);
    Thread.sleep(nextWait);
  }
  return next;
}
