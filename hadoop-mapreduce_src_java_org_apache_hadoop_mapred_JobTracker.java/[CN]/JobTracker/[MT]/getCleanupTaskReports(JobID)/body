{
  JobInProgress job=jobs.get(jobid);
  if (job == null || !isJobInited(job)) {
    return EMPTY_TASK_REPORTS;
  }
 else {
    Vector<TaskReport> reports=new Vector<TaskReport>();
    Vector<TaskInProgress> completeTasks=job.reportCleanupTIPs(true);
    for (Iterator<TaskInProgress> it=completeTasks.iterator(); it.hasNext(); ) {
      TaskInProgress tip=it.next();
      reports.add(tip.generateSingleReport());
    }
    Vector<TaskInProgress> incompleteTasks=job.reportCleanupTIPs(false);
    for (Iterator<TaskInProgress> it=incompleteTasks.iterator(); it.hasNext(); ) {
      TaskInProgress tip=it.next();
      reports.add(tip.generateSingleReport());
    }
    return reports.toArray(new TaskReport[reports.size()]);
  }
}
