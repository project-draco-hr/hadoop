{
  String samplerStr=conf.get(CommonConfigurationKeys.HADOOP_TRACE_SAMPLER,CommonConfigurationKeys.HADOOP_TRACE_SAMPLER_DEFAULT);
  if (samplerStr.equals("NeverSampler")) {
    LOG.debug("HTrace is OFF for all spans.");
    return Sampler.NEVER;
  }
 else   if (samplerStr.equals("AlwaysSampler")) {
    LOG.info("HTrace is ON for all spans.");
    return Sampler.ALWAYS;
  }
 else   if (samplerStr.equals("ProbabilitySampler")) {
    double percentage=conf.getDouble("htrace.probability.sampler.percentage",0.01d);
    LOG.info("HTrace is ON for " + percentage + "% of top-level spans.");
    return new ProbabilitySampler(percentage / 100.0d);
  }
 else {
    throw new RuntimeException("Can't create sampler " + samplerStr + ".  Available samplers are NeverSampler, AlwaysSampler, "+ "and ProbabilitySampler.");
  }
}
