{
  RMContainerFinishedEvent finishedEvent=(RMContainerFinishedEvent)event;
  container.finishTime=System.currentTimeMillis();
  container.finishedStatus=finishedEvent.getRemoteContainerStatus();
  updateAttemptMetrics(container);
  container.eventHandler.handle(new RMAppAttemptContainerFinishedEvent(container.appAttemptId,finishedEvent.getRemoteContainerStatus(),container.getAllocatedNode()));
  container.rmContext.getRMApplicationHistoryWriter().containerFinished(container);
  boolean saveNonAMContainerMetaInfo=container.rmContext.getYarnConfiguration().getBoolean(YarnConfiguration.APPLICATION_HISTORY_SAVE_NON_AM_CONTAINER_META_INFO,YarnConfiguration.DEFAULT_APPLICATION_HISTORY_SAVE_NON_AM_CONTAINER_META_INFO);
  if (saveNonAMContainerMetaInfo || container.isAMContainer()) {
    container.rmContext.getSystemMetricsPublisher().containerFinished(container,container.finishTime);
  }
}
