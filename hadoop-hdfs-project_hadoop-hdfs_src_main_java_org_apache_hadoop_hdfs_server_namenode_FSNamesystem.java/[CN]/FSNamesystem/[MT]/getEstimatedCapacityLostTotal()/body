{
  List<DatanodeDescriptor> live=new ArrayList<DatanodeDescriptor>();
  getBlockManager().getDatanodeManager().fetchDatanodes(live,null,true);
  long estimatedCapacityLostTotal=0;
  for (  DatanodeDescriptor node : live) {
    VolumeFailureSummary volumeFailureSummary=node.getVolumeFailureSummary();
    if (volumeFailureSummary != null) {
      estimatedCapacityLostTotal+=volumeFailureSummary.getEstimatedCapacityLostTotal();
    }
  }
  return estimatedCapacityLostTotal;
}
