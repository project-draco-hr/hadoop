{
  String src=srcArg;
  if (NameNode.stateChangeLog.isDebugEnabled()) {
    NameNode.stateChangeLog.debug("DIR* NameSystem.truncate: src=" + src + " newLength="+ newLength);
  }
  HdfsFileStatus stat=null;
  FSPermissionChecker pc=getPermissionChecker();
  checkOperation(OperationCategory.WRITE);
  boolean res;
  byte[][] pathComponents=FSDirectory.getPathComponentsForReservedPath(src);
  writeLock();
  try {
    checkOperation(OperationCategory.WRITE);
    checkNameNodeSafeMode("Cannot truncate for " + src);
    src=dir.resolvePath(pc,src,pathComponents);
    res=truncateInternal(src,newLength,clientName,clientMachine,mtime,pc);
    stat=FSDirStatAndListingOp.getFileInfo(dir,src,false,FSDirectory.isReservedRawName(src),true);
  }
  finally {
    writeUnlock();
  }
  getEditLog().logSync();
  logAuditEvent(true,"truncate",src,null,stat);
  return res;
}
