{
  int start=0;
  int end=0;
  List<Block> toDeleteList=blocks.getToDeleteList();
  while (start < toDeleteList.size()) {
    end=BLOCK_DELETION_INCREMENT + start;
    end=end > toDeleteList.size() ? toDeleteList.size() : end;
    writeLock();
    try {
      for (int i=start; i < end; i++) {
        blockManager.removeBlock(toDeleteList.get(i));
      }
    }
  finally {
      writeUnlock();
    }
    start=end;
  }
}
