{
  List<BlockInfo> toDeleteList=blocks.getToDeleteList();
  Iterator<BlockInfo> iter=toDeleteList.iterator();
  while (iter.hasNext()) {
    writeLock();
    try {
      for (int i=0; i < BLOCK_DELETION_INCREMENT && iter.hasNext(); i++) {
        blockManager.removeBlock(iter.next());
      }
    }
  finally {
      writeUnlock();
    }
  }
}
