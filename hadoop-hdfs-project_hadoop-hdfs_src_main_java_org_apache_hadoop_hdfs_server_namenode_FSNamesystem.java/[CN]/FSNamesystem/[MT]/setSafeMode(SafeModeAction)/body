{
  if (action != SafeModeAction.SAFEMODE_GET) {
    checkSuperuserPrivilege();
switch (action) {
case SAFEMODE_LEAVE:
      if (blockManager.getBytesInFuture() > 0) {
        LOG.error("Refusing to leave safe mode without a force flag. " + "Exiting safe mode will cause a deletion of " + blockManager.getBytesInFuture() + " byte(s). Please use "+ "-forceExit flag to exit safe mode forcefully and data loss is "+ "acceptable.");
      }
 else {
        leaveSafeMode();
      }
    break;
case SAFEMODE_ENTER:
  enterSafeMode(false);
break;
case SAFEMODE_FORCE_EXIT:
if (blockManager.getBytesInFuture() > 0) {
LOG.warn("Leaving safe mode due to forceExit. This will cause a data " + "loss of " + blockManager.getBytesInFuture() + " byte(s).");
blockManager.clearBytesInFuture();
}
 else {
LOG.warn("forceExit used when normal exist would suffice. Treating " + "force exit as normal safe mode exit.");
}
leaveSafeMode();
break;
default :
LOG.error("Unexpected safe mode action");
}
}
return isInSafeMode();
}
