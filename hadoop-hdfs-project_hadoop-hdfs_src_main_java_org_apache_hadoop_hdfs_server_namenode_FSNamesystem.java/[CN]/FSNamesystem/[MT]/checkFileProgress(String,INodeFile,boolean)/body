{
  readLock();
  try {
    if (checkall) {
      for (      BlockInfo block : v.getBlocks()) {
        if (!isCompleteBlock(src,block,blockManager.minReplication)) {
          return false;
        }
      }
    }
 else {
      BlockInfo b=v.getPenultimateBlock();
      if (b != null && !isCompleteBlock(src,b,blockManager.minReplication)) {
        return false;
      }
    }
    return true;
  }
  finally {
    readUnlock();
  }
}
