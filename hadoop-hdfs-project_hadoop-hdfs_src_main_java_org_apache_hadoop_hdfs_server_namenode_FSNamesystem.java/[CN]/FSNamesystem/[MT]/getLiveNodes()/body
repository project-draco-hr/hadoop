{
  final Map<String,Map<String,Object>> info=new HashMap<String,Map<String,Object>>();
  final List<DatanodeDescriptor> live=new ArrayList<DatanodeDescriptor>();
  blockManager.getDatanodeManager().fetchDatanodes(live,null,true);
  for (  DatanodeDescriptor node : live) {
    final Map<String,Object> innerinfo=new HashMap<String,Object>();
    innerinfo.put("lastContact",getLastContact(node));
    innerinfo.put("usedSpace",getDfsUsed(node));
    innerinfo.put("adminState",node.getAdminState().toString());
    innerinfo.put("nonDfsUsedSpace",node.getNonDfsUsed());
    innerinfo.put("capacity",node.getCapacity());
    innerinfo.put("numBlocks",node.numBlocks());
    innerinfo.put("version",node.getSoftwareVersion());
    info.put(node.getHostName(),innerinfo);
  }
  return JSON.toString(info);
}
