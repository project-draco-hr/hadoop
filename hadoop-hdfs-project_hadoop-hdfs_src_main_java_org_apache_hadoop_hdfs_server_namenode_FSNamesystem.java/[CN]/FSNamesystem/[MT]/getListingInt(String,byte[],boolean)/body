{
  DirectoryListing dl;
  FSPermissionChecker pc=getPermissionChecker();
  checkOperation(OperationCategory.READ);
  byte[][] pathComponents=FSDirectory.getPathComponentsForReservedPath(src);
  readLock();
  try {
    checkOperation(OperationCategory.READ);
    src=FSDirectory.resolvePath(src,pathComponents,dir);
    if (isPermissionEnabled) {
      if (dir.isDir(src)) {
        checkPathAccess(pc,src,FsAction.READ_EXECUTE);
      }
 else {
        checkTraverse(pc,src);
      }
    }
    logAuditEvent(true,"listStatus",src);
    dl=dir.getListing(src,startAfter,needLocation);
  }
  finally {
    readUnlock();
  }
  return dl;
}
