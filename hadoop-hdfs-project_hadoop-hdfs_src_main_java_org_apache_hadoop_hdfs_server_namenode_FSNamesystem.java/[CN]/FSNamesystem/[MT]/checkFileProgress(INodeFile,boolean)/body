{
  readLock();
  try {
    if (checkall) {
      for (      BlockInfo block : v.getBlocks()) {
        if (!block.isComplete()) {
          LOG.info("BLOCK* NameSystem.checkFileProgress: " + "block " + block + " has not reached minimal replication "+ blockManager.minReplication);
          return false;
        }
      }
    }
 else {
      BlockInfo b=v.getPenultimateBlock();
      if (b != null && !b.isComplete()) {
        LOG.info("BLOCK* NameSystem.checkFileProgress: " + "block " + b + " has not reached minimal replication "+ blockManager.minReplication);
        return false;
      }
    }
    return true;
  }
  finally {
    readUnlock();
  }
}
