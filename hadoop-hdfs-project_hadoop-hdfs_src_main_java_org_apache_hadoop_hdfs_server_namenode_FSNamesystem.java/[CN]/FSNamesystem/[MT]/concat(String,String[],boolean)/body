{
  checkOperation(OperationCategory.WRITE);
  waitForLoadingFSImage();
  HdfsFileStatus stat=null;
  boolean success=false;
  writeLock();
  try {
    checkOperation(OperationCategory.WRITE);
    checkNameNodeSafeMode("Cannot concat " + target);
    stat=FSDirConcatOp.concat(dir,target,srcs,logRetryCache);
    success=true;
  }
  finally {
    writeUnlock();
    if (success) {
      getEditLog().logSync();
    }
    logAuditEvent(success,"concat",Arrays.toString(srcs),target,stat);
  }
}
