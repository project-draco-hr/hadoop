{
  if (offset < 0) {
    throw new HadoopIllegalArgumentException("Negative offset is not supported. File: " + src);
  }
  if (length < 0) {
    throw new HadoopIllegalArgumentException("Negative length is not supported. File: " + src);
  }
  final LocatedBlocks ret=getBlockLocationsUpdateTimes(src,offset,length,doAccessTime,needBlockToken);
  logAuditEvent(true,"open",src);
  if (checkSafeMode && isInSafeMode()) {
    for (    LocatedBlock b : ret.getLocatedBlocks()) {
      if ((b.getLocations() == null) || (b.getLocations().length == 0)) {
        SafeModeException se=new SafeModeException("Zero blocklocations for " + src,safeMode);
        if (haEnabled && haContext != null && haContext.getState().getServiceState() == HAServiceState.ACTIVE) {
          throw new RetriableException(se);
        }
 else {
          throw se;
        }
      }
    }
  }
  return ret;
}
