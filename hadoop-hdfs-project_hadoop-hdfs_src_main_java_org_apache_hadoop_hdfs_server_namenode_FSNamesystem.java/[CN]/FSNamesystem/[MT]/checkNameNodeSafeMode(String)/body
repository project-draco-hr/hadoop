{
  if (isInSafeMode()) {
    SafeModeException se=newSafemodeException(errorMsg);
    if (haEnabled && haContext != null && haContext.getState().getServiceState() == HAServiceState.ACTIVE && shouldRetrySafeMode(this.safeMode)) {
      throw new RetriableException(se);
    }
 else {
      throw se;
    }
  }
}
