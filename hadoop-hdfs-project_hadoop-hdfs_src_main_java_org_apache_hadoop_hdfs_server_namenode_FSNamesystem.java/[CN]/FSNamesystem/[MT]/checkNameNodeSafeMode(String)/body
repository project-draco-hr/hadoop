{
  if (isInSafeMode()) {
    SafeModeException se=newSafemodeException(errorMsg);
    if (haEnabled && haContext != null && haContext.getState().getServiceState() == HAServiceState.ACTIVE && isInStartupSafeMode()) {
      throw new RetriableException(se);
    }
 else {
      throw se;
    }
  }
}
