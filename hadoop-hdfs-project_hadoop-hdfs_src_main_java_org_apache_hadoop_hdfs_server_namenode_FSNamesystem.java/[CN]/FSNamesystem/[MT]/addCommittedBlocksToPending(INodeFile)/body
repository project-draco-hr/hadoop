{
  final BlockInfo[] blocks=pendingFile.getBlocks();
  int i=blocks.length - numCommittedAllowed;
  if (i < 0) {
    i=0;
  }
  for (; i < blocks.length; i++) {
    final BlockInfo b=blocks[i];
    if (b != null && b.getBlockUCState() == BlockUCState.COMMITTED) {
      blockManager.addExpectedReplicasToPending(b);
    }
  }
}
