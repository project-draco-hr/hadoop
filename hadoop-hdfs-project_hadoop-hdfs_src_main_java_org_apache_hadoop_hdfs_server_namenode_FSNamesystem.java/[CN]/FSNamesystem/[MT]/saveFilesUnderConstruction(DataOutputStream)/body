{
synchronized (leaseManager) {
    out.writeInt(leaseManager.countPath());
    for (    Lease lease : leaseManager.getSortedLeases()) {
      for (      String path : lease.getPaths()) {
        final INodeFileUnderConstruction cons;
        try {
          cons=INodeFileUnderConstruction.valueOf(dir.getINode(path),path);
        }
 catch (        UnresolvedLinkException e) {
          throw new AssertionError("Lease files should reside on this FS");
        }
        FSImageSerialization.writeINodeUnderConstruction(out,cons,path);
      }
    }
  }
}
