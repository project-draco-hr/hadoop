{
  FSImage fsImage=new FSImage(conf);
  FSNamesystem namesystem=new FSNamesystem(conf,fsImage);
  long loadStart=now();
  StartupOption startOpt=NameNode.getStartupOption(conf);
  namesystem.loadFSImage(startOpt,fsImage);
  long timeTakenToLoadFSImage=now() - loadStart;
  LOG.info("Finished loading FSImage in " + timeTakenToLoadFSImage + " msecs");
  NameNode.getNameNodeMetrics().setFsImageLoadTime((int)timeTakenToLoadFSImage);
  return namesystem;
}
