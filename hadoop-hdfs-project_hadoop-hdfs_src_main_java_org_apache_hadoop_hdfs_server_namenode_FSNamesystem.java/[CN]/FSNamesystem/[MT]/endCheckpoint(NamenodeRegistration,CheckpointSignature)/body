{
  writeLock();
  try {
    if (isInSafeMode()) {
      throw new SafeModeException("Checkpoint not ended",safeMode);
    }
    LOG.info("End checkpoint for " + registration.getAddress());
    getFSImage().endCheckpoint(sig,registration.getRole());
  }
  finally {
    writeUnlock();
  }
}
