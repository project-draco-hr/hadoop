{
  Map<String,Map<File,StorageDirType>> statusMap=new HashMap<String,Map<File,StorageDirType>>();
  Map<File,StorageDirType> activeDirs=new HashMap<File,StorageDirType>();
  for (Iterator<StorageDirectory> it=getFSImage().getStorage().dirIterator(); it.hasNext(); ) {
    StorageDirectory st=it.next();
    activeDirs.put(st.getRoot(),st.getStorageDirType());
  }
  statusMap.put("active",activeDirs);
  List<Storage.StorageDirectory> removedStorageDirs=getFSImage().getStorage().getRemovedStorageDirs();
  Map<File,StorageDirType> failedDirs=new HashMap<File,StorageDirType>();
  for (  StorageDirectory st : removedStorageDirs) {
    failedDirs.put(st.getRoot(),st.getStorageDirType());
  }
  statusMap.put("failed",failedDirs);
  return JSON.toString(statusMap);
}
