{
  SnapshotDiffReport diffs;
  checkOperation(OperationCategory.READ);
  final FSPermissionChecker pc=getPermissionChecker();
  readLock();
  try {
    checkOperation(OperationCategory.READ);
    if (isPermissionEnabled) {
      checkSubtreeReadPermission(pc,path,fromSnapshot);
      checkSubtreeReadPermission(pc,path,toSnapshot);
    }
    diffs=snapshotManager.diff(path,fromSnapshot,toSnapshot);
  }
  finally {
    readUnlock();
  }
  if (auditLog.isInfoEnabled() && isExternalInvocation()) {
    logAuditEvent(true,"computeSnapshotDiff",null,null,null);
  }
  return diffs;
}
