{
  writeLock();
  try {
    stopSecretManager();
    boolean isEditlogOpenForWrite=getEditLog().isOpenForWrite();
    if (isEditlogOpenForWrite) {
      getEditLog().logSyncAll();
    }
    setManualAndResourceLowSafeMode(!resourcesLow,resourcesLow);
    NameNode.stateChangeLog.info("STATE* Safe mode is ON.\n" + getSafeModeTip());
    if (isEditlogOpenForWrite) {
      getEditLog().logSyncAll();
    }
    NameNode.stateChangeLog.info("STATE* Safe mode is ON" + getSafeModeTip());
  }
  finally {
    writeUnlock();
  }
}
