{
  if (!FileSystem.areSymlinksEnabled()) {
    throw new UnsupportedOperationException("Symlinks not supported");
  }
  HdfsFileStatus auditStat=null;
  writeLock();
  try {
    checkOperation(OperationCategory.WRITE);
    checkNameNodeSafeMode("Cannot create symlink " + link);
    auditStat=FSDirSymlinkOp.createSymlinkInt(this,target,link,dirPerms,createParent,logRetryCache);
  }
 catch (  AccessControlException e) {
    logAuditEvent(false,"createSymlink",link,target,null);
    throw e;
  }
 finally {
    writeUnlock();
  }
  getEditLog().logSync();
  logAuditEvent(true,"createSymlink",link,target,auditStat);
}
