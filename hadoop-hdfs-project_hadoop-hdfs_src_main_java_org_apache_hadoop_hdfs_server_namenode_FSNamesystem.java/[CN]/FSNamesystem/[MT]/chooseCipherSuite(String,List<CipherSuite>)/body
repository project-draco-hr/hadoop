{
  EncryptionZone zone=getEncryptionZoneForPath(src);
  if (zone == null) {
    return null;
  }
  CipherSuite chosen=null;
  for (  CipherSuite c : cipherSuites) {
    if (c.equals(CipherSuite.UNKNOWN)) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Ignoring unknown CipherSuite provided by client: " + c.getUnknownValue());
      }
      continue;
    }
    for (    CipherSuite supported : CipherSuite.values()) {
      if (supported.equals(c)) {
        chosen=c;
        break;
      }
    }
  }
  if (chosen == null) {
    throw new UnknownCipherSuiteException("No cipher suites provided by the client are supported." + " Client provided: " + Arrays.toString(cipherSuites.toArray()) + " NameNode supports: "+ Arrays.toString(CipherSuite.values()));
  }
  return chosen;
}
