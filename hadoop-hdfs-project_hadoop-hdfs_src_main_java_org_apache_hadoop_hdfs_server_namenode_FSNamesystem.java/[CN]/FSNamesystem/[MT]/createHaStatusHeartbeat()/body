{
  HAState state=haContext.getState();
  NNHAStatusHeartbeat.State hbState;
  if (state.getServiceState() == HAServiceState.ACTIVE) {
    hbState=NNHAStatusHeartbeat.State.ACTIVE;
  }
 else   if (state.getServiceState() == HAServiceState.STANDBY) {
    hbState=NNHAStatusHeartbeat.State.STANDBY;
  }
 else {
    throw new AssertionError("Invalid state: " + state.getClass());
  }
  return new NNHAStatusHeartbeat(hbState,getFSImage().getLastAppliedOrWrittenTxId());
}
