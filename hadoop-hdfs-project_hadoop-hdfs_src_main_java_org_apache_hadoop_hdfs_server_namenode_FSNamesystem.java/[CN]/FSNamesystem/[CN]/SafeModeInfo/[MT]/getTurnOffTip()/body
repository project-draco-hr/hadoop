{
  if (!isOn()) {
    return "Safe mode is OFF.";
  }
  String adminMsg="It was turned on manually. ";
  if (areResourcesLow()) {
    adminMsg="Resources are low on NN. Please add or free up more " + "resources then turn off safe mode manually. NOTE:  If you turn off" + " safe mode before adding resources, "+ "the NN will immediately return to safe mode. ";
  }
  if (isManual() || areResourcesLow()) {
    return adminMsg + "Use \"hdfs dfsadmin -safemode leave\" to turn safe mode off.";
  }
  boolean thresholdsMet=true;
  int numLive=getNumLiveDataNodes();
  String msg="";
  if (blockSafe < blockThreshold) {
    msg+=String.format("The reported blocks %d needs additional %d" + " blocks to reach the threshold %.4f of total blocks %d.%n",blockSafe,(blockThreshold - blockSafe),threshold,blockTotal);
    thresholdsMet=false;
  }
 else {
    msg+=String.format("The reported blocks %d has reached the threshold" + " %.4f of total blocks %d. ",blockSafe,threshold,blockTotal);
  }
  if (numLive < datanodeThreshold) {
    msg+=String.format("The number of live datanodes %d needs an additional %d live " + "datanodes to reach the minimum number %d.%n",numLive,(datanodeThreshold - numLive),datanodeThreshold);
    thresholdsMet=false;
  }
 else {
    msg+=String.format("The number of live datanodes %d has reached " + "the minimum number %d. ",numLive,datanodeThreshold);
  }
  msg+=(reached > 0) ? "In safe mode extension. " : "";
  msg+="Safe mode will be turned off automatically ";
  if (!thresholdsMet) {
    msg+="once the thresholds have been reached.";
  }
 else   if (reached + extension - monotonicNow() > 0) {
    msg+=("in " + (reached + extension - monotonicNow()) / 1000 + " seconds.");
  }
 else {
    msg+="soon.";
  }
  return msg;
}
