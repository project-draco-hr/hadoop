{
  BlockStoragePolicy lpPolicy=blockManager.getStoragePolicy("LAZY_PERSIST");
  List<BlockCollection> filesToDelete=new ArrayList<BlockCollection>();
  writeLock();
  try {
    final Iterator<Block> it=blockManager.getCorruptReplicaBlockIterator();
    while (it.hasNext()) {
      Block b=it.next();
      BlockInfoContiguous blockInfo=blockManager.getStoredBlock(b);
      if (blockInfo.getBlockCollection().getStoragePolicyID() == lpPolicy.getId()) {
        filesToDelete.add(blockInfo.getBlockCollection());
      }
    }
    for (    BlockCollection bc : filesToDelete) {
      LOG.warn("Removing lazyPersist file " + bc.getName() + " with no replicas.");
      BlocksMapUpdateInfo toRemoveBlocks=FSDirDeleteOp.deleteInternal(FSNamesystem.this,bc.getName(),INodesInPath.fromINode((INodeFile)bc),false);
      if (toRemoveBlocks != null) {
        removeBlocks(toRemoveBlocks);
      }
    }
  }
  finally {
    writeUnlock();
  }
}
