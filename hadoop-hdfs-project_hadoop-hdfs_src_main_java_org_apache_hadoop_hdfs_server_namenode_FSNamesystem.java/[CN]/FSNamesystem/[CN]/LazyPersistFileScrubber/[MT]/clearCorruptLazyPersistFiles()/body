{
  List<BlockCollection> filesToDelete=new ArrayList<BlockCollection>();
  writeLock();
  try {
    final Iterator<Block> it=blockManager.getCorruptReplicaBlockIterator();
    while (it.hasNext()) {
      Block b=it.next();
      BlockInfo blockInfo=blockManager.getStoredBlock(b);
      if (blockInfo.getBlockCollection().getLazyPersistFlag()) {
        filesToDelete.add(blockInfo.getBlockCollection());
      }
    }
    for (    BlockCollection bc : filesToDelete) {
      LOG.warn("Removing lazyPersist file " + bc.getName() + " with no replicas.");
      deleteInternal(bc.getName(),false,false,false);
    }
  }
  finally {
    writeUnlock();
  }
}
