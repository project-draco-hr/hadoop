{
  return Iterables.filter(getStorages(blocks.get(b)),new Predicate<DatanodeStorageInfo>(){
    @Override public boolean apply(    DatanodeStorageInfo storage){
      return storage.getState() == state;
    }
  }
);
}
