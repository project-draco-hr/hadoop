{
  BlockInfo blockInfo=blocks.remove(block);
  if (blockInfo == null)   return;
  blockInfo.setBlockCollection(null);
  final int size=blockInfo instanceof BlockInfoContiguous ? blockInfo.numNodes() : blockInfo.getCapacity();
  for (int idx=size - 1; idx >= 0; idx--) {
    DatanodeDescriptor dn=blockInfo.getDatanode(idx);
    if (dn != null) {
      dn.removeBlock(blockInfo);
    }
  }
}
