{
  BlockInfo blockInfo=blocks.remove(block);
  if (blockInfo == null)   return;
  blockInfo.setBlockCollectionId(INodeId.INVALID_INODE_ID);
  final int size=blockInfo.isStriped() ? blockInfo.getCapacity() : blockInfo.numNodes();
  for (int idx=size - 1; idx >= 0; idx--) {
    DatanodeDescriptor dn=blockInfo.getDatanode(idx);
    if (dn != null) {
      removeBlock(dn,blockInfo);
    }
  }
}
