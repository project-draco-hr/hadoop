{
  BlockInfo blockInfo=blocks.remove(block);
  if (blockInfo == null)   return;
  blockInfo.setBlockCollectionId(INodeId.INVALID_INODE_ID);
  for (int idx=blockInfo.numNodes() - 1; idx >= 0; idx--) {
    DatanodeDescriptor dn=blockInfo.getDatanode(idx);
    dn.removeBlock(blockInfo);
  }
}
