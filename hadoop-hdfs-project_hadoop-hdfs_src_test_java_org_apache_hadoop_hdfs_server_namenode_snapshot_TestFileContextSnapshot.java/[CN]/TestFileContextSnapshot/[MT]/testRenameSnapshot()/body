{
  DFSTestUtil.createFile(dfs,filePath,BLOCKSIZE,REPLICATION,SEED);
  dfs.allowSnapshot(snapRootPath);
  Path snapPath1=fileContext.createSnapshot(snapRootPath,"s1");
  Path ssPath=new Path(snapPath1,filePath.getName());
  assertTrue("Failed to create snapshot",dfs.exists(ssPath));
  FileStatus statusBeforeRename=dfs.getFileStatus(ssPath);
  fileContext.renameSnapshot(snapRootPath,"s1","s2");
  assertFalse("Old snapshot still exists after rename!",dfs.exists(ssPath));
  Path snapshotRoot=SnapshotTestHelper.getSnapshotRoot(snapRootPath,"s2");
  ssPath=new Path(snapshotRoot,filePath.getName());
  assertTrue("Snapshot doesn't exists!",dfs.exists(ssPath));
  FileStatus statusAfterRename=dfs.getFileStatus(ssPath);
  assertFalse("Filestatus of the snapshot matches",statusBeforeRename.equals(statusAfterRename));
  statusBeforeRename.setPath(statusAfterRename.getPath());
  assertEquals("FileStatus of the snapshot mismatches!",statusBeforeRename.toString(),statusAfterRename.toString());
}
