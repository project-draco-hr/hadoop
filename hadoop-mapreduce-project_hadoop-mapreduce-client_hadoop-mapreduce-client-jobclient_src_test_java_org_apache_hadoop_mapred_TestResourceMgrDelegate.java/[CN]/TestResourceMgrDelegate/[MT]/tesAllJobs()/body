{
  ClientRMProtocol applicationsManager=Mockito.mock(ClientRMProtocol.class);
  GetAllApplicationsResponse allApplicationsResponse=Records.newRecord(GetAllApplicationsResponse.class);
  List<ApplicationReport> applications=new ArrayList<ApplicationReport>();
  applications.add(getApplicationReport(YarnApplicationState.FINISHED,FinalApplicationStatus.FAILED));
  applications.add(getApplicationReport(YarnApplicationState.FINISHED,FinalApplicationStatus.SUCCEEDED));
  applications.add(getApplicationReport(YarnApplicationState.FINISHED,FinalApplicationStatus.KILLED));
  applications.add(getApplicationReport(YarnApplicationState.FAILED,FinalApplicationStatus.FAILED));
  allApplicationsResponse.setApplicationList(applications);
  Mockito.when(applicationsManager.getAllApplications(Mockito.any(GetAllApplicationsRequest.class))).thenReturn(allApplicationsResponse);
  ResourceMgrDelegate resourceMgrDelegate=new ResourceMgrDelegate(new YarnConfiguration(),applicationsManager);
  JobStatus[] allJobs=resourceMgrDelegate.getAllJobs();
  Assert.assertEquals(State.FAILED,allJobs[0].getState());
  Assert.assertEquals(State.SUCCEEDED,allJobs[1].getState());
  Assert.assertEquals(State.KILLED,allJobs[2].getState());
  Assert.assertEquals(State.FAILED,allJobs[3].getState());
}
