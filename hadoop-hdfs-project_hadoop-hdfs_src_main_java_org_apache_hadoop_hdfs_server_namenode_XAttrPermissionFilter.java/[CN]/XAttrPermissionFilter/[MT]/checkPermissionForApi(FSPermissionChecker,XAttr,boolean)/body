{
  final boolean isSuperUser=pc.isSuperUser();
  if (xAttr.getNameSpace() == XAttr.NameSpace.USER || (xAttr.getNameSpace() == XAttr.NameSpace.TRUSTED && isSuperUser)) {
    return;
  }
  if (xAttr.getNameSpace() == XAttr.NameSpace.RAW && isRawPath && isSuperUser) {
    return;
  }
  throw new AccessControlException("User doesn't have permission for xattr: " + XAttrHelper.getPrefixName(xAttr));
}
