{
  JobConf conf=new JobConf(TestJavaSerialization.class);
  conf.setJobName("JavaSerialization");
  FileSystem fs=FileSystem.get(conf);
  cleanAndCreateInput(fs);
  conf.set("io.serializations","org.apache.hadoop.io.serializer.JavaSerialization," + "org.apache.hadoop.io.serializer.WritableSerialization");
  conf.setInputFormat(TextInputFormat.class);
  conf.setOutputFormat(SequenceFileOutputFormat.class);
  conf.setOutputKeyClass(String.class);
  conf.setOutputValueClass(Long.class);
  conf.setOutputKeyComparatorClass(JavaSerializationComparator.class);
  conf.setMapperClass(WordCountMapper.class);
  conf.setReducerClass(SumReducer.class);
  conf.set(MRConfig.FRAMEWORK_NAME,MRConfig.LOCAL_FRAMEWORK_NAME);
  FileInputFormat.setInputPaths(conf,INPUT_DIR);
  FileOutputFormat.setOutputPath(conf,OUTPUT_DIR);
  JobClient.runJob(conf);
  Path[] outputFiles=FileUtil.stat2Paths(fs.listStatus(OUTPUT_DIR,new Utils.OutputFileUtils.OutputFilesFilter()));
  assertEquals(1,outputFiles.length);
}
