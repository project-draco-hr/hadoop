{
  this.path=path;
  this.nextLocation=0;
  this.stat=lfs.getFileStatus(path);
  long numBlocks=(this.stat.getLen() % this.stat.getBlockSize() == 0) ? this.stat.getLen() / this.stat.getBlockSize() : 1 + this.stat.getLen() / this.stat.getBlockSize();
  this.underlyingBlocks=new UnderlyingBlock[(int)numBlocks];
  for (int i=0; i < numBlocks; i++) {
    long actualFileOffset=i * stat.getBlockSize();
    long originalFileOffset=i * stat.getBlockSize();
    long length=Math.min(stat.getBlockSize(),stat.getLen() - originalFileOffset);
    this.underlyingBlocks[i]=new UnderlyingBlock(path,actualFileOffset,originalFileOffset,length);
  }
  this.currentOffset=0;
  this.currentBlock=null;
  this.alternates=alternates;
  this.buffersize=buffersize;
  this.conf=conf;
  this.lfs=lfs;
  this.stripeLength=stripeLength;
  openCurrentStream();
}
