{
  this.conf=conf;
  int serialNumberLowDigits=3;
  serialNumberFormat=("%0" + (JobHistoryUtils.SERIAL_NUMBER_DIRECTORY_DIGITS + serialNumberLowDigits) + "d");
  long maxFSWaitTime=conf.getLong(JHAdminConfig.MR_HISTORY_MAX_START_WAIT_TIME,JHAdminConfig.DEFAULT_MR_HISTORY_MAX_START_WAIT_TIME);
  createHistoryDirs(SystemClock.getInstance(),10 * 1000,maxFSWaitTime);
  maxTasksForLoadedJob=conf.getInt(JHAdminConfig.MR_HS_LOADED_JOBS_TASKS_MAX,JHAdminConfig.DEFAULT_MR_HS_LOADED_JOBS_TASKS_MAX);
  this.aclsMgr=new JobACLsManager(conf);
  maxHistoryAge=conf.getLong(JHAdminConfig.MR_HISTORY_MAX_AGE_MS,JHAdminConfig.DEFAULT_MR_HISTORY_MAX_AGE);
  jobListCache=createJobListCache();
  serialNumberIndex=new SerialNumberIndex(conf.getInt(JHAdminConfig.MR_HISTORY_DATESTRING_CACHE_SIZE,JHAdminConfig.DEFAULT_MR_HISTORY_DATESTRING_CACHE_SIZE));
  int numMoveThreads=conf.getInt(JHAdminConfig.MR_HISTORY_MOVE_THREAD_COUNT,JHAdminConfig.DEFAULT_MR_HISTORY_MOVE_THREAD_COUNT);
  moveToDoneExecutor=createMoveToDoneThreadPool(numMoveThreads);
  super.serviceInit(conf);
}
