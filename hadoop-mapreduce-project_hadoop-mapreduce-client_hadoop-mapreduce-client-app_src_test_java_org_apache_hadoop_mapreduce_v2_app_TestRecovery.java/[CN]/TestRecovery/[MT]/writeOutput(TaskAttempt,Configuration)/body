{
  TaskAttemptContext tContext=new TaskAttemptContextImpl(conf,TypeConverter.fromYarn(attempt.getID()));
  TextOutputFormat<?,?> theOutputFormat=new TextOutputFormat();
  RecordWriter theRecordWriter=theOutputFormat.getRecordWriter(tContext);
  NullWritable nullWritable=NullWritable.get();
  try {
    theRecordWriter.write(key1,val1);
    theRecordWriter.write(null,nullWritable);
    theRecordWriter.write(null,val1);
    theRecordWriter.write(nullWritable,val2);
    theRecordWriter.write(key2,nullWritable);
    theRecordWriter.write(key1,null);
    theRecordWriter.write(null,null);
    theRecordWriter.write(key2,val2);
  }
  finally {
    theRecordWriter.close(tContext);
  }
  OutputFormat outputFormat=ReflectionUtils.newInstance(tContext.getOutputFormatClass(),conf);
  OutputCommitter committer=outputFormat.getOutputCommitter(tContext);
  committer.commitTask(tContext);
}
