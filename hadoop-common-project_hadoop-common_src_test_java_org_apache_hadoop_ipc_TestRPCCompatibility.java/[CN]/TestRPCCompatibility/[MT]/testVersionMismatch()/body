{
  server=RPC.getServer(TestProtocol2.class,new TestImpl2(),ADDRESS,0,2,false,conf,null);
  server.start();
  addr=NetUtils.getConnectAddress(server);
  TestProtocol4 proxy=RPC.getProxy(TestProtocol4.class,TestProtocol4.versionID,addr,conf);
  try {
    proxy.echo(21);
    fail("The call must throw VersionMismatch exception");
  }
 catch (  IOException ex) {
    Assert.assertTrue("Expected version mismatch but got " + ex.getMessage(),ex.getMessage().contains("VersionMismatch"));
  }
}
