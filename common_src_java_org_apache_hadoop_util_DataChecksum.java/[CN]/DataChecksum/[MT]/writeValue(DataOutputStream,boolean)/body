{
  if (size <= 0) {
    return 0;
  }
  if (type == CHECKSUM_CRC32) {
    out.writeInt((int)summer.getValue());
  }
 else {
    throw new IOException("Unknown Checksum " + type);
  }
  if (reset) {
    reset();
  }
  return size;
}
