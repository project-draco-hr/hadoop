{
  Job newJob=new JobImpl(appAttemptID,conf,dispatcher.getEventHandler(),taskAttemptListener,jobTokenSecretManager,fsTokens,clock,completedTasksFromPreviousRun,metrics,currentUser.getUserName(),appSubmitTime,amInfos);
  ((RunningAppContext)context).jobs.put(newJob.getID(),newJob);
  dispatcher.register(JobFinishEvent.Type.class,createJobFinishEventHandler());
  return newJob;
}
