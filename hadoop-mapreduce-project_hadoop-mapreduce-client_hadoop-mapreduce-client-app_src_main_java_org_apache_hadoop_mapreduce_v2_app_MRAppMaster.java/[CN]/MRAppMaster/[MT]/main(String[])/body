{
  try {
    ApplicationId applicationId=RecordFactoryProvider.getRecordFactory(null).newRecordInstance(ApplicationId.class);
    applicationId.setClusterTimestamp(Long.valueOf(args[0]));
    applicationId.setId(Integer.valueOf(args[1]));
    int failCount=Integer.valueOf(args[2]);
    MRAppMaster appMaster=new MRAppMaster(applicationId,failCount);
    Runtime.getRuntime().addShutdownHook(new CompositeServiceShutdownHook(appMaster));
    YarnConfiguration conf=new YarnConfiguration(new JobConf());
    conf.addResource(new Path(MRJobConfig.JOB_CONF_FILE));
    conf.set(MRJobConfig.USER_NAME,System.getProperty("user.name"));
    UserGroupInformation.setConfiguration(conf);
    appMaster.init(conf);
    appMaster.start();
  }
 catch (  Throwable t) {
    LOG.fatal("Error starting MRAppMaster",t);
    System.exit(1);
  }
}
