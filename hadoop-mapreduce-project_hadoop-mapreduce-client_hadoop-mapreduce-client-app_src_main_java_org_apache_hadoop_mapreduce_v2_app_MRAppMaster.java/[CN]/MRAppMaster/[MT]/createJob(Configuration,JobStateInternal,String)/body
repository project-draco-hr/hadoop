{
  Job newJob=new JobImpl(jobId,appAttemptID,conf,dispatcher.getEventHandler(),taskAttemptListener,jobTokenSecretManager,jobCredentials,clock,completedTasksFromPreviousRun,metrics,committer,newApiCommitter,currentUser.getUserName(),appSubmitTime,amInfos,context,forcedState,diagnostic);
  ((RunningAppContext)context).jobs.put(newJob.getID(),newJob);
  dispatcher.register(JobFinishEvent.Type.class,createJobFinishEventHandler());
  return newJob;
}
