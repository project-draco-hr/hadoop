{
  this.conf=config;
  this.clientToAMTokenSecretManager=new ClientToAMTokenSecretManager(appAttemptID,null);
  this.taskAttemptFinishingMonitor=taskAttemptFinishingMonitor;
  if (conf.getBoolean(MRJobConfig.MAPREDUCE_JOB_EMIT_TIMELINE_DATA,MRJobConfig.DEFAULT_MAPREDUCE_JOB_EMIT_TIMELINE_DATA) && conf.getBoolean(YarnConfiguration.TIMELINE_SERVICE_ENABLED,YarnConfiguration.DEFAULT_TIMELINE_SERVICE_ENABLED)) {
    boolean newTimelineServiceEnabled=conf.getBoolean(MRJobConfig.MAPREDUCE_JOB_NEW_TIMELINE_SERVICE_ENABLED,MRJobConfig.DEFAULT_MAPREDUCE_JOB_NEW_TIMELINE_SERVICE_ENABLED);
    if (newTimelineServiceEnabled) {
      timelineClient=TimelineClient.createTimelineClient(appAttemptID.getApplicationId());
    }
 else {
      timelineClient=TimelineClient.createTimelineClient();
    }
  }
}
