{
  LOG.info("MRAppMaster received a signal. Signaling RMCommunicator and " + "JobHistoryEventHandler.");
  if (appMaster.containerAllocator instanceof ContainerAllocatorRouter) {
    ((ContainerAllocatorRouter)appMaster.containerAllocator).setSignalled(true);
    ((ContainerAllocatorRouter)appMaster.containerAllocator).setShouldUnregister(appMaster.isLastAMRetry);
  }
  if (appMaster.jobHistoryEventHandler != null) {
    appMaster.jobHistoryEventHandler.setForcejobCompletion(appMaster.isLastAMRetry);
  }
  appMaster.stop();
}
