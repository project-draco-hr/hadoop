{
  LOG.info("MRAppMaster received a signal. Signaling RMCommunicator and " + "JobHistoryEventHandler.");
  if (appMaster.containerAllocator instanceof ContainerAllocatorRouter) {
    ((ContainerAllocatorRouter)appMaster.containerAllocator).setSignalled(true);
  }
  if (appMaster.jobHistoryEventHandler != null) {
    appMaster.jobHistoryEventHandler.setSignalled(true);
  }
  appMaster.stop();
  try {
    FileSystem.closeAll();
  }
 catch (  IOException ioe) {
    LOG.warn("Failed to close all FileSystem objects",ioe);
  }
}
