{
  boolean containerSchedPriorityIsSet=false;
  int containerSchedPriorityAdjustment=YarnConfiguration.DEFAULT_NM_CONTAINER_EXECUTOR_SCHED_PRIORITY;
  if (conf.get(YarnConfiguration.NM_CONTAINER_EXECUTOR_SCHED_PRIORITY) != null) {
    containerSchedPriorityIsSet=true;
    containerSchedPriorityAdjustment=conf.getInt(YarnConfiguration.NM_CONTAINER_EXECUTOR_SCHED_PRIORITY,YarnConfiguration.DEFAULT_NM_CONTAINER_EXECUTOR_SCHED_PRIORITY);
  }
  if (Shell.WINDOWS) {
    return new String[]{Shell.WINUTILS,"task","create",groupId,"cmd /c " + command};
  }
 else {
    List<String> retCommand=new ArrayList<String>();
    if (containerSchedPriorityIsSet) {
      retCommand.addAll(Arrays.asList("nice","-n",Integer.toString(containerSchedPriorityAdjustment)));
    }
    retCommand.addAll(Arrays.asList("bash",command));
    return retCommand.toArray(new String[retCommand.size()]);
  }
}
