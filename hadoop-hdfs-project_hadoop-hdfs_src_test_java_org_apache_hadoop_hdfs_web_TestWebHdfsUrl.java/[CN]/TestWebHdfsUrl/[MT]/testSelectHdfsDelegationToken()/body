{
  SecurityUtilTestHelper.setTokenServiceUseIp(true);
  Configuration conf=new Configuration();
  conf.setClass("fs.webhdfs.impl",MyWebHdfsFileSystem.class,FileSystem.class);
  URI fsUri=URI.create("webhdfs://localhost");
  MyWebHdfsFileSystem fs=(MyWebHdfsFileSystem)FileSystem.get(fsUri,conf);
  checkTokenSelection(fs,conf);
  fsUri=URI.create("webhdfs://localhost:" + fs.getDefaultPort());
  fs=(MyWebHdfsFileSystem)FileSystem.get(fsUri,conf);
  checkTokenSelection(fs,conf);
  fsUri=URI.create("webhdfs://localhost:" + (fs.getDefaultPort() - 1));
  fs=(MyWebHdfsFileSystem)FileSystem.get(fsUri,conf);
  checkTokenSelection(fs,conf);
}
