{
  String path=methodDir.getAbsolutePath();
  MetricsSystem ms=initMetricsSystem(path,true,false);
  new MyMetrics1().registerWith(ms);
  methodDir.setWritable(false);
  MockSink.errored=false;
  try {
    ms.publishMetricsNow();
    assertFalse("An exception was generated while writing metrics " + "when the target directory was not writable, even though the " + "sink is set to ignore errors",MockSink.errored);
    ms.stop();
    ms.shutdown();
  }
  finally {
    methodDir.setWritable(true);
  }
}
