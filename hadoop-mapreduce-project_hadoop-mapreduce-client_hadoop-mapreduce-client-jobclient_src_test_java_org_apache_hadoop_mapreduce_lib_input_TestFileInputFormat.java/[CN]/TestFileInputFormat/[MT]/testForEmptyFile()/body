{
  Configuration conf=new Configuration();
  FileSystem fileSys=FileSystem.get(conf);
  Path file=new Path("test" + "/file");
  FSDataOutputStream out=fileSys.create(file,true,conf.getInt("io.file.buffer.size",4096),(short)1,(long)1024);
  out.write(new byte[0]);
  out.close();
  DummyInputFormat inFormat=new DummyInputFormat();
  Job job=Job.getInstance(conf);
  FileInputFormat.setInputPaths(job,"test");
  List<InputSplit> splits=inFormat.getSplits(job);
  assertEquals(1,splits.size());
  FileSplit fileSplit=(FileSplit)splits.get(0);
  assertEquals(0,fileSplit.getLocations().length);
  assertEquals(file.getName(),fileSplit.getPath().getName());
  assertEquals(0,fileSplit.getStart());
  assertEquals(0,fileSplit.getLength());
  fileSys.delete(file.getParent(),true);
}
