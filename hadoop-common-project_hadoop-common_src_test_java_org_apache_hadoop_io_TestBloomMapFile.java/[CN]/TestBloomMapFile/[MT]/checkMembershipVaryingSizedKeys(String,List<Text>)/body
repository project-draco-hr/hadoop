{
  FileSystem fs=FileSystem.getLocal(conf);
  Path qualifiedDirName=fs.makeQualified(TEST_DIR);
  BloomMapFile.Writer writer=new BloomMapFile.Writer(conf,fs,qualifiedDirName.toString(),Text.class,NullWritable.class);
  for (  Text key : keys) {
    writer.append(key,NullWritable.get());
  }
  writer.close();
  BloomMapFile.Reader reader=new BloomMapFile.Reader(fs,qualifiedDirName.toString(),conf);
  Collections.reverse(keys);
  for (  Text key : keys) {
    assertTrue("False negative for existing key " + key,reader.probablyHasKey(key));
  }
  reader.close();
  fs.delete(qualifiedDirName,true);
}
