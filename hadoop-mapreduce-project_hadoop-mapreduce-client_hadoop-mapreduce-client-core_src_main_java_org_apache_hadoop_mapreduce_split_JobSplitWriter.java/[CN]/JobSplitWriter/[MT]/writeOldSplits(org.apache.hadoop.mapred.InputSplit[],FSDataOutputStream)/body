{
  SplitMetaInfo[] info=new SplitMetaInfo[splits.length];
  if (splits.length != 0) {
    int i=0;
    long offset=out.size();
    for (    org.apache.hadoop.mapred.InputSplit split : splits) {
      int prevLen=out.size();
      Text.writeString(out,split.getClass().getName());
      split.write(out);
      int currLen=out.size();
      info[i++]=new JobSplit.SplitMetaInfo(split.getLocations(),offset,split.getLength());
      offset+=currLen - prevLen;
    }
  }
  return info;
}
