{
  SplitMetaInfo[] info=new SplitMetaInfo[array.length];
  if (array.length != 0) {
    SerializationFactory factory=new SerializationFactory(conf);
    int i=0;
    long offset=out.size();
    for (    T split : array) {
      int prevCount=out.size();
      Text.writeString(out,split.getClass().getName());
      Serializer<T> serializer=factory.getSerializer((Class<T>)split.getClass());
      serializer.open(out);
      serializer.serialize(split);
      int currCount=out.size();
      info[i++]=new JobSplit.SplitMetaInfo(split.getLocations(),offset,split.getLength());
      offset+=currCount - prevCount;
    }
  }
  return info;
}
