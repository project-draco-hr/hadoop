{
  XAttrFeatureProto.Builder b=XAttrFeatureProto.newBuilder();
  for (  XAttr a : f.getXAttrs()) {
    XAttrCompactProto.Builder xAttrCompactBuilder=XAttrCompactProto.newBuilder();
    int v=((a.getNameSpace().ordinal() & XATTR_NAMESPACE_MASK) << XATTR_NAMESPACE_OFFSET) | ((stringMap.getId(a.getName()) & XATTR_NAME_MASK) << XATTR_NAME_OFFSET);
    xAttrCompactBuilder.setName(v);
    if (a.getValue() != null) {
      xAttrCompactBuilder.setValue(PBHelper.getByteString(a.getValue()));
    }
    b.addXAttrs(xAttrCompactBuilder.build());
  }
  return b;
}
