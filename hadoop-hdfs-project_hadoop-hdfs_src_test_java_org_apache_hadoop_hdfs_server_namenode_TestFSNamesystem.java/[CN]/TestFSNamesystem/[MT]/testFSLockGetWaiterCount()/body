{
  final int threadCount=3;
  final CountDownLatch latch=new CountDownLatch(threadCount);
  final FSNamesystemLock rwLock=new FSNamesystemLock(true);
  rwLock.writeLock().lock();
  ExecutorService helper=Executors.newFixedThreadPool(threadCount);
  for (int x=0; x < threadCount; x++) {
    helper.execute(new Runnable(){
      @Override public void run(){
        latch.countDown();
        rwLock.readLock().lock();
      }
    }
);
  }
  latch.await();
  Thread.sleep(10);
  Assert.assertEquals("Expected number of blocked thread not found",threadCount,rwLock.getQueueLength());
}
