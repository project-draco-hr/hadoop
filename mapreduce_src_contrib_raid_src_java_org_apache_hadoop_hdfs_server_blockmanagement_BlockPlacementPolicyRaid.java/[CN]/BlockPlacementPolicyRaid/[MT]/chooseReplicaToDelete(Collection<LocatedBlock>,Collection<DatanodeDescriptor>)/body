{
  if (dataNodes.isEmpty()) {
    return null;
  }
  final Map<String,Integer> nodeCompanionBlockCount=countCompanionBlocks(companionBlocks,false);
  final Map<String,Integer> rackCompanionBlockCount=countCompanionBlocks(companionBlocks,true);
  NodeComparator comparator=new NodeComparator(nodeCompanionBlockCount,rackCompanionBlockCount);
  return Collections.max(dataNodes,comparator);
}
