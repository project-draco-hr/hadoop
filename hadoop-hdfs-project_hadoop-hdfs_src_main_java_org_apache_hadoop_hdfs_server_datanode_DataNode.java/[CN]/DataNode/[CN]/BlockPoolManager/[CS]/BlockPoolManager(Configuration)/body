{
  bpMapping=new HashMap<String,BPOfferService>();
  nameNodeThreads=new HashMap<InetSocketAddress,BPOfferService>();
  List<InetSocketAddress> isas=DFSUtil.getNNServiceRpcAddresses(conf);
  for (  InetSocketAddress isa : isas) {
    BPOfferService bpos=new BPOfferService(isa);
    nameNodeThreads.put(bpos.getNNSocketAddress(),bpos);
  }
}
