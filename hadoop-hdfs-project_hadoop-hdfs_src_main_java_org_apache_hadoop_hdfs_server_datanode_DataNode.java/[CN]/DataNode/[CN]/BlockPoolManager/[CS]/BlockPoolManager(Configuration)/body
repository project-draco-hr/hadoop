{
  bpMapping=new HashMap<String,BPOfferService>();
  offerServices=new ArrayList<BPOfferService>();
  Map<String,Map<String,InetSocketAddress>> map=DFSUtil.getNNServiceRpcAddresses(conf);
  for (  Entry<String,Map<String,InetSocketAddress>> entry : map.entrySet()) {
    List<InetSocketAddress> nnList=Lists.newArrayList(entry.getValue().values());
    BPOfferService bpos=new BPOfferService(nnList,DataNode.this);
    offerServices.add(bpos);
  }
}
