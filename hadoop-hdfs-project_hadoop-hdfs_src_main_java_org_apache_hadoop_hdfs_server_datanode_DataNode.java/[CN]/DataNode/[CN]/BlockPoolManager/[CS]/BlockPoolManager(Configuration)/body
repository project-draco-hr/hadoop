{
  bpMapping=new HashMap<String,BPOfferService>();
  nameNodeThreads=new HashMap<InetSocketAddress,BPOfferService>();
  Map<String,Map<String,InetSocketAddress>> map=DFSUtil.getNNServiceRpcAddresses(conf);
  for (  Entry<String,Map<String,InetSocketAddress>> entry : map.entrySet()) {
    List<InetSocketAddress> nnList=Lists.newArrayList(entry.getValue().values());
    InetSocketAddress isa=nnList.get(0);
    BPOfferService bpos=new BPOfferService(isa,DataNode.this);
    nameNodeThreads.put(bpos.getNNSocketAddress(),bpos);
  }
}
