{
  super(conf);
  this.usersWithLocalPathAccess=Arrays.asList(conf.getTrimmedStrings(DFSConfigKeys.DFS_BLOCK_LOCAL_PATH_ACCESS_USER_KEY));
  this.connectToDnViaHostname=conf.getBoolean(DFSConfigKeys.DFS_DATANODE_USE_DN_HOSTNAME,DFSConfigKeys.DFS_DATANODE_USE_DN_HOSTNAME_DEFAULT);
  this.getHdfsBlockLocationsEnabled=conf.getBoolean(DFSConfigKeys.DFS_HDFS_BLOCKS_METADATA_ENABLED,DFSConfigKeys.DFS_HDFS_BLOCKS_METADATA_ENABLED_DEFAULT);
  try {
    hostName=getHostName(conf);
    LOG.info("Configured hostname is " + hostName);
    startDataNode(conf,dataDirs,resources);
  }
 catch (  IOException ie) {
    shutdown();
    throw ie;
  }
}
