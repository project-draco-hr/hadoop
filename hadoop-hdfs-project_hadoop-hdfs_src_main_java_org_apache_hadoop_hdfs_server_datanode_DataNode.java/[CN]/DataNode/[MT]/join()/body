{
  while (shouldRun) {
    try {
      blockPoolManager.joinAll();
      if (blockPoolManager.getAllNamenodeThreads() != null && blockPoolManager.getAllNamenodeThreads().length == 0) {
        shouldRun=false;
      }
synchronized (this) {
        wait(2000);
      }
    }
 catch (    InterruptedException ex) {
      LOG.warn("Received exception in Datanode#join: " + ex);
    }
  }
}
