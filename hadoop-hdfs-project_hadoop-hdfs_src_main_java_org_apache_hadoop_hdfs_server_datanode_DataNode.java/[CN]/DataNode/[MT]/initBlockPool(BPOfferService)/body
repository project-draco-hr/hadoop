{
  NamespaceInfo nsInfo=bpos.getNamespaceInfo();
  if (nsInfo == null) {
    throw new IOException("NamespaceInfo not found: Block pool " + bpos + " should have retrieved namespace info before initBlockPool.");
  }
  blockPoolManager.addBlockPool(bpos);
  setClusterId(nsInfo.clusterID,nsInfo.getBlockPoolID());
  initStorage(nsInfo);
  initPeriodicScanners(conf);
  data.addBlockPool(nsInfo.getBlockPoolID(),conf);
}
