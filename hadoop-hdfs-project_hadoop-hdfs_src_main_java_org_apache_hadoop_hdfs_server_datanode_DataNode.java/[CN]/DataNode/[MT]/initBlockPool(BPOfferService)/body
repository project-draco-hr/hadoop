{
  NamespaceInfo nsInfo=bpos.getNamespaceInfo();
  if (nsInfo == null) {
    throw new IOException("NamespaceInfo not found: Block pool " + bpos + " should have retrieved namespace info before initBlockPool.");
  }
  setClusterId(nsInfo.clusterID,nsInfo.getBlockPoolID());
  blockPoolManager.addBlockPool(bpos);
  initStorage(nsInfo);
  checkDiskError();
  initDirectoryScanner(conf);
  data.addBlockPool(nsInfo.getBlockPoolID(),conf);
  blockScanner.enableBlockPoolId(bpos.getBlockPoolId());
}
