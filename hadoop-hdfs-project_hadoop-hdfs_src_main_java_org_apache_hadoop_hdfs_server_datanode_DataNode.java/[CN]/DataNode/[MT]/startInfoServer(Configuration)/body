{
  Configuration confForInfoServer=new Configuration(conf);
  confForInfoServer.setInt(HttpServer2.HTTP_MAX_THREADS,10);
  HttpServer2.Builder builder=new HttpServer2.Builder().setName("datanode").setConf(conf).setACL(new AccessControlList(conf.get(DFS_ADMIN," "))).addEndpoint(URI.create("http://localhost:0")).setFindPort(true);
  this.infoServer=builder.build();
  this.infoServer.setAttribute("datanode",this);
  this.infoServer.setAttribute(JspHelper.CURRENT_CONF,conf);
  this.infoServer.addServlet(null,"/blockScannerReport",DataBlockScanner.Servlet.class);
  this.infoServer.start();
  InetSocketAddress jettyAddr=infoServer.getConnectorAddress(0);
  ServerSocketChannel httpServerChannel=secureResources != null ? secureResources.getHttpServerChannel() : null;
  this.httpServer=new DatanodeHttpServer(conf,jettyAddr,httpServerChannel);
  httpServer.start();
  if (httpServer.getHttpAddress() != null) {
    infoPort=httpServer.getHttpAddress().getPort();
  }
  if (httpServer.getHttpsAddress() != null) {
    infoSecurePort=httpServer.getHttpsAddress().getPort();
  }
}
