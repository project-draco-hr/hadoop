{
  if (isBlockTokenEnabled && UserGroupInformation.isSecurityEnabled()) {
    BlockTokenIdentifier id=new BlockTokenIdentifier();
    ByteArrayInputStream buf=new ByteArrayInputStream(token.getIdentifier());
    DataInputStream in=new DataInputStream(buf);
    id.readFields(in);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Got: " + id.toString());
    }
    blockPoolTokenSecretManager.checkAccess(id,null,block,accessMode);
  }
}
