{
  BPOfferService bpos=blockPoolManager.get(bpid);
  if (bpos == null) {
    throw new IOException("No block pool offer service for bpid=" + bpid);
  }
 else   if (bpos.bpNamenode == null) {
    throw new IOException("cannot find a namenode proxy for bpid=" + bpid);
  }
  return bpos.bpNamenode;
}
