{
  Collection<String> rawLocations=conf.getTrimmedStringCollection(DFS_DATANODE_DATA_DIR_KEY);
  List<StorageLocation> locations=new ArrayList<StorageLocation>(rawLocations.size());
  for (  String locationString : rawLocations) {
    final StorageLocation location;
    try {
      location=StorageLocation.parse(locationString);
    }
 catch (    IOException ioe) {
      LOG.error("Failed to initialize storage directory " + locationString + ". Exception details: "+ ioe);
      continue;
    }
catch (    SecurityException se) {
      LOG.error("Failed to initialize storage directory " + locationString + ". Exception details: "+ se);
      continue;
    }
    locations.add(location);
  }
  return locations;
}
