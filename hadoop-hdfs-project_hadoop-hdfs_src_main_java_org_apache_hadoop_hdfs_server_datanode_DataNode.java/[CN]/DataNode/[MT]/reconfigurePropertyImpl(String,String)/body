{
  if (property.equals(DFS_DATANODE_DATA_DIR_KEY)) {
    IOException rootException=null;
    try {
      LOG.info("Reconfiguring " + property + " to "+ newVal);
      this.refreshVolumes(newVal);
    }
 catch (    IOException e) {
      rootException=e;
    }
 finally {
      try {
        triggerBlockReport(new BlockReportOptions.Factory().setIncremental(false).build());
      }
 catch (      IOException e) {
        LOG.warn("Exception while sending the block report after refreshing" + " volumes " + property + " to "+ newVal,e);
        if (rootException == null) {
          rootException=e;
        }
      }
 finally {
        if (rootException != null) {
          throw new ReconfigurationException(property,newVal,getConf().get(property),rootException);
        }
      }
    }
  }
 else   if (property.equals(DFS_DATANODE_BALANCE_MAX_NUM_CONCURRENT_MOVES_KEY)) {
    ReconfigurationException rootException=null;
    try {
      LOG.info("Reconfiguring " + property + " to "+ newVal);
      int movers;
      if (newVal == null) {
        movers=DFS_DATANODE_BALANCE_MAX_NUM_CONCURRENT_MOVES_DEFAULT;
      }
 else {
        movers=Integer.parseInt(newVal);
        if (movers <= 0) {
          rootException=new ReconfigurationException(property,newVal,getConf().get(property),new IllegalArgumentException("balancer max concurrent movers must be larger than 0"));
        }
      }
      xserver.updateBalancerMaxConcurrentMovers(movers);
    }
 catch (    NumberFormatException nfe) {
      rootException=new ReconfigurationException(property,newVal,getConf().get(property),nfe);
    }
 finally {
      if (rootException != null) {
        LOG.warn(String.format("Exception in updating balancer max concurrent movers %s to %s",property,newVal),rootException);
        throw rootException;
      }
    }
  }
 else {
    throw new ReconfigurationException(property,newVal,getConf().get(property));
  }
}
