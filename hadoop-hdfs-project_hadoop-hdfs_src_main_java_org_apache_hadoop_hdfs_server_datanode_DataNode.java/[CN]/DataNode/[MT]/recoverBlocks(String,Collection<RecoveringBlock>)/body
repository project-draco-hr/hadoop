{
  Daemon d=new Daemon(threadGroup,new Runnable(){
    /** 
 * Recover a list of blocks. It is run by the primary datanode. 
 */
    @Override public void run(){
      for (      RecoveringBlock b : blocks) {
        try {
          logRecoverBlock(who,b);
          recoverBlock(b);
        }
 catch (        IOException e) {
          LOG.warn("recoverBlocks FAILED: " + b,e);
        }
      }
    }
  }
);
  d.start();
  return d;
}
