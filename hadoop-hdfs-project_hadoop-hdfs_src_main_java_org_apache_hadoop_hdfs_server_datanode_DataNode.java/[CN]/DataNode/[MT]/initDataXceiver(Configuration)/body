{
  InetSocketAddress streamingAddr=DataNode.getStreamingAddr(conf);
  ServerSocket ss;
  if (secureResources == null) {
    ss=(dnConf.socketWriteTimeout > 0) ? ServerSocketChannel.open().socket() : new ServerSocket();
    Server.bind(ss,streamingAddr,0);
  }
 else {
    ss=secureResources.getStreamingSocket();
  }
  ss.setReceiveBufferSize(HdfsConstants.DEFAULT_DATA_SOCKET_SIZE);
  int tmpPort=ss.getLocalPort();
  selfAddr=new InetSocketAddress(ss.getInetAddress().getHostAddress(),tmpPort);
  LOG.info("Opened streaming server at " + selfAddr);
  this.threadGroup=new ThreadGroup("dataXceiverServer");
  this.dataXceiverServer=new Daemon(threadGroup,new DataXceiverServer(ss,conf,this));
  this.threadGroup.setDaemon(true);
}
