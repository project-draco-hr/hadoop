{
  ServerSocket ss;
  if (secureResources == null) {
    InetSocketAddress addr=DataNode.getStreamingAddr(conf);
    ss=(dnConf.socketWriteTimeout > 0) ? ServerSocketChannel.open().socket() : new ServerSocket();
    Server.bind(ss,addr,0);
  }
 else {
    ss=secureResources.getStreamingSocket();
  }
  ss.setReceiveBufferSize(HdfsConstants.DEFAULT_DATA_SOCKET_SIZE);
  streamingAddr=new InetSocketAddress(ss.getInetAddress().getHostAddress(),ss.getLocalPort());
  LOG.info("Opened streaming server at " + streamingAddr);
  this.threadGroup=new ThreadGroup("dataXceiverServer");
  this.dataXceiverServer=new Daemon(threadGroup,new DataXceiverServer(ss,conf,this));
  this.threadGroup.setDaemon(true);
}
