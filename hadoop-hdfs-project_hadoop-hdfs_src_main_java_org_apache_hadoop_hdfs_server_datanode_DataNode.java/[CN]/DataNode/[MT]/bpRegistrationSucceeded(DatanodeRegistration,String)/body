{
  if (null == id) {
    id=bpRegistration;
  }
  if (storage.getStorageID().equals("")) {
    storage.setStorageID(bpRegistration.getStorageID());
    storage.writeAll();
    LOG.info("New storage id " + bpRegistration.getStorageID() + " is assigned to data-node "+ bpRegistration);
  }
 else   if (!storage.getStorageID().equals(bpRegistration.getStorageID())) {
    throw new IOException("Inconsistent storage IDs. Name-node returned " + bpRegistration.getStorageID() + ". Expecting "+ storage.getStorageID());
  }
  registerBlockPoolWithSecretManager(bpRegistration,blockPoolId);
}
