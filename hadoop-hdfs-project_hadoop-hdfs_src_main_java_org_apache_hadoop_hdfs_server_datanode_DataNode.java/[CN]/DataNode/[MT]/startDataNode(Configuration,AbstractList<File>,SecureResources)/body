{
  if (UserGroupInformation.isSecurityEnabled() && resources == null)   throw new RuntimeException("Cannot start secure cluster without " + "privileged resources.");
  this.secureResources=resources;
  this.dataDirs=dataDirs;
  this.conf=conf;
  storage=new DataStorage();
  initConfig(conf);
  registerMXBean();
  initDataXceiver(conf);
  startInfoServer(conf);
  this.blockPoolTokenSecretManager=new BlockPoolTokenSecretManager();
  initIpcServer(conf);
  metrics=DataNodeMetrics.create(conf,getMachineName());
  blockPoolManager=new BlockPoolManager(conf);
}
