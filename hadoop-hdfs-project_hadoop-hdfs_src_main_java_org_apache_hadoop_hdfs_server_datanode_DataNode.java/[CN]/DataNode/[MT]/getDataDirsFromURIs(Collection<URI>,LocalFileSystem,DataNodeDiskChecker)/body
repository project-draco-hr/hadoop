{
  ArrayList<File> dirs=new ArrayList<File>();
  StringBuilder invalidDirs=new StringBuilder();
  for (  URI dirURI : dataDirs) {
    if (!"file".equalsIgnoreCase(dirURI.getScheme())) {
      LOG.warn("Unsupported URI schema in " + dirURI + ". Ignoring ...");
      invalidDirs.append("\"").append(dirURI).append("\" ");
      continue;
    }
    File dir=new File(dirURI.getPath());
    try {
      dataNodeDiskChecker.checkDir(localFS,new Path(dir.toURI()));
      dirs.add(dir);
    }
 catch (    IOException ioe) {
      LOG.warn("Invalid " + DFS_DATANODE_DATA_DIR_KEY + " "+ dir+ " : ",ioe);
      invalidDirs.append("\"").append(dir.getCanonicalPath()).append("\" ");
    }
  }
  if (dirs.size() == 0) {
    throw new IOException("All directories in " + DFS_DATANODE_DATA_DIR_KEY + " are invalid: "+ invalidDirs);
  }
  return dirs;
}
