{
  int errorCode=0;
  try {
    StringUtils.startupShutdownMessage(DataNode.class,args,LOG);
    DataNode datanode=createDataNode(args,null,resources);
    if (datanode != null) {
      datanode.join();
    }
 else {
      errorCode=1;
    }
  }
 catch (  Throwable e) {
    LOG.fatal("Exception in secureMain",e);
    terminate(1,e);
  }
 finally {
    LOG.warn("Exiting Datanode");
    terminate(errorCode);
  }
}
