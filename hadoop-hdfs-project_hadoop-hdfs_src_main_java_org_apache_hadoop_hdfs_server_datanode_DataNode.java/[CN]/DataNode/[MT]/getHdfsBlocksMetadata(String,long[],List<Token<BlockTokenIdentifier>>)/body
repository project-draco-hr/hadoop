{
  if (!getHdfsBlockLocationsEnabled) {
    throw new UnsupportedOperationException("Datanode#getHdfsBlocksMetadata " + " is not enabled in datanode config");
  }
  if (blockIds.length != tokens.size()) {
    throw new IOException("Differing number of blocks and tokens");
  }
  for (int i=0; i < blockIds.length; i++) {
    checkBlockToken(new ExtendedBlock(bpId,blockIds[i]),tokens.get(i),BlockTokenSecretManager.AccessMode.READ);
  }
  DataNodeFaultInjector.get().getHdfsBlocksMetadata();
  return data.getHdfsBlocksMetadata(bpId,blockIds);
}
