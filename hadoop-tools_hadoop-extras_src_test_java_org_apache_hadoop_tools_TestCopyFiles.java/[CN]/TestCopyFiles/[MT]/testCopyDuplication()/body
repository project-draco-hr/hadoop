{
  final FileSystem localfs=FileSystem.get(LOCAL_FS,new Configuration());
  try {
    MyFile[] files=createFiles(localfs,TEST_ROOT_DIR + "/srcdat");
    ToolRunner.run(new DistCp(new Configuration()),new String[]{"file:///" + TEST_ROOT_DIR + "/srcdat","file:///" + TEST_ROOT_DIR + "/src2/srcdat"});
    assertTrue("Source and destination directories do not match.",checkFiles(localfs,TEST_ROOT_DIR + "/src2/srcdat",files));
    assertEquals(DistCp.DuplicationException.ERROR_CODE,ToolRunner.run(new DistCp(new Configuration()),new String[]{"file:///" + TEST_ROOT_DIR + "/srcdat","file:///" + TEST_ROOT_DIR + "/src2/srcdat","file:///" + TEST_ROOT_DIR + "/destdat"}));
  }
  finally {
    deldir(localfs,TEST_ROOT_DIR + "/destdat");
    deldir(localfs,TEST_ROOT_DIR + "/srcdat");
    deldir(localfs,TEST_ROOT_DIR + "/src2");
  }
}
