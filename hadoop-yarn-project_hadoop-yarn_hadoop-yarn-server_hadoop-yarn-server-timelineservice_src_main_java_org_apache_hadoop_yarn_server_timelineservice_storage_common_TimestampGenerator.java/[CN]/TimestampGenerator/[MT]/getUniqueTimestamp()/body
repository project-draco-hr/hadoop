{
  long lastTs;
  long nextTs;
  do {
    lastTs=lastTimestamp.get();
    nextTs=Math.max(lastTs + 1,currentTime());
  }
 while (!lastTimestamp.compareAndSet(lastTs,nextTs));
  return nextTs;
}
