{
  Preconditions.checkArgument(nsInfo.getLayoutVersion() == 0 || nsInfo.getLayoutVersion() == HdfsConstants.NAMENODE_LAYOUT_VERSION,"Bad layout version: %s",nsInfo.getLayoutVersion());
  this.setStorageInfo(nsInfo);
  this.blockpoolID=nsInfo.getBlockPoolID();
  for (Iterator<StorageDirectory> it=dirIterator(); it.hasNext(); ) {
    StorageDirectory sd=it.next();
    format(sd);
  }
}
