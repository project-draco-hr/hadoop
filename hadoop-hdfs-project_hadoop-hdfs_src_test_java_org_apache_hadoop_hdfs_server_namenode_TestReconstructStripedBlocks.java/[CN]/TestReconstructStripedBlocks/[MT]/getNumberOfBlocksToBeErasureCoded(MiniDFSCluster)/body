{
  DatanodeManager dm=cluster.getNamesystem().getBlockManager().getDatanodeManager();
  int count=0;
  for (  DataNode dn : cluster.getDataNodes()) {
    DatanodeDescriptor dd=dm.getDatanode(dn.getDatanodeId());
    count+=dd.getNumberOfBlocksToBeErasureCoded();
  }
  return count;
}
