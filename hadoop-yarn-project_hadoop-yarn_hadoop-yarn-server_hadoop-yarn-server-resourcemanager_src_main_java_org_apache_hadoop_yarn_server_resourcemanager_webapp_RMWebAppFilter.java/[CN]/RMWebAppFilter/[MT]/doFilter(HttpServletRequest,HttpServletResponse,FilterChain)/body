{
  response.setCharacterEncoding("UTF-8");
  String uri=HtmlQuoting.quoteHtmlChars(request.getRequestURI());
  if (uri == null) {
    uri="/";
  }
  RMWebApp rmWebApp=injector.getInstance(RMWebApp.class);
  rmWebApp.checkIfStandbyRM();
  if (rmWebApp.isStandby() && !uri.equals("/" + rmWebApp.wsName() + "/v1/cluster/info") && !uri.equals("/" + rmWebApp.name() + "/cluster")) {
    String redirectPath=rmWebApp.getRedirectPath() + uri;
    if (redirectPath != null && !redirectPath.isEmpty()) {
      String redirectMsg="This is standby RM. Redirecting to the current active RM: " + redirectPath;
      response.addHeader("Refresh","3; url=" + redirectPath);
      PrintWriter out=response.getWriter();
      out.println(redirectMsg);
      return;
    }
  }
  super.doFilter(request,response,chain);
}
