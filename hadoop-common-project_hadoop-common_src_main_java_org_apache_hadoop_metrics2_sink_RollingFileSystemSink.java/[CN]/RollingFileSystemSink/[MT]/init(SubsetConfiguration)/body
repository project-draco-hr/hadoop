{
  basePath=new Path(conf.getString(BASEPATH_KEY,BASEPATH_DEFAULT));
  source=conf.getString(SOURCE_KEY,SOURCE_DEFAULT);
  ignoreError=conf.getBoolean(IGNORE_ERROR_KEY,false);
  allowAppend=conf.getBoolean(ALLOW_APPEND_KEY,false);
  try {
    fileSystem=FileSystem.get(new URI(basePath.toString()),new Configuration());
  }
 catch (  URISyntaxException ex) {
    throw new MetricsException("The supplied filesystem base path URI" + " is not a valid URI: " + basePath.toString(),ex);
  }
catch (  IOException ex) {
    throw new MetricsException("Error connecting to file system: " + basePath + " ["+ ex.toString()+ "]",ex);
  }
  if (allowAppend) {
    allowAppend=checkAppend(fileSystem);
  }
  flushTimer=new Timer("RollingFileSystemSink Flusher",true);
}
