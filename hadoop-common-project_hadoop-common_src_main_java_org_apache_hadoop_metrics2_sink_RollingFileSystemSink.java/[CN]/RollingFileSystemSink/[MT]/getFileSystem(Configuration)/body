{
  FileSystem fs=null;
  if (suppliedFilesystem != null) {
    fs=suppliedFilesystem;
  }
 else {
    try {
      fs=FileSystem.get(new URI(basePath.toString()),conf);
    }
 catch (    URISyntaxException ex) {
      throw new MetricsException("The supplied filesystem base path URI" + " is not a valid URI: " + basePath.toString(),ex);
    }
catch (    IOException ex) {
      throw new MetricsException("Error connecting to file system: " + basePath + " ["+ ex.toString()+ "]",ex);
    }
  }
  return fs;
}
