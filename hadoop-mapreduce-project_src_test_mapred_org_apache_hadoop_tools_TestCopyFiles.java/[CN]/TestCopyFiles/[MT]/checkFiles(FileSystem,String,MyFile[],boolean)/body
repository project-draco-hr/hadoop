{
  Path root=new Path(topdir);
  for (int idx=0; idx < files.length; idx++) {
    Path fPath=new Path(root,files[idx].getName());
    try {
      fs.getFileStatus(fPath);
      FSDataInputStream in=fs.open(fPath);
      byte[] toRead=new byte[files[idx].getSize()];
      byte[] toCompare=new byte[files[idx].getSize()];
      Random rb=new Random(files[idx].getSeed());
      rb.nextBytes(toCompare);
      assertEquals("Cannnot read file.",toRead.length,in.read(toRead));
      in.close();
      for (int i=0; i < toRead.length; i++) {
        if (toRead[i] != toCompare[i]) {
          return false;
        }
      }
      toRead=null;
      toCompare=null;
    }
 catch (    FileNotFoundException fnfe) {
      if (!existingOnly) {
        throw fnfe;
      }
    }
  }
  return true;
}
