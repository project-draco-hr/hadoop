{
  if (wrappedStream != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Aborting old stream to open at pos " + pos);
    }
    wrappedStream.abort();
  }
  if (pos < 0) {
    throw new EOFException(FSExceptionMessages.NEGATIVE_SEEK + " " + pos);
  }
  if (contentLength > 0 && pos > contentLength - 1) {
    throw new EOFException(FSExceptionMessages.CANNOT_SEEK_PAST_EOF + " " + pos);
  }
  LOG.debug("Actually opening file " + key + " at pos "+ pos);
  GetObjectRequest request=new GetObjectRequest(bucket,key);
  request.setRange(pos,contentLength - 1);
  wrappedObject=client.getObject(request);
  wrappedStream=wrappedObject.getObjectContent();
  if (wrappedStream == null) {
    throw new IOException("Null IO stream");
  }
  this.pos=pos;
}
