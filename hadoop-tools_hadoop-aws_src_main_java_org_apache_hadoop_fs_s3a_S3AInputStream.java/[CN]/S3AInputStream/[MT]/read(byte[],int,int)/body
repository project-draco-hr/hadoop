{
  if (closed) {
    throw new IOException("Stream closed");
  }
  openIfNeeded();
  int byteRead;
  try {
    byteRead=wrappedStream.read(buf,off,len);
  }
 catch (  SocketTimeoutException e) {
    LOG.info("Got timeout while trying to read from stream, trying to recover " + e);
    reopen(pos);
    byteRead=wrappedStream.read(buf,off,len);
  }
catch (  SocketException e) {
    LOG.info("Got socket exception while trying to read from stream, trying to recover " + e);
    reopen(pos);
    byteRead=wrappedStream.read(buf,off,len);
  }
  if (byteRead > 0) {
    pos+=byteRead;
  }
  if (stats != null && byteRead > 0) {
    stats.incrementBytesRead(byteRead);
  }
  return byteRead;
}
