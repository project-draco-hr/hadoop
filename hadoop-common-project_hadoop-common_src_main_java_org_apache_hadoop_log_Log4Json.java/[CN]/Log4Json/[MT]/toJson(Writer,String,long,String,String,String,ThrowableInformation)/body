{
  JsonGenerator json=factory.createJsonGenerator(writer);
  json.writeStartObject();
  json.writeStringField(NAME,loggerName);
  json.writeNumberField(TIME,timeStamp);
  Date date=new Date(timeStamp);
  json.writeStringField(DATE,dateFormat.format(date));
  json.writeStringField(LEVEL,level);
  json.writeStringField(THREAD,threadName);
  json.writeStringField(MESSAGE,message);
  if (ti != null) {
    Throwable thrown=ti.getThrowable();
    String eclass=(thrown != null) ? thrown.getClass().getName() : "";
    json.writeStringField(EXCEPTION_CLASS,eclass);
    String[] stackTrace=ti.getThrowableStrRep();
    json.writeArrayFieldStart(STACK);
    for (    String row : stackTrace) {
      json.writeString(row);
    }
    json.writeEndArray();
  }
  json.writeEndObject();
  json.flush();
  json.close();
  return writer;
}
