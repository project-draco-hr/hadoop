{
  Optional<String> optHostPort=Optional.fromNullable(hostPort);
  RMContext rmContext=mock(RMContext.class);
  conf=new YarnConfiguration();
  conf.set(YarnConfiguration.RM_ZK_ADDRESS,optHostPort.or(curatorTestingServer.getConnectString()));
  conf.set(YarnConfiguration.ZK_RM_STATE_STORE_PARENT_PATH,workingZnode);
  store=new ZKRMStateStore();
  store.setResourceManager(new ResourceManager());
  store.init(conf);
  store.start();
  when(rmContext.getStateStore()).thenReturn(store);
  appTokenMgr=new AMRMTokenSecretManager(conf,rmContext);
  appTokenMgr.start();
  clientToAMTokenMgr=new ClientToAMTokenSecretManagerInRM();
}
