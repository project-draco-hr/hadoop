{
  String[] retVal=new String[replicationFactor];
  List<NodeInfo> rackList=new LinkedList<NodeInfo>();
  rackList.addAll(racksMap.values());
  sortInDescendingOrder(rackList);
  boolean done=false;
  int index=0;
  for (  NodeInfo ni : rackList) {
    Set<NodeInfo> hostSet=ni.getLeaves();
    List<NodeInfo> hostList=new LinkedList<NodeInfo>();
    hostList.addAll(hostSet);
    sortInDescendingOrder(hostList);
    for (    NodeInfo host : hostList) {
      retVal[index++]=host.node.getName().split(":")[0];
      if (index == replicationFactor) {
        done=true;
        break;
      }
    }
    if (done == true) {
      break;
    }
  }
  return retVal;
}
