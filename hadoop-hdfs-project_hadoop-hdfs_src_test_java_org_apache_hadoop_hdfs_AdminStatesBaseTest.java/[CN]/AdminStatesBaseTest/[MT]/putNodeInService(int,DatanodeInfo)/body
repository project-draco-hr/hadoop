{
  LOG.info("Putting node: " + outOfServiceNode + " in service");
  ArrayList<String> decommissionNodes=new ArrayList<>();
  Map<String,Long> maintenanceNodes=new HashMap<>();
  DatanodeManager dm=cluster.getNamesystem(nnIndex).getBlockManager().getDatanodeManager();
  List<DatanodeDescriptor> nodes=dm.getDatanodeListForReport(DatanodeReportType.ALL);
  for (  DatanodeDescriptor node : nodes) {
    if (node.isMaintenance()) {
      maintenanceNodes.put(node.getName(),node.getMaintenanceExpireTimeInMS());
    }
 else     if (node.isDecommissionInProgress() || node.isDecommissioned()) {
      decommissionNodes.add(node.getName());
    }
  }
  decommissionNodes.remove(outOfServiceNode.getName());
  maintenanceNodes.remove(outOfServiceNode.getName());
  hostsFileWriter.initOutOfServiceHosts(decommissionNodes,maintenanceNodes);
  refreshNodes(nnIndex);
  waitNodeState(outOfServiceNode,AdminStates.NORMAL);
}
