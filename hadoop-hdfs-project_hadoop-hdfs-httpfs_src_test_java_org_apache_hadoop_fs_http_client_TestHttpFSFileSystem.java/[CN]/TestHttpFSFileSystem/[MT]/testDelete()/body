{
  Path foo=new Path(TestHdfsHelper.getHdfsTestDir(),"foo");
  Path bar=new Path(TestHdfsHelper.getHdfsTestDir(),"bar");
  Path foe=new Path(TestHdfsHelper.getHdfsTestDir(),"foe");
  FileSystem fs=FileSystem.get(TestHdfsHelper.getHdfsConf());
  fs.mkdirs(foo);
  fs.mkdirs(new Path(bar,"a"));
  fs.mkdirs(foe);
  FileSystem hoopFs=getHttpFileSystem();
  Assert.assertTrue(hoopFs.delete(new Path(foo.toUri().getPath()),false));
  Assert.assertFalse(fs.exists(foo));
  try {
    hoopFs.delete(new Path(bar.toUri().getPath()),false);
    Assert.fail();
  }
 catch (  IOException ex) {
  }
catch (  Exception ex) {
    Assert.fail();
  }
  Assert.assertTrue(fs.exists(bar));
  Assert.assertTrue(hoopFs.delete(new Path(bar.toUri().getPath()),true));
  Assert.assertFalse(fs.exists(bar));
  Assert.assertTrue(fs.exists(foe));
  Assert.assertTrue(hoopFs.delete(foe,true));
  Assert.assertFalse(fs.exists(foe));
  hoopFs.close();
  fs.close();
}
