{
  long id=getFreeBlockId();
  try (FsDatasetSpi.FsVolumeReferences volumes=fds.getFsVolumeReferences()){
    int numVolumes=volumes.size();
    int index=rand.nextInt(numVolumes - 1);
    File finalizedDir=volumes.get(index).getFinalizedDir(bpid);
    File file=new File(finalizedDir,getBlockFile(id));
    if (file.createNewFile()) {
      LOG.info("Created block file " + file.getName());
    }
  }
   return id;
}
