{
  try (AutoCloseableLock lock=fds.acquireDatasetLock()){
    for (    ReplicaInfo b : FsDatasetTestUtil.getReplicas(fds,bpid)) {
      File f=new File(b.getBlockURI());
      File mf=new File(b.getMetadataURI());
      if (f.exists() && mf.exists() && f.delete()) {
        LOG.info("Deleting block file " + f.getAbsolutePath());
        return b.getBlockId();
      }
    }
  }
   return 0;
}
