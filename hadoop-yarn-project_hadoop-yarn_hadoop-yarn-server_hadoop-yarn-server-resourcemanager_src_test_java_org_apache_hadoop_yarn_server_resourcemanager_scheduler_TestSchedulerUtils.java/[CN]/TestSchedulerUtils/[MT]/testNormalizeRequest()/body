{
  ResourceCalculator resourceCalculator=new DefaultResourceCalculator();
  final int minMemory=1024;
  final int maxMemory=8192;
  Resource minResource=Resources.createResource(minMemory,0);
  Resource maxResource=Resources.createResource(maxMemory,0);
  ResourceRequest ask=new ResourceRequestPBImpl();
  ask.setCapability(Resources.createResource(-1024));
  SchedulerUtils.normalizeRequest(ask,resourceCalculator,null,minResource,maxResource);
  assertEquals(minMemory,ask.getCapability().getMemory());
  ask.setCapability(Resources.createResource(0));
  SchedulerUtils.normalizeRequest(ask,resourceCalculator,null,minResource,maxResource);
  assertEquals(minMemory,ask.getCapability().getMemory());
  ask.setCapability(Resources.createResource(2 * minMemory));
  SchedulerUtils.normalizeRequest(ask,resourceCalculator,null,minResource,maxResource);
  assertEquals(2 * minMemory,ask.getCapability().getMemory());
  ask.setCapability(Resources.createResource(minMemory + 10));
  SchedulerUtils.normalizeRequest(ask,resourceCalculator,null,minResource,maxResource);
  assertEquals(2 * minMemory,ask.getCapability().getMemory());
  ask.setCapability(Resources.createResource(maxMemory));
  SchedulerUtils.normalizeRequest(ask,resourceCalculator,null,minResource,maxResource);
  assertEquals(maxMemory,ask.getCapability().getMemory());
  ask.setCapability(Resources.createResource(maxMemory - 10));
  SchedulerUtils.normalizeRequest(ask,resourceCalculator,null,minResource,maxResource);
  assertEquals(maxMemory,ask.getCapability().getMemory());
  maxResource=Resources.createResource(maxMemory - 10,0);
  ask.setCapability(Resources.createResource(maxMemory - 100));
  SchedulerUtils.normalizeRequest(ask,resourceCalculator,null,minResource,maxResource);
  assertEquals(maxResource.getMemory(),ask.getCapability().getMemory());
  maxResource=Resources.createResource(maxMemory,0);
  ask.setCapability(Resources.createResource(maxMemory + 100));
  SchedulerUtils.normalizeRequest(ask,resourceCalculator,null,minResource,maxResource);
  assertEquals(maxResource.getMemory(),ask.getCapability().getMemory());
}
