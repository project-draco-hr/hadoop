{
  StartedContainer startedContainer=getStartedContainer(containerId);
  if (startedContainer == null) {
    throw RPCUtil.getRemoteException("Container " + containerId + " is either not started yet or already stopped");
  }
synchronized (startedContainer) {
    if (startedContainer.stopped) {
      return;
    }
    NMCommunicator nmCommunicator=null;
    try {
      nmCommunicator=new NMCommunicator(containerId,nodeId,containerToken);
      nmCommunicator.init(getConfig());
      nmCommunicator.start();
      nmCommunicator.stopContainer();
    }
  finally {
      if (nmCommunicator != null) {
        nmCommunicator.stop();
      }
      startedContainer.stopped=true;
      removeStartedContainer(containerId);
    }
  }
}
