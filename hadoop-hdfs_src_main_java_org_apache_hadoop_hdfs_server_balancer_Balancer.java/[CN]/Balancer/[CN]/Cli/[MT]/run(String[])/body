{
  final long startTime=Util.now();
  final Configuration conf=getConf();
  WIN_WIDTH=conf.getLong(DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY,DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);
  try {
    checkReplicationPolicyCompatibility(conf);
    final List<InetSocketAddress> namenodes=DFSUtil.getNNServiceRpcAddresses(conf);
    return Balancer.run(namenodes,parse(args),conf);
  }
 catch (  IOException e) {
    System.out.println(e + ".  Exiting ...");
    return ReturnStatus.IO_EXCEPTION.code;
  }
catch (  InterruptedException e) {
    System.out.println(e + ".  Exiting ...");
    return ReturnStatus.INTERRUPTED.code;
  }
 finally {
    System.out.println("Balancing took " + time2Str(Util.now() - startTime));
  }
}
