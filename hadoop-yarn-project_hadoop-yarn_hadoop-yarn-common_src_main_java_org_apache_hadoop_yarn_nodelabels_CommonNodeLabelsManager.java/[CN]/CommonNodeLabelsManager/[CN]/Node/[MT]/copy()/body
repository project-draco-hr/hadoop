{
  Node c=new Node(nodeId);
  if (labels != null) {
    c.labels=Collections.newSetFromMap(new ConcurrentHashMap<String,Boolean>());
    c.labels.addAll(labels);
  }
 else {
    c.labels=null;
  }
  c.resource=Resources.clone(resource);
  c.running=running;
  return c;
}
