{
  Map<T,Set<NodeId>> labelsToNodes=new HashMap<T,Set<NodeId>>();
  for (  String label : labels) {
    if (label.equals(NO_LABEL)) {
      continue;
    }
    RMNodeLabel nodeLabelInfo=labelCollections.get(label);
    if (nodeLabelInfo != null) {
      Set<NodeId> nodeIds=nodeLabelInfo.getAssociatedNodeIds();
      if (!nodeIds.isEmpty()) {
        if (type.isAssignableFrom(String.class)) {
          labelsToNodes.put(type.cast(label),nodeIds);
        }
 else {
          labelsToNodes.put(type.cast(nodeLabelInfo.getNodeLabel()),nodeIds);
        }
      }
    }
 else {
      LOG.warn("getLabelsToNodes : Label [" + label + "] cannot be found");
    }
  }
  return labelsToNodes;
}
