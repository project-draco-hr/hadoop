{
  if (!nodeLabelsEnabled) {
    LOG.error(NODE_LABELS_NOT_ENABLED_ERR);
    throw new IOException(NODE_LABELS_NOT_ENABLED_ERR);
  }
  if (null == labels || labels.isEmpty()) {
    return;
  }
  Set<String> newLabels=new HashSet<String>();
  labels=normalizeLabels(labels);
  for (  String label : labels) {
    checkAndThrowLabelName(label);
  }
  for (  String label : labels) {
    if (this.labelCollections.get(label) == null) {
      this.labelCollections.put(label,new RMNodeLabel(label));
      newLabels.add(label);
    }
  }
  if (null != dispatcher && !newLabels.isEmpty()) {
    dispatcher.getEventHandler().handle(new StoreNewClusterNodeLabels(newLabels));
  }
  LOG.info("Add labels: [" + StringUtils.join(labels.iterator(),",") + "]");
}
