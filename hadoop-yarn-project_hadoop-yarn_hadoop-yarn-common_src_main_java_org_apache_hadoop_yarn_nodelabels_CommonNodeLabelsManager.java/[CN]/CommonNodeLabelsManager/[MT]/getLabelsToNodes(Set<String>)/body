{
  try {
    readLock.lock();
    Map<String,Set<NodeId>> labelsToNodes=new HashMap<String,Set<NodeId>>();
    for (    String label : labels) {
      if (label.equals(NO_LABEL)) {
        continue;
      }
      RMNodeLabel nodeLabelInfo=labelCollections.get(label);
      if (nodeLabelInfo != null) {
        Set<NodeId> nodeIds=nodeLabelInfo.getAssociatedNodeIds();
        if (!nodeIds.isEmpty()) {
          labelsToNodes.put(label,nodeIds);
        }
      }
 else {
        LOG.warn("getLabelsToNodes : Label [" + label + "] cannot be found");
      }
    }
    return Collections.unmodifiableMap(labelsToNodes);
  }
  finally {
    readLock.unlock();
  }
}
