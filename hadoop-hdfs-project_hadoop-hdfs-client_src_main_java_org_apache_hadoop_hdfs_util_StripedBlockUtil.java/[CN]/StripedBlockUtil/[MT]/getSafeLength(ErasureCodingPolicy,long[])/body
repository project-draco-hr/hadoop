{
  final int cellSize=ecPolicy.getCellSize();
  final int dataBlkNum=ecPolicy.getNumDataUnits();
  Preconditions.checkArgument(blockLens.length >= dataBlkNum);
  final int stripeSize=dataBlkNum * cellSize;
  long[] cpy=Arrays.copyOf(blockLens,blockLens.length);
  Arrays.sort(cpy);
  int lastFullStripeIdx=(int)(cpy[cpy.length - dataBlkNum] / cellSize);
  return lastFullStripeIdx * stripeSize;
}
