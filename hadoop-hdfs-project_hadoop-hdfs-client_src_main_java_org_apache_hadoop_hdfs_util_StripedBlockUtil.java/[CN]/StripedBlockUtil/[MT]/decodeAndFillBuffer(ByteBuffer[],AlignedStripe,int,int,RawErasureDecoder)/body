{
  int[] decodeIndices=new int[parityBlkNum];
  int pos=0;
  for (int i=0; i < dataBlkNum; i++) {
    if (alignedStripe.chunks[i] != null && alignedStripe.chunks[i].state == StripingChunk.MISSING) {
      decodeIndices[pos++]=i;
    }
  }
  decodeIndices=Arrays.copyOf(decodeIndices,pos);
  ByteBuffer[] decodeOutputs=new ByteBuffer[decodeIndices.length];
  for (int i=0; i < decodeOutputs.length; i++) {
    decodeOutputs[i]=ByteBuffer.allocate((int)alignedStripe.getSpanInBlock());
  }
  decoder.decode(decodeInputs,decodeIndices,decodeOutputs);
  for (int i=0; i < decodeIndices.length; i++) {
    int missingBlkIdx=decodeIndices[i];
    StripingChunk chunk=alignedStripe.chunks[missingBlkIdx];
    if (chunk.state == StripingChunk.MISSING && chunk.useChunkBuffer()) {
      chunk.getChunkBuffer().copyFrom(decodeOutputs[i]);
    }
  }
}
