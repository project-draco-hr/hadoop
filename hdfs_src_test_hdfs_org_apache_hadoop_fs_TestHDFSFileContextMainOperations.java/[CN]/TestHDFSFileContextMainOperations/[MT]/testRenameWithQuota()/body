{
  DistributedFileSystem fs=(DistributedFileSystem)cluster.getFileSystem();
  Path src1=getTestRootPath(fc,"test/testRenameWithQuota/srcdir/src1");
  Path src2=getTestRootPath(fc,"test/testRenameWithQuota/srcdir/src2");
  Path dst1=getTestRootPath(fc,"test/testRenameWithQuota/dstdir/dst1");
  Path dst2=getTestRootPath(fc,"test/testRenameWithQuota/dstdir/dst2");
  createFile(src1);
  createFile(src2);
  fs.setQuota(src1.getParent(),FSConstants.QUOTA_DONT_SET,FSConstants.QUOTA_DONT_SET);
  fc.mkdir(dst1.getParent(),FileContext.DEFAULT_PERM,true);
  fs.setQuota(dst1.getParent(),2,FSConstants.QUOTA_DONT_SET);
  rename(src1,dst1,false,true,false,Rename.NONE);
  rename(src2,dst1,true,true,false,Rename.OVERWRITE);
  createFile(src2);
  rename(src2,dst2,false,false,true,Rename.NONE);
  fs.setQuota(src1.getParent(),1,FSConstants.QUOTA_DONT_SET);
  rename(dst1,src1,false,false,true,Rename.NONE);
  fs.setQuota(src1.getParent(),100,FSConstants.QUOTA_DONT_SET);
  createFile(src1);
  fs.setQuota(src1.getParent(),1,FSConstants.QUOTA_DONT_SET);
  rename(dst1,src1,true,true,false,Rename.OVERWRITE);
}
