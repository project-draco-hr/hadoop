{
  ByteArrayOutputStream o=new ByteArrayOutputStream();
  PrintStream out=new PrintStream(o,true);
  try {
    int ret=ToolRunner.run(new GetConf(conf,out,out),args);
    out.flush();
    System.err.println("Output: " + o.toString());
    assertEquals("Expected " + (success ? "success" : "failure") + " for args: "+ Joiner.on(" ").join(args)+ "\n"+ "Output: "+ o.toString(),success,ret == 0);
    return o.toString();
  }
  finally {
    o.close();
    out.close();
  }
}
