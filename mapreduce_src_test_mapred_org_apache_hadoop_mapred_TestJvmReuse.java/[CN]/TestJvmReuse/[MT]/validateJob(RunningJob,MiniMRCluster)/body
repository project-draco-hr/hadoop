{
  assertEquals(JobStatus.SUCCEEDED,job.getJobState());
  long uses=job.getCounters().findCounter("jvm","use").getValue();
  assertTrue("maps = " + numMappers + ", jvms = "+ uses,numMappers < uses);
  JobID jobId=job.getID();
  for (int i=0; i < numMappers; i++) {
    TaskAttemptID attemptId=new TaskAttemptID(new TaskID(jobId,TaskType.MAP,i),0);
    TaskInProgress tip=mr.getJobTrackerRunner().getJobTracker().getTip(attemptId.getTaskID());
    TaskStatus ts=mr.getJobTrackerRunner().getJobTracker().getTaskStatus(attemptId);
    validateAttempt(tip,attemptId,ts,i == taskWithCleanup);
    if (i == taskWithCleanup) {
      attemptId=new TaskAttemptID(new TaskID(jobId,TaskType.MAP,i),1);
      ts=mr.getJobTrackerRunner().getJobTracker().getTaskStatus(attemptId);
      validateAttempt(tip,attemptId,ts,false);
    }
  }
}
