{
  byte[] cluster=Separator.encode(rowKey.getClusterId(),Separator.SPACE,Separator.TAB,Separator.QUALIFIERS);
  byte[] user=Separator.encode(rowKey.getUserId(),Separator.SPACE,Separator.TAB,Separator.QUALIFIERS);
  byte[] flow=Separator.encode(rowKey.getFlowName(),Separator.SPACE,Separator.TAB,Separator.QUALIFIERS);
  byte[] first=Separator.QUALIFIERS.join(cluster,user,flow);
  if (rowKey.getFlowRunId() == null) {
    return Separator.QUALIFIERS.join(first,Separator.EMPTY_BYTES);
  }
  byte[] second=Bytes.toBytes(TimelineStorageUtils.invertLong(rowKey.getFlowRunId()));
  if (rowKey.getAppId() == null || rowKey.getAppId().isEmpty()) {
    return Separator.QUALIFIERS.join(first,second,Separator.EMPTY_BYTES);
  }
  byte[] third=AppIdKeyConverter.getInstance().encode(rowKey.getAppId());
  return Separator.QUALIFIERS.join(first,second,third);
}
