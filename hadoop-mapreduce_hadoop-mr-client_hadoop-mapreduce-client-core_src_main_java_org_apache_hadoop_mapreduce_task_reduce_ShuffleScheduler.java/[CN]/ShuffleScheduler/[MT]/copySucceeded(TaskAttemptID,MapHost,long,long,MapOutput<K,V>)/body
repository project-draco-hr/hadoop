{
  failureCounts.remove(mapId);
  hostFailures.remove(host.getHostName());
  int mapIndex=mapId.getTaskID().getId();
  if (!finishedMaps[mapIndex]) {
    output.commit();
    finishedMaps[mapIndex]=true;
    shuffledMapsCounter.increment(1);
    if (--remainingMaps == 0) {
      notifyAll();
    }
    totalBytesShuffledTillNow+=bytes;
    float mbs=(float)totalBytesShuffledTillNow / (1024 * 1024);
    int mapsDone=totalMaps - remainingMaps;
    long secsSinceStart=(System.currentTimeMillis() - startTime) / 1000 + 1;
    float transferRate=mbs / secsSinceStart;
    progress.set((float)mapsDone / totalMaps);
    String statusString=mapsDone + " / " + totalMaps+ " copied.";
    status.setStateString(statusString);
    progress.setStatus("copy(" + mapsDone + " of "+ totalMaps+ " at "+ mbpsFormat.format(transferRate)+ " MB/s)");
    reduceShuffleBytes.increment(bytes);
    lastProgressTime=System.currentTimeMillis();
    LOG.debug("map " + mapId + " done "+ statusString);
  }
}
