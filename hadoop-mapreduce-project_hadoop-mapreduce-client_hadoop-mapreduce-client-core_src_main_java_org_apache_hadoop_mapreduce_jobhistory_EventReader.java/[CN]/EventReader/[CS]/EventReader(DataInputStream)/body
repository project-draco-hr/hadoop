{
  this.in=in;
  this.version=in.readLine();
  Schema myschema=new SpecificData(Event.class.getClassLoader()).getSchema(Event.class);
  Schema.Parser parser=new Schema.Parser();
  String eventschema=in.readLine();
  if (null != eventschema) {
    try {
      this.schema=parser.parse(eventschema);
      this.reader=new SpecificDatumReader(schema,myschema);
      if (EventWriter.VERSION.equals(version)) {
        this.decoder=DecoderFactory.get().jsonDecoder(schema,in);
      }
 else       if (EventWriter.VERSION_BINARY.equals(version)) {
        this.decoder=DecoderFactory.get().binaryDecoder(in,null);
      }
 else {
        throw new IOException("Incompatible event log version: " + version);
      }
    }
 catch (    AvroRuntimeException e) {
      throw new IOException(e);
    }
  }
 else {
    throw new IOException("Event schema string not parsed since its null");
  }
}
