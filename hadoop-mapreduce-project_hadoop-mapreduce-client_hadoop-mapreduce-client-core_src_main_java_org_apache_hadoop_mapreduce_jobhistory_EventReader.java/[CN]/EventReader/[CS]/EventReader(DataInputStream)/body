{
  this.in=in;
  this.version=in.readLine();
  if (!EventWriter.VERSION.equals(version)) {
    throw new IOException("Incompatible event log version: " + version);
  }
  Schema myschema=new SpecificData(Event.class.getClassLoader()).getSchema(Event.class);
  this.schema=Schema.parse(in.readLine());
  this.reader=new SpecificDatumReader(schema,myschema);
  this.decoder=DecoderFactory.get().jsonDecoder(schema,in);
}
