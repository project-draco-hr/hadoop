{
  this.in=in;
  this.version=in.readLine();
  Schema myschema=new SpecificData(Event.class.getClassLoader()).getSchema(Event.class);
  Schema.Parser parser=new Schema.Parser();
  this.schema=parser.parse(in.readLine());
  this.reader=new SpecificDatumReader(schema,myschema);
  if (EventWriter.VERSION.equals(version)) {
    this.decoder=DecoderFactory.get().jsonDecoder(schema,in);
  }
 else   if (EventWriter.VERSION_BINARY.equals(version)) {
    this.decoder=DecoderFactory.get().binaryDecoder(in,null);
  }
 else {
    throw new IOException("Incompatible event log version: " + version);
  }
}
