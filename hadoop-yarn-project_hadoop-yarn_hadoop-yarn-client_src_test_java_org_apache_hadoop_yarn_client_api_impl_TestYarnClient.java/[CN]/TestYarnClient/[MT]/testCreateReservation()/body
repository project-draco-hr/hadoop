{
  MiniYARNCluster cluster=setupMiniYARNCluster();
  YarnClient client=setupYarnClient(cluster);
  try {
    Clock clock=new UTCClock();
    long arrival=clock.getTime();
    long duration=60000;
    long deadline=(long)(arrival + 1.05 * duration);
    ReservationSubmissionRequest sRequest=submitReservationTestHelper(client,arrival,deadline,duration);
    client.submitReservation(sRequest);
    arrival=clock.getTime();
    ReservationDefinition rDef=sRequest.getReservationDefinition();
    rDef.setArrival(arrival + duration);
    sRequest.setReservationDefinition(rDef);
    try {
      client.submitReservation(sRequest);
      Assert.fail("Reservation submission should fail if a duplicate " + "reservation id is used, but the reservation definition has been " + "updated.");
    }
 catch (    Exception e) {
      Assert.assertTrue(e instanceof YarnException);
    }
  }
  finally {
    if (client != null) {
      client.stop();
    }
    cluster.stop();
  }
}
