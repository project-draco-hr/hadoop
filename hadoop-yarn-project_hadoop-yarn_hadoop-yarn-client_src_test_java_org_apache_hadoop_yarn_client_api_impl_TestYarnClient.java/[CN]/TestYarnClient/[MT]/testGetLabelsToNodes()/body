{
  Configuration conf=new Configuration();
  final YarnClient client=new MockYarnClient();
  client.init(conf);
  client.start();
  Map<String,Set<NodeId>> expectedLabelsToNodes=((MockYarnClient)client).getLabelsToNodesMap();
  Map<String,Set<NodeId>> labelsToNodes=client.getLabelsToNodes();
  Assert.assertEquals(labelsToNodes,expectedLabelsToNodes);
  Assert.assertEquals(labelsToNodes.size(),3);
  Set<String> setLabels=new HashSet<String>(Arrays.asList("x","z"));
  expectedLabelsToNodes=((MockYarnClient)client).getLabelsToNodesMap(setLabels);
  labelsToNodes=client.getLabelsToNodes(setLabels);
  Assert.assertEquals(labelsToNodes,expectedLabelsToNodes);
  Assert.assertEquals(labelsToNodes.size(),2);
  client.stop();
  client.close();
}
