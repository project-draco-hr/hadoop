{
  Configuration conf=new Configuration();
  final YarnClient client=new MockYarnClient();
  client.init(conf);
  client.start();
  List<ApplicationReport> expectedReports=((MockYarnClient)client).getReports();
  Set<String> appTypes=new HashSet<String>();
  appTypes.add("YARN");
  appTypes.add("NON-YARN");
  List<ApplicationReport> reports=client.getApplications(appTypes);
  Assert.assertEquals(reports.size(),2);
  Assert.assertTrue((reports.get(0).getApplicationType().equals("YARN") && reports.get(1).getApplicationType().equals("NON-YARN")) || (reports.get(1).getApplicationType().equals("YARN") && reports.get(0).getApplicationType().equals("NON-YARN")));
  for (  ApplicationReport report : reports) {
    Assert.assertTrue(expectedReports.contains(report));
  }
  reports=client.getApplications();
  Assert.assertEquals(reports,expectedReports);
  client.stop();
}
