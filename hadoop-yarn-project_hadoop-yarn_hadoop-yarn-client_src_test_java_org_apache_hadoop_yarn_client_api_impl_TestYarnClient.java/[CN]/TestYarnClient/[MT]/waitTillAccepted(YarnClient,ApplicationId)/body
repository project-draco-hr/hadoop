{
  try {
    long start=System.currentTimeMillis();
    ApplicationReport report=rmClient.getApplicationReport(appId);
    while (YarnApplicationState.ACCEPTED != report.getYarnApplicationState()) {
      if (System.currentTimeMillis() - start > 20 * 1000) {
        throw new Exception("App '" + appId + "' time out, failed to reach ACCEPTED state");
      }
      Thread.sleep(200);
      report=rmClient.getApplicationReport(appId);
    }
  }
 catch (  Exception ex) {
    throw new Exception(ex);
  }
}
