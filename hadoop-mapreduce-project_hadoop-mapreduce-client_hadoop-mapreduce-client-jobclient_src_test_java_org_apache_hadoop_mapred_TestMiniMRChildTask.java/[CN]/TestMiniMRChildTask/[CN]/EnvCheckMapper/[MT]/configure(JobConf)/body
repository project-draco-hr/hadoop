{
  boolean oldConfigs=job.getBoolean(OLD_CONFIGS,false);
  if (oldConfigs) {
    String javaOpts=job.get(JobConf.MAPRED_TASK_JAVA_OPTS);
    assertNotNull(JobConf.MAPRED_TASK_JAVA_OPTS + " is null!",javaOpts);
    assertEquals(JobConf.MAPRED_TASK_JAVA_OPTS + " has value of: " + javaOpts,javaOpts,TASK_OPTS_VAL);
  }
 else {
    String mapJavaOpts=job.get(JobConf.MAPRED_MAP_TASK_JAVA_OPTS);
    assertNotNull(JobConf.MAPRED_MAP_TASK_JAVA_OPTS + " is null!",mapJavaOpts);
    assertEquals(JobConf.MAPRED_MAP_TASK_JAVA_OPTS + " has value of: " + mapJavaOpts,mapJavaOpts,MAP_OPTS_VAL);
  }
  String path=job.get("path");
  String pwd=System.getenv("PWD");
  assertTrue("LD doesnt contain pwd",System.getenv("LD_LIBRARY_PATH").contains(pwd));
  checkEnv("LD_LIBRARY_PATH","/tmp","append");
  checkEnv("LANG","en_us_8859_1","noappend");
  checkEnv("MY_PATH","/tmp","noappend");
  checkEnv("NEW_PATH",File.pathSeparator + "/tmp","noappend");
  if (Shell.WINDOWS) {
    String hadoopHome=System.getenv("HADOOP_COMMON_HOME");
    if (hadoopHome == null) {
      hadoopHome="";
    }
    String hadoopLibLocation=hadoopHome + "\\bin";
    path+=File.pathSeparator + hadoopLibLocation;
    path+=File.pathSeparator + path;
  }
  checkEnv("PATH",path + File.pathSeparator + "/tmp","noappend");
  String jobLocalDir=job.get(MRJobConfig.JOB_LOCAL_DIR);
  assertNotNull(MRJobConfig.JOB_LOCAL_DIR + " is null",jobLocalDir);
}
