{
  if (dfsCluster == null) {
    JobConf conf=new JobConf();
    if (props != null) {
      for (      Map.Entry entry : props.entrySet()) {
        conf.set((String)entry.getKey(),(String)entry.getValue());
      }
    }
    dfsCluster=new MiniDFSCluster(conf,2,reformatDFS,null);
    ConfigurableMiniMRCluster.setConfiguration(props);
    mrCluster=new ConfigurableMiniMRCluster(2,getFileSystem().getUri().toString(),1,conf);
  }
}
