{
  boolean isValid=false;
  Collection<BlockStoragePolicy> storagePolicies=((DistributedFileSystem)fs).getAllStoragePolicies();
  try {
    for (    BlockStoragePolicy policy : storagePolicies) {
      if (policy.getName().equals(storagePolicy)) {
        isValid=true;
        break;
      }
    }
  }
 catch (  Exception e) {
    throw new IOException("Get block storage policies error: ",e);
  }
  if (!isValid) {
    System.out.println("Invalid block storage policy: " + storagePolicy);
    System.out.println("Current supported storage policy list: ");
    for (    BlockStoragePolicy policy : storagePolicies) {
      System.out.println(policy.getName());
    }
    return false;
  }
  config.set(STORAGE_POLICY_NAME_KEY,storagePolicy);
  LOG.info("storagePolicy = " + storagePolicy);
  return true;
}
