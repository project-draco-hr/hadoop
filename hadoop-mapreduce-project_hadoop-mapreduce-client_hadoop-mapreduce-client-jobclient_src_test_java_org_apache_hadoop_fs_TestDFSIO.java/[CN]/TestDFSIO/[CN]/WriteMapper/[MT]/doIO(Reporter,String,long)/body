{
  OutputStream out;
  out=fs.create(new Path(getDataDir(getConf()),name),true,bufferSize);
  if (compressionCodec != null)   out=compressionCodec.createOutputStream(out);
  try {
    long nrRemaining;
    for (nrRemaining=totalSize; nrRemaining > 0; nrRemaining-=bufferSize) {
      int curSize=(bufferSize < nrRemaining) ? bufferSize : (int)nrRemaining;
      out.write(buffer,0,curSize);
      reporter.setStatus("writing " + name + "@"+ (totalSize - nrRemaining)+ "/"+ totalSize+ " ::host = "+ hostName);
    }
  }
  finally {
    out.close();
  }
  return Long.valueOf(totalSize);
}
