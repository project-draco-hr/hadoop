{
  LOG.info("Executing \"Cancel plan\" command.");
  Preconditions.checkState(cmd.hasOption(DiskBalancer.CANCEL));
  verifyCommandOptions(DiskBalancer.CANCEL,cmd);
  if (cmd.hasOption(DiskBalancer.NODE)) {
    String nodeAddress=cmd.getOptionValue(DiskBalancer.NODE);
    String planHash=cmd.getOptionValue(DiskBalancer.CANCEL);
    cancelPlanUsingHash(nodeAddress,planHash);
  }
 else {
    String planFile=cmd.getOptionValue(DiskBalancer.CANCEL);
    Preconditions.checkArgument(planFile != null && !planFile.isEmpty(),"Invalid plan file specified.");
    String planData=null;
    try (FSDataInputStream plan=open(planFile)){
      planData=IOUtils.toString(plan);
    }
     cancelPlan(planData);
  }
}
