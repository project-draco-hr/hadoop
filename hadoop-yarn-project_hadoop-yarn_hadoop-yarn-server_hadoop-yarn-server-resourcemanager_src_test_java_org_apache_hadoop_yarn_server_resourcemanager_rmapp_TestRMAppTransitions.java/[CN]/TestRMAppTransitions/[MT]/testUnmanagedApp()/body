{
  ApplicationSubmissionContext subContext=new ApplicationSubmissionContextPBImpl();
  subContext.setUnmanagedAM(true);
  LOG.info("--- START: testUnmanagedAppSuccessPath ---");
  testCreateAppFinished(subContext);
  LOG.info("--- START: testUnmanagedAppFailPath ---");
  RMApp application=testCreateAppRunning(subContext);
  RMAppEvent event=new RMAppFailedAttemptEvent(application.getApplicationId(),RMAppEventType.ATTEMPT_FAILED,"");
  application.handle(event);
  rmDispatcher.await();
  RMAppAttempt appAttempt=application.getCurrentAppAttempt();
  Assert.assertEquals(1,appAttempt.getAppAttemptId().getAttemptId());
  assertFailed(application,".*Unmanaged application.*Failing the application.*");
}
