{
  LOG.info("--- START: testAppFailedFailed ---");
  RMApp application=testCreateAppNewSaving(null);
  RMAppEvent event=new RMAppEvent(application.getApplicationId(),RMAppEventType.APP_REJECTED,"");
  application.handle(event);
  rmDispatcher.await();
  sendAppUpdateSavedEvent(application);
  assertTimesAtFinish(application);
  assertAppState(RMAppState.FAILED,application);
  event=new RMAppEvent(application.getApplicationId(),RMAppEventType.KILL,"Application killed by user.");
  application.handle(event);
  rmDispatcher.await();
  assertTimesAtFinish(application);
  assertAppState(RMAppState.FAILED,application);
  verifyApplicationFinished(RMAppState.FAILED);
  assertTimesAtFinish(application);
  assertAppState(RMAppState.FAILED,application);
}
