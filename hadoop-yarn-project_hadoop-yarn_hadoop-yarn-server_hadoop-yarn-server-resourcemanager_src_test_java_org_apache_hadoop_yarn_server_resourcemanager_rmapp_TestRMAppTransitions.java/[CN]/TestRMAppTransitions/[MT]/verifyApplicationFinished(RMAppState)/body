{
  ArgumentCaptor<RMAppState> finalState=ArgumentCaptor.forClass(RMAppState.class);
  verify(writer).applicationFinished(any(RMApp.class),finalState.capture());
  Assert.assertEquals(state,finalState.getValue());
  finalState=ArgumentCaptor.forClass(RMAppState.class);
  verify(publisher).appFinished(any(RMApp.class),finalState.capture(),anyLong());
  Assert.assertEquals(state,finalState.getValue());
}
