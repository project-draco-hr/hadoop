{
  String[] origDistFiles=origJobConf.get(GridMixConfig.GRIDMIX_DISTCACHE_FILES).split(",");
  String[] simuDistFiles=simuJobConf.get(GridMixConfig.GRIDMIX_DISTCACHE_FILES).split(",");
  String[] simuDistVisibilities=simuJobConf.get(GridMixConfig.GRIDMIX_DISTCACHE_VISIBILITIES).split(",");
  Assert.assertEquals("No. of simulatued job's distcache files mismacted" + "with no.of original job's distcache files",origDistFiles.length,simuDistFiles.length);
  int index=0;
  for (  String simDistFile : simuDistFiles) {
    Path distPath=new Path(simDistFile);
    boolean isLocalDistCache=GridmixSystemTestCase.isLocalDistCache(simDistFile,simuJobConf.getUser(),Boolean.valueOf(simuDistVisibilities[index]));
    if (!isLocalDistCache) {
      FileSystem fs=distPath.getFileSystem(conf);
      FileStatus fstat=fs.getFileStatus(distPath);
      FsPermission permission=fstat.getPermission();
      Assert.assertTrue("HDFS distributed cache file has wrong " + "permissions for users.",FsAction.READ_WRITE.SYMBOL == permission.getUserAction().SYMBOL);
      Assert.assertTrue("HDFS distributed cache file has wrong " + "permissions for groups.",FsAction.READ.SYMBOL == permission.getGroupAction().SYMBOL);
      Assert.assertTrue("HDSFS distributed cache file has wrong " + "permissions for others.",FsAction.READ.SYMBOL == permission.getOtherAction().SYMBOL);
    }
    index++;
  }
}
