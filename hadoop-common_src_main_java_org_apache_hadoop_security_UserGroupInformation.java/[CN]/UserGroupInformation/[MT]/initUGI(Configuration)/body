{
  String value=conf.get(HADOOP_SECURITY_AUTHENTICATION);
  if (value == null || "simple".equals(value)) {
    useKerberos=false;
  }
 else   if ("kerberos".equals(value)) {
    useKerberos=true;
  }
 else {
    throw new IllegalArgumentException("Invalid attribute value for " + HADOOP_SECURITY_AUTHENTICATION + " of "+ value);
  }
  if (!(groups instanceof TestingGroups)) {
    groups=Groups.getUserToGroupsMappingService(conf);
  }
  javax.security.auth.login.Configuration existingConfig=null;
  try {
    existingConfig=javax.security.auth.login.Configuration.getConfiguration();
  }
 catch (  SecurityException se) {
  }
  if (existingConfig instanceof HadoopConfiguration) {
    LOG.info("JAAS Configuration already set up for Hadoop, not re-installing.");
  }
 else {
    javax.security.auth.login.Configuration.setConfiguration(new HadoopConfiguration(existingConfig));
  }
  isInitialized=true;
  UserGroupInformation.conf=conf;
}
