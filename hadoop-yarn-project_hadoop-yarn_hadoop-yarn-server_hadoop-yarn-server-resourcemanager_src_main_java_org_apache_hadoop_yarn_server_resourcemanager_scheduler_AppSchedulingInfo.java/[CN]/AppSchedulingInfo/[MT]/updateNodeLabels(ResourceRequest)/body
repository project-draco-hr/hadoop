{
  SchedulerRequestKey schedulerKey=SchedulerRequestKey.create(request);
  String resourceName=request.getResourceName();
  if (resourceName.equals(ResourceRequest.ANY)) {
    ResourceRequest previousAnyRequest=getResourceRequest(schedulerKey,resourceName);
    if ((null == previousAnyRequest) || hasRequestLabelChanged(previousAnyRequest,request)) {
      Map<String,ResourceRequest> resourceRequest=getResourceRequests(schedulerKey);
      if (resourceRequest != null) {
        for (        ResourceRequest r : resourceRequest.values()) {
          if (!r.getResourceName().equals(ResourceRequest.ANY)) {
            r.setNodeLabelExpression(request.getNodeLabelExpression());
          }
        }
      }
    }
  }
 else {
    ResourceRequest anyRequest=getResourceRequest(schedulerKey,ResourceRequest.ANY);
    if (anyRequest != null) {
      request.setNodeLabelExpression(anyRequest.getNodeLabelExpression());
    }
  }
}
