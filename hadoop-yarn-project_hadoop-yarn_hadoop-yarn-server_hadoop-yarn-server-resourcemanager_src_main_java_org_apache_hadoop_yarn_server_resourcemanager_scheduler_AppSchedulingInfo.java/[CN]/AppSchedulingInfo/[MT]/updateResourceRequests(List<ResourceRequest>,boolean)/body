{
  boolean anyResourcesUpdated=false;
  for (  ResourceRequest request : requests) {
    Priority priority=request.getPriority();
    String resourceName=request.getResourceName();
    updateNodeLabels(request);
    Map<String,ResourceRequest> asks=this.resourceRequestMap.get(priority);
    if (asks == null) {
      asks=new ConcurrentHashMap<>();
      this.resourceRequestMap.put(priority,asks);
      this.priorities.add(priority);
    }
    ResourceRequest lastRequest=asks.get(resourceName);
    if (recoverPreemptedRequest && lastRequest != null) {
      request.setNumContainers(lastRequest.getNumContainers() + 1);
    }
    asks.put(resourceName,request);
    if (resourceName.equals(ResourceRequest.ANY)) {
      anyResourcesUpdated=true;
      if (request.getNumContainers() > 0) {
        activeUsersManager.activateApplication(user,applicationId);
      }
      updatePendingResources(lastRequest,request,queue.getMetrics());
    }
  }
  return anyResourcesUpdated;
}
