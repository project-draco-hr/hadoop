{
  if (type == NodeType.NODE_LOCAL) {
    allocateNodeLocal(node,priority,request,container);
  }
 else   if (type == NodeType.RACK_LOCAL) {
    allocateRackLocal(node,priority,request,container);
  }
 else {
    allocateOffSwitch(node,priority,request,container);
  }
  QueueMetrics metrics=queue.getMetrics();
  if (pending) {
    pending=false;
    metrics.runAppAttempt(applicationId,user);
  }
  LOG.debug("allocate: user: " + user + ", memory: "+ request.getCapability());
  metrics.allocateResources(user,1,request.getCapability());
}
