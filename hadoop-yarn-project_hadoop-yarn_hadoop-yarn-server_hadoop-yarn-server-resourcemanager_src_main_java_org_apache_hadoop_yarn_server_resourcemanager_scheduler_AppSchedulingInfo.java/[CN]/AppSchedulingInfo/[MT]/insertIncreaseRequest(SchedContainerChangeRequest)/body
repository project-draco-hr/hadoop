{
  NodeId nodeId=request.getNodeId();
  SchedulerRequestKey schedulerKey=request.getRMContainer().getAllocatedSchedulerKey();
  ContainerId containerId=request.getContainerId();
  Map<SchedulerRequestKey,Map<ContainerId,SchedContainerChangeRequest>> requestsOnNode=containerIncreaseRequestMap.get(nodeId);
  if (null == requestsOnNode) {
    requestsOnNode=new HashMap<>();
    containerIncreaseRequestMap.put(nodeId,requestsOnNode);
  }
  Map<ContainerId,SchedContainerChangeRequest> requestsOnNodeWithPriority=requestsOnNode.get(schedulerKey);
  if (null == requestsOnNodeWithPriority) {
    requestsOnNodeWithPriority=new TreeMap<>();
    requestsOnNode.put(schedulerKey,requestsOnNodeWithPriority);
  }
  requestsOnNodeWithPriority.put(containerId,request);
  String partition=request.getRMContainer().getNodeLabelExpression();
  Resource delta=request.getDeltaCapacity();
  appResourceUsage.incPending(partition,delta);
  queue.incPendingResource(partition,delta);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Added increase request:" + request.getContainerId() + " delta="+ delta);
  }
  schedulerKeys.add(schedulerKey);
}
