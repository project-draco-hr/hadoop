{
  LightWeightHashSet<Block> set=node2blocks.get(datanode.getDatanodeUuid());
  if (set == null) {
    set=new LightWeightHashSet<Block>();
    node2blocks.put(datanode.getDatanodeUuid(),set);
  }
  if (set.add(block)) {
    numBlocks++;
    if (log) {
      NameNode.blockStateChangeLog.info("BLOCK* " + getClass().getSimpleName() + ": add "+ block+ " to "+ datanode);
    }
  }
}
