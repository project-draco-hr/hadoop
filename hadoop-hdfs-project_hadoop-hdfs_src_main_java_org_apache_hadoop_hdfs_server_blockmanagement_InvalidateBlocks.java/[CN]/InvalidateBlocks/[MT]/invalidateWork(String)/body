{
  final DatanodeDescriptor dn=datanodeManager.getDatanode(storageId);
  if (dn == null) {
    remove(storageId);
    return 0;
  }
  final List<Block> toInvalidate=invalidateWork(storageId,dn);
  if (toInvalidate == null) {
    return 0;
  }
  if (NameNode.stateChangeLog.isInfoEnabled()) {
    NameNode.stateChangeLog.info("BLOCK* " + getClass().getSimpleName() + ": ask "+ dn.getName()+ " to delete "+ toInvalidate);
  }
  return toInvalidate.size();
}
