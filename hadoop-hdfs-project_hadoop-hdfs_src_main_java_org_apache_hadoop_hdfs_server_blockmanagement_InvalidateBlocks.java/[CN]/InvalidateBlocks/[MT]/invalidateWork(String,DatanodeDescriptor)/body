{
  final LightWeightHashSet<Block> set=node2blocks.get(storageId);
  if (set == null) {
    return null;
  }
  final int limit=datanodeManager.blockInvalidateLimit;
  final List<Block> toInvalidate=set.pollN(limit);
  if (set.isEmpty()) {
    remove(storageId);
  }
  dn.addBlocksToBeInvalidated(toInvalidate);
  numBlocks-=toInvalidate.size();
  return toInvalidate;
}
