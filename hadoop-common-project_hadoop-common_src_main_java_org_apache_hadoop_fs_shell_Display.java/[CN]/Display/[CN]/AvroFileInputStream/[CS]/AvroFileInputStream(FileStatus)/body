{
  pos=0;
  buffer=new byte[0];
  GenericDatumReader<Object> reader=new GenericDatumReader<Object>();
  FileContext fc=FileContext.getFileContext(new Configuration());
  fileReader=DataFileReader.openReader(new AvroFSInput(fc,status.getPath()),reader);
  Schema schema=fileReader.getSchema();
  writer=new GenericDatumWriter<Object>(schema);
  output=new ByteArrayOutputStream();
  JsonGenerator generator=new JsonFactory().createJsonGenerator(output,JsonEncoding.UTF8);
  MinimalPrettyPrinter prettyPrinter=new MinimalPrettyPrinter();
  prettyPrinter.setRootValueSeparator(System.getProperty("line.separator"));
  generator.setPrettyPrinter(prettyPrinter);
  encoder=EncoderFactory.get().jsonEncoder(schema,generator);
}
