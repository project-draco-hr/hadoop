{
  int ret;
  if (null == inbuf || -1 == (ret=inbuf.read())) {
    if (!r.next(key,val)) {
      return -1;
    }
    byte[] tmp=key.toString().getBytes(Charsets.UTF_8);
    outbuf.write(tmp,0,tmp.length);
    outbuf.write('\t');
    tmp=val.toString().getBytes(Charsets.UTF_8);
    outbuf.write(tmp,0,tmp.length);
    outbuf.write('\n');
    inbuf.reset(outbuf.getData(),outbuf.getLength());
    outbuf.reset();
    ret=inbuf.read();
  }
  return ret;
}
