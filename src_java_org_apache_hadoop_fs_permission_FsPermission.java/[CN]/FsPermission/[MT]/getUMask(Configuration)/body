{
  int umask=DEFAULT_UMASK;
  if (conf != null) {
    String confUmask=conf.get(UMASK_LABEL);
    if (confUmask != null) {
      umask=new UmaskParser(confUmask).getUMask();
    }
 else {
      int oldStyleValue=conf.getInt(DEPRECATED_UMASK_LABEL,Integer.MIN_VALUE);
      if (oldStyleValue != Integer.MIN_VALUE) {
        LOG.warn(DEPRECATED_UMASK_LABEL + " configuration key is deprecated. " + "Convert to "+ UMASK_LABEL+ ", using octal or symbolic umask "+ "specifications.");
        umask=oldStyleValue;
      }
    }
  }
  return new FsPermission((short)umask);
}
