{
  int umask=DEFAULT_UMASK;
  if (conf != null) {
    String confUmask=conf.get(UMASK_LABEL);
    if (confUmask != null) {
      try {
        if (conf.deprecatedKeyWasSet(DEPRECATED_UMASK_LABEL))         umask=Integer.parseInt(confUmask);
 else         umask=new UmaskParser(confUmask).getUMask();
      }
 catch (      IllegalArgumentException iae) {
        String type=iae instanceof NumberFormatException ? "decimal" : "octal or symbolic";
        throw new IllegalArgumentException("Unable to parse " + confUmask + " as "+ type+ " umask.");
      }
    }
  }
  return new FsPermission((short)umask);
}
