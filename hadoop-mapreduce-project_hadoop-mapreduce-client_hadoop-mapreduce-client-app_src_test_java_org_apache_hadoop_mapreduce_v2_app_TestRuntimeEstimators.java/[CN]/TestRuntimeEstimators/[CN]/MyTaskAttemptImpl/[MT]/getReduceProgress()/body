{
  Job job=myAppContext.getJob(myAttemptID.getTaskId().getJobId());
  float runtime=getCodeRuntime();
  Collection<Task> allMapTasks=job.getTasks(TaskType.MAP).values();
  int numberMaps=allMapTasks.size();
  int numberDoneMaps=0;
  for (  Task mapTask : allMapTasks) {
    if (mapTask.isFinished()) {
      ++numberDoneMaps;
    }
  }
  if (numberMaps == numberDoneMaps) {
    shuffleCompletedTime=Math.min(shuffleCompletedTime,clock.getTime());
    return Math.min((float)(clock.getTime() - shuffleCompletedTime) / (runtime * 2000.0F) + 0.5F,1.0F);
  }
 else {
    return ((float)numberDoneMaps) / numberMaps * 0.5F;
  }
}
