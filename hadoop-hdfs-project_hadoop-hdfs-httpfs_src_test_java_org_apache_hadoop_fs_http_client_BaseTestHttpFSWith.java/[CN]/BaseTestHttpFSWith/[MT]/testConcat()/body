{
  Configuration config=getProxiedFSConf();
  config.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,1024);
  if (!isLocalFS()) {
    FileSystem fs=FileSystem.get(config);
    fs.mkdirs(getProxiedFSTestDir());
    Path path1=new Path("/test/foo.txt");
    Path path2=new Path("/test/bar.txt");
    Path path3=new Path("/test/derp.txt");
    DFSTestUtil.createFile(fs,path1,1024,(short)3,0);
    DFSTestUtil.createFile(fs,path2,1024,(short)3,0);
    DFSTestUtil.createFile(fs,path3,1024,(short)3,0);
    fs.close();
    fs=getHttpFSFileSystem();
    fs.concat(path1,new Path[]{path2,path3});
    fs.close();
    fs=FileSystem.get(config);
    assertTrue(fs.exists(path1));
    assertFalse(fs.exists(path2));
    assertFalse(fs.exists(path3));
    fs.close();
  }
}
