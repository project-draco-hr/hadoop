{
  if (!isLocalFS()) {
    final short repl=3;
    final int blockSize=1024;
    final int numOfBlocks=2;
    FileSystem fs=FileSystem.get(getProxiedFSConf());
    fs.mkdirs(getProxiedFSTestDir());
    Path file=new Path(getProxiedFSTestDir(),"foo.txt");
    final byte[] data=FileSystemTestHelper.getFileData(numOfBlocks,blockSize);
    FileSystemTestHelper.createFile(fs,file,data,blockSize,repl);
    final int newLength=blockSize;
    boolean isReady=fs.truncate(file,newLength);
    Assert.assertTrue("Recovery is not expected.",isReady);
    FileStatus fileStatus=fs.getFileStatus(file);
    Assert.assertEquals(fileStatus.getLen(),newLength);
    AppendTestUtil.checkFullFile(fs,file,newLength,data,file.toString());
    fs.close();
  }
}
