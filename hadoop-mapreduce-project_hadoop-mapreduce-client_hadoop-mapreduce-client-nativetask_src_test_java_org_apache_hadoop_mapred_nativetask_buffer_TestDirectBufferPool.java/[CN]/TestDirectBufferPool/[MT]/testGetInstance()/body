{
  final int num=100;
  List<DirectBufferPool> pools=new ArrayList<DirectBufferPool>();
  Thread[] list=new Thread[num];
  for (int i=0; i < num; i++) {
    Thread t=getPoolThread(pools);
    t.start();
    list[i]=t;
  }
  for (int i=0; i < num; i++) {
    try {
      list[i].join(10000);
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
  DirectBufferPool p1=pools.get(0);
  assertNotNull(p1);
  for (int i=1; i < pools.size(); i++) {
    DirectBufferPool p2=pools.get(i);
    assertNotNull(p2);
    assertSame(p1,p2);
  }
}
