{
  Path pathWithScheme=p;
  if (!pathWithScheme.toUri().isAbsolute()) {
    FileSystem localFs=FileSystem.getLocal(job);
    pathWithScheme=localFs.makeQualified(p);
  }
  FileStatus status=getFileStatus(statCache,job,pathWithScheme);
  if (status.isDirectory()) {
    FileStatus[] statusArray=pathWithScheme.getFileSystem(job).listStatus(pathWithScheme);
    for (    FileStatus s : statusArray) {
      explorePath(job,s.getPath(),limitChecker,statCache);
    }
  }
 else {
    limitChecker.addFile(pathWithScheme,status.getLen());
  }
}
