{
  Scan scan=new Scan();
  String clusterId=getContext().getClusterId();
  if (getFilters().getCreatedTimeBegin() == 0L && getFilters().getCreatedTimeEnd() == Long.MAX_VALUE) {
    scan.setRowPrefixFilter(new FlowActivityRowKeyPrefix(clusterId).getRowKeyPrefix());
  }
 else {
    scan.setStartRow(new FlowActivityRowKeyPrefix(clusterId,getFilters().getCreatedTimeEnd()).getRowKeyPrefix());
    scan.setStopRow(new FlowActivityRowKeyPrefix(clusterId,(getFilters().getCreatedTimeBegin() <= 0 ? 0 : (getFilters().getCreatedTimeBegin() - 1))).getRowKeyPrefix());
  }
  scan.setFilter(new PageFilter(getFilters().getLimit()));
  return getTable().getResultScanner(hbaseConf,conn,scan);
}
