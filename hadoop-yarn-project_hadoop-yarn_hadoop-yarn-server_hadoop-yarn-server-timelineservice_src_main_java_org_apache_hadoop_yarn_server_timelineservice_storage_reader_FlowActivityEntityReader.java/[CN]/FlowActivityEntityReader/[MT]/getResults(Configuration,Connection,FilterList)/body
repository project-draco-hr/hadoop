{
  Scan scan=new Scan();
  String clusterId=getContext().getClusterId();
  if (getFilters().getCreatedTimeBegin() == 0L && getFilters().getCreatedTimeEnd() == Long.MAX_VALUE) {
    scan.setRowPrefixFilter(FlowActivityRowKey.getRowKeyPrefix(clusterId));
  }
 else {
    scan.setStartRow(FlowActivityRowKey.getRowKeyPrefix(clusterId,getFilters().getCreatedTimeEnd()));
    scan.setStopRow(FlowActivityRowKey.getRowKeyPrefix(clusterId,(getFilters().getCreatedTimeBegin() <= 0 ? 0 : (getFilters().getCreatedTimeBegin() - 1))));
  }
  scan.setFilter(new PageFilter(getFilters().getLimit()));
  return getTable().getResultScanner(hbaseConf,conn,scan);
}
