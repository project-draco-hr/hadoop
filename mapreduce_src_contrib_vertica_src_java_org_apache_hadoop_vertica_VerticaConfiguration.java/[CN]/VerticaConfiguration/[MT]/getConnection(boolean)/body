{
  try {
    Class.forName(VERTICA_DRIVER_CLASS);
  }
 catch (  ClassNotFoundException e) {
    throw new RuntimeException(e);
  }
  String[] hosts=conf.getStrings(HOSTNAMES_PROP);
  String user=conf.get(USERNAME_PROP);
  String pass=conf.get(PASSWORD_PROP);
  String database=conf.get(DATABASE_PROP);
  if (output) {
    hosts=conf.getStrings(OUTPUT_HOSTNAMES_PROP,hosts);
    user=conf.get(OUTPUT_USERNAME_PROP,user);
    pass=conf.get(OUTPUT_PASSWORD_PROP,pass);
    database=conf.get(OUTPUT_DATABASE_PROP,database);
  }
  if (hosts == null)   throw new IOException("Vertica requies a hostname defined by " + HOSTNAMES_PROP);
  if (hosts.length == 0)   throw new IOException("Vertica requies a hostname defined by " + HOSTNAMES_PROP);
  if (database == null)   throw new IOException("Vertica requies a database name defined by " + DATABASE_PROP);
  Random r=new Random();
  if (user == null)   throw new IOException("Vertica requires a username defined by " + USERNAME_PROP);
  return DriverManager.getConnection("jdbc:vertica://" + hosts[r.nextInt(hosts.length)] + ":5433/"+ database,user,pass);
}
