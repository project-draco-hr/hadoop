{
  DelegationToken dToken=BuilderUtils.newDelegationToken(token.getIdentifier(),token.getKind().toString(),token.getPassword(),token.getService().toString());
  MRClientProtocol histProxy=instantiateHistoryProxy(conf,SecurityUtil.getTokenServiceAddr(token));
  try {
    RenewDelegationTokenRequest request=Records.newRecord(RenewDelegationTokenRequest.class);
    request.setDelegationToken(dToken);
    return histProxy.renewDelegationToken(request).getNextExpirationTime();
  }
  finally {
    stopHistoryProxy(histProxy);
  }
}
