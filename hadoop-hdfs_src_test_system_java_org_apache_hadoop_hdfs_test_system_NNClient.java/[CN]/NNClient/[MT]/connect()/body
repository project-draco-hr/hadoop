{
  if (isConnected())   return;
  String sockAddrStr=FileSystem.getDefaultUri(getConf()).getAuthority();
  if (sockAddrStr == null) {
    throw new IllegalArgumentException("Namenode IPC address is not set");
  }
  String[] splits=sockAddrStr.split(":");
  if (splits.length != 2) {
    throw new IllegalArgumentException("Namenode report IPC is not correctly configured");
  }
  String port=splits[1];
  String sockAddr=getHostName() + ":" + port;
  InetSocketAddress bindAddr=NetUtils.createSocketAddr(sockAddr);
  proxy=(NNProtocol)RPC.getProxy(NNProtocol.class,NNProtocol.versionID,bindAddr,getConf());
  setConnected(true);
}
