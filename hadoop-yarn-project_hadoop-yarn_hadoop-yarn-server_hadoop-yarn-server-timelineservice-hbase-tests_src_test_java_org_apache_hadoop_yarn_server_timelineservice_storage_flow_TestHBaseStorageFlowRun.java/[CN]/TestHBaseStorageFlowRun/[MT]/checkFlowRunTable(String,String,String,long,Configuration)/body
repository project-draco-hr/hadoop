{
  Scan s=new Scan();
  s.addFamily(FlowRunColumnFamily.INFO.getBytes());
  byte[] startRow=FlowRunRowKey.getRowKey(cluster,user,flow,runid);
  s.setStartRow(startRow);
  String clusterStop=cluster + "1";
  byte[] stopRow=FlowRunRowKey.getRowKey(clusterStop,user,flow,runid);
  s.setStopRow(stopRow);
  Connection conn=ConnectionFactory.createConnection(c1);
  Table table1=conn.getTable(TableName.valueOf(FlowRunTable.DEFAULT_TABLE_NAME));
  ResultScanner scanner=table1.getScanner(s);
  int rowCount=0;
  for (  Result result : scanner) {
    assertNotNull(result);
    assertTrue(!result.isEmpty());
    Map<byte[],byte[]> values=result.getFamilyMap(FlowRunColumnFamily.INFO.getBytes());
    rowCount++;
    byte[] q=ColumnHelper.getColumnQualifier(FlowRunColumnPrefix.METRIC.getColumnPrefixBytes(),METRIC1);
    assertTrue(values.containsKey(q));
    assertEquals(141L,Bytes.toLong(values.get(q)));
    assertEquals(3,values.size());
    q=ColumnHelper.getColumnQualifier(FlowRunColumnPrefix.METRIC.getColumnPrefixBytes(),METRIC2);
    assertTrue(values.containsKey(q));
    assertEquals(57L,Bytes.toLong(values.get(q)));
  }
  assertEquals(1,rowCount);
}
