{
  IFileInputStream checksumIn=new IFileInputStream(input,compressedLength,conf);
  input=checksumIn;
  if (codec != null) {
    decompressor.reset();
    input=codec.createInputStream(input,decompressor);
  }
  try {
    IOUtils.readFully(input,memory,0,memory.length);
    metrics.inputBytes(memory.length);
    reporter.progress();
    LOG.info("Read " + memory.length + " bytes from map-output for "+ getMapId());
    if (input.read() >= 0) {
      throw new IOException("Unexpected extra bytes from input stream for " + getMapId());
    }
  }
 catch (  IOException ioe) {
    IOUtils.cleanup(LOG,input);
    throw ioe;
  }
 finally {
    CodecPool.returnDecompressor(decompressor);
  }
}
