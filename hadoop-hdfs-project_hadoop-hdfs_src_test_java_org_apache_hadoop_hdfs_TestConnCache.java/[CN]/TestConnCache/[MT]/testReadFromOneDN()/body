{
  BlockReaderTestUtil util=new BlockReaderTestUtil(1,new HdfsConfiguration());
  final Path testFile=new Path("/testConnCache.dat");
  byte authenticData[]=util.writeFile(testFile,FILE_SIZE / 1024);
  DFSClient client=new DFSClient(new InetSocketAddress("localhost",util.getCluster().getNameNodePort()),util.getConf());
  DFSInputStream in=Mockito.spy(client.open(testFile.toString()));
  LOG.info("opened " + testFile.toString());
  byte[] dataBuf=new byte[BLOCK_SIZE];
  MockGetBlockReader answer=new MockGetBlockReader();
  Mockito.doAnswer(answer).when(in).getBlockReader((InetSocketAddress)Matchers.anyObject(),(DatanodeInfo)Matchers.anyObject(),Matchers.anyString(),(ExtendedBlock)Matchers.anyObject(),(Token<BlockTokenIdentifier>)Matchers.anyObject(),Matchers.anyLong(),Matchers.anyLong(),Matchers.anyInt(),Matchers.anyBoolean(),Matchers.anyString(),(CachingStrategy)Matchers.anyObject());
  pread(in,0,dataBuf,0,dataBuf.length,authenticData);
  pread(in,FILE_SIZE - dataBuf.length,dataBuf,0,dataBuf.length,authenticData);
  pread(in,1024,dataBuf,0,dataBuf.length,authenticData);
  pread(in,-1,dataBuf,0,dataBuf.length,authenticData);
  pread(in,64,dataBuf,0,dataBuf.length / 2,authenticData);
  in.close();
}
