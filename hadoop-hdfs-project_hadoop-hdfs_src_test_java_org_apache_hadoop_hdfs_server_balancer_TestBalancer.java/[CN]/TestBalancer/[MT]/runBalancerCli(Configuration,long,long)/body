{
  waitForHeartBeat(totalUsedSpace,totalCapacity,client,cluster);
  final String[] args={"-policy","datanode"};
  final Tool tool=new Cli();
  tool.setConf(conf);
  final int r=tool.run(args);
  assertEquals("Tools should exit 0 on success",0,r);
  waitForHeartBeat(totalUsedSpace,totalCapacity,client,cluster);
  LOG.info("Rebalancing with default ctor.");
  waitForBalancer(totalUsedSpace,totalCapacity,client,cluster);
}
