{
  waitForHeartBeat(totalUsedSpace,totalCapacity,client,cluster);
  Collection<URI> namenodes=DFSUtil.getNsServiceRpcUris(conf);
  final int r=Balancer.run(namenodes,p,conf);
  if (conf.getInt(DFSConfigKeys.DFS_DATANODE_BALANCE_MAX_NUM_CONCURRENT_MOVES_KEY,DFSConfigKeys.DFS_DATANODE_BALANCE_MAX_NUM_CONCURRENT_MOVES_DEFAULT) == 0) {
    assertEquals(Balancer.ReturnStatus.NO_MOVE_PROGRESS.code,r);
    return;
  }
 else {
    assertEquals(Balancer.ReturnStatus.SUCCESS.code,r);
  }
  waitForHeartBeat(totalUsedSpace,totalCapacity,client,cluster);
  LOG.info("Rebalancing with default ctor.");
  waitForBalancer(totalUsedSpace,totalCapacity,client,cluster,p,excludedNodes);
}
