{
  waitForHeartBeat(totalUsedSpace,totalCapacity,client,cluster);
  Map<String,Map<String,InetSocketAddress>> namenodes=DFSUtil.getNNServiceRpcAddresses(conf);
  final int r=Balancer.run(namenodes,Balancer.Parameters.DEFALUT,conf);
  assertEquals(Balancer.ReturnStatus.SUCCESS.code,r);
  waitForHeartBeat(totalUsedSpace,totalCapacity,client,cluster);
  LOG.info("Rebalancing with default ctor.");
  waitForBalancer(totalUsedSpace,totalCapacity,client,cluster);
}
