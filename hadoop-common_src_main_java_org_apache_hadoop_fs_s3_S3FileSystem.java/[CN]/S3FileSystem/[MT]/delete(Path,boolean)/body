{
  Path absolutePath=makeAbsolute(path);
  INode inode=store.retrieveINode(absolutePath);
  if (inode == null) {
    return false;
  }
  if (inode.isFile()) {
    store.deleteINode(absolutePath);
    for (    Block block : inode.getBlocks()) {
      store.deleteBlock(block);
    }
  }
 else {
    FileStatus[] contents=null;
    try {
      contents=listStatus(absolutePath);
    }
 catch (    FileNotFoundException fnfe) {
      return false;
    }
    if ((contents.length != 0) && (!recursive)) {
      throw new IOException("Directory " + path.toString() + " is not empty.");
    }
    for (    FileStatus p : contents) {
      if (!delete(p.getPath(),recursive)) {
        return false;
      }
    }
    store.deleteINode(absolutePath);
  }
  return true;
}
