{
  Path absoluteSrc=makeAbsolute(src);
  INode srcINode=store.retrieveINode(absoluteSrc);
  if (srcINode == null) {
    return false;
  }
  Path absoluteDst=makeAbsolute(dst);
  INode dstINode=store.retrieveINode(absoluteDst);
  if (dstINode != null && dstINode.isDirectory()) {
    absoluteDst=new Path(absoluteDst,absoluteSrc.getName());
    dstINode=store.retrieveINode(absoluteDst);
  }
  if (dstINode != null) {
    return false;
  }
  Path dstParent=absoluteDst.getParent();
  if (dstParent != null) {
    INode dstParentINode=store.retrieveINode(dstParent);
    if (dstParentINode == null || dstParentINode.isFile()) {
      return false;
    }
  }
  return renameRecursive(absoluteSrc,absoluteDst);
}
