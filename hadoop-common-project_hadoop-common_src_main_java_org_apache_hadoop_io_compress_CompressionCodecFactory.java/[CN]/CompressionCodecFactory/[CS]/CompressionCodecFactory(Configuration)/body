{
  codecs=new TreeMap<String,CompressionCodec>();
  codecsByClassName=new HashMap<String,CompressionCodec>();
  codecsByName=new HashMap<String,CompressionCodec>();
  List<Class<? extends CompressionCodec>> codecClasses=getCodecClasses(conf);
  if (codecClasses == null || codecClasses.isEmpty()) {
    addCodec(new GzipCodec());
    addCodec(new DefaultCodec());
  }
 else {
    for (    Class<? extends CompressionCodec> codecClass : codecClasses) {
      addCodec(ReflectionUtils.newInstance(codecClass,conf));
    }
  }
}
