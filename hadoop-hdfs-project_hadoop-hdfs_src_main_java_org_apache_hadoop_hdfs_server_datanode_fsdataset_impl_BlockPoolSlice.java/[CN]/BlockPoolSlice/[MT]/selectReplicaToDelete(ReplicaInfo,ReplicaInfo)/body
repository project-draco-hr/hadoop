{
  ReplicaInfo replicaToKeep;
  ReplicaInfo replicaToDelete;
  if (replica1.getBlockFile().equals(replica2.getBlockFile())) {
    return null;
  }
  if (replica1.getGenerationStamp() != replica2.getGenerationStamp()) {
    replicaToKeep=replica1.getGenerationStamp() > replica2.getGenerationStamp() ? replica1 : replica2;
  }
 else   if (replica1.getNumBytes() != replica2.getNumBytes()) {
    replicaToKeep=replica1.getNumBytes() > replica2.getNumBytes() ? replica1 : replica2;
  }
 else   if (replica1.getVolume().isTransientStorage() && !replica2.getVolume().isTransientStorage()) {
    replicaToKeep=replica2;
  }
 else {
    replicaToKeep=replica1;
  }
  replicaToDelete=(replicaToKeep == replica1) ? replica2 : replica1;
  if (LOG.isDebugEnabled()) {
    LOG.debug("resolveDuplicateReplicas decide to keep " + replicaToKeep + ".  Will try to delete "+ replicaToDelete);
  }
  return replicaToDelete;
}
