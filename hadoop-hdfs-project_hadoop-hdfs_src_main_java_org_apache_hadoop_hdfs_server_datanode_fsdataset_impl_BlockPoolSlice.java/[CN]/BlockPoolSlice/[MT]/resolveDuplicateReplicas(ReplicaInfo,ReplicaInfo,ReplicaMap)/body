{
  if (!deleteDuplicateReplicas) {
    return replica1;
  }
  final ReplicaInfo replicaToDelete=selectReplicaToDelete(replica1,replica2);
  final ReplicaInfo replicaToKeep=(replicaToDelete != replica1) ? replica1 : replica2;
  volumeMap.add(bpid,replicaToKeep);
  if (replicaToDelete != null) {
    deleteReplica(replicaToDelete);
  }
  return replicaToKeep;
}
