{
  byte[] password;
  ContainerTokenIdentifier tokenIdentifier;
  long expiryTimeStamp=System.currentTimeMillis() + containerTokenExpiryInterval;
  this.readLock.lock();
  try {
    tokenIdentifier=new ContainerTokenIdentifier(containerId,containerVersion,nodeId.toString(),appSubmitter,capability,expiryTimeStamp,this.currentMasterKey.getMasterKey().getKeyId(),ResourceManager.getClusterTimeStamp(),priority,createTime,logAggregationContext,nodeLabelExpression,containerType,ExecutionType.GUARANTEED);
    password=this.createPassword(tokenIdentifier);
  }
  finally {
    this.readLock.unlock();
  }
  return BuilderUtils.newContainerToken(nodeId,password,tokenIdentifier);
}
