{
  String pathStr=path.toString();
  HdfsFileStatus status=dfs.getFileInfo(pathStr);
  if (!status.isDir()) {
    dfs.recoverLease(pathStr);
    return;
  }
  byte prev[]=HdfsFileStatus.EMPTY_NAME;
  DirectoryListing dirList;
  do {
    dirList=dfs.listPaths(pathStr,prev);
    HdfsFileStatus files[]=dirList.getPartialListing();
    for (    HdfsFileStatus f : files) {
      recoverAllLeases(dfs,f.getFullPath(path));
    }
    prev=dirList.getLastName();
  }
 while (dirList.hasMore());
}
