{
  if (volumes.remove(target)) {
    if (blockScanner != null) {
      blockScanner.removeVolumeScanner(target);
    }
    try {
      target.closeAndWait();
    }
 catch (    IOException e) {
      FsDatasetImpl.LOG.warn("Error occurs when waiting volume to close: " + target,e);
    }
    target.shutdown();
    FsDatasetImpl.LOG.info("Removed volume: " + target);
  }
 else {
    if (FsDatasetImpl.LOG.isDebugEnabled()) {
      FsDatasetImpl.LOG.debug("Volume " + target + " does not exist or is removed by others.");
    }
  }
}
