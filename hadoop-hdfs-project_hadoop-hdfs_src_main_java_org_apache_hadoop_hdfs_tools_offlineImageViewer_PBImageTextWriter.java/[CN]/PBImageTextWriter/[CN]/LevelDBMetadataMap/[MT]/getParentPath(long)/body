{
  if (inode == INodeId.ROOT_INODE_ID) {
    return "/";
  }
  byte[] bytes=dirChildMap.get(toBytes(inode));
  Preconditions.checkState(bytes != null && bytes.length == 8,"Can not find parent directory for inode %s, " + "fsimage might be corrupted",inode);
  long parent=toLong(bytes);
  if (!dirPathCache.containsKey(parent)) {
    bytes=dirMap.get(toBytes(parent));
    if (parent != INodeId.ROOT_INODE_ID) {
      Preconditions.checkState(bytes != null,"Can not find parent directory for inode %s, " + ", the fsimage might be corrupted.",parent);
    }
    String parentName=toString(bytes);
    String parentPath=new File(getParentPath(parent),parentName).toString();
    dirPathCache.put(parent,parentPath);
  }
  return dirPathCache.get(parent);
}
