{
  long memorySeconds=finishedMemorySeconds.get();
  long vcoreSeconds=finishedVcoreSeconds.get();
  RMAppAttempt currentAttempt=rmContext.getRMApps().get(attemptId.getApplicationId()).getCurrentAppAttempt();
  if (currentAttempt.getAppAttemptId().equals(attemptId)) {
    ApplicationResourceUsageReport appResUsageReport=rmContext.getScheduler().getAppResourceUsageReport(attemptId);
    if (appResUsageReport != null) {
      memorySeconds+=appResUsageReport.getMemorySeconds();
      vcoreSeconds+=appResUsageReport.getVcoreSeconds();
    }
  }
  return new AggregateAppResourceUsage(memorySeconds,vcoreSeconds);
}
