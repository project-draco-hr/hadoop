{
  if (!FSImageUtil.checkFileFormat(file)) {
    throw new IOException("Unrecognized FSImage");
  }
  FileSummary summary=FSImageUtil.loadSummary(file);
  FileInputStream in=null;
  try {
    in=new FileInputStream(file.getFD());
    for (    FileSummary.Section s : summary.getSectionsList()) {
      if (SectionName.fromString(s.getName()) != SectionName.INODE) {
        continue;
      }
      in.getChannel().position(s.getOffset());
      InputStream is=FSImageUtil.wrapInputStreamForCompression(conf,summary.getCodec(),new BufferedInputStream(new LimitInputStream(in,s.getLength())));
      run(is);
      output();
    }
  }
  finally {
    IOUtils.cleanup(null,in);
  }
}
