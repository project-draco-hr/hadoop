{
  configuration=getConfigurationForCluster();
  cluster=new MiniDFSCluster.Builder(configuration).numDataNodes(1).format(true).build();
  System.setProperty("org.apache.hadoop.mapred.TaskTracker","target/tmp");
  configuration.set("org.apache.hadoop.mapred.TaskTracker","target/tmp");
  System.setProperty("hadoop.log.dir","target/tmp");
  configuration.set("hadoop.log.dir","target/tmp");
  mrCluster=new MiniMRCluster(1,cluster.getFileSystem().getUri().toString(),1);
  Configuration mrConf=mrCluster.createJobConf();
  final String mrJobTracker=mrConf.get("mapred.job.tracker");
  configuration.set("mapred.job.tracker",mrJobTracker);
  final String mrJobTrackerAddress=mrConf.get("mapred.job.tracker.http.address");
  configuration.set("mapred.job.tracker.http.address",mrJobTrackerAddress);
}
