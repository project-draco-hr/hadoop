{
  try {
    clearState();
    List<Path> sources=new ArrayList<Path>();
    final FileSystem fs=cluster.getFileSystem();
    sources.add(new Path("/a").makeQualified(fs.getUri(),fs.getWorkingDirectory()));
    sources.add(new Path("/b").makeQualified(fs.getUri(),fs.getWorkingDirectory()));
    touchFile("/a/a.txt");
    touchFile("/b/b.txt");
    Path targetPath=new Path("/c").makeQualified(fs.getUri(),fs.getWorkingDirectory());
    DistCpOptions options=new DistCpOptions(sources,targetPath);
    new DistCp(configuration,options).execute();
    Assert.assertTrue(fs.exists(new Path("/c/a/a.txt")));
    Assert.assertTrue(fs.exists(new Path("/c/b/b.txt")));
  }
 catch (  Exception e) {
    LOG.error("Exception encountered",e);
    Assert.fail("Unexpected exception: " + e.getMessage());
  }
}
