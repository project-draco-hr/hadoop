{
  try {
    if (lazyPersist) {
      EnumSet<CreateFlag> createFlags=EnumSet.of(CREATE,LAZY_PERSIST);
      return create(item.path,FsPermission.getFileDefault().applyUMask(FsPermission.getUMask(getConf())),createFlags,getConf().getInt("io.file.buffer.size",4096),lazyPersist ? 1 : getDefaultReplication(item.path),getDefaultBlockSize(),null,null);
    }
 else {
      return create(item.path,true);
    }
  }
  finally {
    if (!direct) {
      deleteOnExit(item.path);
    }
  }
}
