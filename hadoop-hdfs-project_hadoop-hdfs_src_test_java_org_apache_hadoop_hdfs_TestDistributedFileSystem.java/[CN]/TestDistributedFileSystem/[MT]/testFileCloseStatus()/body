{
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).build();
  DistributedFileSystem fs=cluster.getFileSystem();
  try {
    Path file=new Path("/simpleFlush.dat");
    FSDataOutputStream output=fs.create(file);
    output.writeBytes("Some test data");
    output.flush();
    assertFalse("File status should be open",fs.isFileClosed(file));
    output.close();
    assertTrue("File status should be closed",fs.isFileClosed(file));
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}
