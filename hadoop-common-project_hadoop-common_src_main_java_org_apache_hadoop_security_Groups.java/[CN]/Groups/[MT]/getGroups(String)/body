{
  CachedGroups groups=userToGroupsMap.get(user);
  long now=System.currentTimeMillis();
  if (groups != null && (groups.getTimestamp() + cacheTimeout > now)) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Returning cached groups for '" + user + "'");
    }
    return groups.getGroups();
  }
  groups=new CachedGroups(impl.getGroups(user));
  if (groups.getGroups().isEmpty()) {
    throw new IOException("No groups found for user " + user);
  }
  userToGroupsMap.put(user,groups);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Returning fetched groups for '" + user + "'");
  }
  return groups.getGroups();
}
