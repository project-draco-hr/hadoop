{
  if (curPacketBuf == null || curPacketBuf.capacity() < atLeastCapacity) {
    returnPacketBufToPool();
    if (useDirectBuffers) {
      curPacketBuf=bufferPool.getBuffer(atLeastCapacity);
    }
 else {
      curPacketBuf=ByteBuffer.allocate(atLeastCapacity);
    }
  }
}
