{
  RMNode eventNode=event.getNode();
switch (event.getType()) {
case NODE_UNUSABLE:
    LOG.debug(eventNode + " reported unusable");
  for (  RMApp app : rmContext.getRMApps().values()) {
    if (!app.isAppFinalStateStored()) {
      this.rmContext.getDispatcher().getEventHandler().handle(new RMAppNodeUpdateEvent(app.getApplicationId(),eventNode,RMAppNodeUpdateType.NODE_UNUSABLE));
    }
  }
break;
case NODE_USABLE:
LOG.debug(eventNode + " reported usable");
for (RMApp app : rmContext.getRMApps().values()) {
if (!app.isAppFinalStateStored()) {
this.rmContext.getDispatcher().getEventHandler().handle(new RMAppNodeUpdateEvent(app.getApplicationId(),eventNode,RMAppNodeUpdateType.NODE_USABLE));
}
}
break;
default :
LOG.error("Ignoring invalid eventtype " + event.getType());
}
if (resolver instanceof CachedResolver) {
((CachedResolver)resolver).removeFromCache(eventNode.getNodeID().getHost());
}
}
