{
  ActiveStandbyElectorCallback cb=cbs[0];
  byte[] appData=appDatas[0];
  ActiveStandbyElector elector=electors[0];
  elector.ensureParentZNode();
  elector.joinElection(appData);
  ZooKeeperServer zks=getServer(serverFactory);
  ActiveStandbyElectorTestUtil.waitForActiveLockData(null,zks,PARENT_DIR,appData);
  Mockito.verify(cb,Mockito.timeout(1000)).becomeActive();
  checkFatalsAndReset();
  LOG.info("========================== Expiring session");
  zks.closeSession(elector.getZKSessionIdForTests());
  Mockito.verify(cb,Mockito.timeout(1000)).enterNeutralMode();
  ActiveStandbyElectorTestUtil.waitForActiveLockData(null,zks,PARENT_DIR,appData);
  Mockito.verify(cb,Mockito.timeout(1000)).becomeActive();
  checkFatalsAndReset();
  LOG.info("========================== Quitting election");
  elector.quitElection(false);
  ActiveStandbyElectorTestUtil.waitForActiveLockData(null,zks,PARENT_DIR,null);
  Thread.sleep(1000);
  Mockito.verify(cb,Mockito.never()).becomeActive();
  ActiveStandbyElectorTestUtil.waitForActiveLockData(null,zks,PARENT_DIR,null);
  checkFatalsAndReset();
}
