{
  Map<String,WeakReference<Class<?>>> map;
synchronized (CACHE_CLASSES) {
    map=CACHE_CLASSES.get(classLoader);
    if (map == null) {
      map=Collections.synchronizedMap(new WeakHashMap<String,WeakReference<Class<?>>>());
      CACHE_CLASSES.put(classLoader,map);
    }
  }
  Class<?> clazz=null;
  WeakReference<Class<?>> ref=map.get(name);
  if (ref != null) {
    clazz=ref.get();
  }
  if (clazz == null) {
    try {
      clazz=Class.forName(name,true,classLoader);
    }
 catch (    ClassNotFoundException e) {
      map.put(name,new WeakReference<Class<?>>(NEGATIVE_CACHE_SENTINEL));
      return null;
    }
    map.put(name,new WeakReference<Class<?>>(clazz));
    return clazz;
  }
 else   if (clazz == NEGATIVE_CACHE_SENTINEL) {
    return null;
  }
 else {
    return clazz;
  }
}
