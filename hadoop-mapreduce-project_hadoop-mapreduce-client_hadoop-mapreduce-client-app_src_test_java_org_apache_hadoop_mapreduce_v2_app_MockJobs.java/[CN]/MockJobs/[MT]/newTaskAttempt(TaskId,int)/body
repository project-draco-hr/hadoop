{
  final TaskAttemptId taid=Records.newRecord(TaskAttemptId.class);
  taid.setTaskId(tid);
  taid.setId(i);
  final TaskAttemptReport report=newTaskAttemptReport(taid);
  return new TaskAttempt(){
    @Override public NodeId getNodeId() throws UnsupportedOperationException {
      throw new UnsupportedOperationException();
    }
    @Override public TaskAttemptId getID(){
      return taid;
    }
    @Override public TaskAttemptReport getReport(){
      return report;
    }
    @Override public long getLaunchTime(){
      return report.getStartTime();
    }
    @Override public long getFinishTime(){
      return report.getFinishTime();
    }
    @Override public int getShufflePort(){
      return ShuffleHandler.DEFAULT_SHUFFLE_PORT;
    }
    @Override public Counters getCounters(){
      if (report != null && report.getCounters() != null) {
        return new Counters(TypeConverter.fromYarn(report.getCounters()));
      }
      return null;
    }
    @Override public float getProgress(){
      return report.getProgress();
    }
    @Override public Phase getPhase(){
      return report.getPhase();
    }
    @Override public TaskAttemptState getState(){
      return report.getTaskAttemptState();
    }
    @Override public boolean isFinished(){
switch (report.getTaskAttemptState()) {
case SUCCEEDED:
case FAILED:
case KILLED:
        return true;
    }
    return false;
  }
  @Override public ContainerId getAssignedContainerID(){
    ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(taid.getTaskId().getJobId().getAppId(),0);
    ContainerId id=ContainerId.newContainerId(appAttemptId,0);
    return id;
  }
  @Override public String getNodeHttpAddress(){
    return "localhost:8042";
  }
  @Override public List<String> getDiagnostics(){
    return Lists.newArrayList(report.getDiagnosticInfo());
  }
  @Override public String getAssignedContainerMgrAddress(){
    return "localhost:9998";
  }
  @Override public long getShuffleFinishTime(){
    return report.getShuffleFinishTime();
  }
  @Override public long getSortFinishTime(){
    return report.getSortFinishTime();
  }
  @Override public String getNodeRackName(){
    return "/default-rack";
  }
}
;
}
