{
  Configuration conf=new Configuration();
  conf.setBoolean(SleepJob.SLEEPJOB_MAPTASK_ONLY,true);
  DebugJobProducer jobProducer=new DebugJobProducer(5,conf);
  JobConf jconf=GridmixTestUtils.mrCluster.createJobConf(new JobConf(conf));
  UserGroupInformation ugi=UserGroupInformation.getLoginUser();
  JobStory story;
  int seq=1;
  while ((story=jobProducer.getNextJob()) != null) {
    GridmixJob gridmixJob=JobCreator.SLEEPJOB.createGridmixJob(jconf,0,story,new Path("ignored"),ugi,seq++);
    gridmixJob.buildSplits(null);
    Job job=gridmixJob.call();
    assertEquals(0,job.getNumReduceTasks());
  }
}
