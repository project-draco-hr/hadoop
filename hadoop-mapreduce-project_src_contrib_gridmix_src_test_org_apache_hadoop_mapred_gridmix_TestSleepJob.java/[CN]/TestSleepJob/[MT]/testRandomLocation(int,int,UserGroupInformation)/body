{
  Configuration conf=new Configuration();
  conf.setInt(JobCreator.SLEEPJOB_RANDOM_LOCATIONS,locations);
  DebugJobProducer jobProducer=new DebugJobProducer(njobs,conf);
  JobConf jconf=GridmixTestUtils.mrCluster.createJobConf(new JobConf(conf));
  JobStory story;
  int seq=1;
  while ((story=jobProducer.getNextJob()) != null) {
    GridmixJob gridmixJob=JobCreator.SLEEPJOB.createGridmixJob(jconf,0,story,new Path("ignored"),ugi,seq++);
    gridmixJob.buildSplits(null);
    List<InputSplit> splits=new SleepJob.SleepInputFormat().getSplits(gridmixJob.getJob());
    for (    InputSplit split : splits) {
      assertEquals(locations,split.getLocations().length);
    }
  }
}
