{
  for (Iterator<ApplicationReport> reportIt=eligibleApplications.iterator(); reportIt.hasNext(); ) {
    ApplicationReport report=reportIt.next();
    long totalFileSize=0L;
    try {
      FileStatus[] files=fs.listStatus(LogAggregationUtils.getRemoteAppLogDir(remoteRootLogDir,report.getApplicationId(),report.getUser(),suffix));
      if (files.length < minNumLogFiles) {
        reportIt.remove();
      }
 else {
        for (        FileStatus file : files) {
          if (file.getPath().getName().equals(report.getApplicationId() + ".har")) {
            reportIt.remove();
            break;
          }
          totalFileSize+=file.getLen();
        }
        if (totalFileSize > maxTotalLogsSize) {
          reportIt.remove();
        }
      }
    }
 catch (    IOException ioe) {
      reportIt.remove();
    }
  }
}
