{
  YarnClient client=YarnClient.createYarnClient();
  try {
    client.init(getConf());
    client.start();
    List<ApplicationReport> reports=client.getApplications();
    for (    ApplicationReport report : reports) {
      LogAggregationStatus aggStatus=report.getLogAggregationStatus();
      if (aggStatus.equals(LogAggregationStatus.SUCCEEDED) || aggStatus.equals(LogAggregationStatus.FAILED)) {
        eligibleApplications.add(report);
      }
    }
  }
  finally {
    if (client != null) {
      client.stop();
    }
  }
}
