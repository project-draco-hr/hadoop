{
  this.conf=conf;
  volumes=new HashMap<String,DF>();
  duReserved=conf.getLong(DFSConfigKeys.DFS_NAMENODE_DU_RESERVED_KEY,DFSConfigKeys.DFS_NAMENODE_DU_RESERVED_DEFAULT);
  Collection<URI> extraCheckedVolumes=Util.stringCollectionAsURIs(conf.getTrimmedStringCollection(DFSConfigKeys.DFS_NAMENODE_CHECKED_VOLUMES_KEY));
  addDirsToCheck(FSNamesystem.getNamespaceDirs(conf));
  Collection<URI> localEditDirs=Collections2.filter(FSNamesystem.getNamespaceEditsDirs(conf),new Predicate<URI>(){
    public boolean apply(    URI input){
      if (input.getScheme().equals(NNStorage.LOCAL_URI_SCHEME)) {
        return true;
      }
      return false;
    }
  }
);
  addDirsToCheck(localEditDirs);
  addDirsToCheck(extraCheckedVolumes);
}
