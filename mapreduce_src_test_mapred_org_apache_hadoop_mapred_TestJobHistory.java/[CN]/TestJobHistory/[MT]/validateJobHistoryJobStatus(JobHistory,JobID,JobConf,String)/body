{
  Path doneDir=jobHistory.getCompletedJobHistoryLocation();
  String logFileName=getDoneFile(jobHistory,conf,id,doneDir);
  Path logFile=new Path(doneDir,logFileName);
  FileSystem fileSys=logFile.getFileSystem(conf);
  assertTrue("History file does not exist",fileSys.exists(logFile));
  assertTrue("History file permissions does not match",fileSys.getFileStatus(logFile).getPermission().equals(new FsPermission(JobHistory.HISTORY_FILE_PERMISSION)));
  JobHistoryParser parser=new JobHistoryParser(fileSys,logFile.toUri().getPath());
  JobHistoryParser.JobInfo jobInfo=parser.parse();
  assertTrue("Job Status read from job history file is not the expected" + " status",status.equals(jobInfo.getJobStatus()));
}
