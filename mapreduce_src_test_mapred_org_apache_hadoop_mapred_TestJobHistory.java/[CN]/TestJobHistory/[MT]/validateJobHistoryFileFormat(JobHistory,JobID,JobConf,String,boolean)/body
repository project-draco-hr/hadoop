{
  Path dir=jobHistory.getCompletedJobHistoryLocation();
  String logFileName=getDoneFile(jobHistory,conf,id,dir);
  Path logFile=new Path(dir,logFileName);
  FileSystem fileSys=logFile.getFileSystem(conf);
  assertTrue("History file does not exist",fileSys.exists(logFile));
  JobHistoryParser parser=new JobHistoryParser(fileSys,logFile.toUri().getPath());
  JobHistoryParser.JobInfo jobInfo=parser.parse();
  validateJobLevelKeyValuesFormat(jobInfo,status);
  validateTaskLevelKeyValuesFormat(jobInfo,splitsCanBeEmpty);
  validateTaskAttemptLevelKeyValuesFormat(jobInfo);
  if (status.equals("SUCCEEDED")) {
    for (Iterator<String> it=taskIDsToAttemptIDs.keySet().iterator(); it.hasNext(); ) {
      String taskid=it.next();
      assertTrue("There are some Tasks which are not finished in history " + "file.",taskEnds.contains(taskid));
      List<String> attemptIDs=taskIDsToAttemptIDs.get(taskid);
      if (attemptIDs != null) {
        assertTrue("Unexpected. TaskID " + taskid + " has task attempt(s)"+ " that are not finished.",(attemptIDs.size() == 1));
      }
    }
  }
}
