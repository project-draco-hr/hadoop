{
  final String lz4Codec="org.apache.hadoop.io.compress.Lz4Codec";
  nativeConf.set(MRJobConfig.MAP_OUTPUT_COMPRESS_CODEC,lz4Codec);
  final String nativeOutputPath=TestConstants.NATIVETASK_COMPRESS_TEST_NATIVE_OUTPUTDIR + "/lz4";
  final Job nativeJob=CompressMapper.getCompressJob("nativelz4",nativeConf,TestConstants.NATIVETASK_COMPRESS_TEST_INPUTDIR,nativeOutputPath);
  assertTrue(nativeJob.waitForCompletion(true));
  hadoopConf.set(MRJobConfig.MAP_OUTPUT_COMPRESS_CODEC,lz4Codec);
  final String hadoopOutputPath=TestConstants.NATIVETASK_COMPRESS_TEST_NORMAL_OUTPUTDIR + "/lz4";
  final Job hadoopJob=CompressMapper.getCompressJob("hadooplz4",hadoopConf,TestConstants.NATIVETASK_COMPRESS_TEST_INPUTDIR,hadoopOutputPath);
  assertTrue(hadoopJob.waitForCompletion(true));
  final boolean compareRet=ResultVerifier.verify(nativeOutputPath,hadoopOutputPath);
  assertEquals("file compare result: if they are the same ,then return true",true,compareRet);
  ResultVerifier.verifyCounters(hadoopJob,nativeJob);
}
