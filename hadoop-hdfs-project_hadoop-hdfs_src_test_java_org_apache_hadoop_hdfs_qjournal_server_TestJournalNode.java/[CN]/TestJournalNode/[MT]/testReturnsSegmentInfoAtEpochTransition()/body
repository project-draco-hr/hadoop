{
  ch.newEpoch(1).get();
  ch.setEpoch(1);
  ch.startLogSegment(1,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION).get();
  ch.sendEdits(1L,1,2,QJMTestUtil.createTxnData(1,2)).get();
  NewEpochResponseProto response=ch.newEpoch(2).get();
  ch.setEpoch(2);
  assertEquals(1,response.getLastSegmentTxId());
  ch.finalizeLogSegment(1,2).get();
  response=ch.newEpoch(3).get();
  ch.setEpoch(3);
  assertEquals(1,response.getLastSegmentTxId());
  ch.startLogSegment(3,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION).get();
  response=ch.newEpoch(4).get();
  ch.setEpoch(4);
  assertEquals(1,response.getLastSegmentTxId());
}
