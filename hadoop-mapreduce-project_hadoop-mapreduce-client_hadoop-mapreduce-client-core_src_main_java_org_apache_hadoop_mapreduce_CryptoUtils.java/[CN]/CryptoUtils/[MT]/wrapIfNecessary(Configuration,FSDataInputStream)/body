{
  if (isShuffleEncrypted(conf)) {
    CryptoCodec cryptoCodec=CryptoCodec.getInstance(conf);
    int bufferSize=getBufferSize(conf);
    IOUtils.readFully(in,new byte[8],0,8);
    byte[] iv=new byte[cryptoCodec.getCipherSuite().getAlgorithmBlockSize()];
    IOUtils.readFully(in,iv,0,cryptoCodec.getCipherSuite().getAlgorithmBlockSize());
    if (LOG.isDebugEnabled()) {
      LOG.debug("IV read from Stream [" + Base64.encodeBase64URLSafeString(iv) + "]");
    }
    return new CryptoFSDataInputStream(in,cryptoCodec,bufferSize,getEncryptionKey(),iv);
  }
 else {
    return in;
  }
}
