{
  SimulatorEventListener listener=event.getListener();
  long now=event.getTimeStamp();
  if (event instanceof TestComplexEvent2) {
    int level=((TestComplexEvent2)event).getLevel();
    if (level == 0)     return SimulatorEventQueue.EMPTY_EVENTS;
    List<SimulatorEvent> response=new ArrayList<SimulatorEvent>();
    for (int i=0; i < 2; i++)     response.add(new TestComplexEvent2(listener,now + random.nextInt(TIME_WARP),level - 1));
    response.add(new TestSimpleEvent(listener,now + random.nextInt(TIME_WARP)));
    return response;
  }
 else   if (event instanceof TestComplexEvent1) {
    TestComplexEvent1 e=(TestComplexEvent1)event;
    if (e.getLevel() == 0)     return SimulatorEventQueue.EMPTY_EVENTS;
    List<SimulatorEvent> response=new ArrayList<SimulatorEvent>();
    response.add(new TestComplexEvent1(listener,now + random.nextInt(TIME_WARP),e.getLevel() - 1));
    for (int i=0; i < 4; i++)     response.add(new TestSimpleEvent(listener,now + random.nextInt(TIME_WARP)));
    return response;
  }
 else   if (event instanceof TestSimpleEvent) {
    return SimulatorEventQueue.EMPTY_EVENTS;
  }
 else {
    throw new IllegalArgumentException("unknown event type: " + event.getClass());
  }
}
