{
  DatabaseMetaData dbmd=connection.getMetaData();
  String schema=null;
  String table=null;
  String[] schemaTable=writerTable.split("\\.");
  if (schemaTable.length == 2) {
    schema=schemaTable[0];
    table=schemaTable[1];
  }
 else   if (schemaTable.length == 1) {
    table=schemaTable[0];
  }
 else {
    throw new RuntimeException("Vertica Formatter requires a value output table");
  }
  List<Integer> types=new ArrayList<Integer>();
  List<String> names=new ArrayList<String>();
  ResultSet rs=dbmd.getColumns(null,schema,table,null);
  while (rs.next()) {
    names.add(rs.getString(4));
    types.add(rs.getInt(5));
  }
  VerticaRecord record=new VerticaRecord(names,types);
  return record;
}
