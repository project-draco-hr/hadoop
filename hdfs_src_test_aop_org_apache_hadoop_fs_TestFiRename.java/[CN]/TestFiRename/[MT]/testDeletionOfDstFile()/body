{
  Path src=getTestPath("testDeletionOfDstFile/dir/src");
  Path dst=getTestPath("testDeletionOfDstFile/newdir/dst");
  createFile(src);
  createFile(dst);
  final FSNamesystem namesystem=cluster.getNamesystem();
  final long blocks=namesystem.getBlocksTotal();
  final long fileCount=namesystem.getFilesTotal();
  rename(src,dst,false,false,true,Rename.OVERWRITE);
  Assert.assertEquals(blocks - 1,namesystem.getBlocksTotal());
  Assert.assertEquals(fileCount - 1,namesystem.getFilesTotal());
  restartCluster(false);
  int count=0;
  boolean exception=true;
  src=getTestPath("testDeletionOfDstFile/dir/src");
  dst=getTestPath("testDeletionOfDstFile/newdir/dst");
  while (exception && count < 5) {
    try {
      exists(fc,src);
      exception=false;
    }
 catch (    Exception e) {
      LOG.warn("Exception " + " count " + count + " "+ e.getMessage());
      Thread.sleep(1000);
      count++;
    }
  }
  Assert.assertFalse(exists(fc,src));
  Assert.assertTrue(exists(fc,dst));
}
