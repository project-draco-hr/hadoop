{
  DatanodeInfo[] dnInfos0=new DatanodeInfo[]{DFSTestUtil.getLocalDatanodeInfo(),DFSTestUtil.getLocalDatanodeInfo()};
  DatanodeStorageInfo targetDnInfos_0=BlockManagerTestUtil.newDatanodeStorageInfo(DFSTestUtil.getLocalDatanodeDescriptor(),new DatanodeStorage("s00"));
  DatanodeStorageInfo targetDnInfos_1=BlockManagerTestUtil.newDatanodeStorageInfo(DFSTestUtil.getLocalDatanodeDescriptor(),new DatanodeStorage("s01"));
  DatanodeStorageInfo[] targetDnInfos0=new DatanodeStorageInfo[]{targetDnInfos_0,targetDnInfos_1};
  short[] liveBlkIndices0=new short[2];
  BlockECRecoveryInfo blkECRecoveryInfo0=new BlockECRecoveryInfo(new ExtendedBlock("bp1",1234),dnInfos0,targetDnInfos0,liveBlkIndices0,ErasureCodingPolicyManager.getSystemDefaultPolicy());
  DatanodeInfo[] dnInfos1=new DatanodeInfo[]{DFSTestUtil.getLocalDatanodeInfo(),DFSTestUtil.getLocalDatanodeInfo()};
  DatanodeStorageInfo targetDnInfos_2=BlockManagerTestUtil.newDatanodeStorageInfo(DFSTestUtil.getLocalDatanodeDescriptor(),new DatanodeStorage("s02"));
  DatanodeStorageInfo targetDnInfos_3=BlockManagerTestUtil.newDatanodeStorageInfo(DFSTestUtil.getLocalDatanodeDescriptor(),new DatanodeStorage("s03"));
  DatanodeStorageInfo[] targetDnInfos1=new DatanodeStorageInfo[]{targetDnInfos_2,targetDnInfos_3};
  short[] liveBlkIndices1=new short[2];
  BlockECRecoveryInfo blkECRecoveryInfo1=new BlockECRecoveryInfo(new ExtendedBlock("bp2",3256),dnInfos1,targetDnInfos1,liveBlkIndices1,ErasureCodingPolicyManager.getSystemDefaultPolicy());
  List<BlockECRecoveryInfo> blkRecoveryInfosList=new ArrayList<BlockECRecoveryInfo>();
  blkRecoveryInfosList.add(blkECRecoveryInfo0);
  blkRecoveryInfosList.add(blkECRecoveryInfo1);
  BlockECRecoveryCommand blkECRecoveryCmd=new BlockECRecoveryCommand(DatanodeProtocol.DNA_ERASURE_CODING_RECOVERY,blkRecoveryInfosList);
  BlockECRecoveryCommandProto blkECRecoveryCmdProto=PBHelper.convert(blkECRecoveryCmd);
  blkECRecoveryCmd=PBHelper.convert(blkECRecoveryCmdProto);
  Iterator<BlockECRecoveryInfo> iterator=blkECRecoveryCmd.getECTasks().iterator();
  assertBlockECRecoveryInfoEquals(blkECRecoveryInfo0,iterator.next());
  assertBlockECRecoveryInfoEquals(blkECRecoveryInfo1,iterator.next());
}
