{
  job=Job.getInstance(conf,jobname);
  job.setJarByClass(KVJob.class);
  job.setMapperClass(KVJob.ValueMapper.class);
  job.setOutputKeyClass(keyclass);
  job.setMapOutputValueClass(valueclass);
  if (conf.get(TestConstants.NATIVETASK_KVTEST_CREATEFILE).equals("true")) {
    final FileSystem fs=FileSystem.get(conf);
    fs.delete(new Path(inputpath),true);
    fs.close();
    final TestInputFile testfile=new TestInputFile(Integer.valueOf(conf.get(TestConstants.FILESIZE_KEY,"1000")),keyclass.getName(),valueclass.getName(),conf);
    StopWatch sw=new StopWatch().start();
    testfile.createSequenceTestFile(inputpath);
    LOG.info("Created test file " + inputpath + " in "+ sw.now(TimeUnit.MILLISECONDS)+ "ms");
  }
  job.setInputFormatClass(SequenceFileInputFormat.class);
  FileInputFormat.addInputPath(job,new Path(inputpath));
  FileOutputFormat.setOutputPath(job,new Path(outputpath));
}
