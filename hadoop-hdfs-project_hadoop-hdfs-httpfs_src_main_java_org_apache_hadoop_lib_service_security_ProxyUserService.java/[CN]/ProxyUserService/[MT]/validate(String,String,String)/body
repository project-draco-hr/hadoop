{
  Check.notEmpty(proxyUser,"proxyUser");
  Check.notEmpty(proxyHost,"proxyHost");
  Check.notEmpty(doAsUser,"doAsUser");
  LOG.debug("Authorization check proxyuser [{}] host [{}] doAs [{}]",new Object[]{proxyUser,proxyHost,doAsUser});
  if (proxyUserHosts.containsKey(proxyUser)) {
    proxyHost=normalizeHostname(proxyHost);
    validateRequestorHost(proxyUser,proxyHost,proxyUserHosts.get(proxyUser));
    validateGroup(proxyUser,doAsUser,proxyUserGroups.get(proxyUser));
  }
 else {
    throw new AccessControlException(MessageFormat.format("User [{0}] not defined as proxyuser",proxyUser));
  }
}
