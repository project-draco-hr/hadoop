{
  if (validGroups != null) {
    List<String> userGroups=getServer().get(Groups.class).getGroups(user);
    for (    String g : validGroups) {
      if (userGroups.contains(g)) {
        return;
      }
    }
    throw new AccessControlException(MessageFormat.format("Unauthorized proxyuser [{0}] for user [{1}], not in proxyuser groups",proxyUser,user));
  }
}
