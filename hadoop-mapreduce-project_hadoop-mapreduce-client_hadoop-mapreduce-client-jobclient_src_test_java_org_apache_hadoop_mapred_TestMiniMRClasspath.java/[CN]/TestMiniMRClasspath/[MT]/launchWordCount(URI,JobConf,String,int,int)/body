{
  final Path inDir=new Path("/testing/wc/input");
  final Path outDir=new Path("/testing/wc/output");
  FileSystem fs=FileSystem.get(fileSys,conf);
  configureWordCount(fs,conf,input,numMaps,numReduces,inDir,outDir);
  JobClient.runJob(conf);
  StringBuffer result=new StringBuffer();
{
    Path[] parents=FileUtil.stat2Paths(fs.listStatus(outDir.getParent()));
    Path[] fileList=FileUtil.stat2Paths(fs.listStatus(outDir,new Utils.OutputFileUtils.OutputFilesFilter()));
    for (int i=0; i < fileList.length; ++i) {
      BufferedReader file=new BufferedReader(new InputStreamReader(fs.open(fileList[i])));
      String line=file.readLine();
      while (line != null) {
        result.append(line);
        result.append("\n");
        line=file.readLine();
      }
      file.close();
    }
  }
  return result.toString();
}
