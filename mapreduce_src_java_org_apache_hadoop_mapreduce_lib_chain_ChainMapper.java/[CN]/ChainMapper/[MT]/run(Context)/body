{
  setup(context);
  int numMappers=chain.getAllMappers().size();
  if (numMappers == 0) {
    return;
  }
  ChainBlockingQueue<Chain.KeyValuePair<?,?>> inputqueue;
  ChainBlockingQueue<Chain.KeyValuePair<?,?>> outputqueue;
  if (numMappers == 1) {
    chain.runMapper(context,0);
  }
 else {
    outputqueue=chain.createBlockingQueue();
    chain.addMapper(context,outputqueue,0);
    for (int i=1; i < numMappers - 1; i++) {
      inputqueue=outputqueue;
      outputqueue=chain.createBlockingQueue();
      chain.addMapper(inputqueue,outputqueue,context,i);
    }
    chain.addMapper(outputqueue,context,numMappers - 1);
  }
  chain.startAllThreads();
  chain.joinAllThreads();
}
