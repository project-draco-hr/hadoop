{
  if (conf == null) {
    conf=new Configuration();
  }
  String recordFactoryClassName=conf.get(YarnConfiguration.IPC_EXCEPTION_FACTORY);
  if (recordFactoryClassName == null) {
    String serializer=conf.get(YarnConfiguration.IPC_SERIALIZER_TYPE,YarnConfiguration.DEFAULT_IPC_SERIALIZER_TYPE);
    if (serializer.equals(YarnConfiguration.DEFAULT_IPC_SERIALIZER_TYPE)) {
      return YarnRemoteExceptionFactoryPBImpl.get();
    }
 else {
      throw new YarnException("Unknown serializer: [" + conf.get(YarnConfiguration.IPC_SERIALIZER_TYPE) + "]. Use keys: ["+ YarnConfiguration.IPC_EXCEPTION_FACTORY+ "] to specify Exception factory");
    }
  }
 else {
    return (YarnRemoteExceptionFactory)getFactoryClassInstance(recordFactoryClassName);
  }
}
