{
  TimelineFilterList list1=new TimelineFilterList();
  list1.addFilter(new TimelineKeyValueFilter(TimelineCompareOp.EQUAL,"cfg_param1","value1"));
  list1.addFilter(new TimelineKeyValueFilter(TimelineCompareOp.EQUAL,"cfg_param2","value2"));
  TimelineFilterList list2=new TimelineFilterList();
  list2.addFilter(new TimelineKeyValueFilter(TimelineCompareOp.EQUAL,"cfg_param1","value3"));
  list2.addFilter(new TimelineKeyValueFilter(TimelineCompareOp.EQUAL,"config_param2","value2"));
  TimelineFilterList confFilterList=new TimelineFilterList(Operator.OR,list1,list2);
  Set<TimelineEntity> entities=reader.getEntities(new TimelineReaderContext("cluster1","user1","some_flow_name",1002345678919L,null,TimelineEntityType.YARN_APPLICATION.toString(),null),new TimelineEntityFilters(null,null,null,null,null,null,confFilterList,null,null),new TimelineDataToRetrieve(null,null,EnumSet.of(Field.CONFIGS),null));
  assertEquals(2,entities.size());
  int cfgCnt=0;
  for (  TimelineEntity entity : entities) {
    cfgCnt+=entity.getConfigs().size();
  }
  assertEquals(5,cfgCnt);
  entities=reader.getEntities(new TimelineReaderContext("cluster1","user1","some_flow_name",1002345678919L,null,TimelineEntityType.YARN_APPLICATION.toString(),null),new TimelineEntityFilters(null,null,null,null,null,null,confFilterList,null,null),new TimelineDataToRetrieve(null,null,EnumSet.of(Field.ALL),null));
  assertEquals(2,entities.size());
  cfgCnt=0;
  for (  TimelineEntity entity : entities) {
    cfgCnt+=entity.getConfigs().size();
  }
  assertEquals(5,cfgCnt);
  TimelineFilterList confFilterList1=new TimelineFilterList(new TimelineKeyValueFilter(TimelineCompareOp.NOT_EQUAL,"cfg_param1","value1"));
  entities=reader.getEntities(new TimelineReaderContext("cluster1","user1","some_flow_name",1002345678919L,null,TimelineEntityType.YARN_APPLICATION.toString(),null),new TimelineEntityFilters(null,null,null,null,null,null,confFilterList1,null,null),new TimelineDataToRetrieve(null,null,EnumSet.of(Field.CONFIGS),null));
  assertEquals(1,entities.size());
  cfgCnt=0;
  for (  TimelineEntity entity : entities) {
    cfgCnt+=entity.getConfigs().size();
  }
  assertEquals(3,cfgCnt);
  TimelineFilterList confFilterList2=new TimelineFilterList(new TimelineKeyValueFilter(TimelineCompareOp.NOT_EQUAL,"cfg_param1","value1"),new TimelineKeyValueFilter(TimelineCompareOp.NOT_EQUAL,"config_param2","value2"));
  entities=reader.getEntities(new TimelineReaderContext("cluster1","user1","some_flow_name",1002345678919L,null,TimelineEntityType.YARN_APPLICATION.toString(),null),new TimelineEntityFilters(null,null,null,null,null,null,confFilterList2,null,null),new TimelineDataToRetrieve(null,null,EnumSet.of(Field.CONFIGS),null));
  assertEquals(0,entities.size());
  TimelineFilterList confFilterList3=new TimelineFilterList(new TimelineKeyValueFilter(TimelineCompareOp.EQUAL,"dummy_config","value1"));
  entities=reader.getEntities(new TimelineReaderContext("cluster1","user1","some_flow_name",1002345678919L,null,TimelineEntityType.YARN_APPLICATION.toString(),null),new TimelineEntityFilters(null,null,null,null,null,null,confFilterList3,null,null),new TimelineDataToRetrieve(null,null,EnumSet.of(Field.CONFIGS),null));
  assertEquals(0,entities.size());
  TimelineFilterList confFilterList4=new TimelineFilterList(new TimelineKeyValueFilter(TimelineCompareOp.NOT_EQUAL,"dummy_config","value1"));
  entities=reader.getEntities(new TimelineReaderContext("cluster1","user1","some_flow_name",1002345678919L,null,TimelineEntityType.YARN_APPLICATION.toString(),null),new TimelineEntityFilters(null,null,null,null,null,null,confFilterList4,null,null),new TimelineDataToRetrieve(null,null,EnumSet.of(Field.CONFIGS),null));
  assertEquals(0,entities.size());
  TimelineFilterList confFilterList5=new TimelineFilterList(new TimelineKeyValueFilter(TimelineCompareOp.NOT_EQUAL,"dummy_config","value1",false));
  entities=reader.getEntities(new TimelineReaderContext("cluster1","user1","some_flow_name",1002345678919L,null,TimelineEntityType.YARN_APPLICATION.toString(),null),new TimelineEntityFilters(null,null,null,null,null,null,confFilterList5,null,null),new TimelineDataToRetrieve(null,null,EnumSet.of(Field.CONFIGS),null));
  assertEquals(3,entities.size());
}
