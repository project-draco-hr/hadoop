{
  if (LOG.isTraceEnabled()) {
    LOG.trace("HTTP " + op.getValue().getType() + ": "+ op+ ", "+ path+ ", ugi="+ ugi+ Param.toSortedString(", ",parameters));
  }
  response.setContentType(null);
  if (UserGroupInformation.isSecurityEnabled()) {
    final Token<DelegationTokenIdentifier> token=new Token<DelegationTokenIdentifier>();
    token.decodeFromUrlString(delegation.getValue());
    SecurityUtil.setTokenService(token,nnRpcAddr);
    token.setKind(DelegationTokenIdentifier.HDFS_DELEGATION_KIND);
    ugi.addToken(token);
  }
}
