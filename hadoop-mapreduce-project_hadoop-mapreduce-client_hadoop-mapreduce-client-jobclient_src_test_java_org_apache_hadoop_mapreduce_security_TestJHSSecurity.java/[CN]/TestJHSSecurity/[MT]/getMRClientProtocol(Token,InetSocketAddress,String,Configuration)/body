{
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser(user);
  ugi.addToken(ProtoUtils.convertFromProtoFormat(token,hsAddress));
  final YarnRPC rpc=YarnRPC.create(conf);
  MRClientProtocol hsWithDT=ugi.doAs(new PrivilegedAction<MRClientProtocol>(){
    @Override public MRClientProtocol run(){
      return (MRClientProtocol)rpc.getProxy(HSClientProtocol.class,hsAddress,conf);
    }
  }
);
  return hsWithDT;
}
