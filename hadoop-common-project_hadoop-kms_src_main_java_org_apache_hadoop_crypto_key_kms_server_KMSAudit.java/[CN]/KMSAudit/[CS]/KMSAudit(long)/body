{
  cache=CacheBuilder.newBuilder().expireAfterWrite(delay,TimeUnit.MILLISECONDS).removalListener(new RemovalListener<String,AuditEvent>(){
    @Override public void onRemoval(    RemovalNotification<String,AuditEvent> entry){
      AuditEvent event=entry.getValue();
      if (event.getAccessCount().get() > 0) {
        KMSAudit.this.logEvent(event);
        event.getAccessCount().set(0);
        KMSAudit.this.cache.put(entry.getKey(),event);
      }
    }
  }
).build();
  executor=Executors.newScheduledThreadPool(1,new ThreadFactoryBuilder().setDaemon(true).setNameFormat(KMS_LOGGER_NAME + "_thread").build());
  executor.scheduleAtFixedRate(new Runnable(){
    @Override public void run(){
      cache.cleanUp();
    }
  }
,delay / 10,delay / 10,TimeUnit.MILLISECONDS);
}
