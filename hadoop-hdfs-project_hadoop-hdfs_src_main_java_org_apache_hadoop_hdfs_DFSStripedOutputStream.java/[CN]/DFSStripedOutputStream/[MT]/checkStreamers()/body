{
  int count=0;
  for (  StripedDataStreamer s : streamers) {
    if (!s.isFailed()) {
      if (s.getBlock() != null) {
        s.getErrorState().initExternalError();
      }
      count++;
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("checkStreamers: " + streamers);
    LOG.debug("count=" + count);
  }
  if (count < numDataBlocks) {
    throw new IOException("Failed: the number of remaining blocks = " + count + " < the number of data blocks = "+ numDataBlocks);
  }
}
