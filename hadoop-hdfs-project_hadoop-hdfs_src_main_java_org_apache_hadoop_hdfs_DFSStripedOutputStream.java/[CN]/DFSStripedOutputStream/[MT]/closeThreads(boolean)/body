{
  int index=0;
  boolean exceptionOccurred=false;
  for (  StripedDataStreamer streamer : streamers) {
    try {
      streamer.close(force);
      streamer.join();
      streamer.closeSocket();
    }
 catch (    InterruptedException|IOException e) {
      DFSClient.LOG.error("Failed to shutdown streamer: name=" + streamer.getName() + ", index="+ index+ ", file="+ src,e);
      exceptionOccurred=true;
    }
 finally {
      streamer.setSocketToNull();
      setClosed();
      index++;
    }
  }
  if (exceptionOccurred) {
    throw new IOException("Failed to shutdown streamer");
  }
}
