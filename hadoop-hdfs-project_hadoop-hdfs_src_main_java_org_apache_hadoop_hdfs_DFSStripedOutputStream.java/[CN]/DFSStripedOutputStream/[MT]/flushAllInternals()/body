{
  int current=getCurrentIndex();
  for (int i=0; i < numAllBlocks; i++) {
    final StripedDataStreamer s=setCurrentStreamer(i);
    if (s.isHealthy()) {
      try {
        flushInternal();
      }
 catch (      Exception e) {
        handleStreamerFailure("flushInternal " + s,e);
      }
    }
  }
  setCurrentStreamer(current);
}
