{
  final DatanodeInfo[] newNodes=new DatanodeInfo[numAllBlocks];
  final String[] newStorageIDs=new String[numAllBlocks];
  for (int i=0; i < numAllBlocks; i++) {
    final StripedDataStreamer streamer=getStripedDataStreamer(i);
    final DatanodeInfo[] nodes=streamer.getNodes();
    final String[] storageIDs=streamer.getStorageIDs();
    if (streamer.isHealthy() && nodes != null && storageIDs != null) {
      newNodes[i]=nodes[0];
      newStorageIDs[i]=storageIDs[0];
    }
 else {
      newNodes[i]=new DatanodeInfo(DatanodeID.EMPTY_DATANODE_ID);
      newStorageIDs[i]="";
    }
  }
  dfsClient.namenode.updatePipeline(dfsClient.clientName,currentBlockGroup,newBG,newNodes,newStorageIDs);
  currentBlockGroup=newBG;
}
