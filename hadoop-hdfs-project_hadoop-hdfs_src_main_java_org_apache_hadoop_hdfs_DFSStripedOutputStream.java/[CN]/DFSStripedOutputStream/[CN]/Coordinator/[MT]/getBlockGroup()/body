{
  final StripedDataStreamer s0=getStripedDataStreamer(0);
  final ExtendedBlock b0=s0.getBlock();
  if (b0 == null) {
    return null;
  }
  final boolean atBlockGroupBoundary=s0.getBytesCurBlock() == 0 && b0.getNumBytes() > 0;
  final ExtendedBlock block=new ExtendedBlock(b0);
  long numBytes=atBlockGroupBoundary ? b0.getNumBytes() : s0.getBytesCurBlock();
  for (int i=1; i < numAllBlocks; i++) {
    final StripedDataStreamer si=getStripedDataStreamer(i);
    final ExtendedBlock bi=si.getBlock();
    if (bi != null && bi.getGenerationStamp() > block.getGenerationStamp()) {
      block.setGenerationStamp(bi.getGenerationStamp());
    }
    if (i < numDataBlocks) {
      numBytes+=atBlockGroupBoundary ? bi.getNumBytes() : si.getBytesCurBlock();
    }
  }
  block.setNumBytes(numBytes);
  if (LOG.isDebugEnabled()) {
    LOG.debug("getBlockGroup: " + block + ", numBytes="+ block.getNumBytes());
  }
  return block;
}
