{
  boolean failed=false;
  for (  final String dir : localDirs) {
    try {
      createDir(localFs,new Path(dir),perm);
    }
 catch (    IOException e) {
      LOG.warn("Unable to create directory " + dir + " error "+ e.getMessage()+ ", removing from the list of valid directories.");
      localDirs.remove(dir);
      errorDirs.add(dir);
      numFailures++;
      failed=true;
    }
  }
  return !failed;
}
