{
  long lastCkptTime=MetricsAsserts.getLongGauge("LastCheckpointTime",getMetrics(NS_METRICS));
  assertGauge("LastCheckpointTime",lastCkptTime,getMetrics(NS_METRICS));
  assertGauge("LastWrittenTransactionId",1L,getMetrics(NS_METRICS));
  assertGauge("TransactionsSinceLastCheckpoint",1L,getMetrics(NS_METRICS));
  assertGauge("TransactionsSinceLastLogRoll",1L,getMetrics(NS_METRICS));
  fs.mkdirs(new Path(TEST_ROOT_DIR_PATH,"/tmp"));
  updateMetrics();
  assertGauge("LastCheckpointTime",lastCkptTime,getMetrics(NS_METRICS));
  assertGauge("LastWrittenTransactionId",2L,getMetrics(NS_METRICS));
  assertGauge("TransactionsSinceLastCheckpoint",2L,getMetrics(NS_METRICS));
  assertGauge("TransactionsSinceLastLogRoll",2L,getMetrics(NS_METRICS));
  cluster.getNameNodeRpc().rollEditLog();
  updateMetrics();
  assertGauge("LastCheckpointTime",lastCkptTime,getMetrics(NS_METRICS));
  assertGauge("LastWrittenTransactionId",4L,getMetrics(NS_METRICS));
  assertGauge("TransactionsSinceLastCheckpoint",4L,getMetrics(NS_METRICS));
  assertGauge("TransactionsSinceLastLogRoll",1L,getMetrics(NS_METRICS));
  cluster.getNameNodeRpc().setSafeMode(SafeModeAction.SAFEMODE_ENTER);
  cluster.getNameNodeRpc().saveNamespace();
  cluster.getNameNodeRpc().setSafeMode(SafeModeAction.SAFEMODE_LEAVE);
  updateMetrics();
  long newLastCkptTime=MetricsAsserts.getLongGauge("LastCheckpointTime",getMetrics(NS_METRICS));
  assertTrue(lastCkptTime < newLastCkptTime);
  assertGauge("LastWrittenTransactionId",6L,getMetrics(NS_METRICS));
  assertGauge("TransactionsSinceLastCheckpoint",1L,getMetrics(NS_METRICS));
  assertGauge("TransactionsSinceLastLogRoll",1L,getMetrics(NS_METRICS));
}
