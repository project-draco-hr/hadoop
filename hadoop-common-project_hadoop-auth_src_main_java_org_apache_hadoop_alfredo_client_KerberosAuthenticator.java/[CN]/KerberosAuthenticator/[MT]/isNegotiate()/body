{
  boolean negotiate=false;
  if (conn.getResponseCode() == HttpURLConnection.HTTP_UNAUTHORIZED) {
    String authHeader=conn.getHeaderField(WWW_AUTHENTICATE);
    negotiate=authHeader != null && authHeader.trim().startsWith(NEGOTIATE);
  }
  return negotiate;
}
