{
  this.writeLock.lock();
  try {
    LOG.info("Create AMRMToken for ApplicationAttempt: " + appAttemptId);
    AMRMTokenIdentifier identifier=new AMRMTokenIdentifier(appAttemptId,getMasterKey().getMasterKey().getKeyId());
    byte[] password=this.createPassword(identifier);
    appAttemptSet.add(appAttemptId);
    return new Token<AMRMTokenIdentifier>(identifier.getBytes(),password,identifier.getKind(),new Text());
  }
  finally {
    this.writeLock.unlock();
  }
}
