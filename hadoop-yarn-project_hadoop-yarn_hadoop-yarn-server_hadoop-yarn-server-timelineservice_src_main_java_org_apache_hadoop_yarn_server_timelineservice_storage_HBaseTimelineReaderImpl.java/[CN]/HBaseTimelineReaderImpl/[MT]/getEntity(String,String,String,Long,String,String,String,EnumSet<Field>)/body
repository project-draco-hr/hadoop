{
  validateParams(userId,clusterId,appId,entityType,entityId,true);
  if (flowId == null || flowRunId == null) {
    FlowContext context=lookupFlowContext(clusterId,appId);
    flowId=context.flowId;
    flowRunId=context.flowRunId;
  }
  if (fieldsToRetrieve == null) {
    fieldsToRetrieve=EnumSet.noneOf(Field.class);
  }
  byte[] rowKey=EntityRowKey.getRowKey(clusterId,userId,flowId,flowRunId,appId,entityType,entityId);
  Get get=new Get(rowKey);
  get.setMaxVersions(Integer.MAX_VALUE);
  return parseEntity(entityTable.getResult(hbaseConf,conn,get),fieldsToRetrieve,false,DEFAULT_BEGIN_TIME,DEFAULT_END_TIME,false,DEFAULT_BEGIN_TIME,DEFAULT_END_TIME,null,null,null,null,null,null);
}
