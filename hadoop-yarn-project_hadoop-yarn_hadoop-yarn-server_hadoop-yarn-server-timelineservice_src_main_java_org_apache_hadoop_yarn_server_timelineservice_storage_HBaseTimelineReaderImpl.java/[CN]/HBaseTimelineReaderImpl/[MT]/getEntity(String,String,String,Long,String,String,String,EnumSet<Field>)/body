{
  validateParams(userId,clusterId,appId,entityType,entityId,true);
  if (flowId == null || flowRunId == null) {
    FlowContext context=lookupFlowContext(clusterId,appId);
    flowId=context.flowId;
    flowRunId=context.flowRunId;
  }
  if (fieldsToRetrieve == null) {
    fieldsToRetrieve=EnumSet.noneOf(Field.class);
  }
  boolean isApplication=isApplicationEntity(entityType);
  byte[] rowKey=isApplication ? ApplicationRowKey.getRowKey(clusterId,userId,flowId,flowRunId,appId) : EntityRowKey.getRowKey(clusterId,userId,flowId,flowRunId,appId,entityType,entityId);
  Get get=new Get(rowKey);
  get.setMaxVersions(Integer.MAX_VALUE);
  Result result=isApplication ? applicationTable.getResult(hbaseConf,conn,get) : entityTable.getResult(hbaseConf,conn,get);
  return parseEntity(result,fieldsToRetrieve,false,DEFAULT_BEGIN_TIME,DEFAULT_END_TIME,false,DEFAULT_BEGIN_TIME,DEFAULT_END_TIME,null,null,null,null,null,null,isApplication);
}
