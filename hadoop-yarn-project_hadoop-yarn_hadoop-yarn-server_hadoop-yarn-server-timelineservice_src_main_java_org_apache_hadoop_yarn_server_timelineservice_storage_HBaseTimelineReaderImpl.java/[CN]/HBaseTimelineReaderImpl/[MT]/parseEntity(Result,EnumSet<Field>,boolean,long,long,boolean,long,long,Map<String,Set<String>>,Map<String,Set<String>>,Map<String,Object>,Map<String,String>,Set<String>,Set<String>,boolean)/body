{
  if (result == null || result.isEmpty()) {
    return null;
  }
  TimelineEntity entity=new TimelineEntity();
  String entityType=isApplication ? TimelineEntityType.YARN_APPLICATION.toString() : EntityColumn.TYPE.readResult(result).toString();
  entity.setType(entityType);
  String entityId=isApplication ? ApplicationColumn.ID.readResult(result).toString() : EntityColumn.ID.readResult(result).toString();
  entity.setId(entityId);
  Number createdTime=isApplication ? (Number)ApplicationColumn.CREATED_TIME.readResult(result) : (Number)EntityColumn.CREATED_TIME.readResult(result);
  entity.setCreatedTime(createdTime.longValue());
  if (checkCreatedTime && (entity.getCreatedTime() < createdTimeBegin || entity.getCreatedTime() > createdTimeEnd)) {
    return null;
  }
  Number modifiedTime=isApplication ? (Number)ApplicationColumn.MODIFIED_TIME.readResult(result) : (Number)EntityColumn.MODIFIED_TIME.readResult(result);
  entity.setModifiedTime(modifiedTime.longValue());
  if (checkModifiedTime && (entity.getModifiedTime() < modifiedTimeBegin || entity.getModifiedTime() > modifiedTimeEnd)) {
    return null;
  }
  boolean checkIsRelatedTo=isRelatedTo != null && isRelatedTo.size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.IS_RELATED_TO) || checkIsRelatedTo) {
    if (isApplication) {
      readRelationship(entity,result,ApplicationColumnPrefix.IS_RELATED_TO,true);
    }
 else {
      readRelationship(entity,result,EntityColumnPrefix.IS_RELATED_TO,true);
    }
    if (checkIsRelatedTo && !TimelineReaderUtils.matchRelations(entity.getIsRelatedToEntities(),isRelatedTo)) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.IS_RELATED_TO)) {
      entity.getIsRelatedToEntities().clear();
    }
  }
  boolean checkRelatesTo=relatesTo != null && relatesTo.size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.RELATES_TO) || checkRelatesTo) {
    if (isApplication) {
      readRelationship(entity,result,ApplicationColumnPrefix.RELATES_TO,false);
    }
 else {
      readRelationship(entity,result,EntityColumnPrefix.RELATES_TO,false);
    }
    if (checkRelatesTo && !TimelineReaderUtils.matchRelations(entity.getRelatesToEntities(),relatesTo)) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.RELATES_TO)) {
      entity.getRelatesToEntities().clear();
    }
  }
  boolean checkInfo=infoFilters != null && infoFilters.size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.INFO) || checkInfo) {
    if (isApplication) {
      readKeyValuePairs(entity,result,ApplicationColumnPrefix.INFO,false);
    }
 else {
      readKeyValuePairs(entity,result,EntityColumnPrefix.INFO,false);
    }
    if (checkInfo && !TimelineReaderUtils.matchFilters(entity.getInfo(),infoFilters)) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.INFO)) {
      entity.getInfo().clear();
    }
  }
  boolean checkConfigs=configFilters != null && configFilters.size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.CONFIGS) || checkConfigs) {
    if (isApplication) {
      readKeyValuePairs(entity,result,ApplicationColumnPrefix.CONFIG,true);
    }
 else {
      readKeyValuePairs(entity,result,EntityColumnPrefix.CONFIG,true);
    }
    if (checkConfigs && !TimelineReaderUtils.matchFilters(entity.getConfigs(),configFilters)) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.CONFIGS)) {
      entity.getConfigs().clear();
    }
  }
  boolean checkEvents=eventFilters != null && eventFilters.size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.EVENTS) || checkEvents) {
    readEvents(entity,result,isApplication);
    if (checkEvents && !TimelineReaderUtils.matchEventFilters(entity.getEvents(),eventFilters)) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.EVENTS)) {
      entity.getEvents().clear();
    }
  }
  boolean checkMetrics=metricFilters != null && metricFilters.size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.METRICS) || checkMetrics) {
    readMetrics(entity,result,isApplication);
    if (checkMetrics && !TimelineReaderUtils.matchMetricFilters(entity.getMetrics(),metricFilters)) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.METRICS)) {
      entity.getMetrics().clear();
    }
  }
  return entity;
}
