{
  long started=System.currentTimeMillis();
synchronized (appMasters) {
    while (!appMasters.isEmpty() && System.currentTimeMillis() - started < timeoutMillis) {
      appMasters.wait(1000);
    }
  }
  if (!appMasters.isEmpty()) {
    LOG.warn("Stopping RM while some app masters are still alive");
  }
}
