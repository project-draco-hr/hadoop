{
  GetClusterMetricsRequest req=GetClusterMetricsRequest.newInstance();
  for (int i=0; i < timeout / 100; i++) {
    ResourceManager rm=getResourceManager();
    if (rm == null) {
      throw new YarnException("Can not find the active RM.");
    }
 else     if (nodeManagers.length == rm.getClientRMService().getClusterMetrics(req).getClusterMetrics().getNumNodeManagers()) {
      return true;
    }
    Thread.sleep(100);
  }
  return false;
}
