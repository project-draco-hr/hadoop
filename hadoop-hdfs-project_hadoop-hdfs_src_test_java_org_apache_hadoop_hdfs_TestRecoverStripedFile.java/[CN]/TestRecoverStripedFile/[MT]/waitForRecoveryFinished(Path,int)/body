{
  final int ATTEMPTS=60;
  for (int i=0; i < ATTEMPTS; i++) {
    LocatedBlocks locatedBlocks=getLocatedBlocks(file);
    LocatedStripedBlock lastBlock=(LocatedStripedBlock)locatedBlocks.getLastLocatedBlock();
    DatanodeInfo[] storageInfos=lastBlock.getLocations();
    if (storageInfos.length >= groupSize) {
      return locatedBlocks;
    }
    Thread.sleep(1000);
  }
  throw new IOException("Time out waiting for EC block recovery.");
}
