{
  final Configuration conf=new Configuration();
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,blockSize);
  conf.setInt(DFSConfigKeys.DFS_DATANODE_STRIPED_READ_BUFFER_SIZE_KEY,cellSize - 1);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_REPLICATION_INTERVAL_KEY,1);
  conf.setBoolean(DFSConfigKeys.DFS_NAMENODE_REPLICATION_CONSIDERLOAD_KEY,false);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(dnNum).build();
  cluster.waitActive();
  fs=cluster.getFileSystem();
  fs.getClient().setErasureCodingPolicy("/",null);
  List<DataNode> datanodes=cluster.getDataNodes();
  for (int i=0; i < dnNum; i++) {
    dnMap.put(datanodes.get(i).getDatanodeId(),i);
  }
}
