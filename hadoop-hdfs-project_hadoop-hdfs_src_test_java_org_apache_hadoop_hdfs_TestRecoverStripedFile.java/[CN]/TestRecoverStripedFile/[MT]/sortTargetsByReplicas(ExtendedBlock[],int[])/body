{
  int[] result=new int[blocks.length];
  for (int i=0; i < blocks.length; i++) {
    result[i]=-1;
    for (int j=0; j < targetDNs.length; j++) {
      if (targetDNs[j] != -1) {
        File replica=cluster.getBlockFile(targetDNs[j],blocks[i]);
        if (replica != null) {
          result[i]=targetDNs[j];
          targetDNs[j]=-1;
          break;
        }
      }
    }
    if (result[i] == -1) {
      Assert.fail("Failed to recover striped block: " + blocks[i].getBlockId());
    }
  }
  return result;
}
