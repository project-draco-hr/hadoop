{
  total=JobImpl.newCounters();
  if (job == null) {
    return;
  }
  map=JobImpl.newCounters();
  reduce=JobImpl.newCounters();
  Map<TaskId,Task> tasks=job.getTasks();
  for (  Task t : tasks.values()) {
    Counters counters=t.getCounters();
    JobImpl.incrAllCounters(total,counters);
switch (t.getType()) {
case MAP:
      JobImpl.incrAllCounters(map,counters);
    break;
case REDUCE:
  JobImpl.incrAllCounters(reduce,counters);
break;
}
}
}
