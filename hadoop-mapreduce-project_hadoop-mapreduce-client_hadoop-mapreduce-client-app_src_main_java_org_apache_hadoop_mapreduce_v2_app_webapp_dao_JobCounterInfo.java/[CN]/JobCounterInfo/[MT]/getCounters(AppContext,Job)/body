{
  if (job == null) {
    return;
  }
  total=job.getAllCounters();
  boolean needTotalCounters=false;
  if (total == null) {
    total=new Counters();
    needTotalCounters=true;
  }
  map=new Counters();
  reduce=new Counters();
  Map<TaskId,Task> tasks=job.getTasks();
  for (  Task t : tasks.values()) {
    Counters counters=t.getCounters();
    if (counters == null) {
      continue;
    }
switch (t.getType()) {
case MAP:
      map.incrAllCounters(counters);
    break;
case REDUCE:
  reduce.incrAllCounters(counters);
break;
}
if (needTotalCounters) {
total.incrAllCounters(counters);
}
}
}
