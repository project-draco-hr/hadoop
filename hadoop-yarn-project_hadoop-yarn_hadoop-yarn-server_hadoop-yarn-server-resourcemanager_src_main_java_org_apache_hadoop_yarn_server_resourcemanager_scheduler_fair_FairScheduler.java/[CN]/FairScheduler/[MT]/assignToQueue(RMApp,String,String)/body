{
  if (queueName.equals(YarnConfiguration.DEFAULT_QUEUE_NAME) && userAsDefaultQueue) {
    queueName=user;
  }
  FSLeafQueue queue=queueMgr.getLeafQueue(queueName,conf.getAllowUndeclaredPools());
  if (queue == null) {
    queue=queueMgr.getLeafQueue(YarnConfiguration.DEFAULT_QUEUE_NAME,false);
  }
  if (rmApp != null) {
    rmApp.setQueue(queue.getName());
  }
  return queue;
}
