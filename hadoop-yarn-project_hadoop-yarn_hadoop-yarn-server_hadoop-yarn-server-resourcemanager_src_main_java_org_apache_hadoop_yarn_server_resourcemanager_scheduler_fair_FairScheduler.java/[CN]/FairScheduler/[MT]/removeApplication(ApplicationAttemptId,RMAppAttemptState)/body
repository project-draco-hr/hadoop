{
  LOG.info("Application " + applicationAttemptId + " is done."+ " finalState="+ rmAppAttemptFinalState);
  FSSchedulerApp application=applications.get(applicationAttemptId);
  if (application == null) {
    LOG.info("Unknown application " + applicationAttemptId + " has completed!");
    return;
  }
  for (  RMContainer rmContainer : application.getLiveContainers()) {
    completedContainer(rmContainer,SchedulerUtils.createAbnormalContainerStatus(rmContainer.getContainerId(),SchedulerUtils.COMPLETED_APPLICATION),RMContainerEventType.KILL);
  }
  for (  RMContainer rmContainer : application.getReservedContainers()) {
    completedContainer(rmContainer,SchedulerUtils.createAbnormalContainerStatus(rmContainer.getContainerId(),"Application Complete"),RMContainerEventType.KILL);
  }
  application.stop(rmAppAttemptFinalState);
  FSQueue queue=queueMgr.getQueue(application.getQueue().getQueueName());
  queue.removeApp(application);
  applications.remove(applicationAttemptId);
}
