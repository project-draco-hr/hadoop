{
  ApplicationAttemptId appAttemptId=container.getApplicationAttemptId();
  FSSchedulerApp app=getSchedulerApp(appAttemptId);
  FSLeafQueue queue=app.getQueue();
  LOG.info("Preempting container (prio=" + container.getContainer().getPriority() + "res="+ container.getContainer().getResource()+ ") from queue "+ queue.getName());
  Long time=app.getContainerPreemptionTime(container);
  if (time != null) {
    if (time + waitTimeBeforeKill < clock.getTime()) {
      ContainerStatus status=SchedulerUtils.createPreemptedContainerStatus(container.getContainerId(),SchedulerUtils.PREEMPTED_CONTAINER);
      recoverResourceRequestForContainer(container);
      completedContainer(container,status,RMContainerEventType.KILL);
      LOG.info("Killing container" + container + " (after waiting for premption for "+ (clock.getTime() - time)+ "ms)");
    }
  }
 else {
    app.addPreemption(container,clock.getTime());
  }
}
