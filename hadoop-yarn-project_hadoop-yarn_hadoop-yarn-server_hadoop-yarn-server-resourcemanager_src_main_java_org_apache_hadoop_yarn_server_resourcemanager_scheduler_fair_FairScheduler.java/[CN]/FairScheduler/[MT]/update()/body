{
  queueMgr.reloadAllocsIfNecessary();
  updateRunnability();
  updatePreemptionVariables();
  for (  FSQueue queue : queueMgr.getQueues()) {
    queue.getQueueSchedulable().updateDemand();
  }
  List<FSQueueSchedulable> queueScheds=getQueueSchedulables();
  SchedulingAlgorithms.computeFairShares(queueScheds,clusterCapacity);
  for (  FSQueueSchedulable sched : queueScheds) {
    sched.getMetrics().setAvailableResourcesToQueue(sched.getFairShare());
  }
  for (  FSQueue queue : queueMgr.getQueues()) {
    queue.getQueueSchedulable().redistributeShare();
  }
  rootMetrics.setAvailableResourcesToQueue(clusterCapacity);
}
