{
  FSQueue queue=queueMgr.getQueue(queueName);
  FSSchedulerApp schedulerApp=new FSSchedulerApp(applicationAttemptId,user,queue.getQueueSchedulable(),new ActiveUsersManager(getRootQueueMetrics()),rmContext,null);
  UserGroupInformation userUgi;
  try {
    userUgi=UserGroupInformation.getCurrentUser();
  }
 catch (  IOException ioe) {
    LOG.info("Failed to get current user information");
    return;
  }
  List<QueueUserACLInfo> info=queue.getQueueSchedulable().getQueueUserAclInfo(userUgi);
  if (!info.get(0).getUserAcls().contains(QueueACL.SUBMIT_APPLICATIONS)) {
    LOG.info("User " + userUgi.getUserName() + " cannot submit"+ " applications to queue "+ queue.getName());
    return;
  }
  queue.addApp(schedulerApp);
  queue.getQueueSchedulable().getMetrics().submitApp(user,applicationAttemptId.getAttemptId());
  rootMetrics.submitApp(user,applicationAttemptId.getAttemptId());
  applications.put(applicationAttemptId,schedulerApp);
  LOG.info("Application Submission: " + applicationAttemptId + ", user: "+ user+ ", currently active: "+ applications.size());
  rmContext.getDispatcher().getEventHandler().handle(new RMAppAttemptEvent(applicationAttemptId,RMAppAttemptEventType.APP_ACCEPTED));
}
