{
  double weight=1.0;
  if (sizeBasedWeight) {
    weight=Math.log1p(app.getDemand().getMemory()) / Math.log(2);
  }
  weight*=app.getPriority().getPriority();
  if (weightAdjuster != null) {
    weight=weightAdjuster.adjustWeight(app,weight);
  }
  ResourceWeights resourceWeights=app.getResourceWeights();
  resourceWeights.setWeight((float)weight);
  return resourceWeights;
}
