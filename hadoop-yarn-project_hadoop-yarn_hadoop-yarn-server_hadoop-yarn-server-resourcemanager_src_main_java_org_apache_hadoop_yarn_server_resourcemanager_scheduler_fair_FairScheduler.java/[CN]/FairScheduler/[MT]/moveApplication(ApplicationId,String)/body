{
  SchedulerApplication app=applications.get(appId);
  if (app == null) {
    throw new YarnException("App to be moved " + appId + " not found.");
  }
  FSSchedulerApp attempt=(FSSchedulerApp)app.getCurrentAppAttempt();
  FSLeafQueue oldQueue=(FSLeafQueue)app.getQueue();
  FSLeafQueue targetQueue=queueMgr.getLeafQueue(queueName,false);
  if (targetQueue == null) {
    throw new YarnException("Target queue " + queueName + " not found or is not a leaf queue.");
  }
  if (targetQueue == oldQueue) {
    return oldQueue.getQueueName();
  }
  if (oldQueue.getRunnableAppSchedulables().contains(attempt.getAppSchedulable())) {
    verifyMoveDoesNotViolateConstraints(attempt,oldQueue,targetQueue);
  }
  executeMove(app,attempt,oldQueue,targetQueue);
  return targetQueue.getQueueName();
}
