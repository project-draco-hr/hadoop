{
  MiniKMS.Builder miniKMSBuilder=new MiniKMS.Builder().setKmsConfDir(confDir).setLog4jConfFile("log4j.properties");
  if (keystore != null) {
    miniKMSBuilder.setSslConf(new File(keystore),password);
  }
  if (port > 0) {
    miniKMSBuilder.setPort(port);
  }
  MiniKMS miniKMS=miniKMSBuilder.build();
  miniKMS.start();
  try {
    System.out.println("Test KMS running at: " + miniKMS.getKMSUrl());
    callable.kmsUrl=miniKMS.getKMSUrl();
    return callable.call();
  }
  finally {
    miniKMS.stop();
  }
}
