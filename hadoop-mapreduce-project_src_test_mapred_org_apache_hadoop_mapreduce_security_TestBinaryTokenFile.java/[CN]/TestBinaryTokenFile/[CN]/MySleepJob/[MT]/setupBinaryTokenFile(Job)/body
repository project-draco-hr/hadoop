{
  try {
    Credentials cred1=new Credentials();
    Credentials cred2=new Credentials();
    TokenCache.obtainTokensForNamenodesInternal(cred1,new Path[]{p1},job.getConfiguration());
    for (    Token<? extends TokenIdentifier> t : cred1.getAllTokens()) {
      cred2.addToken(new Text("Hdfs"),t);
    }
    DataOutputStream os=new DataOutputStream(new FileOutputStream(binaryTokenFileName.toString()));
    cred2.writeTokenStorageToStream(os);
    os.close();
    job.getConfiguration().set("mapreduce.job.credentials.binary",binaryTokenFileName.toString());
  }
 catch (  IOException e) {
    Assert.fail("Exception " + e);
  }
}
