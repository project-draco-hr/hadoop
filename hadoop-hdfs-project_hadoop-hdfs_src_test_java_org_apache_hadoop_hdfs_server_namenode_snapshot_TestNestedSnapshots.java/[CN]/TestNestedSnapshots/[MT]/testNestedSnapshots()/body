{
  final Path foo=new Path("/testNestedSnapshots/foo");
  final Path bar=new Path(foo,"bar");
  final Path file1=new Path(bar,"file1");
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPLICATION,SEED);
  print("create file " + file1);
  final String s1name="foo-s1";
  final Path s1path=SnapshotTestHelper.getSnapshotRoot(foo,s1name);
  hdfs.allowSnapshot(foo.toString());
  print("allow snapshot " + foo);
  hdfs.createSnapshot(s1name,foo.toString());
  print("create snapshot " + s1name);
  final String s2name="bar-s2";
  final Path s2path=SnapshotTestHelper.getSnapshotRoot(bar,s2name);
  hdfs.allowSnapshot(bar.toString());
  print("allow snapshot " + bar);
  hdfs.createSnapshot(s2name,bar.toString());
  print("create snapshot " + s2name);
  final Path file2=new Path(bar,"file2");
  DFSTestUtil.createFile(hdfs,file2,BLOCKSIZE,REPLICATION,SEED);
  print("create file " + file2);
  assertFile(s1path,s2path,file1,true,true,true);
  assertFile(s1path,s2path,file2,true,false,false);
}
