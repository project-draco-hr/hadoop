{
  final Path dir=new Path("/dir");
  final Path sub=new Path(dir,"sub");
  hdfs.mkdirs(sub);
  SnapshotTestHelper.createSnapshot(hdfs,dir,"s1");
  final Path file=new Path(sub,"file");
  DFSTestUtil.createFile(hdfs,file,BLOCKSIZE,REPLICATION,SEED);
  FSDirectory fsdir=cluster.getNamesystem().getFSDirectory();
  INode subNode=fsdir.getINode(sub.toString());
  assertTrue(subNode instanceof INodeDirectoryWithSnapshot);
  hdfs.allowSnapshot(sub);
  subNode=fsdir.getINode(sub.toString());
  assertTrue(subNode instanceof INodeDirectorySnapshottable);
  hdfs.disallowSnapshot(sub);
  subNode=fsdir.getINode(sub.toString());
  assertTrue(subNode instanceof INodeDirectoryWithSnapshot);
}
