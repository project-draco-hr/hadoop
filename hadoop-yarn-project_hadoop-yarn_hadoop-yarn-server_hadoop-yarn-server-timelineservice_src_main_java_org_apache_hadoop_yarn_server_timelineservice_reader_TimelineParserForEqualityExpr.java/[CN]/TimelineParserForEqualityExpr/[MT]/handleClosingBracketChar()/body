{
  if (currentParseState != ParseState.PARSING_VALUE && currentParseState != ParseState.PARSING_OP) {
    throw new TimelineParseException("Encountered unexpected closing " + "bracket while parsing " + exprName + ".");
  }
  if (!filterListStack.isEmpty()) {
    if (currentParseState == ParseState.PARSING_VALUE) {
      if (startOffset != offset) {
        createAndSetFilter(true);
        currentParseState=ParseState.PARSING_OP;
      }
    }
    if (filterList == null) {
      filterList=new TimelineFilterList();
    }
    if (currentFilter != null) {
      filterList.addFilter(currentFilter);
    }
    TimelineFilterList fList=filterListStack.pop();
    if (fList != null) {
      fList.addFilter(filterList);
      filterList=fList;
    }
    currentFilter=null;
    offset++;
    startOffset=offset;
  }
 else {
    throw new TimelineParseException("Encountered unexpected closing " + "bracket while parsing " + exprName + ".");
  }
}
