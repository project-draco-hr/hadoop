{
  try {
    rm1.registerNode("127.0.0.1:1",102400,100);
    int attempts=10;
    do {
      DrainDispatcher dispatcher=(DrainDispatcher)rm1.getRMContext().getDispatcher();
      dispatcher.await();
      rm1.getRMContext().getReservationSystem().synchronizePlan(ReservationSystemTestUtil.reservationQ);
      if (rm1.getRMContext().getReservationSystem().getPlan(ReservationSystemTestUtil.reservationQ).getTotalCapacity().getMemory() > 0) {
        break;
      }
      LOG.info("Waiting for node capacity to be added to plan");
      Thread.sleep(100);
    }
 while (attempts-- > 0);
    if (attempts <= 0) {
      Assert.fail("Exhausted attempts in checking if node capacity was " + "added to the plan");
    }
  }
 catch (  Exception e) {
    Assert.fail(e.getMessage());
  }
}
