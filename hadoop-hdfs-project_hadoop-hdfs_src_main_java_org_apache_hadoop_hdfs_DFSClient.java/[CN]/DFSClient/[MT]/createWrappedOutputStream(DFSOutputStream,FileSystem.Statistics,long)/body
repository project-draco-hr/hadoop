{
  final FileEncryptionInfo feInfo=dfsos.getFileEncryptionInfo();
  if (feInfo != null) {
    final CryptoOutputStream cryptoOut=new CryptoOutputStream(dfsos,codec,feInfo.getEncryptedDataEncryptionKey(),feInfo.getIV(),startPos);
    return new HdfsDataOutputStream(cryptoOut,statistics,startPos);
  }
 else {
    return new HdfsDataOutputStream(dfsos,statistics,startPos);
  }
}
