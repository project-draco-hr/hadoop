{
  checkOpen();
  TraceScope scope=getPathTraceScope("newDFSInputStream",src);
  try {
    LocatedBlocks locatedBlocks=getLocatedBlocks(src,0);
    if (locatedBlocks != null) {
      ECSchema schema=locatedBlocks.getECSchema();
      if (schema != null) {
        return new DFSStripedInputStream(this,src,verifyChecksum,schema,locatedBlocks.getStripeCellSize(),locatedBlocks);
      }
      return new DFSInputStream(this,src,verifyChecksum,locatedBlocks);
    }
 else {
      throw new IOException("Cannot open filename " + src);
    }
  }
  finally {
    scope.close();
  }
}
