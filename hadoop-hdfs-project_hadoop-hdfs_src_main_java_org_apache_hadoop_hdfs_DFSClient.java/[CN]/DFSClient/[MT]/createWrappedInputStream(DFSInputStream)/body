{
  final FileEncryptionInfo feInfo=dfsis.getFileEncryptionInfo();
  if (feInfo != null) {
    getCryptoProtocolVersion(feInfo);
    final CryptoCodec codec=getCryptoCodec(conf,feInfo);
    final KeyVersion decrypted=decryptEncryptedDataEncryptionKey(feInfo);
    final CryptoInputStream cryptoIn=new CryptoInputStream(dfsis,codec,decrypted.getMaterial(),feInfo.getIV());
    return new HdfsDataInputStream(cryptoIn);
  }
 else {
    return new HdfsDataInputStream(dfsis);
  }
}
