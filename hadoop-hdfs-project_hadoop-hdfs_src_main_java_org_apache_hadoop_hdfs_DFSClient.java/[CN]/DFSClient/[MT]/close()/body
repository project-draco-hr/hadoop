{
  try {
    if (clientRunning) {
      closeAllFilesBeingWritten(false);
      clientRunning=false;
      getLeaseRenewer().closeClient(this);
      closeConnectionToNamenode();
    }
  }
  finally {
    if (provider != null) {
      provider.close();
    }
  }
}
