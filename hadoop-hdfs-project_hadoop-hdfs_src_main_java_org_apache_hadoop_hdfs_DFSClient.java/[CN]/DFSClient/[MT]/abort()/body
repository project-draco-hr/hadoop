{
  if (mmapManager != null) {
    MMAP_MANAGER_FACTORY.unref(mmapManager);
    mmapManager=null;
  }
  clientRunning=false;
  closeAllFilesBeingWritten(true);
  try {
    getLeaseRenewer().closeClient(this);
  }
 catch (  IOException ioe) {
    LOG.info("Exception occurred while aborting the client " + ioe);
  }
  closeConnectionToNamenode();
}
