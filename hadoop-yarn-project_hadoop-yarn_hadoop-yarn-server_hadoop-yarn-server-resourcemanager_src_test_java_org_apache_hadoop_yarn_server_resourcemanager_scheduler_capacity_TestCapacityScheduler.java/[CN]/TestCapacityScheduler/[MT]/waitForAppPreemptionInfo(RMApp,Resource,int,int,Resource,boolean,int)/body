{
  while (true) {
    RMAppMetrics appPM=app.getRMAppMetrics();
    RMAppAttemptMetrics attemptPM=app.getCurrentAppAttempt().getRMAppAttemptMetrics();
    if (appPM.getResourcePreempted().equals(preempted) && appPM.getNumAMContainersPreempted() == numAMPreempted && appPM.getNumNonAMContainersPreempted() == numTaskPreempted && attemptPM.getResourcePreempted().equals(currentAttemptPreempted) && app.getCurrentAppAttempt().getRMAppAttemptMetrics().getIsPreempted() == currentAttemptAMPreempted && attemptPM.getNumNonAMContainersPreempted() == numLatestAttemptTaskPreempted) {
      return;
    }
    Thread.sleep(500);
  }
}
