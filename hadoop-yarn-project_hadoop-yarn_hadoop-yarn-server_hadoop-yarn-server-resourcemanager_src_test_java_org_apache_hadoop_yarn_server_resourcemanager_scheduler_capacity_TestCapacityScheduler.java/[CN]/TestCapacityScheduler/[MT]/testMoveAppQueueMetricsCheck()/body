{
  ResourceScheduler scheduler=resourceManager.getResourceScheduler();
  String host_0="host_0";
  NodeManager nm_0=registerNode(host_0,1234,2345,NetworkTopology.DEFAULT_RACK,Resources.createResource(5 * GB,1));
  String host_1="host_1";
  NodeManager nm_1=registerNode(host_1,1234,2345,NetworkTopology.DEFAULT_RACK,Resources.createResource(5 * GB,1));
  Priority priority_0=org.apache.hadoop.yarn.server.resourcemanager.resource.Priority.create(0);
  Priority priority_1=org.apache.hadoop.yarn.server.resourcemanager.resource.Priority.create(1);
  Application application_0=new Application("user_0","a1",resourceManager);
  application_0.submit();
  application_0.addNodeManager(host_0,1234,nm_0);
  application_0.addNodeManager(host_1,1234,nm_1);
  Resource capability_0_0=Resources.createResource(3 * GB,1);
  application_0.addResourceRequestSpec(priority_1,capability_0_0);
  Resource capability_0_1=Resources.createResource(2 * GB,1);
  application_0.addResourceRequestSpec(priority_0,capability_0_1);
  Task task_0_0=new Task(application_0,priority_1,new String[]{host_0,host_1});
  application_0.addTask(task_0_0);
  Application application_1=new Application("user_1","b2",resourceManager);
  application_1.submit();
  application_1.addNodeManager(host_0,1234,nm_0);
  application_1.addNodeManager(host_1,1234,nm_1);
  Resource capability_1_0=Resources.createResource(1 * GB,1);
  application_1.addResourceRequestSpec(priority_1,capability_1_0);
  Resource capability_1_1=Resources.createResource(2 * GB,1);
  application_1.addResourceRequestSpec(priority_0,capability_1_1);
  Task task_1_0=new Task(application_1,priority_1,new String[]{host_0,host_1});
  application_1.addTask(task_1_0);
  application_0.schedule();
  application_1.schedule();
  nodeUpdate(nm_0);
  nodeUpdate(nm_1);
  CapacityScheduler cs=(CapacityScheduler)resourceManager.getResourceScheduler();
  CSQueue origRootQ=cs.getRootQueue();
  CapacitySchedulerInfo oldInfo=new CapacitySchedulerInfo(origRootQ);
  int origNumAppsA=getNumAppsInQueue("a",origRootQ.getChildQueues());
  int origNumAppsRoot=origRootQ.getNumApplications();
  scheduler.moveApplication(application_0.getApplicationId(),"a2");
  CSQueue newRootQ=cs.getRootQueue();
  int newNumAppsA=getNumAppsInQueue("a",newRootQ.getChildQueues());
  int newNumAppsRoot=newRootQ.getNumApplications();
  CapacitySchedulerInfo newInfo=new CapacitySchedulerInfo(newRootQ);
  CapacitySchedulerLeafQueueInfo origOldA1=(CapacitySchedulerLeafQueueInfo)getQueueInfo("a1",oldInfo.getQueues());
  CapacitySchedulerLeafQueueInfo origNewA1=(CapacitySchedulerLeafQueueInfo)getQueueInfo("a1",newInfo.getQueues());
  CapacitySchedulerLeafQueueInfo targetOldA2=(CapacitySchedulerLeafQueueInfo)getQueueInfo("a2",oldInfo.getQueues());
  CapacitySchedulerLeafQueueInfo targetNewA2=(CapacitySchedulerLeafQueueInfo)getQueueInfo("a2",newInfo.getQueues());
  assertEquals(1,origOldA1.getNumApplications());
  assertEquals(1,origNumAppsA);
  assertEquals(2,origNumAppsRoot);
  assertEquals(0,origNewA1.getNumApplications());
  assertEquals(1,newNumAppsA);
  assertEquals(2,newNumAppsRoot);
  assertEquals(3 * GB,origOldA1.getResourcesUsed().getMemory());
  assertEquals(1,origOldA1.getResourcesUsed().getvCores());
  assertEquals(0,origNewA1.getResourcesUsed().getMemory());
  assertEquals(0,origNewA1.getResourcesUsed().getvCores());
  assertEquals(3 * GB,targetNewA2.getResourcesUsed().getMemory());
  assertEquals(1,targetNewA2.getResourcesUsed().getvCores());
  assertEquals(0,targetOldA2.getNumApplications());
  assertEquals(0,targetOldA2.getResourcesUsed().getMemory());
  assertEquals(0,targetOldA2.getResourcesUsed().getvCores());
  assertEquals(1,targetNewA2.getNumApplications());
  assertEquals(1,origOldA1.getNumContainers());
  assertEquals(0,origNewA1.getNumContainers());
  assertEquals(1,targetNewA2.getNumContainers());
  assertEquals(0,targetOldA2.getNumContainers());
  assertEquals(3 * GB,origOldA1.getUsers().getUsersList().get(0).getResourcesUsed().getMemory());
  assertEquals(1,origOldA1.getUsers().getUsersList().get(0).getResourcesUsed().getvCores());
  assertEquals(0,origNewA1.getUsers().getUsersList().size());
  assertEquals(3 * GB,targetNewA2.getUsers().getUsersList().get(0).getResourcesUsed().getMemory());
  assertEquals(1,targetNewA2.getUsers().getUsersList().get(0).getResourcesUsed().getvCores());
  application_0.schedule();
  checkApplicationResourceUsage(3 * GB,application_0);
  application_1.schedule();
  checkApplicationResourceUsage(1 * GB,application_1);
  checkNodeResourceUsage(4 * GB,nm_0);
  checkNodeResourceUsage(0 * GB,nm_1);
}
