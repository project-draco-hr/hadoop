{
  LOG.info("Loading history file: [" + historyFileAbsolute + "]");
  if (this.jobInfo != null) {
    return;
  }
  if (historyFileAbsolute != null) {
    JobHistoryParser parser=null;
    try {
      final FileSystem fs=historyFileAbsolute.getFileSystem(conf);
      parser=new JobHistoryParser(historyFileAbsolute.getFileSystem(conf),historyFileAbsolute);
      final Path jobConfPath=new Path(historyFileAbsolute.getParent(),JobHistoryUtils.getIntermediateConfFileName(jobId));
      final Configuration conf=new Configuration();
      try {
        conf.addResource(fs.open(jobConfPath),jobConfPath.toString());
        Limits.reset(conf);
      }
 catch (      FileNotFoundException fnf) {
        if (LOG.isWarnEnabled()) {
          LOG.warn("Missing job conf in history",fnf);
        }
      }
      this.jobInfo=parser.parse();
    }
 catch (    IOException e) {
      throw new YarnRuntimeException("Could not load history file " + historyFileAbsolute,e);
    }
    IOException parseException=parser.getParseException();
    if (parseException != null) {
      throw new YarnRuntimeException("Could not parse history file " + historyFileAbsolute,parseException);
    }
  }
 else {
    throw new IOException("History file not found");
  }
  if (loadTasks) {
    loadAllTasks();
    LOG.info("TaskInfo loaded");
  }
}
