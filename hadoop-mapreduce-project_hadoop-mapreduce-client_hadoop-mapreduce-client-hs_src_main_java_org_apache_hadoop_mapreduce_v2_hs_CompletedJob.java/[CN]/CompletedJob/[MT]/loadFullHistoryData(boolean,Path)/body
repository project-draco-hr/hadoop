{
  LOG.info("Loading history file: [" + historyFileAbsolute + "]");
  if (jobInfo != null) {
    return;
  }
  if (historyFileAbsolute != null) {
    try {
      JobHistoryParser parser=new JobHistoryParser(historyFileAbsolute.getFileSystem(conf),historyFileAbsolute);
      jobInfo=parser.parse();
    }
 catch (    IOException e) {
      throw new YarnException("Could not load history file " + historyFileAbsolute,e);
    }
  }
 else {
    throw new IOException("History file not found");
  }
  if (loadTasks) {
    for (    Map.Entry<org.apache.hadoop.mapreduce.TaskID,TaskInfo> entry : jobInfo.getAllTasks().entrySet()) {
      TaskId yarnTaskID=TypeConverter.toYarn(entry.getKey());
      TaskInfo taskInfo=entry.getValue();
      Task task=new CompletedTask(yarnTaskID,taskInfo);
      tasks.put(yarnTaskID,task);
      if (task.getType() == TaskType.MAP) {
        mapTasks.put(task.getID(),task);
      }
 else       if (task.getType() == TaskType.REDUCE) {
        reduceTasks.put(task.getID(),task);
      }
    }
  }
  LOG.info("TaskInfo loaded");
}
