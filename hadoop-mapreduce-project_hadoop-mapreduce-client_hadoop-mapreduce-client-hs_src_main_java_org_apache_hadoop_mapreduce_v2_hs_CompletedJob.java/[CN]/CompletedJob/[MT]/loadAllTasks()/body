{
  if (tasksLoaded.get()) {
    return;
  }
  tasksLock.lock();
  try {
    if (tasksLoaded.get()) {
      return;
    }
    for (    Map.Entry<TaskID,TaskInfo> entry : jobInfo.getAllTasks().entrySet()) {
      TaskId yarnTaskID=TypeConverter.toYarn(entry.getKey());
      TaskInfo taskInfo=entry.getValue();
      Task task=new CompletedTask(yarnTaskID,taskInfo);
      tasks.put(yarnTaskID,task);
      if (task.getType() == TaskType.MAP) {
        mapTasks.put(task.getID(),task);
      }
 else       if (task.getType() == TaskType.REDUCE) {
        reduceTasks.put(task.getID(),task);
      }
    }
    tasksLoaded.set(true);
  }
  finally {
    tasksLock.unlock();
  }
}
