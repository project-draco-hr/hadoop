{
  String className=StringUtils.popOptionWithArgument("-class",args);
  if (className == null) {
    System.err.println("You must specify the classname with -class.");
    return 1;
  }
  ByteArrayOutputStream configStream=new ByteArrayOutputStream();
  PrintStream configsOut=new PrintStream(configStream);
  SpanReceiverInfoBuilder factory=new SpanReceiverInfoBuilder(className);
  String prefix="";
  for (int i=0; i < args.size(); ++i) {
    String str=args.get(i);
    if (!str.startsWith(CONFIG_PREFIX)) {
      System.err.println("Can't understand argument: " + str);
      return 1;
    }
    str=str.substring(CONFIG_PREFIX.length());
    int equalsIndex=str.indexOf("=");
    if (equalsIndex < 0) {
      System.err.println("Can't parse configuration argument " + str);
      System.err.println("Arguments must be in the form key=value");
      return 1;
    }
    String key=str.substring(0,equalsIndex);
    String value=str.substring(equalsIndex + 1);
    factory.addConfigurationPair(key,value);
    configsOut.print(prefix + key + " = "+ value);
    prefix=", ";
  }
  try {
    long id=remote.addSpanReceiver(factory.build());
    System.out.println("Added trace span receiver " + id + " with configuration "+ configStream.toString());
  }
 catch (  IOException e) {
    System.out.println("addSpanReceiver error with configuration " + configStream.toString());
    throw e;
  }
  return 0;
}
