{
  this.dataset=dataset;
  this.storageID=storageID;
  this.reserved=conf.getLong(DFSConfigKeys.DFS_DATANODE_DU_RESERVED_KEY,DFSConfigKeys.DFS_DATANODE_DU_RESERVED_DEFAULT);
  this.currentDir=currentDir;
  File parent=currentDir.getParentFile();
  this.usage=new DF(parent,conf);
  final int maxNumThreads=dataset.datanode.getConf().getInt(DFSConfigKeys.DFS_DATANODE_FSDATASETCACHE_MAX_THREADS_PER_VOLUME_KEY,DFSConfigKeys.DFS_DATANODE_FSDATASETCACHE_MAX_THREADS_PER_VOLUME_DEFAULT);
  ThreadFactory workerFactory=new ThreadFactoryBuilder().setDaemon(true).setNameFormat("FsVolumeImplWorker-" + parent.toString() + "-%d").build();
  cacheExecutor=new ThreadPoolExecutor(1,maxNumThreads,60,TimeUnit.SECONDS,new LinkedBlockingQueue<Runnable>(),workerFactory);
  cacheExecutor.allowCoreThreadTimeOut(true);
}
