{
  try {
    this.reference.setClosed();
  }
 catch (  ClosedChannelException e) {
    throw new IOException("The volume has already closed.",e);
  }
  final int SLEEP_MILLIS=500;
  while (this.reference.getReferenceCount() > 0) {
    if (FsDatasetImpl.LOG.isDebugEnabled()) {
      FsDatasetImpl.LOG.debug(String.format("The reference count for %s is %d, wait to be 0.",this,reference.getReferenceCount()));
    }
    try {
      Thread.sleep(SLEEP_MILLIS);
    }
 catch (    InterruptedException e) {
      throw new IOException(e);
    }
  }
}
