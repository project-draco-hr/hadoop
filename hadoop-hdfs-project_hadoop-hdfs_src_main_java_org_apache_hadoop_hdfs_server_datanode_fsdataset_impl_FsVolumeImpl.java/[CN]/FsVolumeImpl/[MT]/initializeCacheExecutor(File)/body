{
  if (storageType.isTransient()) {
    return null;
  }
  if (dataset.datanode == null) {
    return null;
  }
  final int maxNumThreads=dataset.datanode.getConf().getInt(DFSConfigKeys.DFS_DATANODE_FSDATASETCACHE_MAX_THREADS_PER_VOLUME_KEY,DFSConfigKeys.DFS_DATANODE_FSDATASETCACHE_MAX_THREADS_PER_VOLUME_DEFAULT);
  ThreadFactory workerFactory=new ThreadFactoryBuilder().setDaemon(true).setNameFormat("FsVolumeImplWorker-" + parent.toString() + "-%d").build();
  ThreadPoolExecutor executor=new ThreadPoolExecutor(1,maxNumThreads,60,TimeUnit.SECONDS,new LinkedBlockingQueue<Runnable>(),workerFactory);
  executor.allowCoreThreadTimeOut(true);
  return executor;
}
