{
  File volumeCurrentDir=this.getCurrentDir();
  File bpDir=new File(volumeCurrentDir,bpid);
  File bpCurrentDir=new File(bpDir,DataStorage.STORAGE_DIR_CURRENT);
  File finalizedDir=new File(bpCurrentDir,DataStorage.STORAGE_DIR_FINALIZED);
  File rbwDir=new File(bpCurrentDir,DataStorage.STORAGE_DIR_RBW);
  if (finalizedDir.exists() && !DatanodeUtil.dirNoFilesRecursive(finalizedDir)) {
    return false;
  }
  if (rbwDir.exists() && FileUtil.list(rbwDir).length != 0) {
    return false;
  }
  return true;
}
