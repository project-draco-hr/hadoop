{
  long remaining=getCapacity() - getDfsUsed() - reservedForReplicas.get();
  long available=usage.getAvailable() - reserved - reservedForReplicas.get();
  if (remaining > available) {
    remaining=available;
  }
  return (remaining > 0) ? remaining : 0;
}
