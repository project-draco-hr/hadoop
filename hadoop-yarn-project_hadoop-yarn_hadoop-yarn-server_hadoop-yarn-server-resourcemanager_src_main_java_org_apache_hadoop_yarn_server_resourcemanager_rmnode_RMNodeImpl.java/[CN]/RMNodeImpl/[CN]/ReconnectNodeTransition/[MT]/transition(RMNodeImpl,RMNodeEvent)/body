{
  rmNode.nodeUpdateQueue.clear();
  rmNode.context.getDispatcher().getEventHandler().handle(new NodeRemovedSchedulerEvent(rmNode));
  RMNode newNode=((RMNodeReconnectEvent)event).getReconnectedNode();
  rmNode.nodeManagerVersion=newNode.getNodeManagerVersion();
  if (rmNode.getTotalCapability().equals(newNode.getTotalCapability()) && rmNode.getHttpPort() == newNode.getHttpPort()) {
    rmNode.getLastNodeHeartBeatResponse().setResponseId(0);
    if (rmNode.getState() != NodeState.UNHEALTHY) {
      rmNode.context.getDispatcher().getEventHandler().handle(new NodeAddedSchedulerEvent(rmNode));
    }
  }
 else {
switch (rmNode.getState()) {
case RUNNING:
      ClusterMetrics.getMetrics().decrNumActiveNodes();
    break;
case UNHEALTHY:
  ClusterMetrics.getMetrics().decrNumUnhealthyNMs();
break;
}
rmNode.context.getRMNodes().put(newNode.getNodeID(),newNode);
rmNode.context.getDispatcher().getEventHandler().handle(new RMNodeEvent(newNode.getNodeID(),RMNodeEventType.STARTED));
}
rmNode.context.getDispatcher().getEventHandler().handle(new NodesListManagerEvent(NodesListManagerEventType.NODE_USABLE,rmNode));
}
