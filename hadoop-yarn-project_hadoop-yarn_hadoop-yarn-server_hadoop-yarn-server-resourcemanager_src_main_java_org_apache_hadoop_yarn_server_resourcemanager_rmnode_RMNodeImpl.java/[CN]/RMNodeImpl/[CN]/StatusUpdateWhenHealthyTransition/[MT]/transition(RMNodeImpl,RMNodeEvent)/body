{
  RMNodeStatusEvent statusEvent=(RMNodeStatusEvent)event;
  rmNode.latestHeartBeatResponse=statusEvent.getLatestResponse();
  NodeHealthStatus remoteNodeHealthStatus=statusEvent.getNodeHealthStatus();
  rmNode.setNodeHealthStatus(remoteNodeHealthStatus);
  if (!remoteNodeHealthStatus.getIsNodeHealthy()) {
    LOG.info("Node " + rmNode.nodeId + " reported UNHEALTHY with details: "+ remoteNodeHealthStatus.getHealthReport());
    rmNode.nodeUpdateQueue.clear();
    rmNode.context.getDispatcher().getEventHandler().handle(new NodeRemovedSchedulerEvent(rmNode));
    rmNode.context.getDispatcher().getEventHandler().handle(new NodesListManagerEvent(NodesListManagerEventType.NODE_UNUSABLE,rmNode));
    rmNode.updateMetricsForDeactivatedNode(NodeState.UNHEALTHY);
    return NodeState.UNHEALTHY;
  }
  List<ContainerStatus> newlyLaunchedContainers=new ArrayList<ContainerStatus>();
  List<ContainerStatus> completedContainers=new ArrayList<ContainerStatus>();
  for (  ContainerStatus remoteContainer : statusEvent.getContainers()) {
    ContainerId containerId=remoteContainer.getContainerId();
    if (rmNode.containersToClean.contains(containerId)) {
      LOG.info("Container " + containerId + " already scheduled for "+ "cleanup, no further processing");
      continue;
    }
    if (rmNode.finishedApplications.contains(containerId.getApplicationAttemptId().getApplicationId())) {
      LOG.info("Container " + containerId + " belongs to an application that is already killed,"+ " no further processing");
      continue;
    }
    if (remoteContainer.getState() == ContainerState.RUNNING) {
      if (!rmNode.justLaunchedContainers.containsKey(containerId)) {
        rmNode.justLaunchedContainers.put(containerId,remoteContainer);
        newlyLaunchedContainers.add(remoteContainer);
      }
    }
 else {
      rmNode.justLaunchedContainers.remove(containerId);
      completedContainers.add(remoteContainer);
    }
  }
  if (newlyLaunchedContainers.size() != 0 || completedContainers.size() != 0) {
    rmNode.nodeUpdateQueue.add(new UpdatedContainerInfo(newlyLaunchedContainers,completedContainers));
  }
  if (rmNode.nextHeartBeat) {
    rmNode.nextHeartBeat=false;
    rmNode.context.getDispatcher().getEventHandler().handle(new NodeUpdateSchedulerEvent(rmNode));
  }
  rmNode.context.getDelegationTokenRenewer().updateKeepAliveApplications(statusEvent.getKeepAliveAppIds());
  return NodeState.RUNNING;
}
