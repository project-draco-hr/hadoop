{
  rmNode.nodeUpdateQueue.clear();
  NodeState initialState=rmNode.getState();
  if (!initialState.equals(NodeState.UNHEALTHY)) {
    rmNode.context.getDispatcher().getEventHandler().handle(new NodeRemovedSchedulerEvent(rmNode));
  }
  rmNode.context.getDispatcher().getEventHandler().handle(new NodesListManagerEvent(NodesListManagerEventType.NODE_UNUSABLE,rmNode));
  rmNode.context.getRMNodes().remove(rmNode.nodeId);
  LOG.info("Deactivating Node " + rmNode.nodeId + " as it is now "+ finalState);
  rmNode.context.getInactiveRMNodes().put(rmNode.nodeId,rmNode);
  rmNode.updateMetricsForDeactivatedNode(initialState,finalState);
}
