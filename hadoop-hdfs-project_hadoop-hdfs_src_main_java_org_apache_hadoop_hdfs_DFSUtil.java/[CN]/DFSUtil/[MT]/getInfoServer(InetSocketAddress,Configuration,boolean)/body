{
  String httpAddress=null;
  boolean securityOn=UserGroupInformation.isSecurityEnabled();
  String httpAddressKey=(securityOn && httpsAddress) ? DFS_NAMENODE_HTTPS_ADDRESS_KEY : DFS_NAMENODE_HTTP_ADDRESS_KEY;
  String httpAddressDefault=(securityOn && httpsAddress) ? DFS_NAMENODE_HTTPS_ADDRESS_DEFAULT : DFS_NAMENODE_HTTP_ADDRESS_DEFAULT;
  if (namenodeAddr != null) {
    String nameServiceId=DFSUtil.getNameServiceIdFromAddress(conf,namenodeAddr,DFSConfigKeys.DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY,DFSConfigKeys.DFS_NAMENODE_RPC_ADDRESS_KEY);
    if (nameServiceId != null) {
      httpAddress=conf.get(DFSUtil.addKeySuffixes(httpAddressKey,nameServiceId));
    }
  }
  if (httpAddress == null) {
    httpAddress=conf.get(httpAddressKey,httpAddressDefault);
  }
  return httpAddress;
}
