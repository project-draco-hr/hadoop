{
  String defaultAddress;
  try {
    defaultAddress=NetUtils.getHostPortString(DFSUtilClient.getNNAddress(conf));
  }
 catch (  IllegalArgumentException e) {
    defaultAddress=null;
  }
  Map<String,Map<String,InetSocketAddress>> addressList=DFSUtilClient.getAddresses(conf,defaultAddress,DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY,DFS_NAMENODE_RPC_ADDRESS_KEY);
  if (addressList.isEmpty()) {
    throw new IOException("Incorrect configuration: namenode address " + DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY + " or "+ DFS_NAMENODE_RPC_ADDRESS_KEY+ " is not configured.");
  }
  return addressList;
}
