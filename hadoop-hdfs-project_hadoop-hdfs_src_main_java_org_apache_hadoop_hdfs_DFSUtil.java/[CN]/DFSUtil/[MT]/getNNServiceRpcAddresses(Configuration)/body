{
  String defaultAddress;
  try {
    defaultAddress=NetUtils.getHostPortString(NameNode.getAddress(conf));
  }
 catch (  IllegalArgumentException e) {
    defaultAddress=null;
  }
  List<InetSocketAddress> addressList=getAddresses(conf,defaultAddress,DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY,DFS_NAMENODE_RPC_ADDRESS_KEY);
  if (addressList == null) {
    throw new IOException("Incorrect configuration: namenode address " + DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY + " or "+ DFS_NAMENODE_RPC_ADDRESS_KEY+ " is not configured.");
  }
  return addressList;
}
