{
  Collection<String> nameserviceIds=getNameServiceIds(conf);
  Map<String,Map<String,InetSocketAddress>> ret=Maps.newLinkedHashMap();
  for (  String nsId : emptyAsSingletonNull(nameserviceIds)) {
    Map<String,InetSocketAddress> isas=getAddressesForNameserviceId(conf,nsId,defaultAddress,keys);
    if (!isas.isEmpty()) {
      ret.put(nsId,isas);
    }
  }
  return ret;
}
