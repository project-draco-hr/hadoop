{
  Collection<String> parentNameServices=conf.getTrimmedStringCollection(DFSConfigKeys.DFS_INTERNAL_NAMESERVICES_KEY);
  if (parentNameServices.isEmpty()) {
    parentNameServices=conf.getTrimmedStringCollection(DFSConfigKeys.DFS_NAMESERVICES);
  }
 else {
    Set<String> availableNameServices=Sets.newHashSet(conf.getTrimmedStringCollection(DFSConfigKeys.DFS_NAMESERVICES));
    for (    String nsId : parentNameServices) {
      if (!availableNameServices.contains(nsId)) {
        throw new IOException("Unknown nameservice: " + nsId);
      }
    }
  }
  return DFSUtilClient.getAddressesForNsIds(conf,parentNameServices,null,DFS_NAMENODE_LIFELINE_RPC_ADDRESS_KEY);
}
