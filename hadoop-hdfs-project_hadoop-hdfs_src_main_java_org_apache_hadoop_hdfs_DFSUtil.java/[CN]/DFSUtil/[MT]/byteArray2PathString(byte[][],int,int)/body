{
  final int range=offset + length;
  Preconditions.checkPositionIndexes(offset,range,components.length);
  if (length == 0) {
    return "";
  }
  byte[] firstComponent=components[offset];
  boolean isAbsolute=(offset == 0 && (firstComponent == null || firstComponent.length == 0));
  if (offset == 0 && length == 1) {
    return isAbsolute ? Path.SEPARATOR : bytes2String(firstComponent);
  }
  int pos=isAbsolute ? 0 : firstComponent.length;
  int size=pos + length - 1;
  for (int i=offset + 1; i < range; i++) {
    size+=components[i].length;
  }
  final byte[] result=new byte[size];
  if (!isAbsolute) {
    System.arraycopy(firstComponent,0,result,0,firstComponent.length);
  }
  for (int i=offset + 1; i < range; i++) {
    result[pos++]=(byte)Path.SEPARATOR_CHAR;
    int len=components[i].length;
    System.arraycopy(components[i],0,result,pos,len);
    pos+=len;
  }
  return bytes2String(result);
}
