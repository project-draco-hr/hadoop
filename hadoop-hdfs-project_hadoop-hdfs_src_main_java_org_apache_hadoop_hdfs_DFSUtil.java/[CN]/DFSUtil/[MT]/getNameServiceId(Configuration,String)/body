{
  String nameserviceId=conf.get(DFS_FEDERATION_NAMESERVICE_ID);
  if (nameserviceId != null) {
    return nameserviceId;
  }
  if (!isFederationEnabled(conf)) {
    return null;
  }
  nameserviceId=getSuffixIDs(conf,addressKey,LOCAL_ADDRESS_MATCHER)[0];
  if (nameserviceId == null) {
    String msg="Configuration " + addressKey + " must be suffixed with"+ " nameserviceId for federation configuration.";
    throw new HadoopIllegalArgumentException(msg);
  }
  return nameserviceId;
}
