{
  Set<URI> ret=new HashSet<URI>();
  for (  String nsId : getNameServiceIds(conf)) {
    if (HAUtil.isHAEnabled(conf,nsId)) {
      try {
        ret.add(new URI(HdfsConstants.HDFS_URI_SCHEME + "://" + nsId));
      }
 catch (      URISyntaxException ue) {
        throw new IllegalArgumentException(ue);
      }
    }
 else {
      for (      String key : keys) {
        String addr=conf.get(concatSuffixes(key,nsId));
        if (addr != null) {
          ret.add(createUri(HdfsConstants.HDFS_URI_SCHEME,NetUtils.createSocketAddr(addr)));
          break;
        }
      }
    }
  }
  for (  String key : keys) {
    String addr=conf.get(key);
    if (addr != null) {
      ret.add(createUri("hdfs",NetUtils.createSocketAddr(addr)));
      break;
    }
  }
  return ret;
}
