{
  String[] suffixes=null;
  if (namenodeAddr != null) {
    suffixes=getSuffixIDs(conf,namenodeAddr,DFSConfigKeys.DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY,DFSConfigKeys.DFS_NAMENODE_RPC_ADDRESS_KEY);
  }
  String authority;
  if ("http".equals(scheme)) {
    authority=getSuffixedConf(conf,DFS_NAMENODE_HTTP_ADDRESS_KEY,DFS_NAMENODE_HTTP_ADDRESS_DEFAULT,suffixes);
  }
 else   if ("https".equals(scheme)) {
    authority=getSuffixedConf(conf,DFS_NAMENODE_HTTPS_ADDRESS_KEY,DFS_NAMENODE_HTTPS_ADDRESS_DEFAULT,suffixes);
  }
 else {
    throw new IllegalArgumentException("Invalid scheme:" + scheme);
  }
  if (namenodeAddr != null) {
    authority=substituteForWildcardAddress(authority,namenodeAddr.getHostName());
  }
  return URI.create(scheme + "://" + authority);
}
