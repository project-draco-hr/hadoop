{
  if (nsId == null) {
    Collection<String> nsIds=getNameServiceIds(conf);
    if (nsIds.size() != 1) {
      return null;
    }
 else {
      nsId=nsIds.toArray(new String[1])[0];
    }
  }
  String serviceAddrKey=concatSuffixes(DFSConfigKeys.DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY,nsId,nnId);
  String addrKey=concatSuffixes(DFSConfigKeys.DFS_NAMENODE_RPC_ADDRESS_KEY,nsId,nnId);
  String serviceRpcAddr=conf.get(serviceAddrKey);
  if (serviceRpcAddr == null) {
    serviceRpcAddr=conf.get(addrKey);
  }
  return serviceRpcAddr;
}
