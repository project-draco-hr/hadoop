{
  int maxBytesToRead=buffer.length;
  if (totalBytesRead < splitLength) {
    maxBytesToRead=Math.min(maxBytesToRead,(int)(splitLength - totalBytesRead));
  }
  int bytesRead=in.read(buffer,0,maxBytesToRead);
  lastBytesRead=bytesRead;
  if (totalBytesRead == splitLength && inDelimiter && bytesRead > 0) {
    if (usingCRLF) {
      needAdditionalRecord=(buffer[0] != '\n');
    }
 else {
      needAdditionalRecord=true;
    }
  }
  if (bytesRead > 0) {
    totalBytesRead+=bytesRead;
  }
  return bytesRead;
}
