{
  int maxBytesToRead=buffer.length;
  if (totalBytesRead < splitLength) {
    long leftBytesForSplit=splitLength - totalBytesRead;
    if (leftBytesForSplit <= Integer.MAX_VALUE) {
      maxBytesToRead=Math.min(maxBytesToRead,(int)leftBytesForSplit);
    }
  }
  int bytesRead=in.read(buffer,0,maxBytesToRead);
  if (totalBytesRead == splitLength && inDelimiter && bytesRead > 0) {
    if (usingCRLF) {
      needAdditionalRecord=(buffer[0] != '\n');
    }
 else {
      needAdditionalRecord=true;
    }
  }
  if (bytesRead > 0) {
    totalBytesRead+=bytesRead;
  }
  return bytesRead;
}
