{
  String currentBpId="";
  boolean firstRun=true;
  while (datanode.shouldRun && !Thread.interrupted()) {
    if (!firstRun) {
      try {
        Thread.sleep(SLEEP_PERIOD_MS);
      }
 catch (      InterruptedException ex) {
        blockScannerThread.interrupt();
        continue;
      }
    }
 else {
      firstRun=false;
    }
    BlockPoolSliceScanner bpScanner=getNextBPScanner(currentBpId);
    if (bpScanner == null) {
      continue;
    }
    currentBpId=bpScanner.getBlockPoolId();
    if (!datanode.isBPServiceAlive(currentBpId)) {
      LOG.warn("Block Pool " + currentBpId + " is not alive");
      removeBlockPool(currentBpId);
      continue;
    }
    bpScanner.scanBlockPoolSlice();
  }
  for (  BlockPoolSliceScanner bpss : blockPoolScannerMap.values()) {
    bpss.shutdown();
  }
}
