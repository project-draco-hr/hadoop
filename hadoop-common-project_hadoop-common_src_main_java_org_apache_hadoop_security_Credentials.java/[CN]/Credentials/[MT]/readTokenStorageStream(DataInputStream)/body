{
  byte[] magic=new byte[TOKEN_STORAGE_MAGIC.length];
  in.readFully(magic);
  if (!Arrays.equals(magic,TOKEN_STORAGE_MAGIC)) {
    throw new IOException("Bad header found in token storage.");
  }
  byte version=in.readByte();
  if (version != TOKEN_STORAGE_VERSION) {
    throw new IOException("Unknown version " + version + " in token storage.");
  }
  readFields(in);
}
