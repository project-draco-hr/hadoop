{
{
    long now=System.currentTimeMillis();
    String[] users=new String[]{"foo","bar"};
    final Configuration conf=new Configuration();
    FileSystem[] fs=new FileSystem[users.length];
    for (int i=0; i < users.length; i++) {
      UserGroupInformation ugi=UserGroupInformation.createRemoteUser(users[i]);
      fs[i]=ugi.doAs(new PrivilegedExceptionAction<FileSystem>(){
        public FileSystem run() throws IOException {
          return FileSystem.get(conf);
        }
      }
);
      for (int j=0; j < i; j++) {
        assertFalse(fs[j] == fs[i]);
      }
    }
    FileSystem.closeAll();
  }
{
    try {
      runTestCache(DFSConfigKeys.DFS_NAMENODE_RPC_PORT_DEFAULT);
    }
 catch (    java.net.BindException be) {
      LOG.warn("Cannot test NameNode's default RPC port (=" + DFSConfigKeys.DFS_NAMENODE_RPC_PORT_DEFAULT + ")",be);
    }
    runTestCache(0);
  }
}
