{
  LogCapturer logs=GenericTestUtils.LogCapturer.captureLogs(LogFactory.getLog(DataStreamer.class));
  byte[] toWrite=new byte[PACKET_SIZE];
  new Random(1).nextBytes(toWrite);
  final Path path=new Path("/file1");
  final DistributedFileSystem dfs=cluster.getFileSystem();
  FSDataOutputStream out=null;
  out=dfs.create(path,false);
  out.write(toWrite);
  out.write(toWrite);
  out.hflush();
  Thread.sleep(15 * 1000);
  out.write(toWrite);
  out.write(toWrite);
  out.hflush();
  Thread.sleep(5 * 1000);
  out.close();
  logs.stopCapturing();
  GenericTestUtils.assertDoesNotMatch(logs.getOutput(),"Slow ReadProcessor read fields for block");
}
