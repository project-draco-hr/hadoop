{
  AuthenticationToken token;
  String delegationParam=request.getParameter(TimelineAuthenticationConsts.DELEGATION_PARAM);
  if (delegationParam != null) {
    Token<TimelineDelegationTokenIdentifier> dt=new Token<TimelineDelegationTokenIdentifier>();
    dt.decodeFromUrlString(delegationParam);
    TimelineDelegationTokenSecretManagerService secretManager=AHSWebApp.getInstance().getTimelineDelegationTokenSecretManagerService();
    UserGroupInformation ugi=secretManager.verifyToken(dt);
    final String shortName=ugi.getShortUserName();
    token=new AuthenticationToken(shortName,ugi.getUserName(),getType());
    token.setExpires(0);
  }
 else {
    token=super.authenticate(request,response);
  }
  return token;
}
