{
  Path src=srcStatus.getPath();
  dst=checkDest(src.getName(),dstFS,dst,overwrite);
  if (srcStatus.isDirectory()) {
    checkDependencies(srcFS,src,dstFS,dst);
    if (!dstFS.mkdirs(dst)) {
      return false;
    }
    FileStatus contents[]=srcFS.listStatus(src);
    for (int i=0; i < contents.length; i++) {
      copy(srcFS,contents[i],dstFS,new Path(dst,contents[i].getPath().getName()),deleteSource,overwrite,conf);
    }
  }
 else {
    InputStream in=null;
    OutputStream out=null;
    try {
      in=srcFS.open(src);
      out=dstFS.create(dst,overwrite);
      IOUtils.copyBytes(in,out,conf,true);
    }
 catch (    IOException e) {
      IOUtils.closeStream(out);
      IOUtils.closeStream(in);
      throw e;
    }
  }
  if (deleteSource) {
    return srcFS.delete(src,true);
  }
 else {
    return true;
  }
}
