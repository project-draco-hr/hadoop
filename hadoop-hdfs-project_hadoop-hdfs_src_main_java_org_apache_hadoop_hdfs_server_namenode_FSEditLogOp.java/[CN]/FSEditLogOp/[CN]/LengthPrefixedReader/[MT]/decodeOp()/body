{
  long txid=decodeOpFrame();
  if (txid == HdfsServerConstants.INVALID_TXID) {
    return null;
  }
  in.reset();
  in.mark(maxOpSize);
  FSEditLogOpCodes opCode=FSEditLogOpCodes.fromByte(in.readByte());
  FSEditLogOp op=cache.get(opCode);
  if (op == null) {
    throw new IOException("Read invalid opcode " + opCode);
  }
  op.setTransactionId(txid);
  IOUtils.skipFully(in,4 + 8);
  op.readFields(in,logVersion);
  IOUtils.skipFully(in,CHECKSUM_LENGTH);
  return op;
}
