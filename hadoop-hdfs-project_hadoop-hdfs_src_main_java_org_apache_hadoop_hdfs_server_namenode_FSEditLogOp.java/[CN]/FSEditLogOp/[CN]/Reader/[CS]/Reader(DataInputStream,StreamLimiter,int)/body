{
  this.logVersion=logVersion;
  if (NameNodeLayoutVersion.supports(LayoutVersion.Feature.EDITS_CHESKUM,logVersion)) {
    this.checksum=new PureJavaCrc32();
  }
 else {
    this.checksum=null;
  }
  this.supportEditLogLength=NameNodeLayoutVersion.supports(NameNodeLayoutVersion.Feature.EDITLOG_LENGTH,logVersion) || logVersion < NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION;
  if (this.checksum != null) {
    this.in=new DataInputStream(new CheckedInputStream(in,this.checksum));
  }
 else {
    this.in=in;
  }
  this.limiter=limiter;
  this.cache=new OpInstanceCache();
  this.maxOpSize=DFSConfigKeys.DFS_NAMENODE_MAX_OP_SIZE_DEFAULT;
}
