{
  if (checksum != null) {
    checksum.reset();
  }
  in.mark(1);
  byte opCodeByte;
  try {
    opCodeByte=in.readByte();
  }
 catch (  EOFException eof) {
    return null;
  }
  FSEditLogOpCodes opCode=FSEditLogOpCodes.fromByte(opCodeByte);
  if (opCode == OP_INVALID) {
    in.reset();
    return null;
  }
  FSEditLogOp op=opInstances.get().get(opCode);
  if (op == null) {
    throw new IOException("Read invalid opcode " + opCode);
  }
  if (LayoutVersion.supports(Feature.STORED_TXIDS,logVersion)) {
    op.setTransactionId(in.readLong());
  }
  op.readFields(in,logVersion);
  validateChecksum(in,checksum,op.txid);
  return op;
}
