{
  if (supportEditLogLength) {
    limiter.setLimit(maxOpSize);
    in.mark(maxOpSize);
    final byte opCodeByte;
    try {
      opCodeByte=in.readByte();
    }
 catch (    EOFException e) {
      return HdfsConstants.INVALID_TXID;
    }
    FSEditLogOpCodes opCode=FSEditLogOpCodes.fromByte(opCodeByte);
    if (opCode == OP_INVALID) {
      verifyTerminator();
      return HdfsConstants.INVALID_TXID;
    }
    int length=in.readInt();
    long txid=in.readLong();
    IOUtils.skipFully(in,length - 8);
    return txid;
  }
 else {
    FSEditLogOp op=decodeOp();
    return op == null ? HdfsConstants.INVALID_TXID : op.getTransactionId();
  }
}
