{
  assertEquals(expectedReplicas.size(),decodedBlocks.getNumberOfBlocks());
  Map<Long,Replica> reportReplicas=new HashMap<>(expectedReplicas);
  for (  BlockReportReplica replica : decodedBlocks) {
    assertNotNull(replica);
    Replica expected=reportReplicas.remove(replica.getBlockId());
    assertNotNull(expected);
    assertEquals("wrong bytes",expected.getNumBytes(),replica.getNumBytes());
    assertEquals("wrong genstamp",expected.getGenerationStamp(),replica.getGenerationStamp());
    assertEquals("wrong replica state",expected.getState(),replica.getState());
  }
  assertTrue(reportReplicas.isEmpty());
}
