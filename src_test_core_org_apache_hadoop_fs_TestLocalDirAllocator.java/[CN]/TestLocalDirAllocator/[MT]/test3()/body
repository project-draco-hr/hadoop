{
  if (isWindows)   return;
  try {
    conf.set(CONTEXT,BUFFER_DIR[3] + "," + BUFFER_DIR[4]);
    assertTrue(localFs.mkdirs(BUFFER_PATH[3]));
    assertTrue(localFs.mkdirs(BUFFER_PATH[4]));
    createTempFile(SMALL_FILE_SIZE);
    int nextDirIdx=(dirAllocator.getCurrentDirectoryIndex() == 0) ? 3 : 4;
    validateTempDirCreation(nextDirIdx);
    new File(BUFFER_DIR[4]).setReadOnly();
    validateTempDirCreation(3);
    validateTempDirCreation(3);
  }
  finally {
    rmBufferDirs();
  }
}
