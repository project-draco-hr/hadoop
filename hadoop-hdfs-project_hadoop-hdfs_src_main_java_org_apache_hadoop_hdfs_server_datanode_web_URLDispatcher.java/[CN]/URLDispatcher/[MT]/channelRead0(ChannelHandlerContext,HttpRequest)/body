{
  String uri=req.getUri();
  ChannelPipeline p=ctx.pipeline();
  if (uri.startsWith(WEBHDFS_PREFIX)) {
    WebHdfsHandler h=new WebHdfsHandler(conf,confForCreate);
    p.replace(this,WebHdfsHandler.class.getSimpleName(),h);
    h.channelRead0(ctx,req);
  }
 else {
    SimpleHttpProxyHandler h=new SimpleHttpProxyHandler(proxyHost);
    p.replace(this,SimpleHttpProxyHandler.class.getSimpleName(),h);
    h.channelRead0(ctx,req);
  }
}
