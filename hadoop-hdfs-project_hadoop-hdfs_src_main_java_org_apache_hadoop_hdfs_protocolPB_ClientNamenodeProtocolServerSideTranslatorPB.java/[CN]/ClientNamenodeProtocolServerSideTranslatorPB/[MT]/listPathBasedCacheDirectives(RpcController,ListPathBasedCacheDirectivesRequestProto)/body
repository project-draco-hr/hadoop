{
  try {
    PathBasedCacheDirective filter=PBHelper.convert(request.getFilter());
    RemoteIterator<PathBasedCacheDirective> iter=server.listPathBasedCacheDirectives(request.getPrevId(),filter);
    ListPathBasedCacheDirectivesResponseProto.Builder builder=ListPathBasedCacheDirectivesResponseProto.newBuilder();
    long prevId=0;
    while (iter.hasNext()) {
      PathBasedCacheDirective directive=iter.next();
      builder.addElements(ListPathBasedCacheDirectivesElementProto.newBuilder().setInfo(PBHelper.convert(directive)));
      prevId=directive.getId();
    }
    if (prevId == 0) {
      builder.setHasMore(false);
    }
 else {
      iter=server.listPathBasedCacheDirectives(prevId,filter);
      builder.setHasMore(iter.hasNext());
    }
    return builder.build();
  }
 catch (  IOException e) {
    throw new ServiceException(e);
  }
}
