{
  try {
    RemoteIterator<CachePool> iter=server.listCachePools(PBHelper.convert(request.getPrevPool()).getId(),request.getMaxReplies());
    ListCachePoolsResponseProto.Builder responseBuilder=ListCachePoolsResponseProto.newBuilder();
    while (iter.hasNext()) {
      CachePool pool=iter.next();
      ListCachePoolsResponseElementProto.Builder elemBuilder=ListCachePoolsResponseElementProto.newBuilder();
      elemBuilder.setPool(PBHelper.convert(pool));
      responseBuilder.addElements(elemBuilder.build());
    }
    return responseBuilder.build();
  }
 catch (  IOException e) {
    throw new ServiceException(e);
  }
}
