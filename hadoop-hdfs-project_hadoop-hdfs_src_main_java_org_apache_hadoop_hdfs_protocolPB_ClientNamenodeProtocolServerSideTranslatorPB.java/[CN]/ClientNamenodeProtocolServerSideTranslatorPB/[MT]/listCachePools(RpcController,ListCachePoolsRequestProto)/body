{
  try {
    RemoteIterator<CachePoolInfo> iter=server.listCachePools(request.getPrevPoolName(),request.getMaxReplies());
    ListCachePoolsResponseProto.Builder responseBuilder=ListCachePoolsResponseProto.newBuilder();
    while (iter.hasNext()) {
      CachePoolInfo pool=iter.next();
      ListCachePoolsResponseElementProto.Builder elemBuilder=ListCachePoolsResponseElementProto.newBuilder();
      elemBuilder.setPoolName(pool.getPoolName());
      if (pool.getOwnerName() != null) {
        elemBuilder.setOwnerName(pool.getOwnerName());
      }
      if (pool.getGroupName() != null) {
        elemBuilder.setGroupName(pool.getGroupName());
      }
      if (pool.getMode() != null) {
        elemBuilder.setMode(pool.getMode());
      }
      if (pool.getWeight() != null) {
        elemBuilder.setWeight(pool.getWeight());
      }
      responseBuilder.addElements(elemBuilder.build());
    }
    return responseBuilder.build();
  }
 catch (  IOException e) {
    throw new ServiceException(e);
  }
}
