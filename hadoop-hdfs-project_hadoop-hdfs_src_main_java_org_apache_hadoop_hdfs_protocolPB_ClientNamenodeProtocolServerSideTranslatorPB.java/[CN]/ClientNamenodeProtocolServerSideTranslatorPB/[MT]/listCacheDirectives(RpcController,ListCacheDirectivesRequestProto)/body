{
  try {
    CacheDirectiveInfo filter=PBHelper.convert(request.getFilter());
    RemoteIterator<CacheDirectiveEntry> iter=server.listCacheDirectives(request.getPrevId(),filter);
    ListCacheDirectivesResponseProto.Builder builder=ListCacheDirectivesResponseProto.newBuilder();
    long prevId=0;
    while (iter.hasNext()) {
      CacheDirectiveEntry entry=iter.next();
      builder.addElements(PBHelper.convert(entry));
      prevId=entry.getInfo().getId();
    }
    if (prevId == 0) {
      builder.setHasMore(false);
    }
 else {
      iter=server.listCacheDirectives(prevId,filter);
      builder.setHasMore(iter.hasNext());
    }
    return builder.build();
  }
 catch (  IOException e) {
    throw new ServiceException(e);
  }
}
