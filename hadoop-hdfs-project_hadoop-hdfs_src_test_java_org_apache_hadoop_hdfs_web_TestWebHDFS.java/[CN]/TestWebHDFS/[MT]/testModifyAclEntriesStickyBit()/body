{
  FileSystem.mkdirs(testFs,tmpPath,FsPermission.createImmutable((short)01750));
  List<AclEntry> aclSpec=Lists.newArrayList(aclEntry(ACCESS,USER,ALL),aclEntry(ACCESS,USER,"foo",ALL),aclEntry(ACCESS,GROUP,READ_EXECUTE),aclEntry(ACCESS,OTHER,NONE),aclEntry(DEFAULT,USER,"foo",ALL));
  testFs.setAcl(tmpPath,aclSpec);
  aclSpec=Lists.newArrayList(aclEntry(ACCESS,USER,"foo",READ_EXECUTE),aclEntry(DEFAULT,USER,"foo",READ_EXECUTE));
  testFs.modifyAclEntries(tmpPath,aclSpec);
  AclStatus s=testFs.getAclStatus(tmpPath);
  AclEntry[] returned=s.getEntries().toArray(new AclEntry[0]);
  assertArrayEquals(new AclEntry[]{aclEntry(ACCESS,USER,"foo",READ_EXECUTE),aclEntry(ACCESS,GROUP,READ_EXECUTE),aclEntry(DEFAULT,USER,ALL),aclEntry(DEFAULT,USER,"foo",READ_EXECUTE),aclEntry(DEFAULT,GROUP,READ_EXECUTE),aclEntry(DEFAULT,MASK,READ_EXECUTE),aclEntry(DEFAULT,OTHER,NONE)},returned);
}
