{
  MRApp app=new MockFirstFailingAttemptMRApp(1,0);
  Configuration conf=new Configuration();
  conf.setBoolean(MRJobConfig.JOB_UBERTASK_ENABLE,false);
  Job job=app.submit(conf);
  app.waitForState(job,JobState.SUCCEEDED);
  Map<TaskId,Task> tasks=job.getTasks();
  Assert.assertEquals("Num tasks is not correct",1,tasks.size());
  Task task=tasks.values().iterator().next();
  Assert.assertEquals("Task state not correct",TaskState.SUCCEEDED,task.getReport().getTaskState());
  Map<TaskAttemptId,TaskAttempt> attempts=tasks.values().iterator().next().getAttempts();
  Assert.assertEquals("Num attempts is not correct",2,attempts.size());
  Iterator<TaskAttempt> it=attempts.values().iterator();
  Assert.assertEquals("Attempt state not correct",TaskAttemptState.FAILED,it.next().getReport().getTaskAttemptState());
  Assert.assertEquals("Attempt state not correct",TaskAttemptState.SUCCEEDED,it.next().getReport().getTaskAttemptState());
}
