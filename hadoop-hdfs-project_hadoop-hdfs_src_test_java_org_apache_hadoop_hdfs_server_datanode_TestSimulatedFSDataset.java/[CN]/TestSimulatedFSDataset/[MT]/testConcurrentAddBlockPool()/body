{
  final String[] bpids={"BP-TEST1-","BP-TEST2-"};
  final SimulatedFSDataset fsdataset=new SimulatedFSDataset(null,conf);
class AddBlockPoolThread extends Thread {
    private int id;
    private IOException ioe;
    public AddBlockPoolThread(    int id){
      super();
      this.id=id;
    }
    public void test() throws InterruptedException, IOException {
      this.join();
      if (ioe != null) {
        throw ioe;
      }
    }
    public void run(){
      for (int i=0; i < 10000; i++) {
        String newbpid=bpids[id] + i;
        fsdataset.addBlockPool(newbpid,conf);
        ExtendedBlock block=new ExtendedBlock(newbpid,1);
        try {
          fsdataset.createTemporary(StorageType.DEFAULT,block);
        }
 catch (        IOException ioe) {
          this.ioe=ioe;
        }
        assert(fsdataset.getReplicaString(newbpid,1) != "null");
      }
    }
  }
  ;
  AddBlockPoolThread t1=new AddBlockPoolThread(0);
  AddBlockPoolThread t2=new AddBlockPoolThread(1);
  t1.start();
  t2.start();
  t1.test();
  t2.test();
}
