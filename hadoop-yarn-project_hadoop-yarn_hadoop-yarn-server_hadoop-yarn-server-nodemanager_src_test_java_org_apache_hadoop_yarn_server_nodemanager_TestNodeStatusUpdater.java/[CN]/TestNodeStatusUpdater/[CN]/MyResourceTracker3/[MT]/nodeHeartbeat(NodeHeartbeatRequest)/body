{
  LOG.info("Got heartBeatId: [" + heartBeatID + "]");
  NodeStatus nodeStatus=request.getNodeStatus();
  nodeStatus.setResponseId(heartBeatID++);
  NodeHeartbeatResponse nhResponse=YarnServerBuilderUtils.newNodeHeartbeatResponse(heartBeatID,heartBeatNodeAction,null,null,null,null,1000L);
  if (nodeStatus.getKeepAliveApplications() != null && nodeStatus.getKeepAliveApplications().size() > 0) {
    for (    ApplicationId appId : nodeStatus.getKeepAliveApplications()) {
      List<Long> list=keepAliveRequests.get(appId);
      if (list == null) {
        list=new LinkedList<Long>();
        keepAliveRequests.put(appId,list);
      }
      list.add(System.currentTimeMillis());
    }
  }
  if (heartBeatID == 2) {
    LOG.info("Sending FINISH_APP for application: [" + appId + "]");
    this.context.getApplications().put(appId,mock(Application.class));
    nhResponse.addAllApplicationsToCleanup(Collections.singletonList(appId));
  }
  return nhResponse;
}
