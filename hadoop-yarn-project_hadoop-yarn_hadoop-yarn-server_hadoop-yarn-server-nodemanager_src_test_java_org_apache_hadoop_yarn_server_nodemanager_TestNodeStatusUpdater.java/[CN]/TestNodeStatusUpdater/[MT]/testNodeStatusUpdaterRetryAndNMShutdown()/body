{
  final long connectionWaitSecs=1;
  final long connectionRetryIntervalSecs=1;
  YarnConfiguration conf=createNMConfig();
  conf.setLong(YarnConfiguration.RESOURCEMANAGER_CONNECT_MAX_WAIT_SECS,connectionWaitSecs);
  conf.setLong(YarnConfiguration.RESOURCEMANAGER_CONNECT_RETRY_INTERVAL_SECS,connectionRetryIntervalSecs);
  CyclicBarrier syncBarrier=new CyclicBarrier(2);
  nm=new MyNodeManager2(syncBarrier,conf);
  nm.init(conf);
  nm.start();
  try {
    syncBarrier.await(10000,TimeUnit.MILLISECONDS);
  }
 catch (  Exception e) {
  }
  Assert.assertTrue(((MyNodeManager2)nm).isStopped);
  Assert.assertTrue("calculate heartBeatCount based on" + " connectionWaitSecs and RetryIntervalSecs",heartBeatID == 2);
}
