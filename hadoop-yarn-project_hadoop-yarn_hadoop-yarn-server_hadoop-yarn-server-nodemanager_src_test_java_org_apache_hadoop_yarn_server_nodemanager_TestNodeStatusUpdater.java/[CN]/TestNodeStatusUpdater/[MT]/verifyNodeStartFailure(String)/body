{
  Assert.assertNotNull("nm is null",nm);
  YarnConfiguration conf=createNMConfig();
  nm.init(conf);
  try {
    nm.start();
    Assert.fail("NM should have failed to start. Didn't get exception!!");
  }
 catch (  Exception e) {
    if (!e.getMessage().contains(errMessage)) {
      throw e;
    }
  }
  Assert.assertEquals("NM state is wrong!",STATE.STOPPED,nm.getServiceState());
  Assert.assertEquals("Number of registered nodes is wrong!",0,this.registeredNodes.size());
}
