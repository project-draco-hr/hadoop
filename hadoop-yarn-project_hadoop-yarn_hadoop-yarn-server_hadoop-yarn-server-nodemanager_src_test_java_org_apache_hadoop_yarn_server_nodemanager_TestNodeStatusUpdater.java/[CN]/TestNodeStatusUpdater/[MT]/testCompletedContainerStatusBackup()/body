{
  nm=new NodeManager(){
    @Override protected NodeStatusUpdater createNodeStatusUpdater(    Context context,    Dispatcher dispatcher,    NodeHealthCheckerService healthChecker){
      MyNodeStatusUpdater2 myNodeStatusUpdater=new MyNodeStatusUpdater2(context,dispatcher,healthChecker,metrics);
      return myNodeStatusUpdater;
    }
    @Override protected NMContext createNMContext(    NMContainerTokenSecretManager containerTokenSecretManager,    NMTokenSecretManagerInNM nmTokenSecretManager){
      return new MyNMContext(containerTokenSecretManager,nmTokenSecretManager);
    }
  }
;
  YarnConfiguration conf=createNMConfig();
  nm.init(conf);
  nm.start();
  int waitCount=0;
  while (heartBeatID <= 3 && waitCount++ != 20) {
    Thread.sleep(500);
  }
  if (!containerStatusBackupSuccessfully) {
    Assert.fail("ContainerStatus Backup failed");
  }
  nm.stop();
}
