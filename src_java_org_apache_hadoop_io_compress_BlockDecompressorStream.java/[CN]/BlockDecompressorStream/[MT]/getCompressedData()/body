{
  checkStream();
  int len=rawReadInt();
  if (len > buffer.length) {
    buffer=new byte[len];
  }
  int n=0, off=0;
  while (n < len) {
    int count=in.read(buffer,off + n,len - n);
    if (count < 0) {
      throw new EOFException("Unexpected end of block in input stream");
    }
    n+=count;
  }
  return len;
}
