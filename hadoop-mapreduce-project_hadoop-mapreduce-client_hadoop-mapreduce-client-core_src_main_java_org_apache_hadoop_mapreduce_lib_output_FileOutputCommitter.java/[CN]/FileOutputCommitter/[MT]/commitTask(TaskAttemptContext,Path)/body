{
  TaskAttemptID attemptId=context.getTaskAttemptID();
  if (hasOutputPath()) {
    context.progress();
    if (taskAttemptPath == null) {
      taskAttemptPath=getTaskAttemptPath(context);
    }
    Path committedTaskPath=getCommittedTaskPath(context);
    FileSystem fs=taskAttemptPath.getFileSystem(context.getConfiguration());
    if (fs.exists(taskAttemptPath)) {
      if (fs.exists(committedTaskPath)) {
        if (!fs.delete(committedTaskPath,true)) {
          throw new IOException("Could not delete " + committedTaskPath);
        }
      }
      if (!fs.rename(taskAttemptPath,committedTaskPath)) {
        throw new IOException("Could not rename " + taskAttemptPath + " to "+ committedTaskPath);
      }
      LOG.info("Saved output of task '" + attemptId + "' to "+ committedTaskPath);
    }
 else {
      LOG.warn("No Output found for " + attemptId);
    }
  }
 else {
    LOG.warn("Output Path is null in commitTask()");
  }
}
