{
  LOG.debug("Merging data from " + from + " to "+ to);
  if (from.isFile()) {
    if (fs.exists(to)) {
      if (!fs.delete(to,true)) {
        throw new IOException("Failed to delete " + to);
      }
    }
    if (!fs.rename(from.getPath(),to)) {
      throw new IOException("Failed to rename " + from + " to "+ to);
    }
  }
 else   if (from.isDirectory()) {
    if (fs.exists(to)) {
      FileStatus toStat=fs.getFileStatus(to);
      if (!toStat.isDirectory()) {
        if (!fs.delete(to,true)) {
          throw new IOException("Failed to delete " + to);
        }
        if (!fs.rename(from.getPath(),to)) {
          throw new IOException("Failed to rename " + from + " to "+ to);
        }
      }
 else {
        for (        FileStatus subFrom : fs.listStatus(from.getPath())) {
          Path subTo=new Path(to,subFrom.getPath().getName());
          mergePaths(fs,subFrom,subTo);
        }
      }
    }
 else {
      if (!fs.rename(from.getPath(),to)) {
        throw new IOException("Failed to rename " + from + " to "+ to);
      }
    }
  }
}
