{
  if (hasOutputPath()) {
    Path finalOutput=getOutputPath();
    FileSystem fs=finalOutput.getFileSystem(context.getConfiguration());
    if (algorithmVersion == 1) {
      for (      FileStatus stat : getAllCommittedTaskPaths(context)) {
        mergePaths(fs,stat,finalOutput);
      }
    }
    cleanupJob(context);
    if (context.getConfiguration().getBoolean(SUCCESSFUL_JOB_OUTPUT_DIR_MARKER,true)) {
      Path markerPath=new Path(outputPath,SUCCEEDED_FILE_NAME);
      fs.create(markerPath).close();
    }
  }
 else {
    LOG.warn("Output Path is null in commitJob()");
  }
}
