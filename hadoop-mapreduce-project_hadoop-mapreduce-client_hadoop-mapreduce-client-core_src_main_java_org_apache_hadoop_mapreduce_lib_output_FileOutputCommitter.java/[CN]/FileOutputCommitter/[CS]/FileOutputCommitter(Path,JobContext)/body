{
  Configuration conf=context.getConfiguration();
  algorithmVersion=conf.getInt(FILEOUTPUTCOMMITTER_ALGORITHM_VERSION,FILEOUTPUTCOMMITTER_ALGORITHM_VERSION_DEFAULT);
  LOG.info("File Output Committer Algorithm version is " + algorithmVersion);
  if (algorithmVersion != 1 && algorithmVersion != 2) {
    throw new IOException("Only 1 or 2 algorithm version is supported");
  }
  skipCleanup=conf.getBoolean(FILEOUTPUTCOMMITTER_CLEANUP_SKIPPED,FILEOUTPUTCOMMITTER_CLEANUP_SKIPPED_DEFAULT);
  ignoreCleanupFailures=conf.getBoolean(FILEOUTPUTCOMMITTER_CLEANUP_FAILURES_IGNORED,FILEOUTPUTCOMMITTER_CLEANUP_FAILURES_IGNORED_DEFAULT);
  LOG.info("FileOutputCommitter skip cleanup _temporary folders under " + "output directory:" + skipCleanup + ", ignore cleanup failures: "+ ignoreCleanupFailures);
  if (outputPath != null) {
    FileSystem fs=outputPath.getFileSystem(context.getConfiguration());
    this.outputPath=fs.makeQualified(outputPath);
  }
}
