{
  this.id=ID.incrementAndGet();
  this.mapId=mapId;
  this.merger=merger;
  type=Type.DISK;
  memory=null;
  byteStream=null;
  this.size=size;
  this.localFS=FileSystem.getLocal(conf);
  String filename="map_" + mapId.getTaskID().getId() + ".out";
  String tmpOutput=Path.SEPARATOR + TaskTracker.getJobCacheSubdir(conf.getUser()) + Path.SEPARATOR+ mapId.getJobID()+ Path.SEPARATOR+ merger.getReduceId()+ Path.SEPARATOR+ "output"+ Path.SEPARATOR+ filename+ "."+ fetcher;
  tmpOutputPath=localDirAllocator.getLocalPathForWrite(tmpOutput,size,conf);
  outputPath=new Path(tmpOutputPath.getParent(),filename);
  disk=localFS.create(tmpOutputPath);
  this.primaryMapOutput=primaryMapOutput;
}
