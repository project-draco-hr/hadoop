{
  long dfsBytes=blockFile.length() + metaFile.length();
  if (!blockFile.delete() || (!metaFile.delete() && metaFile.exists())) {
    DataNode.LOG.warn("Unexpected error trying to delete block " + block.getBlockPoolId() + " "+ block.getLocalBlock().toString()+ " at file "+ blockFile+ ". Ignored.");
  }
 else {
    if (block.getLocalBlock().getNumBytes() != BlockCommand.NO_ACK) {
      dataset.notifyNamenodeDeletedBlock(block);
    }
    volume.decDfsUsed(block.getBlockPoolId(),dfsBytes);
    DataNode.LOG.info("Deleted block " + block.getBlockPoolId() + " "+ block.getLocalBlock().toString()+ " at file "+ blockFile);
  }
}
