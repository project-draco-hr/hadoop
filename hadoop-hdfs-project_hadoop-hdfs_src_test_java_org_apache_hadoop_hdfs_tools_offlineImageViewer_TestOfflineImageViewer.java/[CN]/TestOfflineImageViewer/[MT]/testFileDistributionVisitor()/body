{
  StringWriter output=new StringWriter();
  PrintWriter o=new PrintWriter(output);
  new FileDistributionCalculator(new Configuration(),0,0,o).visit(new RandomAccessFile(originalFsimage,"r"));
  o.close();
  Pattern p=Pattern.compile("totalFiles = (\\d+)\n");
  Matcher matcher=p.matcher(output.getBuffer());
  assertTrue(matcher.find() && matcher.groupCount() == 1);
  int totalFiles=Integer.parseInt(matcher.group(1));
  assertEquals(totalFiles,NUM_DIRS * FILES_PER_DIR);
}
