def _authorize_client_ports(cluster, master, client_cidrs):
    if (not client_cidrs):
        logger.debug('No client CIDRs specified, using local address.')
        client_ip = url_get('http://checkip.amazonaws.com/').strip()
        client_cidrs = (('%s/32' % client_ip),)
    logger.debug('Client CIDRs: %s', client_cidrs)
    for client_cidr in client_cidrs:
        cluster.authorize_role(MASTER, 80, 80, client_cidr)
        cluster.authorize_role(MASTER, 50030, 50030, client_cidr)
    master_ip = socket.gethostbyname(master.public_ip)
    cluster.authorize_role(MASTER, 8020, 8021, ('%s/32' % master_ip))
