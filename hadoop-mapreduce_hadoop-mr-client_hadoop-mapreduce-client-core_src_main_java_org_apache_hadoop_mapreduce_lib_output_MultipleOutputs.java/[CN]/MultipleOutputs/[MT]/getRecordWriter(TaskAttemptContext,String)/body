{
  RecordWriter writer=recordWriters.get(baseFileName);
  if (writer == null) {
    FileOutputFormat.setOutputName(taskContext,baseFileName);
    try {
      writer=((OutputFormat)ReflectionUtils.newInstance(taskContext.getOutputFormatClass(),taskContext.getConfiguration())).getRecordWriter(taskContext);
    }
 catch (    ClassNotFoundException e) {
      throw new IOException(e);
    }
    if (countersEnabled) {
      writer=new RecordWriterWithCounter(writer,baseFileName,context);
    }
    recordWriters.put(baseFileName,writer);
  }
  return writer;
}
