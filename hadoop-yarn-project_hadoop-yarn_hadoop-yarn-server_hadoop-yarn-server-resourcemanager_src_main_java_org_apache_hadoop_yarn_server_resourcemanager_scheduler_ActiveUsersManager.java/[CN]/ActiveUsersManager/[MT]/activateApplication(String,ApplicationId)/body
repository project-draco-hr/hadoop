{
  Set<ApplicationId> userApps=usersApplications.get(user);
  if (userApps == null) {
    userApps=new HashSet<ApplicationId>();
    usersApplications.put(user,userApps);
    ++activeUsers;
    metrics.incrActiveUsers();
    LOG.debug("User " + user + " added to activeUsers, currently: "+ activeUsers);
  }
  if (userApps.add(applicationId)) {
    metrics.activateApp(user);
  }
}
