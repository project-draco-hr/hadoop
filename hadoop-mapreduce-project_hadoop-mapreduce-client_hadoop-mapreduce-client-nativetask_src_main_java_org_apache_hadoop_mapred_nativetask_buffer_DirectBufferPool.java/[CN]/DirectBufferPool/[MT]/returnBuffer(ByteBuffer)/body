{
  if (null == buffer || !buffer.isDirect()) {
    throw new IOException("the buffer is null or the buffer returned is not direct buffer");
  }
  buffer.clear();
  int capacity=buffer.capacity();
  Queue<WeakReference<ByteBuffer>> list=bufferMap.get(capacity);
  if (null == list) {
    list=new ConcurrentLinkedQueue<WeakReference<ByteBuffer>>();
    Queue<WeakReference<ByteBuffer>> prev=bufferMap.putIfAbsent(capacity,list);
    if (prev != null) {
      list=prev;
    }
  }
  list.add(new WeakReference<ByteBuffer>(buffer));
}
