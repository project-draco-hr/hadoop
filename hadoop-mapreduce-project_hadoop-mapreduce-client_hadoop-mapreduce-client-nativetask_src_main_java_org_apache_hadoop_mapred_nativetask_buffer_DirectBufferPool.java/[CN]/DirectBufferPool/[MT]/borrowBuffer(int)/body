{
  Queue<WeakReference<ByteBuffer>> list=bufferMap.get(capacity);
  if (null == list) {
    return ByteBuffer.allocateDirect(capacity);
  }
  WeakReference<ByteBuffer> ref;
  while ((ref=list.poll()) != null) {
    ByteBuffer buf=ref.get();
    if (buf != null) {
      return buf;
    }
  }
  return ByteBuffer.allocateDirect(capacity);
}
