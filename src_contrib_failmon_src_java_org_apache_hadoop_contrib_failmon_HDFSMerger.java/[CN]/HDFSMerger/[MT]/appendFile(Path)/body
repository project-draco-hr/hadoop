{
  FSDataInputStream anyInputFile=hdfs.open(inputPath);
  InputStream inputFile;
  byte buffer[]=new byte[4096];
  if (inputPath.toString().endsWith(LocalStore.COMPRESSION_SUFFIX)) {
    inputFile=new ZipInputStream(anyInputFile);
    ((ZipInputStream)inputFile).getNextEntry();
  }
 else {
    inputFile=anyInputFile;
  }
  try {
    int bytesRead=0;
    while ((bytesRead=inputFile.read(buffer)) > 0) {
      outputFile.write(buffer,0,bytesRead);
    }
  }
 catch (  IOException e) {
    Environment.logInfo("Error while copying file:" + inputPath.toString());
  }
 finally {
    inputFile.close();
  }
}
