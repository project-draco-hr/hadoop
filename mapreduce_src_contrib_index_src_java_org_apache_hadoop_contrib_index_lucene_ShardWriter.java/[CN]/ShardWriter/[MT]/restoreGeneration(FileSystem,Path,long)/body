{
  FileStatus[] fileStatus=fs.listStatus(perm,new PathFilter(){
    public boolean accept(    Path path){
      return LuceneUtil.isSegmentsFile(path.getName());
    }
  }
);
  for (int i=0; i < fileStatus.length; i++) {
    Path path=fileStatus[i].getPath();
    if (startGen < LuceneUtil.generationFromSegmentsFileName(path.getName())) {
      fs.delete(path,true);
    }
  }
  Path segmentsGenFile=new Path(LuceneUtil.IndexFileNames.SEGMENTS_GEN);
  if (fs.exists(segmentsGenFile)) {
    fs.delete(segmentsGenFile,true);
  }
}
