{
  final NodeId node=masterContainer.getNodeId();
  final InetSocketAddress containerManagerBindAddress=NetUtils.createSocketAddrForHost(node.getHost(),node.getPort());
  final YarnRPC rpc=YarnRPC.create(conf);
  UserGroupInformation currentUser=UserGroupInformation.createRemoteUser(containerId.toString());
  if (UserGroupInformation.isSecurityEnabled()) {
    Token<ContainerTokenIdentifier> token=ProtoUtils.convertFromProtoFormat(masterContainer.getContainerToken(),containerManagerBindAddress);
    currentUser.addToken(token);
  }
  return currentUser.doAs(new PrivilegedAction<ContainerManager>(){
    @Override public ContainerManager run(){
      return (ContainerManager)rpc.getProxy(ContainerManager.class,containerManagerBindAddress,conf);
    }
  }
);
}
