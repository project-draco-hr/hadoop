{
  final NodeId node=masterContainer.getNodeId();
  final InetSocketAddress containerManagerBindAddress=NetUtils.createSocketAddrForHost(node.getHost(),node.getPort());
  final YarnRPC rpc=YarnRPC.create(conf);
  UserGroupInformation currentUser=UserGroupInformation.createRemoteUser(containerId.toString());
  if (UserGroupInformation.isSecurityEnabled()) {
    Token<ContainerTokenIdentifier> token=ConverterUtils.convertFromYarn(masterContainer.getContainerToken(),containerManagerBindAddress);
    currentUser.addToken(token);
  }
  return currentUser.doAs(new PrivilegedAction<ContainerManagementProtocol>(){
    @Override public ContainerManagementProtocol run(){
      return (ContainerManagementProtocol)rpc.getProxy(ContainerManagementProtocol.class,containerManagerBindAddress,conf);
    }
  }
);
}
