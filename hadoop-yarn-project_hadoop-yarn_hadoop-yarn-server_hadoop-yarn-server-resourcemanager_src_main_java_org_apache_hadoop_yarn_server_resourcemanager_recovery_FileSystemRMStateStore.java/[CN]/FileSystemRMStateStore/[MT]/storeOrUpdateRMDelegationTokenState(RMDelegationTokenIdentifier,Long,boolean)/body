{
  Path nodeCreatePath=getNodePath(rmDTSecretManagerRoot,DELEGATION_TOKEN_PREFIX + identifier.getSequenceNumber());
  RMDelegationTokenIdentifierData identifierData=new RMDelegationTokenIdentifierData(identifier,renewDate);
  if (isUpdate) {
    LOG.info("Updating RMDelegationToken_" + identifier.getSequenceNumber());
    updateFile(nodeCreatePath,identifierData.toByteArray(),true);
  }
 else {
    LOG.info("Storing RMDelegationToken_" + identifier.getSequenceNumber());
    writeFileWithRetries(nodeCreatePath,identifierData.toByteArray(),true);
    Path latestSequenceNumberPath=getNodePath(rmDTSecretManagerRoot,DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX + identifier.getSequenceNumber());
    LOG.info("Storing " + DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX + identifier.getSequenceNumber());
    if (dtSequenceNumberPath == null) {
      if (!createFileWithRetries(latestSequenceNumberPath)) {
        throw new Exception("Failed to create " + latestSequenceNumberPath);
      }
    }
 else {
      if (!renameFileWithRetries(dtSequenceNumberPath,latestSequenceNumberPath)) {
        throw new Exception("Failed to rename " + dtSequenceNumberPath);
      }
    }
    dtSequenceNumberPath=latestSequenceNumberPath;
  }
}
