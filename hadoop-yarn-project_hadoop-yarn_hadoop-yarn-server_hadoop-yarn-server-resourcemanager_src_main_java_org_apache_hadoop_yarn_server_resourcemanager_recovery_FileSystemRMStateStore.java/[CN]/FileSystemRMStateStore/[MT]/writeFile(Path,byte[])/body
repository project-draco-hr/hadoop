{
  Path tempPath=new Path(outputPath.getParent(),outputPath.getName() + ".tmp");
  FSDataOutputStream fsOut=null;
  try {
    fsOut=fs.create(tempPath,true);
    fsOut.write(data);
    fsOut.close();
    fsOut=null;
    fs.rename(tempPath,outputPath);
  }
  finally {
    IOUtils.cleanup(LOG,fsOut);
  }
}
