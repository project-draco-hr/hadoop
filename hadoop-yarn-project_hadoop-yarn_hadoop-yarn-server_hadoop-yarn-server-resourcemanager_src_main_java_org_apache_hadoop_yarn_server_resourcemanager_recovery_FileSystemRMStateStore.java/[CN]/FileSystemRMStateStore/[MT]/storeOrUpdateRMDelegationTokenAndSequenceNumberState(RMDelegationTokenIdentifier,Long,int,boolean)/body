{
  Path nodeCreatePath=getNodePath(rmDTSecretManagerRoot,DELEGATION_TOKEN_PREFIX + identifier.getSequenceNumber());
  RMDelegationTokenIdentifierData identifierData=new RMDelegationTokenIdentifierData(identifier,renewDate);
  if (isUpdate) {
    LOG.info("Updating RMDelegationToken_" + identifier.getSequenceNumber());
    updateFile(nodeCreatePath,identifierData.toByteArray());
  }
 else {
    LOG.info("Storing RMDelegationToken_" + identifier.getSequenceNumber());
    writeFile(nodeCreatePath,identifierData.toByteArray());
  }
  Path latestSequenceNumberPath=getNodePath(rmDTSecretManagerRoot,DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX + latestSequenceNumber);
  LOG.info("Storing " + DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX + latestSequenceNumber);
  if (dtSequenceNumberPath == null) {
    if (!createFile(latestSequenceNumberPath)) {
      throw new Exception("Failed to create " + latestSequenceNumberPath);
    }
  }
 else {
    if (!renameFile(dtSequenceNumberPath,latestSequenceNumberPath)) {
      throw new Exception("Failed to rename " + dtSequenceNumberPath);
    }
  }
  dtSequenceNumberPath=latestSequenceNumberPath;
}
