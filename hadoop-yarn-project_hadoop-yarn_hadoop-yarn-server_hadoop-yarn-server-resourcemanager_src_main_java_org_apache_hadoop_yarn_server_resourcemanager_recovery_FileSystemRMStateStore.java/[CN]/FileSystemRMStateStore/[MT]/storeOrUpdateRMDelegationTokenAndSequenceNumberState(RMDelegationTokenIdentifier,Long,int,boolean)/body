{
  Path nodeCreatePath=getNodePath(rmDTSecretManagerRoot,DELEGATION_TOKEN_PREFIX + identifier.getSequenceNumber());
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  DataOutputStream fsOut=new DataOutputStream(os);
  identifier.write(fsOut);
  fsOut.writeLong(renewDate);
  if (isUpdate) {
    LOG.info("Updating RMDelegationToken_" + identifier.getSequenceNumber());
    updateFile(nodeCreatePath,os.toByteArray());
  }
 else {
    LOG.info("Storing RMDelegationToken_" + identifier.getSequenceNumber());
    writeFile(nodeCreatePath,os.toByteArray());
  }
  fsOut.close();
  Path latestSequenceNumberPath=getNodePath(rmDTSecretManagerRoot,DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX + latestSequenceNumber);
  LOG.info("Storing " + DELEGATION_TOKEN_SEQUENCE_NUMBER_PREFIX + latestSequenceNumber);
  if (dtSequenceNumberPath == null) {
    if (!createFile(latestSequenceNumberPath)) {
      throw new Exception("Failed to create " + latestSequenceNumberPath);
    }
  }
 else {
    if (!renameFile(dtSequenceNumberPath,latestSequenceNumberPath)) {
      throw new Exception("Failed to rename " + dtSequenceNumberPath);
    }
  }
  dtSequenceNumberPath=latestSequenceNumberPath;
}
