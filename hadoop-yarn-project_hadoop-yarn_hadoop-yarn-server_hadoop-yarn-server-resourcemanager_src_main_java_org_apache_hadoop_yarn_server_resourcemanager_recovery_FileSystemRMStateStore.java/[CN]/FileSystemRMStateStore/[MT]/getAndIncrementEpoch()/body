{
  Path epochNodePath=getNodePath(rootDirPath,EPOCH_NODE);
  long currentEpoch=0;
  FileStatus status=getFileStatusWithRetries(epochNodePath);
  if (status != null) {
    byte[] data=readFileWithRetries(epochNodePath,status.getLen());
    Epoch epoch=new EpochPBImpl(EpochProto.parseFrom(data));
    currentEpoch=epoch.getEpoch();
    byte[] storeData=Epoch.newInstance(currentEpoch + 1).getProto().toByteArray();
    updateFile(epochNodePath,storeData);
  }
 else {
    byte[] storeData=Epoch.newInstance(currentEpoch + 1).getProto().toByteArray();
    writeFileWithRetries(epochNodePath,storeData);
  }
  return currentEpoch;
}
