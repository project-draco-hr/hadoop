{
  thr=Thread.currentThread();
  FsPermission p=new FsPermission((short)0777);
  int i=0;
  while (!stopped) {
    try {
      String dirname="/thr-" + thr.getId() + "-dir-"+ i;
      if (i % 2 == 0) {
        Path dirnamePath=new Path(dirname);
        fs.mkdirs(dirnamePath);
        fs.delete(dirnamePath,true);
      }
 else {
        nn.mkdirs(dirname,p,true);
        nn.delete(dirname,true);
      }
    }
 catch (    SafeModeException sme) {
    }
catch (    Throwable e) {
      if (e instanceof RemoteException && ((RemoteException)e).getClassName().contains("SafeModeException")) {
        return;
      }
      LOG.warn("Got error in transaction thread",e);
      caught.compareAndSet(null,e);
      break;
    }
    i++;
  }
}
