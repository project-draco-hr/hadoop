{
  final Collection<URI> namenodes=DFSUtil.getInternalNsRpcUris(conf);
  Assert.assertEquals(1,namenodes.size());
  Map<URI,List<Path>> nnMap=Maps.newHashMap();
  for (  URI nn : namenodes) {
    nnMap.put(nn,null);
  }
  final List<NameNodeConnector> nncs=NameNodeConnector.newNameNodeConnectors(nnMap,Mover.class.getSimpleName(),Mover.MOVER_ID_PATH,conf,NameNodeConnector.DEFAULT_MAX_IDLE_ITERATIONS);
  return new Mover(nncs.get(0),conf,new AtomicInteger(0));
}
