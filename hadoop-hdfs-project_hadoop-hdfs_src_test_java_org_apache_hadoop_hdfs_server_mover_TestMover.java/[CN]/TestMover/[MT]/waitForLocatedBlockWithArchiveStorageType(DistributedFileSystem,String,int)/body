{
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      LocatedBlock lb=null;
      try {
        lb=dfs.getClient().getLocatedBlocks(file,0).get(0);
      }
 catch (      IOException e) {
        LOG.error("Exception while getting located blocks",e);
        return false;
      }
      int archiveCount=0;
      for (      StorageType storageType : lb.getStorageTypes()) {
        if (StorageType.ARCHIVE == storageType) {
          archiveCount++;
        }
      }
      LOG.info("Archive replica count, expected={} and actual={}",expectedArchiveCount,archiveCount);
      return expectedArchiveCount == archiveCount;
    }
  }
,100,3000);
}
