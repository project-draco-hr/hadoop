{
  final Configuration conf=new HdfsConfiguration();
  final MiniDFSCluster cluster=new MiniDFSCluster.Builder(new HdfsConfiguration()).nnTopology(MiniDFSNNTopology.simpleHATopology()).numDataNodes(0).build();
  HATestUtil.setFailoverConfigurations(cluster,conf,"MyCluster");
  try {
    Map<URI,List<Path>> movePaths=Mover.Cli.getNameNodePathsToMove(conf,"-p","/foo","/bar");
    Collection<URI> namenodes=DFSUtil.getNsServiceRpcUris(conf);
    Assert.assertEquals(1,namenodes.size());
    Assert.assertEquals(1,movePaths.size());
    URI nn=namenodes.iterator().next();
    Assert.assertEquals(new URI("hdfs://MyCluster"),nn);
    Assert.assertTrue(movePaths.containsKey(nn));
    checkMovePaths(movePaths.get(nn),new Path("/foo"),new Path("/bar"));
  }
  finally {
    cluster.shutdown();
  }
}
