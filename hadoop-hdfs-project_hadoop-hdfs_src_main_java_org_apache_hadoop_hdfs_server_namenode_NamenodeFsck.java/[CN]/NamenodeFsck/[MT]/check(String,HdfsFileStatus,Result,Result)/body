{
  String path=file.getFullName(parent);
  if (file.isDir()) {
    checkDir(path,replRes,ecRes);
    return;
  }
  if (file.isSymlink()) {
    if (showFiles) {
      out.println(path + " <symlink>");
    }
    totalSymlinks++;
    return;
  }
  LocatedBlocks blocks=getBlockLocations(path,file);
  if (blocks == null) {
    return;
  }
  final Result r=file.getErasureCodingPolicy() != null ? ecRes : replRes;
  collectFileSummary(path,file,r,blocks);
  if (showprogress && (replRes.totalFiles + ecRes.totalFiles) % 100 == 0) {
    out.println();
    out.flush();
  }
  collectBlocksSummary(parent,file,r,blocks);
}
