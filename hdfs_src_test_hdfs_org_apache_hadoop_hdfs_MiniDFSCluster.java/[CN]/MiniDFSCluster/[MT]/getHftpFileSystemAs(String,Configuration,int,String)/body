{
  final UserGroupInformation ugi=UserGroupInformation.createUserForTesting(username,groups);
  return ugi.doAs(new PrivilegedExceptionAction<HftpFileSystem>(){
    @Override public HftpFileSystem run() throws Exception {
      return getHftpFileSystem(nnIndex);
    }
  }
);
}
