{
  PlacementManager placementMgr=mock(PlacementManager.class);
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      ApplicationSubmissionContext ctx=(ApplicationSubmissionContext)invocation.getArguments()[0];
      ctx.setQueue("newQueue");
      return null;
    }
  }
).when(placementMgr).placeApplication(any(ApplicationSubmissionContext.class),any(String.class));
  rmContext.setQueuePlacementManager(placementMgr);
  asContext.setQueue("oldQueue");
  appMonitor.submitApplication(asContext,"test");
  RMApp app=rmContext.getRMApps().get(appId);
  Assert.assertNotNull("app is null",app);
  Assert.assertEquals("newQueue",asContext.getQueue());
  int timeoutSecs=0;
  while ((getAppEventType() == RMAppEventType.KILL) && timeoutSecs++ < 20) {
    Thread.sleep(1000);
  }
  Assert.assertEquals("app event type sent is wrong",RMAppEventType.START,getAppEventType());
}
