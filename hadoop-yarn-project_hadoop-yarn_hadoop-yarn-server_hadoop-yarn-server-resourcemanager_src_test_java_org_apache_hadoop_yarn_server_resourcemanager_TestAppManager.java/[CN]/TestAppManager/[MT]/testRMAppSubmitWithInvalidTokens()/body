{
  DataOutputBuffer dob=new DataOutputBuffer();
  ByteBuffer securityTokens=ByteBuffer.wrap(dob.getData(),0,dob.getLength());
  asContext.getAMContainerSpec().setTokens(securityTokens);
  try {
    appMonitor.submitApplication(asContext,"test");
    Assert.fail("Application submission should fail because" + " Tokens are invalid.");
  }
 catch (  YarnException e) {
    Assert.assertTrue("The thrown exception is not" + " java.io.EOFException",e.getMessage().contains("java.io.EOFException"));
  }
  int timeoutSecs=0;
  while ((getAppEventType() == RMAppEventType.KILL) && timeoutSecs++ < 20) {
    Thread.sleep(1000);
  }
  Assert.assertEquals("app event type sent is wrong",RMAppEventType.APP_REJECTED,getAppEventType());
  asContext.getAMContainerSpec().setTokens(null);
}
