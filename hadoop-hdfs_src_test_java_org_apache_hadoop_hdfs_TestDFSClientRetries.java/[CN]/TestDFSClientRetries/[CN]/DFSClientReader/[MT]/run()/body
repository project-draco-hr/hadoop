{
  try {
    fs=cluster.getNewFileSystemInstance(0);
    int bufferSize=len;
    byte[] buf=new byte[bufferSize];
    InputStream in=fs.open(filePath,bufferSize);
    IOUtils.readFully(in,buf,0,bufferSize);
    MessageDigest m=MessageDigest.getInstance("SHA");
    m.update(buf,0,bufferSize);
    byte[] hash_sha=m.digest();
    buf=null;
    in.close();
    fs.close();
    assertTrue("hashed keys are not the same size",hash_sha.length == expected_sha.length);
    assertTrue("hashed keys are not equal",Arrays.equals(hash_sha,expected_sha));
    counter.inc();
    LOG.info("Thread correctly read the block.");
  }
 catch (  BlockMissingException e) {
    LOG.info("Bad - BlockMissingException is caught.");
    e.printStackTrace();
  }
catch (  Exception e) {
    e.printStackTrace();
  }
}
