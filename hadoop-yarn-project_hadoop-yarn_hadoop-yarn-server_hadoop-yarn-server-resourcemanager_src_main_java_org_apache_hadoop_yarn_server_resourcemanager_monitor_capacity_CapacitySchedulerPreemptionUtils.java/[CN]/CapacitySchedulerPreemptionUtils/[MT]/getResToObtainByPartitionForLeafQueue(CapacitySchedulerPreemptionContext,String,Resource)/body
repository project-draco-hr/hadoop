{
  Map<String,Resource> resToObtainByPartition=new HashMap<>();
  for (  TempQueuePerPartition qT : context.getQueuePartitions(queueName)) {
    if (qT.preemptionDisabled) {
      continue;
    }
    if (Resources.greaterThan(context.getResourceCalculator(),clusterResource,qT.actuallyToBePreempted,Resources.none())) {
      resToObtainByPartition.put(qT.partition,Resources.clone(qT.actuallyToBePreempted));
    }
  }
  return resToObtainByPartition;
}
