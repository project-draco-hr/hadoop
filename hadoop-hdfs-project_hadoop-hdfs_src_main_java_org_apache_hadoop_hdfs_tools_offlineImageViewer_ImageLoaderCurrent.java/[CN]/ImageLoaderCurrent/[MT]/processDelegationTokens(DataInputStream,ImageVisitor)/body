{
  v.visit(ImageElement.CURRENT_DELEGATION_KEY_ID,in.readInt());
  int numDKeys=in.readInt();
  v.visitEnclosingElement(ImageElement.DELEGATION_KEYS,ImageElement.NUM_DELEGATION_KEYS,numDKeys);
  for (int i=0; i < numDKeys; i++) {
    DelegationKey key=new DelegationKey();
    key.readFields(in);
    v.visit(ImageElement.DELEGATION_KEY,key.toString());
  }
  v.leaveEnclosingElement();
  v.visit(ImageElement.DELEGATION_TOKEN_SEQUENCE_NUMBER,in.readInt());
  int numDTokens=in.readInt();
  v.visitEnclosingElement(ImageElement.DELEGATION_TOKENS,ImageElement.NUM_DELEGATION_TOKENS,numDTokens);
  for (int i=0; i < numDTokens; i++) {
    DelegationTokenIdentifier id=new DelegationTokenIdentifier();
    id.readFields(in);
    long expiryTime=in.readLong();
    v.visitEnclosingElement(ImageElement.DELEGATION_TOKEN_IDENTIFIER);
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_KIND,id.getKind().toString());
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_SEQNO,id.getSequenceNumber());
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_OWNER,id.getOwner().toString());
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_RENEWER,id.getRenewer().toString());
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_REALUSER,id.getRealUser().toString());
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_ISSUE_DATE,id.getIssueDate());
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_MAX_DATE,id.getMaxDate());
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_EXPIRY_TIME,expiryTime);
    v.visit(ImageElement.DELEGATION_TOKEN_IDENTIFIER_MASTER_KEY_ID,id.getMasterKeyId());
    v.leaveEnclosingElement();
  }
  v.leaveEnclosingElement();
}
