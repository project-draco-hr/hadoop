{
  v.visitEnclosingElement(ImageElement.BLOCKS,ImageElement.NUM_BLOCKS,numBlocks);
  if (numBlocks < 0) {
    v.leaveEnclosingElement();
    return;
  }
  if (skipBlocks) {
    int bytesToSkip=((Long.SIZE * 3) / 8) * numBlocks;
    if (in.skipBytes(bytesToSkip) != bytesToSkip)     throw new IOException("Error skipping over blocks");
  }
 else {
    for (int j=0; j < numBlocks; j++) {
      v.visitEnclosingElement(ImageElement.BLOCK);
      v.visit(ImageElement.BLOCK_ID,in.readLong());
      v.visit(ImageElement.NUM_BYTES,in.readLong());
      v.visit(ImageElement.GENERATION_STAMP,in.readLong());
      v.leaveEnclosingElement();
    }
  }
  v.leaveEnclosingElement();
}
