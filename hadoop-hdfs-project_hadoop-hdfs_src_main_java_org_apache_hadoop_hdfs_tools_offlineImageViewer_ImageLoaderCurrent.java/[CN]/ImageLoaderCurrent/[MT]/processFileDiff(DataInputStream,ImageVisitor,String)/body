{
  int snapshotId=in.readInt();
  v.visitEnclosingElement(ImageElement.SNAPSHOT_FILE_DIFF,ImageElement.SNAPSHOT_DIFF_SNAPSHOTID,snapshotId);
  v.visit(ImageElement.SNAPSHOT_FILE_SIZE,in.readLong());
  if (in.readBoolean()) {
    v.visitEnclosingElement(ImageElement.SNAPSHOT_INODE_FILE_ATTRIBUTES);
    if (NameNodeLayoutVersion.supports(Feature.OPTIMIZE_SNAPSHOT_INODES,imageVersion)) {
      processINodeFileAttributes(in,v,currentINodeName);
    }
 else {
      processINode(in,v,true,currentINodeName,true);
    }
    v.leaveEnclosingElement();
  }
  v.leaveEnclosingElement();
}
