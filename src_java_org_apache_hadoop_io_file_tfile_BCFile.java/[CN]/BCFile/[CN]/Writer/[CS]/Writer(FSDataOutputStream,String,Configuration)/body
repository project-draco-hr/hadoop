{
  if (fout.getPos() != 0) {
    throw new IOException("Output file not at zero offset.");
  }
  this.out=fout;
  this.conf=conf;
  dataIndex=new DataIndex(compressionName);
  metaIndex=new MetaIndex();
  fsOutputBuffer=new BytesWritable();
  Magic.write(fout);
}
