{
  Map<TaskID,JobHistoryParser.TaskInfo> tasks=job.getAllTasks();
  StringBuilder taskList=new StringBuilder();
  taskList.append("\n").append(taskType);
  taskList.append(" task list for ").append(job.getJobId());
  taskList.append("\nTaskId\t\tStartTime");
  if (TaskType.REDUCE.equals(taskType)) {
    taskList.append("\tShuffleFinished\tSortFinished");
  }
  taskList.append("\tFinishTime\tHostName\tError\tTaskLogs");
  taskList.append("\n====================================================");
  ps.println(taskList.toString());
  for (  JobHistoryParser.TaskInfo task : tasks.values()) {
    for (    JobHistoryParser.TaskAttemptInfo attempt : task.getAllTaskAttempts().values()) {
      if (taskType.equals(task.getTaskType())) {
        taskList.setLength(0);
        taskList.append(attempt.getAttemptId()).append("\t");
        taskList.append(StringUtils.getFormattedTimeWithDiff(dateFormat,attempt.getStartTime(),0)).append("\t");
        if (TaskType.REDUCE.equals(taskType)) {
          taskList.append(StringUtils.getFormattedTimeWithDiff(dateFormat,attempt.getShuffleFinishTime(),attempt.getStartTime()));
          taskList.append("\t");
          taskList.append(StringUtils.getFormattedTimeWithDiff(dateFormat,attempt.getSortFinishTime(),attempt.getShuffleFinishTime()));
        }
        taskList.append(StringUtils.getFormattedTimeWithDiff(dateFormat,attempt.getFinishTime(),attempt.getStartTime()));
        taskList.append("\t");
        taskList.append(attempt.getHostname()).append("\t");
        taskList.append(attempt.getError());
        String taskLogsUrl=HistoryViewer.getTaskLogsUrl(scheme,attempt);
        taskList.append(taskLogsUrl != null ? taskLogsUrl : "n/a");
        ps.println(taskList);
      }
    }
  }
}
