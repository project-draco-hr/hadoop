{
  if (nameNodeThreads.get(t.getNNSocketAddress()) == null) {
    throw new IllegalArgumentException("Unknown BPOfferService thread for namenode address:" + t.getNNSocketAddress());
  }
  if (t.getBlockPoolId() == null) {
    throw new IllegalArgumentException("Null blockpool id");
  }
  bpMapping.put(t.getBlockPoolId(),t);
}
