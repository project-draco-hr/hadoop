{
  InetSocketAddress socAddr=DataNode.getStreamingAddr(conf);
  ServerSocket ss;
  if (secureResources == null) {
    ss=(socketWriteTimeout > 0) ? ServerSocketChannel.open().socket() : new ServerSocket();
    Server.bind(ss,socAddr,0);
  }
 else {
    ss=secureResources.getStreamingSocket();
  }
  ss.setReceiveBufferSize(DEFAULT_DATA_SOCKET_SIZE);
  int tmpPort=ss.getLocalPort();
  selfAddr=new InetSocketAddress(ss.getInetAddress().getHostAddress(),tmpPort);
  LOG.info("Opened info server at " + tmpPort);
  this.threadGroup=new ThreadGroup("dataXceiverServer");
  this.dataXceiverServer=new Daemon(threadGroup,new DataXceiverServer(ss,conf,this));
  this.threadGroup.setDaemon(true);
}
