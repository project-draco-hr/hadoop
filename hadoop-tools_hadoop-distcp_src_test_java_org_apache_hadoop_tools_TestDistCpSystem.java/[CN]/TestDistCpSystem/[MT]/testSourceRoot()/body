{
  MiniDFSCluster cluster=null;
  Configuration conf=new Configuration();
  try {
    cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
    cluster.waitActive();
    FileSystem fs=cluster.getFileSystem();
    String rootStr=fs.makeQualified(new Path("/")).toString();
    String tgtStr=fs.makeQualified(new Path("/nodir")).toString();
    String[] args=new String[]{rootStr,tgtStr};
    Assert.assertThat(ToolRunner.run(conf,new DistCp(),args),is(0));
    Path tgtPath2=new Path("/dir");
    assertTrue(fs.mkdirs(tgtPath2));
    String tgtStr2=fs.makeQualified(tgtPath2).toString();
    String[] args2=new String[]{rootStr,tgtStr2};
    Assert.assertThat(ToolRunner.run(conf,new DistCp(),args2),is(0));
  }
  finally {
    if (cluster != null) {
      cluster.shutdown();
    }
  }
}
