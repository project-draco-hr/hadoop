{
  Socket sock=new Socket();
  sock.connect(NetUtils.createSocketAddr(destination.getName()),HdfsConstants.READ_TIMEOUT);
  sock.setKeepAlive(true);
  DataOutputStream out=new DataOutputStream(sock.getOutputStream());
  new Sender(out).replaceBlock(block,BlockTokenSecretManager.DUMMY_TOKEN,source.getStorageID(),sourceProxy);
  out.flush();
  DataInputStream reply=new DataInputStream(sock.getInputStream());
  BlockOpResponseProto proto=BlockOpResponseProto.parseDelimitedFrom(reply);
  return proto.getStatus() == Status.SUCCESS;
}
