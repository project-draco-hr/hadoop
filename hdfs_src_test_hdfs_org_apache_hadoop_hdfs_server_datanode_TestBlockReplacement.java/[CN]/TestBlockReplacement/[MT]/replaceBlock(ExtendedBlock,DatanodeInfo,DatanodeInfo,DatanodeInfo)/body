{
  Socket sock=new Socket();
  sock.connect(NetUtils.createSocketAddr(destination.getName()),HdfsConstants.READ_TIMEOUT);
  sock.setKeepAlive(true);
  DataOutputStream out=new DataOutputStream(sock.getOutputStream());
  Sender.opReplaceBlock(out,block,source.getStorageID(),sourceProxy,BlockTokenSecretManager.DUMMY_TOKEN);
  out.flush();
  DataInputStream reply=new DataInputStream(sock.getInputStream());
  BlockOpResponseProto proto=BlockOpResponseProto.parseDelimitedFrom(reply);
  return proto.getStatus() == Status.SUCCESS;
}
