{
  double mag=r.getSchedulingResourceUsage().getCachedUsed(CommonNodeLabelsManager.ANY).getMemory();
  if (sizeBasedWeight) {
    double weight=Math.log1p(r.getSchedulingResourceUsage().getCachedDemand(CommonNodeLabelsManager.ANY).getMemory()) / Math.log(2);
    mag=mag / weight;
  }
  return mag;
}
