{
  int maps=100;
  int reduces=0;
  System.out.println("Running benchmark with maps:" + maps + " reduces:"+ reduces);
  run(new MRApp(maps,reduces,true,this.getClass().getName(),true){
    @Override protected ContainerAllocator createContainerAllocator(    ClientService clientService,    AppContext context){
      return new RMContainerAllocator(clientService,context){
        @Override protected AMRMProtocol createSchedulerProxy(){
          return new AMRMProtocol(){
            @Override public RegisterApplicationMasterResponse registerApplicationMaster(            RegisterApplicationMasterRequest request) throws YarnRemoteException, IOException {
              RegisterApplicationMasterResponse response=Records.newRecord(RegisterApplicationMasterResponse.class);
              response.setMinimumResourceCapability(BuilderUtils.newResource(1024,1));
              response.setMaximumResourceCapability(BuilderUtils.newResource(10240,1));
              return response;
            }
            @Override public FinishApplicationMasterResponse finishApplicationMaster(            FinishApplicationMasterRequest request) throws YarnRemoteException, IOException {
              FinishApplicationMasterResponse response=Records.newRecord(FinishApplicationMasterResponse.class);
              return response;
            }
            @Override public AllocateResponse allocate(            AllocateRequest request) throws YarnRemoteException, IOException {
              AllocateResponse response=Records.newRecord(AllocateResponse.class);
              List<ResourceRequest> askList=request.getAskList();
              List<Container> containers=new ArrayList<Container>();
              for (              ResourceRequest req : askList) {
                if (!ResourceRequest.isAnyLocation(req.getHostName())) {
                  continue;
                }
                int numContainers=req.getNumContainers();
                for (int i=0; i < numContainers; i++) {
                  ContainerId containerId=BuilderUtils.newContainerId(request.getApplicationAttemptId(),request.getResponseId() + i);
                  containers.add(BuilderUtils.newContainer(containerId,BuilderUtils.newNodeId("host" + containerId.getId(),2345),"host" + containerId.getId() + ":5678",req.getCapability(),req.getPriority(),null,0));
                }
              }
              response.setAllocatedContainers(containers);
              response.setResponseId(request.getResponseId() + 1);
              response.setNumClusterNodes(350);
              return response;
            }
          }
;
        }
      }
;
    }
  }
);
}
