{
  if (LOG.isDebugEnabled()) {
    LOG.info("read off " + off + " len "+ len);
  }
  if (!verifyChecksum) {
    return dataIn.read(buf,off,len);
  }
 else {
    int dataRead=-1;
    if (dataBuff.remaining() == 0) {
      dataBuff.clear();
      checksumBuff.clear();
      dataRead=readIntoBuffer(dataIn,dataBuff);
      readIntoBuffer(checksumIn,checksumBuff);
      checksumBuff.flip();
      dataBuff.flip();
      if (verifyChecksum) {
        checksum.verifyChunkedSums(dataBuff,checksumBuff,filename,this.startOffset);
      }
    }
 else {
      dataRead=dataBuff.remaining();
    }
    if (dataRead > 0) {
      int nRead=Math.min(dataRead - offsetFromChunkBoundary,len);
      if (offsetFromChunkBoundary > 0) {
        dataBuff.position(offsetFromChunkBoundary);
        offsetFromChunkBoundary=0;
      }
      if (nRead > 0) {
        dataBuff.get(buf,off,nRead);
        return nRead;
      }
 else {
        return 0;
      }
    }
 else {
      return -1;
    }
  }
}
