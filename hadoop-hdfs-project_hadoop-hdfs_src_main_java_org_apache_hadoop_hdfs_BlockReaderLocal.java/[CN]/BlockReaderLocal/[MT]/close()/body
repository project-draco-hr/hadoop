{
  if (clientMmap != null) {
    clientMmap.unref();
    clientMmap=null;
  }
  if (fisCache != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("putting FileInputStream for " + filename + " back into FileInputStreamCache");
    }
    fisCache.put(datanodeID,block,new FileInputStream[]{dataIn,checksumIn});
  }
 else {
    LOG.debug("closing FileInputStream for " + filename);
    IOUtils.cleanup(LOG,dataIn,checksumIn);
  }
  if (slowReadBuff != null) {
    bufferPool.returnBuffer(slowReadBuff);
    slowReadBuff=null;
  }
  if (checksumBuff != null) {
    bufferPool.returnBuffer(checksumBuff);
    checksumBuff=null;
  }
  startOffset=-1;
  checksum=null;
}
