{
  if (closed)   return;
  closed=true;
  if (LOG.isTraceEnabled()) {
    LOG.trace("close(filename=" + filename + ", block="+ block+ ")");
  }
  if (clientMmap != null) {
    clientMmap.unref();
    clientMmap=null;
  }
  if (fisCache != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("putting FileInputStream for " + filename + " back into FileInputStreamCache");
    }
    fisCache.put(datanodeID,block,streams);
  }
 else {
    LOG.debug("closing FileInputStream for " + filename);
    IOUtils.cleanup(LOG,dataIn,checksumIn);
  }
  freeDataBufIfExists();
  freeChecksumBufIfExists();
}
