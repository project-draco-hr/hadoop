{
  this.filename=hdfsfile;
  this.checksum=checksum;
  this.verifyChecksum=verifyChecksum;
  this.startOffset=Math.max(startOffset,0);
  bytesPerChecksum=this.checksum.getBytesPerChecksum();
  checksumSize=this.checksum.getChecksumSize();
  this.dataIn=dataIn;
  this.checksumIn=checksumIn;
  this.offsetFromChunkBoundary=(int)(startOffset - firstChunkOffset);
  dataBuff=bufferPool.getBuffer(bytesPerChecksum * 64);
  checksumBuff=bufferPool.getBuffer(checksumSize * 64);
  dataBuff.flip();
  checksumBuff.flip();
  long toSkip=firstChunkOffset;
  while (toSkip > 0) {
    long skipped=dataIn.skip(toSkip);
    if (skipped == 0) {
      throw new IOException("Couldn't initialize input stream");
    }
    toSkip-=skipped;
  }
  if (checksumIn != null) {
    long checkSumOffset=(firstChunkOffset / bytesPerChecksum) * checksumSize;
    while (checkSumOffset > 0) {
      long skipped=checksumIn.skip(checkSumOffset);
      if (skipped == 0) {
        throw new IOException("Couldn't initialize checksum input stream");
      }
      checkSumOffset-=skipped;
    }
  }
}
