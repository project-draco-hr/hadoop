{
  LOG.info("testDeleteSingleDeleteFailure");
  NativeAzureFileSystem mockFs=Mockito.spy((NativeAzureFileSystem)fs);
  String path=mockFs.pathToKey(mockFs.makeAbsolute(new Path("root/0")));
  Mockito.when(mockFs.deleteFile(path,true)).thenReturn(false);
  createFolder(mockFs,"root");
  Path sourceFolder=new Path("root");
  assertFalse(mockFs.delete(sourceFolder,true));
  assertTrue(mockFs.exists(sourceFolder));
  String content=logs.getOutput();
  assertTrue(content.contains("Using thread pool for Delete operation with threads"));
  assertTrue(content.contains("Delete operation failed for file " + path));
  assertTrue(content.contains("Terminating execution of Delete operation now as some other thread already got exception or operation failed"));
  assertTrue(content.contains("Failed to delete files / subfolders in blob"));
}
