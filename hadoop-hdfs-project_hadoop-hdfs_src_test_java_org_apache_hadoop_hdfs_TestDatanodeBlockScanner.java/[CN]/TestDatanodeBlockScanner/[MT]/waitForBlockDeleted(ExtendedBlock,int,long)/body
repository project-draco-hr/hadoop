{
  File blockFile=MiniDFSCluster.getBlockFile(dnIndex,blk);
  long failtime=Time.monotonicNow() + ((timeout > 0) ? timeout : Long.MAX_VALUE);
  while (blockFile != null && blockFile.exists()) {
    if (failtime < Time.monotonicNow()) {
      throw new TimeoutException("waited too long for blocks to be deleted: " + blockFile.getPath() + (blockFile.exists() ? " still exists; " : " is absent; "));
    }
    Thread.sleep(100);
    blockFile=MiniDFSCluster.getBlockFile(dnIndex,blk);
  }
}
