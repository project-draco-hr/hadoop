{
  if (!conf.getBoolean(DFS_WEBHDFS_REST_CSRF_ENABLED_KEY,DFS_WEBHDFS_REST_CSRF_ENABLED_DEFAULT)) {
    return null;
  }
  String restCsrfClassName=RestCsrfPreventionFilter.class.getName();
  Map<String,String> restCsrfParams=RestCsrfPreventionFilter.getFilterParams(conf,"dfs.webhdfs.rest-csrf.");
  RestCsrfPreventionFilter filter=new RestCsrfPreventionFilter();
  try {
    filter.init(new MapBasedFilterConfig(restCsrfClassName,restCsrfParams));
  }
 catch (  ServletException e) {
    throw new IllegalStateException("Failed to initialize RestCsrfPreventionFilter.",e);
  }
  return filter;
}
