{
  UnderReplicatedBlocks queues=new UnderReplicatedBlocks();
  BlockInfo block1=genBlockInfo(1);
  BlockInfo block2=genBlockInfo(2);
  BlockInfo block_very_under_replicated=genBlockInfo(3);
  BlockInfo block_corrupt=genBlockInfo(4);
  BlockInfo block_corrupt_repl_one=genBlockInfo(5);
  assertAdded(queues,block1,1,0,3);
  assertEquals(1,queues.getUnderReplicatedBlockCount());
  assertEquals(1,queues.size());
  assertInLevel(queues,block1,UnderReplicatedBlocks.QUEUE_HIGHEST_PRIORITY);
  assertFalse(queues.add(block1,1,0,3));
  assertAdded(queues,block2,2,0,3);
  assertEquals(2,queues.getUnderReplicatedBlockCount());
  assertEquals(2,queues.size());
  assertInLevel(queues,block2,UnderReplicatedBlocks.QUEUE_UNDER_REPLICATED);
  assertAdded(queues,block_corrupt,0,0,3);
  assertEquals(3,queues.size());
  assertEquals(2,queues.getUnderReplicatedBlockCount());
  assertEquals(1,queues.getCorruptBlockSize());
  assertInLevel(queues,block_corrupt,UnderReplicatedBlocks.QUEUE_WITH_CORRUPT_BLOCKS);
  assertAdded(queues,block_very_under_replicated,4,0,25);
  assertInLevel(queues,block_very_under_replicated,UnderReplicatedBlocks.QUEUE_VERY_UNDER_REPLICATED);
  assertAdded(queues,block_corrupt_repl_one,0,0,1);
  assertEquals(2,queues.getCorruptBlockSize());
  assertEquals(1,queues.getCorruptReplOneBlockSize());
  queues.update(block_corrupt_repl_one,0,0,3,0,2);
  assertEquals(0,queues.getCorruptReplOneBlockSize());
  queues.update(block_corrupt,0,0,1,0,-2);
  assertEquals(1,queues.getCorruptReplOneBlockSize());
  queues.update(block_very_under_replicated,0,0,1,-4,-24);
  assertEquals(2,queues.getCorruptReplOneBlockSize());
}
