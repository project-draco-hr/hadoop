{
  if (fp == null) {
    throw new IOException("Trying to use aborted output stream");
  }
  if (doubleBuf.isFlushed()) {
    LOG.info("Nothing to flush");
    return;
  }
  preallocate();
  doubleBuf.flushTo(fp);
  if (durable && !shouldSkipFsyncForTests && !shouldSyncWritesAndSkipFsync) {
    fc.force(false);
  }
}
