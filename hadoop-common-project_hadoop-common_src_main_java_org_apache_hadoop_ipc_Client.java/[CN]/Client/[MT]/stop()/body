{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Stopping client");
  }
  if (!running.compareAndSet(true,false)) {
    return;
  }
  for (  Connection conn : connections.asMap().values()) {
    conn.interrupt();
  }
  while (connections.size() > 0) {
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
    }
  }
  clientExcecutorFactory.unrefAndCleanup();
}
