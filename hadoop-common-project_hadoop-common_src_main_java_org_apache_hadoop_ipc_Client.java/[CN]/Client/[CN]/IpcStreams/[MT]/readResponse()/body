{
  int length=in.readInt();
  if (firstResponse) {
    firstResponse=false;
    if (length == -1) {
      in.readInt();
      throw new RemoteException(WritableUtils.readString(in),WritableUtils.readString(in));
    }
  }
  if (length <= 0) {
    throw new RpcException("RPC response has invalid length");
  }
  if (maxResponseLength > 0 && length > maxResponseLength) {
    throw new RpcException("RPC response exceeds maximum data length");
  }
  ByteBuffer bb=ByteBuffer.allocate(length);
  in.readFully(bb.array());
  return bb;
}
