{
  long numHeartbeats=(long)Math.ceil((time - simulationStartTime) / (double)heartbeatInterval);
  return simulationStartTime + numHeartbeats * heartbeatInterval;
}
