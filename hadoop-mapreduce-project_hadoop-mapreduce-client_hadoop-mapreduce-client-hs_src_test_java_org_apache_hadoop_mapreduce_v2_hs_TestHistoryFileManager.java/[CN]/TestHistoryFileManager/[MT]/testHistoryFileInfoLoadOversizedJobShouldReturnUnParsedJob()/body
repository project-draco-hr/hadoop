{
  HistoryFileManagerTest hmTest=new HistoryFileManagerTest();
  int allowedMaximumTasks=5;
  Configuration conf=dfsCluster.getConfiguration(0);
  conf.setInt(JHAdminConfig.MR_HS_LOADED_JOBS_TASKS_MAX,allowedMaximumTasks);
  hmTest.init(conf);
  String jobId="job_1410889000000_123456";
  JobIndexInfo jobIndexInfo=new JobIndexInfo();
  jobIndexInfo.setJobId(TypeConverter.toYarn(JobID.forName(jobId)));
  jobIndexInfo.setNumMaps(allowedMaximumTasks);
  jobIndexInfo.setNumReduces(allowedMaximumTasks);
  HistoryFileInfo info=hmTest.getHistoryFileInfo(null,null,null,jobIndexInfo,false);
  Job job=info.loadJob();
  Assert.assertTrue("Should return an instance of UnparsedJob to indicate" + " the job history file is not parsed",job instanceof UnparsedJob);
}
