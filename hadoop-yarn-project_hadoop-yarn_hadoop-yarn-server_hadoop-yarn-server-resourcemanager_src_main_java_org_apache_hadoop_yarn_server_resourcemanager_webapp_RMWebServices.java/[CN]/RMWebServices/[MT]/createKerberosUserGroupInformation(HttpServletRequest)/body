{
  UserGroupInformation callerUGI=getCallerUserGroupInformation(hsr,true);
  if (callerUGI == null) {
    String msg="Unable to obtain user name, user not authenticated";
    throw new AuthorizationException(msg);
  }
  String authType=hsr.getAuthType();
  if (!KerberosAuthenticationHandler.TYPE.equals(authType)) {
    String msg="Delegation token operations can only be carried out on a " + "Kerberos authenticated channel";
    throw new YarnException(msg);
  }
  callerUGI.setAuthenticationMethod(AuthenticationMethod.KERBEROS);
  return callerUGI;
}
