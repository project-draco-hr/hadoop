{
  init();
  UserGroupInformation callerUGI=getCallerUserGroupInformation(hsr,true);
  if (callerUGI == null) {
    String msg="Unable to obtain user name, user not authenticated for" + " post to .../replace-node-to-labels";
    throw new AuthorizationException(msg);
  }
  if (!rm.getRMContext().getNodeLabelManager().checkAccess(callerUGI)) {
    String msg="User " + callerUGI.getShortUserName() + " not authorized"+ " for post to .../replace-node-to-labels ";
    throw new AuthorizationException(msg);
  }
  Map<NodeId,Set<String>> nodeIdToLabels=new HashMap<NodeId,Set<String>>();
  for (  Map.Entry<String,NodeLabelsInfo> nitle : newNodeToLabels.getNodeToLabels().entrySet()) {
    nodeIdToLabels.put(ConverterUtils.toNodeIdWithDefaultPort(nitle.getKey()),new HashSet<String>(nitle.getValue().getNodeLabels()));
  }
  rm.getRMContext().getNodeLabelManager().replaceLabelsOnNode(nodeIdToLabels);
  return Response.status(Status.OK).build();
}
