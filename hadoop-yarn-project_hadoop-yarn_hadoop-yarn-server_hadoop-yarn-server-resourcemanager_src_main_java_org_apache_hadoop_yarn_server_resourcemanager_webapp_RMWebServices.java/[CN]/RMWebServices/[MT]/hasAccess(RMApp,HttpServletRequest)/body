{
  UserGroupInformation callerUGI=getCallerUserGroupInformation(hsr,true);
  List<String> forwardedAddresses=null;
  String forwardedFor=hsr.getHeader("X-Forwarded-For");
  if (forwardedFor != null) {
    forwardedAddresses=Arrays.asList(forwardedFor.split(","));
  }
  if (callerUGI != null && !(this.rm.getApplicationACLsManager().checkAccess(callerUGI,ApplicationAccessType.VIEW_APP,app.getUser(),app.getApplicationId()) || this.rm.getQueueACLsManager().checkAccess(callerUGI,QueueACL.ADMINISTER_QUEUE,app,hsr.getRemoteAddr(),forwardedAddresses))) {
    return false;
  }
  return true;
}
