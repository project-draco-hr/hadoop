{
  init();
  UserGroupInformation callerUGI=getCallerUserGroupInformation(hsr,true);
  if (callerUGI == null) {
    String msg="Unable to obtain user name, user not authenticated for" + " post to .../nodes/nodeid/replace-labels";
    throw new AuthorizationException(msg);
  }
  if (!rm.getRMContext().getNodeLabelManager().checkAccess(callerUGI)) {
    String msg="User " + callerUGI.getShortUserName() + " not authorized"+ " for post to .../nodes/nodeid/replace-labels";
    throw new AuthorizationException(msg);
  }
  NodeId nid=ConverterUtils.toNodeIdWithDefaultPort(nodeId);
  Map<NodeId,Set<String>> newLabelsForNode=new HashMap<NodeId,Set<String>>();
  newLabelsForNode.put(nid,new HashSet<String>(newNodeLabelsInfo.getNodeLabels()));
  rm.getRMContext().getNodeLabelManager().replaceLabelsOnNode(newLabelsForNode);
  return Response.status(Status.OK).build();
}
