{
  init();
  UserGroupInformation callerUGI=getCallerUserGroupInformation(hsr,true);
  if (callerUGI == null) {
    String msg="Unable to obtain user name, user not authenticated";
    throw new AuthorizationException(msg);
  }
  if (UserGroupInformation.isSecurityEnabled() && isStaticUser(callerUGI)) {
    String msg="The default static user cannot carry out this operation.";
    return Response.status(Status.FORBIDDEN).entity(msg).build();
  }
  String userName=callerUGI.getUserName();
  RMApp app=null;
  try {
    app=getRMAppForAppId(appId);
  }
 catch (  NotFoundException e) {
    RMAuditLogger.logFailure(userName,AuditConstants.KILL_APP_REQUEST,"UNKNOWN","RMWebService","Trying to kill/move an absent application " + appId);
    throw e;
  }
  if (!app.getState().toString().equals(targetState.getState())) {
    if (targetState.getState().equals(YarnApplicationState.KILLED.toString())) {
      return killApp(app,callerUGI,hsr);
    }
    throw new BadRequestException("Only '" + YarnApplicationState.KILLED.toString() + "' is allowed as a target state.");
  }
  AppState ret=new AppState();
  ret.setState(app.getState().toString());
  return Response.status(Status.OK).entity(ret).build();
}
