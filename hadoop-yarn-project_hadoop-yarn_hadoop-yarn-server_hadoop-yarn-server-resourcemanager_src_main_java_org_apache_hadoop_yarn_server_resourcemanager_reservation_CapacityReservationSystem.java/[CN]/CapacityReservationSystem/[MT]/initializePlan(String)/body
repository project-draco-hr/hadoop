{
  SharingPolicy adPolicy=getAdmissionPolicy(planQueueName);
  String planQueuePath=capScheduler.getQueue(planQueueName).getQueuePath();
  adPolicy.init(planQueuePath,capScheduler.getConfiguration());
  CSQueue planQueue=capScheduler.getQueue(planQueueName);
  Resource minAllocation=capScheduler.getMinimumResourceCapability();
  ResourceCalculator rescCalc=capScheduler.getResourceCalculator();
  Resource totCap=rescCalc.multiplyAndNormalizeDown(capScheduler.getClusterResource(),planQueue.getAbsoluteCapacity(),minAllocation);
  Plan plan=new InMemoryPlan(capScheduler.getRootQueueMetrics(),adPolicy,getAgent(planQueuePath),totCap,planStepSize,rescCalc,minAllocation,capScheduler.getMaximumResourceCapability(),planQueueName,getReplanner(planQueuePath),capScheduler.getConfiguration().getMoveOnExpiry(planQueuePath));
  LOG.info("Intialized plan {0} based on reservable queue {1}",plan.toString(),planQueueName);
  return plan;
}
