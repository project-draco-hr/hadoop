{
  CapacitySchedulerConfiguration capSchedulerConfig=capScheduler.getConfiguration();
  String plannerClassName=capSchedulerConfig.getReplanner(planQueueName);
  LOG.info("Using Replanner: " + plannerClassName + " for queue: "+ planQueueName);
  try {
    Class<?> plannerClazz=capSchedulerConfig.getClassByName(plannerClassName);
    if (Planner.class.isAssignableFrom(plannerClazz)) {
      Planner planner=(Planner)ReflectionUtils.newInstance(plannerClazz,conf);
      planner.init(planQueueName,capSchedulerConfig);
      return planner;
    }
 else {
      throw new YarnRuntimeException("Class: " + plannerClazz + " not instance of "+ Planner.class.getCanonicalName());
    }
  }
 catch (  ClassNotFoundException e) {
    throw new YarnRuntimeException("Could not instantiate Planner: " + plannerClassName + " for queue: "+ planQueueName,e);
  }
}
