{
  Command currentCommand=null;
  if (cmd.hasOption(DiskBalancer.PLAN)) {
    currentCommand=new PlanCommand(getConf());
  }
  if (cmd.hasOption(DiskBalancer.EXECUTE)) {
    currentCommand=new ExecuteCommand(getConf());
  }
  if (cmd.hasOption(DiskBalancer.QUERY)) {
    currentCommand=new QueryCommand(getConf());
  }
  if (cmd.hasOption(DiskBalancer.CANCEL)) {
    currentCommand=new CancelCommand(getConf());
  }
  if (cmd.hasOption(DiskBalancer.REPORT)) {
    currentCommand=new ReportCommand(getConf(),out);
  }
  if (cmd.hasOption(DiskBalancer.HELP)) {
    currentCommand=new HelpCommand(getConf());
  }
  if (currentCommand == null) {
    new HelpCommand(getConf()).execute(null);
    return 1;
  }
  currentCommand.execute(cmd);
  return 0;
}
