{
synchronized (this) {
    shuffleMetrics.incrMetric("shuffle_input_bytes",numBytes);
    shuffleMetrics.incrMetric("shuffle_failed_fetches",numFailedFetches);
    shuffleMetrics.incrMetric("shuffle_success_fetches",numSuccessFetches);
    if (numCopiers != 0) {
      shuffleMetrics.setMetric("shuffle_fetchers_busy_percent",100 * ((float)numThreadsBusy / numCopiers));
    }
 else {
      shuffleMetrics.setMetric("shuffle_fetchers_busy_percent",0);
    }
    numBytes=0;
    numSuccessFetches=0;
    numFailedFetches=0;
  }
  shuffleMetrics.update();
}
