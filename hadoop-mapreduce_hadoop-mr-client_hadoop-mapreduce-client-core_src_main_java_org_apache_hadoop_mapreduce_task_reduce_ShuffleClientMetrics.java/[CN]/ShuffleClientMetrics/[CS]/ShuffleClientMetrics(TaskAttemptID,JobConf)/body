{
  this.numCopiers=jobConf.getInt(MRJobConfig.SHUFFLE_PARALLEL_COPIES,5);
  MetricsContext metricsContext=MetricsUtil.getContext("mapred");
  this.shuffleMetrics=MetricsUtil.createRecord(metricsContext,"shuffleInput");
  this.shuffleMetrics.setTag("user",jobConf.getUser());
  this.shuffleMetrics.setTag("jobName",jobConf.getJobName());
  this.shuffleMetrics.setTag("jobId",reduceId.getJobID().toString());
  this.shuffleMetrics.setTag("taskId",reduceId.toString());
  this.shuffleMetrics.setTag("sessionId",jobConf.getSessionId());
  metricsContext.registerUpdater(this);
}
