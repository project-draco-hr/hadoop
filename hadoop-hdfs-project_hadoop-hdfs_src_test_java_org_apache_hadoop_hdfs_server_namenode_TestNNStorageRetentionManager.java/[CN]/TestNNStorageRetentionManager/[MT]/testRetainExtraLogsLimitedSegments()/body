{
  conf.setLong(DFSConfigKeys.DFS_NAMENODE_NUM_EXTRA_EDITS_RETAINED_KEY,150);
  conf.setLong(DFSConfigKeys.DFS_NAMENODE_MAX_EXTRA_EDITS_SEGMENTS_RETAINED_KEY,2);
  TestCaseDescription tc=new TestCaseDescription();
  tc.addRoot("/foo1",NameNodeDirType.IMAGE);
  tc.addRoot("/foo2",NameNodeDirType.EDITS);
  tc.addImage("/foo1/current/" + getImageFileName(100),true);
  tc.addImage("/foo1/current/" + getImageFileName(200),true);
  tc.addImage("/foo1/current/" + getImageFileName(300),false);
  tc.addImage("/foo1/current/" + getImageFileName(400),false);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(1,100),true);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(101,175),true);
  tc.addLog("/foo2/current/" + getInProgressEditsFileName(176) + ".empty",true);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(176,200),true);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(201,225),true);
  tc.addLog("/foo2/current/" + getInProgressEditsFileName(226) + ".corrupt",true);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(226,240),true);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(241,275),false);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(276,300),false);
  tc.addLog("/foo2/current/" + getInProgressEditsFileName(301) + ".empty",false);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(301,350),false);
  tc.addLog("/foo2/current/" + getInProgressEditsFileName(351) + ".corrupt",false);
  tc.addLog("/foo2/current/" + getFinalizedEditsFileName(351,400),false);
  tc.addLog("/foo2/current/" + getInProgressEditsFileName(401),false);
  runTest(tc);
}
