{
  List<DatanodeInfo> candidates=new ArrayList<>();
  candidates.add(dataNodes[0]);
  candidates.add(dataNodes[1]);
  candidates.add(dataNodes[2]);
  candidates.add(dataNodes[3]);
  assertTrue(replicator.isMovable(candidates,dataNodes[0],dataNodes[3]));
  candidates.clear();
  candidates.add(dataNodes[0]);
  candidates.add(dataNodes[1]);
  candidates.add(dataNodes[2]);
  candidates.add(dataNodes[4]);
  assertFalse(replicator.isMovable(candidates,dataNodes[0],dataNodes[4]));
  candidates.clear();
  candidates.add(dataNodes[0]);
  candidates.add(dataNodes[4]);
  candidates.add(dataNodes[5]);
  candidates.add(dataNodes[6]);
  assertTrue(replicator.isMovable(candidates,dataNodes[0],dataNodes[6]));
  candidates.clear();
  candidates.add(dataNodes[0]);
  candidates.add(dataNodes[1]);
  candidates.add(dataNodes[3]);
  candidates.add(dataNodes[4]);
  assertTrue(replicator.isMovable(candidates,dataNodes[0],dataNodes[4]));
  candidates.clear();
  candidates.add(dataNodes[0]);
  candidates.add(dataNodes[3]);
  candidates.add(dataNodes[4]);
  candidates.add(dataNodes[6]);
  assertFalse(replicator.isMovable(candidates,dataNodes[4],dataNodes[6]));
}
