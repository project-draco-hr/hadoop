{
  PrintWriter out=new PrintWriter(new FileWriter(SCHEMA_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<schemas>");
  out.println("  <schema name=\"RSk6m3\">");
  out.println("    <k>6</k>");
  out.println("    <m>3</m>");
  out.println("    <codec>RS</codec>");
  out.println("  </schema>");
  out.println("  <schema name=\"RSk10m4\">");
  out.println("    <k>10</k>");
  out.println("    <m>4</m>");
  out.println("    <codec>RS</codec>");
  out.println("  </schema>");
  out.println("</schemas>");
  out.close();
  Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeys.IO_ERASURECODE_SCHEMA_FILE_KEY,SCHEMA_FILE);
  SchemaLoader schemaLoader=new SchemaLoader();
  List<ECSchema> schemas=schemaLoader.loadSchema(conf);
  assertEquals(2,schemas.size());
  ECSchema schema1=schemas.get(0);
  assertEquals("RSk6m3",schema1.getSchemaName());
  assertEquals(3,schema1.getOptions().size());
  assertEquals(6,schema1.getNumDataUnits());
  assertEquals(3,schema1.getNumParityUnits());
  assertEquals("RS",schema1.getCodecName());
  ECSchema schema2=schemas.get(1);
  assertEquals("RSk10m4",schema2.getSchemaName());
  assertEquals(3,schema2.getOptions().size());
  assertEquals(10,schema2.getNumDataUnits());
  assertEquals(4,schema2.getNumParityUnits());
  assertEquals("RS",schema2.getCodecName());
}
