{
  if (type == Type.MEMORY) {
    merger.closeInMemoryFile(this);
  }
 else   if (type == Type.DISK) {
    localFS.rename(tmpOutputPath,outputPath);
    merger.closeOnDiskFile(outputPath);
  }
 else {
    throw new IOException("Cannot commit MapOutput of type WAIT!");
  }
}
