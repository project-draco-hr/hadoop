{
  QueueMetrics queueMetrics=new QueueMetrics();
  List<QueueInfo> queuesInfo;
  if (queues.isEmpty()) {
    try {
      queuesInfo=client.getRootQueueInfos();
    }
 catch (    Exception ie) {
      LOG.error("Unable to get queue information",ie);
      return queueMetrics;
    }
  }
 else {
    queuesInfo=new ArrayList<>();
    for (    String queueName : queues) {
      try {
        QueueInfo qInfo=client.getQueueInfo(queueName);
        queuesInfo.add(qInfo);
      }
 catch (      Exception ie) {
        LOG.error("Unable to get queue information",ie);
        return queueMetrics;
      }
    }
  }
  for (  QueueInfo childInfo : queuesInfo) {
    QueueStatistics stats=childInfo.getQueueStatistics();
    if (stats != null) {
      queueMetrics.appsSubmitted+=stats.getNumAppsSubmitted();
      queueMetrics.appsRunning+=stats.getNumAppsRunning();
      queueMetrics.appsPending+=stats.getNumAppsPending();
      queueMetrics.appsCompleted+=stats.getNumAppsCompleted();
      queueMetrics.appsKilled+=stats.getNumAppsKilled();
      queueMetrics.appsFailed+=stats.getNumAppsFailed();
      queueMetrics.activeUsers+=stats.getNumActiveUsers();
      queueMetrics.availableMemoryGB+=stats.getAvailableMemoryMB();
      queueMetrics.allocatedMemoryGB+=stats.getAllocatedMemoryMB();
      queueMetrics.pendingMemoryGB+=stats.getPendingMemoryMB();
      queueMetrics.reservedMemoryGB+=stats.getReservedMemoryMB();
      queueMetrics.availableVCores+=stats.getAvailableVCores();
      queueMetrics.allocatedVCores+=stats.getAllocatedVCores();
      queueMetrics.pendingVCores+=stats.getPendingVCores();
      queueMetrics.reservedVCores+=stats.getReservedVCores();
    }
  }
  queueMetrics.availableMemoryGB=queueMetrics.availableMemoryGB / 1024;
  queueMetrics.allocatedMemoryGB=queueMetrics.allocatedMemoryGB / 1024;
  queueMetrics.pendingMemoryGB=queueMetrics.pendingMemoryGB / 1024;
  queueMetrics.reservedMemoryGB=queueMetrics.reservedMemoryGB / 1024;
  return queueMetrics;
}
