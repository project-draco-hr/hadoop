{
  AuthenticatedURL.Token token=new AuthenticatedURL.Token();
  AuthenticatedURL authUrl;
  SSLFactory clientSslFactory;
  URLConnection connection;
  if (YarnConfiguration.useHttps(getConf())) {
    clientSslFactory=new SSLFactory(SSLFactory.Mode.CLIENT,getConf());
    clientSslFactory.init();
    SSLSocketFactory sslSocktFact=clientSslFactory.createSSLSocketFactory();
    authUrl=new AuthenticatedURL(new KerberosAuthenticator(),clientSslFactory);
    connection=authUrl.openConnection(url,token);
    HttpsURLConnection httpsConn=(HttpsURLConnection)connection;
    httpsConn.setSSLSocketFactory(sslSocktFact);
  }
 else {
    authUrl=new AuthenticatedURL(new KerberosAuthenticator());
    connection=authUrl.openConnection(url,token);
  }
  connection.connect();
  return connection;
}
