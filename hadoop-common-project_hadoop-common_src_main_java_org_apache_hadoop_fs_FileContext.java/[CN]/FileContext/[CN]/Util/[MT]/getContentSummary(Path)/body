{
  FileStatus status=FileContext.this.getFileStatus(f);
  if (status.isFile()) {
    long length=status.getLen();
    return new ContentSummary.Builder().length(length).fileCount(1).directoryCount(0).spaceConsumed(length).build();
  }
  long[] summary={0,0,1};
  RemoteIterator<FileStatus> statusIterator=FileContext.this.listStatus(f);
  while (statusIterator.hasNext()) {
    FileStatus s=statusIterator.next();
    long length=s.getLen();
    ContentSummary c=s.isDirectory() ? getContentSummary(s.getPath()) : new ContentSummary.Builder().length(length).fileCount(1).directoryCount(0).spaceConsumed(length).build();
    summary[0]+=c.getLength();
    summary[1]+=c.getFileCount();
    summary[2]+=c.getDirectoryCount();
  }
  return new ContentSummary.Builder().length(summary[0]).fileCount(summary[1]).directoryCount(summary[2]).spaceConsumed(summary[0]).build();
}
