{
  FileStatus status=FileContext.this.getFileStatus(f);
  if (status.isFile()) {
    return new ContentSummary(status.getLen(),1,0);
  }
  long[] summary={0,0,1};
  RemoteIterator<FileStatus> statusIterator=FileContext.this.listStatus(f);
  while (statusIterator.hasNext()) {
    FileStatus s=statusIterator.next();
    ContentSummary c=s.isDirectory() ? getContentSummary(s.getPath()) : new ContentSummary(s.getLen(),1,0);
    summary[0]+=c.getLength();
    summary[1]+=c.getFileCount();
    summary[2]+=c.getDirectoryCount();
  }
  return new ContentSummary(summary[0],summary[1],summary[2]);
}
