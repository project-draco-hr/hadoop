{
  Path file0=new Path(sub1,"file0");
  Path file1=new Path(sub1,"file1");
  DFSTestUtil.createFile(hdfs,file0,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPLICATION,seed);
  Path subfile1=new Path(subsub1,"file0");
  Path subfile2=new Path(subsub1,"file1");
  DFSTestUtil.createFile(hdfs,subfile1,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,subfile2,BLOCKSIZE,REPLICATION,seed);
  hdfs.allowSnapshot(subsub1.toString());
  hdfs.createSnapshot("s1",subsub1.toString());
  exception.expect(RemoteException.class);
  String error="The direcotry " + dir.toString() + " cannot be deleted since "+ subsub1.toString()+ " is snapshottable and already has snapshots";
  exception.expectMessage(error);
  hdfs.delete(dir,true);
}
