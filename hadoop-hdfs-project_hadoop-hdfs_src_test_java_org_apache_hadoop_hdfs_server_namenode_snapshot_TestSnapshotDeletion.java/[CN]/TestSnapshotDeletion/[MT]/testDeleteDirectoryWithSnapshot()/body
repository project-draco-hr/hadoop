{
  Path file0=new Path(sub1,"file0");
  Path file1=new Path(sub1,"file1");
  DFSTestUtil.createFile(hdfs,file0,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPLICATION,seed);
  hdfs.allowSnapshot(sub1.toString());
  hdfs.createSnapshot("s1",sub1.toString());
  exception.expect(RemoteException.class);
  String error="The direcotry " + sub1.toString() + " cannot be deleted since "+ sub1.toString()+ " is snapshottable and already has snapshots";
  exception.expectMessage(error);
  hdfs.delete(sub1,true);
}
