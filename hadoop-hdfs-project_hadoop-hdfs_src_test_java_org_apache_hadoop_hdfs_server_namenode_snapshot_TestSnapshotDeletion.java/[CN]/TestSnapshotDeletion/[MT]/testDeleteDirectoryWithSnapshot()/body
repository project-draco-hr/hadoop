{
  Path file0=new Path(sub,"file0");
  Path file1=new Path(sub,"file1");
  DFSTestUtil.createFile(hdfs,file0,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPLICATION,seed);
  hdfs.allowSnapshot(sub.toString());
  hdfs.createSnapshot(sub,"s1");
  exception.expect(RemoteException.class);
  String error="The direcotry " + sub.toString() + " cannot be deleted since "+ sub.toString()+ " is snapshottable and already has snapshots";
  exception.expectMessage(error);
  hdfs.delete(sub,true);
}
