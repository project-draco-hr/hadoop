{
  Path file=new Path(sub1,"file");
  DFSTestUtil.createFile(hdfs,file,BLOCKSIZE,REPLICATION,seed);
  hdfs.setOwner(sub1,"user1","group1");
  SnapshotTestHelper.createSnapshot(hdfs,sub1,"s1");
  hdfs.setOwner(sub1,"user2","group2");
  hdfs.createSnapshot(sub1,"s2");
  hdfs.createSnapshot(sub1,"s3");
  hdfs.setOwner(sub1,"user3","group3");
  hdfs.deleteSnapshot(sub1,"s3");
  FileStatus statusOfS2=hdfs.getFileStatus(new Path(sub1,HdfsConstants.DOT_SNAPSHOT_DIR + "/s2"));
  assertEquals("user2",statusOfS2.getOwner());
  assertEquals("group2",statusOfS2.getGroup());
  hdfs.deleteSnapshot(sub1,"s2");
  FileStatus statusOfS1=hdfs.getFileStatus(new Path(sub1,HdfsConstants.DOT_SNAPSHOT_DIR + "/s1"));
  assertEquals("user1",statusOfS1.getOwner());
  assertEquals("group1",statusOfS1.getGroup());
}
