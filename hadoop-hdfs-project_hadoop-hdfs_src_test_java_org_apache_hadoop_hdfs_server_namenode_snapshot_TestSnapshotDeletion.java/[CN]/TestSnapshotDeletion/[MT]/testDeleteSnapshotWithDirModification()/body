{
  Path file=new Path(sub,"file");
  DFSTestUtil.createFile(hdfs,file,BLOCKSIZE,REPLICATION,seed);
  hdfs.setOwner(sub,"user1","group1");
  SnapshotTestHelper.createSnapshot(hdfs,sub,"s1");
  checkQuotaUsageComputation(sub,3,BLOCKSIZE * 3);
  hdfs.setOwner(sub,"user2","group2");
  checkQuotaUsageComputation(sub,3,BLOCKSIZE * 3);
  hdfs.createSnapshot(sub,"s2");
  checkQuotaUsageComputation(sub,4,BLOCKSIZE * 3);
  hdfs.createSnapshot(sub,"s3");
  checkQuotaUsageComputation(sub,5,BLOCKSIZE * 3);
  hdfs.setOwner(sub,"user3","group3");
  checkQuotaUsageComputation(sub,5,BLOCKSIZE * 3);
  hdfs.deleteSnapshot(sub,"s3");
  checkQuotaUsageComputation(sub,4,BLOCKSIZE * 3);
  FileStatus statusOfS2=hdfs.getFileStatus(new Path(sub,HdfsConstants.DOT_SNAPSHOT_DIR + "/s2"));
  assertEquals("user2",statusOfS2.getOwner());
  assertEquals("group2",statusOfS2.getGroup());
  hdfs.deleteSnapshot(sub,"s2");
  checkQuotaUsageComputation(sub,3,BLOCKSIZE * 3);
  FileStatus statusOfS1=hdfs.getFileStatus(new Path(sub,HdfsConstants.DOT_SNAPSHOT_DIR + "/s1"));
  assertEquals("user1",statusOfS1.getOwner());
  assertEquals("group1",statusOfS1.getGroup());
}
