{
  Connection conn=null;
  try {
    conn=ConnectionFactory.createConnection(hbaseConf);
    Admin admin=conn.getAdmin();
    if (admin == null) {
      throw new IOException("Cannot create table since admin is null");
    }
    try {
      new EntityTable().createTable(admin,hbaseConf);
    }
 catch (    IOException e) {
      if (skipExisting) {
        LOG.warn("Skip and continue on: " + e.getMessage());
      }
 else {
        throw e;
      }
    }
    try {
      new AppToFlowTable().createTable(admin,hbaseConf);
    }
 catch (    IOException e) {
      if (skipExisting) {
        LOG.warn("Skip and continue on: " + e.getMessage());
      }
 else {
        throw e;
      }
    }
    try {
      new ApplicationTable().createTable(admin,hbaseConf);
    }
 catch (    IOException e) {
      if (skipExisting) {
        LOG.warn("Skip and continue on: " + e.getMessage());
      }
 else {
        throw e;
      }
    }
  }
  finally {
    if (conn != null) {
      conn.close();
    }
  }
}
