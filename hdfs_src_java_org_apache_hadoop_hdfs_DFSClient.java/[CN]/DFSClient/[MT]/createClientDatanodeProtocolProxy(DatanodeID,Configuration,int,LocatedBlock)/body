{
  InetSocketAddress addr=NetUtils.createSocketAddr(datanodeid.getHost() + ":" + datanodeid.getIpcPort());
  if (ClientDatanodeProtocol.LOG.isDebugEnabled()) {
    ClientDatanodeProtocol.LOG.debug("ClientDatanodeProtocol addr=" + addr);
  }
  Configuration confWithNoIpcIdle=new Configuration(conf);
  confWithNoIpcIdle.setInt(CommonConfigurationKeysPublic.IPC_CLIENT_CONNECTION_MAXIDLETIME_KEY,0);
  UserGroupInformation ticket=UserGroupInformation.createRemoteUser(locatedBlock.getBlock().getLocalBlock().toString());
  ticket.addToken(locatedBlock.getBlockToken());
  return (ClientDatanodeProtocol)RPC.getProxy(ClientDatanodeProtocol.class,ClientDatanodeProtocol.versionID,addr,ticket,confWithNoIpcIdle,NetUtils.getDefaultSocketFactory(conf),socketTimeout);
}
