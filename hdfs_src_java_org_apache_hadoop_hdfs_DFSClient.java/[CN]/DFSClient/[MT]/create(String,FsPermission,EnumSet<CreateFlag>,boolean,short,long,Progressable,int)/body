{
  checkOpen();
  if (permission == null) {
    permission=FsPermission.getDefault();
  }
  FsPermission masked=permission.applyUMask(FsPermission.getUMask(conf));
  if (LOG.isDebugEnabled()) {
    LOG.debug(src + ": masked=" + masked);
  }
  final DFSOutputStream result=new DFSOutputStream(this,src,masked,flag,createParent,replication,blockSize,progress,buffersize,conf.getInt(DFSConfigKeys.DFS_BYTES_PER_CHECKSUM_KEY,DFSConfigKeys.DFS_BYTES_PER_CHECKSUM_DEFAULT));
  leaserenewer.put(src,result,this);
  return result;
}
