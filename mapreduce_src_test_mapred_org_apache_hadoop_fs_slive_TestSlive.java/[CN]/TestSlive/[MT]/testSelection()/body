{
  ConfigExtractor extractor=getTestConfig(false);
  WeightSelector selector=new WeightSelector(extractor,rnd);
  int expected=OperationType.values().length;
  Operation op=null;
  Set<String> types=new HashSet<String>();
  FileSystem fs=FileSystem.get(extractor.getConfig());
  while (true) {
    op=selector.select(1,1);
    if (op == null) {
      break;
    }
    op.run(fs);
    types.add(op.getType());
  }
  assertEquals(types.size(),expected);
}
