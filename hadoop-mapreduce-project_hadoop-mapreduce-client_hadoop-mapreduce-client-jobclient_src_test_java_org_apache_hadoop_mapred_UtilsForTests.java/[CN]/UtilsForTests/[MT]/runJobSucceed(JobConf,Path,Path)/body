{
  conf.setJobName("test-job-succeed");
  conf.setMapperClass(IdentityMapper.class);
  conf.setReducerClass(IdentityReducer.class);
  RunningJob job=UtilsForTests.runJob(conf,inDir,outDir);
  long sleepCount=0;
  while (!job.isComplete()) {
    try {
      if (sleepCount > 300) {
        throw new IOException("Job didn't finish in 30 seconds");
      }
      Thread.sleep(100);
      sleepCount++;
    }
 catch (    InterruptedException e) {
      break;
    }
  }
  return job;
}
