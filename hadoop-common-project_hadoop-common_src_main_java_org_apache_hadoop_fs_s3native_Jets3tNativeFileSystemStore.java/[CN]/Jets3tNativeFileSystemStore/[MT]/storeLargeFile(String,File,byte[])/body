{
  S3Object object=new S3Object(key);
  object.setDataInputFile(file);
  object.setContentType("binary/octet-stream");
  object.setContentLength(file.length());
  object.setServerSideEncryptionAlgorithm(serverSideEncryptionAlgorithm);
  if (md5Hash != null) {
    object.setMd5Hash(md5Hash);
  }
  List<StorageObject> objectsToUploadAsMultipart=new ArrayList<StorageObject>();
  objectsToUploadAsMultipart.add(object);
  MultipartUtils mpUtils=new MultipartUtils(multipartBlockSize);
  try {
    mpUtils.uploadObjects(bucket.getName(),s3Service,objectsToUploadAsMultipart,null);
  }
 catch (  ServiceException e) {
    handleServiceException(e);
  }
catch (  Exception e) {
    throw new S3Exception(e);
  }
}
