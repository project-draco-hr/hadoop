{
  if (dir.isQuotaSet()) {
    QuotaCounts q=dir.getDirectoryWithQuotaFeature().getSpaceConsumed();
    String name=dir.getFullPathName();
    if (verify) {
      assertEquals(nsMap.get(name).longValue(),q.getNameSpace());
      assertEquals(dsMap.get(name).longValue(),q.getStorageSpace());
    }
 else {
      nsMap.put(name,Long.valueOf(q.getNameSpace()));
      dsMap.put(name,Long.valueOf(q.getStorageSpace()));
    }
  }
  for (  INode child : dir.getChildrenList(Snapshot.CURRENT_STATE_ID)) {
    if (child instanceof INodeDirectory) {
      scanDirsWithQuota((INodeDirectory)child,nsMap,dsMap,verify);
    }
  }
}
