{
  final Path foo=new Path(dir,"foo");
  Path createdFile=new Path(foo,"created_file.data");
  dfs.mkdirs(foo);
  dfs.setQuota(foo,Long.MAX_VALUE - 1,Long.MAX_VALUE - 1);
  long fileLen=BLOCKSIZE * 2 + BLOCKSIZE / 2;
  DFSTestUtil.createFile(dfs,createdFile,BLOCKSIZE / 16,fileLen,BLOCKSIZE,REPLICATION,seed);
  INode fnode=fsdir.getINode4Write(foo.toString());
  assertTrue(fnode.isDirectory());
  assertTrue(fnode.isQuotaSet());
  Quota.Counts cnt=fnode.asDirectory().getDirectoryWithQuotaFeature().getSpaceConsumed();
  assertEquals(2,cnt.get(Quota.NAMESPACE));
  assertEquals(fileLen * REPLICATION,cnt.get(Quota.DISKSPACE));
}
