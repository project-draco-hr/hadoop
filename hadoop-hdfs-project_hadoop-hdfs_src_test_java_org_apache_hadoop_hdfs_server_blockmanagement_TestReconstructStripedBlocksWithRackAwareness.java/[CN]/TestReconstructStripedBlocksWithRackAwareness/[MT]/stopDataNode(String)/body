{
  MiniDFSCluster.DataNodeProperties dnProp=null;
  for (int i=0; i < cluster.getDataNodes().size(); i++) {
    DataNode dn=cluster.getDataNodes().get(i);
    if (dn.getDatanodeId().getHostName().equals(hostname)) {
      dnProp=cluster.stopDataNode(i);
      cluster.setDataNodeDead(dn.getDatanodeId());
      LOG.info("stop datanode " + dn.getDatanodeId().getHostName());
    }
  }
  return dnProp;
}
