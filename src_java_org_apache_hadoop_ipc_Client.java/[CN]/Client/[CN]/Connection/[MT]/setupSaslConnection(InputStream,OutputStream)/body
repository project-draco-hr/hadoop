{
  try {
    saslRpcClient=new SaslRpcClient(authMethod,token,serverPrincipal);
    return saslRpcClient.saslConnect(in2,out2);
  }
 catch (  javax.security.sasl.SaslException je) {
    UserGroupInformation loginUser=UserGroupInformation.getLoginUser();
    UserGroupInformation currentUser=UserGroupInformation.getCurrentUser();
    UserGroupInformation realUser=currentUser.getRealUser();
    if (authMethod == AuthMethod.KERBEROS && UserGroupInformation.isLoginKeytabBased() && ((currentUser != null && currentUser.equals(loginUser)) || (realUser != null && realUser.equals(loginUser)))) {
      try {
        loginUser.reloginFromKeytab();
        disposeSasl();
        saslRpcClient=new SaslRpcClient(authMethod,token,serverPrincipal);
        return saslRpcClient.saslConnect(in2,out2);
      }
 catch (      javax.security.sasl.SaslException jee) {
        LOG.warn("Couldn't setup connection for " + loginUser.getUserName() + " to "+ serverPrincipal+ " even after relogin.");
        throw jee;
      }
catch (      IOException ie) {
        ie.initCause(je);
        throw ie;
      }
    }
    throw je;
  }
}
