{
  try {
    saslRpcClient=new SaslRpcClient(authMethod,token,serverPrincipal);
    return saslRpcClient.saslConnect(in2,out2);
  }
 catch (  javax.security.sasl.SaslException je) {
    if (authMethod == AuthMethod.KERBEROS && UserGroupInformation.isLoginKeytabBased()) {
      UserGroupInformation.getCurrentUser().reloginFromKeytab();
      try {
        disposeSasl();
        saslRpcClient=new SaslRpcClient(authMethod,token,serverPrincipal);
        return saslRpcClient.saslConnect(in2,out2);
      }
 catch (      javax.security.sasl.SaslException jee) {
        UserGroupInformation.setLastUnsuccessfulAuthenticationAttemptTime(System.currentTimeMillis());
        LOG.warn("Couldn't setup connection for " + UserGroupInformation.getCurrentUser().getUserName() + " to "+ serverPrincipal+ " even after relogin.");
        throw jee;
      }
    }
 else     throw je;
  }
}
