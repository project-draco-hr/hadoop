{
  if (!UserGroupInformation.isSecurityEnabled() || protocol == null) {
    return null;
  }
  KerberosInfo krbInfo=protocol.getAnnotation(KerberosInfo.class);
  if (krbInfo != null) {
    String serverKey=krbInfo.serverPrincipal();
    if (serverKey == null) {
      throw new IOException("Can't obtain server Kerberos config key from protocol=" + protocol.getCanonicalName());
    }
    return SecurityUtil.getServerPrincipal(conf.get(serverKey),address.getAddress().getCanonicalHostName());
  }
  return null;
}
