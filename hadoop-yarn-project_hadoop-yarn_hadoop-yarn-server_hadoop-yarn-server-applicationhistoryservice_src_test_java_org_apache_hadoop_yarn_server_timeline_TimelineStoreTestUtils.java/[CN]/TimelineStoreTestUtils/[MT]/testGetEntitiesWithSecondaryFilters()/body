{
  List<TimelineEntity> entities=getEntitiesWithFilters("type_1",null,goodTestingFilters);
  assertEquals(3,entities.size());
  verifyEntityInfo(entityId1,entityType1,events1,EMPTY_REL_ENTITIES,primaryFilters,otherInfo,entities.get(0),domainId1);
  verifyEntityInfo(entityId1b,entityType1,events1,EMPTY_REL_ENTITIES,primaryFilters,otherInfo,entities.get(1),domainId1);
  verifyEntityInfo(entityId6,entityType1,EMPTY_EVENTS,EMPTY_REL_ENTITIES,primaryFilters,otherInfo,entities.get(2),domainId2);
  entities=getEntitiesWithFilters("type_1",userFilter,goodTestingFilters);
  assertEquals(3,entities.size());
  verifyEntityInfo(entityId1,entityType1,events1,EMPTY_REL_ENTITIES,primaryFilters,otherInfo,entities.get(0),domainId1);
  verifyEntityInfo(entityId1b,entityType1,events1,EMPTY_REL_ENTITIES,primaryFilters,otherInfo,entities.get(1),domainId1);
  verifyEntityInfo(entityId6,entityType1,EMPTY_EVENTS,EMPTY_REL_ENTITIES,primaryFilters,otherInfo,entities.get(2),domainId2);
  entities=getEntitiesWithFilters("type_1",null,Collections.singleton(new NameValuePair("user","none")));
  assertEquals(0,entities.size());
  entities=getEntitiesWithFilters("type_1",null,badTestingFilters);
  assertEquals(0,entities.size());
  entities=getEntitiesWithFilters("type_1",userFilter,badTestingFilters);
  assertEquals(0,entities.size());
  entities=getEntitiesWithFilters("type_5",null,badTestingFilters);
  assertEquals(0,entities.size());
}
