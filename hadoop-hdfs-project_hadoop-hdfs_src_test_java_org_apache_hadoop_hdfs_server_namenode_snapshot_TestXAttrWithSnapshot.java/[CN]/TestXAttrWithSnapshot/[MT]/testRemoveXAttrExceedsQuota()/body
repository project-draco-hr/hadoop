{
  Path filePath=new Path(path,"file1");
  Path fileSnapshotPath=new Path(snapshotPath,"file1");
  FileSystem.mkdirs(hdfs,path,FsPermission.createImmutable((short)0755));
  hdfs.allowSnapshot(path);
  hdfs.setQuota(path,3,HdfsConstants.QUOTA_DONT_SET);
  FileSystem.create(hdfs,filePath,FsPermission.createImmutable((short)0600)).close();
  hdfs.setXAttr(filePath,name1,value1);
  hdfs.createSnapshot(path,snapshotName);
  byte[] value=hdfs.getXAttr(filePath,name1);
  Assert.assertArrayEquals(value,value1);
  value=hdfs.getXAttr(fileSnapshotPath,name1);
  Assert.assertArrayEquals(value,value1);
  exception.expect(NSQuotaExceededException.class);
  hdfs.removeXAttr(filePath,name1);
}
