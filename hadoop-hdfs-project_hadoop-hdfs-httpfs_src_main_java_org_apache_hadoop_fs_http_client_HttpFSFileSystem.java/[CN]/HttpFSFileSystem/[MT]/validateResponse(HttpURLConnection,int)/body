{
  int status=conn.getResponseCode();
  if (status != expected) {
    try {
      JSONObject json=(JSONObject)jsonParse(conn);
      json=(JSONObject)json.get(ERROR_JSON);
      String message=(String)json.get(ERROR_MESSAGE_JSON);
      String exception=(String)json.get(ERROR_EXCEPTION_JSON);
      String className=(String)json.get(ERROR_CLASSNAME_JSON);
      try {
        ClassLoader cl=HttpFSFileSystem.class.getClassLoader();
        Class klass=cl.loadClass(className);
        Constructor constr=klass.getConstructor(String.class);
        throw (IOException)constr.newInstance(message);
      }
 catch (      IOException ex) {
        throw ex;
      }
catch (      Exception ex) {
        throw new IOException(MessageFormat.format("{0} - {1}",exception,message));
      }
    }
 catch (    IOException ex) {
      if (ex.getCause() instanceof IOException) {
        throw (IOException)ex.getCause();
      }
      throw new IOException(MessageFormat.format("HTTP status [{0}], {1}",status,conn.getResponseMessage()));
    }
  }
}
