{
  if (makeQualified) {
    path=makeQualified(path);
  }
  final URL url=HttpFSUtils.createURL(path,params,multiValuedParams);
  try {
    return UserGroupInformation.getCurrentUser().doAs(new PrivilegedExceptionAction<HttpURLConnection>(){
      @Override public HttpURLConnection run() throws Exception {
        return getConnection(url,method);
      }
    }
);
  }
 catch (  Exception ex) {
    if (ex instanceof IOException) {
      throw (IOException)ex;
    }
 else {
      throw new IOException(ex);
    }
  }
}
