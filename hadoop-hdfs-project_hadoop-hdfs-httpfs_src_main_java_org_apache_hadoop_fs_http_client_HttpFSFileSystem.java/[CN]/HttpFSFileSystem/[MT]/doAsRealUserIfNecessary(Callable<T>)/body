{
  try {
    if (realUser.getShortUserName().equals(doAs)) {
      return callable.call();
    }
 else {
      return realUser.doAs(new PrivilegedExceptionAction<T>(){
        @Override public T run() throws Exception {
          return callable.call();
        }
      }
);
    }
  }
 catch (  Exception ex) {
    throw new IOException(ex.toString(),ex);
  }
}
