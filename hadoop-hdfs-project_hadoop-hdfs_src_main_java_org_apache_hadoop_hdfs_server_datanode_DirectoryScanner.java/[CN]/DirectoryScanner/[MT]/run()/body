{
  try {
    if (!shouldRun) {
      LOG.warn("this cycle terminating immediately because 'shouldRun' has been deactivated");
      return;
    }
    String[] bpids=dataset.getBlockPoolList();
    for (    String bpid : bpids) {
      UpgradeManagerDatanode um=datanode.getUpgradeManagerDatanode(bpid);
      if (um != null && !um.isUpgradeCompleted()) {
        LOG.warn("this cycle terminating immediately because Distributed Upgrade is in process");
        return;
      }
    }
    reconcile();
  }
 catch (  Exception e) {
    LOG.error("Exception during DirectoryScanner execution - will continue next cycle",e);
  }
catch (  Error er) {
    LOG.error("System Error during DirectoryScanner execution - permanently terminating periodic scanner",er);
    throw er;
  }
}
