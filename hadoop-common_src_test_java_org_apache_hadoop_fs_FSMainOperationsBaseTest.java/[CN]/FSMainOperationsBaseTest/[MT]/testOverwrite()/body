{
  Path path=getTestRootPath(fSys,"test/hadoop/file");
  fSys.mkdirs(path.getParent());
  createFile(path);
  Assert.assertTrue("Exists",exists(fSys,path));
  Assert.assertEquals("Length",data.length,fSys.getFileStatus(path).getLen());
  try {
    createFile(path);
    Assert.fail("Should throw IOException.");
  }
 catch (  IOException e) {
  }
  FSDataOutputStream out=fSys.create(path,true,4096);
  out.write(data,0,data.length);
  out.close();
  Assert.assertTrue("Exists",exists(fSys,path));
  Assert.assertEquals("Length",data.length,fSys.getFileStatus(path).getLen());
}
