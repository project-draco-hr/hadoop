{
  AppendRequestProto req=AppendRequestProto.newBuilder().setSrc(src).setClientName(clientName).setFlag(PBHelper.convertCreateFlag(flag)).build();
  try {
    AppendResponseProto res=rpcProxy.append(null,req);
    LocatedBlock lastBlock=res.hasBlock() ? PBHelper.convertLocatedBlockProto(res.getBlock()) : null;
    HdfsFileStatus stat=(res.hasStat()) ? PBHelper.convert(res.getStat()) : null;
    return new LastBlockWithStatus(lastBlock,stat);
  }
 catch (  ServiceException e) {
    throw ProtobufHelper.getRemoteException(e);
  }
}
