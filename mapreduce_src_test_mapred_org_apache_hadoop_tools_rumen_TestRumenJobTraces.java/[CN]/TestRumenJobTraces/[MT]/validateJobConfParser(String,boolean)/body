{
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  @SuppressWarnings("deprecation") final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs);
  final Path rootInputPath=new Path(rootInputDir,"rumen/small-trace-test");
  final Path inputPath=new Path(rootInputPath,confFile);
  InputStream inputConfStream=new PossiblyDecompressedInputStream(inputPath,conf);
  try {
    Properties props=JobConfigurationParser.parse(inputConfStream);
    inputConfStream.close();
    String oldOrNew=newConfig ? "New" : "Old";
    assertEquals(oldOrNew + " config property for job queue name is not " + " extracted properly.","TheQueue",JobBuilder.extract(props,JobConfPropertyNames.QUEUE_NAMES.getCandidates(),null));
    assertEquals(oldOrNew + " config property for job name is not " + " extracted properly.","MyMRJob",JobBuilder.extract(props,JobConfPropertyNames.JOB_NAMES.getCandidates(),null));
    validateChildJavaOpts(newConfig,props);
  }
  finally {
    inputConfStream.close();
  }
}
