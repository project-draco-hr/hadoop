{
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  String user="test";
  org.apache.hadoop.mapred.JobID jid=new org.apache.hadoop.mapred.JobID("12345",1);
  final Path rootInputDir=new Path(System.getProperty("test.tools.input.dir","")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  Path jhFilename=JobHistory.getJobHistoryFile(rootInputDir,jid,user);
  JobID extractedJID=JobID.forName(TraceBuilder.extractJobID(jhFilename.getName()));
  assertEquals("TraceBuilder failed to parse the current JH filename",jid,extractedJID);
  jhFilename=jhFilename.suffix(JobHistory.getOldFileSuffix("123"));
  extractedJID=JobID.forName(TraceBuilder.extractJobID(jhFilename.getName()));
  assertEquals("TraceBuilder failed to parse the current JH filename" + "(old-suffix)",jid,extractedJID);
  Path jhConfFilename=JobHistory.getConfFile(rootInputDir,jid);
  assertTrue("TraceBuilder failed to parse the current JH conf filename",TraceBuilder.isJobConfXml(jhConfFilename.getName(),null));
  jhConfFilename=jhConfFilename.suffix(JobHistory.getOldFileSuffix("123"));
  assertTrue("TraceBuilder failed to parse the current JH conf filename" + " (old suffix)",TraceBuilder.isJobConfXml(jhConfFilename.getName(),null));
}
