{
  final Configuration conf=new Configuration();
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(lfs.getUri(),lfs.getWorkingDirectory());
  Path testRootInputDir=new Path(rootTempDir,"TestProcessInputArgument");
  Path nestedInputDir=new Path(testRootInputDir,"1/2/3/4");
  Path globbedInputNestedDir=lfs.makeQualified(new Path(testRootInputDir,"*/*/*/*/*"));
  try {
    lfs.delete(nestedInputDir,true);
    List<String> recursiveInputPaths=new ArrayList<String>();
    List<String> nonRecursiveInputPaths=new ArrayList<String>();
    createHistoryLogsHierarchy(nestedInputDir,lfs,recursiveInputPaths,nonRecursiveInputPaths);
    List<Path> inputs=MyOptions.processInputArgument(globbedInputNestedDir.toString(),conf,false);
    validateHistoryLogPaths(inputs,nonRecursiveInputPaths);
    inputs=MyOptions.processInputArgument(globbedInputNestedDir.toString(),conf,true);
    validateHistoryLogPaths(inputs,recursiveInputPaths);
  }
  finally {
    lfs.delete(testRootInputDir,true);
  }
}
