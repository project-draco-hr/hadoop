{
  Configuration conf=new Configuration();
  Path rootInputDir=new Path(System.getProperty("test.tools.input.dir",""));
  Path rootInputSubFolder=new Path(rootInputDir,"rumen/small-trace-test");
  Path traceFile=new Path(rootInputSubFolder,"v20-resource-usage-log.gz");
  FileSystem lfs=FileSystem.getLocal(conf);
  Path rootTempDir=new Path(System.getProperty("test.build.data","/tmp"));
  Path outputDir=new Path(rootTempDir,"testResourceUsageMetricsWithHadoopLogsAnalyzer");
  lfs.delete(outputDir,true);
  lfs.deleteOnExit(outputDir);
  HadoopLogsAnalyzer analyzer=new HadoopLogsAnalyzer();
  analyzer.setConf(conf);
  Path traceOutput=new Path(outputDir,"trace.json");
  analyzer.run(new String[]{"-write-job-trace",traceOutput.toString(),"-v1",traceFile.toString()});
  JsonObjectMapperParser<LoggedJob> traceParser=new JsonObjectMapperParser<LoggedJob>(traceOutput,LoggedJob.class,conf);
  LoggedJob job=traceParser.getNext();
  LoggedTaskAttempt attempt=job.getMapTasks().get(0).getAttempts().get(0);
  ResourceUsageMetrics metrics=attempt.getResourceUsageMetrics();
  testResourceUsageMetricViaDeepCompare(metrics,200,100,75,50,true);
}
