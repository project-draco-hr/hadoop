{
  final TopologyBuilder subject=new TopologyBuilder();
  subject.process(new Properties());
  subject.process(new TaskAttemptFinishedEvent(TaskAttemptID.forName("attempt_200904211745_0003_m_000004_0"),TaskType.valueOf("MAP"),"STATUS",1234567890L,"/194\\.6\\.134\\.64/cluster50261\\.secondleveldomain\\.com","SUCCESS",null));
  subject.process(new TaskAttemptUnsuccessfulCompletionEvent(TaskAttemptID.forName("attempt_200904211745_0003_m_000004_1"),TaskType.valueOf("MAP"),"STATUS",1234567890L,"/194\\.6\\.134\\.80/cluster50262\\.secondleveldomain\\.com","MACHINE_EXPLODED"));
  subject.process(new TaskAttemptUnsuccessfulCompletionEvent(TaskAttemptID.forName("attempt_200904211745_0003_m_000004_2"),TaskType.valueOf("MAP"),"STATUS",1234567890L,"/194\\.6\\.134\\.80/cluster50263\\.secondleveldomain\\.com","MACHINE_EXPLODED"));
  subject.process(new TaskStartedEvent(TaskID.forName("task_200904211745_0003_m_000004"),1234567890L,TaskType.valueOf("MAP"),"/194\\.6\\.134\\.80/cluster50263\\.secondleveldomain\\.com"));
  final LoggedNetworkTopology topology=subject.build();
  List<LoggedNetworkTopology> racks=topology.getChildren();
  assertEquals("Wrong number of racks",2,racks.size());
  boolean sawSingleton=false;
  boolean sawDoubleton=false;
  for (  LoggedNetworkTopology rack : racks) {
    List<LoggedNetworkTopology> nodes=rack.getChildren();
    if (rack.getName().endsWith(".64")) {
      assertEquals("The singleton rack has the wrong number of elements",1,nodes.size());
      sawSingleton=true;
    }
 else     if (rack.getName().endsWith(".80")) {
      assertEquals("The doubleton rack has the wrong number of elements",2,nodes.size());
      sawDoubleton=true;
    }
 else {
      assertTrue("Unrecognized rack name",false);
    }
  }
  assertTrue("Did not see singleton rack",sawSingleton);
  assertTrue("Did not see doubleton rack",sawDoubleton);
}
