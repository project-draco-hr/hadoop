{
  if (closed) {
    return;
  }
  flush();
  if (filePos == 0 || bytesWrittenToBlock != 0) {
    endBlock();
  }
  backupStream.close();
  boolean b=backupFile.delete();
  if (!b) {
    LOG.warn("Ignoring failed delete");
  }
  super.close();
  closed=true;
}
