{
  Container container=null;
  org.apache.hadoop.yarn.server.nodemanager.containermanager.container.ContainerState currentState=null;
  int timeoutSecs=0;
  do {
    Thread.sleep(2000);
    container=containerManager.getContext().getContainers().get(containerID);
    if (container != null) {
      currentState=container.getContainerState();
    }
    if (currentState != null) {
      LOG.info("Waiting for NM container to get into state " + finalState + ". Current state is "+ currentState);
    }
    timeoutSecs+=2;
  }
 while (!currentState.equals(finalState) && timeoutSecs++ < timeOutMax);
  LOG.info("Container state is " + currentState);
  Assert.assertEquals("ContainerState is not correct (timedout)",finalState,currentState);
}
