{
  Container container=containerManager.getContext().getContainers().get(containerID);
  org.apache.hadoop.yarn.server.nodemanager.containermanager.container.ContainerState currentState=container.getContainerState();
  int timeoutSecs=0;
  while (!currentState.equals(finalState) && timeoutSecs++ < timeOutMax) {
    Thread.sleep(1000);
    LOG.info("Waiting for NM container to get into state " + finalState + ". Current state is "+ currentState);
    currentState=container.getContainerState();
  }
  LOG.info("Container state is " + currentState);
  Assert.assertEquals("ContainerState is not correct (timedout)",finalState,currentState);
}
