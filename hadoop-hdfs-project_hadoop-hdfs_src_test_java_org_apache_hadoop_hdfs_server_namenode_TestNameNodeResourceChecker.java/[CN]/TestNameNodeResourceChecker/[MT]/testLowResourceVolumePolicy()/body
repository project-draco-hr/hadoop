{
  Configuration conf=new Configuration();
  File nameDir1=new File(System.getProperty("test.build.data"),"name-dir1");
  File nameDir2=new File(System.getProperty("test.build.data"),"name-dir2");
  nameDir1.mkdirs();
  nameDir2.mkdirs();
  conf.set(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY,nameDir1.getAbsolutePath() + "," + nameDir2.getAbsolutePath());
  NameNodeResourceChecker nnrc=new NameNodeResourceChecker(conf);
  Map<String,DF> volumes=new HashMap<String,DF>();
  volumes.put("volume1",new DF(nameDir1,conf));
  volumes.put("volume2",new DF(nameDir2,conf));
  nnrc.setVolumes(volumes);
  NameNodeResourceChecker spyNnrc=Mockito.spy(nnrc);
  Mockito.when(spyNnrc.getVolumesLowOnSpace()).thenReturn(Lists.newArrayList("volume1"));
  assertTrue(spyNnrc.hasAvailableDiskSpace());
  Mockito.when(spyNnrc.getVolumesLowOnSpace()).thenReturn(Lists.newArrayList("volume1","volume2"));
  assertFalse(spyNnrc.hasAvailableDiskSpace());
}
