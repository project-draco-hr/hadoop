{
  index++;
  for (int i=0; i < K.length; i++) {
    for (int j=0; j < K[i]; j++) {
      d[i][j]++;
      x[i]+=q[i][j];
      if (d[i][j] < P[i]) {
        break;
      }
      d[i][j]=0;
      x[i]-=(j == 0 ? 1.0 : q[i][j - 1]);
    }
  }
  return x;
}
