{
  Path file=new Path(inDir,jobName + IN_FILE_SUFFIX);
  FileSystem fs=file.getFileSystem(getConf());
  SequenceFile.Writer fileOut=SequenceFile.createWriter(fs,getConf(),file,LongWritable.class,Text.class);
  long index=0L;
  List<Path> filesAdded=new LinkedList<Path>();
  for (  Path corruptFile : corruptFiles) {
    if (pendingFiles >= maxPendingFiles) {
      break;
    }
    String corruptFileName=corruptFile.toString();
    fileOut.append(new LongWritable(index++),new Text(corruptFileName));
    filesAdded.add(corruptFile);
    pendingFiles++;
    if (index % filesPerTask == 0) {
      fileOut.sync();
    }
  }
  fileOut.close();
  return filesAdded;
}
