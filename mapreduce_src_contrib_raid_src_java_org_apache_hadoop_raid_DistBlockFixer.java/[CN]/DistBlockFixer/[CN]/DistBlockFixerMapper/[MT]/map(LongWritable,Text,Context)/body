{
  BlockFixerHelper helper=new BlockFixerHelper(context.getConfiguration());
  String fileStr=fileText.toString();
  LOG.info("fixing " + fileStr);
  Path file=new Path(fileStr);
  boolean success=false;
  try {
    boolean fixed=helper.fixFile(file,context);
    if (fixed) {
      context.getCounter(Counter.FILES_SUCCEEDED).increment(1L);
    }
 else {
      context.getCounter(Counter.FILES_NOACTION).increment(1L);
    }
  }
 catch (  Exception e) {
    LOG.error(StringUtils.stringifyException(e));
    context.getCounter(Counter.FILES_FAILED).increment(1L);
    String outkey=fileStr;
    String outval="failed";
    context.write(new Text(outkey),new Text(outval));
  }
  context.progress();
}
