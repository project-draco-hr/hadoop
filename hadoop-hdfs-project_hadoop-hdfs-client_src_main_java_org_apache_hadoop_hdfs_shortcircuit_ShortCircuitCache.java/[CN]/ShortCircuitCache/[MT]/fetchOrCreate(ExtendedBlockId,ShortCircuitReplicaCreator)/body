{
  Waitable<ShortCircuitReplicaInfo> newWaitable=null;
  lock.lock();
  try {
    ShortCircuitReplicaInfo info=null;
    do {
      if (closed) {
        LOG.trace("{}: can't fethchOrCreate {} because the cache is closed.",this,key);
        return null;
      }
      Waitable<ShortCircuitReplicaInfo> waitable=replicaInfoMap.get(key);
      if (waitable != null) {
        try {
          info=fetch(key,waitable);
        }
 catch (        RetriableException e) {
          LOG.debug("{}: retrying {}",this,e.getMessage());
          continue;
        }
      }
    }
 while (false);
    if (info != null)     return info;
    newWaitable=new Waitable<ShortCircuitReplicaInfo>(lock.newCondition());
    replicaInfoMap.put(key,newWaitable);
  }
  finally {
    lock.unlock();
  }
  return create(key,creator,newWaitable);
}
