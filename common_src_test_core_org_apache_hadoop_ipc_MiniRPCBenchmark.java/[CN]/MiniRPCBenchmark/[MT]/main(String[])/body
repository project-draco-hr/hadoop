{
  System.out.println("Benchmark: RPC session establishment.");
  if (args.length < 1)   printUsage();
  Configuration conf=new Configuration();
  int count=Integer.parseInt(args[0]);
  if (args.length > 1)   conf.set(KEYTAB_FILE_KEY,args[1]);
  if (args.length > 2)   conf.set(USER_NAME_KEY,args[2]);
  boolean useDelegationToken=false;
  if (args.length > 3)   useDelegationToken=args[3].equalsIgnoreCase("useToken");
  Level l=Level.ERROR;
  if (args.length > 4)   l=Level.toLevel(args[4]);
  MiniRPCBenchmark mb=new MiniRPCBenchmark(l);
  long elapsedTime=0;
  if (useDelegationToken) {
    System.out.println("Running MiniRPCBenchmark with delegation token authentication.");
    elapsedTime=mb.runMiniBenchmarkWithDelegationToken(conf,count,KEYTAB_FILE_KEY,USER_NAME_KEY);
  }
 else {
    String auth=conf.get(CommonConfigurationKeys.HADOOP_SECURITY_AUTHENTICATION,"simple");
    System.out.println("Running MiniRPCBenchmark with " + auth + " authentication.");
    elapsedTime=mb.runMiniBenchmark(conf,count,KEYTAB_FILE_KEY,USER_NAME_KEY);
  }
  System.out.println(org.apache.hadoop.util.VersionInfo.getVersion());
  System.out.println("Number  of  connects: " + count);
  System.out.println("Average connect time: " + ((double)elapsedTime / count));
}
