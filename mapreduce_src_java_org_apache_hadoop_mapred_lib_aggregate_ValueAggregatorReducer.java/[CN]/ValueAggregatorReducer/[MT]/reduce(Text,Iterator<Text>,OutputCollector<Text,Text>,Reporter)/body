{
  String keyStr=key.toString();
  int pos=keyStr.indexOf(ValueAggregatorDescriptor.TYPE_SEPARATOR);
  String type=keyStr.substring(0,pos);
  keyStr=keyStr.substring(pos + ValueAggregatorDescriptor.TYPE_SEPARATOR.length());
  ValueAggregator aggregator=ValueAggregatorBaseDescriptor.generateValueAggregator(type);
  while (values.hasNext()) {
    aggregator.addNextValue(values.next());
  }
  String val=aggregator.getReport();
  key=new Text(keyStr);
  output.collect(key,new Text(val));
}
