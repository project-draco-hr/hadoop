{
  mgr.activateNode(NodeId.newInstance("n1",1),Resource.newInstance(10,0));
  Assert.assertTrue(mgr.getLabelsToNodes().isEmpty());
  assertLabelsToNodesEquals(mgr.getLabelsToNodes(),transposeNodeToLabels(mgr.getNodeLabels()));
  mgr.addToCluserNodeLabels(toSet("p1","p2","p3"));
  mgr.replaceLabelsOnNode(ImmutableMap.of(toNodeId("n1"),toSet("p1"),toNodeId("n2"),toSet("p2"),toNodeId("n3"),toSet("p3")));
  assertLabelsToNodesEquals(mgr.getLabelsToNodes(),transposeNodeToLabels(mgr.getNodeLabels()));
  mgr.activateNode(NodeId.newInstance("n1",2),Resource.newInstance(10,0));
  assertLabelsToNodesEquals(mgr.getLabelsToNodes(),transposeNodeToLabels(mgr.getNodeLabels()));
  mgr.deactivateNode(NodeId.newInstance("n1",1));
  assertLabelsToNodesEquals(mgr.getLabelsToNodes(),transposeNodeToLabels(mgr.getNodeLabels()));
}
