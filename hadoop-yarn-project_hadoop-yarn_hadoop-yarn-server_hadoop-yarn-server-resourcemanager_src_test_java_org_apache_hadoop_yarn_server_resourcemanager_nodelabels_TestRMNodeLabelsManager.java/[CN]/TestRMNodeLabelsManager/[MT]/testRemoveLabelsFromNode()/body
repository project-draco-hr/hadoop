{
  mgr.addToCluserNodeLabels(toSet("p1","p2","p3"));
  mgr.replaceLabelsOnNode(ImmutableMap.of(toNodeId("n1"),toSet("p1"),toNodeId("n2"),toSet("p2"),toNodeId("n3"),toSet("p3")));
  mgr.activateNode(NodeId.newInstance("n1",1),SMALL_RESOURCE);
  try {
    mgr.removeLabelsFromNode(ImmutableMap.of(toNodeId("n1:1"),toSet("p1")));
    Assert.fail("removeLabelsFromNode should trigger IOException");
  }
 catch (  IOException e) {
  }
  mgr.replaceLabelsOnNode(ImmutableMap.of(toNodeId("n1:1"),toSet("p1")));
  try {
    mgr.removeLabelsFromNode(ImmutableMap.of(toNodeId("n1:1"),toSet("p1")));
  }
 catch (  IOException e) {
    Assert.fail("IOException from removeLabelsFromNode " + e);
  }
}
