{
  mgr.addToCluserNodeLabels(toSet("x","y","z"));
  mgr.activateNode(NodeId.newInstance("n1",1),Resource.newInstance(10,0));
  mgr.activateNode(NodeId.newInstance("n2",1),Resource.newInstance(10,0));
  mgr.activateNode(NodeId.newInstance("n3",1),Resource.newInstance(10,0));
  mgr.activateNode(NodeId.newInstance("n4",1),Resource.newInstance(10,0));
  mgr.activateNode(NodeId.newInstance("n5",1),Resource.newInstance(10,0));
  mgr.replaceLabelsOnNode(ImmutableMap.of(toNodeId("n1"),toSet("x"),toNodeId("n2"),toSet("x"),toNodeId("n3"),toSet("y")));
  List<NodeLabel> infos=mgr.pullRMNodeLabelsInfo();
  Assert.assertEquals(4,infos.size());
  checkNodeLabelInfo(infos,RMNodeLabelsManager.NO_LABEL,2,20);
  checkNodeLabelInfo(infos,"x",2,20);
  checkNodeLabelInfo(infos,"y",1,10);
  checkNodeLabelInfo(infos,"z",0,0);
}
