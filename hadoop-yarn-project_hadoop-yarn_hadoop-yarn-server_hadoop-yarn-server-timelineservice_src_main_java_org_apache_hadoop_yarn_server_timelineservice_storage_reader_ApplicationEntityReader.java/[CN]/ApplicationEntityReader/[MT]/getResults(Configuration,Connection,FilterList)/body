{
  Scan scan=new Scan();
  TimelineReaderContext context=getContext();
  if (context.getFlowRunId() != null) {
    scan.setRowPrefixFilter(ApplicationRowKey.getRowKeyPrefix(context.getClusterId(),context.getUserId(),context.getFlowName(),context.getFlowRunId()));
  }
 else {
    scan.setRowPrefixFilter(ApplicationRowKey.getRowKeyPrefix(context.getClusterId(),context.getUserId(),context.getFlowName()));
  }
  FilterList newList=new FilterList();
  newList.addFilter(new PageFilter(getFilters().getLimit()));
  if (filterList != null && !filterList.getFilters().isEmpty()) {
    newList.addFilter(filterList);
  }
  scan.setFilter(newList);
  return getTable().getResultScanner(hbaseConf,conn,scan);
}
