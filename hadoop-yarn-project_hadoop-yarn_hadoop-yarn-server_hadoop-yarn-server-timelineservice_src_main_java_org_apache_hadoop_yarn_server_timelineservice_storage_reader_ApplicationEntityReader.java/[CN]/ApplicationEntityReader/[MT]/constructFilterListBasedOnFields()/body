{
  FilterList list=new FilterList(Operator.MUST_PASS_ONE);
  TimelineDataToRetrieve dataToRetrieve=getDataToRetrieve();
  if (dataToRetrieve.getFieldsToRetrieve().contains(Field.ALL) && (dataToRetrieve.getConfsToRetrieve() == null || dataToRetrieve.getConfsToRetrieve().getFilterList().isEmpty()) && (dataToRetrieve.getMetricsToRetrieve() == null || dataToRetrieve.getMetricsToRetrieve().getFilterList().isEmpty())) {
    return list;
  }
  FilterList infoColFamilyList=new FilterList();
  FamilyFilter infoColumnFamily=new FamilyFilter(CompareOp.EQUAL,new BinaryComparator(ApplicationColumnFamily.INFO.getBytes()));
  infoColFamilyList.addFilter(infoColumnFamily);
  TimelineEntityFilters filters=getFilters();
  if (!dataToRetrieve.getFieldsToRetrieve().contains(Field.EVENTS) && !dataToRetrieve.getFieldsToRetrieve().contains(Field.ALL) && (singleEntityRead || filters.getEventFilters() == null)) {
    infoColFamilyList.addFilter(new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryPrefixComparator(ApplicationColumnPrefix.EVENT.getColumnPrefixBytes(""))));
  }
  if (!dataToRetrieve.getFieldsToRetrieve().contains(Field.INFO) && !dataToRetrieve.getFieldsToRetrieve().contains(Field.ALL) && (singleEntityRead || filters.getInfoFilters() == null)) {
    infoColFamilyList.addFilter(new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryPrefixComparator(ApplicationColumnPrefix.INFO.getColumnPrefixBytes(""))));
  }
  if (!dataToRetrieve.getFieldsToRetrieve().contains(Field.IS_RELATED_TO) && !dataToRetrieve.getFieldsToRetrieve().contains(Field.ALL) && (singleEntityRead || filters.getIsRelatedTo() == null)) {
    infoColFamilyList.addFilter(new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryPrefixComparator(ApplicationColumnPrefix.IS_RELATED_TO.getColumnPrefixBytes(""))));
  }
  if (!dataToRetrieve.getFieldsToRetrieve().contains(Field.RELATES_TO) && !dataToRetrieve.getFieldsToRetrieve().contains(Field.ALL) && (singleEntityRead || filters.getRelatesTo() == null)) {
    infoColFamilyList.addFilter(new QualifierFilter(CompareOp.NOT_EQUAL,new BinaryPrefixComparator(ApplicationColumnPrefix.RELATES_TO.getColumnPrefixBytes(""))));
  }
  list.addFilter(infoColFamilyList);
  if ((dataToRetrieve.getFieldsToRetrieve().contains(Field.CONFIGS) || (!singleEntityRead && filters.getConfigFilters() != null)) || (dataToRetrieve.getConfsToRetrieve() != null && !dataToRetrieve.getConfsToRetrieve().getFilterList().isEmpty())) {
    FilterList filterCfg=new FilterList(new FamilyFilter(CompareOp.EQUAL,new BinaryComparator(ApplicationColumnFamily.CONFIGS.getBytes())));
    if (dataToRetrieve.getConfsToRetrieve() != null && !dataToRetrieve.getConfsToRetrieve().getFilterList().isEmpty()) {
      filterCfg.addFilter(TimelineFilterUtils.createHBaseFilterList(ApplicationColumnPrefix.CONFIG,dataToRetrieve.getConfsToRetrieve()));
    }
    list.addFilter(filterCfg);
  }
  if ((dataToRetrieve.getFieldsToRetrieve().contains(Field.METRICS) || (!singleEntityRead && filters.getMetricFilters() != null)) || (dataToRetrieve.getMetricsToRetrieve() != null && !dataToRetrieve.getMetricsToRetrieve().getFilterList().isEmpty())) {
    FilterList filterMetrics=new FilterList(new FamilyFilter(CompareOp.EQUAL,new BinaryComparator(ApplicationColumnFamily.METRICS.getBytes())));
    if (dataToRetrieve.getMetricsToRetrieve() != null && !dataToRetrieve.getMetricsToRetrieve().getFilterList().isEmpty()) {
      filterMetrics.addFilter(TimelineFilterUtils.createHBaseFilterList(ApplicationColumnPrefix.METRIC,dataToRetrieve.getMetricsToRetrieve()));
    }
    list.addFilter(filterMetrics);
  }
  return list;
}
