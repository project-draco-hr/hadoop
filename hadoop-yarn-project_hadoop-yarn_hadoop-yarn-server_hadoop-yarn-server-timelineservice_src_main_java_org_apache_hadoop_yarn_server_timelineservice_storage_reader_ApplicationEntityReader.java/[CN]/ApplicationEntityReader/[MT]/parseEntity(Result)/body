{
  if (result == null || result.isEmpty()) {
    return null;
  }
  TimelineEntity entity=new TimelineEntity();
  entity.setType(TimelineEntityType.YARN_APPLICATION.toString());
  String entityId=ApplicationColumn.ID.readResult(result).toString();
  entity.setId(entityId);
  TimelineEntityFilters filters=getFilters();
  Number createdTime=(Number)ApplicationColumn.CREATED_TIME.readResult(result);
  entity.setCreatedTime(createdTime.longValue());
  if (!isSingleEntityRead() && (entity.getCreatedTime() < filters.getCreatedTimeBegin() || entity.getCreatedTime() > filters.getCreatedTimeEnd())) {
    return null;
  }
  EnumSet<Field> fieldsToRetrieve=getDataToRetrieve().getFieldsToRetrieve();
  boolean checkIsRelatedTo=filters != null && filters.getIsRelatedTo() != null && filters.getIsRelatedTo().size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.IS_RELATED_TO) || checkIsRelatedTo) {
    readRelationship(entity,result,ApplicationColumnPrefix.IS_RELATED_TO,true);
    if (checkIsRelatedTo && !TimelineStorageUtils.matchRelations(entity.getIsRelatedToEntities(),filters.getIsRelatedTo())) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.IS_RELATED_TO)) {
      entity.getIsRelatedToEntities().clear();
    }
  }
  boolean checkRelatesTo=filters != null && filters.getRelatesTo() != null && filters.getRelatesTo().size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.RELATES_TO) || checkRelatesTo) {
    readRelationship(entity,result,ApplicationColumnPrefix.RELATES_TO,false);
    if (checkRelatesTo && !TimelineStorageUtils.matchRelations(entity.getRelatesToEntities(),filters.getRelatesTo())) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.RELATES_TO)) {
      entity.getRelatesToEntities().clear();
    }
  }
  boolean checkInfo=filters != null && filters.getInfoFilters() != null && filters.getInfoFilters().size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.INFO) || checkInfo) {
    readKeyValuePairs(entity,result,ApplicationColumnPrefix.INFO,false);
    if (checkInfo && !TimelineStorageUtils.matchFilters(entity.getInfo(),filters.getInfoFilters())) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.INFO)) {
      entity.getInfo().clear();
    }
  }
  boolean checkConfigs=filters != null && filters.getConfigFilters() != null && filters.getConfigFilters().size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.CONFIGS) || checkConfigs) {
    readKeyValuePairs(entity,result,ApplicationColumnPrefix.CONFIG,true);
    if (checkConfigs && !TimelineStorageUtils.matchFilters(entity.getConfigs(),filters.getConfigFilters())) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.CONFIGS)) {
      entity.getConfigs().clear();
    }
  }
  boolean checkEvents=filters != null && filters.getEventFilters() != null && filters.getEventFilters().size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.EVENTS) || checkEvents) {
    readEvents(entity,result,true);
    if (checkEvents && !TimelineStorageUtils.matchEventFilters(entity.getEvents(),filters.getEventFilters())) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.EVENTS)) {
      entity.getEvents().clear();
    }
  }
  boolean checkMetrics=filters != null && filters.getMetricFilters() != null && filters.getMetricFilters().size() > 0;
  if (fieldsToRetrieve.contains(Field.ALL) || fieldsToRetrieve.contains(Field.METRICS) || checkMetrics) {
    readMetrics(entity,result,ApplicationColumnPrefix.METRIC);
    if (checkMetrics && !TimelineStorageUtils.matchMetricFilters(entity.getMetrics(),filters.getMetricFilters())) {
      return null;
    }
    if (!fieldsToRetrieve.contains(Field.ALL) && !fieldsToRetrieve.contains(Field.METRICS)) {
      entity.getMetrics().clear();
    }
  }
  return entity;
}
