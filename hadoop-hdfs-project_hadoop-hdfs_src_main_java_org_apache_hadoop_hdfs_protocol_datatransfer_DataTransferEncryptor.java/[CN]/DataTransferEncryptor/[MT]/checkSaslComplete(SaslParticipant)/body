{
  if (!sasl.isComplete()) {
    throw new IOException("Failed to complete SASL handshake");
  }
  if (!sasl.supportsConfidentiality()) {
    throw new IOException("SASL handshake completed, but channel does not " + "support encryption");
  }
}
