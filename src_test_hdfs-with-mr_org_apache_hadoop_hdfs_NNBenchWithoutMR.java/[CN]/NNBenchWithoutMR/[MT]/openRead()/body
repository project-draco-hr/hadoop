{
  int totalExceptions=0;
  FSDataInputStream in=null;
  for (int index=0; index < numFiles; index++) {
    int singleFileExceptions=0;
    try {
      in=fileSys.open(new Path(taskDir,"" + index),512);
      long toBeRead=bytesPerFile;
      while (toBeRead > 0) {
        int nbytes=(int)Math.min(buffer.length,toBeRead);
        toBeRead-=nbytes;
        try {
          in.read(buffer,0,nbytes);
        }
 catch (        IOException ioe) {
          totalExceptions++;
          handleException("reading from file #" + index,ioe,++singleFileExceptions);
        }
      }
      in.close();
    }
 catch (    IOException ioe) {
      totalExceptions++;
      handleException("opening file #" + index,ioe,++singleFileExceptions);
    }
  }
  return totalExceptions;
}
