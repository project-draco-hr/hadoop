{
  long endTime=System.currentTimeMillis() + millis;
  while (shouldRun() && finishedThreads.size() < testThreads.size()) {
    long left=endTime - System.currentTimeMillis();
    if (left <= 0)     break;
    checkException();
    wait(left);
  }
  checkException();
}
