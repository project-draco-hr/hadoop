{
  fs.delete(file,true);
  LOG.info("creating " + count + " records with metadata and with "+ compressionType+ " compression");
  SequenceFile.Writer writer=SequenceFile.createWriter(fs,conf,file,RandomDatum.class,RandomDatum.class,compressionType,codec,null,metadata);
  RandomDatum.Generator generator=new RandomDatum.Generator(seed);
  for (int i=0; i < count; i++) {
    generator.next();
    RandomDatum key=generator.getKey();
    RandomDatum value=generator.getValue();
    writer.append(key,value);
  }
  writer.close();
}
