{
  String policyFile=System.getProperty("hadoop.policy.file",HADOOP_POLICY_FILE);
  Configuration policyConf=new Configuration(conf);
  policyConf.addResource(policyFile);
  final Map<Class<?>,AccessControlList> newAcls=new IdentityHashMap<Class<?>,AccessControlList>();
  Service[] services=provider.getServices();
  if (services != null) {
    for (    Service service : services) {
      AccessControlList acl=new AccessControlList(policyConf.get(service.getServiceKey(),AccessControlList.WILDCARD_ACL_VALUE));
      newAcls.put(service.getProtocol(),acl);
    }
  }
  protocolToAcl=newAcls;
}
