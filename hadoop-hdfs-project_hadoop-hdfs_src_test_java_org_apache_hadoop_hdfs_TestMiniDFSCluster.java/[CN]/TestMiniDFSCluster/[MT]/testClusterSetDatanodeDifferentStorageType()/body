{
  final Configuration conf=new HdfsConfiguration();
  StorageType[][] storageType=new StorageType[][]{{StorageType.DISK,StorageType.ARCHIVE},{StorageType.DISK},{StorageType.ARCHIVE}};
  final MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(3).storageTypes(storageType).build();
  try {
    cluster.waitActive();
    ArrayList<DataNode> dataNodes=cluster.getDataNodes();
    for (int i=0; i < storageType.length; i++) {
      assertEquals(DataNode.getStorageLocations(dataNodes.get(i).getConf()).size(),storageType[i].length);
    }
  }
  finally {
    MiniDFSCluster.shutdownCluster(cluster);
  }
}
