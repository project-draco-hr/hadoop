{
  if (NetworkTopology.DEFAULT_RACK.equals(node.getNetworkLocation())) {
    node.setNetworkLocation(node.getNetworkLocation() + DEFAULT_NODEGROUP);
  }
  Node nodeGroup=getNode(node.getNetworkLocation());
  if (nodeGroup == null) {
    nodeGroup=new InnerNode(node.getNetworkLocation());
  }
  return getNode(nodeGroup.getNetworkLocation());
}
