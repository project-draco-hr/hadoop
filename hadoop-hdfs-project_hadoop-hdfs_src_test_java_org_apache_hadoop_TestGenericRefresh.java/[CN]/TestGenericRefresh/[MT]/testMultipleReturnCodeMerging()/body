{
  RefreshHandler handlerOne=Mockito.mock(RefreshHandler.class);
  Mockito.stub(handlerOne.handleRefresh(Mockito.anyString(),Mockito.any(String[].class))).toReturn(new RefreshResponse(23,"Twenty Three"));
  RefreshHandler handlerTwo=Mockito.mock(RefreshHandler.class);
  Mockito.stub(handlerTwo.handleRefresh(Mockito.anyString(),Mockito.any(String[].class))).toReturn(new RefreshResponse(10,"Ten"));
  RefreshRegistry.defaultRegistry().register("shared",handlerOne);
  RefreshRegistry.defaultRegistry().register("shared",handlerTwo);
  DFSAdmin admin=new DFSAdmin(config);
  String[] args=new String[]{"-refresh","localhost:" + cluster.getNameNodePort(),"shared"};
  int exitCode=admin.run(args);
  assertEquals(-1,exitCode);
  Mockito.verify(handlerOne).handleRefresh("shared",new String[]{});
  Mockito.verify(handlerTwo).handleRefresh("shared",new String[]{});
  RefreshRegistry.defaultRegistry().unregisterAll("shared");
}
