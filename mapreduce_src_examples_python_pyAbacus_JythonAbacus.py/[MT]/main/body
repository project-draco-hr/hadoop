def main(args):
    if (len(args) < 6):
        printUsage(1)
    inDir = args[1]
    outDir = args[2]
    numOfReducers = int(args[3])
    theInputFormat = args[4]
    specFile = args[5]
    print 'numOfReducers: ', numOfReducers, 'theInputFormat: ', theInputFormat, 'specFile: ', specFile
    conf = JobConf(AbacusMapper)
    conf.setJobName('recordcount')
    conf.addDefaultResource(Path(specFile))
    if (theInputFormat == 'textinputformat'):
        conf.setInputFormat(TextInputFormat)
    else:
        conf.setInputFormat(SequenceFileInputFormat)
    conf.setOutputFormat(TextOutputFormat)
    conf.setMapOutputKeyClass(Text)
    conf.setMapOutputValueClass(Text)
    conf.setOutputKeyClass(Text)
    conf.setOutputValueClass(Text)
    conf.setNumMapTasks(1)
    conf.setNumReduceTasks(numOfReducers)
    conf.setMapperClass(AbacusMapper)
    conf.setCombinerClass(AbacusCombiner)
    conf.setReducerClass(AbacusReducer)
    conf.setInputPath(Path(args[1]))
    conf.setOutputPath(Path(args[2]))
    JobClient.runJob(conf)
