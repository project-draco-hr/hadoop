{
  CompressionCodecFactory codecs=new CompressionCodecFactory(getConf());
  inputCodec=codecs.getCodec(p);
  FileSystem fs=p.getFileSystem(getConf());
  FSDataInputStream fileIn=fs.open(p);
  if (inputCodec == null) {
    return new LineReader(fileIn,getConf());
  }
 else {
    inputDecompressor=CodecPool.getDecompressor(inputCodec);
    return new LineReader(inputCodec.createInputStream(fileIn,inputDecompressor),getConf());
  }
}
