{
  job.setInt(JobContext.JVM_NUMTASKS_TORUN,-1);
  job.setInt(JobContext.IO_SORT_MB,1);
  job.setNumMapTasks(12);
  String[] sortArgs={sortInput.toString(),sortOutput.toString()};
  Sort sort=new Sort();
  assertEquals(ToolRunner.run(job,sort,sortArgs),0);
  org.apache.hadoop.mapreduce.Counters counters=sort.getResult().getCounters();
  long mapInput=counters.findCounter(FileInputFormatCounter.BYTES_READ).getValue();
  long hdfsRead=counters.findCounter(Task.FILESYSTEM_COUNTER_GROUP,"HDFS_BYTES_READ").getValue();
  assertTrue("map input = " + mapInput + ", hdfs read = "+ hdfsRead,(hdfsRead < (mapInput * 1.1)) && (hdfsRead >= mapInput));
}
