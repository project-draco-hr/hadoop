{
  TestSetup setup=new TestSetup(new TestSuite(TestMiniMRDFSSort.class)){
    protected void setUp() throws Exception {
      Configuration conf=new Configuration();
      dfsCluster=new MiniDFSCluster(conf,NUM_HADOOP_SLAVES,true,null);
      dfs=dfsCluster.getFileSystem();
      mrCluster=new MiniMRCluster(NUM_HADOOP_SLAVES,dfs.getUri().toString(),1);
    }
    protected void tearDown() throws Exception {
      if (dfsCluster != null) {
        dfsCluster.shutdown();
      }
      if (mrCluster != null) {
        mrCluster.shutdown();
      }
    }
  }
;
  return setup;
}
