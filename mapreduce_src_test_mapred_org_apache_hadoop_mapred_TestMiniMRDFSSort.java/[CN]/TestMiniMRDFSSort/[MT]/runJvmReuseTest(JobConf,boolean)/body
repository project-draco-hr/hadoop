{
  job.setInt(JobContext.JVM_NUMTASKS_TORUN,reuse ? -1 : 1);
  FileInputFormat.setInputPaths(job,SORT_INPUT_PATH);
  job.setInputFormat(SequenceFileInputFormat.class);
  job.setOutputFormat(NullOutputFormat.class);
  job.setMapperClass(ReuseDetector.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(Text.class);
  job.setNumMapTasks(24);
  job.setNumReduceTasks(0);
  RunningJob result=JobClient.runJob(job);
  long uses=result.getCounters().findCounter("jvm","use").getValue();
  int maps=job.getNumMapTasks();
  if (reuse) {
    assertTrue("maps = " + maps + ", uses = "+ uses,maps < uses);
  }
 else {
    assertEquals("uses should be number of maps",job.getNumMapTasks(),uses);
  }
}
