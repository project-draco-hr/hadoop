{
  int numMaps=(int)(totalBytes / job.getLong(BYTES_PER_MAP_LABEL,BYTES_PER_MAP));
  numMaps=Math.min(numMaps,job.getInt(MAX_MAPS_LABEL,MAX_MAPS_PER_NODE * new JobClient(job).getClusterStatus().getTaskTrackers()));
  numMaps=Math.max(numMaps,1);
  job.setNumMapTasks(numMaps);
  return numMaps;
}
