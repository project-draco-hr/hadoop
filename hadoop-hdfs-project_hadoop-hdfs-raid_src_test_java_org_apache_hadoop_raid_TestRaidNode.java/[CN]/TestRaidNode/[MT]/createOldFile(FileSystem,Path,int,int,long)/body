{
  CRC32 crc=new CRC32();
  FSDataOutputStream stm=fileSys.create(name,true,fileSys.getConf().getInt("io.file.buffer.size",4096),(short)repl,blocksize);
  byte[] b=new byte[(int)blocksize];
  for (int i=0; i < numBlocks; i++) {
    if (i == (numBlocks - 1)) {
      b=new byte[(int)blocksize / 2];
    }
    rand.nextBytes(b);
    stm.write(b);
    crc.update(b);
  }
  stm.close();
  return crc.getValue();
}
