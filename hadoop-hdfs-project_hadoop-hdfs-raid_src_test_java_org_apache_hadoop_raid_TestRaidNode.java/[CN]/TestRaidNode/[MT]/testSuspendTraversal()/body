{
  LOG.info("Test testSuspendTraversal started.");
  long targetReplication=2;
  long metaReplication=2;
  long stripeLength=3;
  short srcReplication=1;
  createClusters(false);
  ConfigBuilder cb=new ConfigBuilder();
  cb.addPolicy("policy1","/user/dhruba/raidtest",srcReplication,targetReplication,metaReplication,stripeLength);
  cb.persist();
  RaidNode cnode=null;
  try {
    for (int i=0; i < 4; i++) {
      Path file=new Path("/user/dhruba/raidtest/dir" + i + "/file"+ i);
      createOldFile(fileSys,file,1,7,1024L);
    }
    LOG.info("Test testSuspendTraversal created test files");
    Configuration localConf=new Configuration(conf);
    localConf.setInt("raid.distraid.max.jobs",2);
    localConf.setInt("raid.distraid.max.files",2);
    localConf.setInt("raid.directorytraversal.threads",1);
    localConf.set(JobContext.JAR,TestRaidNode.DistRaid_JAR);
    final int numJobsExpected=2;
    cnode=RaidNode.createRaidNode(null,localConf);
    long start=System.currentTimeMillis();
    final int MAX_WAITTIME=300000;
    assertTrue("cnode is not DistRaidNode",cnode instanceof DistRaidNode);
    DistRaidNode dcnode=(DistRaidNode)cnode;
    start=System.currentTimeMillis();
    while (dcnode.jobMonitor.jobsSucceeded() < numJobsExpected && System.currentTimeMillis() - start < MAX_WAITTIME) {
      LOG.info("Waiting for num jobs succeeded " + dcnode.jobMonitor.jobsSucceeded() + " to reach "+ numJobsExpected);
      Thread.sleep(3000);
    }
    start=System.currentTimeMillis();
    while (dcnode.jobMonitor.runningJobsCount() > 0 && System.currentTimeMillis() - start < MAX_WAITTIME) {
      LOG.info("Waiting for zero running jobs: " + dcnode.jobMonitor.runningJobsCount());
      Thread.sleep(1000);
    }
    assertEquals(numJobsExpected,dcnode.jobMonitor.jobsMonitored());
    assertEquals(numJobsExpected,dcnode.jobMonitor.jobsSucceeded());
    LOG.info("Test testSuspendTraversal successful.");
  }
 catch (  Exception e) {
    LOG.info("testSuspendTraversal Exception " + e + StringUtils.stringifyException(e));
    throw e;
  }
 finally {
    if (cnode != null) {
      cnode.stop();
      cnode.join();
    }
    stopClusters();
  }
  LOG.info("Test testSuspendTraversal completed.");
}
