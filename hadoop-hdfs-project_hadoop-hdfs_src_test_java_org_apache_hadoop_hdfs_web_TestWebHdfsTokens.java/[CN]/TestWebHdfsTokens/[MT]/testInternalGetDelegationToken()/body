{
  WebHdfsFileSystem fs=spy(new WebHdfsFileSystem());
  Token<DelegationTokenIdentifier> token=mock(Token.class);
  doReturn(null).when(fs).selectDelegationToken(ugi);
  doReturn(token).when(fs).getDelegationToken(anyString());
  doNothing().when(fs).addRenewAction(any(WebHdfsFileSystem.class));
  fs.initialize(URI.create("webhdfs://127.0.0.1:0"),conf);
  Token<?> token2=fs.getDelegationToken();
  assertEquals(token2,token);
  verify(fs).getDelegationToken(null);
  verify(fs).setDelegationToken(token);
  verify(fs).addRenewAction(fs);
  reset(fs);
  token2=fs.getDelegationToken();
  assertEquals(token2,token);
  verify(fs,never()).getDelegationToken(null);
  verify(fs,never()).setDelegationToken(any(Token.class));
  verify(fs,never()).addRenewAction(fs);
}
