{
  WebHdfsFileSystem fs=spy(new WebHdfsFileSystem());
  Token<DelegationTokenIdentifier> token=mock(Token.class);
  doReturn(null).when(fs).selectDelegationToken(ugi);
  doReturn(token).when(fs).getDelegationToken(null);
  doNothing().when(fs).addRenewAction(any(WebHdfsFileSystem.class));
  fs.initialize(URI.create("webhdfs://127.0.0.1:0"),conf);
  fs.toUrl(GetOpParam.Op.OPEN,null);
  verify(fs).getDelegationToken();
  verify(fs).getDelegationToken(null);
  verify(fs).setDelegationToken(token);
  verify(fs).addRenewAction(fs);
  reset(fs);
  fs.toUrl(GetOpParam.Op.OPEN,null);
  verify(fs).getDelegationToken();
  verify(fs,never()).getDelegationToken(null);
  verify(fs,never()).setDelegationToken(token);
  verify(fs,never()).addRenewAction(fs);
}
