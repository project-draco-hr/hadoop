{
  FileSystem localFs=FileSystem.getLocal(conf);
  Path mapOut=subMapOutputFile.getOutputFile();
  FileStatus mStatus=localFs.getFileStatus(mapOut);
  Path reduceIn=subMapOutputFile.getInputFileForWrite(TypeConverter.fromYarn(mapId).getTaskID(),mStatus.getLen());
  Path mapOutIndex=subMapOutputFile.getOutputIndexFile();
  Path reduceInIndex=new Path(reduceIn.toString() + ".index");
  if (LOG.isDebugEnabled()) {
    LOG.debug("Renaming map output file for task attempt " + mapId.toString() + " from original location "+ mapOut.toString()+ " to destination "+ reduceIn.toString());
  }
  if (!localFs.mkdirs(reduceIn.getParent())) {
    throw new IOException("Mkdirs failed to create " + reduceIn.getParent().toString());
  }
  if (!localFs.rename(mapOut,reduceIn))   throw new IOException("Couldn't rename " + mapOut);
  if (!localFs.rename(mapOutIndex,reduceInIndex))   throw new IOException("Couldn't rename " + mapOutIndex);
  return new RenamedMapOutputFile(reduceIn);
}
