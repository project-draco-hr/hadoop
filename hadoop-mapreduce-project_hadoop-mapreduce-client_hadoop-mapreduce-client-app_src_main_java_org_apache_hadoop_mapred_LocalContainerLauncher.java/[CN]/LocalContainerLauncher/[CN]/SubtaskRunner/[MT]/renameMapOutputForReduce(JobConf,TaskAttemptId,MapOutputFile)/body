{
  FileSystem localFs=FileSystem.getLocal(conf);
  Path mapOut=subMapOutputFile.getOutputFile();
  Path reduceIn=subMapOutputFile.getInputFileForWrite(TypeConverter.fromYarn(mapId).getTaskID(),localFs.getLength(mapOut));
  if (!localFs.mkdirs(reduceIn.getParent())) {
    throw new IOException("Mkdirs failed to create " + reduceIn.getParent().toString());
  }
  if (!localFs.rename(mapOut,reduceIn))   throw new IOException("Couldn't rename " + mapOut);
}
