{
  ThreadMXBean threadBean=ManagementFactory.getThreadMXBean();
  ThreadInfo[] infos=threadBean.getThreadInfo(threadBean.getAllThreadIds(),20);
  for (  ThreadInfo info : infos) {
    if (info == null)     continue;
    LOG.info("Check thread: " + info.getThreadName());
    if (info.getThreadName().contains("SecondaryNameNode")) {
      fail("Leaked thread: " + info + "\n"+ Joiner.on("\n").join(info.getStackTrace()));
    }
  }
  LOG.info("--------");
}
