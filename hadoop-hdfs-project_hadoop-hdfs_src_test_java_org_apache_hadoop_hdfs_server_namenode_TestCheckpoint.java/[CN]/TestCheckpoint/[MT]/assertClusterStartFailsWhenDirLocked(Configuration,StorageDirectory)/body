{
  sdToLock.lock();
  try {
    MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).format(false).manageNameDfsDirs(false).numDataNodes(0).build();
    assertFalse("cluster should fail to start after locking " + sdToLock,sdToLock.isLockSupported());
    cluster.shutdown();
  }
 catch (  IOException ioe) {
    GenericTestUtils.assertExceptionContains("already locked",ioe);
  }
 finally {
    sdToLock.unlock();
  }
}
