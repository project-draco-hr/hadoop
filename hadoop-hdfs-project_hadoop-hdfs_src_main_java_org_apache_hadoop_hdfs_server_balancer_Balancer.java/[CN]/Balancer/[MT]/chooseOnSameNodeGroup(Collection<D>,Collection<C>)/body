{
  for (Iterator<D> i=datanodes.iterator(); i.hasNext(); ) {
    final D datanode=i.next();
    for (; chooseOnSameNodeGroup(datanode,candidates.iterator()); )     ;
    if (!datanode.isMoveQuotaFull()) {
      i.remove();
    }
  }
}
