{
  long size=Math.min(source.availableSizeToMove(),target.availableSizeToMove());
  NodeTask nodeTask=new NodeTask(target,size);
  source.addNodeTask(nodeTask);
  target.incScheduledSize(nodeTask.getSize());
  sources.add(source);
  targets.add(target);
  LOG.info("Decided to move " + StringUtils.byteDesc(size) + " bytes from "+ source.datanode.getName()+ " to "+ target.datanode.getName());
}
