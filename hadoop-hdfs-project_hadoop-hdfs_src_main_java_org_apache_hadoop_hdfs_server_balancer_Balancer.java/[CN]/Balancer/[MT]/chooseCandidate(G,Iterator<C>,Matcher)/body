{
  if (g.hasSpaceForScheduling()) {
    for (; candidates.hasNext(); ) {
      final C c=candidates.next();
      if (!c.hasSpaceForScheduling()) {
        candidates.remove();
      }
 else       if (matcher.match(dispatcher.getCluster(),g.getDatanode(),c.getDatanode())) {
        return c;
      }
    }
  }
  return null;
}
