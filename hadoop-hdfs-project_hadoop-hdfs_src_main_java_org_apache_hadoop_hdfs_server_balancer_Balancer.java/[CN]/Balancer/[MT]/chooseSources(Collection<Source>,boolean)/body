{
  for (Iterator<BalancerDatanode> targetIterator=underUtilizedDatanodes.iterator(); targetIterator.hasNext(); ) {
    BalancerDatanode target=targetIterator.next();
    while (chooseSource(target,sourceCandidates.iterator(),onRackSource)) {
    }
    if (!target.isMoveQuotaFull()) {
      targetIterator.remove();
    }
  }
  return;
}
