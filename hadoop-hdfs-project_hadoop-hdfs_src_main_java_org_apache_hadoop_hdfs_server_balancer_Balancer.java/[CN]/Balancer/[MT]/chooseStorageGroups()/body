{
  if (dispatcher.getCluster().isNodeGroupAware()) {
    chooseStorageGroups(Matcher.SAME_NODE_GROUP);
  }
  chooseStorageGroups(Matcher.SAME_RACK);
  chooseStorageGroups(Matcher.ANY_OTHER);
  return dispatcher.bytesToMove();
}
