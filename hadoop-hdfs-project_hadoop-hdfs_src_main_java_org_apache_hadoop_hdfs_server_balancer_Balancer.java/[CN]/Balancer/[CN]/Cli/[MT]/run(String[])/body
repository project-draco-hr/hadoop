{
  final long startTime=Time.now();
  final Configuration conf=getConf();
  WIN_WIDTH=conf.getLong(DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY,DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);
  try {
    checkReplicationPolicyCompatibility(conf);
    final Collection<URI> namenodes=DFSUtil.getNsServiceRpcUris(conf);
    return Balancer.run(namenodes,parse(args),conf);
  }
 catch (  IOException e) {
    System.out.println(e + ".  Exiting ...");
    return ReturnStatus.IO_EXCEPTION.code;
  }
catch (  InterruptedException e) {
    System.out.println(e + ".  Exiting ...");
    return ReturnStatus.INTERRUPTED.code;
  }
 finally {
    System.out.format("%-24s ",DateFormat.getDateTimeInstance().format(new Date()));
    System.out.println("Balancing took " + time2Str(Time.now() - startTime));
  }
}
