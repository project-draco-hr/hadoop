{
  datanode=node;
  utilization=policy.getUtilization(node);
  final double avgUtil=policy.getAvgUtilization();
  long maxSizeToMove;
  if (utilization >= avgUtil + threshold || utilization <= avgUtil - threshold) {
    maxSizeToMove=(long)(threshold * datanode.getCapacity() / 100);
  }
 else {
    maxSizeToMove=(long)(Math.abs(avgUtil - utilization) * datanode.getCapacity() / 100);
  }
  if (utilization < avgUtil) {
    maxSizeToMove=Math.min(datanode.getRemaining(),maxSizeToMove);
  }
  this.maxSize2Move=Math.min(MAX_SIZE_TO_MOVE,maxSizeToMove);
  this.maxConcurrentMoves=maxConcurrentMoves;
  this.pendingBlocks=new ArrayList<PendingBlockMove>(maxConcurrentMoves);
}
