{
  this.threshold=p.threshold;
  this.policy=p.policy;
  this.nnc=theblockpool;
  cluster=NetworkTopology.getInstance(conf);
  this.moverExecutor=Executors.newFixedThreadPool(conf.getInt(DFSConfigKeys.DFS_BALANCER_MOVERTHREADS_KEY,DFSConfigKeys.DFS_BALANCER_MOVERTHREADS_DEFAULT));
  this.dispatcherExecutor=Executors.newFixedThreadPool(conf.getInt(DFSConfigKeys.DFS_BALANCER_DISPATCHERTHREADS_KEY,DFSConfigKeys.DFS_BALANCER_DISPATCHERTHREADS_DEFAULT));
  this.maxConcurrentMovesPerNode=conf.getInt(DFSConfigKeys.DFS_DATANODE_BALANCE_MAX_NUM_CONCURRENT_MOVES_KEY,DFSConfigKeys.DFS_DATANODE_BALANCE_MAX_NUM_CONCURRENT_MOVES_DEFAULT);
}
