{
  MDC.remove("user");
  HttpRequestContext request=Mockito.mock(HttpRequestContext.class);
  Mockito.when(request.getUserPrincipal()).thenReturn(null);
  MultivaluedMap map=Mockito.mock(MultivaluedMap.class);
  Mockito.when(map.getFirst(UserProvider.USER_NAME_PARAM)).thenReturn("foo");
  Mockito.when(request.getQueryParameters()).thenReturn(map);
  HttpContext context=Mockito.mock(HttpContext.class);
  Mockito.when(context.getRequest()).thenReturn(request);
  UserProvider up=new UserProvider();
  Assert.assertEquals(up.getValue(context).getName(),"foo");
  Assert.assertEquals(MDC.get("user"),"foo");
}
