{
  Path p1=new Path("/dir1");
  Path p2=new Path("/dir2");
  fs.mkdirs(p1);
  cluster.shutdownNameNode(0);
  assertTrue(fs.exists(p1));
  fs.mkdirs(p2);
  assertEquals(AlwaysSucceedFencer.getLastFencedService().getAddress(),thr1.zkfc.getLocalTarget().getAddress());
  cluster.restartNameNode(0);
  waitForHAState(0,HAServiceState.STANDBY);
  assertTrue(fs.exists(p1));
  assertTrue(fs.exists(p2));
  cluster.shutdownNameNode(1);
  waitForHAState(0,HAServiceState.ACTIVE);
  assertTrue(fs.exists(p1));
  assertTrue(fs.exists(p2));
  assertEquals(AlwaysSucceedFencer.getLastFencedService().getAddress(),thr2.zkfc.getLocalTarget().getAddress());
}
