{
  MockEventHandler eventHandler=new MockEventHandler();
  TaskAttemptImpl taImpl=createTaskAttemptImpl(eventHandler);
  taImpl.handle(new TaskAttemptEvent(taImpl.getID(),TaskAttemptEventType.TA_FAILMSG));
  assertEquals("Task attempt is not in FAILED state",taImpl.getState(),TaskAttemptState.FAILED);
  assertEquals("Task attempt's internal state is not " + "FAIL_FINISHING_CONTAINER",taImpl.getInternalState(),TaskAttemptStateInternal.FAIL_FINISHING_CONTAINER);
  taImpl.handle(new TaskAttemptEvent(taImpl.getID(),TaskAttemptEventType.TA_KILL));
  assertEquals("Task attempt is not in RUNNING state",taImpl.getState(),TaskAttemptState.FAILED);
  assertEquals("Task attempt's internal state is not " + "FAIL_FINISHING_CONTAINER",taImpl.getInternalState(),TaskAttemptStateInternal.FAIL_FINISHING_CONTAINER);
  taImpl.handle(new TaskAttemptEvent(taImpl.getID(),TaskAttemptEventType.TA_TIMED_OUT));
  assertEquals("Task attempt's internal state is not FAIL_CONTAINER_CLEANUP",taImpl.getInternalState(),TaskAttemptStateInternal.FAIL_CONTAINER_CLEANUP);
  taImpl.handle(new TaskAttemptEvent(taImpl.getID(),TaskAttemptEventType.TA_CONTAINER_CLEANED));
  assertEquals("Task attempt's internal state is not FAIL_TASK_CLEANUP",taImpl.getInternalState(),TaskAttemptStateInternal.FAIL_TASK_CLEANUP);
  taImpl.handle(new TaskAttemptEvent(taImpl.getID(),TaskAttemptEventType.TA_CLEANUP_DONE));
  assertEquals("Task attempt is not in KILLED state",taImpl.getState(),TaskAttemptState.FAILED);
  assertFalse("InternalError occurred",eventHandler.internalError);
}
