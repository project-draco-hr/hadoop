{
  return storagePolicy.chooseStorageTypes(replication,new Iterable<StorageType>(){
    @Override public Iterator<StorageType> iterator(){
      return new Iterator<StorageType>(){
        final Iterator<DatanodeStorageInfo> i=chosen.iterator();
        @Override public boolean hasNext(){
          return i.hasNext();
        }
        @Override public StorageType next(){
          return i.next().getStorageType();
        }
        @Override public void remove(){
          throw new UnsupportedOperationException();
        }
      }
;
    }
  }
);
}
