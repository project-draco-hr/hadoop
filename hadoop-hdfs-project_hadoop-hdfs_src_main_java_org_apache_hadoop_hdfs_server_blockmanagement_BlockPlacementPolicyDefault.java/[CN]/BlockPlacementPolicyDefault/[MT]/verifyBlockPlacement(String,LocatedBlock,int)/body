{
  DatanodeInfo[] locs=lBlk.getLocations();
  if (locs == null)   locs=DatanodeDescriptor.EMPTY_ARRAY;
  int numRacks=clusterMap.getNumOfRacks();
  if (numRacks <= 1)   return new BlockPlacementStatusDefault(Math.min(numRacks,numberOfReplicas),numRacks);
  int minRacks=Math.min(2,numberOfReplicas);
  Set<String> racks=new TreeSet<String>();
  for (  DatanodeInfo dn : locs)   racks.add(dn.getNetworkLocation());
  return new BlockPlacementStatusDefault(racks.size(),minRacks);
}
