{
  DatanodeInfo[] locs=lBlk.getLocations();
  if (locs == null)   locs=DatanodeDescriptor.EMPTY_ARRAY;
  int numRacks=clusterMap.getNumOfRacks();
  if (numRacks <= 1)   return 0;
  minRacks=Math.min(minRacks,numRacks);
  Set<String> racks=new TreeSet<String>();
  for (  DatanodeInfo dn : locs)   racks.add(dn.getNetworkLocation());
  return minRacks - racks.size();
}
