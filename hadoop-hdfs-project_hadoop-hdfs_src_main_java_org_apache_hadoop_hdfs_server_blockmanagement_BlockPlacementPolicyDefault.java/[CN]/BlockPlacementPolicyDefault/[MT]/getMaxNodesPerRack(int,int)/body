{
  int clusterSize=clusterMap.getNumOfLeaves();
  int totalNumOfReplicas=numOfChosen + numOfReplicas;
  if (totalNumOfReplicas > clusterSize) {
    numOfReplicas-=(totalNumOfReplicas - clusterSize);
    totalNumOfReplicas=clusterSize;
  }
  int maxNodesPerRack=(totalNumOfReplicas - 1) / clusterMap.getNumOfRacks() + 2;
  return new int[]{numOfReplicas,maxNodesPerRack};
}
