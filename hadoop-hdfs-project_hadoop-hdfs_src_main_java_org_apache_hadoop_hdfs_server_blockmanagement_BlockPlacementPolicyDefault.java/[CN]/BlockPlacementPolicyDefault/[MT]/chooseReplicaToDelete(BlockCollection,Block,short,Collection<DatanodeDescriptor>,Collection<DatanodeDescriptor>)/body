{
  long minSpace=Long.MAX_VALUE;
  DatanodeDescriptor cur=null;
  Iterator<DatanodeDescriptor> iter=first.isEmpty() ? second.iterator() : first.iterator();
  while (iter.hasNext()) {
    DatanodeDescriptor node=iter.next();
    long free=node.getRemaining();
    if (minSpace > free) {
      minSpace=free;
      cur=node;
    }
  }
  return cur;
}
