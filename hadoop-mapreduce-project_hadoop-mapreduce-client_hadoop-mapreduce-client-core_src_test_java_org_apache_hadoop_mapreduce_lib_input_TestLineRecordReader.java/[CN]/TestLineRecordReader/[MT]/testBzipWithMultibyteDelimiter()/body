{
  String testFileName="compressedMultibyteDelimiter.txt.bz2";
  int firstSplitLength=100;
  URL testFileUrl=getClass().getClassLoader().getResource(testFileName);
  assertNotNull("Cannot find " + testFileName,testFileUrl);
  File testFile=new File(testFileUrl.getFile());
  long testFileSize=testFile.length();
  Path testFilePath=new Path(testFile.getAbsolutePath());
  assertTrue("Split size is smaller than header length",firstSplitLength > 9);
  assertTrue("Split size is larger than compressed file size " + testFilePath,testFileSize > firstSplitLength);
  Configuration conf=new Configuration();
  conf.setInt(org.apache.hadoop.mapreduce.lib.input.LineRecordReader.MAX_LINE_LENGTH,Integer.MAX_VALUE);
  String delimiter="<E-LINE>\r\r\n";
  conf.set("textinputformat.record.delimiter",delimiter);
  testSplitRecordsForFile(conf,firstSplitLength,testFileSize,testFilePath);
}
