{
  File testFile=new File(testFileUrl.getFile());
  long testFileSize=testFile.length();
  Path testFilePath=new Path(testFile.getAbsolutePath());
  Configuration conf=new Configuration();
  conf.setInt("io.file.buffer.size",1);
  TaskAttemptContext context=new TaskAttemptContextImpl(conf,new TaskAttemptID());
  ArrayList<String> records=new ArrayList<String>();
  long offset=0;
  while (offset < testFileSize) {
    FileSplit split=new FileSplit(testFilePath,offset,splitSize,null);
    LineRecordReader reader=new LineRecordReader();
    reader.initialize(split,context);
    while (reader.nextKeyValue()) {
      records.add(reader.getCurrentValue().toString());
    }
    offset+=splitSize;
  }
  return records;
}
