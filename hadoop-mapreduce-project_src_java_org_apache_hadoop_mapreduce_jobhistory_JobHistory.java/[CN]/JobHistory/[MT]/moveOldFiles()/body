{
  FileStatus[] files=logDirFs.listStatus(logDir);
  String fileSuffix=getOldFileSuffix(jobTracker.getTrackerIdentifier());
  for (  FileStatus fileStatus : files) {
    Path fromPath=fileStatus.getPath();
    if (fromPath.equals(done)) {
      continue;
    }
    LOG.info("Moving log file from last run: " + fromPath);
    Path toPath=new Path(done,fromPath.getName() + fileSuffix);
    try {
      moveToDoneNow(fromPath,toPath);
    }
 catch (    ChecksumException e) {
      LOG.warn("Unable to move " + fromPath + ", deleting it");
      try {
        boolean b=logDirFs.delete(fromPath,false);
        if (LOG.isDebugEnabled()) {
          LOG.debug("Deletion of corrupt file " + fromPath + " returned "+ b);
        }
      }
 catch (      IOException ioe) {
        LOG.warn("Unable to delete " + fromPath + "Exception: "+ ioe.getMessage());
      }
    }
catch (    IOException e) {
      LOG.warn("Error moving file " + fromPath + " to done folder."+ "Ignoring.");
    }
  }
}
