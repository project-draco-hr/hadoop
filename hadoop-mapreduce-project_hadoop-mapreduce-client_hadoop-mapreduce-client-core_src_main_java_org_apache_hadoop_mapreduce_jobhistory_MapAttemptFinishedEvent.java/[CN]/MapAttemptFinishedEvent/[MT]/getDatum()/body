{
  if (datum == null) {
    datum=new MapAttemptFinished();
    datum.setTaskid(new Utf8(attemptId.getTaskID().toString()));
    datum.setAttemptId(new Utf8(attemptId.toString()));
    datum.setTaskType(new Utf8(taskType.name()));
    datum.setTaskStatus(new Utf8(taskStatus));
    datum.setMapFinishTime(mapFinishTime);
    datum.setFinishTime(finishTime);
    datum.setHostname(new Utf8(hostname));
    datum.setPort(port);
    if (rackName != null) {
      datum.setRackname(new Utf8(rackName));
    }
    datum.setState(new Utf8(state));
    datum.setCounters(EventWriter.toAvro(counters));
    datum.setClockSplits(AvroArrayUtils.toAvro(ProgressSplitsBlock.arrayGetWallclockTime(allSplits)));
    datum.setCpuUsages(AvroArrayUtils.toAvro(ProgressSplitsBlock.arrayGetCPUTime(allSplits)));
    datum.setVMemKbytes(AvroArrayUtils.toAvro(ProgressSplitsBlock.arrayGetVMemKbytes(allSplits)));
    datum.setPhysMemKbytes(AvroArrayUtils.toAvro(ProgressSplitsBlock.arrayGetPhysMemKbytes(allSplits)));
  }
  return datum;
}
