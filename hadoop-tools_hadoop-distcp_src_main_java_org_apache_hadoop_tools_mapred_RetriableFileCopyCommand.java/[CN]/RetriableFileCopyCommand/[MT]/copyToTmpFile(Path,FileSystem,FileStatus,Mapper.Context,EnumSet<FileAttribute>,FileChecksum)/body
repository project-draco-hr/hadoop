{
  FsPermission permission=FsPermission.getFileDefault().applyUMask(FsPermission.getUMask(targetFS.getConf()));
  OutputStream outStream=new BufferedOutputStream(targetFS.create(tmpTargetPath,permission,EnumSet.of(CreateFlag.CREATE,CreateFlag.OVERWRITE),BUFFER_SIZE,getReplicationFactor(fileAttributes,sourceFileStatus,targetFS,tmpTargetPath),getBlockSize(fileAttributes,sourceFileStatus,targetFS,tmpTargetPath),context,getChecksumOpt(fileAttributes,sourceChecksum)));
  return copyBytes(sourceFileStatus,outStream,BUFFER_SIZE,context);
}
