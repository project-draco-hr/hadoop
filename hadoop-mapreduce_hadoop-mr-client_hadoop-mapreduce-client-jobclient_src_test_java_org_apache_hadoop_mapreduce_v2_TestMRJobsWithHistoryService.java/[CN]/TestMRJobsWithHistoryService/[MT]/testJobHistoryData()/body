{
  if (!(new File(MiniMRYarnCluster.APPJAR)).exists()) {
    LOG.info("MRAppJar " + MiniMRYarnCluster.APPJAR + " not found. Not running test.");
    return;
  }
  SleepJob sleepJob=new SleepJob();
  sleepJob.setConf(mrCluster.getConfig());
  Job job=sleepJob.createJob(3,2,1000,1,500,1);
  job.setJarByClass(SleepJob.class);
  job.addFileToClassPath(APP_JAR);
  job.waitForCompletion(true);
  Counters counterMR=job.getCounters();
  ApplicationId appID=TypeConverter.toYarn(job.getJobID()).getAppId();
  while (true) {
    Thread.sleep(1000);
    if (mrCluster.getResourceManager().getRMContext().getRMApps().get(appID).getState().equals(RMAppState.FINISHED))     break;
  }
  Counters counterHS=job.getCounters();
  LOG.info("CounterHS " + counterHS);
  LOG.info("CounterMR " + counterMR);
  Assert.assertEquals(counterHS,counterMR);
}
