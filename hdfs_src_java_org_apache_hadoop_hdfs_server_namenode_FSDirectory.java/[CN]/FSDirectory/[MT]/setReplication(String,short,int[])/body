{
  waitForReady();
  Block[] fileBlocks=null;
  writeLock();
  try {
    fileBlocks=unprotectedSetReplication(src,replication,oldReplication);
    if (fileBlocks != null)     fsImage.getEditLog().logSetReplication(src,replication);
    return fileBlocks;
  }
  finally {
    writeUnlock();
  }
}
