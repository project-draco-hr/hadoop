{
  NamenodeProtocolPB proxy=(NamenodeProtocolPB)createNameNodeProxy(address,conf,ugi,NamenodeProtocolPB.class);
  if (withRetries) {
    RetryPolicy timeoutPolicy=RetryPolicies.exponentialBackoffRetry(5,200,TimeUnit.MILLISECONDS);
    Map<Class<? extends Exception>,RetryPolicy> exceptionToPolicyMap=new HashMap<Class<? extends Exception>,RetryPolicy>();
    RetryPolicy methodPolicy=RetryPolicies.retryByException(timeoutPolicy,exceptionToPolicyMap);
    Map<String,RetryPolicy> methodNameToPolicyMap=new HashMap<String,RetryPolicy>();
    methodNameToPolicyMap.put("getBlocks",methodPolicy);
    methodNameToPolicyMap.put("getAccessKeys",methodPolicy);
    proxy=(NamenodeProtocolPB)RetryProxy.create(NamenodeProtocolPB.class,proxy,methodNameToPolicyMap);
  }
  return new NamenodeProtocolTranslatorPB(proxy);
}
