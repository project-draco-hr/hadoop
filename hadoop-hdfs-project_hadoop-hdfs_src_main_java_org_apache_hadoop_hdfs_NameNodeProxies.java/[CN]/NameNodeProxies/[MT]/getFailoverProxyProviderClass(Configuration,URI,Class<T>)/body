{
  if (nameNodeUri == null) {
    return null;
  }
  String host=nameNodeUri.getHost();
  String configKey=DFS_CLIENT_FAILOVER_PROXY_PROVIDER_KEY_PREFIX + "." + host;
  try {
    @SuppressWarnings("unchecked") Class<FailoverProxyProvider<T>> ret=(Class<FailoverProxyProvider<T>>)conf.getClass(configKey,null,FailoverProxyProvider.class);
    if (ret != null) {
      int port=nameNodeUri.getPort();
      if (port > 0 && port != DFSConfigKeys.DFS_NAMENODE_RPC_PORT_DEFAULT) {
        throw new IOException("Port " + port + " specified in URI "+ nameNodeUri+ " but host '"+ host+ "' is a logical (HA) namenode"+ " and does not use port information.");
      }
    }
    return ret;
  }
 catch (  RuntimeException e) {
    if (e.getCause() instanceof ClassNotFoundException) {
      throw new IOException("Could not load failover proxy provider class " + conf.get(configKey) + " which is configured for authority "+ nameNodeUri,e);
    }
 else {
      throw e;
    }
  }
}
