{
  if (count == 0 && len >= buf.length) {
    final int length=buf.length;
    writeChecksumChunks(b,off,length);
    return length;
  }
  int bytesToCopy=buf.length - count;
  bytesToCopy=(len < bytesToCopy) ? len : bytesToCopy;
  System.arraycopy(b,off,buf,count,bytesToCopy);
  count+=bytesToCopy;
  if (count == buf.length) {
    flushBuffer();
  }
  return bytesToCopy;
}
