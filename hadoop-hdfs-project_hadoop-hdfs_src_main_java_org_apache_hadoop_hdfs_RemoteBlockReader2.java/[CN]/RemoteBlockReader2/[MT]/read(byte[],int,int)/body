{
  UUID randomId=null;
  if (LOG.isTraceEnabled()) {
    randomId=UUID.randomUUID();
    LOG.trace(String.format("Starting read #%s file %s from datanode %s",randomId.toString(),this.filename,this.datanodeID.getHostName()));
  }
  if (curDataSlice == null || curDataSlice.remaining() == 0 && bytesNeededToFinish > 0) {
    readNextPacket();
  }
  if (LOG.isTraceEnabled()) {
    LOG.trace(String.format("Finishing read #" + randomId));
  }
  if (curDataSlice.remaining() == 0) {
    return -1;
  }
  int nRead=Math.min(curDataSlice.remaining(),len);
  curDataSlice.get(buf,off,nRead);
  return nRead;
}
