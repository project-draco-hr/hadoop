{
  int packetLen=checksumsLen + dataLen;
  if (curPacketBuf == null || curPacketBuf.capacity() < packetLen) {
    returnPacketBufToPool();
    curPacketBuf=bufferPool.getBuffer(packetLen);
  }
  curPacketBuf.position(checksumsLen);
  curDataSlice=curPacketBuf.slice();
  curDataSlice.limit(dataLen);
  curPacketBuf.clear();
  curPacketBuf.limit(checksumsLen + dataLen);
}
