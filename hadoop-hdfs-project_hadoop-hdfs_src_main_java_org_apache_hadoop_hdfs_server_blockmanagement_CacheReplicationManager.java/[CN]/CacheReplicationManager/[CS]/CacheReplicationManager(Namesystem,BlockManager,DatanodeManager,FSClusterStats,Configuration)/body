{
  super(conf);
  this.namesystem=namesystem;
  this.blockManager=blockManager;
  this.datanodeManager=datanodeManager;
  this.conf=conf;
  isCachingEnabled=conf.getBoolean(DFSConfigKeys.DFS_NAMENODE_CACHING_ENABLED_KEY,DFSConfigKeys.DFS_NAMENODE_CACHING_ENABLED_DEFAULT);
  if (isCachingEnabled) {
    cachedBlocksMap=new BlocksMap(BlockManager.DEFAULT_MAP_LOAD_FACTOR);
    blocksToUncache=new UncacheBlocks();
    pendingCacheBlocks=new PendingReplicationBlocks(1000 * conf.getInt(DFSConfigKeys.DFS_NAMENODE_REPLICATION_PENDING_TIMEOUT_SEC_KEY,DFSConfigKeys.DFS_NAMENODE_REPLICATION_PENDING_TIMEOUT_SEC_DEFAULT));
    neededCacheBlocks=new LightWeightHashSet<Block>();
  }
 else {
    cachedBlocksMap=null;
    blocksToUncache=null;
    pendingCacheBlocks=null;
    neededCacheBlocks=null;
  }
}
