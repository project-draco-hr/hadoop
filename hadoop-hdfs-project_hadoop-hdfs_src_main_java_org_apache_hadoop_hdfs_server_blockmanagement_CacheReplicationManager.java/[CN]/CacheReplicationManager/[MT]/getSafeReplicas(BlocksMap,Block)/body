{
  List<DatanodeDescriptor> nodes=new ArrayList<DatanodeDescriptor>(3);
  Collection<DatanodeDescriptor> corrupted=blockManager.corruptReplicas.getNodes(block);
  Iterator<DatanodeDescriptor> it=map.nodeIterator(block);
  while (it.hasNext()) {
    DatanodeDescriptor dn=it.next();
    if (dn.isDecommissioned() || dn.isDecommissionInProgress()) {
      continue;
    }
    if (corrupted != null && corrupted.contains(dn)) {
      continue;
    }
    nodes.add(dn);
  }
  return nodes;
}
