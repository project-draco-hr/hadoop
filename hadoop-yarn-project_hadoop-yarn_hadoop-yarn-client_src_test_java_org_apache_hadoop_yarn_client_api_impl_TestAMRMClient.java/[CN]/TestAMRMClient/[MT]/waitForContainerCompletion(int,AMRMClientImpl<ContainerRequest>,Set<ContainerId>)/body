{
  while (!releases.isEmpty() || numIterations-- > 0) {
    AllocateResponse allocResponse=amClient.allocate(0.1f);
    assertEquals(0,allocResponse.getAllocatedContainers().size());
    if (allocResponse.getCompletedContainersStatuses().size() > 0) {
      for (      ContainerStatus cStatus : allocResponse.getCompletedContainersStatuses()) {
        if (releases.contains(cStatus.getContainerId())) {
          assertEquals(cStatus.getState(),ContainerState.COMPLETE);
          assertEquals(-100,cStatus.getExitStatus());
          releases.remove(cStatus.getContainerId());
        }
      }
    }
    if (numIterations > 0) {
      sleep(100);
    }
  }
  assertEquals(0,amClient.ask.size());
  assertEquals(0,amClient.release.size());
}
