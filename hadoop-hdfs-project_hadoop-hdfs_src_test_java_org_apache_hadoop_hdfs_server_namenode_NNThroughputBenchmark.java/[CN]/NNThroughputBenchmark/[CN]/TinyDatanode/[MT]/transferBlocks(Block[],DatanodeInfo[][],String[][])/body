{
  for (int i=0; i < blocks.length; i++) {
    DatanodeInfo blockTargets[]=xferTargets[i];
    for (int t=0; t < blockTargets.length; t++) {
      DatanodeInfo dnInfo=blockTargets[t];
      String targetStorageID=targetStorageIDs[i][t];
      DatanodeRegistration receivedDNReg;
      receivedDNReg=new DatanodeRegistration(dnInfo,new DataStorage(nsInfo),new ExportedBlockKeys(),VersionInfo.getVersion());
      ReceivedDeletedBlockInfo[] rdBlocks={new ReceivedDeletedBlockInfo(blocks[i],ReceivedDeletedBlockInfo.BlockStatus.RECEIVED_BLOCK,null)};
      StorageReceivedDeletedBlocks[] report={new StorageReceivedDeletedBlocks(targetStorageID,rdBlocks)};
      nameNodeProto.blockReceivedAndDeleted(receivedDNReg,nameNode.getNamesystem().getBlockPoolId(),report);
    }
  }
  return blocks.length;
}
