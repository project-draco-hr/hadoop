{
  StorageReport[] rep={new StorageReport(storage,false,DF_CAPACITY,DF_USED,DF_CAPACITY - DF_USED,DF_USED)};
  DatanodeCommand[] cmds=nameNodeProto.sendHeartbeat(dnRegistration,rep,0L,0L,0,0,0,null).getCommands();
  if (cmds != null) {
    for (    DatanodeCommand cmd : cmds) {
      if (cmd.getAction() == DatanodeProtocol.DNA_TRANSFER) {
        BlockCommand bcmd=(BlockCommand)cmd;
        return transferBlocks(bcmd.getBlocks(),bcmd.getTargets(),bcmd.getTargetStorageIDs());
      }
    }
  }
  return 0;
}
