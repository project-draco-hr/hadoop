{
  StorageReport[] rep={new StorageReport(dnRegistration.getStorageID(),false,DF_CAPACITY,DF_USED,DF_CAPACITY - DF_USED,DF_USED)};
  CacheReport[] cacheRep={new CacheReport(0l,0l)};
  DatanodeCommand[] cmds=nameNodeProto.sendHeartbeat(dnRegistration,rep,cacheRep,0,0,0).getCommands();
  if (cmds != null) {
    for (    DatanodeCommand cmd : cmds) {
      if (cmd.getAction() == DatanodeProtocol.DNA_TRANSFER) {
        BlockCommand bcmd=(BlockCommand)cmd;
        return transferBlocks(bcmd.getBlocks(),bcmd.getTargets());
      }
    }
  }
  return 0;
}
