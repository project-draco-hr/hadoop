{
  Reader reader=new Reader(fs.open(path),fs.getFileStatus(path).getLen(),conf);
  Scanner scanner=reader.createScanner();
  try {
    for (int nx=0; nx < count; nx++, scanner.advance()) {
      Assert.assertFalse(scanner.atEnd());
      byte[] kbuf=new byte[BUF_SIZE];
      int klen=scanner.entry().getKeyLength();
      scanner.entry().getKey(kbuf);
      Assert.assertEquals(new String(kbuf,0,klen),composeSortedKey(KEY,nx));
      byte[] vbuf=new byte[BUF_SIZE];
      int vlen=scanner.entry().getValueLength();
      scanner.entry().getValue(vbuf);
      Assert.assertEquals(new String(vbuf,0,vlen),VALUE + nx);
    }
    Assert.assertTrue(scanner.atEnd());
    Assert.assertFalse(scanner.advance());
  }
  finally {
    scanner.close();
    reader.close();
  }
}
