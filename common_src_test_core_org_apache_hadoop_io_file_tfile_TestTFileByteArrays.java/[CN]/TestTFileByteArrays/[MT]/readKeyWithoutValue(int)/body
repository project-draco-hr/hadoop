{
  Reader reader=new Reader(fs.open(path),fs.getFileStatus(path).getLen(),conf);
  Scanner scanner=reader.createScannerByKey(composeSortedKey(KEY,recordIndex).getBytes(),null);
  try {
    byte[] kbuf1=new byte[BUF_SIZE];
    int klen1=scanner.entry().getKeyLength();
    scanner.entry().getKey(kbuf1);
    Assert.assertEquals(new String(kbuf1,0,klen1),composeSortedKey(KEY,recordIndex));
    if (scanner.advance() && !scanner.atEnd()) {
      byte[] kbuf2=new byte[BUF_SIZE];
      int klen2=scanner.entry().getKeyLength();
      scanner.entry().getKey(kbuf2);
      Assert.assertEquals(new String(kbuf2,0,klen2),composeSortedKey(KEY,recordIndex + 1));
    }
  }
  finally {
    scanner.close();
    reader.close();
  }
}
