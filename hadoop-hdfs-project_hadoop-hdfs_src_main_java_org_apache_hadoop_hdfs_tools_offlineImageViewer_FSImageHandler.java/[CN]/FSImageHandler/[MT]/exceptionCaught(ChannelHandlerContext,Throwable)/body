{
  Exception e=cause instanceof Exception ? (Exception)cause : new Exception(cause);
  final String output=JsonUtil.toJsonString(e);
  ByteBuf content=Unpooled.wrappedBuffer(output.getBytes());
  final DefaultFullHttpResponse resp=new DefaultFullHttpResponse(HTTP_1_1,INTERNAL_SERVER_ERROR,content);
  resp.headers().set("Content-Type","application/json");
  if (e instanceof IllegalArgumentException) {
    resp.setStatus(BAD_REQUEST);
  }
 else   if (e instanceof FileNotFoundException) {
    resp.setStatus(NOT_FOUND);
  }
  resp.headers().set("Content-Length",resp.content().readableBytes());
  resp.headers().set("Connection","close");
  ctx.write(resp).addListener(ChannelFutureListener.CLOSE);
}
