{
  HttpRequest request=(HttpRequest)e.getMessage();
  HttpResponse response=new DefaultHttpResponse(HttpVersion.HTTP_1_1,HttpResponseStatus.OK);
  response.setHeader(HttpHeaders.Names.CONTENT_TYPE,"application/json");
  String content=null;
  if (request.getMethod() == HttpMethod.GET) {
    if (op.equals("GETFILESTATUS")) {
      content=loader.getFileStatus(path);
    }
 else     if (op.equals("LISTSTATUS")) {
      content=loader.listStatus(path);
    }
 else     if (op.equals("GETACLSTATUS")) {
      content=loader.getAclStatus(path);
    }
 else {
      response.setStatus(HttpResponseStatus.BAD_REQUEST);
    }
  }
 else {
    response.setStatus(HttpResponseStatus.METHOD_NOT_ALLOWED);
  }
  if (content != null) {
    HttpHeaders.setContentLength(response,content.length());
  }
  e.getChannel().write(response);
  if (content != null) {
    e.getChannel().write(content);
  }
  LOG.info(response.getStatus().getCode() + " method=" + request.getMethod().getName()+ " op="+ op+ " target="+ path);
}
