{
  BlockingQueue<Event> eventQueue=spy(new LinkedBlockingQueue<Event>());
  Event event=mock(Event.class);
  doThrow(new InterruptedException()).when(eventQueue).put(event);
  DrainDispatcher disp=new DrainDispatcher(eventQueue);
  disp.init(new Configuration());
  disp.setDrainEventsOnStop();
  disp.start();
  disp.waitForEventThreadToWait();
  try {
    disp.getEventHandler().handle(event);
    Assert.fail("Expected YarnRuntimeException");
  }
 catch (  YarnRuntimeException e) {
    Assert.assertTrue(e.getCause() instanceof InterruptedException);
  }
  Assert.assertTrue("Event Queue should have been empty",eventQueue.isEmpty());
  disp.close();
}
