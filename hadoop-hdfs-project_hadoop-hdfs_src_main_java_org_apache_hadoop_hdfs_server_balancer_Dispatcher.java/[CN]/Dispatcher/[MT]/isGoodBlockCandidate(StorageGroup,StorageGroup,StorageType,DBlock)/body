{
  if (source.equals(target)) {
    return false;
  }
  if (target.storageType != targetStorageType) {
    return false;
  }
  if (movedBlocks.contains(block.getBlock())) {
    return false;
  }
  final DatanodeInfo targetDatanode=target.getDatanodeInfo();
  if (source.getDatanodeInfo().equals(targetDatanode)) {
    return true;
  }
  for (  StorageGroup blockLocation : block.getLocations()) {
    if (blockLocation.getDatanodeInfo().equals(targetDatanode)) {
      return false;
    }
  }
  if (cluster.isNodeGroupAware() && isOnSameNodeGroupWithReplicas(source,target,block)) {
    return false;
  }
  if (reduceNumOfRacks(source,target,block)) {
    return false;
  }
  return true;
}
