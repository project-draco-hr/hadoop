{
  final long bytesLastMoved=getBytesMoved();
  final Future<?>[] futures=new Future<?>[sources.size()];
  final Iterator<Source> i=sources.iterator();
  for (int j=0; j < futures.length; j++) {
    final Source s=i.next();
    futures[j]=dispatchExecutor.submit(new Runnable(){
      @Override public void run(){
        s.dispatchBlocks();
      }
    }
);
  }
  for (  Future<?> future : futures) {
    try {
      future.get();
    }
 catch (    ExecutionException e) {
      LOG.warn("Dispatcher thread failed",e.getCause());
    }
  }
  waitForMoveCompletion(targets);
  return getBytesMoved() - bytesLastMoved;
}
