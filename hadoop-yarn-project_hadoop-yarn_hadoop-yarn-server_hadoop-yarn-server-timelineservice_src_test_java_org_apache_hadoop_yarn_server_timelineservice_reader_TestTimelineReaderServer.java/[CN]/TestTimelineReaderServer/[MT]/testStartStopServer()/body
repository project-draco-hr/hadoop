{
  TimelineReaderServer server=new TimelineReaderServer();
  Configuration config=new YarnConfiguration();
  config.set(YarnConfiguration.TIMELINE_SERVICE_WEBAPP_ADDRESS,"localhost:0");
  try {
    server.init(config);
    assertEquals(STATE.INITED,server.getServiceState());
    assertEquals(2,server.getServices().size());
    server.start();
    assertEquals(STATE.STARTED,server.getServiceState());
    server.stop();
    assertEquals(STATE.STOPPED,server.getServiceState());
  }
  finally {
    server.stop();
  }
}
