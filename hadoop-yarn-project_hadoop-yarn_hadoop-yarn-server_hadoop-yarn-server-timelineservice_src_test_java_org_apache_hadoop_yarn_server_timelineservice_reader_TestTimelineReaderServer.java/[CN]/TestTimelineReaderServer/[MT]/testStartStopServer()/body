{
  @SuppressWarnings("resource") TimelineReaderServer server=new TimelineReaderServer();
  Configuration config=new YarnConfiguration();
  config.setBoolean(YarnConfiguration.TIMELINE_SERVICE_ENABLED,true);
  config.setFloat(YarnConfiguration.TIMELINE_SERVICE_VERSION,2.0f);
  config.set(YarnConfiguration.TIMELINE_SERVICE_WEBAPP_ADDRESS,"localhost:0");
  config.setClass(YarnConfiguration.TIMELINE_SERVICE_READER_CLASS,FileSystemTimelineReaderImpl.class,TimelineReader.class);
  try {
    server.init(config);
    assertEquals(STATE.INITED,server.getServiceState());
    assertEquals(2,server.getServices().size());
    server.start();
    assertEquals(STATE.STARTED,server.getServiceState());
    server.stop();
    assertEquals(STATE.STOPPED,server.getServiceState());
  }
  finally {
    server.stop();
  }
}
