{
  Path remoteRootLogDir=new Path(getConf().get(YarnConfiguration.NM_REMOTE_APP_LOG_DIR,YarnConfiguration.DEFAULT_NM_REMOTE_APP_LOG_DIR));
  String user=appOwner;
  String logDirSuffix=LogAggregationUtils.getRemoteNodeLogDirSuffix(getConf());
  Path remoteAppLogDir=LogAggregationUtils.getRemoteAppLogDir(remoteRootLogDir,appId,user,logDirSuffix);
  RemoteIterator<FileStatus> nodeFiles;
  try {
    Path qualifiedLogDir=FileContext.getFileContext(getConf()).makeQualified(remoteAppLogDir);
    nodeFiles=FileContext.getFileContext(qualifiedLogDir.toUri(),getConf()).listStatus(remoteAppLogDir);
  }
 catch (  FileNotFoundException fnf) {
    System.out.println("Logs not available at " + remoteAppLogDir.toString());
    System.out.println("Log aggregation has not completed or is not enabled.");
    return -1;
  }
  while (nodeFiles.hasNext()) {
    FileStatus thisNodeFile=nodeFiles.next();
    AggregatedLogFormat.LogReader reader=new AggregatedLogFormat.LogReader(getConf(),new Path(remoteAppLogDir,thisNodeFile.getPath().getName()));
    try {
      DataInputStream valueStream;
      LogKey key=new LogKey();
      valueStream=reader.next(key);
      while (valueStream != null) {
        String containerString="\n\nContainer: " + key + " on "+ thisNodeFile.getPath().getName();
        out.println(containerString);
        out.println(StringUtils.repeat("=",containerString.length()));
        while (true) {
          try {
            LogReader.readAContainerLogsForALogType(valueStream,out);
          }
 catch (          EOFException eof) {
            break;
          }
        }
        key=new LogKey();
        valueStream=reader.next(key);
      }
    }
  finally {
      reader.close();
    }
  }
  return 0;
}
