{
  String argName="refreshQueues";
  final String msg="refresh queues.";
  UserGroupInformation user=checkAcls(argName);
  checkRMStatus(user.getShortUserName(),argName,msg);
  RefreshQueuesResponse response=recordFactory.newRecordInstance(RefreshQueuesResponse.class);
  try {
    rmContext.getScheduler().reinitialize(getConfig(),this.rmContext);
    ReservationSystem rSystem=rmContext.getReservationSystem();
    if (rSystem != null) {
      rSystem.reinitialize(getConfig(),rmContext);
    }
    RMAuditLogger.logSuccess(user.getShortUserName(),argName,"AdminService");
    return response;
  }
 catch (  IOException ioe) {
    throw logAndWrapException(ioe,user.getShortUserName(),argName,msg);
  }
}
