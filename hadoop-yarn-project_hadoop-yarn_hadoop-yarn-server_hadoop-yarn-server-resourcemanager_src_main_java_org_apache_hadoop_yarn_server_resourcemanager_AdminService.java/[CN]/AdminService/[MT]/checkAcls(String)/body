{
  UserGroupInformation user;
  try {
    user=UserGroupInformation.getCurrentUser();
  }
 catch (  IOException ioe) {
    LOG.warn("Couldn't get current user",ioe);
    RMAuditLogger.logFailure("UNKNOWN",method,adminAcl.toString(),"AdminService","Couldn't get current user");
    throw RPCUtil.getRemoteException(ioe);
  }
  if (!adminAcl.isUserAllowed(user)) {
    LOG.warn("User " + user.getShortUserName() + " doesn't have permission"+ " to call '"+ method+ "'");
    RMAuditLogger.logFailure(user.getShortUserName(),method,adminAcl.toString(),"AdminService",AuditConstants.UNAUTHORIZED_USER);
    throw RPCUtil.getRemoteException(new AccessControlException("User " + user.getShortUserName() + " doesn't have permission"+ " to call '"+ method+ "'"));
  }
  LOG.info("RM Admin: " + method + " invoked by user "+ user.getShortUserName());
  return user;
}
