{
  Map<NodeId,ResourceOption> nodeResourceMap=request.getNodeResourceMap();
  Set<NodeId> nodeIds=nodeResourceMap.keySet();
  for (  NodeId nodeId : nodeIds) {
    RMNode node=this.rmContext.getRMNodes().get(nodeId);
    if (node == null) {
      LOG.error("Resource update get failed on all nodes due to change " + "resource on an unrecognized node: " + nodeId);
      throw RPCUtil.getRemoteException("Resource update get failed on all nodes due to change resource " + "on an unrecognized node: " + nodeId);
    }
  }
  for (  Map.Entry<NodeId,ResourceOption> entry : nodeResourceMap.entrySet()) {
    ResourceOption newResourceOption=entry.getValue();
    NodeId nodeId=entry.getKey();
    RMNode node=this.rmContext.getRMNodes().get(nodeId);
    if (node == null) {
      LOG.warn("Resource update get failed on an unrecognized node: " + nodeId);
    }
 else {
      node.setResourceOption(newResourceOption);
      LOG.info("Update resource successfully on node(" + node.getNodeID() + ") with resource("+ newResourceOption.toString()+ ")");
    }
  }
  UpdateNodeResourceResponse response=recordFactory.newRecordInstance(UpdateNodeResourceResponse.class);
  return response;
}
