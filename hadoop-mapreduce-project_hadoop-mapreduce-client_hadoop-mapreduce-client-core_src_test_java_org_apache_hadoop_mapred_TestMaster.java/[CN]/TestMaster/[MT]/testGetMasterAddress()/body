{
  YarnConfiguration conf=new YarnConfiguration();
  String masterHostname=Master.getMasterAddress(conf).getHostName();
  InetSocketAddress rmAddr=NetUtils.createSocketAddr(YarnConfiguration.DEFAULT_RM_ADDRESS);
  assertEquals(masterHostname,rmAddr.getHostName());
  conf.set(MRConfig.FRAMEWORK_NAME,MRConfig.CLASSIC_FRAMEWORK_NAME);
  conf.set(MRConfig.MASTER_ADDRESS,"local");
  try {
    Master.getMasterAddress(conf);
    fail("Should not reach here as there is a bad master address");
  }
 catch (  Exception e) {
  }
  conf.set(MRConfig.MASTER_ADDRESS,"bar.com:9999");
  masterHostname=Master.getMasterAddress(conf).getHostName();
  assertEquals(masterHostname,"bar.com");
  conf.set(MRConfig.FRAMEWORK_NAME,MRConfig.YARN_FRAMEWORK_NAME);
  conf.set(YarnConfiguration.RM_ADDRESS,"foo1.com:8192");
  masterHostname=Master.getMasterAddress(conf).getHostName();
  assertEquals(masterHostname,"foo1.com");
}
