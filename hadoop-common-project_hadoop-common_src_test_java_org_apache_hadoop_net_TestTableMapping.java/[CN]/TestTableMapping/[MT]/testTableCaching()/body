{
  TableMapping mapping=new TableMapping();
  Configuration conf=new Configuration();
  conf.set(NET_TOPOLOGY_TABLE_MAPPING_FILE_KEY,mappingFile.getCanonicalPath());
  mapping.setConf(conf);
  List<String> names=new ArrayList<String>();
  names.add("a.b.c");
  names.add("1.2.3.4");
  List<String> result1=mapping.resolve(names);
  assertEquals(names.size(),result1.size());
  assertEquals("/rack1",result1.get(0));
  assertEquals("/rack2",result1.get(1));
  conf.set(NET_TOPOLOGY_TABLE_MAPPING_FILE_KEY,"some bad value for a file");
  List<String> result2=mapping.resolve(names);
  assertEquals(result1,result2);
}
