{
  NodeStatus nodeStatus=request.getNodeStatus();
  LOG.info("Got heartbeat number " + heartBeatID);
  nodeStatus.setResponseId(heartBeatID++);
  HeartbeatResponse response=recordFactory.newRecordInstance(HeartbeatResponse.class);
  response.setResponseId(heartBeatID);
  NodeHeartbeatResponse nhResponse=recordFactory.newRecordInstance(NodeHeartbeatResponse.class);
  nhResponse.setHeartbeatResponse(response);
  return nhResponse;
}
