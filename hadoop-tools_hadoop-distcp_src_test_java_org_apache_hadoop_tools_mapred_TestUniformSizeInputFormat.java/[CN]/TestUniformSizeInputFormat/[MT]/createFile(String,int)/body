{
  FileSystem fileSystem=null;
  DataOutputStream outputStream=null;
  try {
    fileSystem=cluster.getFileSystem();
    outputStream=fileSystem.create(new Path(path),true,0);
    int size=(int)Math.ceil(fileSize + (1 - random.nextFloat()) * fileSize);
    outputStream.write(new byte[size]);
    return size;
  }
  finally {
    IOUtils.cleanup(null,fileSystem,outputStream);
  }
}
