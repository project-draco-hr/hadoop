{
  JobConf jobConf=job.getJobConf();
  int slotsPerMap=1;
  int slotsPerReduce=1;
  if (MemoryMatcher.isSchedulingBasedOnMemEnabled()) {
    slotsPerMap=jobConf.computeNumSlotsPerMap(MemoryMatcher.getMemSizeForMapSlot());
    slotsPerReduce=jobConf.computeNumSlotsPerReduce(MemoryMatcher.getMemSizeForReduceSlot());
  }
  job.setNumSlotsPerMap(slotsPerMap);
  job.setNumSlotsPerReduce(slotsPerReduce);
}
