{
  if (!shouldRun()) {
    return;
  }
  startCluster();
  jobOwner.doAs(new PrivilegedExceptionAction<Object>(){
    public Object run() throws Exception {
      TestMiniMRChildTask childTask=new TestMiniMRChildTask();
      Path inDir=new Path("input1");
      Path outDir=new Path("output1");
      try {
        childTask.runTestTaskEnv(getClusterConf(),inDir,outDir,false);
      }
 catch (      IOException e) {
        fail("IOException thrown while running enviroment test." + e.getMessage());
      }
 finally {
        FileSystem outFs=outDir.getFileSystem(getClusterConf());
        if (outFs.exists(outDir)) {
          assertOwnerShip(outDir);
          outFs.delete(outDir,true);
        }
 else {
          fail("Output directory does not exist" + outDir.toString());
        }
        return null;
      }
    }
  }
);
}
