{
  long numRead=0;
  CRC32 newcrc=new CRC32();
  FSDataInputStream stm=fileSys.open(name);
  final byte[] b=new byte[4192];
  int num=0;
  while (num >= 0) {
    num=stm.read(b);
    if (num < 0) {
      break;
    }
    numRead+=num;
    newcrc.update(b,0,num);
  }
  stm.close();
  if (numRead != length) {
    LOG.info("Number of bytes read " + numRead + " does not match file size "+ length);
    return false;
  }
  LOG.info(" Newcrc " + newcrc.getValue() + " old crc "+ crc);
  if (newcrc.getValue() != crc) {
    LOG.info("CRC mismatch of file " + name + ": "+ newcrc+ " vs. "+ crc);
    return false;
  }
  return true;
}
