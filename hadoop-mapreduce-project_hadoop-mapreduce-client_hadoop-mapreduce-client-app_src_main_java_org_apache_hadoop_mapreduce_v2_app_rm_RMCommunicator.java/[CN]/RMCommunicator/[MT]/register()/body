{
  InetSocketAddress serviceAddr=null;
  if (clientService != null) {
    serviceAddr=clientService.getBindAddress();
  }
  try {
    RegisterApplicationMasterRequest request=recordFactory.newRecordInstance(RegisterApplicationMasterRequest.class);
    request.setApplicationAttemptId(applicationAttemptId);
    if (serviceAddr != null) {
      request.setHost(serviceAddr.getHostName());
      request.setRpcPort(serviceAddr.getPort());
      request.setTrackingUrl(serviceAddr.getHostName() + ":" + clientService.getHttpPort());
    }
    RegisterApplicationMasterResponse response=scheduler.registerApplicationMaster(request);
    minContainerCapability=response.getMinimumResourceCapability();
    maxContainerCapability=response.getMaximumResourceCapability();
    this.context.getClusterInfo().setMinContainerCapability(minContainerCapability);
    this.context.getClusterInfo().setMaxContainerCapability(maxContainerCapability);
    this.applicationACLs=response.getApplicationACLs();
    LOG.info("minContainerCapability: " + minContainerCapability.getMemory());
    LOG.info("maxContainerCapability: " + maxContainerCapability.getMemory());
  }
 catch (  Exception are) {
    LOG.error("Exception while registering",are);
    throw new YarnRuntimeException(are);
  }
}
