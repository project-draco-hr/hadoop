{
  if (stopped.getAndSet(true)) {
    return;
  }
  allocatorThread.interrupt();
  try {
    allocatorThread.join();
  }
 catch (  InterruptedException ie) {
    LOG.warn("InterruptedException while stopping",ie);
  }
  if (shouldUnregister) {
    unregister();
  }
  super.stop();
}
