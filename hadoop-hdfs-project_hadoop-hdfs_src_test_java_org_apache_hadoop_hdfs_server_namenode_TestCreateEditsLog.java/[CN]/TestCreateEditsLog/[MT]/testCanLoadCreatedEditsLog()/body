{
  HdfsConfiguration conf=new HdfsConfiguration();
  File nameDir=new File(HDFS_DIR,"name");
  conf.set(DFS_NAMENODE_NAME_DIR_KEY,Util.fileAsURI(nameDir).toString());
  DFSTestUtil.formatNameNode(conf);
  CreateEditsLog.main(new String[]{"-f","1000","0","1","-d",TEST_DIR.getAbsolutePath()});
  Path editsWildcard=new Path(TEST_DIR.getAbsolutePath(),"*");
  FileContext localFc=FileContext.getLocalFSFileContext();
  for (  FileStatus edits : localFc.util().globStatus(editsWildcard)) {
    Path src=edits.getPath();
    Path dst=new Path(new File(nameDir,"current").getAbsolutePath(),src.getName());
    localFc.rename(src,dst);
  }
  cluster=new MiniDFSCluster.Builder(conf).format(false).manageNameDfsDirs(false).waitSafeMode(false).build();
  cluster.waitClusterUp();
}
