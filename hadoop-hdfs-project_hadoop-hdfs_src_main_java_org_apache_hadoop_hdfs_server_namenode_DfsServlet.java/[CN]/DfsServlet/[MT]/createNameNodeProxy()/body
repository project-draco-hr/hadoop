{
  ServletContext context=getServletContext();
  NameNode nn=NameNodeHttpServer.getNameNodeFromContext(context);
  if (nn != null) {
    return nn.getRpcServer();
  }
  InetSocketAddress nnAddr=NameNodeHttpServer.getNameNodeAddressFromContext(context);
  Configuration conf=new HdfsConfiguration(NameNodeHttpServer.getConfFromContext(context));
  return DFSUtil.createNamenode(nnAddr,conf);
}
