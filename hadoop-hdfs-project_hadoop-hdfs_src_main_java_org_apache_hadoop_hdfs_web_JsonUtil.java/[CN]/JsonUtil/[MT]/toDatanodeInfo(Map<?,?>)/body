{
  if (m == null) {
    return null;
  }
  String ipAddr=getString(m,"ipAddr",null);
  int xferPort=getInt(m,"xferPort",-1);
  if (ipAddr == null) {
    String name=getString(m,"name",null);
    if (name != null) {
      int colonIdx=name.indexOf(':');
      if (colonIdx > 0) {
        ipAddr=name.substring(0,colonIdx);
        xferPort=Integer.parseInt(name.substring(colonIdx + 1));
      }
 else {
        throw new IOException("Invalid value in server response: name=[" + name + "]");
      }
    }
 else {
      throw new IOException("Missing both 'ipAddr' and 'name' in server response.");
    }
  }
  if (xferPort == -1) {
    throw new IOException("Invalid or missing 'xferPort' in server response.");
  }
  return new DatanodeInfo(ipAddr,(String)m.get("hostName"),(String)m.get("storageID"),xferPort,((Number)m.get("infoPort")).intValue(),getInt(m,"infoSecurePort",0),((Number)m.get("ipcPort")).intValue(),getLong(m,"capacity",0l),getLong(m,"dfsUsed",0l),getLong(m,"remaining",0l),getLong(m,"blockPoolUsed",0l),getLong(m,"cacheCapacity",0l),getLong(m,"cacheUsed",0l),getLong(m,"lastUpdate",0l),getInt(m,"xceiverCount",0),getString(m,"networkLocation",""),AdminStates.valueOf(getString(m,"adminState","NORMAL")));
}
