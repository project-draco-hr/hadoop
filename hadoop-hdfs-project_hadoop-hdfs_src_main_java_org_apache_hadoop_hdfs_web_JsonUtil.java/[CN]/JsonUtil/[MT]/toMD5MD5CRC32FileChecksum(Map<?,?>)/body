{
  if (json == null) {
    return null;
  }
  final Map<?,?> m=(Map<?,?>)json.get(FileChecksum.class.getSimpleName());
  final String algorithm=(String)m.get("algorithm");
  final int length=(int)(long)(Long)m.get("length");
  final byte[] bytes=StringUtils.hexStringToByte((String)m.get("bytes"));
  final DataInputStream in=new DataInputStream(new ByteArrayInputStream(bytes));
  final MD5MD5CRC32FileChecksum checksum=new MD5MD5CRC32FileChecksum();
  checksum.readFields(in);
  if (!checksum.getAlgorithmName().equals(algorithm)) {
    throw new IOException("Algorithm not matched. Expected " + algorithm + ", Received "+ checksum.getAlgorithmName());
  }
  if (length != checksum.getLength()) {
    throw new IOException("Length not matched: length=" + length + ", checksum.getLength()="+ checksum.getLength());
  }
  return checksum;
}
