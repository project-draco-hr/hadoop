{
  final Path f=new Path("/test/test");
  final FSDataOutputStream fsDataOutputStream=fs.create(f);
  final String message="Test string";
  fsDataOutputStream.write(message.getBytes());
  fsDataOutputStream.close();
  assertExists("created file",f);
  FSDataInputStream open=null;
  try {
    open=fs.open(f);
    final byte[] bytes=new byte[512];
    final int read=open.read(bytes);
    final byte[] buffer=new byte[read];
    System.arraycopy(bytes,0,buffer,0,read);
    assertEquals(message,new String(buffer));
  }
  finally {
    fs.delete(f,false);
    IOUtils.closeStream(open);
  }
}
