{
  UserGroupInformation callerUGI=getUser(req);
  ApplicationId aid=parseApplicationId(appId);
  final ApplicationAttemptId aaid=parseApplicationAttemptId(appAttemptId);
  validateIds(aid,aaid,null);
  Collection<ContainerReport> containerReports=null;
  try {
    if (callerUGI == null) {
      GetContainersRequest request=GetContainersRequest.newInstance(aaid);
      containerReports=appBaseProt.getContainers(request).getContainerList();
    }
 else {
      containerReports=callerUGI.doAs(new PrivilegedExceptionAction<Collection<ContainerReport>>(){
        @Override public Collection<ContainerReport> run() throws Exception {
          GetContainersRequest request=GetContainersRequest.newInstance(aaid);
          return appBaseProt.getContainers(request).getContainerList();
        }
      }
);
    }
  }
 catch (  Exception e) {
    rewrapAndThrowException(e);
  }
  ContainersInfo containersInfo=new ContainersInfo();
  for (  ContainerReport containerReport : containerReports) {
    ContainerInfo containerInfo=new ContainerInfo(containerReport);
    containersInfo.add(containerInfo);
  }
  return containersInfo;
}
