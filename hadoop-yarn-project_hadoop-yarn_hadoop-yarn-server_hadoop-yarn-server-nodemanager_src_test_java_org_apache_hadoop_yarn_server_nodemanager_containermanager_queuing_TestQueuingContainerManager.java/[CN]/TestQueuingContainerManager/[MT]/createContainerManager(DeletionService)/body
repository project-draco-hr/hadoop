{
  return new QueuingContainerManagerImpl(context,exec,delSrvc,nodeStatusUpdater,metrics,dirsHandler){
    @Override public void setBlockNewContainerRequests(    boolean blockNewContainerRequests){
    }
    @Override protected UserGroupInformation getRemoteUgi() throws YarnException {
      ApplicationId appId=ApplicationId.newInstance(0,0);
      ApplicationAttemptId appAttemptId=ApplicationAttemptId.newInstance(appId,1);
      UserGroupInformation ugi=UserGroupInformation.createRemoteUser(appAttemptId.toString());
      ugi.addTokenIdentifier(new NMTokenIdentifier(appAttemptId,context.getNodeId(),user,context.getNMTokenSecretManager().getCurrentKey().getKeyId()));
      return ugi;
    }
    @Override protected ContainersMonitor createContainersMonitor(    ContainerExecutor exec){
      return new ContainersMonitorImpl(exec,dispatcher,this.context){
        @Override public long getPmemAllocatedForContainers(){
          return 2048 * 1024 * 1024L;
        }
        @Override public long getVmemAllocatedForContainers(){
          float pmemRatio=getConfig().getFloat(YarnConfiguration.NM_VMEM_PMEM_RATIO,YarnConfiguration.DEFAULT_NM_VMEM_PMEM_RATIO);
          return (long)(pmemRatio * getPmemAllocatedForContainers());
        }
        @Override public long getVCoresAllocatedForContainers(){
          return 4;
        }
      }
;
    }
  }
;
}
