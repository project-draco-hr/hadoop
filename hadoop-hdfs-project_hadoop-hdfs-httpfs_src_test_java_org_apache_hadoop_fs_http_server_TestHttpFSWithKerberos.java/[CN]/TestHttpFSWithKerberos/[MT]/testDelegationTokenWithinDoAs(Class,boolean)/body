{
  Configuration conf=new Configuration();
  conf.set("hadoop.security.authentication","kerberos");
  UserGroupInformation.setConfiguration(conf);
  UserGroupInformation.loginUserFromKeytab("client","/Users/tucu/tucu.keytab");
  UserGroupInformation ugi=UserGroupInformation.getLoginUser();
  if (proxyUser) {
    ugi=UserGroupInformation.createProxyUser("foo",ugi);
  }
  conf=new Configuration();
  UserGroupInformation.setConfiguration(conf);
  ugi.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      testDelegationTokenWithFS(fileSystemClass);
      return null;
    }
  }
);
}
