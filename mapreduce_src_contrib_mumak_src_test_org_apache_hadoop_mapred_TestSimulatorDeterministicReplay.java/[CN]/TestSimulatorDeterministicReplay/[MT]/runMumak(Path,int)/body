{
  final Configuration conf=new Configuration();
  conf.set(SimulatorJobSubmissionPolicy.JOB_SUBMISSION_POLICY,policy.name());
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootInputDir=new Path(System.getProperty("src.test.data","data")).makeQualified(lfs);
  final Path traceFile=new Path(rootInputDir,"19-jobs.trace.json.gz");
  final Path topologyFile=new Path(rootInputDir,"19-jobs.topology.json.gz");
  LOG.info("traceFile = " + traceFile + " topology = "+ topologyFile);
  conf.setLong("mumak.start.time",10);
  conf.setLong("mumak.terminate.time",10 + 20 * 60 * 1000);
  conf.setLong("mumak.random.seed",42);
  System.setProperty("hadoop.log.dir",hadoopLogDir.toString());
  conf.set("hadoop.log.dir",hadoopLogDir.toString());
  conf.set("mapred.job.tracker.http.address","0.0.0.0:" + jobTrackerHttpPort);
  conf.setBoolean(JTConfig.JT_PERSIST_JOBSTATUS,false);
  String[] args={traceFile.toString(),topologyFile.toString()};
  int res=ToolRunner.run(conf,new SimulatorEngine(),args);
  Assert.assertEquals(0,res);
}
