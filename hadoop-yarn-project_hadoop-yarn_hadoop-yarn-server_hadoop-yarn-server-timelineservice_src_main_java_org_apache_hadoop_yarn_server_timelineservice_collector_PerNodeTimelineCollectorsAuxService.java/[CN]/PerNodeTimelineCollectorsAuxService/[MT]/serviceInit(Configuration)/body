{
  if (!YarnConfiguration.timelineServiceV2Enabled(conf)) {
    throw new YarnException("Timeline service v2 is not enabled");
  }
  collectorLingerPeriod=conf.getLong(YarnConfiguration.ATS_APP_COLLECTOR_LINGER_PERIOD_IN_MS,YarnConfiguration.DEFAULT_ATS_APP_COLLECTOR_LINGER_PERIOD_IN_MS);
  scheduler=Executors.newSingleThreadScheduledExecutor();
  collectorManager.init(conf);
  super.serviceInit(conf);
}
