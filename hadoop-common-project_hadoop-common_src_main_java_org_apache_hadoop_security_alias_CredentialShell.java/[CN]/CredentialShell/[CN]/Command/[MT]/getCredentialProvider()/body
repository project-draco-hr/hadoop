{
  CredentialProvider provider=null;
  List<CredentialProvider> providers;
  try {
    providers=CredentialProviderFactory.getProviders(getConf());
    if (userSuppliedProvider) {
      provider=providers.get(0);
    }
 else {
      for (      CredentialProvider p : providers) {
        if (!p.isTransient()) {
          provider=p;
          break;
        }
      }
    }
  }
 catch (  IOException e) {
    e.printStackTrace(err);
  }
  return provider;
}
