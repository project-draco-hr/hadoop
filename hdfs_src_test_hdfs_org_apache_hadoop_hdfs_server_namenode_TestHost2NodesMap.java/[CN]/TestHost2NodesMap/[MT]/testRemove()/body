{
  assertFalse(map.remove(NODE));
  assertTrue(map.remove(dataNodes[0]));
  assertTrue(map.getDatanodeByHost("h1") == null);
  assertTrue(map.getDatanodeByHost("h2") == dataNodes[1]);
  DatanodeDescriptor node=map.getDatanodeByHost("h3");
  assertTrue(node == dataNodes[2] || node == dataNodes[3]);
  assertTrue(null == map.getDatanodeByHost("h4"));
  assertTrue(map.remove(dataNodes[2]));
  assertTrue(map.getDatanodeByHost("h1") == null);
  assertTrue(map.getDatanodeByHost("h2") == dataNodes[1]);
  assertTrue(map.getDatanodeByHost("h3") == dataNodes[3]);
  assertTrue(map.remove(dataNodes[3]));
  assertTrue(map.getDatanodeByHost("h1") == null);
  assertTrue(map.getDatanodeByHost("h2") == dataNodes[1]);
  assertTrue(map.getDatanodeByHost("h3") == null);
  assertFalse(map.remove(NULL_NODE));
  assertTrue(map.remove(dataNodes[1]));
  assertFalse(map.remove(dataNodes[1]));
}
