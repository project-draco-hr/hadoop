{
  Iterator itr=conf.iterator();
  List<String> proxyUsersData=new ArrayList<String>();
  while (itr.hasNext()) {
    String property=itr.next().toString();
    if (property.indexOf("hadoop.proxyuser") >= 0 && property.indexOf("groups=") >= 0) {
      proxyUsersData.add(property.split("\\.")[2]);
    }
  }
  if (proxyUsersData.size() == 0) {
    LOG.error("No proxy users found in the configuration.");
    throw new Exception("No proxy users found in the configuration.");
  }
  ProxyUserDefinitions pud=new ProxyUserDefinitions(){
    public boolean writeToFile(    URI filePath) throws IOException {
      throw new UnsupportedOperationException("No such methood exists.");
    }
  }
;
  for (  String userName : proxyUsersData) {
    List<String> groups=Arrays.asList(conf.get("hadoop.proxyuser." + userName + ".groups").split("//,"));
    List<String> hosts=Arrays.asList(conf.get("hadoop.proxyuser." + userName + ".hosts").split("//,"));
    ProxyUserDefinitions.GroupsAndHost definitions=pud.new GroupsAndHost();
    definitions.setGroups(groups);
    definitions.setHosts(hosts);
    pud.addProxyUser(userName,definitions);
  }
  return pud;
}
