{
  Path outputDir=new Path(gridmixDir,"gridmix");
  Path inputDir=new Path(gridmixDir,"input");
  LOG.info("Cleanup the data if data already exists.");
  String modeName=new String();
switch (gridmixRunMode) {
case 1:
    cleanup(inputDir,conf);
  cleanup(outputDir,conf);
modeName=GridMixRunMode.DATA_GENERATION.name();
break;
case 2:
cleanup(outputDir,conf);
modeName=GridMixRunMode.RUN_GRIDMIX.name();
break;
case 3:
cleanup(inputDir,conf);
cleanup(outputDir,conf);
modeName=GridMixRunMode.DATA_GENERATION_AND_RUN_GRIDMIX.name();
break;
}
final String[] args=UtilsForGridmix.getArgsList(gridmixDir,gridmixRunMode,runtimeValues,otherArgs);
Gridmix gridmix=new Gridmix();
LOG.info("Submit a Gridmix job in " + runtimeValues[1] + " mode for "+ modeName);
int exitCode=ToolRunner.run(conf,gridmix,args);
return exitCode;
}
