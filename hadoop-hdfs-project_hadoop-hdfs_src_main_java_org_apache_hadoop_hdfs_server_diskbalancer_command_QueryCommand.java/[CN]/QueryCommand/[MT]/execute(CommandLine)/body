{
  LOG.info("Executing \"query plan\" command.");
  Preconditions.checkState(cmd.hasOption(DiskBalancer.QUERY));
  verifyCommandOptions(DiskBalancer.QUERY,cmd);
  String nodeName=cmd.getOptionValue(DiskBalancer.QUERY);
  Preconditions.checkNotNull(nodeName);
  ClientDatanodeProtocol dataNode=getDataNodeProxy(nodeName);
  try {
    DiskBalancerWorkStatus workStatus=dataNode.queryDiskBalancerPlan();
    System.out.printf("Plan ID: %s Result: %s%n",workStatus.getPlanID(),workStatus.getResult().toString());
    if (cmd.hasOption(DiskBalancer.VERBOSE)) {
      System.out.printf("%s",workStatus.currentStateString());
    }
  }
 catch (  DiskBalancerException ex) {
    LOG.error("Query plan failed. ex: {}",ex);
    throw ex;
  }
}
