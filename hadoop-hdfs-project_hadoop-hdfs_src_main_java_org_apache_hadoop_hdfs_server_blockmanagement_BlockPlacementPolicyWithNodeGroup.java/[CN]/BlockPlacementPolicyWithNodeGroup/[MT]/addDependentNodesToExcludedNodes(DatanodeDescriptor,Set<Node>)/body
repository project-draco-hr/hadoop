{
  if (this.host2datanodeMap == null) {
    return 0;
  }
  int countOfExcludedNodes=0;
  for (  String hostname : chosenNode.getDependentHostNames()) {
    DatanodeDescriptor node=this.host2datanodeMap.getDataNodeByHostName(hostname);
    if (node != null) {
      if (excludedNodes.add(node)) {
        countOfExcludedNodes++;
      }
    }
 else {
      LOG.warn("Not able to find datanode " + hostname + " which has dependency with datanode "+ chosenNode.getHostName());
    }
  }
  return countOfExcludedNodes;
}
