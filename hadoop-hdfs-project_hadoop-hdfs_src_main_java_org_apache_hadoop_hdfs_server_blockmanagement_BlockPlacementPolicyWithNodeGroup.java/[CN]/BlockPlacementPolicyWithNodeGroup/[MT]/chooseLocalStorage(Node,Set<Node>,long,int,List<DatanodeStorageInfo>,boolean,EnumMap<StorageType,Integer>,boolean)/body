{
  DatanodeStorageInfo localStorage=chooseLocalStorage(localMachine,excludedNodes,blocksize,maxNodesPerRack,results,avoidStaleNodes,storageTypes);
  if (localStorage != null) {
    return localStorage;
  }
  if (!fallbackToNodeGroupAndLocalRack) {
    return null;
  }
  DatanodeStorageInfo chosenStorage=chooseLocalNodeGroup((NetworkTopologyWithNodeGroup)clusterMap,localMachine,excludedNodes,blocksize,maxNodesPerRack,results,avoidStaleNodes,storageTypes);
  if (chosenStorage != null) {
    return chosenStorage;
  }
  return chooseLocalRack(localMachine,excludedNodes,blocksize,maxNodesPerRack,results,avoidStaleNodes,storageTypes);
}
