{
synchronized (this) {
    if (workerThreads != 0) {
      shuffleMetricsRecord.setMetric("shuffle_handler_busy_percent",100 * ((float)serverHandlerBusy / workerThreads));
    }
 else {
      shuffleMetricsRecord.setMetric("shuffle_handler_busy_percent",0);
    }
    shuffleMetricsRecord.incrMetric("shuffle_output_bytes",outputBytes);
    shuffleMetricsRecord.incrMetric("shuffle_failed_outputs",failedOutputs);
    shuffleMetricsRecord.incrMetric("shuffle_success_outputs",successOutputs);
    shuffleMetricsRecord.incrMetric("shuffle_exceptions_caught",exceptionsCaught);
    outputBytes=0;
    failedOutputs=0;
    successOutputs=0;
    exceptionsCaught=0;
  }
  shuffleMetricsRecord.update();
}
