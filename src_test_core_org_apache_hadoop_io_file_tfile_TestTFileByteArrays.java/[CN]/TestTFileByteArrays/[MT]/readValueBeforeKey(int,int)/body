{
  Reader reader=new Reader(fs.open(path),fs.getFileStatus(path).getLen(),conf);
  Scanner scanner=reader.createScanner(composeSortedKey(KEY,count,recordIndex).getBytes(),null);
  try {
    byte[] vbuf=new byte[BUF_SIZE];
    int vlen=scanner.entry().getValueLength();
    scanner.entry().getValue(vbuf);
    Assert.assertEquals(new String(vbuf,0,vlen),VALUE + recordIndex);
    byte[] kbuf=new byte[BUF_SIZE];
    int klen=scanner.entry().getKeyLength();
    scanner.entry().getKey(kbuf);
    Assert.assertEquals(new String(kbuf,0,klen),composeSortedKey(KEY,count,recordIndex));
  }
  finally {
    scanner.close();
    reader.close();
  }
}
