{
  DataOutputBuffer buf=new DataOutputBuffer();
  DataInputBuffer inbuf=new DataInputBuffer();
  WritableUtils.writeVLong(buf,val);
  try {
    inbuf.reset(buf.getData(),0,buf.getLength());
    long val2=WritableUtils.readVIntInRange(inbuf,lower,upper);
    if (!expectSuccess) {
      fail("expected readVIntInRange to throw an exception");
    }
    assertEquals(val,val2);
  }
 catch (  IOException e) {
    if (expectSuccess) {
      LOG.error("unexpected exception:",e);
      fail("readVIntInRange threw an unexpected exception");
    }
  }
}
