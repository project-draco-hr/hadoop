{
  if (fs == null && in == null) {
    throw new IllegalArgumentException("fs == null && in == null");
  }
  this.file=file;
  this.in=in != null ? in : openFile(fs,file,bufferSize,length);
  this.conf=conf;
  boolean succeeded=false;
  try {
    seek(start);
    this.end=this.in.getPos() + length;
    init(tempReader);
    succeeded=true;
  }
  finally {
    if (!succeeded) {
      IOUtils.cleanup(LOG,this.in);
    }
  }
}
