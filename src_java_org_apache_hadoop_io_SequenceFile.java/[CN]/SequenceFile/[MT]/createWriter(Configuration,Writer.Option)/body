{
  Writer.CompressionTypeOption compressionOption=Options.getOption(Writer.CompressionTypeOption.class,opts);
  CompressionType kind;
  if (compressionOption != null) {
    kind=compressionOption.getValue();
  }
 else {
    kind=getDefaultCompressionType(conf);
  }
switch (kind) {
default :
case NONE:
    return new Writer(conf,kind,opts);
case RECORD:
  return new RecordCompressWriter(conf,kind,opts);
case BLOCK:
return new BlockCompressWriter(conf,kind,opts);
}
}
