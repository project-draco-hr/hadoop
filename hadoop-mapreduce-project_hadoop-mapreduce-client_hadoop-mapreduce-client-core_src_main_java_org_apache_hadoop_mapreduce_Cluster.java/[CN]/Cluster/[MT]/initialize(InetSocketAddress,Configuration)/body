{
  for (  ClientProtocolProvider provider : ServiceLoader.load(ClientProtocolProvider.class)) {
    ClientProtocol clientProtocol=null;
    if (jobTrackAddr == null) {
      clientProtocol=provider.create(conf);
    }
 else {
      clientProtocol=provider.create(jobTrackAddr,conf);
    }
    if (clientProtocol != null) {
      clientProtocolProvider=provider;
      client=clientProtocol;
      break;
    }
  }
  if (null == clientProtocolProvider || null == client) {
    throw new IOException("Cannot initialize Cluster. Please check your configuration for " + MRConfig.FRAMEWORK_NAME + " and the correspond server addresses.");
  }
}
