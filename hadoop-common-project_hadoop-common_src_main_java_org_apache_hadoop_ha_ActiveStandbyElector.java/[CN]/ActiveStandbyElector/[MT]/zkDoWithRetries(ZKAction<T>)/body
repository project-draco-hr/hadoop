{
  int retry=0;
  while (true) {
    try {
      return action.run();
    }
 catch (    KeeperException ke) {
      if (shouldRetry(ke.code()) && ++retry < NUM_RETRIES) {
        continue;
      }
      throw ke;
    }
  }
}
