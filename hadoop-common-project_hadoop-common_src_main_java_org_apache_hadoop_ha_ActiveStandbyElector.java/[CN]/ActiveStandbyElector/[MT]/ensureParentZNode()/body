{
  Preconditions.checkState(!wantToBeInElection,"ensureParentZNode() may not be called while in the election");
  String pathParts[]=znodeWorkingDir.split("/");
  Preconditions.checkArgument(pathParts.length >= 1 && pathParts[0].isEmpty(),"Invalid path: %s",znodeWorkingDir);
  StringBuilder sb=new StringBuilder();
  for (int i=1; i < pathParts.length; i++) {
    sb.append("/").append(pathParts[i]);
    String prefixPath=sb.toString();
    LOG.debug("Ensuring existence of " + prefixPath);
    try {
      createWithRetries(prefixPath,new byte[]{},zkAcl,CreateMode.PERSISTENT);
    }
 catch (    KeeperException e) {
      if (isNodeExists(e.code())) {
        continue;
      }
 else {
        throw new IOException("Couldn't create " + prefixPath,e);
      }
    }
  }
  LOG.info("Successfully created " + znodeWorkingDir + " in ZK.");
}
