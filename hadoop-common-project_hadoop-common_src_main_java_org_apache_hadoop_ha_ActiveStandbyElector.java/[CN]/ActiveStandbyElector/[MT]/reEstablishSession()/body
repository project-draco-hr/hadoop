{
  int connectionRetryCount=0;
  boolean success=false;
  while (!success && connectionRetryCount < NUM_RETRIES) {
    LOG.debug("Establishing zookeeper connection");
    try {
      createConnection();
      success=true;
    }
 catch (    IOException e) {
      LOG.warn(e);
      try {
        Thread.sleep(5000);
      }
 catch (      InterruptedException e1) {
        LOG.warn(e1);
      }
    }
    ++connectionRetryCount;
  }
  return success;
}
