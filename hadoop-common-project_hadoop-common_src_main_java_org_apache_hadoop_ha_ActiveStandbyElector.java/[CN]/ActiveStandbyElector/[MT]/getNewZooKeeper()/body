{
  watcher=new WatcherWithClientRef();
  ZooKeeper zk=new ZooKeeper(zkHostPort,zkSessionTimeout,watcher);
  watcher.setZooKeeperRef(zk);
  watcher.waitForZKConnectionEvent(zkSessionTimeout);
  for (  ZKAuthInfo auth : zkAuthInfo) {
    zk.addAuthInfo(auth.getScheme(),auth.getAuth());
  }
  return zk;
}
