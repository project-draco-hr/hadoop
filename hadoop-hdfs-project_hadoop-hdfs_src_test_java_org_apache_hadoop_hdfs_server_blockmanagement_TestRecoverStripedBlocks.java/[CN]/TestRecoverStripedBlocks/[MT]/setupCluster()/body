{
  conf=new HdfsConfiguration();
  conf.setInt(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,BLOCK_SIZE);
  conf.setInt(DFSConfigKeys.DFS_HEARTBEAT_INTERVAL_KEY,100);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_REPLICATION_WORK_MULTIPLIER_PER_ITERATION,5);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_OF_DATANODES).build();
  cluster.waitActive();
  fs=cluster.getFileSystem();
  dfsAdmin=new HdfsAdmin(cluster.getURI(),conf);
  namesystem=cluster.getNamesystem();
  ECFilePath=new Path("/ecfile");
  DFSTestUtil.createFile(fs,ECFilePath,4 * BLOCK_SIZE,GROUP_SIZE,0);
  dfsAdmin.setStoragePolicy(ECFilePath,EC_STORAGE_POLICY_NAME);
}
