{
  MiniMRCluster mr=null;
  try {
    final JobConf conf=new JobConf();
    conf.setClass(PolicyProvider.POLICY_PROVIDER_CONFIG,MapReducePolicyProvider.class,PolicyProvider.class);
    conf.setBoolean(ServiceAuthorizationManager.SERVICE_AUTHORIZATION_CONFIG,true);
    mr=new MiniMRCluster(1,"file:///",1,null,null,conf);
    MRAdmin mrAdmin=new MRAdmin(mr.createJobConf());
    assertEquals(0,mrAdmin.run(new String[]{"-refreshQueues"}));
    assertEquals(0,mrAdmin.run(new String[]{"-refreshNodes"}));
  }
  finally {
    if (mr != null) {
      mr.shutdown();
    }
  }
}
