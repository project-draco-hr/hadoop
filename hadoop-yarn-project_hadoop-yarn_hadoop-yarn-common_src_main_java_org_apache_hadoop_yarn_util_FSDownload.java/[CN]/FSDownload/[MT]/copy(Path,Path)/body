{
  FileSystem sourceFs=sCopy.getFileSystem(conf);
  Path dCopy=new Path(dstdir,sCopy.getName() + ".tmp");
  FileStatus sStat=sourceFs.getFileStatus(sCopy);
  if (sStat.getModificationTime() != resource.getTimestamp()) {
    throw new IOException("Resource " + sCopy + " changed on src filesystem (expected "+ resource.getTimestamp()+ ", was "+ sStat.getModificationTime());
  }
  sourceFs.copyToLocalFile(sCopy,dCopy);
  return dCopy;
}
