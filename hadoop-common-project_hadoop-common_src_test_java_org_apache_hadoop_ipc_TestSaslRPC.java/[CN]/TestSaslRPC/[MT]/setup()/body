{
  LOG.info("---------------------------------");
  LOG.info("Testing QOP:" + getQOPNames(qop));
  LOG.info("---------------------------------");
  conf=new Configuration();
  conf.set(HADOOP_SECURITY_AUTHENTICATION,SIMPLE.toString());
  conf.set(HADOOP_RPC_PROTECTION,getQOPNames(qop));
  if (saslPropertiesResolver != null) {
    conf.set(CommonConfigurationKeys.HADOOP_SECURITY_SASL_PROPS_RESOLVER_CLASS,saslPropertiesResolver);
  }
  UserGroupInformation.setConfiguration(conf);
  enableSecretManager=null;
  forceSecretManager=null;
  clientFallBackToSimpleAllowed=true;
  RPC.setProtocolEngine(conf,TestRpcService.class,ProtobufRpcEngine.class);
}
