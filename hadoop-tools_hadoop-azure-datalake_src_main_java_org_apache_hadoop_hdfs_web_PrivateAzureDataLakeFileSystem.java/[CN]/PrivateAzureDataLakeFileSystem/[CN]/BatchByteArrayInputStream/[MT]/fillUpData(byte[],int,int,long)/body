{
  int totalBytesRead=0;
  final URL offsetUrl=new URL(runner + "&" + new OffsetParam(String.valueOf(globalOffset))+ "&"+ new LengthParam(String.valueOf(length)));
  HttpURLConnection conn=new URLRunner(GetOpParam.Op.OPEN,offsetUrl,true).run();
  InputStream in=conn.getInputStream();
  try {
    int bytesRead=0;
    while ((bytesRead=in.read(buffer,(int)offset + totalBytesRead,(int)(length - totalBytesRead))) > 0) {
      totalBytesRead+=bytesRead;
    }
    if (bytesRead == 0) {
      if (in.read() != -1) {
        throw new SocketException("Server returned more than requested data.");
      }
    }
  }
  finally {
    in.close();
    conn.disconnect();
  }
  return totalBytesRead;
}
