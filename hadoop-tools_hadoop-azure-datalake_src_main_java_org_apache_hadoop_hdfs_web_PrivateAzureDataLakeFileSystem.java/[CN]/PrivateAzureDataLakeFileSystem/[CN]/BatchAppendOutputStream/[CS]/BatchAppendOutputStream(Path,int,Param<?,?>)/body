{
  if (bufferSize < (ADLConfKeys.DEFAULT_BLOCK_SIZE)) {
    bufSize=ADLConfKeys.DEFAULT_BLOCK_SIZE;
  }
 else {
    bufSize=bufferSize;
  }
  this.fsPath=path;
  this.parameters=param;
  this.data=getBuffer();
  FSDataOutputStream createStream=null;
  try {
    if (featureRedirectOff) {
      CreateADLNoRedirectParam skipRedirect=new CreateADLNoRedirectParam(true);
      Param<?,?>[] tmpParam=featureFlushWhenEOF ? new Param<?,?>[param.length + 2] : new Param<?,?>[param.length + 1];
      System.arraycopy(param,0,tmpParam,0,param.length);
      tmpParam[param.length]=skipRedirect;
      if (featureFlushWhenEOF) {
        tmpParam[param.length + 1]=new ADLFlush(false);
      }
      createStream=new FsPathOutputStreamRunner(ADLPutOpParam.Op.CREATE,fsPath,1,tmpParam).run();
    }
 else {
      createStream=new FsPathOutputStreamRunner(PutOpParam.Op.CREATE,fsPath,1,param).run();
    }
  }
  finally {
    if (createStream != null) {
      createStream.close();
    }
  }
}
