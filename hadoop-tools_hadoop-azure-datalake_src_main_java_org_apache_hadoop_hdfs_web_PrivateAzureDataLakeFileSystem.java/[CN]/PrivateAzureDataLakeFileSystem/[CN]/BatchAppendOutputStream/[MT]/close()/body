{
  if (streamClosed) {
    return;
  }
  if (featureRedirectOff) {
    eof=true;
  }
  boolean flushedSomething=false;
  if (hadError) {
    streamClosed=true;
    return;
  }
 else {
    flushedSomething=offset > 0;
    try {
      flush();
    }
  finally {
      streamClosed=true;
    }
  }
  if (featureRedirectOff) {
    if (!flushedSomething) {
      try {
        commit(null,0,ADLConfKeys.KB,true);
      }
  finally {
        streamClosed=true;
      }
    }
  }
}
