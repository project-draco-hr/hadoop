{
  CompressionCodec codec=null;
  ZlibFactory.setCompressionLevel(conf,CompressionLevel.NO_COMPRESSION);
  try {
    codec=(CompressionCodec)ReflectionUtils.newInstance(conf.getClassByName(codecClass),conf);
  }
 catch (  ClassNotFoundException cnfe) {
    throw new IOException("Illegal codec!");
  }
  Compressor c=codec.createCompressor();
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  CompressionOutputStream cos=null;
  byte[] b=new byte[1 << 15];
  Arrays.fill(b,(byte)43);
  try {
    cos=codec.createOutputStream(bos,c);
    cos.write(b);
  }
  finally {
    if (cos != null) {
      cos.close();
    }
  }
  byte[] outbytes=bos.toByteArray();
  assertTrue("Compressed bytes contrary to configuration(NO_COMPRESSION)",outbytes.length >= b.length);
}
