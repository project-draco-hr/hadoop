{
  TaskTrackerStatus taskTrackerStatus=taskTracker.getStatus();
  printQSCs();
  JobInProgress job=taskTracker.getJobForFallowSlot(type);
  if (job != null) {
    int availableSlots=taskTracker.getAvailableSlots(type);
    if (LOG.isDebugEnabled()) {
      LOG.debug(job.getJobID() + ": Checking 'reserved' tasktracker " + taskTracker.getTrackerName()+ " with "+ availableSlots+ " '"+ type+ "' slots");
    }
    if (availableSlots >= job.getNumSlotsPerTask(type)) {
      taskTracker.unreserveSlots(type,job);
      Task t=obtainNewTask(taskTrackerStatus,job);
      if (t != null) {
        if (LOG.isDebugEnabled()) {
          LOG.info(job.getJobID() + ": Got " + t.getTaskID()+ " for reserved tasktracker "+ taskTracker.getTrackerName());
        }
        return TaskLookupResult.getTaskFoundResult(t);
      }
    }
 else {
      taskTracker.reserveSlots(type,job,availableSlots);
      if (LOG.isDebugEnabled()) {
        LOG.debug(job.getJobID() + ": Re-reserving " + taskTracker.getTrackerName());
      }
      return TaskLookupResult.getMemFailedResult();
    }
  }
  for (  AbstractQueue q : getOrderedJobQueues()) {
    QueueSchedulingContext qsc=q.getQueueSchedulingContext();
    if (0 == getTSC(qsc).getCapacity()) {
      continue;
    }
    if (this.areTasksInQueueOverMaxCapacity(qsc,1)) {
      continue;
    }
    TaskLookupResult tlr=getTaskFromQueue(taskTracker,qsc);
    TaskLookupResult.LookUpStatus lookUpStatus=tlr.getLookUpStatus();
    if (lookUpStatus == TaskLookupResult.LookUpStatus.NO_TASK_FOUND) {
      continue;
    }
    if (lookUpStatus == TaskLookupResult.LookUpStatus.TASK_FOUND) {
      return tlr;
    }
 else     if (lookUpStatus == TaskLookupResult.LookUpStatus.TASK_FAILING_MEMORY_REQUIREMENT) {
      return tlr;
    }
  }
  return TaskLookupResult.getNoTaskFoundResult();
}
