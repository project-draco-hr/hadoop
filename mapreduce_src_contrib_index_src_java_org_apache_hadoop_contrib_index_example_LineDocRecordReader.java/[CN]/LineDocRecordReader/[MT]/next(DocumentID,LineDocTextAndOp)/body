{
  if (pos >= end) {
    return false;
  }
  if (!readInto(key.getText(),SPACE)) {
    return false;
  }
  Text opText=new Text();
  if (!readInto(opText,SPACE)) {
    return false;
  }
  String opStr=opText.toString();
  DocumentAndOp.Op op;
  if (opStr.equals("i") || opStr.equals("ins") || opStr.equals("insert")) {
    op=DocumentAndOp.Op.INSERT;
  }
 else   if (opStr.equals("d") || opStr.equals("del") || opStr.equals("delete")) {
    op=DocumentAndOp.Op.DELETE;
  }
 else   if (opStr.equals("u") || opStr.equals("upd") || opStr.equals("update")) {
    op=DocumentAndOp.Op.UPDATE;
  }
 else {
    op=DocumentAndOp.Op.INSERT;
  }
  value.setOp(op);
  if (op == DocumentAndOp.Op.DELETE) {
    return true;
  }
 else {
    return readInto(value.getText(),EOL);
  }
}
