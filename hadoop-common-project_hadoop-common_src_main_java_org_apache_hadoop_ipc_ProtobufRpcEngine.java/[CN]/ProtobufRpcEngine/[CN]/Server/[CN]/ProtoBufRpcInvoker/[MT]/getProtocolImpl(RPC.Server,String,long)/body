{
  ProtoNameVer pv=new ProtoNameVer(protoName,clientVersion);
  ProtoClassProtoImpl impl=server.getProtocolImplMap(RPC.RpcKind.RPC_PROTOCOL_BUFFER).get(pv);
  if (impl == null) {
    VerProtocolImpl highest=server.getHighestSupportedProtocol(RPC.RpcKind.RPC_PROTOCOL_BUFFER,protoName);
    if (highest == null) {
      throw new RpcNoSuchProtocolException("Unknown protocol: " + protoName);
    }
    throw new RPC.VersionMismatch(protoName,clientVersion,highest.version);
  }
  return impl;
}
