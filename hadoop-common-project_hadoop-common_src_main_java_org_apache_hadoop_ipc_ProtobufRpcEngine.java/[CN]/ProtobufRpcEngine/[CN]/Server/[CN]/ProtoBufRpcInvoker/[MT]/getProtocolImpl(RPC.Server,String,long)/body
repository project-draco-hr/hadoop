{
  ProtoNameVer pv=new ProtoNameVer(protoName,version);
  ProtoClassProtoImpl impl=server.getProtocolImplMap(RpcKind.RPC_PROTOCOL_BUFFER).get(pv);
  if (impl == null) {
    VerProtocolImpl highest=server.getHighestSupportedProtocol(RpcKind.RPC_PROTOCOL_BUFFER,protoName);
    if (highest == null) {
      throw new IOException("Unknown protocol: " + protoName);
    }
    throw new RPC.VersionMismatch(protoName,version,highest.version);
  }
  return impl;
}
