{
  DFSOutputStream mockStream=Mockito.mock(DFSOutputStream.class);
  String filePath="/foo";
  Assert.assertFalse("Renewer not initially running",renewer.isRunning());
  Mockito.doReturn(false).when(MOCK_DFSCLIENT).isFilesBeingWrittenEmpty();
  renewer.put(filePath,mockStream,MOCK_DFSCLIENT);
  Assert.assertTrue("Renewer should have started running",renewer.isRunning());
  String threadName=renewer.getDaemonName();
  Assert.assertEquals("LeaseRenewer:myuser@hdfs://nn1/",threadName);
  Mockito.doReturn(true).when(MOCK_DFSCLIENT).isFilesBeingWrittenEmpty();
  renewer.closeFile(filePath,MOCK_DFSCLIENT);
  long failTime=System.currentTimeMillis() + 5000;
  while (renewer.isRunning() && System.currentTimeMillis() < failTime) {
    Thread.sleep(50);
  }
  Assert.assertFalse(renewer.isRunning());
}
