{
  TaskAttemptId attemptID=status.id;
  TaskId taskID=attemptID.getTaskId();
  JobId jobID=taskID.getJobId();
  Job job=context.getJob(jobID);
  if (job == null) {
    return;
  }
  Task task=job.getTask(taskID);
  if (task == null) {
    return;
  }
  Long boxedStart=startTimes.get(attemptID);
  long start=boxedStart == null ? Long.MIN_VALUE : boxedStart;
  TaskAttempt taskAttempt=task.getAttempt(attemptID);
  if (taskAttempt.getState() == TaskAttemptState.SUCCEEDED) {
    boolean isNew=false;
synchronized (doneTasks) {
      if (!doneTasks.contains(task)) {
        doneTasks.add(task);
        isNew=true;
      }
    }
    if (isNew) {
      long finish=timestamp;
      if (start > 1L && finish > 1L && start <= finish) {
        long duration=finish - start;
        DataStatistics statistics=dataStatisticsForTask(taskID);
        if (statistics != null) {
          statistics.add(duration);
        }
      }
    }
  }
}
