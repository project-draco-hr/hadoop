{
  this.conf=conf;
  if (mode == null) {
    throw new IllegalArgumentException("mode cannot be NULL");
  }
  this.mode=mode;
  requireClientCert=conf.getBoolean(SSL_REQUIRE_CLIENT_CERT_KEY,DEFAULT_SSL_REQUIRE_CLIENT_CERT);
  Configuration sslConf=readSSLConfiguration(mode);
  Class<? extends KeyStoresFactory> klass=conf.getClass(KEYSTORES_FACTORY_CLASS_KEY,FileBasedKeyStoresFactory.class,KeyStoresFactory.class);
  keystoresFactory=ReflectionUtils.newInstance(klass,sslConf);
  enabledProtocols=conf.getStrings(SSL_ENABLED_PROTOCOLS,DEFAULT_SSL_ENABLED_PROTOCOLS);
  String excludeCiphersConf=sslConf.get(SSL_SERVER_EXCLUDE_CIPHER_LIST,"");
  if (excludeCiphersConf.isEmpty()) {
    excludeCiphers=new LinkedList<String>();
  }
 else {
    LOG.debug("will exclude cipher suites: {}",excludeCiphersConf);
    excludeCiphers=Arrays.asList(excludeCiphersConf.split(","));
  }
}
