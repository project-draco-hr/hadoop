{
  long versionNumber=-1;
  long generation=-1;
  Shard[] shards=new Shard[numShards];
  for (int j=0; j < shards.length; j++) {
    shards[j]=new Shard(versionNumber,new Path(indexPath,NUMBER_FORMAT.format(j)).toString(),generation);
  }
  if (fs.exists(outputPath)) {
    fs.delete(outputPath,true);
  }
  IIndexUpdater updater=new IndexUpdater();
  updater.run(conf,new Path[]{inputPath},outputPath,numMapTasks,shards);
  if (fs.exists(outputPath)) {
    fs.delete(outputPath,true);
  }
  updater.run(conf,new Path[]{updatePath},outputPath,numMapTasks,shards);
  verify(shards);
}
