{
  this.reconstructor=reconstructor;
  this.datanode=datanode;
  this.conf=conf;
  ErasureCodingPolicy ecPolicy=reconstructionInfo.getErasureCodingPolicy();
  dataBlkNum=ecPolicy.getNumDataUnits();
  parityBlkNum=ecPolicy.getNumParityUnits();
  targets=reconstructionInfo.getTargetDnInfos();
  targetStorageTypes=reconstructionInfo.getTargetStorageTypes();
  writers=new StripedBlockWriter[targets.length];
  targetIndices=new short[targets.length];
  Preconditions.checkArgument(targetIndices.length <= parityBlkNum,"Too much missed striped blocks.");
  initTargetIndices();
  maxTargetLength=0L;
  for (  short targetIndex : targetIndices) {
    maxTargetLength=Math.max(maxTargetLength,reconstructor.getBlockLen(targetIndex));
  }
  targetsStatus=new boolean[targets.length];
}
