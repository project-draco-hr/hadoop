{
  LOG.info("Fixing block at " + srcFile + ":"+ errorOffset+ ", skipping "+ bytesToSkip+ ", limit "+ limit);
  FileStatus srcStat=fs.getFileStatus(srcFile);
  ArrayList<FSDataInputStream> xorinputs=new ArrayList<FSDataInputStream>();
  FSDataInputStream parityFileIn=parityFs.open(parityFile);
  parityFileIn.seek(parityOffset(errorOffset,blockSize));
  xorinputs.add(parityFileIn);
  long errorBlockOffset=(errorOffset / blockSize) * blockSize;
  long[] srcOffsets=stripeOffsets(errorOffset,blockSize);
  for (int i=0; i < srcOffsets.length; i++) {
    if (srcOffsets[i] == errorBlockOffset) {
      LOG.info("Skipping block at " + srcFile + ":"+ errorBlockOffset);
      continue;
    }
    if (srcOffsets[i] < srcStat.getLen()) {
      FSDataInputStream in=fs.open(srcFile);
      in.seek(srcOffsets[i]);
      xorinputs.add(in);
    }
  }
  FSDataInputStream[] inputs=xorinputs.toArray(new FSDataInputStream[]{null});
  ParityInputStream recovered=new ParityInputStream(inputs,limit,readBufs[0],writeBufs[0]);
  recovered.skip(bytesToSkip);
  recovered.drain(out,null);
}
