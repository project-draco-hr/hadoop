{
  StringBuilder dnNewDataDirs=new StringBuilder();
  for (  File newVol : newVols) {
    if (dnNewDataDirs.length() > 0) {
      dnNewDataDirs.append(',');
    }
    dnNewDataDirs.append(newVol.getAbsolutePath());
  }
  try {
    dn.reconfigurePropertyImpl(DFSConfigKeys.DFS_DATANODE_DATA_DIR_KEY,dnNewDataDirs.toString());
  }
 catch (  ReconfigurationException e) {
    LOG.warn("Could not reconfigure DataNode.",e);
  }
}
