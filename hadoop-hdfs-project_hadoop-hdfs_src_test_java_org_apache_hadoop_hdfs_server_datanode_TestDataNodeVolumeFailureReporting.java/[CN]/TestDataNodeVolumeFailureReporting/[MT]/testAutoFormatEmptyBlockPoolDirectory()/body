{
  DataNode dn=cluster.getDataNodes().get(0);
  String bpid=cluster.getNamesystem().getBlockPoolId();
  BlockPoolSliceStorage bps=dn.getStorage().getBPStorage(bpid);
  Storage.StorageDirectory dir=bps.getStorageDir(0);
  File current=dir.getCurrentDir();
  File currentVersion=new File(current,"VERSION");
  currentVersion.delete();
  assertTrue(cluster.restartDataNodes(true));
  cluster.waitActive();
  assertFalse("DataNode should not reformat if VERSION is missing",currentVersion.exists());
}
