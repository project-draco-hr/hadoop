{
  LOG.info("Starting testSuspension");
  mySetup();
  try {
    Path topDir=new Path(TEST_DIR + "/testenumeration");
    createTestTree(topDir);
    String top=topDir.toString();
    List<FileStatus> startPaths=new LinkedList<FileStatus>();
    startPaths.add(fs.getFileStatus(new Path(top + "/a")));
    startPaths.add(fs.getFileStatus(new Path(top + "/b")));
    DirectoryTraversal dt=new DirectoryTraversal(fs,startPaths);
    int limit=2;
    short targetRepl=1;
    Path raid=new Path("/raid");
    DirectoryTraversal.FileFilter filter=new RaidFilter.TimeBasedFilter(conf,RaidNode.xorDestinationPath(conf),1,Time.now(),0);
    List<FileStatus> selected=dt.getFilteredFiles(filter,limit);
    for (    FileStatus f : selected) {
      LOG.info(f.getPath());
    }
    assertEquals(limit,selected.size());
    selected=dt.getFilteredFiles(filter,limit);
    for (    FileStatus f : selected) {
      LOG.info(f.getPath());
    }
    assertEquals(limit,selected.size());
  }
  finally {
    myTearDown();
  }
}
