{
  try {
    jc=(jc == null) ? createJobConf() : createJobConf(jc);
    File f=new File("build/test/mapred/local").getAbsoluteFile();
    jc.set(MRConfig.LOCAL_DIR,f.getAbsolutePath());
    jc.setClass("topology.node.switch.mapping.impl",StaticMapping.class,DNSToSwitchMapping.class);
    final String id=new SimpleDateFormat("yyyyMMddHHmmssSSS").format(new Date());
    if (ugi == null) {
      ugi=UserGroupInformation.getLoginUser();
    }
    tracker=ugi.doAs(new PrivilegedExceptionAction<JobTracker>(){
      public JobTracker run() throws InterruptedException, IOException {
        return JobTracker.startTracker(jc,clock,id);
      }
    }
);
    tracker.offerService();
  }
 catch (  Throwable e) {
    LOG.error("Job tracker crashed",e);
    isActive=false;
  }
}
