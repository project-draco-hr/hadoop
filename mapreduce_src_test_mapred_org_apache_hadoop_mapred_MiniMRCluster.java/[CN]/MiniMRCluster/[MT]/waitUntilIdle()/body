{
  waitTaskTrackers();
  JobClient client;
  try {
    client=new JobClient(job);
    ClusterStatus status=client.getClusterStatus();
    while (status.getTaskTrackers() + numTrackerToExclude < taskTrackerList.size()) {
      for (      TaskTrackerRunner runner : taskTrackerList) {
        if (runner.isDead) {
          throw new RuntimeException("TaskTracker is dead");
        }
      }
      Thread.sleep(1000);
      status=client.getClusterStatus();
    }
  }
 catch (  IOException ex) {
    throw new RuntimeException(ex);
  }
catch (  InterruptedException ex) {
    throw new RuntimeException(ex);
  }
}
