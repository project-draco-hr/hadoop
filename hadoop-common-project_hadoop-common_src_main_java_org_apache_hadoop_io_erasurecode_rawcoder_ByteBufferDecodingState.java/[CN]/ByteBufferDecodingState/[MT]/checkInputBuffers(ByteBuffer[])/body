{
  int validInputs=0;
  for (  ByteBuffer buffer : buffers) {
    if (buffer == null) {
      continue;
    }
    if (buffer.remaining() != decodeLength) {
      throw new HadoopIllegalArgumentException("Invalid buffer, not of length " + decodeLength);
    }
    if (buffer.isDirect() != usingDirectBuffer) {
      throw new HadoopIllegalArgumentException("Invalid buffer, isDirect should be " + usingDirectBuffer);
    }
    validInputs++;
  }
  if (validInputs < decoder.getNumDataUnits()) {
    throw new HadoopIllegalArgumentException("No enough valid inputs are provided, not recoverable");
  }
}
