{
  response.setContentType("text/plain");
  DataNode datanode=(DataNode)getServletContext().getAttribute("datanode");
  DataBlockScanner blockScanner=datanode.blockScanner;
  boolean summary=(request.getParameter("listblocks") == null);
  StringBuilder buffer=new StringBuilder(8 * 1024);
  if (blockScanner == null) {
    LOG.warn("Periodic block scanner is not running");
    buffer.append("Periodic block scanner is not running. " + "Please check the datanode log if this is unexpected.");
  }
 else {
    blockScanner.printBlockReport(buffer,summary);
  }
  response.getWriter().write(buffer.toString());
}
