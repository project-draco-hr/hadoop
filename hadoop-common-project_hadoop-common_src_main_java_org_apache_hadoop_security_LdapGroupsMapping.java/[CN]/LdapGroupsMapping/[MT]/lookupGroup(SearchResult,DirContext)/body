{
  List<String> groups=new ArrayList<String>();
  NamingEnumeration<SearchResult> groupResults=null;
  if (isPosix) {
    groupResults=lookupPosixGroup(result,c);
  }
 else {
    String userDn=result.getNameInNamespace();
    groupResults=c.search(baseDN,"(&" + groupSearchFilter + "("+ groupMemberAttr+ "={0}))",new Object[]{userDn},SEARCH_CONTROLS);
  }
  if (groupResults != null) {
    while (groupResults.hasMoreElements()) {
      SearchResult groupResult=groupResults.nextElement();
      Attribute groupName=groupResult.getAttributes().get(groupNameAttr);
      if (groupName == null) {
        throw new NamingException("The group object does not have " + "attribute '" + groupNameAttr + "'.");
      }
      groups.add(groupName.get().toString());
    }
  }
  return groups;
}
