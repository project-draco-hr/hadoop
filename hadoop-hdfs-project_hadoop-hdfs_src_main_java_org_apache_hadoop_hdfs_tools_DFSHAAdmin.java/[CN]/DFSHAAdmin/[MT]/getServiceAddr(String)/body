{
  HdfsConfiguration conf=(HdfsConfiguration)getConf();
  String serviceAddr=DFSUtil.getNamenodeServiceAddr(conf,nameserviceId,nnId);
  if (serviceAddr == null) {
    throw new IllegalArgumentException("Unable to determine service address for namenode '" + nnId + "'");
  }
  return serviceAddr;
}
