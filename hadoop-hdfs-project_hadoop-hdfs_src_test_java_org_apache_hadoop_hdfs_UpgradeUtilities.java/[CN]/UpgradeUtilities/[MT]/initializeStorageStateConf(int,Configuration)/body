{
  StringBuffer nameNodeDirs=new StringBuffer(new File(TEST_ROOT_DIR,"name1").toString());
  StringBuffer dataNodeDirs=new StringBuffer(new File(TEST_ROOT_DIR,"data1").toString());
  for (int i=2; i <= numDirs; i++) {
    nameNodeDirs.append("," + new File(TEST_ROOT_DIR,"name" + i));
    dataNodeDirs.append("," + new File(TEST_ROOT_DIR,"data" + i));
  }
  if (conf == null) {
    conf=new HdfsConfiguration();
  }
  conf.set(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_KEY,nameNodeDirs.toString());
  conf.set(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_KEY,nameNodeDirs.toString());
  conf.set(DFSConfigKeys.DFS_DATANODE_DATA_DIR_KEY,dataNodeDirs.toString());
  conf.setInt(DFSConfigKeys.DFS_BLOCKREPORT_INTERVAL_MSEC_KEY,10000);
  return conf;
}
