{
  File[] retVal=new File[parents.length];
  for (int i=0; i < parents.length; i++) {
    File newDir=new File(parents[i],dirName);
    createEmptyDirs(new String[]{newDir.toString()});
    LocalFileSystem localFS=FileSystem.getLocal(new HdfsConfiguration());
    localFS.copyToLocalFile(new Path(datanodeStorage.toString(),"current"),new Path(newDir.toString()),false);
    StorageDirectory sd=new StorageDirectory(new File(datanodeStorage.toString()));
    sd.setStorageUuid(DatanodeStorage.generateUuid());
    Properties properties=Storage.readPropertiesFile(sd.getVersionFile());
    properties.setProperty("storageID",sd.getStorageUuid());
    Storage.writeProperties(sd.getVersionFile(),properties);
    retVal[i]=newDir;
  }
  return retVal;
}
