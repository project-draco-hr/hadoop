{
  final Path p=new Path("/TC2/foo2");
  final int len1=(int)(BLOCK_SIZE + BLOCK_SIZE / 2);
{
    FSDataOutputStream out=fs.create(p,false,buffersize,REPLICATION,BLOCK_SIZE);
    AppendTestUtil.write(out,0,len1);
    out.close();
  }
  AppendTestUtil.check(fs,p,len1);
  final int len2=(int)BLOCK_SIZE / 4;
{
    FSDataOutputStream out=fs.append(p,EnumSet.of(CreateFlag.APPEND,CreateFlag.NEW_BLOCK),4096,null);
    AppendTestUtil.write(out,len1,len2);
    out.close();
  }
  AppendTestUtil.check(fs,p,len1 + len2);
  List<LocatedBlock> blocks=fs.getClient().getLocatedBlocks(p.toString(),0L).getLocatedBlocks();
  Assert.assertEquals(3,blocks.size());
  Assert.assertEquals(BLOCK_SIZE,blocks.get(0).getBlockSize());
  Assert.assertEquals(BLOCK_SIZE / 2,blocks.get(1).getBlockSize());
  Assert.assertEquals(BLOCK_SIZE / 4,blocks.get(2).getBlockSize());
}
