{
  CacheDirectiveInfo.Builder builder=new CacheDirectiveInfo.Builder();
  String path=StringUtils.popOptionWithArgument("-path",args);
  if (path == null) {
    System.err.println("You must specify a path with -path.");
    return 1;
  }
  builder.setPath(new Path(path));
  String poolName=StringUtils.popOptionWithArgument("-pool",args);
  if (poolName == null) {
    System.err.println("You must specify a pool name with -pool.");
    return 1;
  }
  builder.setPool(poolName);
  boolean force=StringUtils.popOption("-force",args);
  String replicationString=StringUtils.popOptionWithArgument("-replication",args);
  if (replicationString != null) {
    Short replication=Short.parseShort(replicationString);
    builder.setReplication(replication);
  }
  String ttlString=StringUtils.popOptionWithArgument("-ttl",args);
  try {
    Expiration ex=parseExpirationString(ttlString);
    if (ex != null) {
      builder.setExpiration(ex);
    }
  }
 catch (  IOException e) {
    System.err.println("Error while parsing ttl value: " + e.getMessage());
    return 1;
  }
  if (!args.isEmpty()) {
    System.err.println("Can't understand argument: " + args.get(0));
    return 1;
  }
  DistributedFileSystem dfs=AdminHelper.getDFS(conf);
  CacheDirectiveInfo directive=builder.build();
  EnumSet<CacheFlag> flags=EnumSet.noneOf(CacheFlag.class);
  if (force) {
    flags.add(CacheFlag.FORCE);
  }
  try {
    long id=dfs.addCacheDirective(directive,flags);
    System.out.println("Added cache directive " + id);
  }
 catch (  IOException e) {
    System.err.println(AdminHelper.prettifyException(e));
    return 2;
  }
  return 0;
}
