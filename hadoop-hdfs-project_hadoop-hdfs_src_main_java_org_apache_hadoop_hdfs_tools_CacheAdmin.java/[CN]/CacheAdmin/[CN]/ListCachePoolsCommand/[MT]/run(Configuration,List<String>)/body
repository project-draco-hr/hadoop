{
  String name=StringUtils.popFirstNonOption(args);
  if (!args.isEmpty()) {
    System.err.print("Can't understand arguments: " + Joiner.on(" ").join(args) + "\n");
    System.err.println("Usage is " + getShortUsage());
    return 1;
  }
  DistributedFileSystem dfs=getDFS(conf);
  TableListing listing=new TableListing.Builder().addField("NAME",Justification.LEFT).addField("OWNER",Justification.LEFT).addField("GROUP",Justification.LEFT).addField("MODE",Justification.LEFT).addField("WEIGHT",Justification.RIGHT).build();
  int numResults=0;
  try {
    RemoteIterator<CachePoolEntry> iter=dfs.listCachePools();
    while (iter.hasNext()) {
      CachePoolEntry entry=iter.next();
      CachePoolInfo info=entry.getInfo();
      String[] row=new String[5];
      if (name == null || info.getPoolName().equals(name)) {
        row[0]=info.getPoolName();
        row[1]=info.getOwnerName();
        row[2]=info.getGroupName();
        row[3]=info.getMode() != null ? info.getMode().toString() : null;
        row[4]=info.getWeight() != null ? info.getWeight().toString() : null;
        listing.addRow(row);
        ++numResults;
        if (name != null) {
          break;
        }
      }
    }
  }
 catch (  IOException e) {
    throw new RemoteException(e.getClass().getName(),e.getMessage());
  }
  System.out.print(String.format("Found %d result%s.\n",numResults,(numResults == 1 ? "" : "s")));
  if (numResults > 0) {
    System.out.print(listing);
  }
  return (numResults == 0) ? 1 : 0;
}
