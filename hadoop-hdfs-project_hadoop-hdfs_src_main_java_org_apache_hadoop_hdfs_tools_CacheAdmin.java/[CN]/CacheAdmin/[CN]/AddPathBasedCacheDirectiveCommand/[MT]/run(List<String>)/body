{
  String path=StringUtils.popOptionWithArgument("-path",args);
  if (path == null) {
    System.err.println("You must specify a path with -path.");
    return 1;
  }
  String poolName=StringUtils.popOptionWithArgument("-pool",args);
  if (poolName == null) {
    System.err.println("You must specify a pool name with -pool.");
    return 1;
  }
  if (!args.isEmpty()) {
    System.err.println("Can't understand argument: " + args.get(0));
    return 1;
  }
  DistributedFileSystem dfs=getDFS();
  PathBasedCacheDirective directive=new PathBasedCacheDirective(path,poolName);
  PathBasedCacheDescriptor descriptor=dfs.addPathBasedCacheDirective(directive);
  System.out.println("Added PathBasedCache entry " + descriptor.getEntryId());
  return 0;
}
