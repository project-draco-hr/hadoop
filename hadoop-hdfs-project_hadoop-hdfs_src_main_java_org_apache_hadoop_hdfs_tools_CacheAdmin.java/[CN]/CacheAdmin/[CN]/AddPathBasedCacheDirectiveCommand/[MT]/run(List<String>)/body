{
  String path=StringUtils.popOptionWithArgument("-path",args);
  if (path == null) {
    System.err.println("You must specify a path with -path.");
    return 1;
  }
  String poolName=StringUtils.popOptionWithArgument("-pool",args);
  if (poolName == null) {
    System.err.println("You must specify a pool name with -pool.");
    return 1;
  }
  if (!args.isEmpty()) {
    System.err.println("Can't understand argument: " + args.get(0));
    return 1;
  }
  DistributedFileSystem dfs=getDFS();
  List<PathBasedCacheDirective> directives=new LinkedList<PathBasedCacheDirective>();
  PathBasedCacheDirective directive=new PathBasedCacheDirective(path,poolName);
  directives.add(directive);
  List<Fallible<PathBasedCacheEntry>> results=dfs.addPathBasedCacheDirective(directives);
  try {
    PathBasedCacheEntry entry=results.get(0).get();
    System.out.println("Added PathBasedCache entry " + entry.getEntryId());
    return 0;
  }
 catch (  IOException e) {
    System.err.println("Error adding cache directive " + directive + ": "+ e.getMessage());
    return 1;
  }
}
