{
  String path=StringUtils.popOptionWithArgument("-path",args);
  if (path == null) {
    System.err.println("You must specify a path with -path.");
    return 1;
  }
  if (!args.isEmpty()) {
    System.err.println("Can't understand argument: " + args.get(0));
    System.err.println("Usage is " + getShortUsage());
    return 1;
  }
  DistributedFileSystem dfs=getDFS(conf);
  RemoteIterator<PathBasedCacheDirective> iter=dfs.listPathBasedCacheDirectives(new PathBasedCacheDirective.Builder().setPath(new Path(path)).build());
  int exitCode=0;
  while (iter.hasNext()) {
    PathBasedCacheDirective directive=iter.next();
    try {
      dfs.removePathBasedCacheDirective(directive.getId());
      System.out.println("Removed PathBasedCache directive " + directive.getId());
    }
 catch (    IOException e) {
      System.err.println(prettifyException(e));
      exitCode=2;
    }
  }
  if (exitCode == 0) {
    System.out.println("Removed every PathBasedCache directive with path " + path);
  }
  return exitCode;
}
