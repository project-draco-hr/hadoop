{
  long now=System.nanoTime();
  AccessCacheEntry newEntry=new AccessCacheEntry(address,AccessPrivilege.NONE,now + this.cacheExpirationPeriod);
  AccessCacheEntry cachedEntry=accessCache.get(newEntry);
  if (cachedEntry != null && now < cachedEntry.expirationTime) {
    return cachedEntry.access;
  }
 else {
    for (    Match match : mMatches) {
      if (match.isIncluded(address,hostname)) {
        if (match.accessPrivilege == AccessPrivilege.READ_ONLY) {
          newEntry.access=AccessPrivilege.READ_ONLY;
          break;
        }
 else         if (match.accessPrivilege == AccessPrivilege.READ_WRITE) {
          newEntry.access=AccessPrivilege.READ_WRITE;
        }
      }
    }
    accessCache.put(newEntry);
    return newEntry.access;
  }
}
