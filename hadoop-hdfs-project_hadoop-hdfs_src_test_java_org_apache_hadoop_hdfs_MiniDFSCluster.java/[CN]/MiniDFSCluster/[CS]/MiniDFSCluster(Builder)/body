{
  if (builder.nnTopology == null) {
    builder.nnTopology=MiniDFSNNTopology.simpleSingleNN(builder.nameNodePort,builder.nameNodeHttpPort);
  }
  LOG.info("starting cluster with " + builder.nnTopology.countNameNodes() + " namenodes.");
  nameNodes=new NameNodeInfo[builder.nnTopology.countNameNodes()];
  initMiniDFSCluster(builder.conf,builder.numDataNodes,builder.format,builder.manageNameDfsDirs,builder.manageNameDfsSharedDirs,builder.manageDataDfsDirs,builder.option,builder.racks,builder.hosts,builder.simulatedCapacities,builder.clusterId,builder.waitSafeMode,builder.setupHostsFile,builder.nnTopology);
}
