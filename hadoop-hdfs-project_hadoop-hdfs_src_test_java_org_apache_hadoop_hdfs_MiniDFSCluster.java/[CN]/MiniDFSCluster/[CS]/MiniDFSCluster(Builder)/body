{
  if (builder.nnTopology == null) {
    builder.nnTopology=MiniDFSNNTopology.simpleSingleNN(builder.nameNodePort,builder.nameNodeHttpPort);
  }
  final int numNameNodes=builder.nnTopology.countNameNodes();
  LOG.info("starting cluster: numNameNodes=" + numNameNodes + ", numDataNodes="+ builder.numDataNodes);
  nameNodes=new NameNodeInfo[numNameNodes];
  initMiniDFSCluster(builder.conf,builder.numDataNodes,builder.storageType,builder.format,builder.manageNameDfsDirs,builder.manageNameDfsSharedDirs,builder.enableManagedDfsDirsRedundancy,builder.manageDataDfsDirs,builder.option,builder.dnOption,builder.racks,builder.hosts,builder.simulatedCapacities,builder.clusterId,builder.waitSafeMode,builder.setupHostsFile,builder.nnTopology,builder.checkExitOnShutdown,builder.checkDataNodeAddrConfig,builder.checkDataNodeHostConfig);
}
