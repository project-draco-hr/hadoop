{
  StringBuilder sb=new StringBuilder();
  for (int j=0; j < storagesPerDatanode; ++j) {
    if ((storageTypes != null) && (j >= storageTypes.length)) {
      break;
    }
    File dir=getInstanceStorageDir(dnIndex,j);
    dir.mkdirs();
    if (!dir.isDirectory()) {
      throw new IOException("Mkdirs failed to create directory for DataNode " + dir);
    }
    sb.append((j > 0 ? "," : "") + "[" + (storageTypes == null ? StorageType.DEFAULT : storageTypes[j])+ "]"+ fileAsURI(dir));
  }
  return sb.toString();
}
