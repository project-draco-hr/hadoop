{
  int blocksCorrupted=0;
  for (  DataNode dn : getDataNodes()) {
    try {
      MaterializedReplica replica=getFsDatasetTestUtils(dn).getMaterializedReplica(block);
      if (deleteBlockFile) {
        replica.deleteData();
      }
 else {
        replica.corruptData();
      }
      blocksCorrupted++;
    }
 catch (    ReplicaNotFoundException e) {
    }
  }
  return blocksCorrupted;
}
