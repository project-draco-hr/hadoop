{
  String nameserviceId=nameNodes[nnIndex].nameserviceId;
  String nnId=nameNodes[nnIndex].nnId;
  StartupOption startOpt=nameNodes[nnIndex].startOpt;
  Configuration conf=nameNodes[nnIndex].conf;
  shutdownNameNode(nnIndex);
  NameNode nn=NameNode.createNameNode(createArgs(startOpt),conf);
  nameNodes[nnIndex]=new NameNodeInfo(nn,nameserviceId,nnId,startOpt,conf);
  if (waitActive) {
    waitClusterUp();
    LOG.info("Restarted the namenode");
    waitActive();
  }
}
