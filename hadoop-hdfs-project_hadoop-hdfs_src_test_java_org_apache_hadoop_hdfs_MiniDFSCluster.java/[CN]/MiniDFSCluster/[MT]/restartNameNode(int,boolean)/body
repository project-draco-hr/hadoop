{
  String nameserviceId=nameNodes[nnIndex].nameserviceId;
  String nnId=nameNodes[nnIndex].nnId;
  Configuration conf=nameNodes[nnIndex].conf;
  shutdownNameNode(nnIndex);
  NameNode nn=NameNode.createNameNode(new String[]{},conf);
  nameNodes[nnIndex]=new NameNodeInfo(nn,nameserviceId,nnId,conf);
  if (waitActive) {
    waitClusterUp();
    LOG.info("Restarted the namenode");
    waitActive();
    LOG.info("Cluster is active");
  }
}
