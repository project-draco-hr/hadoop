{
  if (i < 0 || i >= dataNodes.size()) {
    return null;
  }
  DataNodeProperties dnprop=dataNodes.remove(i);
  DataNode dn=dnprop.datanode;
  LOG.info("MiniDFSCluster Stopping DataNode " + dn.getMachineName() + " from a total of "+ (dataNodes.size() + 1)+ " datanodes.");
  dn.shutdown();
  numDataNodes--;
  return dnprop;
}
