{
  Configuration conf=dnprop.conf;
  String[] args=dnprop.dnArgs;
  SecureResources secureResources=dnprop.secureResources;
  Configuration newconf=new HdfsConfiguration(conf);
  if (keepPort) {
    InetSocketAddress addr=dnprop.datanode.getXferAddress();
    conf.set(DFS_DATANODE_ADDRESS_KEY,addr.getAddress().getHostAddress() + ":" + addr.getPort());
  }
  dataNodes.add(new DataNodeProperties(DataNode.createDataNode(args,conf,secureResources),newconf,args,secureResources));
  numDataNodes++;
  return true;
}
