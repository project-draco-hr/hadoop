{
  Configuration conf=dnprop.conf;
  String[] args=dnprop.dnArgs;
  SecureResources secureResources=dnprop.secureResources;
  Configuration newconf=new HdfsConfiguration(conf);
  if (keepPort) {
    InetSocketAddress addr=dnprop.datanode.getXferAddress();
    conf.set(DFS_DATANODE_ADDRESS_KEY,addr.getAddress().getHostAddress() + ":" + addr.getPort());
    conf.set(DFS_DATANODE_IPC_ADDRESS_KEY,addr.getAddress().getHostAddress() + ":" + dnprop.ipcPort);
  }
  DataNode newDn=DataNode.createDataNode(args,conf,secureResources);
  dataNodes.add(new DataNodeProperties(newDn,newconf,args,secureResources,newDn.getIpcPort()));
  numDataNodes++;
  return true;
}
