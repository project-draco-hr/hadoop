{
  if (namenodes.size() == 0 || getNN(nnIndex) == null || getNN(nnIndex).nameNode == null) {
    return;
  }
  final FSNamesystem ns=getNamesystem(nnIndex);
  final DatanodeManager dm=ns.getBlockManager().getDatanodeManager();
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      List<DatanodeDescriptor> nodes=dm.getDatanodeListForReport(DatanodeReportType.LIVE);
      for (      DatanodeDescriptor node : nodes) {
        if (!node.checkBlockReportReceived()) {
          return false;
        }
      }
      return true;
    }
  }
,100,timeout);
}
