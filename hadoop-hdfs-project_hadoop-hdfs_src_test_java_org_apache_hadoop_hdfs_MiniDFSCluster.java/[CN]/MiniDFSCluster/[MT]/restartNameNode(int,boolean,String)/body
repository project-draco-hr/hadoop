{
  String nameserviceId=nameNodes[nnIndex].nameserviceId;
  String nnId=nameNodes[nnIndex].nnId;
  StartupOption startOpt=nameNodes[nnIndex].startOpt;
  Configuration conf=nameNodes[nnIndex].conf;
  shutdownNameNode(nnIndex);
  if (args.length != 0) {
    startOpt=null;
  }
 else {
    args=createArgs(startOpt);
  }
  NameNode nn=NameNode.createNameNode(args,conf);
  nameNodes[nnIndex]=new NameNodeInfo(nn,nameserviceId,nnId,startOpt,conf);
  if (waitActive) {
    waitClusterUp();
    LOG.info("Restarted the namenode");
    waitActive();
  }
}
