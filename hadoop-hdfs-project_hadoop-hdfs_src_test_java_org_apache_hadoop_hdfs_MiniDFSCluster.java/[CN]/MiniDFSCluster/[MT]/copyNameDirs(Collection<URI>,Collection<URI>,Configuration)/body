{
  URI srcDir=Lists.newArrayList(srcDirs).get(0);
  FileSystem dstFS=FileSystem.getLocal(dstConf).getRaw();
  for (  URI dstDir : dstDirs) {
    Preconditions.checkArgument(!dstDir.equals(srcDir),"src and dst are the same: " + dstDir);
    File dstDirF=new File(dstDir);
    if (dstDirF.exists()) {
      if (!FileUtil.fullyDelete(dstDirF)) {
        throw new IOException("Unable to delete: " + dstDirF);
      }
    }
    LOG.info("Copying namedir from primary node dir " + srcDir + " to "+ dstDir);
    FileUtil.copy(new File(srcDir),dstFS,new Path(dstDir),false,dstConf);
  }
}
