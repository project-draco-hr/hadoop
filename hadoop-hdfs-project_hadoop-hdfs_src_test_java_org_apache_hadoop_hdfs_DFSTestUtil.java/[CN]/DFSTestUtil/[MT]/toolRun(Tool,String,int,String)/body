{
  String[] cmds=StringUtils.split(cmd,' ');
  System.out.flush();
  System.err.flush();
  PrintStream origOut=System.out;
  PrintStream origErr=System.err;
  String output=null;
  int ret=0;
  try {
    ByteArrayOutputStream bs=new ByteArrayOutputStream(1024);
    PrintStream out=new PrintStream(bs);
    System.setOut(out);
    System.setErr(out);
    ret=tool.run(cmds);
    System.out.flush();
    System.err.flush();
    out.close();
    output=bs.toString();
  }
  finally {
    System.setOut(origOut);
    System.setErr(origErr);
  }
  System.out.println("Output for command: " + cmd + " retcode: "+ ret);
  if (output != null) {
    System.out.println(output);
  }
  assertEquals(retcode,ret);
  if (contain != null) {
    assertTrue("The real output is: " + output + ".\n It should contain: "+ contain,output.contains(contain));
  }
}
