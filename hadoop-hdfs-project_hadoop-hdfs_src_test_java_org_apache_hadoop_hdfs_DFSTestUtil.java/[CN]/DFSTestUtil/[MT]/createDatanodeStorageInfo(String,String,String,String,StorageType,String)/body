{
  final DatanodeStorage storage=new DatanodeStorage(storageID,DatanodeStorage.State.NORMAL,type);
  final DatanodeDescriptor dn=BlockManagerTestUtil.getDatanodeDescriptor(ip,rack,storage,hostname);
  if (upgradeDomain != null) {
    dn.setUpgradeDomain(upgradeDomain);
  }
  return BlockManagerTestUtil.newDatanodeStorageInfo(dn,storage);
}
