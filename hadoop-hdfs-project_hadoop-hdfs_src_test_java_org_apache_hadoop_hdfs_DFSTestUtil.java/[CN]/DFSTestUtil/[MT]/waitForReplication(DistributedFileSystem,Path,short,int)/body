{
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      try {
        FileStatus stat=dfs.getFileStatus(file);
        return replication == stat.getReplication();
      }
 catch (      IOException e) {
        LOG.info("getFileStatus on path " + file + " failed!",e);
        return false;
      }
    }
  }
,100,waitForMillis);
}
