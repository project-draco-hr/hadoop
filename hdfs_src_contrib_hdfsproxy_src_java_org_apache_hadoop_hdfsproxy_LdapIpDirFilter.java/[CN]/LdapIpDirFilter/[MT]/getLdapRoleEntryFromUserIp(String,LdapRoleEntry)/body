{
  String ipMember=hdfsIpSchemaStrPrefix + userIp;
  Attributes matchAttrs=new BasicAttributes(true);
  matchAttrs.put(new BasicAttribute(hdfsIpSchemaStr,ipMember));
  matchAttrs.put(new BasicAttribute(hdfsUidSchemaStr));
  matchAttrs.put(new BasicAttribute(hdfsPathSchemaStr));
  String[] attrIDs={hdfsUidSchemaStr,hdfsPathSchemaStr};
  NamingEnumeration<SearchResult> results=lctx.search(baseName,matchAttrs,attrIDs);
  if (results.hasMore()) {
    String userId=null;
    ArrayList<Path> paths=new ArrayList<Path>();
    SearchResult sr=results.next();
    Attributes attrs=sr.getAttributes();
    for (NamingEnumeration ne=attrs.getAll(); ne.hasMore(); ) {
      Attribute attr=(Attribute)ne.next();
      if (hdfsUidSchemaStr.equalsIgnoreCase(attr.getID())) {
        userId=(String)attr.get();
      }
 else       if (hdfsPathSchemaStr.equalsIgnoreCase(attr.getID())) {
        for (NamingEnumeration e=attr.getAll(); e.hasMore(); ) {
          String pathStr=(String)e.next();
          paths.add(new Path(pathStr));
        }
      }
    }
    ldapent.init(userId,paths);
    if (LOG.isDebugEnabled())     LOG.debug(ldapent);
    return true;
  }
  LOG.info("Ip address " + userIp + " is not authorized to access the proxy server");
  return false;
}
