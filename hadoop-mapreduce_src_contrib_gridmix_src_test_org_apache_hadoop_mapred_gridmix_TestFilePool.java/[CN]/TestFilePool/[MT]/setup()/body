{
  final Configuration conf=new Configuration();
  final FileSystem fs=FileSystem.getLocal(conf).getRaw();
  fs.delete(base,true);
  final Random r=new Random();
  final long seed=r.nextLong();
  r.setSeed(seed);
  LOG.info("seed: " + seed);
  fs.mkdirs(base);
  for (int i=0; i < NFILES; ++i) {
    Path file=base;
    for (double d=0.6; d > 0.0; d*=0.8) {
      if (r.nextDouble() < d) {
        file=new Path(base,Integer.toString(r.nextInt(3)));
        continue;
      }
      break;
    }
    OutputStream out=null;
    try {
      out=fs.create(new Path(file,"" + (char)('A' + i)));
      final byte[] b=new byte[1024];
      Arrays.fill(b,(byte)('A' + i));
      for (int len=((i % 13) + 1) * 1024; len > 0; len-=1024) {
        out.write(b);
      }
    }
  finally {
      if (out != null) {
        out.close();
      }
    }
  }
}
