{
  this.bpos=bpos;
  this.dn=bpos.getDataNode();
  this.nnAddr=nnAddr;
  this.dnConf=dn.getDnConf();
  this.ibrManager=new IncrementalBlockReportManager(dnConf.ibrInterval);
  prevBlockReportId=ThreadLocalRandom.current().nextLong();
  scheduler=new Scheduler(dnConf.heartBeatInterval,dnConf.blockReportInterval);
}
