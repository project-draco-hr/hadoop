{
  LOG.info(this + " starting to offer service");
  try {
    try {
      connectToNNAndHandshake();
    }
 catch (    IOException ioe) {
      LOG.fatal("Initialization failed for block pool " + this,ioe);
      return;
    }
    initialized=true;
    while (shouldRun()) {
      try {
        offerService();
      }
 catch (      Exception ex) {
        LOG.error("Exception in BPOfferService for " + this,ex);
        sleepAndLogInterrupts(5000,"offering service");
      }
    }
  }
 catch (  Throwable ex) {
    LOG.warn("Unexpected exception in block pool " + this,ex);
  }
 finally {
    LOG.warn("Ending block pool service for: " + this);
    cleanUp();
  }
}
