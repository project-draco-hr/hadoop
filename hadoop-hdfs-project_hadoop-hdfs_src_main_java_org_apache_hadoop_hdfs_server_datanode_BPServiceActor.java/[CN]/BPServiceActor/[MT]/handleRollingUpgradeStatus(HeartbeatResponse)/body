{
  RollingUpgradeStatus rollingUpgradeStatus=resp.getRollingUpdateStatus();
  if (rollingUpgradeStatus != null && rollingUpgradeStatus.getBlockPoolId().compareTo(bpos.getBlockPoolId()) != 0) {
    LOG.error("Invalid BlockPoolId " + rollingUpgradeStatus.getBlockPoolId() + " in HeartbeatResponse. Expected "+ bpos.getBlockPoolId());
  }
 else {
    bpos.signalRollingUpgrade(rollingUpgradeStatus);
  }
}
