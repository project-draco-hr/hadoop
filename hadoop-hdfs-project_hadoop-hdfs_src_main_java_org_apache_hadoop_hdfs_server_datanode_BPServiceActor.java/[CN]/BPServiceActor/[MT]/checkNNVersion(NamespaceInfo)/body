{
  String nnVersion=nsInfo.getSoftwareVersion();
  String minimumNameNodeVersion=dnConf.getMinimumNameNodeVersion();
  if (VersionUtil.compareVersions(nnVersion,minimumNameNodeVersion) < 0) {
    IncorrectVersionException ive=new IncorrectVersionException(minimumNameNodeVersion,nnVersion,"NameNode","DataNode");
    LOG.warn(ive.getMessage());
    throw ive;
  }
  String dnVersion=VersionInfo.getVersion();
  if (!nnVersion.equals(dnVersion)) {
    LOG.info("Reported NameNode version '" + nnVersion + "' does not match "+ "DataNode version '"+ dnVersion+ "' but is within acceptable "+ "limits. Note: This is normal during a rolling upgrade.");
  }
}
