{
  bpRegistration=bpos.createRegistration();
  LOG.info(this + " beginning handshake with NN");
  while (shouldRun()) {
    try {
      bpRegistration=bpNamenode.registerDatanode(bpRegistration);
      break;
    }
 catch (    EOFException e) {
      LOG.info("Problem connecting to server: " + nnAddr + " :"+ e.getLocalizedMessage());
      sleepAndLogInterrupts(1000,"connecting to server");
    }
catch (    SocketTimeoutException e) {
      LOG.info("Problem connecting to server: " + nnAddr);
      sleepAndLogInterrupts(1000,"connecting to server");
    }
  }
  LOG.info("Block pool " + this + " successfully registered with NN");
  bpos.registrationSucceeded(this,bpRegistration);
  scheduleBlockReport(dnConf.initialBlockReportDelay);
}
