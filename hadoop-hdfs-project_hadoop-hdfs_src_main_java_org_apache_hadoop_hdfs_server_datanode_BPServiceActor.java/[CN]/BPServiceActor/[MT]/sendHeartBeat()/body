{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Sending heartbeat from service actor: " + this);
  }
  StorageReport[] report={new StorageReport(bpRegistration.getStorageID(),false,dn.getFSDataset().getCapacity(),dn.getFSDataset().getDfsUsed(),dn.getFSDataset().getRemaining(),dn.getFSDataset().getBlockPoolUsed(bpos.getBlockPoolId()))};
  CacheReport[] cacheReport={new CacheReport(dn.getFSDataset().getCacheCapacity(),dn.getFSDataset().getCacheUsed())};
  return bpNamenode.sendHeartbeat(bpRegistration,report,cacheReport,dn.getXmitsInProgress(),dn.getXceiverCount(),dn.getFSDataset().getNumFailedVolumes());
}
