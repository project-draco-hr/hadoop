{
  StorageReport[] reports=dn.getFSDataset().getStorageReports(bpos.getBlockPoolId());
  if (LOG.isDebugEnabled()) {
    LOG.debug("Sending heartbeat with " + reports.length + " storage reports from service actor: "+ this);
  }
  return bpNamenode.sendHeartbeat(bpRegistration,reports,dn.getFSDataset().getDnCacheCapacity(),dn.getFSDataset().getDnCacheUsed(),dn.getXmitsInProgress(),dn.getXceiverCount(),dn.getFSDataset().getNumFailedVolumes());
}
