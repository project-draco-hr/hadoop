{
  final List<LocatedBlock> lbs=dfs.getClient().getLocatedBlocks(file.toString(),0).getLocatedBlocks();
  Assert.assertEquals(1,lbs.size());
  LocatedBlock lb=lbs.get(0);
  StringBuilder types=new StringBuilder();
  final Replication r=new Replication();
  for (  StorageType t : lb.getStorageTypes()) {
    types.append(t).append(", ");
    if (t == StorageType.DISK) {
      r.disk++;
    }
 else     if (t == StorageType.ARCHIVE) {
      r.archive++;
    }
 else {
      Assert.fail("Unexpected storage type " + t);
    }
  }
  if (expected != null) {
    final String s="file = " + file + "\n  types = ["+ types+ "]";
    Assert.assertEquals(s,expected,r);
  }
  return r;
}
