{
  GetNewApplicationRequest newAppRequest=GetNewApplicationRequest.newInstance();
  ApplicationClientProtocol submitterClient=getRMClientForUser(submitter);
  ApplicationId applicationId=submitterClient.getNewApplication(newAppRequest).getApplicationId();
  Resource resource=BuilderUtils.newResource(1024,1);
  Map<ApplicationAccessType,String> acls=createACLs(submitter,setupACLs);
  ContainerLaunchContext amContainerSpec=ContainerLaunchContext.newInstance(null,null,null,null,null,acls);
  ApplicationSubmissionContext appSubmissionContext=ApplicationSubmissionContext.newInstance(applicationId,"applicationName",queueName,null,amContainerSpec,false,true,1,resource,"applicationType");
  appSubmissionContext.setApplicationId(applicationId);
  appSubmissionContext.setQueue(queueName);
  SubmitApplicationRequest submitRequest=SubmitApplicationRequest.newInstance(appSubmissionContext);
  submitterClient.submitApplication(submitRequest);
  resourceManager.waitForState(applicationId,RMAppState.ACCEPTED);
  return applicationId;
}
