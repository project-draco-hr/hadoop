{
  inMemoryMapOutputs.add(mapOutput);
  LOG.info("closeInMemoryFile -> map-output of size: " + mapOutput.getSize() + ", inMemoryMapOutputs.size() -> "+ inMemoryMapOutputs.size()+ ", commitMemory -> "+ commitMemory+ ", usedMemory ->"+ usedMemory);
  commitMemory+=mapOutput.getSize();
synchronized (inMemoryMerger) {
    if (!inMemoryMerger.isInProgress() && commitMemory >= mergeThreshold) {
      LOG.info("Starting inMemoryMerger's merge since commitMemory=" + commitMemory + " > mergeThreshold="+ mergeThreshold+ ". Current usedMemory="+ usedMemory);
      inMemoryMapOutputs.addAll(inMemoryMergedMapOutputs);
      inMemoryMergedMapOutputs.clear();
      inMemoryMerger.startMerge(inMemoryMapOutputs);
    }
  }
  if (memToMemMerger != null) {
synchronized (memToMemMerger) {
      if (!memToMemMerger.isInProgress() && inMemoryMapOutputs.size() >= memToMemMergeOutputsThreshold) {
        memToMemMerger.startMerge(inMemoryMapOutputs);
      }
    }
  }
}
