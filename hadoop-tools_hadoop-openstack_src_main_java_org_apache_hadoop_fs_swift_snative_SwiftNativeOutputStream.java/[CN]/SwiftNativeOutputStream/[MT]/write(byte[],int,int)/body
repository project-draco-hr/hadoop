{
  if (offset < 0 || len < 0 || (offset + len) > buffer.length) {
    throw new IndexOutOfBoundsException("Invalid offset/length for write");
  }
  verifyOpen();
  SwiftUtils.debug(LOG," write(offset=%d, len=%d)",offset,len);
  while (blockOffset + len >= filePartSize) {
    int subWriteLen=(int)(filePartSize - blockOffset);
    if (subWriteLen < 0 || subWriteLen > len) {
      throw new SwiftInternalStateException("Invalid subwrite len: " + subWriteLen + " -buffer len: "+ len);
    }
    writeToBackupStream(buffer,offset,subWriteLen);
    offset+=subWriteLen;
    len-=subWriteLen;
    partUpload(false);
  }
  writeToBackupStream(buffer,offset,len);
}
