{
  File src;
  if (changeBlockFile) {
    src=replicaInfo.getBlockFile();
  }
 else {
    src=replicaInfo.getMetaFile();
  }
  File dst=DatanodeUtil.getUnlinkTmpFile(src);
  if (isRename) {
    src.renameTo(dst);
  }
 else {
    FileInputStream in=new FileInputStream(src);
    try {
      FileOutputStream out=new FileOutputStream(dst);
      try {
        IOUtils.copyBytes(in,out,1);
      }
  finally {
        out.close();
      }
    }
  finally {
      in.close();
    }
  }
}
