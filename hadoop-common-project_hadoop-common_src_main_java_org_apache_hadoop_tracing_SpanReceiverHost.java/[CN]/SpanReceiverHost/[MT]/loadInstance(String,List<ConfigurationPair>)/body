{
  className=className.trim();
  if (!className.contains(".")) {
    className="org.htrace.impl." + className;
  }
  Class<?> implClass=null;
  SpanReceiver impl;
  try {
    implClass=Class.forName(className);
    Object o=ReflectionUtils.newInstance(implClass,config);
    impl=(SpanReceiver)o;
    impl.configure(wrapHadoopConf(config,extraConfig));
  }
 catch (  ClassCastException e) {
    throw new IOException("Class " + className + " does not implement SpanReceiver.");
  }
catch (  ClassNotFoundException e) {
    throw new IOException("Class " + className + " cannot be found.");
  }
catch (  SecurityException e) {
    throw new IOException("Got SecurityException while loading " + "SpanReceiver " + className);
  }
catch (  IllegalArgumentException e) {
    throw new IOException("Got IllegalArgumentException while loading " + "SpanReceiver " + className,e);
  }
catch (  RuntimeException e) {
    throw new IOException("Got RuntimeException while loading " + "SpanReceiver " + className,e);
  }
  return impl;
}
