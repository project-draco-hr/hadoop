{
  if (!TaskType.MAP.equals(task.getType())) {
    LOG.error("Unexpected event for REDUCE task " + event.getType());
    task.internalError(event.getType());
  }
  TaskTAttemptEvent attemptEvent=(TaskTAttemptEvent)event;
  TaskAttemptId attemptId=attemptEvent.getTaskAttemptID();
  if (task.successfulAttempt == attemptId) {
    unSucceed(task);
    task.handleTaskAttemptCompletion(attemptId,TaskAttemptCompletionEventStatus.KILLED);
    task.eventHandler.handle(new JobMapTaskRescheduledEvent(task.taskId));
    task.addAndScheduleAttempt();
    return TaskState.SCHEDULED;
  }
 else {
    return TaskState.SUCCEEDED;
  }
}
