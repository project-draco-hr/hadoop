{
  if (event instanceof TaskTAttemptEvent) {
    TaskTAttemptEvent castEvent=(TaskTAttemptEvent)event;
    if (task.getState() == TaskState.SUCCEEDED && !castEvent.getTaskAttemptID().equals(task.successfulAttempt)) {
      return TaskState.SUCCEEDED;
    }
  }
  if (!TaskType.MAP.equals(task.getType())) {
    LOG.error("Unexpected event for REDUCE task " + event.getType());
    task.internalError(event.getType());
  }
  task.eventHandler.handle(new JobMapTaskRescheduledEvent(task.taskId));
  unSucceed(task);
  ++task.numberUncompletedAttempts;
  return super.transition(task,event);
}
