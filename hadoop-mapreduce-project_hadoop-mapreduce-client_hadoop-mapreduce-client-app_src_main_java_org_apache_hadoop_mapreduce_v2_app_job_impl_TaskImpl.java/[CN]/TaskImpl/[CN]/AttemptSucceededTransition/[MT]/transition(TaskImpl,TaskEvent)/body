{
  TaskTAttemptEvent taskTAttemptEvent=(TaskTAttemptEvent)event;
  TaskAttemptId taskAttemptId=taskTAttemptEvent.getTaskAttemptID();
  task.handleTaskAttemptCompletion(taskAttemptId,TaskAttemptCompletionEventStatus.SUCCEEDED);
  task.finishedAttempts.add(taskAttemptId);
  task.inProgressAttempts.remove(taskAttemptId);
  task.successfulAttempt=taskAttemptId;
  task.eventHandler.handle(new JobTaskEvent(task.taskId,TaskState.SUCCEEDED));
  LOG.info("Task succeeded with attempt " + task.successfulAttempt);
  if (task.historyTaskStartGenerated) {
    TaskFinishedEvent tfe=createTaskFinishedEvent(task,TaskStateInternal.SUCCEEDED);
    task.eventHandler.handle(new JobHistoryEvent(task.taskId.getJobId(),tfe));
  }
  for (  TaskAttempt attempt : task.attempts.values()) {
    if (attempt.getID() != task.successfulAttempt && !attempt.isFinished()) {
      LOG.info("Issuing kill to other attempt " + attempt.getID());
      task.eventHandler.handle(new TaskAttemptEvent(attempt.getID(),TaskAttemptEventType.TA_KILL));
    }
  }
  task.finished(TaskStateInternal.SUCCEEDED);
}
