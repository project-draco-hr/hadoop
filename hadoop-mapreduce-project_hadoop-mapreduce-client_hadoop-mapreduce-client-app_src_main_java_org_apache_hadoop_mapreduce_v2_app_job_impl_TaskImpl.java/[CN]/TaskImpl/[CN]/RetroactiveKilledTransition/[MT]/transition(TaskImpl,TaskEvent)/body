{
  TaskAttemptId attemptId=null;
  if (event instanceof TaskTAttemptEvent) {
    TaskTAttemptEvent castEvent=(TaskTAttemptEvent)event;
    attemptId=castEvent.getTaskAttemptID();
    if (task.getInternalState() == TaskStateInternal.SUCCEEDED && !attemptId.equals(task.successfulAttempt)) {
      task.finishedAttempts.add(castEvent.getTaskAttemptID());
      task.inProgressAttempts.remove(castEvent.getTaskAttemptID());
      return TaskStateInternal.SUCCEEDED;
    }
  }
  if (!TaskType.MAP.equals(task.getType())) {
    LOG.error("Unexpected event for REDUCE task " + event.getType());
    task.internalError(event.getType());
  }
  unSucceed(task);
  task.handleTaskAttemptCompletion(attemptId,TaskAttemptCompletionEventStatus.KILLED);
  task.eventHandler.handle(new JobMapTaskRescheduledEvent(task.taskId));
  task.addAndScheduleAttempt();
  return TaskStateInternal.SCHEDULED;
}
