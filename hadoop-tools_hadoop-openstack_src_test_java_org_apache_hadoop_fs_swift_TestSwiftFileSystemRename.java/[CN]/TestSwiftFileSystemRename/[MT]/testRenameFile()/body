{
  assumeRenameSupported();
  final Path old=new Path("/test/alice/file");
  final Path newPath=new Path("/test/bob/file");
  fs.mkdirs(newPath.getParent());
  final FSDataOutputStream fsDataOutputStream=fs.create(old);
  final byte[] message="Some data".getBytes();
  fsDataOutputStream.write(message);
  fsDataOutputStream.close();
  assertTrue(fs.exists(old));
  rename(old,newPath,true,false,true);
  final FSDataInputStream bobStream=fs.open(newPath);
  final byte[] bytes=new byte[512];
  final int read=bobStream.read(bytes);
  bobStream.close();
  final byte[] buffer=new byte[read];
  System.arraycopy(bytes,0,buffer,0,read);
  assertEquals(new String(message),new String(buffer));
}
