{
  final String fullHarPathStr=makeArchive();
  final String tmpDir=System.getProperty("test.build.data","build/test/data") + "/work-dir/har-fs-tmp";
  final Path tmpPath=new Path(tmpDir);
  final LocalFileSystem localFs=FileSystem.getLocal(new Configuration());
  localFs.delete(tmpPath,true);
  localFs.mkdirs(tmpPath);
  assertTrue(localFs.exists(tmpPath));
  final HarFileSystem harFileSystem=new HarFileSystem(fs);
  try {
    final URI harUri=new URI(fullHarPathStr);
    harFileSystem.initialize(harUri,fs.getConf());
    final Path sourcePath=new Path(fullHarPathStr + Path.SEPARATOR + "a");
    final Path targetPath=new Path(tmpPath,"straus");
    harFileSystem.copyToLocalFile(false,sourcePath,targetPath);
    FileStatus straus=localFs.getFileStatus(targetPath);
    assertEquals(1,straus.getLen());
  }
  finally {
    harFileSystem.close();
    localFs.delete(tmpPath,true);
  }
}
