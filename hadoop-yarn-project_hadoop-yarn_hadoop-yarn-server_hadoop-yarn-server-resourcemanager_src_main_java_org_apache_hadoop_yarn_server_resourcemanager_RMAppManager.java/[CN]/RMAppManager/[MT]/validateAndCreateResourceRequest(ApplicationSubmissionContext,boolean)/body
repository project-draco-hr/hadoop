{
  if (!submissionContext.getUnmanagedAM()) {
    ResourceRequest amReq=submissionContext.getAMContainerResourceRequest();
    if (amReq == null) {
      amReq=BuilderUtils.newResourceRequest(RMAppAttemptImpl.AM_CONTAINER_PRIORITY,ResourceRequest.ANY,submissionContext.getResource(),1);
    }
    if (null == amReq.getNodeLabelExpression()) {
      amReq.setNodeLabelExpression(submissionContext.getNodeLabelExpression());
    }
    try {
      SchedulerUtils.normalizeAndValidateRequest(amReq,scheduler.getMaximumResourceCapability(),submissionContext.getQueue(),scheduler,isRecovery,rmContext);
    }
 catch (    InvalidResourceRequestException e) {
      LOG.warn("RM app submission failed in validating AM resource request" + " for application " + submissionContext.getApplicationId(),e);
      throw e;
    }
    SchedulerUtils.normalizeRequest(amReq,scheduler.getResourceCalculator(),scheduler.getClusterResource(),scheduler.getMinimumResourceCapability(),scheduler.getMaximumResourceCapability(),scheduler.getMinimumResourceCapability());
    return amReq;
  }
  return null;
}
