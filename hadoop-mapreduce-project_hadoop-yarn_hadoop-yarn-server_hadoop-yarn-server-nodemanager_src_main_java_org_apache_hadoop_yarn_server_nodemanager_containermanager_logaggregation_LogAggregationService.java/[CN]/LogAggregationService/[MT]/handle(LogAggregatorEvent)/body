{
  if (this.isLogAggregationEnabled) {
switch (event.getType()) {
case APPLICATION_STARTED:
      LogAggregatorAppStartedEvent appStartEvent=(LogAggregatorAppStartedEvent)event;
    initApp(appStartEvent.getApplicationId(),appStartEvent.getUser(),appStartEvent.getCredentials(),appStartEvent.getLogRetentionPolicy(),appStartEvent.getApplicationAcls());
  break;
case CONTAINER_FINISHED:
LogAggregatorContainerFinishedEvent containerFinishEvent=(LogAggregatorContainerFinishedEvent)event;
stopContainer(containerFinishEvent.getContainerId(),containerFinishEvent.getExitCode());
break;
case APPLICATION_FINISHED:
LogAggregatorAppFinishedEvent appFinishedEvent=(LogAggregatorAppFinishedEvent)event;
stopApp(appFinishedEvent.getApplicationId());
break;
default :
;
}
}
}
