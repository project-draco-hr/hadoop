{
  Configuration conf=new Configuration();
  Job job=new Job(conf){
  }
;
  JobStats stats=Statistics.generateJobStats(job,null);
  testJobStats(stats,-1,-1,null,job);
  conf.setInt(GridmixJob.GRIDMIX_JOB_SEQ,1);
  job=new Job(conf){
  }
;
  JobStory zjob=getCustomJobStory(2,1);
  stats=Statistics.generateJobStats(job,zjob);
  testJobStats(stats,2,1,null,job);
  JobStatus jStatus=new JobStatus();
  stats.updateJobStatus(jStatus);
  testJobStats(stats,2,1,jStatus,job);
  CountDownLatch startFlag=new CountDownLatch(1);
  Statistics statistics=new Statistics(new JobConf(),0,startFlag);
  statistics.start();
  testClusterStats(0,0,0);
  statistics.addJobStats(stats);
  testClusterStats(2,1,1);
  JobStory zjob2=getCustomJobStory(10,5);
  conf.setInt(GridmixJob.GRIDMIX_JOB_SEQ,2);
  job=new Job(conf){
  }
;
  JobStats stats2=Statistics.generateJobStats(job,zjob2);
  statistics.addJobStats(stats2);
  testClusterStats(12,6,2);
  statistics.add(stats2);
  testClusterStats(2,1,1);
  statistics.add(stats);
  testClusterStats(0,0,0);
  statistics.shutdown();
}
