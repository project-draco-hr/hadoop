{
  addQueues(QUEUES);
  setSpending("queue1",1.0f);
  setSpending("queue2",2.0f);
  setBudgets(QUEUES,new float[]{100.0f,100.0f});
  scheduler.allocations.setUsage("queue1",1,0);
  scheduler.allocations.setUsage("queue2",1,0);
  timer.runTask();
  Map<String,QueueAllocation> shares=scheduler.allocations.getAllocation();
  assertEquals(1.0f / 3.0f,shares.get("queue1").getShare(),0.1f);
  assertEquals(2.0f / 3.0f,shares.get("queue2").getShare(),0.1f);
  setSpending("queue1",5.0f);
  setSpending("queue2",1.0f);
  timer.runTask();
  shares=scheduler.allocations.getAllocation();
  assertEquals(5.0f / 6.0f,shares.get("queue1").getShare(),0.1f);
  assertEquals(1.0f / 6.0f,shares.get("queue2").getShare(),0.1f);
}
