{
  PreemptionMessage pMsg=null;
  if (allocation.getStrictContainerPreemptions() != null) {
    pMsg=recordFactory.newRecordInstance(PreemptionMessage.class);
    StrictPreemptionContract pStrict=recordFactory.newRecordInstance(StrictPreemptionContract.class);
    Set<PreemptionContainer> pCont=new HashSet<PreemptionContainer>();
    for (    ContainerId cId : allocation.getStrictContainerPreemptions()) {
      PreemptionContainer pc=recordFactory.newRecordInstance(PreemptionContainer.class);
      pc.setId(cId);
      pCont.add(pc);
    }
    pStrict.setContainers(pCont);
    pMsg.setStrictContract(pStrict);
  }
  if (allocation.getResourcePreemptions() != null && allocation.getResourcePreemptions().size() > 0 && allocation.getContainerPreemptions() != null && allocation.getContainerPreemptions().size() > 0) {
    if (pMsg == null) {
      pMsg=recordFactory.newRecordInstance(PreemptionMessage.class);
    }
    PreemptionContract contract=recordFactory.newRecordInstance(PreemptionContract.class);
    Set<PreemptionContainer> pCont=new HashSet<PreemptionContainer>();
    for (    ContainerId cId : allocation.getContainerPreemptions()) {
      PreemptionContainer pc=recordFactory.newRecordInstance(PreemptionContainer.class);
      pc.setId(cId);
      pCont.add(pc);
    }
    List<PreemptionResourceRequest> pRes=new ArrayList<PreemptionResourceRequest>();
    for (    ResourceRequest crr : allocation.getResourcePreemptions()) {
      PreemptionResourceRequest prr=recordFactory.newRecordInstance(PreemptionResourceRequest.class);
      prr.setResourceRequest(crr);
      pRes.add(prr);
    }
    contract.setContainers(pCont);
    contract.setResourceRequest(pRes);
    pMsg.setContract(contract);
  }
  return pMsg;
}
