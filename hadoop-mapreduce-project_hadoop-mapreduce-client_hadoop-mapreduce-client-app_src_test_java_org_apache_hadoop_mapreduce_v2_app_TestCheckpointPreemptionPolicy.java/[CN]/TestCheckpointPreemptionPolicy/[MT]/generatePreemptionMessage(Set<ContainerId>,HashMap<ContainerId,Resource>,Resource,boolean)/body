{
  Set<ContainerId> currentContPreemption=Collections.unmodifiableSet(new HashSet<ContainerId>(containerToPreempt));
  containerToPreempt.clear();
  Resource tot=Resource.newInstance(0,0);
  for (  ContainerId c : currentContPreemption) {
    Resources.addTo(tot,resPerCont.get(c));
  }
  int numCont=(int)Math.ceil(tot.getMemory() / (double)minimumAllocation.getMemory());
  ResourceRequest rr=ResourceRequest.newInstance(Priority.newInstance(0),ResourceRequest.ANY,minimumAllocation,numCont);
  if (strict) {
    return generatePreemptionMessage(new Allocation(null,null,currentContPreemption,null,null));
  }
  return generatePreemptionMessage(new Allocation(null,null,null,currentContPreemption,Collections.singletonList(rr)));
}
