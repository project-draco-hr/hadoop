{
  Job job=Job.getInstance(new Cluster(getConf()),getConf());
  if (args.length != 2) {
    usage();
    return 2;
  }
  setNumberOfRows(job,parseHumanLong(args[0]));
  Path outputDir=new Path(args[1]);
  if (outputDir.getFileSystem(getConf()).exists(outputDir)) {
    throw new IOException("Output directory " + outputDir + " already exists.");
  }
  FileOutputFormat.setOutputPath(job,outputDir);
  job.setJobName("TeraGen");
  job.setJarByClass(TeraGen.class);
  job.setMapperClass(SortGenMapper.class);
  job.setNumReduceTasks(0);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(Text.class);
  job.setInputFormatClass(RangeInputFormat.class);
  job.setOutputFormatClass(TeraOutputFormat.class);
  return job.waitForCompletion(true) ? 0 : 1;
}
