{
  long totalRows=getNumberOfRows(job);
  int numSplits=job.getConfiguration().getInt(MRJobConfig.NUM_MAPS,1);
  LOG.info("Generating " + totalRows + " using "+ numSplits);
  List<InputSplit> splits=new ArrayList<InputSplit>();
  long currentRow=0;
  for (int split=0; split < numSplits; ++split) {
    long goal=(long)Math.ceil(totalRows * (double)(split + 1) / numSplits);
    splits.add(new RangeInputSplit(currentRow,goal - currentRow));
    currentRow=goal;
  }
  return splits;
}
