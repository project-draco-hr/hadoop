{
  if (rand == null) {
    rowId=new Unsigned16(row.get());
    rand=Random16.skipAhead(rowId);
    checksumCounter=context.getCounter(Counters.CHECKSUM);
  }
  Random16.nextRand(rand);
  GenSort.generateRecord(buffer,rand,rowId);
  key.set(buffer,0,TeraInputFormat.KEY_LENGTH);
  value.set(buffer,TeraInputFormat.KEY_LENGTH,TeraInputFormat.VALUE_LENGTH);
  context.write(key,value);
  crc32.reset();
  crc32.update(buffer,0,TeraInputFormat.KEY_LENGTH + TeraInputFormat.VALUE_LENGTH);
  checksum.set(crc32.getValue());
  total.add(checksum);
  rowId.add(ONE);
}
