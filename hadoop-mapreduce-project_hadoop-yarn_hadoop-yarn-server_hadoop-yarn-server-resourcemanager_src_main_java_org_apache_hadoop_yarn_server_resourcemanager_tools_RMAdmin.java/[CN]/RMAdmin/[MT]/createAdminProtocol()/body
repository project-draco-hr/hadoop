{
  final YarnConfiguration conf=new YarnConfiguration(getConf());
  final String adminAddress=conf.get(YarnConfiguration.RM_ADMIN_ADDRESS,YarnConfiguration.DEFAULT_RM_ADMIN_ADDRESS);
  final InetSocketAddress addr=NetUtils.createSocketAddr(adminAddress,YarnConfiguration.DEFAULT_RM_ADMIN_PORT,YarnConfiguration.RM_ADMIN_ADDRESS);
  final YarnRPC rpc=YarnRPC.create(conf);
  RMAdminProtocol adminProtocol=getUGI(conf).doAs(new PrivilegedAction<RMAdminProtocol>(){
    @Override public RMAdminProtocol run(){
      return (RMAdminProtocol)rpc.getProxy(RMAdminProtocol.class,addr,conf);
    }
  }
);
  return adminProtocol;
}
