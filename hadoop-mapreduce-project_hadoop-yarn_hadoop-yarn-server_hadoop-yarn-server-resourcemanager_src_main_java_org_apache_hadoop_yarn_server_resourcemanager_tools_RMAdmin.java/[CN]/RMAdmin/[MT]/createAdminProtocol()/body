{
  final YarnConfiguration conf=new YarnConfiguration(getConf());
  final String adminAddress=conf.get(YarnConfiguration.RM_ADMIN_ADDRESS,YarnConfiguration.RM_ADMIN_ADDRESS);
  final YarnRPC rpc=YarnRPC.create(conf);
  if (UserGroupInformation.isSecurityEnabled()) {
    conf.setClass(YarnConfiguration.YARN_SECURITY_INFO,AdminSecurityInfo.class,SecurityInfo.class);
  }
  RMAdminProtocol adminProtocol=getUGI(conf).doAs(new PrivilegedAction<RMAdminProtocol>(){
    @Override public RMAdminProtocol run(){
      return (RMAdminProtocol)rpc.getProxy(RMAdminProtocol.class,NetUtils.createSocketAddr(adminAddress),conf);
    }
  }
);
  return adminProtocol;
}
