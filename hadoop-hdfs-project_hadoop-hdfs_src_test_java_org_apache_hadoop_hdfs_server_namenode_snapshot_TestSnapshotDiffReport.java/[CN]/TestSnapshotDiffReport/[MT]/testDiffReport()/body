{
  Path subsub1=new Path(sub1,"subsub1");
  Path subsubsub1=new Path(subsub1,"subsubsub1");
  hdfs.mkdirs(subsubsub1);
  modifyAndCreateSnapshot(sub1,new Path[]{sub1,subsubsub1});
  modifyAndCreateSnapshot(subsubsub1,new Path[]{sub1,subsubsub1});
  try {
    hdfs.getSnapshotDiffReport(subsub1,"s1","s2");
    fail("Expect exception when getting snapshot diff report: " + subsub1 + " is not a snapshottable directory.");
  }
 catch (  IOException e) {
    GenericTestUtils.assertExceptionContains("Directory is not a snapshottable directory: " + subsub1,e);
  }
  SnapshotDiffReport report=hdfs.getSnapshotDiffReport(sub1,"s0","s0");
  System.out.println(report);
  assertEquals(0,report.getDiffList().size());
  report=hdfs.getSnapshotDiffReport(sub1,"","");
  System.out.println(report);
  assertEquals(0,report.getDiffList().size());
  report=hdfs.getSnapshotDiffReport(subsubsub1,"s0","s2");
  System.out.println(report);
  assertEquals(0,report.getDiffList().size());
  verifyDiffReport(sub1,"s0","s2",new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/file15"),new DiffReportEntry(DiffType.DELETE,"/TestSnapshot/sub1/file12"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/file11"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/file13"));
  verifyDiffReport(sub1,"s0","s5",new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/file15"),new DiffReportEntry(DiffType.DELETE,"/TestSnapshot/sub1/file12"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/file10"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/file11"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/file13"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/subsub1/subsubsub1"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file10"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file11"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file13"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file15"));
  verifyDiffReport(sub1,"s2","s5",new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/file10"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/subsub1/subsubsub1"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file10"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file11"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file13"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file15"));
  verifyDiffReport(sub1,"s3","",new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/subsub1/subsubsub1"),new DiffReportEntry(DiffType.CREATE,"/TestSnapshot/sub1/subsub1/subsubsub1/file15"),new DiffReportEntry(DiffType.DELETE,"/TestSnapshot/sub1/subsub1/subsubsub1/file12"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/subsub1/subsubsub1/file10"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/subsub1/subsubsub1/file11"),new DiffReportEntry(DiffType.MODIFY,"/TestSnapshot/sub1/subsub1/subsubsub1/file13"));
}
