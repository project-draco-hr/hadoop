{
  final Path root=new Path("/");
  final Path foo=new Path(root,"foo");
  final Path bar=new Path(foo,"bar");
  DFSTestUtil.createFile(hdfs,bar,BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,root,"s0");
  final Path foo2=new Path(root,"foo2");
  hdfs.rename(foo,foo2);
  final Path bar2=new Path(foo2,"bar");
  hdfs.deleteSnapshot(root,"s0");
  SnapshotTestHelper.createSnapshot(hdfs,root,"s1");
  final Path bar3=new Path(foo2,"bar-new");
  hdfs.rename(bar2,bar3);
  verifyDiffReport(root,"s1","",new DiffReportEntry(DiffType.MODIFY,DFSUtil.string2Bytes("")),new DiffReportEntry(DiffType.MODIFY,DFSUtil.string2Bytes("foo2")),new DiffReportEntry(DiffType.RENAME,DFSUtil.string2Bytes("foo2/bar"),DFSUtil.string2Bytes("foo2/bar-new")));
}
