{
  final Path root=new Path("/");
  final Path dir1=new Path(root,"dir1");
  final Path dir2=new Path(root,"dir2");
  final Path foo=new Path(dir1,"foo");
  final Path fileInFoo=new Path(foo,"file");
  final Path bar=new Path(dir2,"bar");
  final Path fileInBar=new Path(bar,"file");
  DFSTestUtil.createFile(hdfs,fileInFoo,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,fileInBar,BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,dir1,"s0");
  final Path newBar=new Path(dir1,"newBar");
  hdfs.rename(bar,newBar);
  final Path newFoo=new Path(dir2,"new");
  hdfs.rename(foo,newFoo);
  SnapshotTestHelper.createSnapshot(hdfs,dir1,"s1");
  verifyDiffReport(dir1,"s0","s1",new DiffReportEntry(DiffType.MODIFY,DFSUtil.string2Bytes("")),new DiffReportEntry(DiffType.CREATE,DFSUtil.string2Bytes(newBar.getName())),new DiffReportEntry(DiffType.DELETE,DFSUtil.string2Bytes(foo.getName())));
}
