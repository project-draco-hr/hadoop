{
  BPOfferService bpos=blockPoolManager.get(block.getBlockPoolId());
  if (bpos == null || bpos.bpNamenode == null) {
    throw new IOException("cannot locate OfferService thread for bp=" + block.getBlockPoolId());
  }
  bpos.reportBadBlocks(block);
}
