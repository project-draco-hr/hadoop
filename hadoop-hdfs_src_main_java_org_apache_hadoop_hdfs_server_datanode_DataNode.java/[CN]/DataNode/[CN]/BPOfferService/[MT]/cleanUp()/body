{
  if (upgradeManager != null)   upgradeManager.shutdownUpgrade();
  blockPoolManager.remove(this);
  shouldServiceRun=false;
  RPC.stopProxy(bpNamenode);
  if (blockScanner != null) {
    blockScanner.removeBlockPool(this.getBlockPoolId());
  }
  if (data != null) {
    data.shutdownBlockPool(this.getBlockPoolId());
  }
  if (storage != null) {
    storage.removeBlockPoolStorage(this.getBlockPoolId());
  }
}
