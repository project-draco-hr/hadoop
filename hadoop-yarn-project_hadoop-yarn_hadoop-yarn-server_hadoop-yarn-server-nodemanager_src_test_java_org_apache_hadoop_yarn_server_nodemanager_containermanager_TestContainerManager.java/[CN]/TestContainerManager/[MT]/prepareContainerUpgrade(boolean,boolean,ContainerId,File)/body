{
  File scriptFile=Shell.appendScriptExtension(tmpDir,"scriptFile_new");
  PrintWriter fileWriter=new PrintWriter(scriptFile);
  writeScriptFile(fileWriter,"Upgrade World!",startFile,cId,failCmd);
  ContainerLaunchContext containerLaunchContext=prepareContainerLaunchContext(scriptFile,"dest_file_new",failLoc);
  containerManager.upgradeContainer(cId,containerLaunchContext);
  try {
    containerManager.upgradeContainer(cId,containerLaunchContext);
  }
 catch (  Exception e) {
    Assert.assertTrue(e.getMessage().contains("Cannot perform UPGRADE"));
  }
  int timeoutSecs=0;
  int maxTimeToWait=failLoc ? 10 : 20;
  while (!startFile.exists() && timeoutSecs++ < maxTimeToWait) {
    Thread.sleep(1000);
    LOG.info("Waiting for New process start-file to be created");
  }
}
