{
  LOG.info("Updating the current master key for generating delegation tokens");
  int newCurrentId;
synchronized (this) {
    newCurrentId=incrementCurrentKeyId();
  }
  DelegationKey newKey=new DelegationKey(newCurrentId,System.currentTimeMillis() + keyUpdateInterval + tokenMaxLifetime,generateSecret());
  logUpdateMasterKey(newKey);
synchronized (this) {
    currentKey=newKey;
    storeDelegationKey(currentKey);
  }
}
