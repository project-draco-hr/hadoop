{
  int sequenceNum;
  long now=Time.now();
  sequenceNum=incrementDelegationTokenSeqNum();
  identifier.setIssueDate(now);
  identifier.setMaxDate(now + tokenMaxLifetime);
  identifier.setMasterKeyId(currentKey.getKeyId());
  identifier.setSequenceNumber(sequenceNum);
  LOG.info("Creating password for identifier: " + identifier + ", currentKey: "+ currentKey.getKeyId());
  byte[] password=createPassword(identifier.getBytes(),currentKey.getKey());
  DelegationTokenInformation tokenInfo=new DelegationTokenInformation(now + tokenRenewInterval,password,getTrackingIdIfEnabled(identifier));
  try {
    storeToken(identifier,tokenInfo);
  }
 catch (  IOException ioe) {
    LOG.error("Could not store token !!",ioe);
  }
  return password;
}
