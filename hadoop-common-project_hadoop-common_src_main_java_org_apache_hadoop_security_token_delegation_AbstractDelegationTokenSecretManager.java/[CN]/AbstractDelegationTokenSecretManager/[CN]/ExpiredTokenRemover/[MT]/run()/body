{
  LOG.info("Starting expired delegation token remover thread, " + "tokenRemoverScanInterval=" + tokenRemoverScanInterval / (60 * 1000) + " min(s)");
  try {
    while (running) {
      long now=Time.now();
      if (lastMasterKeyUpdate + keyUpdateInterval < now) {
        try {
          rollMasterKey();
          lastMasterKeyUpdate=now;
        }
 catch (        IOException e) {
          LOG.error("Master key updating failed: ",e);
        }
      }
      if (lastTokenCacheCleanup + tokenRemoverScanInterval < now) {
        removeExpiredToken();
        lastTokenCacheCleanup=now;
      }
      try {
        Thread.sleep(Math.min(5000,keyUpdateInterval));
      }
 catch (      InterruptedException ie) {
        LOG.error("InterruptedExcpetion recieved for ExpiredTokenRemover thread " + ie);
      }
    }
  }
 catch (  Throwable t) {
    LOG.error("ExpiredTokenRemover thread received unexpected exception. " + t);
    Runtime.getRuntime().exit(-1);
  }
}
