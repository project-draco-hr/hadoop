{
  conf=new Configuration();
  conf.setInt(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,SMALL_BLOCK);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_REPLICATION_INTERVAL_KEY,600);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_REPLICATION_MAX_STREAMS_KEY,1000);
  conf.setClass("dfs.block.replicator.classname",RandomDeleterPolicy.class,BlockPlacementPolicy.class);
  conf.setInt(DFSConfigKeys.DFS_HA_TAILEDITS_PERIOD_KEY,1);
  cluster=new MiniDFSCluster.Builder(conf).nnTopology(MiniDFSNNTopology.simpleHATopology()).numDataNodes(3).build();
  nn1=cluster.getNameNode(0);
  nn2=cluster.getNameNode(1);
  cluster.waitActive();
  cluster.transitionToActive(0);
  cluster.triggerBlockReports();
  fs=HATestUtil.configureFailoverFs(cluster,conf);
}
