{
  checkScheme(uri,supportedScheme);
  if (defaultPort < 0 && authorityNeeded) {
    throw new HadoopIllegalArgumentException("FileSystem implementation error -  default port " + defaultPort + " is not valid");
  }
  String authority=uri.getAuthority();
  if (!authorityNeeded) {
    if (authority != null) {
      throw new HadoopIllegalArgumentException("Scheme with non-null authority: " + uri);
    }
    return new URI(supportedScheme + ":///");
  }
  if (authority == null) {
    throw new HadoopIllegalArgumentException("Uri without authority: " + uri);
  }
  int port=uri.getPort();
  port=port == -1 ? defaultPort : port;
  return new URI(supportedScheme + "://" + uri.getHost()+ ":"+ port);
}
