{
  if (op.getRequireAuth()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("open AuthenticatedURL connection" + url);
    }
    UserGroupInformation.getCurrentUser().checkTGTAndReloginFromKeytab();
    final AuthenticatedURL.Token authToken=new AuthenticatedURL.Token();
    return new AuthenticatedURL(AUTH,connConfigurator).openConnection(url,authToken);
  }
 else {
    if (LOG.isDebugEnabled()) {
      LOG.debug("open URL connection");
    }
    return openConnection(url);
  }
}
