{
  final StringBuilder b=new StringBuilder("createSnapshot: ").append(snapshot).append(" for ").append(dir);
{
    final File subDir=new File(localDir,snapshot);
    Assert.assertFalse(subDir.exists());
    subDir.mkdir();
    for (    File f : localDir.listFiles(FILE_ONLY)) {
      FileUtils.copyFile(f,new File(subDir,f.getName()));
    }
  }
  final Path p=dfs.createSnapshot(dir,snapshot);
  snapshotPaths.put(snapshot,p);
  return b.toString();
}
