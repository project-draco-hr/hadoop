{
  final Random r=DFSUtil.getRandom();
  final int op=r.nextInt(6);
  if (op <= 1) {
    pauseAllFiles();
    try {
      final String snapshot=getSnapshotName(snapshotCount.getAndIncrement());
      return createSnapshot(snapshot);
    }
  finally {
      startAllFiles();
    }
  }
 else   if (op <= 3) {
    final String[] keys=snapshotPaths.keySet().toArray(EMPTY_STRINGS);
    if (keys.length == 0) {
      return "NO-OP";
    }
    final String snapshot=keys[r.nextInt(keys.length)];
    final String s=checkSnapshot(snapshot);
    if (op == 2) {
      return deleteSnapshot(snapshot);
    }
    return s;
  }
 else {
    return "NO-OP";
  }
}
