{
  final StringBuilder b=new StringBuilder("checkSnapshot: ").append(snapshot);
  final File subDir=new File(localDir,snapshot);
  Assert.assertTrue(subDir.exists());
  final File[] localFiles=subDir.listFiles(FILE_ONLY);
  final Path p=snapshotPaths.get(snapshot);
  final FileStatus[] statuses=dfs.listStatus(p);
  Assert.assertEquals(localFiles.length,statuses.length);
  b.append(p).append(" vs ").append(subDir).append(", ").append(statuses.length).append(" entries");
  Arrays.sort(localFiles);
  Arrays.sort(statuses);
  for (int i=0; i < statuses.length; i++) {
    FileWorker.checkFullFile(statuses[i].getPath(),localFiles[i]);
  }
  return b.toString();
}
