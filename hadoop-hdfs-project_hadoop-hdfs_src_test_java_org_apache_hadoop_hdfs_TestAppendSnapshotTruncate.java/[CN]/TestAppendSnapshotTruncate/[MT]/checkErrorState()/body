{
  final State s=state.get();
  if (s == State.ERROR) {
    throw new IllegalStateException(name + " has " + s,thrown);
  }
  return s;
}
