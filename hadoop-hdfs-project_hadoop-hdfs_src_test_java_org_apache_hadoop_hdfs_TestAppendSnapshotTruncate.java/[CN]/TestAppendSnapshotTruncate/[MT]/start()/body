{
  Preconditions.checkState(state.compareAndSet(State.IDLE,State.RUNNING));
  if (thread.get() == null) {
    final Thread t=new Thread(null,new Runnable(){
      @Override public void run(){
        final Random r=DFSUtil.getRandom();
        for (State s; (s=state.get()) == State.RUNNING || s == State.IDLE; ) {
          if (s == State.RUNNING) {
            isCalling.set(true);
            try {
              LOG.info(call());
            }
 catch (            Exception e) {
              LOG.error("Worker " + name + " failed.",e);
              state.set(State.ERROR);
              return;
            }
            isCalling.set(false);
          }
          sleep(r.nextInt(100) + 50);
        }
      }
    }
,name);
    Preconditions.checkState(thread.compareAndSet(null,t));
    t.start();
  }
}
