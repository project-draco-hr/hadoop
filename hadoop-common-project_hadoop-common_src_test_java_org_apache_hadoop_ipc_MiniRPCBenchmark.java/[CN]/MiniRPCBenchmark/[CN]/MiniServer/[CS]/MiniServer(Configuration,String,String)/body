{
  UserGroupInformation.setConfiguration(conf);
  UserGroupInformation.loginUserFromKeytab(user,keytabFile);
  secretManager=new TestDelegationTokenSecretManager(24 * 60 * 60* 1000,7 * 24 * 60* 60* 1000,24 * 60 * 60* 1000,3600000);
  secretManager.startThreads();
  rpcServer=new RPC.Builder(conf).setProtocol(MiniProtocol.class).setInstance(this).setBindAddress(DEFAULT_SERVER_ADDRESS).setPort(0).setNumHandlers(1).setVerbose(false).setSecretManager(secretManager).build();
  rpcServer.start();
}
