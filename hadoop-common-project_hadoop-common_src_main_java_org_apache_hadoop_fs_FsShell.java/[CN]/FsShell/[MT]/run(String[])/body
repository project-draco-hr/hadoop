{
  init();
  traceSampler=new SamplerBuilder(TraceUtils.wrapHadoopConf(SEHLL_HTRACE_PREFIX,getConf())).build();
  int exitCode=-1;
  if (argv.length < 1) {
    printUsage(System.err);
  }
 else {
    String cmd=argv[0];
    Command instance=null;
    try {
      instance=commandFactory.getInstance(cmd);
      if (instance == null) {
        throw new UnknownCommandException();
      }
      TraceScope scope=Trace.startSpan(instance.getCommandName(),traceSampler);
      try {
        exitCode=instance.run(Arrays.copyOfRange(argv,1,argv.length));
      }
  finally {
        scope.close();
      }
    }
 catch (    IllegalArgumentException e) {
      displayError(cmd,e.getLocalizedMessage());
      if (instance != null) {
        printInstanceUsage(System.err,instance);
      }
    }
catch (    Exception e) {
      LOG.debug("Error",e);
      displayError(cmd,"Fatal internal error");
      e.printStackTrace(System.err);
    }
  }
  return exitCode;
}
