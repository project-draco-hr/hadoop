{
  final Configuration conf=new Configuration();
  conf.set(MRConfig.FRAMEWORK_NAME,MRConfig.YARN_FRAMEWORK_NAME);
  conf.set(FileSystem.FS_DEFAULT_NAME_KEY,"nosuchfs:///");
  conf.set(JTConfig.JT_IPC_ADDRESS,"local");
  try {
    new Cluster(conf);
    fail("Cluster init should fail because of non-existing FileSystem");
  }
 catch (  IOException ioEx) {
    final String stackTrace=StringUtils.stringifyException(ioEx);
    assertTrue("No root cause detected",stackTrace.contains(UnsupportedFileSystemException.class.getName()) && stackTrace.contains("nosuchfs"));
  }
}
