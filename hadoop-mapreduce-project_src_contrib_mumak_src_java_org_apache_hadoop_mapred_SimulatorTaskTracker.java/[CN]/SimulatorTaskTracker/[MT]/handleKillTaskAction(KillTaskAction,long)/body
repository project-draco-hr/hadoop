{
  TaskAttemptID taskId=action.getTaskID();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Handling kill task action, taskId=" + taskId + ", now="+ now);
  }
  SimulatorTaskInProgress tip=tasks.get(taskId);
  if (tip == null) {
    return SimulatorEngine.EMPTY_EVENTS;
  }
  progressTaskStatus(tip,now);
  TaskStatus finalStatus=(TaskStatus)tip.getTaskStatus().clone();
  finalStatus.setFinishTime(now);
  finalStatus.setRunState(State.KILLED);
  finishRunningTask(finalStatus,now);
  if (finalStatus.getIsMap() || finalStatus.getPhase() == Phase.REDUCE) {
    orphanTaskCompletions.add(taskId);
  }
  return SimulatorEngine.EMPTY_EVENTS;
}
