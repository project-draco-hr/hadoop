{
  Set<NodeLabel> nodeLabelsForHeartbeat=nodeLabelsProvider.getNodeLabels();
  nodeLabelsForHeartbeat=(nodeLabelsForHeartbeat == null) ? CommonNodeLabelsManager.EMPTY_NODELABEL_SET : nodeLabelsForHeartbeat;
  boolean areNodeLabelsUpdated=nodeLabelsForHeartbeat.size() != previousNodeLabels.size() || !previousNodeLabels.containsAll(nodeLabelsForHeartbeat) || checkResendLabelOnFailure();
  updatedLabelsSentToRM=false;
  if (areNodeLabelsUpdated) {
    previousNodeLabels=nodeLabelsForHeartbeat;
    try {
      LOG.info("Modified labels from provider: " + StringUtils.join(",",previousNodeLabels));
      validateNodeLabels(nodeLabelsForHeartbeat);
      updatedLabelsSentToRM=true;
    }
 catch (    IOException e) {
      nodeLabelsForHeartbeat=null;
    }
  }
 else {
    nodeLabelsForHeartbeat=null;
  }
  return nodeLabelsForHeartbeat;
}
