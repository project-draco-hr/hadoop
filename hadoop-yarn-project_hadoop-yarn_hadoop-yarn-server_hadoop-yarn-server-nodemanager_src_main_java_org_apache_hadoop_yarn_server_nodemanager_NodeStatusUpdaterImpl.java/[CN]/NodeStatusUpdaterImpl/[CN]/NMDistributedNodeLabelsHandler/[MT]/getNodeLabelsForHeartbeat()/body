{
  Set<NodeLabel> nodeLabelsForHeartbeat=nodeLabelsProvider.getNodeLabels();
  nodeLabelsForHeartbeat=(nodeLabelsForHeartbeat == null) ? CommonNodeLabelsManager.EMPTY_NODELABEL_SET : nodeLabelsForHeartbeat;
  boolean areNodeLabelsUpdated=nodeLabelsForHeartbeat.size() != previousNodeLabels.size() || !previousNodeLabels.containsAll(nodeLabelsForHeartbeat);
  areLabelsSentToRM=false;
  if (areNodeLabelsUpdated || isResyncIntervalElapsed()) {
    previousNodeLabels=nodeLabelsForHeartbeat;
    try {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Labels from provider: " + StringUtils.join(",",previousNodeLabels));
      }
      validateNodeLabels(nodeLabelsForHeartbeat);
      areLabelsSentToRM=true;
    }
 catch (    IOException e) {
      nodeLabelsForHeartbeat=null;
    }
 finally {
      lastNodeLabelSendMills=System.currentTimeMillis();
    }
  }
 else {
    nodeLabelsForHeartbeat=null;
  }
  return nodeLabelsForHeartbeat;
}
