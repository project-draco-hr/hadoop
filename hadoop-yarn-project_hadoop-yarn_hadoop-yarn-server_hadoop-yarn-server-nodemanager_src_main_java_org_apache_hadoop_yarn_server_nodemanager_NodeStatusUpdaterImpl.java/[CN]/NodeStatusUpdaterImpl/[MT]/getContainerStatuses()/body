{
  List<ContainerStatus> containerStatuses=new ArrayList<ContainerStatus>();
  for (  Container container : this.context.getContainers().values()) {
    ContainerId containerId=container.getContainerId();
    ApplicationId applicationId=container.getContainerId().getApplicationAttemptId().getApplicationId();
    if (!this.context.getApplications().containsKey(applicationId)) {
      context.getContainers().remove(containerId);
      continue;
    }
    org.apache.hadoop.yarn.api.records.ContainerStatus containerStatus=container.cloneAndGetContainerStatus();
    containerStatuses.add(containerStatus);
    if (containerStatus.getState().equals(ContainerState.COMPLETE)) {
      addCompletedContainer(container.getContainerId());
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Sending out " + containerStatuses.size() + " container statuses: "+ containerStatuses);
  }
  return containerStatuses;
}
