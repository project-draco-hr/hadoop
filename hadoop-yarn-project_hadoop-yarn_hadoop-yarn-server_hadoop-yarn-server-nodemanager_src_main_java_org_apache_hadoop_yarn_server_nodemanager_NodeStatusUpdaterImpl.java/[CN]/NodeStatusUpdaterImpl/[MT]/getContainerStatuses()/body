{
  List<ContainerStatus> containerStatuses=new ArrayList<ContainerStatus>();
  for (  Container container : this.context.getContainers().values()) {
    org.apache.hadoop.yarn.api.records.ContainerStatus containerStatus=container.cloneAndGetContainerStatus();
    containerStatuses.add(containerStatus);
    if (containerStatus.getState().equals(ContainerState.COMPLETE)) {
      updateStoppedContainersInCache(container.getContainerId());
      addCompletedContainer(container);
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Sending out " + containerStatuses.size() + " container statuses: "+ containerStatuses);
  }
  return containerStatuses;
}
