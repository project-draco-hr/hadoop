{
  List<ContainerStatus> containerStatuses=new ArrayList<ContainerStatus>();
  for (  Container container : this.context.getContainers().values()) {
    ContainerId containerId=container.getContainerId();
    ApplicationId applicationId=container.getContainerId().getApplicationAttemptId().getApplicationId();
    org.apache.hadoop.yarn.api.records.ContainerStatus containerStatus=container.cloneAndGetContainerStatus();
    containerStatuses.add(containerStatus);
    if (containerStatus.getState() == ContainerState.COMPLETE) {
      if (isApplicationStopped(applicationId)) {
        if (LOG.isDebugEnabled()) {
          LOG.debug(applicationId + " is completing, " + " remove "+ containerId+ " from NM context.");
        }
        context.getContainers().remove(containerId);
      }
 else {
        addCompletedContainer(container.getContainerId());
      }
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Sending out " + containerStatuses.size() + " container statuses: "+ containerStatuses);
  }
  return containerStatuses;
}
