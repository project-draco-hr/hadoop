{
  List<NMContainerStatus> containerStatuses=new ArrayList<NMContainerStatus>();
  for (  Container container : this.context.getContainers().values()) {
    ContainerId containerId=container.getContainerId();
    ApplicationId applicationId=container.getContainerId().getApplicationAttemptId().getApplicationId();
    if (!this.context.getApplications().containsKey(applicationId)) {
      context.getContainers().remove(containerId);
      continue;
    }
    NMContainerStatus status=container.getNMContainerStatus();
    containerStatuses.add(status);
    if (status.getContainerState() == ContainerState.COMPLETE) {
      addCompletedContainer(container.getContainerId());
    }
  }
  LOG.info("Sending out " + containerStatuses.size() + " NM container statuses: "+ containerStatuses);
  return containerStatuses;
}
