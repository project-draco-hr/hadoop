{
  List<ContainerStatus> containerStatuses=new ArrayList<ContainerStatus>();
  for (Iterator<Entry<ContainerId,Container>> i=this.context.getContainers().entrySet().iterator(); i.hasNext(); ) {
    Entry<ContainerId,Container> e=i.next();
    ContainerId containerId=e.getKey();
    Container container=e.getValue();
    org.apache.hadoop.yarn.api.records.ContainerStatus containerStatus=container.cloneAndGetContainerStatus();
    containerStatuses.add(containerStatus);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Sending out status for container: " + containerStatus);
    }
    if (containerStatus.getState() == ContainerState.COMPLETE) {
      i.remove();
      addStoppedContainersToCache(containerId);
      LOG.info("Removed completed container " + containerId);
    }
  }
  return containerStatuses;
}
