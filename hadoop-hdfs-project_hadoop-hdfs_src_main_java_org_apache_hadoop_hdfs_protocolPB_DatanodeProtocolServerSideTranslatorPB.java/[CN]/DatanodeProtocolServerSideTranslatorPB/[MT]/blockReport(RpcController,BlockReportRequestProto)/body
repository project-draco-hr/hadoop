{
  DatanodeCommand cmd;
  List<Long> blockIds=request.getBlocksList();
  long[] blocks=new long[blockIds.size()];
  for (int i=0; i < blockIds.size(); i++) {
    blocks[i]=blockIds.get(i);
  }
  try {
    cmd=impl.blockReport(PBHelper.convert(request.getRegistration()),request.getBlockPoolId(),blocks);
  }
 catch (  IOException e) {
    throw new ServiceException(e);
  }
  return BlockReportResponseProto.newBuilder().setCmd(PBHelper.convert(cmd)).build();
}
