{
  HttpServletRequest httpRequest=(HttpServletRequest)request;
  if (!isBrowser(httpRequest.getHeader(HEADER_USER_AGENT)) || methodsToIgnore.contains(httpRequest.getMethod()) || httpRequest.getHeader(headerName) != null) {
    chain.doFilter(request,response);
  }
 else {
    ((HttpServletResponse)response).sendError(HttpServletResponse.SC_BAD_REQUEST,"Missing Required Header for CSRF Vulnerability Protection");
  }
}
