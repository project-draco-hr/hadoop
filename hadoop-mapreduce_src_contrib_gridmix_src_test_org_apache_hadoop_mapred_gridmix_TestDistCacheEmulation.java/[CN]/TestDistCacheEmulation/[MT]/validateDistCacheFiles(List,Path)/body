{
  RemoteIterator<LocatedFileStatus> iter=GridmixTestUtils.dfs.listFiles(distCacheDir,false);
  int numFiles=filesSizesExpected.size();
  for (int i=0; i < numFiles; i++) {
    assertTrue("Missing distributed cache files.",iter.hasNext());
    LocatedFileStatus stat=iter.next();
    assertTrue("File size of distributed cache file " + stat.getPath().toUri().getPath() + " is wrong.",filesSizesExpected.remove(stat.getLen()));
    FsPermission perm=stat.getPermission();
    assertEquals("Wrong permissions for distributed cache file " + stat.getPath().toUri().getPath(),new FsPermission((short)0644),perm);
  }
  assertFalse("Number of files under distributed cache dir is wrong.",iter.hasNext());
}
