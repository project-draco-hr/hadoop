{
  while (true) {
    XMLEvent ev=expectTag("ref",true);
    if (ev.isEndElement()) {
      break;
    }
    Node inodeRef=new Node();
    FsImageProto.INodeReferenceSection.INodeReference.Builder bld=FsImageProto.INodeReferenceSection.INodeReference.newBuilder();
    loadNodeChildren(inodeRef,"INodeReference");
    Long referredId=inodeRef.removeChildLong("referredId");
    if (referredId != null) {
      bld.setReferredId(referredId);
    }
    String name=inodeRef.removeChildStr("name");
    if (name != null) {
      bld.setName(ByteString.copyFrom(name,"UTF8"));
    }
    Integer dstSnapshotId=inodeRef.removeChildInt("dstSnapshotId");
    if (dstSnapshotId != null) {
      bld.setDstSnapshotId(dstSnapshotId);
    }
    Integer lastSnapshotId=inodeRef.removeChildInt("lastSnapshotId");
    if (lastSnapshotId != null) {
      bld.setLastSnapshotId(lastSnapshotId);
    }
    inodeRef.verifyNoRemainingKeys("ref");
    bld.build().writeDelimitedTo(out);
  }
  recordSectionLength(SectionName.INODE_REFERENCE.name());
}
