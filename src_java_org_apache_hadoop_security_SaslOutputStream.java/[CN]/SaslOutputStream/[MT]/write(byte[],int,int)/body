{
  try {
    if (saslServer != null) {
      saslToken=saslServer.wrap(inBuf,off,len);
    }
 else {
      saslToken=saslClient.wrap(inBuf,off,len);
    }
  }
 catch (  SaslException se) {
    try {
      disposeSasl();
    }
 catch (    SaslException ignored) {
    }
    throw se;
  }
  if (saslToken != null) {
    outStream.writeInt(saslToken.length);
    outStream.write(saslToken,0,saslToken.length);
    saslToken=null;
  }
}
