{
  this.conf=conf;
  YarnRPC rpc=YarnRPC.create(this.conf);
  InetSocketAddress rmAddress=NetUtils.createSocketAddr(this.conf.get(YarnConfiguration.RM_ADDRESS,YarnConfiguration.DEFAULT_RM_ADDRESS),YarnConfiguration.DEFAULT_RM_PORT,YarnConfiguration.RM_ADDRESS);
  this.rmAddress=rmAddress.toString();
  LOG.debug("Connecting to ResourceManager at " + rmAddress);
  applicationsManager=(ClientRMProtocol)rpc.getProxy(ClientRMProtocol.class,rmAddress,this.conf);
  LOG.debug("Connected to ResourceManager at " + rmAddress);
}
