{
  long bandwidth;
  int exitCode=-1;
  try {
    bandwidth=Long.parseLong(argv[idx]);
  }
 catch (  NumberFormatException nfe) {
    System.err.println("NumberFormatException: " + nfe.getMessage());
    System.err.println("Usage: java DFSAdmin" + " [-setBalancerBandwidth <bandwidth in bytes per second>]");
    return exitCode;
  }
  FileSystem fs=getFS();
  if (!(fs instanceof DistributedFileSystem)) {
    System.err.println("FileSystem is " + fs.getUri());
    return exitCode;
  }
  DistributedFileSystem dfs=(DistributedFileSystem)fs;
  dfs.setBalancerBandwidth(bandwidth);
  exitCode=0;
  return exitCode;
}
