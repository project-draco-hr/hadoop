{
  if (!isNativeSnappyLoaded(conf)) {
    throw new RuntimeException("native-snappy library not available");
  }
  return new SnappyDecompressor(conf.getInt(SNAPPY_BUFFER_SIZE_KEY,DEFAULT_SNAPPY_BUFFER_SIZE));
}
