{
  Compressor compressor=borrow(compressorPool,codec.getCompressorType());
  if (compressor == null) {
    compressor=codec.createCompressor();
    LOG.info("Got brand-new compressor [" + codec.getDefaultExtension() + "]");
  }
 else {
    compressor.reinit(conf);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Got recycled compressor");
    }
  }
  updateLeaseCount(compressorCounts,compressor,1);
  return compressor;
}
