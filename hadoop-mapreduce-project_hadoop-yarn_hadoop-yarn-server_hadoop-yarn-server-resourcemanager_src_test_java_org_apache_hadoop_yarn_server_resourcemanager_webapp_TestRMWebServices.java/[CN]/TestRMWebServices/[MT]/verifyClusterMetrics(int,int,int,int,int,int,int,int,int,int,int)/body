{
  ResourceScheduler rs=rm.getResourceScheduler();
  QueueMetrics metrics=rs.getRootQueueMetrics();
  ClusterMetrics clusterMetrics=ClusterMetrics.getMetrics();
  final long MB_IN_GB=1024;
  long totalMBExpect=(metrics.getReservedGB() * MB_IN_GB) + (metrics.getAvailableGB() * MB_IN_GB) + (metrics.getAllocatedGB() * MB_IN_GB);
  assertEquals("appsSubmitted doesn't match",metrics.getAppsSubmitted(),sub);
  assertEquals("reservedMB doesn't match",metrics.getReservedGB() * MB_IN_GB,reservedMB);
  assertEquals("availableMB doesn't match",metrics.getAvailableGB() * MB_IN_GB,availableMB);
  assertEquals("allocatedMB doesn't match",metrics.getAllocatedGB() * MB_IN_GB,allocMB);
  assertEquals("containersAllocated doesn't match",0,containersAlloc);
  assertEquals("totalMB doesn't match",totalMBExpect,totalMB);
  assertEquals("totalNodes doesn't match",clusterMetrics.getNumNMs(),totalNodes);
  assertEquals("lostNodes doesn't match",clusterMetrics.getNumLostNMs(),lostNodes);
  assertEquals("unhealthyNodes doesn't match",clusterMetrics.getUnhealthyNMs(),unhealthyNodes);
  assertEquals("decommissionedNodes doesn't match",clusterMetrics.getNumDecommisionedNMs(),decommissionedNodes);
  assertEquals("rebootedNodes doesn't match",clusterMetrics.getNumRebootedNMs(),rebootedNodes);
}
