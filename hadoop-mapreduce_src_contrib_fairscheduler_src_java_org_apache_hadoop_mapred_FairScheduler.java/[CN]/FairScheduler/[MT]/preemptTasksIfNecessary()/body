{
  if (!preemptionEnabled)   return;
  long curTime=clock.getTime();
  if (curTime - lastPreemptCheckTime < preemptionInterval)   return;
  lastPreemptCheckTime=curTime;
synchronized (taskTrackerManager) {
synchronized (this) {
      for (      TaskType type : MAP_AND_REDUCE) {
        List<PoolSchedulable> scheds=getPoolSchedulables(type);
        int tasksToPreempt=0;
        for (        PoolSchedulable sched : scheds) {
          tasksToPreempt+=tasksToPreempt(sched,curTime);
        }
        if (tasksToPreempt > 0) {
          eventLog.log("SHOULD_PREEMPT",type,tasksToPreempt);
          if (!onlyLogPreemption) {
            preemptTasks(scheds,tasksToPreempt);
          }
        }
      }
    }
  }
}
