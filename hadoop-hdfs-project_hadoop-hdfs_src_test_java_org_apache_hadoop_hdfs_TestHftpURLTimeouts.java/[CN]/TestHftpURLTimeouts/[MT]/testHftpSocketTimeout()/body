{
  Configuration conf=new Configuration();
  ServerSocket socket=new ServerSocket(0,1);
  URI uri=new URI("hftp",null,InetAddress.getByName(null).getHostAddress(),socket.getLocalPort(),null,null,null);
  boolean timedout=false;
  HftpFileSystem fs=(HftpFileSystem)FileSystem.get(uri,conf);
  HttpURLConnection conn=fs.openConnection("/","");
  timedout=false;
  try {
    conn.getInputStream();
  }
 catch (  SocketTimeoutException ste) {
    timedout=true;
    assertEquals("Read timed out",ste.getMessage());
  }
 finally {
    if (conn != null)     conn.disconnect();
  }
  assertTrue("read timedout",timedout);
  assertTrue("connect timedout",checkConnectTimeout(fs,false));
}
