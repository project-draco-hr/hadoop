{
  Collection<RMNode> nodes=this.rmContext.getRMNodes().values();
  List<InfoMap> nodesInfo=new ArrayList<InfoMap>();
  for (  final RMNode ni : nodes) {
    SchedulerNodeReport report=scheduler.getNodeReport(ni.getNodeID());
    InfoMap info=new InfoMap();
    info.put("HostName",ni.getHostName());
    info.put("Rack",ni.getRackName());
    info.put("State",ni.getState().toString());
    info.put("NodeId",ni.getNodeID());
    info.put("NodeHTTPAddress",ni.getHttpAddress());
    info.put("HealthStatus",ni.getNodeHealthStatus().getIsNodeHealthy() ? "Healthy" : "Unhealthy");
    info.put("LastHealthUpdate",ni.getNodeHealthStatus().getLastHealthReportTime());
    info.put("HealthReport",ni.getNodeHealthStatus().getHealthReport());
    info.put("NumContainersMB",report.getNumContainers());
    info.put("UsedMemoryMB",report.getUsedResource().getMemory());
    info.put("AvailableMemoryMB",report.getAvailableResource().getMemory());
    nodesInfo.add(info);
  }
  return JSON.toString(nodesInfo);
}
