{
  Map<String,String> params=new HashMap<String,String>();
  params.put(OP_PARAM,DelegationTokenOperation.RENEWDELEGATIONTOKEN.toString());
  params.put(TOKEN_PARAM,dToken.encodeToUrlString());
  URL url=HttpFSUtils.createHttpURL(new Path(fsURI),params);
  AuthenticatedURL aUrl=new AuthenticatedURL(new HttpFSKerberosAuthenticator());
  try {
    HttpURLConnection conn=aUrl.openConnection(url,token);
    conn.setRequestMethod(DelegationTokenOperation.RENEWDELEGATIONTOKEN.getHttpMethod());
    HttpFSUtils.validateResponse(conn,HttpURLConnection.HTTP_OK);
    JSONObject json=(JSONObject)((JSONObject)HttpFSUtils.jsonParse(conn)).get(DELEGATION_TOKEN_JSON);
    return (Long)(json.get(RENEW_DELEGATION_TOKEN_JSON));
  }
 catch (  AuthenticationException ex) {
    throw new IOException(ex.toString(),ex);
  }
}
