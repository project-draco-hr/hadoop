{
  if (historyServiceEnabled) {
    try {
      Class<? extends ApplicationHistoryStore> storeClass=conf.getClass(YarnConfiguration.RM_HISTORY_WRITER_CLASS,NullApplicationHistoryStore.class,ApplicationHistoryStore.class);
      return storeClass.newInstance();
    }
 catch (    Exception e) {
      String msg="Could not instantiate ApplicationHistoryWriter: " + conf.get(YarnConfiguration.RM_HISTORY_WRITER_CLASS,NullApplicationHistoryStore.class.getName());
      LOG.error(msg,e);
      throw new YarnRuntimeException(msg,e);
    }
  }
 else {
    return new NullApplicationHistoryStore();
  }
}
