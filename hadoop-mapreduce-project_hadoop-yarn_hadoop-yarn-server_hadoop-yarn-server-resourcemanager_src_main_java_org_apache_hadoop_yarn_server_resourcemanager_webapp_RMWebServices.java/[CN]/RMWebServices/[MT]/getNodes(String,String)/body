{
  ResourceScheduler sched=this.rm.getResourceScheduler();
  if (sched == null) {
    throw new NotFoundException("Null ResourceScheduler instance");
  }
  NodesInfo allNodes=new NodesInfo();
  for (  RMNode ni : this.rm.getRMContext().getRMNodes().values()) {
    NodeInfo nodeInfo=new NodeInfo(ni,sched);
    if (filterState != null) {
      RMNodeState.valueOf(filterState);
      if (!(nodeInfo.getState().equalsIgnoreCase(filterState))) {
        continue;
      }
    }
    if ((healthState != null) && (!healthState.isEmpty())) {
      LOG.info("heatlh state is : " + healthState);
      if (!healthState.equalsIgnoreCase("true") && !healthState.equalsIgnoreCase("false")) {
        String msg="Error: You must specify either true or false to query on health";
        throw new BadRequestException(msg);
      }
      if (nodeInfo.isHealthy() != Boolean.parseBoolean(healthState)) {
        continue;
      }
    }
    allNodes.add(nodeInfo);
  }
  return allNodes;
}
