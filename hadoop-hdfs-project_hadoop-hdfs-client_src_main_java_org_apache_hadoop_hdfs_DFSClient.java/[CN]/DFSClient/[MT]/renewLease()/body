{
  if (clientRunning && !isFilesBeingWrittenEmpty()) {
    try {
      namenode.renewLease(clientName);
      updateLastLeaseRenewal();
      return true;
    }
 catch (    IOException e) {
      final long elapsed=Time.monotonicNow() - getLastLeaseRenewal();
      if (elapsed > HdfsConstants.LEASE_HARDLIMIT_PERIOD) {
        LOG.warn("Failed to renew lease for " + clientName + " for "+ (elapsed / 1000)+ " seconds (>= hard-limit ="+ (HdfsConstants.LEASE_HARDLIMIT_PERIOD / 1000)+ " seconds.) "+ "Closing all files being written ...",e);
        closeAllFilesBeingWritten(true);
      }
 else {
        throw e;
      }
    }
  }
  return false;
}
