{
  IOStreamPair pair=connectToDN(dn,dfsClientConf.getSocketTimeout(),lb.getBlockToken());
  try {
    new Sender((DataOutputStream)pair.out).readBlock(lb.getBlock(),lb.getBlockToken(),clientName,0,1,true,CachingStrategy.newDefaultStrategy());
    final BlockOpResponseProto reply=BlockOpResponseProto.parseFrom(PBHelperClient.vintPrefixed(pair.in));
    String logInfo="trying to read " + lb.getBlock() + " from datanode "+ dn;
    DataTransferProtoUtil.checkBlockOpStatus(reply,logInfo);
    return PBHelperClient.convert(reply.getReadOpChecksumInfo().getChecksum().getType());
  }
  finally {
    IOUtilsClient.cleanup(null,pair.in,pair.out);
  }
}
