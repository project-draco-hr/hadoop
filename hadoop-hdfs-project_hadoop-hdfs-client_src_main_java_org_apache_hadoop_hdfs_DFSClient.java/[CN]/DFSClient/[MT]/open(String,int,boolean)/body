{
  checkOpen();
  try (TraceScope ignored=newPathTraceScope("newDFSInputStream",src)){
    LocatedBlocks locatedBlocks=getLocatedBlocks(src,0);
    if (locatedBlocks != null) {
      ErasureCodingPolicy ecPolicy=locatedBlocks.getErasureCodingPolicy();
      if (ecPolicy != null) {
        return new DFSStripedInputStream(this,src,verifyChecksum,ecPolicy,locatedBlocks);
      }
      return new DFSInputStream(this,src,verifyChecksum,locatedBlocks);
    }
 else {
      throw new IOException("Cannot open filename " + src);
    }
  }
 }
