{
  boolean created=true;
  Path workDir=new Path(client.printWorkingDirectory());
  Path absolute=makeAbsolute(workDir,file);
  String pathName=absolute.getName();
  if (!exists(client,absolute)) {
    Path parent=absolute.getParent();
    created=(parent == null || mkdirs(client,parent,FsPermission.getDirDefault()));
    if (created) {
      String parentDir=parent.toUri().getPath();
      client.changeWorkingDirectory(parentDir);
      created=created && client.makeDirectory(pathName);
    }
  }
 else   if (isFile(client,absolute)) {
    throw new ParentNotDirectoryException(String.format("Can't make directory for path %s since it is a file.",absolute));
  }
  return created;
}
