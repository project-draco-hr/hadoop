{
  mkdirsWithExistsAndPermissionCheck(localFS,dir,expected);
  FileStatus stat=localFS.getFileStatus(dir);
  FsPermission actual=stat.getPermission();
  if (!stat.isDir())   throw new DiskErrorException("not a directory: " + dir.toString());
  FsAction user=actual.getUserAction();
  if (!user.implies(FsAction.READ))   throw new DiskErrorException("directory is not readable: " + dir.toString());
  if (!user.implies(FsAction.WRITE))   throw new DiskErrorException("directory is not writable: " + dir.toString());
  if (!user.implies(FsAction.EXECUTE))   throw new DiskErrorException("directory is not listable: " + dir.toString());
}
