{
  Configuration conf=getConfig();
  YarnRPC rpc=YarnRPC.create(conf);
  InetSocketAddress initialAddress=NetUtils.createSocketAddr(conf.get(YarnConfiguration.NM_ADDRESS,YarnConfiguration.DEFAULT_NM_ADDRESS),YarnConfiguration.DEFAULT_NM_PORT,YarnConfiguration.NM_ADDRESS);
  server=rpc.getServer(ContainerManager.class,this,initialAddress,conf,this.containerTokenSecretManager,conf.getInt(YarnConfiguration.NM_CONTAINER_MGR_THREAD_COUNT,YarnConfiguration.DEFAULT_NM_CONTAINER_MGR_THREAD_COUNT));
  if (conf.getBoolean(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHORIZATION,false)) {
    refreshServiceAcls(conf,new NMPolicyProvider());
  }
  server.start();
  try {
    resolvedAddress=InetAddress.getLocalHost();
  }
 catch (  UnknownHostException e) {
    throw new YarnException(e);
  }
  this.context.getNodeId().setHost(resolvedAddress.getCanonicalHostName());
  this.context.getNodeId().setPort(server.getPort());
  LOG.info("ContainerManager started at " + this.context.getNodeId().toString());
  super.start();
}
