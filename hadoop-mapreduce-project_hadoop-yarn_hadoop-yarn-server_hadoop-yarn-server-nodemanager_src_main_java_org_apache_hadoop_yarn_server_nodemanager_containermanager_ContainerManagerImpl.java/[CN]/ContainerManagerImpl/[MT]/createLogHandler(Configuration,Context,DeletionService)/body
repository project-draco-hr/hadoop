{
  if (conf.getBoolean(YarnConfiguration.NM_LOG_AGGREGATION_ENABLED,YarnConfiguration.DEFAULT_NM_LOG_AGGREGATION_ENABLED)) {
    return new LogAggregationService(this.dispatcher,context,deletionService,dirsHandler);
  }
 else {
    return new NonAggregatingLogHandler(this.dispatcher,deletionService,dirsHandler);
  }
}
