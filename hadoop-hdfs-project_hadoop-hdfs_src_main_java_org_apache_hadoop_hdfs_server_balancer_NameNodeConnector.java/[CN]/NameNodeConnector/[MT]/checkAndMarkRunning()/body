{
  try {
    if (fs.exists(idPath)) {
      IOUtils.closeStream(fs.append(idPath));
      fs.delete(idPath,true);
    }
    final FSDataOutputStream fsout=fs.create(idPath,false);
    fs.deleteOnExit(idPath);
    if (write2IdFile) {
      fsout.writeBytes(InetAddress.getLocalHost().getHostName());
      fsout.hflush();
    }
    return fsout;
  }
 catch (  RemoteException e) {
    if (AlreadyBeingCreatedException.class.getName().equals(e.getClassName())) {
      return null;
    }
 else {
      throw e;
    }
  }
}
