{
  RetryPolicy timeoutPolicy=RetryPolicies.exponentialBackoffRetry(5,200,TimeUnit.MILLISECONDS);
  Map<Class<? extends Exception>,RetryPolicy> exceptionToPolicyMap=new HashMap<Class<? extends Exception>,RetryPolicy>();
  RetryPolicy methodPolicy=RetryPolicies.retryByException(timeoutPolicy,exceptionToPolicyMap);
  Map<String,RetryPolicy> methodNameToPolicyMap=new HashMap<String,RetryPolicy>();
  methodNameToPolicyMap.put("getBlocks",methodPolicy);
  methodNameToPolicyMap.put("getAccessKeys",methodPolicy);
  return (NamenodeProtocol)RetryProxy.create(NamenodeProtocol.class,RPC.getProxy(NamenodeProtocol.class,NamenodeProtocol.versionID,address,UserGroupInformation.getCurrentUser(),conf,NetUtils.getDefaultSocketFactory(conf)),methodNameToPolicyMap);
}
