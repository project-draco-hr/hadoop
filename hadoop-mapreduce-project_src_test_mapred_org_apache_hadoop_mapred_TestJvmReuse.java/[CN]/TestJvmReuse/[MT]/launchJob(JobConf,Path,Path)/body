{
  FileSystem inFs=inDir.getFileSystem(conf);
  FileSystem outFs=outDir.getFileSystem(conf);
  outFs.delete(outDir,true);
  if (!inFs.mkdirs(inDir)) {
    throw new IOException("Mkdirs failed to create " + inDir.toString());
  }
  for (int i=0; i < numMappers; i++) {
    DataOutputStream file=inFs.create(new Path(inDir,"part-" + i));
    file.writeBytes("input");
    file.close();
  }
  conf.setMapperClass(MapperClass.class);
  conf.setNumReduceTasks(0);
  FileInputFormat.setInputPaths(conf,inDir);
  FileOutputFormat.setOutputPath(conf,outDir);
  conf.setNumTasksToExecutePerJvm(-1);
  return new JobClient(conf).submitJob(conf);
}
