{
  try {
    if (user != null && user.getRealUser() != null && (authMethod != AuthMethod.DIGEST)) {
      ProxyUsers.authorize(user,this.getHostAddress(),conf);
    }
    authorize(user,header);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Successfully authorized " + header);
    }
    rpcMetrics.authorizationSuccesses.inc();
  }
 catch (  AuthorizationException ae) {
    rpcMetrics.authorizationFailures.inc();
    authFailedCall.connection=this;
    setupResponse(authFailedResponse,authFailedCall,Status.FATAL,null,ae.getClass().getName(),ae.getMessage());
    responder.doRespond(authFailedCall);
    return false;
  }
  return true;
}
