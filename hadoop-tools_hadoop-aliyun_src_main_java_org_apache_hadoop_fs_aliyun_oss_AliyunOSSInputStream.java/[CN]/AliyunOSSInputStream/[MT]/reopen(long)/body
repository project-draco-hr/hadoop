{
  long partSize;
  if (pos < 0) {
    throw new EOFException("Cannot seek at negative position:" + pos);
  }
 else   if (pos > contentLength) {
    throw new EOFException("Cannot seek after EOF, contentLength:" + contentLength + " position:"+ pos);
  }
 else   if (pos + downloadPartSize > contentLength) {
    partSize=contentLength - pos;
  }
 else {
    partSize=downloadPartSize;
  }
  if (wrappedStream != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Aborting old stream to open at pos " + pos);
    }
    wrappedStream.close();
  }
  wrappedStream=store.retrieve(key,pos,pos + partSize - 1);
  if (wrappedStream == null) {
    throw new IOException("Null IO stream");
  }
  position=pos;
  partRemaining=partSize;
}
