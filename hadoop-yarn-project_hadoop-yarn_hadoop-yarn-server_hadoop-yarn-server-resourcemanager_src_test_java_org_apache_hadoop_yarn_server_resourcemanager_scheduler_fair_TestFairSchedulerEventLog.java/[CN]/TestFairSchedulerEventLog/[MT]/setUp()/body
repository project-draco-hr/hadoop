{
  scheduler=new FairScheduler();
  Configuration conf=new YarnConfiguration();
  conf.setClass(YarnConfiguration.RM_SCHEDULER,FairScheduler.class,ResourceScheduler.class);
  conf.set("yarn.scheduler.fair.event-log-enabled","true");
  conf.set(FairSchedulerConfiguration.ASSIGN_MULTIPLE,"false");
  resourceManager=new ResourceManager();
  resourceManager.init(conf);
  ((AsyncDispatcher)resourceManager.getRMContext().getDispatcher()).start();
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
}
