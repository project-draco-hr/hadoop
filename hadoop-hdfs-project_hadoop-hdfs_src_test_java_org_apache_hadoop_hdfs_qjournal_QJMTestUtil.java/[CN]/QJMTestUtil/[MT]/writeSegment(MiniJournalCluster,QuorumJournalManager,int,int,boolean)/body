{
  EditLogOutputStream stm=qjm.startLogSegment(startTxId);
  assertExistsInQuorum(cluster,NNStorage.getInProgressEditsFileName(startTxId));
  writeTxns(stm,startTxId,numTxns);
  if (finalize) {
    stm.close();
    qjm.finalizeLogSegment(startTxId,startTxId + numTxns - 1);
  }
}
