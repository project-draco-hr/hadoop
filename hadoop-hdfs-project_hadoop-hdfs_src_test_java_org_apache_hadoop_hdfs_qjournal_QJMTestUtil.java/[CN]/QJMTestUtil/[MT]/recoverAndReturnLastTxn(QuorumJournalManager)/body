{
  qjm.recoverUnfinalizedSegments();
  long lastRecoveredTxn=0;
  List<EditLogInputStream> streams=Lists.newArrayList();
  try {
    qjm.selectInputStreams(streams,0,false);
    for (    EditLogInputStream elis : streams) {
      assertTrue(elis.getFirstTxId() > lastRecoveredTxn);
      lastRecoveredTxn=elis.getLastTxId();
    }
  }
  finally {
    IOUtils.cleanup(null,streams.toArray(new Closeable[0]));
  }
  return lastRecoveredTxn;
}
