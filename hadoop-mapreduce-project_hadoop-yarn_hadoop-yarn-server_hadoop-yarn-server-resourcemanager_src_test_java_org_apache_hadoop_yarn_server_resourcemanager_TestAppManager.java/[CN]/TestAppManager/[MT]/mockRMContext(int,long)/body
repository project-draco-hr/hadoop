{
  final List<RMApp> apps=newRMApps(n,time,RMAppState.FINISHED);
  final ConcurrentMap<ApplicationId,RMApp> map=Maps.newConcurrentMap();
  for (  RMApp app : apps) {
    map.put(app.getApplicationId(),app);
  }
  Dispatcher rmDispatcher=new AsyncDispatcher();
  ContainerAllocationExpirer containerAllocationExpirer=new ContainerAllocationExpirer(rmDispatcher);
  AMLivelinessMonitor amLivelinessMonitor=new AMLivelinessMonitor(rmDispatcher);
  return new RMContextImpl(new MemStore(),rmDispatcher,containerAllocationExpirer,amLivelinessMonitor,null,null){
    @Override public ConcurrentMap<ApplicationId,RMApp> getRMApps(){
      return map;
    }
  }
;
}
