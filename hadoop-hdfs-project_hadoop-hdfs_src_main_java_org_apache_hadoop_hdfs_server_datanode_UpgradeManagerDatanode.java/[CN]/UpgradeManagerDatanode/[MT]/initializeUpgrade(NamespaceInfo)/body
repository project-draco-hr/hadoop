{
  if (!super.initializeUpgrade())   return;
  DataNode.LOG.info("\n   Distributed upgrade for DataNode " + dataNode.getDisplayName() + " version "+ getUpgradeVersion()+ " to current LV "+ HdfsConstants.LAYOUT_VERSION+ " is initialized.");
  UpgradeObjectDatanode curUO=(UpgradeObjectDatanode)currentUpgrades.first();
  curUO.setDatanode(dataNode,this.bpid);
  upgradeState=curUO.preUpgradeAction(nsInfo);
}
