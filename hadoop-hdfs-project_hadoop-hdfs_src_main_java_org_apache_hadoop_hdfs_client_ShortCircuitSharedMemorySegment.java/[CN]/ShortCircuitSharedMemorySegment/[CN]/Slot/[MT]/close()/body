{
  if (slotAddress == 0)   return;
  long prev;
  do {
    prev=unsafe.getLongVolatile(null,this.slotAddress);
    Preconditions.checkState((prev & SLOT_IN_USE_FLAG) != 0,"tried to close slot that wasn't open");
  }
 while (!unsafe.compareAndSwapLong(null,this.slotAddress,prev,0));
  slotAddress=0;
  if (ShortCircuitSharedMemorySegment.this.refCount.unreference()) {
    ShortCircuitSharedMemorySegment.this.free();
  }
}
