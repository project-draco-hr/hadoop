{
  testConf=new CapacitySchedulerConf();
  long pollingInterval=testConf.getSleepInterval();
  int maxWorker=testConf.getMaxWorkerThreads();
  assertTrue("Invalid polling interval ",pollingInterval > 0);
  assertTrue("Invalid working thread pool size",maxWorker > 0);
  openFile();
  startConfig();
  writeProperty("mapred.capacity-scheduler.init-worker-threads","1");
  writeProperty("mapred.capacity-scheduler.init-poll-interval","1");
  endConfig();
  testConf=new CapacitySchedulerConf(new Path(testConfFile));
  pollingInterval=testConf.getSleepInterval();
  maxWorker=testConf.getMaxWorkerThreads();
  assertEquals("Invalid polling interval ",pollingInterval,1);
  assertEquals("Invalid working thread pool size",maxWorker,1);
  openFile();
  startConfig();
  writeProperty("mapred.capacity-scheduler.init-worker-threads","0");
  writeProperty("mapred.capacity-scheduler.init-poll-interval","0");
  endConfig();
  testConf=new CapacitySchedulerConf(new Path(testConfFile));
  try {
    pollingInterval=testConf.getSleepInterval();
    fail("Polling interval configured is illegal");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    maxWorker=testConf.getMaxWorkerThreads();
    fail("Max worker thread configured is illegal");
  }
 catch (  IllegalArgumentException e) {
  }
}
