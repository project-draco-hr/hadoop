{
  Configuration conf=jobContext.getConfiguration();
  syncFolder=conf.getBoolean(DistCpConstants.CONF_LABEL_SYNC_FOLDERS,false);
  overwrite=conf.getBoolean(DistCpConstants.CONF_LABEL_OVERWRITE,false);
  targetPathExists=conf.getBoolean(DistCpConstants.CONF_LABEL_TARGET_PATH_EXISTS,true);
  super.commitJob(jobContext);
  cleanupTempFiles(jobContext);
  String attributes=conf.get(DistCpConstants.CONF_LABEL_PRESERVE_STATUS);
  final boolean preserveRawXattrs=conf.getBoolean(DistCpConstants.CONF_LABEL_PRESERVE_RAWXATTRS,false);
  if ((attributes != null && !attributes.isEmpty()) || preserveRawXattrs) {
    preserveFileAttributesForDirectories(conf);
  }
  try {
    if (conf.getBoolean(DistCpConstants.CONF_LABEL_DELETE_MISSING,false) && !(conf.getBoolean(DistCpConstants.CONF_LABEL_DIFF,false))) {
      deleteMissing(conf);
    }
 else     if (conf.getBoolean(DistCpConstants.CONF_LABEL_ATOMIC_COPY,false)) {
      commitData(conf);
    }
    taskAttemptContext.setStatus("Commit Successful");
  }
  finally {
    cleanup(conf);
  }
}
