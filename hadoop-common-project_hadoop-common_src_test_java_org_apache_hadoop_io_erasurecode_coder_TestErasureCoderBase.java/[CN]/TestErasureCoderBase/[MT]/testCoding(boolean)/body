{
  this.usingDirectBuffer=usingDirectBuffer;
  prepareCoders();
  ECBlockGroup blockGroup=prepareBlockGroupForEncoding();
  TestBlock[] clonedDataBlocks=cloneBlocksWithData((TestBlock[])blockGroup.getDataBlocks());
  TestBlock[] parityBlocks=(TestBlock[])blockGroup.getParityBlocks();
  ErasureCodingStep codingStep;
  codingStep=encoder.calculateCoding(blockGroup);
  performCodingStep(codingStep);
  TestBlock[] backupBlocks=backupAndEraseBlocks(clonedDataBlocks,parityBlocks);
  blockGroup=new ECBlockGroup(clonedDataBlocks,blockGroup.getParityBlocks());
  codingStep=decoder.calculateCoding(blockGroup);
  performCodingStep(codingStep);
  compareAndVerify(backupBlocks,codingStep.getOutputBlocks());
}
