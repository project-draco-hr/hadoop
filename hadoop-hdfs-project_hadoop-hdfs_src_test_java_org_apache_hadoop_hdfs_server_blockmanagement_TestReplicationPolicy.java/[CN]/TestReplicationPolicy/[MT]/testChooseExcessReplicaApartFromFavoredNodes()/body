{
  DatanodeStorageInfo[] targets;
  List<DatanodeDescriptor> expectedTargets=new ArrayList<DatanodeDescriptor>();
  expectedTargets.add(dataNodes[0]);
  expectedTargets.add(dataNodes[1]);
  expectedTargets.add(dataNodes[2]);
  expectedTargets.add(dataNodes[4]);
  expectedTargets.add(dataNodes[5]);
  List<DatanodeDescriptor> favouredNodes=new ArrayList<DatanodeDescriptor>();
  favouredNodes.add(dataNodes[0]);
  favouredNodes.add(dataNodes[1]);
  targets=chooseTarget(5,dataNodes[2],null,favouredNodes);
  assertEquals(targets.length,5);
  for (int i=0; i < targets.length; i++) {
    assertTrue("Target should be a part of Expected Targets",expectedTargets.contains(targets[i].getDatanodeDescriptor()));
  }
}
