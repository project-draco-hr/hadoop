{
  StringBuilder query=new StringBuilder();
  if (dbConf.getInputQuery() == null) {
    query.append("SELECT ");
    for (int i=0; i < fieldNames.length; i++) {
      query.append(fieldNames[i]);
      if (i != fieldNames.length - 1) {
        query.append(", ");
      }
    }
    query.append(" FROM ").append(tableName);
    query.append(" AS ").append(tableName);
    if (conditions != null && conditions.length() > 0) {
      query.append(" WHERE (").append(conditions).append(")");
    }
    String orderBy=dbConf.getInputOrderBy();
    if (orderBy != null && orderBy.length() > 0) {
      query.append(" ORDER BY ").append(orderBy);
    }
  }
 else {
    query.append(dbConf.getInputQuery());
  }
  try {
    query.append(" LIMIT ").append(split.getLength());
    query.append(" OFFSET ").append(split.getStart());
  }
 catch (  IOException ex) {
  }
  return query.toString();
}
