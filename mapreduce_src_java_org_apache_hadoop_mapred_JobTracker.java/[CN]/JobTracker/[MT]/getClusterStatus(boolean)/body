{
synchronized (taskTrackers) {
    if (detailed) {
      List<List<String>> trackerNames=taskTrackerNames();
      Collection<BlackListInfo> blackListedTrackers=getBlackListedTrackers();
      return new ClusterStatus(trackerNames.get(0),blackListedTrackers,tasktrackerExpiryInterval,totalMaps,totalReduces,totalMapTaskCapacity,totalReduceTaskCapacity,JobTrackerStatus.valueOf(state.name()),getExcludedNodes().size());
    }
 else {
      return new ClusterStatus(taskTrackers.size() - getBlacklistedTrackerCount(),getBlacklistedTrackerCount(),tasktrackerExpiryInterval,totalMaps,totalReduces,totalMapTaskCapacity,totalReduceTaskCapacity,JobTrackerStatus.valueOf(state.name()),getExcludedNodes().size());
    }
  }
}
