{
  markCompletedJob(job);
  JobEndNotifier.registerNotification(job.getJobConf(),job.getStatus());
  JobID id=job.getStatus().getJobID();
  try {
    jobHistory.markCompleted(id);
  }
 catch (  IOException ioe) {
    LOG.info("Failed to mark job " + id + " as completed!",ioe);
  }
  final JobTrackerInstrumentation metrics=getInstrumentation();
  metrics.finalizeJob(conf,id);
  addJobForCleanup(id);
  if (job.getStatus().getRunState() == JobStatus.SUCCEEDED) {
    if (job.getNoOfBlackListedTrackers() > 0) {
      for (      String hostName : job.getBlackListedTrackers()) {
        faultyTrackers.incrementFaults(hostName);
      }
    }
  }
}
