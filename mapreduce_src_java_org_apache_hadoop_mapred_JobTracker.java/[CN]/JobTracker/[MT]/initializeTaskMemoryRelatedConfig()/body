{
  memSizeForMapSlotOnJT=JobConf.normalizeMemoryConfigValue(conf.getLong(MAPMEMORY_MB,JobConf.DISABLED_MEMORY_LIMIT));
  memSizeForReduceSlotOnJT=JobConf.normalizeMemoryConfigValue(conf.getLong(REDUCEMEMORY_MB,JobConf.DISABLED_MEMORY_LIMIT));
  if (conf.get(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY) != null) {
    LOG.warn(JobConf.deprecatedString(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY) + " instead use " + JTConfig.JT_MAX_MAPMEMORY_MB+ " and "+ JTConfig.JT_MAX_REDUCEMEMORY_MB);
    limitMaxMemForMapTasks=limitMaxMemForReduceTasks=JobConf.normalizeMemoryConfigValue(conf.getLong(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY,JobConf.DISABLED_MEMORY_LIMIT));
    if (limitMaxMemForMapTasks != JobConf.DISABLED_MEMORY_LIMIT && limitMaxMemForMapTasks >= 0) {
      limitMaxMemForMapTasks=limitMaxMemForReduceTasks=limitMaxMemForMapTasks / (1024 * 1024);
    }
  }
 else {
    limitMaxMemForMapTasks=JobConf.normalizeMemoryConfigValue(conf.getLong(JTConfig.JT_MAX_MAPMEMORY_MB,JobConf.DISABLED_MEMORY_LIMIT));
    limitMaxMemForReduceTasks=JobConf.normalizeMemoryConfigValue(conf.getLong(JTConfig.JT_MAX_REDUCEMEMORY_MB,JobConf.DISABLED_MEMORY_LIMIT));
  }
  LOG.info(new StringBuilder().append("Scheduler configured with ").append("(memSizeForMapSlotOnJT, memSizeForReduceSlotOnJT,").append(" limitMaxMemForMapTasks, limitMaxMemForReduceTasks) (").append(memSizeForMapSlotOnJT).append(", ").append(memSizeForReduceSlotOnJT).append(", ").append(limitMaxMemForMapTasks).append(", ").append(limitMaxMemForReduceTasks).append(")"));
}
