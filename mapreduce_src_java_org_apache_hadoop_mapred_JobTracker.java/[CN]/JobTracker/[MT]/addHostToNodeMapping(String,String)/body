{
  Node node=null;
synchronized (nodesAtMaxLevel) {
    if ((node=clusterMap.getNode(networkLoc + "/" + host)) == null) {
      node=new NodeBase(host,networkLoc);
      clusterMap.add(node);
      if (node.getLevel() < getNumTaskCacheLevels()) {
        LOG.fatal("Got a host whose level is: " + node.getLevel() + "."+ " Should get at least a level of value: "+ getNumTaskCacheLevels());
        try {
          stopTracker();
        }
 catch (        IOException ie) {
          LOG.warn("Exception encountered during shutdown: " + StringUtils.stringifyException(ie));
          System.exit(-1);
        }
      }
      hostnameToNodeMap.put(host,node);
      nodesAtMaxLevel.add(getParentNode(node,getNumTaskCacheLevels() - 1));
    }
  }
  return node;
}
