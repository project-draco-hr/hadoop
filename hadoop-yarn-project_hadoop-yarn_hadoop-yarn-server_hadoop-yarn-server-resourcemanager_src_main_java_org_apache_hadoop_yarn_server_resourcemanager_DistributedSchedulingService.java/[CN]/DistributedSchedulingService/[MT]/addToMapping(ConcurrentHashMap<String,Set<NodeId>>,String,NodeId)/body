{
  if (rackName != null) {
    mapping.putIfAbsent(rackName,new HashSet<NodeId>());
    Set<NodeId> nodeIds=mapping.get(rackName);
synchronized (nodeIds) {
      nodeIds.add(nodeId);
    }
  }
}
