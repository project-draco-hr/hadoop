{
  String appId="APP_" + getNextId();
  Container container=mock(Container.class);
  ContainerLaunchContext context=mock(ContainerLaunchContext.class);
  HashMap<String,String> env=new HashMap<String,String>();
  org.apache.hadoop.yarn.api.records.Container containerAPI=mock(org.apache.hadoop.yarn.api.records.Container.class);
  when(container.getContainer()).thenReturn(containerAPI);
  when(container.getContainer().getId()).thenReturn(cId);
  when(container.getLaunchContext()).thenReturn(context);
  when(context.getEnvironment()).thenReturn(env);
  String script=writeScriptFile(cmd);
  Path scriptPath=new Path(script);
  Path tokensPath=new Path("/dev/null");
  Path workDir=new Path(workSpace.getAbsolutePath());
  Path pidFile=new Path(workDir,"pid.txt");
  exec.activateContainer(cId,pidFile);
  return exec.launchContainer(container,scriptPath,tokensPath,appSubmitter,appId,workDir,dirsHandler.getLocalDirs(),dirsHandler.getLogDirs());
}
