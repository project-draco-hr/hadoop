{
  files=FileContext.getLocalFSFileContext();
  Path workSpacePath=new Path(workSpace.getAbsolutePath());
  files.mkdir(workSpacePath,null,true);
  FileUtil.chmod(workSpace.getAbsolutePath(),"777");
  File localDir=new File(workSpace.getAbsoluteFile(),"localDir");
  files.mkdir(new Path(localDir.getAbsolutePath()),new FsPermission("777"),false);
  File logDir=new File(workSpace.getAbsoluteFile(),"logDir");
  files.mkdir(new Path(logDir.getAbsolutePath()),new FsPermission("777"),false);
  String exec_path=System.getProperty("container-executor.path");
  if (exec_path != null && !exec_path.isEmpty()) {
    conf=new Configuration(false);
    conf.setClass("fs.AbstractFileSystem.file.impl",org.apache.hadoop.fs.local.LocalFs.class,org.apache.hadoop.fs.AbstractFileSystem.class);
    conf.set(YarnConfiguration.NM_NONSECURE_MODE_LOCAL_USER_KEY,"xuan");
    LOG.info("Setting " + YarnConfiguration.NM_LINUX_CONTAINER_EXECUTOR_PATH + "="+ exec_path);
    conf.set(YarnConfiguration.NM_LINUX_CONTAINER_EXECUTOR_PATH,exec_path);
    exec=new LinuxContainerExecutor();
    exec.setConf(conf);
    conf.set(YarnConfiguration.NM_LOCAL_DIRS,localDir.getAbsolutePath());
    conf.set(YarnConfiguration.NM_LOG_DIRS,logDir.getAbsolutePath());
    dirsHandler=new LocalDirsHandlerService();
    dirsHandler.init(conf);
  }
  appSubmitter=System.getProperty("application.submitter");
  if (appSubmitter == null || appSubmitter.isEmpty()) {
    appSubmitter="nobody";
  }
}
