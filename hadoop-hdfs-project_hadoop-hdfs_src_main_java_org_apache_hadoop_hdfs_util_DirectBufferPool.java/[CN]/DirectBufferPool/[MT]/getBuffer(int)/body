{
  Queue<WeakReference<ByteBuffer>> list=buffersBySize.get(size);
  if (list == null) {
    return ByteBuffer.allocateDirect(size);
  }
  WeakReference<ByteBuffer> ref;
  while ((ref=list.poll()) != null) {
    ByteBuffer b=ref.get();
    if (b != null) {
      return b;
    }
  }
  return ByteBuffer.allocateDirect(size);
}
