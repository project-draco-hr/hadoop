{
  if (!inReset) {
    if (fileCache.isActive) {
      fileCache.createInDiskSegment();
    }
 else {
      memCache.createInMemorySegment();
    }
  }
  inReset=true;
  for (int i=0; i < segmentList.size(); i++) {
    Segment<K,V> s=segmentList.get(i);
    if (s.inMemory()) {
      int offset=(i == 0) ? firstSegmentOffset : 0;
      s.getReader().reset(offset);
    }
 else {
      s.closeReader();
      if (i == 0) {
        s.reinitReader(firstSegmentOffset);
        s.getReader().disableChecksumValidation();
      }
    }
  }
  currentKVOffset=firstSegmentOffset;
  nextKVOffset=-1;
  readSegmentIndex=0;
  hasMore=false;
  lastSegmentEOF=false;
  LOG.debug("Reset - First segment offset is " + firstSegmentOffset + " Segment List Size is "+ segmentList.size());
}
