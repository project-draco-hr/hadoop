{
  RLESparseResourceAllocation available=plan.getAvailableResourceOverTime(reservation.getUser(),reservation.getReservationId(),reservation.getStartTime(),reservation.getEndTime());
  try {
    RLESparseResourceAllocation.merge(plan.getResourceCalculator(),plan.getTotalCapacity(),available,reservation.getResourcesOverTime(),RLESparseResourceAllocation.RLEOperator.subtractTestNonNegative,reservation.getStartTime(),reservation.getEndTime());
  }
 catch (  PlanningException p) {
    throw new ResourceOverCommitException("Resources at time " + " would be overcommitted by " + "accepting reservation: "+ reservation.getReservationId());
  }
}
