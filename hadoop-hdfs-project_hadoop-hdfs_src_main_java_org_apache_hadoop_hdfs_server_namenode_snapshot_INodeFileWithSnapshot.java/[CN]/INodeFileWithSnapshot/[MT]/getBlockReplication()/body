{
  short max=isCurrentFileDeleted() ? 0 : getFileReplication();
  for (  FileDiff d : getDiffs()) {
    if (d.snapshotINode != null) {
      final short replication=d.snapshotINode.getFileReplication();
      if (replication > max) {
        max=replication;
      }
    }
  }
  return max;
}
