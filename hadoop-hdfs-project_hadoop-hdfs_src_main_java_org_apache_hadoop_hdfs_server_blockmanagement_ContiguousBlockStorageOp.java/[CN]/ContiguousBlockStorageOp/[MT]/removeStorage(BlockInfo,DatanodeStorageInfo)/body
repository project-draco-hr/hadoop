{
  int dnIndex=b.findStorageInfo(storage);
  if (dnIndex < 0) {
    return false;
  }
  Preconditions.checkArgument(b.getPrevious(dnIndex) == null && b.getNext(dnIndex) == null,"Block is still in the list and must be removed first.");
  int lastNode=b.numNodes() - 1;
  b.setStorageInfo(dnIndex,b.getStorageInfo(lastNode));
  b.setNext(dnIndex,b.getNext(lastNode));
  b.setPrevious(dnIndex,b.getPrevious(lastNode));
  b.setStorageInfo(lastNode,null);
  b.setNext(lastNode,null);
  b.setPrevious(lastNode,null);
  return true;
}
