{
  if (!FILE_SYSTEMS_LOADED) {
    loadFileSystems();
  }
  Class<? extends FileSystem> clazz=null;
  if (conf != null) {
    clazz=(Class<? extends FileSystem>)conf.getClass("fs." + scheme + ".impl",null);
  }
  if (clazz == null) {
    clazz=SERVICE_FILE_SYSTEMS.get(scheme);
  }
  if (clazz == null) {
    throw new IOException("No FileSystem for scheme: " + scheme);
  }
  return clazz;
}
