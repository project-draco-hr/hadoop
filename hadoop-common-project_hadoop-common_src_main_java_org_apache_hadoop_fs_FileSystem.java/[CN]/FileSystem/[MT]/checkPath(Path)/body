{
  URI uri=path.toUri();
  String thatScheme=uri.getScheme();
  if (thatScheme == null)   return;
  URI thisUri=getCanonicalUri();
  String thisScheme=thisUri.getScheme();
  if (thisScheme.equalsIgnoreCase(thatScheme)) {
    String thisAuthority=thisUri.getAuthority();
    String thatAuthority=uri.getAuthority();
    if (thatAuthority == null && thisAuthority != null) {
      URI defaultUri=getDefaultUri(getConf());
      if (thisScheme.equalsIgnoreCase(defaultUri.getScheme())) {
        uri=defaultUri;
      }
 else {
        uri=null;
      }
    }
    if (uri != null) {
      uri=NetUtils.getCanonicalUri(uri,getDefaultPort());
      thatAuthority=uri.getAuthority();
      if (thisAuthority == thatAuthority || (thisAuthority != null && thisAuthority.equalsIgnoreCase(thatAuthority)))       return;
    }
  }
  throw new IllegalArgumentException("Wrong FS: " + path + ", expected: "+ this.getUri());
}
