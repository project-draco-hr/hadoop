{
  URI uri=path.toUri();
  if (uri.getScheme() == null)   return;
  String thisScheme=this.getUri().getScheme();
  String thatScheme=uri.getScheme();
  String thisAuthority=this.getUri().getAuthority();
  String thatAuthority=uri.getAuthority();
  if (thisScheme.equalsIgnoreCase(thatScheme)) {
    if (thisAuthority == thatAuthority || (thisAuthority != null && thisAuthority.equalsIgnoreCase(thatAuthority)))     return;
    if (thatAuthority == null && thisAuthority != null) {
      URI defaultUri=getDefaultUri(getConf());
      if (thisScheme.equalsIgnoreCase(defaultUri.getScheme()) && thisAuthority.equalsIgnoreCase(defaultUri.getAuthority()))       return;
      try {
        defaultUri=get(getConf()).getUri();
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
      if (thisScheme.equalsIgnoreCase(defaultUri.getScheme()) && thisAuthority.equalsIgnoreCase(defaultUri.getAuthority()))       return;
    }
  }
  throw new IllegalArgumentException("Wrong FS: " + path + ", expected: "+ this.getUri());
}
