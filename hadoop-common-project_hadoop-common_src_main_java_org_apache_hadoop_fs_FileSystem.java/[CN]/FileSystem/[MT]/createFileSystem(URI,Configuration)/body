{
  TraceScope scope=Trace.startSpan("FileSystem#createFileSystem");
  Span span=scope.getSpan();
  if (span != null) {
    span.addKVAnnotation("scheme",uri.getScheme());
  }
  try {
    Class<?> clazz=getFileSystemClass(uri.getScheme(),conf);
    FileSystem fs=(FileSystem)ReflectionUtils.newInstance(clazz,conf);
    fs.initialize(uri,conf);
    return fs;
  }
  finally {
    scope.close();
  }
}
