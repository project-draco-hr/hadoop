{
  super(DataChecksum.newDataChecksum(DataChecksum.Type.CRC32,fs.getBytesPerSum()));
  this.datas=fs.getRawFs().createInternal(file,createFlag,absolutePermission,bufferSize,replication,blockSize,progress,checksumOpt,createParent);
  int bytesPerSum=fs.getBytesPerSum();
  int sumBufferSize=fs.getSumBufferSize(bytesPerSum,bufferSize);
  this.sums=fs.getRawFs().createInternal(fs.getChecksumFile(file),EnumSet.of(CreateFlag.CREATE,CreateFlag.OVERWRITE),absolutePermission,sumBufferSize,replication,blockSize,progress,checksumOpt,createParent);
  sums.write(CHECKSUM_VERSION,0,CHECKSUM_VERSION.length);
  sums.writeInt(bytesPerSum);
}
