{
  failureCounts.remove(mapId);
  hostFailures.remove(host.getHostName());
  int mapIndex=mapId.getTaskID().getId();
  if (!finishedMaps[mapIndex]) {
    output.commit();
    finishedMaps[mapIndex]=true;
    shuffledMapsCounter.increment(1);
    if (--remainingMaps == 0) {
      notifyAll();
    }
    totalBytesShuffledTillNow+=bytes;
    updateStatus();
    reduceShuffleBytes.increment(bytes);
    lastProgressTime=Time.monotonicNow();
    LOG.debug("map " + mapId + " done "+ status.getStateString());
  }
}
