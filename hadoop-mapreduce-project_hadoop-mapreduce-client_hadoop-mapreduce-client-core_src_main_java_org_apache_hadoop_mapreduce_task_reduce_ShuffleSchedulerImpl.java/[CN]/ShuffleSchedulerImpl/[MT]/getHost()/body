{
  while (pendingHosts.isEmpty()) {
    wait();
  }
  MapHost host=null;
  Iterator<MapHost> iter=pendingHosts.iterator();
  int numToPick=random.nextInt(pendingHosts.size());
  for (int i=0; i <= numToPick; ++i) {
    host=iter.next();
  }
  pendingHosts.remove(host);
  host.markBusy();
  LOG.info("Assigning " + host + " with "+ host.getNumKnownMapOutputs()+ " to "+ Thread.currentThread().getName());
  shuffleStart.set(System.currentTimeMillis());
  return host;
}
