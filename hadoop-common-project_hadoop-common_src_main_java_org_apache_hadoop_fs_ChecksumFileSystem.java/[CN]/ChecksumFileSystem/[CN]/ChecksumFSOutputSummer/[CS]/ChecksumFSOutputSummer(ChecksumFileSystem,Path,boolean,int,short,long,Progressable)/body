{
  super(DataChecksum.newDataChecksum(DataChecksum.Type.CRC32,fs.getBytesPerSum()));
  int bytesPerSum=fs.getBytesPerSum();
  this.datas=fs.getRawFileSystem().create(file,overwrite,bufferSize,replication,blockSize,progress);
  int sumBufferSize=fs.getSumBufferSize(bytesPerSum,bufferSize);
  this.sums=fs.getRawFileSystem().create(fs.getChecksumFile(file),true,sumBufferSize,replication,blockSize);
  sums.write(CHECKSUM_VERSION,0,CHECKSUM_VERSION.length);
  sums.writeInt(bytesPerSum);
}
