{
  Path parent=f.getParent();
  if (parent != null) {
    if (!createParent && !exists(parent)) {
      throw new FileNotFoundException("Parent directory doesn't exist: " + parent);
    }
 else     if (!mkdirs(parent)) {
      throw new IOException("Mkdirs failed to create " + parent);
    }
  }
  final FSDataOutputStream out=new FSDataOutputStream(new ChecksumFSOutputSummer(this,f,overwrite,bufferSize,replication,blockSize,progress),null);
  if (permission != null) {
    setPermission(f,permission);
  }
  return out;
}
