{
  if (fs.isDirectory(src)) {
    return fs.rename(src,dst);
  }
 else {
    if (fs.isDirectory(dst)) {
      dst=new Path(dst,src.getName());
    }
    boolean value=fs.rename(src,dst);
    if (!value)     return false;
    Path srcCheckFile=getChecksumFile(src);
    Path dstCheckFile=getChecksumFile(dst);
    if (fs.exists(srcCheckFile)) {
      value=fs.rename(srcCheckFile,dstCheckFile);
    }
 else     if (fs.exists(dstCheckFile)) {
      value=fs.delete(dstCheckFile,true);
    }
    return value;
  }
}
