def get_cluster_status(hdfsAddress, mapredAddress):
    'Determine the status of the cluster based on socket availability\n     of HDFS and Map/Reduce.'
    status = 0
    mapredSocket = tcpSocket(mapredAddress)
    try:
        mapredSocket.open()
        mapredSocket.close()
    except tcpError:
        status = 14
    hdfsSocket = tcpSocket(hdfsAddress)
    try:
        hdfsSocket.open()
        hdfsSocket.close()
    except tcpError:
        if (status > 0):
            status = 10
        else:
            status = 13
    return status
