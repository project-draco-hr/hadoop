def need_to_allocate(allocated, config, command):
    status = True
    if allocated.isSet():
        status = False
    elif (re.search('\\s*dfs.*$', command) and config['gridservice-hdfs']['external']):
        status = False
    elif config['gridservice-mapred']['external']:
        status = False
    return status
