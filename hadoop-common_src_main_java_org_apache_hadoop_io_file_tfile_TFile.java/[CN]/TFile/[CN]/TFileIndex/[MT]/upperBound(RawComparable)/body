{
  if (comparator == null) {
    throw new RuntimeException("Cannot search in unsorted TFile");
  }
  if (firstKey == null) {
    return -1;
  }
  int ret=Utils.upperBound(index,key,comparator);
  if (ret == index.size()) {
    return -1;
  }
  return ret;
}
