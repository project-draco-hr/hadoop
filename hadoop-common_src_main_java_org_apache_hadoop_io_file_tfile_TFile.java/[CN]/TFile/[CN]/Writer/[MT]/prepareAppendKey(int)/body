{
  if (state != State.READY) {
    throw new IllegalStateException("Incorrect state to start a new key: " + state.name());
  }
  initDataBlock();
  DataOutputStream ret=new KeyRegister(length);
  state=State.IN_KEY;
  return ret;
}
