{
  JobConf configuration=new JobConf();
  configuration.setLong(JobConf.MAPRED_JOB_MAP_MEMORY_MB_PROPERTY,1024);
  configuration.setLong(JobConf.MAPRED_JOB_REDUCE_MEMORY_MB_PROPERTY,1024);
  Assert.assertEquals(1024,configuration.getMemoryForMapTask());
  Assert.assertEquals(1024,configuration.getMemoryForReduceTask());
  configuration.setLong(JobConf.MAPREDUCE_JOB_MAP_MEMORY_MB_PROPERTY,1025);
  configuration.setLong(JobConf.MAPREDUCE_JOB_REDUCE_MEMORY_MB_PROPERTY,1025);
  Assert.assertEquals(1025,configuration.getMemoryForMapTask());
  Assert.assertEquals(1025,configuration.getMemoryForReduceTask());
  configuration.setMemoryForMapTask(2048);
  configuration.setMemoryForReduceTask(2048);
  Assert.assertEquals(2048,configuration.getLong(JobConf.MAPRED_JOB_MAP_MEMORY_MB_PROPERTY,-1));
  Assert.assertEquals(2048,configuration.getLong(JobConf.MAPRED_JOB_REDUCE_MEMORY_MB_PROPERTY,-1));
  Assert.assertEquals(2048,configuration.getLong(JobConf.MAPREDUCE_JOB_MAP_MEMORY_MB_PROPERTY,-1));
  Assert.assertEquals(2048,configuration.getLong(JobConf.MAPREDUCE_JOB_REDUCE_MEMORY_MB_PROPERTY,-1));
}
