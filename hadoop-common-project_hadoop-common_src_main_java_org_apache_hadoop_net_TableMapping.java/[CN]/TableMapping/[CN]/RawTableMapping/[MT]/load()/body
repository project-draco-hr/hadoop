{
  map.clear();
  String filename=getConf().get(NET_TOPOLOGY_TABLE_MAPPING_FILE_KEY,null);
  if (StringUtils.isBlank(filename)) {
    LOG.warn(NET_TOPOLOGY_TABLE_MAPPING_FILE_KEY + " not configured. " + NetworkTopology.DEFAULT_RACK+ " will be returned.");
    return;
  }
  BufferedReader reader=null;
  try {
    reader=new BufferedReader(new FileReader(filename));
    String line=reader.readLine();
    while (line != null) {
      line=line.trim();
      if (line.length() != 0 && line.charAt(0) != '#') {
        String[] columns=line.split("\\s+");
        if (columns.length == 2) {
          map.put(columns[0],columns[1]);
        }
 else {
          LOG.warn("Line does not have two columns. Ignoring. " + line);
        }
      }
      line=reader.readLine();
    }
  }
 catch (  Exception e) {
    LOG.warn(filename + " cannot be read. " + NetworkTopology.DEFAULT_RACK+ " will be returned.",e);
    map.clear();
  }
 finally {
    if (reader != null) {
      try {
        reader.close();
      }
 catch (      IOException e) {
        LOG.warn(filename + " cannot be read. " + NetworkTopology.DEFAULT_RACK+ " will be returned.",e);
        map.clear();
      }
    }
  }
}
