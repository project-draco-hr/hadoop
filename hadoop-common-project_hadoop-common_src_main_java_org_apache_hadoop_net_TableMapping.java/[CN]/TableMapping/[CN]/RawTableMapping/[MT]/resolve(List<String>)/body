{
  if (map == null) {
    map=load();
    if (map == null) {
      LOG.warn("Failed to read topology table. " + NetworkTopology.DEFAULT_RACK + " will be used for all nodes.");
      map=new HashMap<String,String>();
    }
  }
  List<String> results=new ArrayList<String>(names.size());
  for (  String name : names) {
    String result=map.get(name);
    if (result != null) {
      results.add(result);
    }
 else {
      results.add(NetworkTopology.DEFAULT_RACK);
    }
  }
  return results;
}
