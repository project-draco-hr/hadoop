{
  Path f=new Path(src);
  FileSystem srcFs=f.getFileSystem(getConf());
  FileStatus fstatus=null;
  try {
    fstatus=srcFs.getFileStatus(f);
    if (fstatus.isDirectory()) {
      throw new IOException("cannot create directory " + src + ": File exists");
    }
 else {
      throw new IOException(src + " exists but " + "is not a directory");
    }
  }
 catch (  FileNotFoundException e) {
    if (!srcFs.mkdirs(f)) {
      throw new IOException("failed to create " + src);
    }
  }
}
