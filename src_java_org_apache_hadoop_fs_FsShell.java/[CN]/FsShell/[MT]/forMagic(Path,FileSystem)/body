{
  FSDataInputStream i=srcFs.open(p);
switch (i.readShort()) {
case 0x1f8b:
    i.seek(0);
  return new GZIPInputStream(i);
case 0x5345:
if (i.readByte() == 'Q') {
  i.close();
  return new TextRecordInputStream(srcFs.getFileStatus(p));
}
break;
}
i.seek(0);
return i;
}
