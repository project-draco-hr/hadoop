{
  if (srcFs.getFileStatus(src).isFile()) {
    setFileReplication(src,srcFs,newRep,waitingList);
    return;
  }
  FileStatus items[]=srcFs.listStatus(src);
  try {
    items=srcFs.listStatus(src);
  }
 catch (  FileNotFoundException fnfe) {
    throw new IOException("Could not get listing for " + src);
  }
  for (int i=0; i < items.length; i++) {
    if (items[i].isFile()) {
      setFileReplication(items[i].getPath(),srcFs,newRep,waitingList);
    }
 else     if (items[i].isSymlink()) {
      throw new AssertionError("Symlinks unsupported");
    }
 else     if (recursive) {
      setReplication(newRep,srcFs,items[i].getPath(),recursive,waitingList);
    }
  }
}
