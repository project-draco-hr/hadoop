{
  if (!argv[i].startsWith("-") || argv[i].length() > 2)   throw new IOException("Not a flag: " + argv[i]);
  char flag=argv[i].toCharArray()[1];
  Path f=new Path(argv[++i]);
  FileSystem srcFs=f.getFileSystem(getConf());
switch (flag) {
case 'e':
    return srcFs.exists(f) ? 0 : 1;
case 'z':
  return srcFs.getFileStatus(f).getLen() == 0 ? 0 : 1;
case 'd':
return srcFs.getFileStatus(f).isDir() ? 0 : 1;
default :
throw new IOException("Unknown flag: " + flag);
}
}
