{
  cluster=new MiniYARNCluster("testDistributedSchedulingE2E",1,1,1);
  conf=new YarnConfiguration();
  conf.setBoolean(YarnConfiguration.AMRM_PROXY_ENABLED,true);
  conf.setBoolean(YarnConfiguration.DIST_SCHEDULING_ENABLED,true);
  conf.setBoolean(YarnConfiguration.NM_CONTAINER_QUEUING_ENABLED,true);
  cluster.init(conf);
  cluster.start();
  yarnConf=cluster.getConfig();
  yarnConf.set(YarnConfiguration.RM_SCHEDULER_ADDRESS,YarnConfiguration.DEFAULT_AMRM_PROXY_ADDRESS);
  rmClient=YarnClient.createYarnClient();
  rmClient.init(yarnConf);
  rmClient.start();
  attemptId=createApp(rmClient,cluster,conf);
  appId=attemptId.getApplicationId();
  client=createAMRMProtocol(rmClient,appId,cluster,yarnConf);
}
