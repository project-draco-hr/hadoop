@staticmethod
def get_clusters_with_role(role, state='running'):
    all_instances = EC2Connection().get_all_instances()
    clusters = []
    for res in all_instances:
        instance = res.instances[0]
        for group in res.groups:
            if (group.id.endswith(('-' + role)) and (instance.state == state)):
                clusters.append(re.sub(('-%s$' % re.escape(role)), '', group.id))
    return clusters
