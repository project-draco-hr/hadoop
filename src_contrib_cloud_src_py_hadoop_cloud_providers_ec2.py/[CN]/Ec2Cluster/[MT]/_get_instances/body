def _get_instances(self, group_name, state_filter=None):
    '\n    Get all the instances in a group, filtered by state.\n\n    @param group_name: the name of the group\n    @param state_filter: the state that the instance should be in\n      (e.g. "running"), or None for all states\n    '
    all_instances = self.ec2Connection.get_all_instances()
    instances = []
    for res in all_instances:
        for group in res.groups:
            if (group.id == group_name):
                for instance in res.instances:
                    if ((state_filter == None) or (instance.state == state_filter)):
                        instances.append(instance)
    return instances
