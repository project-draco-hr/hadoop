{
  RunJar runJar=spy(new RunJar());
  when(runJar.useClientClassLoader()).thenReturn(true);
  String mainCls=ClassLoaderCheckMain.class.getName();
  String thirdCls=ClassLoaderCheckThird.class.getName();
  String systemClasses="-" + mainCls + ","+ "-"+ thirdCls+ ","+ ApplicationClassLoader.DEFAULT_SYSTEM_CLASSES;
  when(runJar.getSystemClasses()).thenReturn(systemClasses);
  File testJar=makeClassLoaderTestJar(mainCls,thirdCls);
  String[] args=new String[3];
  args[0]=testJar.getAbsolutePath();
  args[1]=mainCls;
  runJar.run(args);
}
