{
  Assert.assertTrue(CALLED.contains("start"));
  FileSystem fs=FileSystem.get(miniDFS.getConfiguration(0));
  fs.mkdirs(new Path("/tmp"));
  fs.setPermission(new Path("/tmp"),new FsPermission((short)0777));
  UserGroupInformation ugi=UserGroupInformation.createUserForTesting("u1",new String[]{"g1"});
  ugi.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      FileSystem fs=FileSystem.get(miniDFS.getConfiguration(0));
      CALLED.clear();
      fs.mkdirs(new Path("/tmp/foo"));
      Assert.assertTrue(CALLED.contains("getAttributes"));
      Assert.assertTrue(CALLED.contains("checkPermission|null|null|null"));
      Assert.assertTrue(CALLED.contains("checkPermission|WRITE|null|null"));
      CALLED.clear();
      fs.listStatus(new Path("/tmp/foo"));
      Assert.assertTrue(CALLED.contains("getAttributes"));
      Assert.assertTrue(CALLED.contains("checkPermission|null|null|READ_EXECUTE"));
      CALLED.clear();
      fs.getAclStatus(new Path("/tmp/foo"));
      Assert.assertTrue(CALLED.contains("getAttributes"));
      Assert.assertTrue(CALLED.contains("checkPermission|null|null|null"));
      return null;
    }
  }
);
}
