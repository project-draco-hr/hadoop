{
  String accessKeyId;
  String accessKeySecret;
  String securityToken;
  try {
    accessKeyId=AliyunOSSUtils.getValueWithKey(conf,ACCESS_KEY_ID);
    accessKeySecret=AliyunOSSUtils.getValueWithKey(conf,ACCESS_KEY_SECRET);
  }
 catch (  IOException e) {
    throw new InvalidCredentialsException(e);
  }
  try {
    securityToken=AliyunOSSUtils.getValueWithKey(conf,SECURITY_TOKEN);
  }
 catch (  IOException e) {
    securityToken=null;
  }
  if (StringUtils.isEmpty(accessKeyId) || StringUtils.isEmpty(accessKeySecret)) {
    throw new InvalidCredentialsException("AccessKeyId and AccessKeySecret should not be null or empty.");
  }
  if (StringUtils.isNotEmpty(securityToken)) {
    credentials=new DefaultCredentials(accessKeyId,accessKeySecret,securityToken);
  }
 else {
    credentials=new DefaultCredentials(accessKeyId,accessKeySecret);
  }
}
