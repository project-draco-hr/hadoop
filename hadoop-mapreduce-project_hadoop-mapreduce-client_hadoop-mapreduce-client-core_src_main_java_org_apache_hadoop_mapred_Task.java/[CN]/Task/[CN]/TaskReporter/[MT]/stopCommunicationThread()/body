{
  if (pingThread != null) {
synchronized (lock) {
      lock.notify();
    }
synchronized (lock) {
      while (!done) {
        lock.wait();
      }
    }
    pingThread.interrupt();
    pingThread.join();
  }
}
