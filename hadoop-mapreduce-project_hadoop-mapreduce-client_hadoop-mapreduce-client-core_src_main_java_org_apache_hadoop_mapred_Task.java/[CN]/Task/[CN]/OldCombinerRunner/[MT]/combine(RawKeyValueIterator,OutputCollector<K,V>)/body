{
  Reducer<K,V,K,V> combiner=ReflectionUtils.newInstance(combinerClass,job);
  try {
    CombineValuesIterator<K,V> values=new CombineValuesIterator<K,V>(kvIter,comparator,keyClass,valueClass,job,reporter,inputCounter);
    while (values.more()) {
      combiner.reduce(values.getKey(),values,combineCollector,reporter);
      values.nextKey();
    }
  }
  finally {
    combiner.close();
  }
}
