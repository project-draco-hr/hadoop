{
  if (secretManagerInitialized == false) {
    throw new IllegalStateException("Secret manager not initialized");
  }
  ByteArrayInputStream buf=new ByteArrayInputStream(token.getIdentifier());
  DataInputStream dis=new DataInputStream(buf);
  RMDelegationTokenIdentifier id=secretManager.createIdentifier();
  try {
    id.readFields(dis);
    secretManager.verifyToken(id,token.getPassword());
  }
 catch (  Throwable t) {
    return null;
  }
 finally {
    dis.close();
  }
  return id.getUser();
}
