{
  Configuration conf=new Configuration();
  FakeProgressive progress=new FakeProgressive();
  conf.setClass(TTConfig.TT_RESOURCE_CALCULATOR_PLUGIN,DummyResourceCalculatorPlugin.class,ResourceCalculatorPlugin.class);
  conf.setClass(ResourceUsageMatcher.RESOURCE_USAGE_EMULATION_PLUGINS,TestResourceUsageEmulatorPlugin.class,ResourceUsageEmulatorPlugin.class);
  long currentTime=System.currentTimeMillis();
  TaskAttemptID id=new TaskAttemptID("test",1,TaskType.MAP,1,1);
  StatusReporter reporter=new DummyReporter(progress);
  TaskInputOutputContext context=new MapContextImpl(conf,id,null,null,null,reporter,null);
  FakeResourceUsageMatcherRunner matcher=new FakeResourceUsageMatcherRunner(context,null);
  String identifier=TestResourceUsageEmulatorPlugin.DEFAULT_IDENTIFIER;
  long initTime=TestResourceUsageEmulatorPlugin.testInitialization(identifier,conf);
  assertTrue("ResourceUsageMatcherRunner failed to initialize the" + " configured plugin",initTime > currentTime);
  assertEquals("Progress mismatch in ResourceUsageMatcherRunner",0,progress.getProgress(),0D);
  progress.setProgress(0.01f);
  currentTime=System.currentTimeMillis();
  matcher.test();
  long emulateTime=TestResourceUsageEmulatorPlugin.testEmulation(identifier,conf);
  assertTrue("ProgressBasedResourceUsageMatcher failed to load and emulate" + " the configured plugin",emulateTime > currentTime);
}
