{
  try {
    JobStatus oldStatus=(JobStatus)jip.getStatus().clone();
    jip.initTasks();
    if (jip.isJobEmpty()) {
      completeEmptyJob(jip);
    }
 else     if (!jip.isSetupCleanupRequired()) {
      jip.completeSetup();
    }
    JobStatus newStatus=(JobStatus)jip.getStatus().clone();
    JobStatusChangeEvent event=new JobStatusChangeEvent(jip,JobStatusChangeEvent.EventType.RUN_STATE_CHANGED,oldStatus,newStatus);
    for (    JobInProgressListener listener : listeners) {
      listener.jobUpdated(event);
    }
  }
 catch (  Exception ioe) {
    failJob(jip);
  }
}
