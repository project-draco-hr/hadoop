{
  FileStatus targetFileStatus=targetFS.getFileStatus(path);
  String group=targetFileStatus.getGroup();
  String user=targetFileStatus.getOwner();
  boolean chown=false;
  if (attributes.contains(FileAttribute.PERMISSION) && !srcFileStatus.getPermission().equals(targetFileStatus.getPermission())) {
    targetFS.setPermission(path,srcFileStatus.getPermission());
  }
  if (attributes.contains(FileAttribute.REPLICATION) && !targetFileStatus.isDirectory() && srcFileStatus.getReplication() != targetFileStatus.getReplication()) {
    targetFS.setReplication(path,srcFileStatus.getReplication());
  }
  if (attributes.contains(FileAttribute.GROUP) && !group.equals(srcFileStatus.getGroup())) {
    group=srcFileStatus.getGroup();
    chown=true;
  }
  if (attributes.contains(FileAttribute.USER) && !user.equals(srcFileStatus.getOwner())) {
    user=srcFileStatus.getOwner();
    chown=true;
  }
  if (chown) {
    targetFS.setOwner(path,user,group);
  }
}
