{
  LOG.info("Starting reconfiguration task.");
  Configuration oldConf=this.parent.getConf();
  Configuration newConf=this.parent.getNewConf();
  Collection<PropertyChange> changes=this.parent.getChangedProperties(newConf,oldConf);
  Map<PropertyChange,Optional<String>> results=Maps.newHashMap();
  for (  PropertyChange change : changes) {
    String errorMessage=null;
    if (!this.parent.isPropertyReconfigurable(change.prop)) {
      LOG.info(String.format("Property %s is not configurable: old value: %s, new value: %s",change.prop,change.oldVal,change.newVal));
      continue;
    }
    LOG.info("Change property: " + change.prop + " from \""+ ((change.oldVal == null) ? "<default>" : change.oldVal)+ "\" to \""+ ((change.newVal == null) ? "<default>" : change.newVal)+ "\".");
    try {
      this.parent.reconfigurePropertyImpl(change.prop,change.newVal);
    }
 catch (    ReconfigurationException e) {
      errorMessage=e.getCause().getMessage();
    }
    results.put(change,Optional.fromNullable(errorMessage));
  }
synchronized (this.parent.reconfigLock) {
    this.parent.endTime=Time.now();
    this.parent.status=Collections.unmodifiableMap(results);
    this.parent.reconfigThread=null;
  }
}
