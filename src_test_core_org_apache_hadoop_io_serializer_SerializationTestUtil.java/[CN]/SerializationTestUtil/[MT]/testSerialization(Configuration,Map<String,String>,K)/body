{
  SerializationFactory factory=new SerializationFactory(conf);
  SerializerBase<K> serializer=factory.getSerializer(metadata);
  DeserializerBase<K> deserializer=factory.getDeserializer(metadata);
  DataOutputBuffer out=new DataOutputBuffer();
  serializer.open(out);
  serializer.serialize(before);
  serializer.close();
  DataInputBuffer in=new DataInputBuffer();
  in.reset(out.getData(),out.getLength());
  deserializer.open(in);
  K after=deserializer.deserialize(null);
  deserializer.close();
  return after;
}
