def launch_cluster(self, instance_templates, config_dir, client_cidr):
    number_of_tasktrackers = 0
    roles = []
    for it in instance_templates:
        roles.extend(it.roles)
        if (TASKTRACKER in it.roles):
            number_of_tasktrackers += it.number
    self._launch_cluster_instances(instance_templates)
    self._create_client_hadoop_site_file(config_dir)
    self._authorize_client_ports(client_cidr)
    self._attach_storage(roles)
    self._update_cluster_membership(instance_templates[0].public_key, instance_templates[0].private_key)
    try:
        self._wait_for_hadoop(number_of_tasktrackers)
    except TimeoutException:
        print ('Timeout while waiting for Hadoop to start. Please check logs on' + ' cluster.')
    self._print_master_url()
