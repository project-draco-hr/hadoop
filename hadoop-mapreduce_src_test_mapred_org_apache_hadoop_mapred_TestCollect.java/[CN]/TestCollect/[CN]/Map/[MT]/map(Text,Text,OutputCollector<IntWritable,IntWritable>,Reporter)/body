{
class CollectFeeder extends Thread {
    int id;
    public CollectFeeder(    int id){
      this.id=id;
    }
    public void run(){
      for (int j=1; j <= NUM_COLLECTS_PER_THREAD; j++) {
        try {
          out.collect(new IntWritable((id * NUM_COLLECTS_PER_THREAD) + j),new IntWritable(0));
        }
 catch (        IOException ioe) {
        }
      }
    }
  }
  CollectFeeder[] feeders=new CollectFeeder[NUM_FEEDERS];
  for (int i=0; i < NUM_FEEDERS; i++) {
    feeders[i]=new CollectFeeder(i);
    feeders[i].start();
  }
  for (int i=0; i < NUM_FEEDERS; i++) {
    try {
      feeders[i].join();
    }
 catch (    InterruptedException ie) {
      throw new IOException(ie.toString());
    }
  }
}
