{
  if (rmContainer == null) {
    rmContainer=new RMContainerImpl(container,getApplicationAttemptId(),node.getNodeID(),appSchedulingInfo.getUser(),rmContext);
    Resources.addTo(currentReservation,container.getResource());
    resetReReservations(priority);
  }
 else {
    addReReservation(priority);
  }
  rmContainer.handle(new RMContainerReservedEvent(container.getId(),container.getResource(),node.getNodeID(),priority));
  Map<NodeId,RMContainer> reservedContainers=this.reservedContainers.get(priority);
  if (reservedContainers == null) {
    reservedContainers=new HashMap<NodeId,RMContainer>();
    this.reservedContainers.put(priority,reservedContainers);
  }
  reservedContainers.put(node.getNodeID(),rmContainer);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Application attempt " + getApplicationAttemptId() + " reserved container "+ rmContainer+ " on node "+ node+ ". This attempt currently has "+ reservedContainers.size()+ " reserved containers at priority "+ priority+ "; currentReservation "+ currentReservation.getMemory());
  }
  return rmContainer;
}
