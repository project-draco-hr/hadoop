{
  SupportsBlocks=true;
  cluster=new MiniDFSCluster.Builder(CONF).numNameNodes(2).numDataNodes(2).build();
  cluster.waitClusterUp();
  NameNodeAdapter.getDtSecretManager(cluster.getNamesystem(0)).startThreads();
  NameNodeAdapter.getDtSecretManager(cluster.getNamesystem(1)).startThreads();
  fHdfs=cluster.getFileSystem(0);
  fHdfs2=cluster.getFileSystem(1);
  defaultWorkingDirectory=fHdfs.makeQualified(new Path("/user/" + UserGroupInformation.getCurrentUser().getShortUserName()));
  defaultWorkingDirectory2=fHdfs2.makeQualified(new Path("/user/" + UserGroupInformation.getCurrentUser().getShortUserName()));
  fHdfs.mkdirs(defaultWorkingDirectory);
  fHdfs2.mkdirs(defaultWorkingDirectory2);
}
