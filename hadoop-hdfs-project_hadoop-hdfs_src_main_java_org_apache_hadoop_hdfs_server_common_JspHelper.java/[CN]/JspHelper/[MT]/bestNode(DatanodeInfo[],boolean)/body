{
  if (nodes == null || nodes.length == 0) {
    throw new IOException("No nodes contain this block");
  }
  int l=0;
  while (l < nodes.length && !nodes[l].isDecommissioned()) {
    ++l;
  }
  if (l == 0) {
    throw new IOException("No active nodes contain this block");
  }
  int index=doRandom ? DFSUtil.getRandom().nextInt(l) : 0;
  return nodes[index];
}
