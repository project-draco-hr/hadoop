{
  String remoteAddr=request.getRemoteAddr();
  String proxyHeader=request.getHeader("X-Forwarded-For");
  if (proxyHeader != null && ProxyServers.isProxyServer(remoteAddr)) {
    final String clientAddr=proxyHeader.split(",")[0].trim();
    if (!clientAddr.isEmpty()) {
      remoteAddr=clientAddr;
    }
  }
  return remoteAddr;
}
