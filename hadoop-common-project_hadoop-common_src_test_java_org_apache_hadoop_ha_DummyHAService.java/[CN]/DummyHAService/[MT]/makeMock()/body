{
  return Mockito.spy(new HAServiceProtocol(){
    @Override public void monitorHealth() throws HealthCheckFailedException, AccessControlException, IOException {
    }
    @Override public void transitionToActive() throws ServiceFailedException, AccessControlException, IOException {
      state=HAServiceState.ACTIVE;
    }
    @Override public void transitionToStandby() throws ServiceFailedException, AccessControlException, IOException {
      state=HAServiceState.STANDBY;
    }
    @Override public HAServiceStatus getServiceStatus() throws IOException {
      HAServiceStatus ret=new HAServiceStatus(state);
      if (state == HAServiceState.STANDBY) {
        ret.setReadyToBecomeActive();
      }
      return ret;
    }
  }
);
}
