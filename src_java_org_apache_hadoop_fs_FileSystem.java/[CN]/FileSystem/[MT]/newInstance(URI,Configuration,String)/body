{
  UserGroupInformation ugi;
  if (user == null) {
    ugi=UserGroupInformation.getCurrentUser();
  }
 else {
    ugi=UserGroupInformation.createRemoteUser(user);
  }
  return ugi.doAs(new PrivilegedExceptionAction<FileSystem>(){
    public FileSystem run() throws IOException {
      return newInstance(uri,conf);
    }
  }
);
}
