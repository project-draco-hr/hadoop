{
  final long original=summary.getCounts().get(Content.DISKSPACE);
  long oldYieldCount=summary.getYieldCount();
  dir.computeDirectoryContentSummary(summary,Snapshot.CURRENT_STATE_ID);
  if (oldYieldCount == summary.getYieldCount()) {
    checkDiskspace(dir,summary.getCounts().get(Content.DISKSPACE) - original);
  }
  return summary;
}
