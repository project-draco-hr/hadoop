{
  return Guice.createInjector(new TestServletModule(){
    @Override protected void configureServlets(){
      isKerberosAuth=true;
      rmconf.set(CommonConfigurationKeysPublic.HADOOP_SECURITY_AUTHENTICATION,"kerberos");
      rmconf.set(YarnConfiguration.RM_WEBAPP_SPNEGO_USER_NAME_KEY,httpSpnegoPrincipal);
      rmconf.set(YarnConfiguration.RM_WEBAPP_SPNEGO_KEYTAB_FILE_KEY,httpSpnegoKeytabFile.getAbsolutePath());
      rmconf.set(YarnConfiguration.NM_WEBAPP_SPNEGO_USER_NAME_KEY,httpSpnegoPrincipal);
      rmconf.set(YarnConfiguration.NM_WEBAPP_SPNEGO_KEYTAB_FILE_KEY,httpSpnegoKeytabFile.getAbsolutePath());
      super.configureServlets();
    }
  }
);
}
