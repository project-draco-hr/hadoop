{
  final int effectiveReplication=nodes.size();
  List<DatanodeDescriptor> targets=new ArrayList<DatanodeDescriptor>(effectiveReplication);
  Collections.shuffle(nodes);
  final int additionalTargetsNeeded=effectiveReplication - replication;
  int chosen=0;
  while (chosen < additionalTargetsNeeded && !nodes.isEmpty()) {
    targets.add(nodes.get(chosen));
    chosen++;
  }
  return targets;
}
