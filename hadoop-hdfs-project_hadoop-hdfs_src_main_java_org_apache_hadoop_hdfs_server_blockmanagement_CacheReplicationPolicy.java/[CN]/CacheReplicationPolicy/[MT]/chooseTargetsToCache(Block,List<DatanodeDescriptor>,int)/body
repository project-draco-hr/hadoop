{
  List<DatanodeDescriptor> sufficient=selectSufficientCapacity(block,targets);
  List<DatanodeDescriptor> chosen=new ArrayList<DatanodeDescriptor>(numTargets);
  for (int i=0; i < numTargets && !sufficient.isEmpty(); i++) {
    DatanodeDescriptor choice=randomDatanodeByRemainingCache(block,sufficient);
    chosen.add(choice);
    sufficient.remove(choice);
  }
  return chosen;
}
