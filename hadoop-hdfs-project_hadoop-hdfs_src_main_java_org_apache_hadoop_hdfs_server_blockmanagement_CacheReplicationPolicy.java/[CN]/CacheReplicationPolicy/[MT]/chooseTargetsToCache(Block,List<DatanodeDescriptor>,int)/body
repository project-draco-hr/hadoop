{
  List<DatanodeDescriptor> sufficient=selectSufficientCapacity(block,targets);
  List<DatanodeDescriptor> chosen=new ArrayList<DatanodeDescriptor>(numTargets);
  for (int i=0; i < numTargets && !sufficient.isEmpty(); i++) {
    chosen.add(randomDatanodeByRemainingCache(block,sufficient));
  }
  return chosen;
}
