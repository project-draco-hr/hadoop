{
  long activeTxId=active.getNamesystem().getFSImage().getEditLog().getLastWrittenTxId();
  active.getRpcServer().rollEditLog();
  long start=System.currentTimeMillis();
  while (System.currentTimeMillis() - start < NN_LAG_TIMEOUT) {
    long nn2HighestTxId=standby.getNamesystem().getFSImage().getLastAppliedTxId();
    if (nn2HighestTxId >= activeTxId) {
      return;
    }
    Thread.sleep(SLEEP_TIME);
  }
  Assert.fail("Standby did not catch up to txid " + activeTxId + " (currently at "+ standby.getNamesystem().getFSImage().getLastAppliedTxId()+ ")");
}
