{
  this.resourceTracker=getRMClient();
  LOG.info("Connecting to ResourceManager at " + this.rmAddress);
  RegisterNodeManagerRequest request=recordFactory.newRecordInstance(RegisterNodeManagerRequest.class);
  request.setHttpPort(this.httpPort);
  request.setResource(this.totalResource);
  request.setNodeId(this.nodeId);
  RegistrationResponse regResponse=this.resourceTracker.registerNodeManager(request).getRegistrationResponse();
  if (NodeAction.SHUTDOWN.equals(regResponse.getNodeAction())) {
    throw new YarnException("Recieved SHUTDOWN signal from Resourcemanager ,Registration of NodeManager failed");
  }
  if (UserGroupInformation.isSecurityEnabled()) {
    this.secretKeyBytes=regResponse.getSecretKey().array();
  }
  if (UserGroupInformation.isSecurityEnabled()) {
    LOG.info("Security enabled - updating secret keys now");
    this.containerTokenSecretManager.setSecretKey(this.nodeId.toString(),this.getRMNMSharedSecret());
  }
  LOG.info("Registered with ResourceManager as " + this.nodeId + " with total resource of "+ this.totalResource);
}
