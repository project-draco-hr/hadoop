{
  this.monitoringInterval=conf.getLong(YarnConfiguration.NM_CONTAINER_MON_INTERVAL_MS,YarnConfiguration.DEFAULT_NM_CONTAINER_MON_INTERVAL_MS);
  Class<? extends ResourceCalculatorPlugin> clazz=conf.getClass(YarnConfiguration.NM_CONTAINER_MON_RESOURCE_CALCULATOR,null,ResourceCalculatorPlugin.class);
  this.resourceCalculatorPlugin=ResourceCalculatorPlugin.getResourceCalculatorPlugin(clazz,conf);
  LOG.info(" Using ResourceCalculatorPlugin : " + this.resourceCalculatorPlugin);
  long totalPhysicalMemoryOnNM=DISABLED_MEMORY_LIMIT;
  if (this.resourceCalculatorPlugin != null) {
    totalPhysicalMemoryOnNM=this.resourceCalculatorPlugin.getPhysicalMemorySize();
    if (totalPhysicalMemoryOnNM <= 0) {
      LOG.warn("NodeManager's totalPmem could not be calculated. " + "Setting it to " + DISABLED_MEMORY_LIMIT);
      totalPhysicalMemoryOnNM=DISABLED_MEMORY_LIMIT;
    }
  }
  this.maxVmemAllottedForContainers=conf.getLong(YarnConfiguration.NM_VMEM_GB,YarnConfiguration.DEFAULT_NM_VMEM_GB);
  this.maxVmemAllottedForContainers=this.maxVmemAllottedForContainers * 1024 * 1024* 1024L;
  if (this.maxVmemAllottedForContainers > totalPhysicalMemoryOnNM) {
    LOG.info("totalMemoryAllottedForContainers > totalPhysicalMemoryOnNM." + " Thrashing might happen.");
  }
  long reservedPmemOnNM=conf.getLong(YarnConfiguration.NM_RESERVED_MEMORY_MB,DISABLED_MEMORY_LIMIT);
  reservedPmemOnNM=reservedPmemOnNM == DISABLED_MEMORY_LIMIT ? DISABLED_MEMORY_LIMIT : reservedPmemOnNM * 1024 * 1024;
  if (reservedPmemOnNM == DISABLED_MEMORY_LIMIT || totalPhysicalMemoryOnNM == DISABLED_MEMORY_LIMIT) {
    this.maxPmemAllottedForContainers=DISABLED_MEMORY_LIMIT;
  }
 else {
    this.maxPmemAllottedForContainers=totalPhysicalMemoryOnNM - reservedPmemOnNM;
  }
  super.init(conf);
}
