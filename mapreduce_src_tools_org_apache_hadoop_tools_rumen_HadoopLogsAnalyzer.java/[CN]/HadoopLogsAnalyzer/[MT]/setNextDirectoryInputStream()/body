{
  if (input != null) {
    input.close();
    LOG.info("File closed: " + currentFileName);
    input=null;
  }
  if (inputCodec != null) {
    CodecPool.returnDecompressor(inputDecompressor);
    inputDecompressor=null;
    inputCodec=null;
  }
  ++inputDirectoryCursor;
  if (inputDirectoryCursor >= inputDirectoryFiles.length) {
    return false;
  }
  fileFirstLine=true;
  currentFileName=inputDirectoryFiles[inputDirectoryCursor];
  LOG.info("\nOpening file " + currentFileName + "  *************************** .");
  LOG.info("This file, " + (inputDirectoryCursor + 1) + "/"+ inputDirectoryFiles.length+ ", starts with line "+ lineNumber+ ".");
  input=maybeUncompressedPath(new Path(inputDirectoryPath,currentFileName));
  return input != null;
}
