{
  final int numDNs=NUM_DATA_BLOCKS + NUM_PARITY_BLOCKS;
  if (ErasureCodeNative.isNativeCodeLoaded()) {
    conf.set(CommonConfigurationKeys.IO_ERASURECODE_CODEC_RS_DEFAULT_RAWCODER_KEY,NativeRSRawErasureCoderFactory.class.getCanonicalName());
  }
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDNs).build();
  cluster.waitActive();
  dfs=cluster.getFileSystem();
  dfs.mkdirs(dir);
  dfs.setErasureCodingPolicy(dir,null);
}
