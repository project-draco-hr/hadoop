{
  final int length=NUM_DATA_BLOCKS * (BLOCK_SIZE - CELL_SIZE);
  final HdfsConfiguration conf=newHdfsConfiguration();
  conf.setBoolean(DFSConfigKeys.DFS_BLOCK_ACCESS_TOKEN_ENABLE_KEY,true);
  conf.setInt(CommonConfigurationKeysPublic.IPC_CLIENT_CONNECT_MAX_RETRIES_KEY,0);
  conf.setInt(HdfsClientConfigKeys.Retry.WINDOW_BASE_KEY,10);
  for (int dn=0; dn < NUM_DATA_BLOCKS + NUM_PARITY_BLOCKS; dn+=2) {
    try {
      setup(conf);
      runTest(length,new int[]{length / 2},new int[]{dn},true);
    }
 catch (    Exception e) {
      LOG.error("failed, dn=" + dn + ", length="+ length);
      throw e;
    }
 finally {
      tearDown();
    }
  }
}
