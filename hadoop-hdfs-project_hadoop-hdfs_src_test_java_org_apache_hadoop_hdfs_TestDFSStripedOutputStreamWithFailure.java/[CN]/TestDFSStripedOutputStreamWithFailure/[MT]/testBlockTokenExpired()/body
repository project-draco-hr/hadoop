{
  final int length=NUM_DATA_BLOCKS * (BLOCK_SIZE - CELL_SIZE);
  HdfsConfiguration conf=new HdfsConfiguration();
  initConf(conf);
  initConfWithBlockToken(conf);
  for (int dn=0; dn < 9; dn+=2) {
    try {
      setup(conf);
      cluster.startDataNodes(conf,1,true,null,null);
      cluster.waitActive();
      runTest(new Path(dir,"file" + dn),length,length / 2,dn,true);
    }
 catch (    Exception e) {
      LOG.error("failed, dn=" + dn + ", length="+ length);
      throw e;
    }
 finally {
      tearDown();
    }
  }
}
