{
  for (; ; ) {
    DatanodeInfo[] datanodes=streamer.getNodes();
    if (datanodes == null) {
      final LocatedBlock lb=streamer.peekFollowingBlock();
      if (lb != null) {
        datanodes=lb.getLocations();
      }
    }
    if (datanodes != null) {
      Assert.assertEquals(1,datanodes.length);
      Assert.assertNotNull(datanodes[0]);
      return datanodes[0];
    }
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException ie) {
      Assert.fail(StringUtils.stringifyException(ie));
      return null;
    }
  }
}
