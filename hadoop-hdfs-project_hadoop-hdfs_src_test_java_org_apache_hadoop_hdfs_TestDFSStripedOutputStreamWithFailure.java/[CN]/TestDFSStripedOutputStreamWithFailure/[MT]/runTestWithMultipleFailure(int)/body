{
  final HdfsConfiguration conf=newHdfsConfiguration();
  for (int i=0; i < dnIndexSuite.length; i++) {
    int[] dnIndex=dnIndexSuite[i];
    int[] killPos=getKillPositions(length,dnIndex.length);
    try {
      setup(conf);
      runTest(length,killPos,dnIndex,false);
    }
 catch (    Throwable e) {
      final String err="failed, killPos=" + Arrays.toString(killPos) + ", dnIndex="+ Arrays.toString(dnIndex)+ ", length="+ length;
      LOG.error(err);
      throw e;
    }
 finally {
      tearDown();
    }
  }
}
