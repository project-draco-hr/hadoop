{
  final HdfsConfiguration conf=newHdfsConfiguration();
  for (int dn=0; dn < 9; dn++) {
    try {
      setup(conf);
      runTest(length,new int[]{length / 2},new int[]{dn},false);
    }
 catch (    Throwable e) {
      final String err="failed, dn=" + dn + ", length="+ length+ StringUtils.stringifyException(e);
      LOG.error(err);
      Assert.fail(err);
    }
 finally {
      tearDown();
    }
  }
}
