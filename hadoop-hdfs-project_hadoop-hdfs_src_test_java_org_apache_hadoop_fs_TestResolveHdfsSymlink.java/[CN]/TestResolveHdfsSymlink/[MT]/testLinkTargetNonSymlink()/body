{
  FileContext fc=null;
  Path notSymlink=new Path("/notasymlink");
  try {
    fc=FileContext.getFileContext(cluster.getFileSystem().getUri());
    fc.create(notSymlink,EnumSet.of(CreateFlag.CREATE));
    DFSClient client=new DFSClient(cluster.getFileSystem().getUri(),cluster.getConfiguration(0));
    try {
      client.getLinkTarget(notSymlink.toString());
      fail("Expected exception for resolving non-symlink");
    }
 catch (    IOException e) {
      GenericTestUtils.assertExceptionContains("is not a symbolic link",e);
    }
  }
  finally {
    if (fc != null) {
      fc.delete(notSymlink,false);
    }
  }
}
