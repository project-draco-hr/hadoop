{
  conf=new YarnConfiguration();
  conf.setBoolean(YarnConfiguration.RM_HA_ENABLED,true);
  conf.set(YarnConfiguration.RM_HA_IDS,RM1_NODE_ID + "," + RM2_NODE_ID);
  setRpcAddressForRM(RM1_NODE_ID,RM1_PORT_BASE);
  setRpcAddressForRM(RM2_NODE_ID,RM2_PORT_BASE);
  conf.setLong(YarnConfiguration.CLIENT_FAILOVER_SLEEPTIME_BASE_MS,100L);
  conf.setBoolean(YarnConfiguration.YARN_MINICLUSTER_FIXED_PORTS,true);
  conf.setBoolean(YarnConfiguration.YARN_MINICLUSTER_USE_RPC,true);
  cluster=new MiniYARNCluster(TestRMFailover.class.getName(),2,1,1,1);
  cluster.init(conf);
  cluster.start();
  cluster.getResourceManager(0).getRMContext().getRMAdminService().transitionToActive(req);
  assertFalse("RM never turned active",-1 == cluster.getActiveRMIndex());
}
