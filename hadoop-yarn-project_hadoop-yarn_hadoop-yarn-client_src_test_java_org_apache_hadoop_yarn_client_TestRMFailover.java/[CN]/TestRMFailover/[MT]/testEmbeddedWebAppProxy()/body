{
  conf.setBoolean(YarnConfiguration.AUTO_FAILOVER_ENABLED,false);
  cluster.init(conf);
  cluster.start();
  getAdminService(0).transitionToActive(req);
  assertFalse("RM never turned active",-1 == cluster.getActiveRMIndex());
  verifyConnections();
  URL wrongUrl=new URL("http://0.0.0.0:18088/proxy/" + fakeAppId);
  HttpURLConnection proxyConn=(HttpURLConnection)wrongUrl.openConnection();
  proxyConn.connect();
  verifyExpectedException(proxyConn.getResponseMessage());
  explicitFailover();
  verifyConnections();
  proxyConn.connect();
  verifyExpectedException(proxyConn.getResponseMessage());
}
