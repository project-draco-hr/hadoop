{
  final SnapshotDiff last=getLastSnapshotDiff();
  final SnapshotDiff d=new SnapshotDiff(snapshot,dir);
  if (isSnapshotCreation) {
    d.snapshotINode=snapshot.getRoot();
  }
  diffs.add(d);
  if (last != null) {
    last.posteriorDiff=d;
  }
  return d;
}
