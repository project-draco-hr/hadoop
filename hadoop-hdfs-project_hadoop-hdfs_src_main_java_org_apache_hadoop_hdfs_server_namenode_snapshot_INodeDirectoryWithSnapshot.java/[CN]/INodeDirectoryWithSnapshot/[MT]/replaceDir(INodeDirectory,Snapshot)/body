{
  Preconditions.checkArgument(!(oldDir instanceof INodeDirectoryWithSnapshot),"oldDir is already an INodeDirectoryWithSnapshot, oldDir=%s",oldDir);
  final INodeDirectory parent=oldDir.getParent();
  Preconditions.checkArgument(parent != null,"parent is null, oldDir=%s",oldDir);
  final INodeDirectoryWithSnapshot newDir=new INodeDirectoryWithSnapshot(oldDir,latestSnapshot);
  parent.replaceChild(newDir,null);
  return newDir;
}
