{
  out.writeInt(childrenSize);
  byte[] fullPath=DFSUtil.string2Bytes(snapshot.getRoot().getFullPathName());
  out.writeShort(fullPath.length);
  out.write(fullPath);
  if (isSnapshotRoot()) {
    out.writeBoolean(true);
  }
 else {
    out.writeBoolean(false);
    if (snapshotINode != null) {
      out.writeBoolean(true);
      FSImageSerialization.writeINodeDirectory(snapshotINode,out);
    }
 else {
      out.writeBoolean(false);
    }
  }
  diff.write(out);
}
