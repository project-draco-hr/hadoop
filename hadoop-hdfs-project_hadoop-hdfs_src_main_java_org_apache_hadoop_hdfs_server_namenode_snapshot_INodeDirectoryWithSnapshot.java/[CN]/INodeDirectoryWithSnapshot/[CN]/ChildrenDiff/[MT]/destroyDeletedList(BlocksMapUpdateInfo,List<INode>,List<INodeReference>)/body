{
  Quota.Counts counts=Quota.Counts.newInstance();
  final List<INode> deletedList=getList(ListType.DELETED);
  for (  INode d : deletedList) {
    d.computeQuotaUsage(counts,false);
    d.destroyAndCollectBlocks(collectedBlocks,removedINodes);
    if (d.isReference()) {
      INodeReference.WithCount wc=(INodeReference.WithCount)d.asReference().getReferredINode();
      if (wc.getReferenceCount() > 0) {
        refNodes.add(d.asReference());
      }
    }
  }
  deletedList.clear();
  return counts;
}
