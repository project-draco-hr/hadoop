{
  Quota.Counts counts=Quota.Counts.newInstance();
  final List<INode> deletedList=getList(ListType.DELETED);
  for (  INode d : deletedList) {
    if (INodeReference.tryRemoveReference(d) <= 0) {
      d.computeQuotaUsage(counts,false);
      d.destroyAndCollectBlocks(collectedBlocks);
    }
 else {
      refNodes.add(d.asReference());
    }
  }
  deletedList.clear();
  return counts;
}
