{
  Quota.Counts counts=Quota.Counts.newInstance();
  List<INodeReference> refNodes=new ArrayList<INodeReference>();
  counts.add(diff.destroyDeletedList(collectedBlocks,refNodes));
  for (  INodeReference ref : refNodes) {
    try {
      counts.add(ref.cleanSubtree(this.snapshot,null,collectedBlocks));
    }
 catch (    QuotaExceededException e) {
      String error="should not have QuotaExceededException while deleting snapshot " + this.snapshot;
      LOG.error(error,e);
    }
  }
  return counts;
}
