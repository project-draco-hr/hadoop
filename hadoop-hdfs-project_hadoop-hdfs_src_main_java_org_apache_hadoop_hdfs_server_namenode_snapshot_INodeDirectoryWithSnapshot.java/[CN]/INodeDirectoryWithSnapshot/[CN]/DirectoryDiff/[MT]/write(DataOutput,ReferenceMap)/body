{
  writeSnapshot(out);
  out.writeInt(childrenSize);
  if (isSnapshotRoot()) {
    out.writeBoolean(true);
  }
 else {
    out.writeBoolean(false);
    if (snapshotINode != null) {
      out.writeBoolean(true);
      FSImageSerialization.writeINodeDirectoryAttributes(snapshotINode,out);
    }
 else {
      out.writeBoolean(false);
    }
  }
  diff.write(out,referenceMap);
}
