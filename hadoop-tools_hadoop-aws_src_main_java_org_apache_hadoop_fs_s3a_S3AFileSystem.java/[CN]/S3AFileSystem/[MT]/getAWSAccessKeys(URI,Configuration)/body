{
  String accessKey=null;
  String secretKey=null;
  String userInfo=name.getUserInfo();
  if (userInfo != null) {
    int index=userInfo.indexOf(':');
    if (index != -1) {
      accessKey=userInfo.substring(0,index);
      secretKey=userInfo.substring(index + 1);
    }
 else {
      accessKey=userInfo;
    }
  }
  Configuration c=ProviderUtils.excludeIncompatibleCredentialProviders(conf,S3AFileSystem.class);
  if (accessKey == null) {
    try {
      final char[] key=c.getPassword(ACCESS_KEY);
      if (key != null) {
        accessKey=(new String(key)).trim();
      }
    }
 catch (    IOException ioe) {
      throw new IOException("Cannot find AWS access key.",ioe);
    }
  }
  if (secretKey == null) {
    try {
      final char[] pass=c.getPassword(SECRET_KEY);
      if (pass != null) {
        secretKey=(new String(pass)).trim();
      }
    }
 catch (    IOException ioe) {
      throw new IOException("Cannot find AWS secret key.",ioe);
    }
  }
  return new AWSAccessKeys(accessKey,secretKey);
}
