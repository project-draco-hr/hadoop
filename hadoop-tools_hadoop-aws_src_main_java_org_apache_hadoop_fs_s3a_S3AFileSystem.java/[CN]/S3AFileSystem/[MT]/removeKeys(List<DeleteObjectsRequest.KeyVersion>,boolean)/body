{
  if (enableMultiObjectsDelete) {
    DeleteObjectsRequest deleteRequest=new DeleteObjectsRequest(bucket).withKeys(keysToDelete);
    s3.deleteObjects(deleteRequest);
    instrumentation.fileDeleted(keysToDelete.size());
    statistics.incrementWriteOps(1);
  }
 else {
    int writeops=0;
    for (    DeleteObjectsRequest.KeyVersion keyVersion : keysToDelete) {
      s3.deleteObject(new DeleteObjectRequest(bucket,keyVersion.getKey()));
      writeops++;
    }
    instrumentation.fileDeleted(keysToDelete.size());
    statistics.incrementWriteOps(writeops);
  }
  if (clearKeys) {
    keysToDelete.clear();
  }
}
