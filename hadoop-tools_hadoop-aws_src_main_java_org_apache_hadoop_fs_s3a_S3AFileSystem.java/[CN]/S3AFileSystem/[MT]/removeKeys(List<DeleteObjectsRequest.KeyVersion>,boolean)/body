{
  if (enableMultiObjectsDelete) {
    deleteObjects(new DeleteObjectsRequest(bucket).withKeys(keysToDelete));
    instrumentation.fileDeleted(keysToDelete.size());
  }
 else {
    for (    DeleteObjectsRequest.KeyVersion keyVersion : keysToDelete) {
      deleteObject(keyVersion.getKey());
    }
    instrumentation.fileDeleted(keysToDelete.size());
  }
  if (clearKeys) {
    keysToDelete.clear();
  }
}
