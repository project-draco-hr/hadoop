{
  incrementStatistic(INVOCATION_COPY_FROM_LOCAL_FILE);
  final String key=pathToKey(dst);
  if (!overwrite && exists(dst)) {
    throw new FileAlreadyExistsException(dst + " already exists");
  }
  LOG.debug("Copying local file from {} to {}",src,dst);
  LocalFileSystem local=getLocal(getConf());
  File srcfile=local.pathToFile(src);
  final ObjectMetadata om=newObjectMetadata();
  PutObjectRequest putObjectRequest=newPutObjectRequest(key,om,srcfile);
  Upload up=putObject(putObjectRequest);
  ProgressableProgressListener listener=new ProgressableProgressListener(this,key,up,null);
  up.addProgressListener(listener);
  try {
    up.waitForUploadResult();
  }
 catch (  InterruptedException e) {
    throw new InterruptedIOException("Interrupted copying " + src + " to "+ dst+ ", cancelling");
  }
  listener.uploadCompleted();
  finishedWrite(key);
  if (delSrc) {
    local.delete(src,false);
  }
}
