{
  while (true) {
    String key="";
    try {
      key=pathToKey(f);
      if (key.isEmpty()) {
        break;
      }
      S3AFileStatus status=getFileStatus(f);
      if (status.isDirectory() && status.isEmptyDirectory()) {
        LOG.debug("Deleting fake directory {}/",key);
        s3.deleteObject(bucket,key + "/");
        statistics.incrementWriteOps(1);
      }
    }
 catch (    IOException|AmazonClientException e) {
      LOG.debug("While deleting key {} ",key,e);
      instrumentation.errorIgnored();
    }
    if (f.isRoot()) {
      break;
    }
    f=f.getParent();
  }
}
