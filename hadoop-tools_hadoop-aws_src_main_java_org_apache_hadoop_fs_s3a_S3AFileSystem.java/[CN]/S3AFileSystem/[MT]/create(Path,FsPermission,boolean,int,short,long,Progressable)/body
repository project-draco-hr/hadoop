{
  String key=pathToKey(f);
  S3AFileStatus status=null;
  try {
    status=getFileStatus(f);
    if (status.isDirectory()) {
      throw new FileAlreadyExistsException(f + " is a directory");
    }
    if (!overwrite) {
      throw new FileAlreadyExistsException(f + " already exists");
    }
    LOG.debug("Overwriting file {}",f);
  }
 catch (  FileNotFoundException e) {
  }
  instrumentation.fileCreated();
  if (getConf().getBoolean(FAST_UPLOAD,DEFAULT_FAST_UPLOAD)) {
    return new FSDataOutputStream(new S3AFastOutputStream(s3,this,bucket,key,progress,cannedACL,partSize,multiPartThreshold,threadPoolExecutor),statistics);
  }
  return new FSDataOutputStream(new S3AOutputStream(getConf(),this,key,progress),null);
}
