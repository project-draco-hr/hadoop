{
  String key=pathToKey(f);
  if (!overwrite && exists(f)) {
    throw new FileAlreadyExistsException(f + " already exists");
  }
  if (getConf().getBoolean(FAST_UPLOAD,DEFAULT_FAST_UPLOAD)) {
    return new FSDataOutputStream(new S3AFastOutputStream(s3,this,bucket,key,progress,statistics,cannedACL,serverSideEncryptionAlgorithm,partSize,multiPartThreshold,threadPoolExecutor),statistics);
  }
  return new FSDataOutputStream(new S3AOutputStream(getConf(),transfers,this,bucket,key,progress,cannedACL,statistics,serverSideEncryptionAlgorithm),null);
}
