{
  String key=pathToKey(f);
  if (!overwrite && exists(f)) {
    throw new FileAlreadyExistsException(f + " already exists");
  }
  instrumentation.fileCreated();
  if (getConf().getBoolean(FAST_UPLOAD,DEFAULT_FAST_UPLOAD)) {
    return new FSDataOutputStream(new S3AFastOutputStream(s3,this,bucket,key,progress,cannedACL,partSize,multiPartThreshold,threadPoolExecutor),statistics);
  }
  return new FSDataOutputStream(new S3AOutputStream(getConf(),this,key,progress),null);
}
