{
  boolean purgeExistingMultipart=conf.getBoolean(PURGE_EXISTING_MULTIPART,DEFAULT_PURGE_EXISTING_MULTIPART);
  long purgeExistingMultipartAge=longOption(conf,PURGE_EXISTING_MULTIPART_AGE,DEFAULT_PURGE_EXISTING_MULTIPART_AGE,0);
  if (purgeExistingMultipart) {
    Date purgeBefore=new Date(new Date().getTime() - purgeExistingMultipartAge * 1000);
    try {
      transfers.abortMultipartUploads(bucket,purgeBefore);
    }
 catch (    AmazonServiceException e) {
      if (e.getStatusCode() == 403) {
        instrumentation.errorIgnored();
        LOG.debug("Failed to abort multipart uploads against {}," + " FS may be read only",bucket,e);
      }
 else {
        throw e;
      }
    }
  }
}
