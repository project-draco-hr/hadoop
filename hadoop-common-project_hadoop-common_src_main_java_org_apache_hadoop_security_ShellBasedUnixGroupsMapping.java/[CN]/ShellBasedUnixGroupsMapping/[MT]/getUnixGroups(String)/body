{
  ShellCommandExecutor executor=createGroupExecutor(user);
  List<String> groups;
  try {
    executor.execute();
    groups=resolveFullGroupNames(executor.getOutput());
  }
 catch (  ExitCodeException e) {
    try {
      groups=resolvePartialGroupNames(user,e.getMessage(),executor.getOutput());
    }
 catch (    PartialGroupNameException pge) {
      LOG.warn("unable to return groups for user " + user,pge);
      return new LinkedList<>();
    }
  }
  if (!Shell.WINDOWS) {
    for (int i=1; i < groups.size(); i++) {
      if (groups.get(i).equals(groups.get(0))) {
        groups.remove(i);
        break;
      }
    }
  }
  return groups;
}
