{
  Configuration conf=getConf();
  FileSystem fs;
  try {
    fs=FileSystem.get(conf);
  }
 catch (  IOException ioe) {
    System.err.println("FileSystem is inaccessible due to:\n" + StringUtils.stringifyException(ioe));
    return null;
  }
  if (!(fs instanceof DistributedFileSystem)) {
    System.err.println("FileSystem is " + fs.getUri());
    return null;
  }
  DistributedFileSystem dfs=(DistributedFileSystem)fs;
  InetSocketAddress namenode=NameNode.getAddress(dfs.getUri().getAuthority());
  return DFSUtil.getInfoServer(namenode,conf,true);
}
