{
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.get(conf);
  int numOfInputLines=10;
  Path outDir=new Path(testDir,"output_for_field_selection_test");
  Path inDir=new Path(testDir,"input_for_field_selection_test");
  StringBuffer inputData=new StringBuffer();
  StringBuffer expectedOutput=new StringBuffer();
  constructInputOutputData(inputData,expectedOutput,numOfInputLines);
  conf.set(FieldSelectionHelper.DATA_FIELD_SEPERATOR,"-");
  conf.set(FieldSelectionHelper.MAP_OUTPUT_KEY_VALUE_SPEC,"6,5,1-3:0-");
  conf.set(FieldSelectionHelper.REDUCE_OUTPUT_KEY_VALUE_SPEC,":4,3,2,1,0,0-");
  Job job=MapReduceTestUtil.createJob(conf,inDir,outDir,1,1,inputData.toString());
  job.setMapperClass(FieldSelectionMapper.class);
  job.setReducerClass(FieldSelectionReducer.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(Text.class);
  job.setNumReduceTasks(1);
  job.waitForCompletion(true);
  assertTrue("Job Failed!",job.isSuccessful());
  String outdata=MapReduceTestUtil.readOutput(outDir,conf);
  assertEquals("Outputs doesnt match.",expectedOutput.toString(),outdata);
  fs.delete(outDir,true);
}
