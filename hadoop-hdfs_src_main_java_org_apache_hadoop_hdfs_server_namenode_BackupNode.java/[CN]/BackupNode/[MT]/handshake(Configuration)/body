{
  InetSocketAddress nnAddress=NameNode.getServiceAddress(conf,true);
  this.namenode=(NamenodeProtocol)RPC.waitForProxy(NamenodeProtocol.class,NamenodeProtocol.versionID,nnAddress,conf);
  this.nnRpcAddress=getHostPortString(nnAddress);
  this.nnHttpAddress=getHostPortString(super.getHttpServerAddress(conf));
  NamespaceInfo nsInfo=null;
  while (!isStopRequested()) {
    try {
      nsInfo=handshake(namenode);
      break;
    }
 catch (    SocketTimeoutException e) {
      LOG.info("Problem connecting to server: " + nnAddress);
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException ie) {
      }
    }
  }
  return nsInfo;
}
