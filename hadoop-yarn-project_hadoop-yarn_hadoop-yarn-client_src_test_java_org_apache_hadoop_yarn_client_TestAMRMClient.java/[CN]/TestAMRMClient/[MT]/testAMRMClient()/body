{
  AMRMClientImpl<ContainerRequest> amClient=null;
  try {
    amClient=new AMRMClientImpl<ContainerRequest>(attemptId);
    amClient.init(conf);
    amClient.start();
    amClient.registerApplicationMaster("Host",10000,"");
    testAllocation(amClient);
    amClient.unregisterApplicationMaster(FinalApplicationStatus.SUCCEEDED,null,null);
  }
  finally {
    if (amClient != null && amClient.getServiceState() == STATE.STARTED) {
      amClient.stop();
    }
  }
}
