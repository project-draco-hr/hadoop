{
  if ("file".equals(getScheme())) {
    return;
  }
  Path file=new Path(testBaseDir1(),"file");
  Path link=new Path(testBaseDir1(),"linkToFile");
  createAndWriteFile(file);
  wrapper.createSymlink(file,link,false);
  try {
    wrapper.rename(link,file);
    fail("Renamed symlink to its target");
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof FileAlreadyExistsException);
  }
  assertTrue(wrapper.isFile(file));
  assertTrue(wrapper.exists(link));
  assertTrue(wrapper.isSymlink(link));
  assertEquals(file,wrapper.getLinkTarget(link));
  try {
    wrapper.rename(link,file,Rename.OVERWRITE);
    fail("Renamed symlink to its target");
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof FileAlreadyExistsException);
  }
  assertTrue(wrapper.isFile(file));
  assertTrue(wrapper.exists(link));
  assertTrue(wrapper.isSymlink(link));
  assertEquals(file,wrapper.getLinkTarget(link));
}
