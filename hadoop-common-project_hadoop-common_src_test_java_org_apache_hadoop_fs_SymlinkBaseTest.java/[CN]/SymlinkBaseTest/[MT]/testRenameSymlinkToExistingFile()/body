{
  Path file1=new Path(testBaseDir1(),"file");
  Path file2=new Path(testBaseDir1(),"someFile");
  Path link=new Path(testBaseDir1(),"linkToFile");
  createAndWriteFile(file1);
  createAndWriteFile(file2);
  wrapper.createSymlink(file2,link,false);
  try {
    wrapper.rename(link,file1);
    fail("Renamed w/o passing overwrite");
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof FileAlreadyExistsException);
  }
  wrapper.rename(link,file1,Rename.OVERWRITE);
  assertFalse(wrapper.exists(link));
  if (!emulatingSymlinksOnWindows()) {
    assertTrue(wrapper.getFileLinkStatus(file1).isSymlink());
    assertEquals(file2,wrapper.getLinkTarget(file1));
  }
}
