{
  Path file=new Path(testBaseDir1(),"file");
  Path subDir=new Path(testBaseDir1(),"subDir");
  Path link=new Path(testBaseDir1(),"link");
  wrapper.mkdir(subDir,FileContext.DEFAULT_PERM,false);
  wrapper.createSymlink(subDir,link,false);
  createAndWriteFile(file);
  try {
    wrapper.rename(file,link);
    fail("Renamed file to symlink w/o overwrite");
  }
 catch (  IOException e) {
    assertTrue(unwrapException(e) instanceof FileAlreadyExistsException);
  }
  wrapper.rename(file,link,Rename.OVERWRITE);
  assertFalse(wrapper.exists(file));
  assertTrue(wrapper.exists(link));
  assertTrue(wrapper.isFile(link));
  assertFalse(wrapper.getFileLinkStatus(link).isSymlink());
}
