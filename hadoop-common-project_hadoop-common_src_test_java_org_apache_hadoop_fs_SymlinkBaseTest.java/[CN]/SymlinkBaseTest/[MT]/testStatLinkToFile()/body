{
  assumeTrue(!emulatingSymlinksOnWindows());
  Path file=new Path(testBaseDir1() + "/file");
  Path linkToFile=new Path(testBaseDir1() + "/linkToFile");
  createAndWriteFile(file);
  wrapper.createSymlink(file,linkToFile,false);
  assertFalse(wrapper.getFileLinkStatus(linkToFile).isDirectory());
  assertTrue(wrapper.isSymlink(linkToFile));
  assertTrue(wrapper.isFile(linkToFile));
  assertFalse(wrapper.isDir(linkToFile));
  assertEquals(file,wrapper.getLinkTarget(linkToFile));
  if (!"file".equals(getScheme())) {
    assertEquals(wrapper.getFileStatus(file),wrapper.getFileStatus(linkToFile));
    assertEquals(wrapper.makeQualified(file),wrapper.getFileStatus(linkToFile).getPath());
    assertEquals(wrapper.makeQualified(linkToFile),wrapper.getFileLinkStatus(linkToFile).getPath());
  }
}
