{
  Path baseDir=new Path(testBaseDir1());
  Path file=new Path(testBaseDir1(),"file");
  Path fileNew=new Path(baseDir,"fileNew");
  Path linkToDir=new Path(testBaseDir2(),"linkToDir");
  Path fileViaLink=new Path(linkToDir,"file");
  Path fileNewViaLink=new Path(linkToDir,"fileNew");
  wrapper.createSymlink(baseDir,linkToDir,false);
  createAndWriteFile(fileViaLink);
  assertTrue(wrapper.exists(fileViaLink));
  assertTrue(wrapper.isFile(fileViaLink));
  assertFalse(wrapper.isDir(fileViaLink));
  assertFalse(wrapper.getFileLinkStatus(fileViaLink).isSymlink());
  assertFalse(wrapper.isDir(fileViaLink));
  assertEquals(wrapper.getFileStatus(file),wrapper.getFileLinkStatus(file));
  assertEquals(wrapper.getFileStatus(fileViaLink),wrapper.getFileLinkStatus(fileViaLink));
  readFile(fileViaLink);
  appendToFile(fileViaLink);
  wrapper.rename(fileViaLink,fileNewViaLink);
  assertFalse(wrapper.exists(fileViaLink));
  assertTrue(wrapper.exists(fileNewViaLink));
  readFile(fileNewViaLink);
  assertEquals(wrapper.getFileBlockLocations(fileNew,0,1).length,wrapper.getFileBlockLocations(fileNewViaLink,0,1).length);
  assertEquals(wrapper.getFileChecksum(fileNew),wrapper.getFileChecksum(fileNewViaLink));
  wrapper.delete(fileNewViaLink,true);
  assertFalse(wrapper.exists(fileNewViaLink));
}
