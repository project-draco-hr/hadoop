{
  assumeTrue(!"file".equals(getScheme()));
  Path dir=new Path(testBaseDir1(),"dir");
  Path file=new Path(dir,"file");
  Path linkToDir=new Path(testBaseDir1(),"linkToDir");
  Path fileViaLink=new Path(linkToDir,"file");
  wrapper.mkdir(dir,FileContext.DEFAULT_PERM,false);
  wrapper.createSymlink(new Path("dir"),linkToDir,false);
  createAndWriteFile(fileViaLink);
  assertEquals(wrapper.makeQualified(file),wrapper.getFileStatus(file).getPath());
  assertEquals(wrapper.getFileStatus(file),wrapper.getFileLinkStatus(file));
  assertEquals(wrapper.getFileStatus(fileViaLink),wrapper.getFileLinkStatus(fileViaLink));
  assertEquals(wrapper.getFileStatus(fileViaLink),wrapper.getFileLinkStatus(file));
}
