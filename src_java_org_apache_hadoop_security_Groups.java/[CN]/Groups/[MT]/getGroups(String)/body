{
  CachedGroups groups=userToGroupsMap.get(user);
  long now=System.currentTimeMillis();
  if (groups != null && (groups.getTimestamp() + cacheTimeout > now)) {
    LOG.debug("Returning cached groups for '" + user + "'");
    return groups.getGroups();
  }
  groups=new CachedGroups(impl.getGroups(user));
  userToGroupsMap.put(user,groups);
  LOG.debug("Returning fetched groups for '" + user + "'");
  return groups.getGroups();
}
