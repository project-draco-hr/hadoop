{
  StaticMapping.resetMap();
  conf=new HdfsConfiguration();
  final String[] racks={"/RACK0","/RACK0","/RACK2","/RACK3","/RACK2"};
  final String[] hosts={"/host0","/host1","/host2","/host3","/host4"};
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,DEFAULT_BLOCK_SIZE);
  conf.setInt(DFSConfigKeys.DFS_BYTES_PER_CHECKSUM_KEY,DEFAULT_BLOCK_SIZE / 2);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(5).racks(racks).hosts(hosts).build();
  cluster.waitActive();
  nameNodeRpc=cluster.getNameNodeRpc();
  namesystem=cluster.getNamesystem();
  perm=new PermissionStatus("TestDefaultBlockPlacementPolicy",null,FsPermission.getDefault());
}
