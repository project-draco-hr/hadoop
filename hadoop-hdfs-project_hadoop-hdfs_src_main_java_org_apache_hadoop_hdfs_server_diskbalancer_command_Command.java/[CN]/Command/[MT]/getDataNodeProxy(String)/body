{
  InetSocketAddress datanodeAddr=NetUtils.createSocketAddr(datanode);
  getConf().set(CommonConfigurationKeys.HADOOP_SECURITY_SERVICE_USER_NAME_KEY,getConf().get(DFSConfigKeys.DFS_DATANODE_KERBEROS_PRINCIPAL_KEY,""));
  ClientDatanodeProtocol dnProtocol=DFSUtilClient.createClientDatanodeProtocolProxy(datanodeAddr,getUGI(),getConf(),NetUtils.getSocketFactory(getConf(),ClientDatanodeProtocol.class));
  return dnProtocol;
}
