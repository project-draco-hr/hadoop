{
  if (conf.get(CapacitySchedulerConf.DEFAULT_PERCENTAGE_OF_PMEM_IN_VMEM_PROPERTY) != null) {
    LOG.warn(JobConf.deprecatedString(CapacitySchedulerConf.DEFAULT_PERCENTAGE_OF_PMEM_IN_VMEM_PROPERTY));
  }
  if (conf.get(CapacitySchedulerConf.UPPER_LIMIT_ON_TASK_PMEM_PROPERTY) != null) {
    LOG.warn(JobConf.deprecatedString(CapacitySchedulerConf.UPPER_LIMIT_ON_TASK_PMEM_PROPERTY));
  }
  if (conf.get(JobConf.MAPRED_TASK_DEFAULT_MAXVMEM_PROPERTY) != null) {
    LOG.warn(JobConf.deprecatedString(JobConf.MAPRED_TASK_DEFAULT_MAXVMEM_PROPERTY));
  }
  memSizeForMapSlotOnJT=JobConf.normalizeMemoryConfigValue(conf.getLong(MRConfig.MAPMEMORY_MB,JobConf.DISABLED_MEMORY_LIMIT));
  memSizeForReduceSlotOnJT=JobConf.normalizeMemoryConfigValue(conf.getLong(MRConfig.REDUCEMEMORY_MB,JobConf.DISABLED_MEMORY_LIMIT));
  if (conf.get(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY) != null) {
    LOG.warn(JobConf.deprecatedString(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY) + " instead use " + JTConfig.JT_MAX_MAPMEMORY_MB+ " and "+ JTConfig.JT_MAX_REDUCEMEMORY_MB);
    limitMaxMemForMapTasks=limitMaxMemForReduceTasks=JobConf.normalizeMemoryConfigValue(conf.getLong(JobConf.UPPER_LIMIT_ON_TASK_VMEM_PROPERTY,JobConf.DISABLED_MEMORY_LIMIT));
    if (limitMaxMemForMapTasks != JobConf.DISABLED_MEMORY_LIMIT && limitMaxMemForMapTasks >= 0) {
      limitMaxMemForMapTasks=limitMaxMemForReduceTasks=limitMaxMemForMapTasks / (1024 * 1024);
    }
  }
 else {
    limitMaxMemForMapTasks=JobConf.normalizeMemoryConfigValue(conf.getLong(JTConfig.JT_MAX_MAPMEMORY_MB,JobConf.DISABLED_MEMORY_LIMIT));
    limitMaxMemForReduceTasks=JobConf.normalizeMemoryConfigValue(conf.getLong(JTConfig.JT_MAX_REDUCEMEMORY_MB,JobConf.DISABLED_MEMORY_LIMIT));
  }
  LOG.info(String.format("Scheduler configured with " + "(memSizeForMapSlotOnJT, memSizeForReduceSlotOnJT, " + "limitMaxMemForMapTasks, limitMaxMemForReduceTasks)"+ " (%d,%d,%d,%d)",Long.valueOf(memSizeForMapSlotOnJT),Long.valueOf(memSizeForReduceSlotOnJT),Long.valueOf(limitMaxMemForMapTasks),Long.valueOf(limitMaxMemForReduceTasks)));
}
