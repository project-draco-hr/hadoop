{
  if (cellSize % bytesPerChecksum != 0) {
    throw new HadoopIllegalArgumentException("Invalid values: " + HdfsClientConfigKeys.DFS_BYTES_PER_CHECKSUM_KEY + " (="+ bytesPerChecksum+ ") must divide cell size (="+ cellSize+ ").");
  }
  checksumArrays=new byte[numParityBlocks][];
  final int size=getChecksumSize() * (cellSize / bytesPerChecksum);
  for (int i=0; i < checksumArrays.length; i++) {
    checksumArrays[i]=new byte[size];
  }
  buffers=new ByteBuffer[numAllBlocks];
  for (int i=0; i < buffers.length; i++) {
    buffers[i]=ByteBuffer.wrap(byteArrayManager.newByteArray(cellSize));
  }
}
