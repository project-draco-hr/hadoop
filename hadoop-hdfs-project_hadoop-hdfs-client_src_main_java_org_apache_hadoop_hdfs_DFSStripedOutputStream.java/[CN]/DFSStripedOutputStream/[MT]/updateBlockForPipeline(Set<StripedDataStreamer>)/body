{
  final LocatedBlock updated=dfsClient.namenode.updateBlockForPipeline(currentBlockGroup,dfsClient.clientName);
  final long newGS=updated.getBlock().getGenerationStamp();
  ExtendedBlock newBlock=new ExtendedBlock(currentBlockGroup);
  newBlock.setGenerationStamp(newGS);
  final LocatedBlock[] updatedBlks=StripedBlockUtil.parseStripedBlockGroup((LocatedStripedBlock)updated,cellSize,numDataBlocks,numAllBlocks - numDataBlocks);
  for (int i=0; i < numAllBlocks; i++) {
    StripedDataStreamer si=getStripedDataStreamer(i);
    if (healthyStreamers.contains(si)) {
      final LocatedBlock lb=new LocatedBlock(new ExtendedBlock(newBlock),null,null,null,-1,updated.isCorrupt(),null);
      lb.setBlockToken(updatedBlks[i].getBlockToken());
      coordinator.getNewBlocks().offer(i,lb);
    }
  }
  return newBlock;
}
