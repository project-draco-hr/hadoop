{
  Set<StripedDataStreamer> healthySet=new HashSet<>();
  for (int i=0; i < numAllBlocks; i++) {
    final StripedDataStreamer streamer=getStripedDataStreamer(i);
    if (streamer.isHealthy() && isStreamerWriting(i)) {
      Preconditions.checkState(streamer.getStage() == BlockConstructionStage.DATA_STREAMING,"streamer: " + streamer);
      streamer.setExternalError();
      healthySet.add(streamer);
    }
  }
  return healthySet;
}
