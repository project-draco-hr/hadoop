{
  List<File> dirs=Lists.newArrayList();
  for (int i=0; i < nameNodeDirs.length; i++) {
    File curDir=new File(nameNodeDirs[i],"current");
    dirs.add(curDir);
    FSImageTestUtil.assertReasonableNameCurrentDir(curDir);
  }
  FSImageTestUtil.assertParallelFilesAreIdentical(dirs,Collections.<String>emptySet());
  for (int i=0; i < dataNodeDirs.length; i++) {
    assertEquals(UpgradeUtilities.checksumContents(DATA_NODE,new File(dataNodeDirs[i],"current")),UpgradeUtilities.checksumMasterDataNodeContents());
  }
  for (int i=0; i < nameNodeDirs.length; i++) {
    assertFalse(new File(nameNodeDirs[i],"previous").isDirectory());
  }
}
