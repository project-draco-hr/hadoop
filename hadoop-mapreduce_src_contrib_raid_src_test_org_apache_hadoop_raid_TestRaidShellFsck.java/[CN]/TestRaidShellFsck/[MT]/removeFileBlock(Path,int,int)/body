{
  LocatedBlocks fileBlocks=dfs.getClient().getNamenode().getBlockLocations(filePath.toString(),0,FILE_BLOCKS * BLOCK_SIZE);
  if (fileBlocks.locatedBlockCount() != FILE_BLOCKS) {
    throw new IOException("expected " + FILE_BLOCKS + " file blocks but found "+ fileBlocks.locatedBlockCount());
  }
  if (blockInStripe >= STRIPE_BLOCKS) {
    throw new IOException("blockInStripe is " + blockInStripe + " but must be smaller than "+ STRIPE_BLOCKS);
  }
  LocatedBlock block=fileBlocks.get(stripe * STRIPE_BLOCKS + blockInStripe);
  removeAndReportBlock(dfs,filePath,block);
  LOG.info("removed file " + filePath.toString() + " block "+ stripe * STRIPE_BLOCKS + " in stripe " + stripe);
}
