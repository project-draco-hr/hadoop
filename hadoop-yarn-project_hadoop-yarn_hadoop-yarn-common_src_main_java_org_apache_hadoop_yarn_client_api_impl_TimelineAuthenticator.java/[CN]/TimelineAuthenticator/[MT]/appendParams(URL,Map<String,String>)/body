{
  StringBuilder sb=new StringBuilder();
  sb.append(url);
  String separator=url.toString().contains("?") ? "&" : "?";
  for (  Map.Entry<String,String> entry : params.entrySet()) {
    sb.append(separator).append(entry.getKey()).append("=").append(URLEncoder.encode(entry.getValue(),"UTF8"));
    separator="&";
  }
  return new URL(sb.toString());
}
