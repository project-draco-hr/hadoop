{
  Map<String,String> params=new HashMap<String,String>();
  params.put(TimelineAuthenticationConsts.OP_PARAM,TimelineDelegationTokenOperation.RENEWDELEGATIONTOKEN.toString());
  params.put(TimelineAuthenticationConsts.TOKEN_PARAM,dToken.encodeToUrlString());
  url=appendParams(url,params);
  AuthenticatedURL aUrl=new AuthenticatedURL(new TimelineAuthenticator());
  try {
    HttpURLConnection conn=aUrl.openConnection(url,token);
    conn.setRequestMethod(TimelineDelegationTokenOperation.RENEWDELEGATIONTOKEN.getHttpMethod());
    TimelineDelegationTokenResponse dtRes=validateAndParseResponse(conn);
    if (!dtRes.getType().equals(TimelineAuthenticationConsts.DELEGATION_TOKEN_EXPIRATION_TIME)) {
      throw new IOException("The response content is not expected: " + dtRes.getContent());
    }
    return Long.valueOf(dtRes.getContent().toString());
  }
 catch (  AuthenticationException ex) {
    throw new IOException(ex.toString(),ex);
  }
}
