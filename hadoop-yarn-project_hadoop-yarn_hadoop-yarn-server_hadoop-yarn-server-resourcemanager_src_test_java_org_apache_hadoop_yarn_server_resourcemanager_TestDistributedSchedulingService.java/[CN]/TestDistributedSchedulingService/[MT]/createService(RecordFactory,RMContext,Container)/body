{
  return new DistributedSchedulingService(rmContext,null){
    @Override public RegisterApplicationMasterResponse registerApplicationMaster(    RegisterApplicationMasterRequest request) throws YarnException, IOException {
      RegisterApplicationMasterResponse resp=factory.newRecordInstance(RegisterApplicationMasterResponse.class);
      resp.setQueue("dummyQueue");
      return resp;
    }
    @Override public FinishApplicationMasterResponse finishApplicationMaster(    FinishApplicationMasterRequest request) throws YarnException, IOException {
      FinishApplicationMasterResponse resp=factory.newRecordInstance(FinishApplicationMasterResponse.class);
      resp.setIsUnregistered(false);
      return resp;
    }
    @Override public AllocateResponse allocate(    AllocateRequest request) throws YarnException, IOException {
      AllocateResponse response=factory.newRecordInstance(AllocateResponse.class);
      response.setNumClusterNodes(12345);
      response.setAllocatedContainers(Arrays.asList(c));
      return response;
    }
    @Override public DistSchedRegisterResponse registerApplicationMasterForDistributedScheduling(    RegisterApplicationMasterRequest request) throws YarnException, IOException {
      DistSchedRegisterResponse resp=factory.newRecordInstance(DistSchedRegisterResponse.class);
      resp.setContainerIdStart(54321L);
      resp.setMaxAllocatableCapabilty(Resource.newInstance(4096,4));
      resp.setMinAllocatableCapabilty(Resource.newInstance(1024,1));
      resp.setIncrAllocatableCapabilty(Resource.newInstance(2048,2));
      return resp;
    }
    @Override public DistSchedAllocateResponse allocateForDistributedScheduling(    AllocateRequest request) throws YarnException, IOException {
      List<ResourceRequest> askList=request.getAskList();
      Assert.assertEquals(1,askList.size());
      Assert.assertTrue(askList.get(0).getExecutionTypeRequest().getEnforceExecutionType());
      DistSchedAllocateResponse resp=factory.newRecordInstance(DistSchedAllocateResponse.class);
      resp.setNodesForScheduling(Arrays.asList(NodeId.newInstance("h1",1234)));
      return resp;
    }
  }
;
}
