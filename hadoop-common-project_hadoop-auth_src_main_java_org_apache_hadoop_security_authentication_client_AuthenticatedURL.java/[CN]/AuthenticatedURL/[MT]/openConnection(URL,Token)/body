{
  if (url == null) {
    throw new IllegalArgumentException("url cannot be NULL");
  }
  if (!url.getProtocol().equalsIgnoreCase("http") && !url.getProtocol().equalsIgnoreCase("https")) {
    throw new IllegalArgumentException("url must be for a HTTP or HTTPS resource");
  }
  if (token == null) {
    throw new IllegalArgumentException("token cannot be NULL");
  }
  authenticator.authenticate(url,token);
  HttpURLConnection conn=(HttpURLConnection)url.openConnection();
  injectToken(conn,token);
  return conn;
}
