{
  JobConf job=new JobConf();
  Path base=cluster.getFileSystem().makeQualified(new Path("/empty"));
  Path[] src={new Path(base,"i0"),new Path("i1"),new Path("i2")};
  job.set("mapreduce.join.expr",CompositeInputFormat.compose("outer",Fake_IF.class,src));
  job.setInputFormat(CompositeInputFormat.class);
  FileOutputFormat.setOutputPath(job,new Path(base,"out"));
  job.setMapperClass(IdentityMapper.class);
  job.setReducerClass(IdentityReducer.class);
  job.setOutputKeyClass(IncomparableKey.class);
  job.setOutputValueClass(NullWritable.class);
  JobClient.runJob(job);
  base.getFileSystem(job).delete(base,true);
}
