def gen_site_conf(self, confDir, tempDir, numNodes, hdfsAddr, mrSysDir, mapredAddr=None, clientParams=None, serverParams=None, finalServerParams=None, clusterFactor=None):
    if (not mapredAddr):
        mapredAddr = 'dummy:8181'
    implementation = getDOMImplementation()
    doc = implementation.createDocument('', 'configuration', None)
    comment = doc.createComment('This is an auto generated hadoop-site.xml, do not modify')
    topElement = doc.documentElement
    topElement.appendChild(comment)
    description = {}
    paramsDict = {'mapred.job.tracker': mapredAddr, 'fs.default.name': ('hdfs://' + hdfsAddr), 'hadoop.tmp.dir': tempDir, }
    paramsDict['mapred.system.dir'] = mrSysDir
    numred = int(math.floor((clusterFactor * (int(numNodes) - 1))))
    paramsDict['mapred.reduce.tasks'] = str(numred)
    for (k, v) in paramsDict.iteritems():
        description[k] = 'Hod generated parameter'
    if finalServerParams:
        for (k, v) in finalServerParams.iteritems():
            if (not description.has_key(k)):
                description[k] = 'final server parameter'
                paramsDict[k] = v
    if serverParams:
        for (k, v) in serverParams.iteritems():
            if (not description.has_key(k)):
                description[k] = 'server parameter'
                paramsDict[k] = v
    if clientParams:
        for (k, v) in clientParams.iteritems():
            if ((not description.has_key(k)) or (description[k] == 'server parameter')):
                description[k] = 'client-side parameter'
                paramsDict[k] = v
    for (k, v) in paramsDict.iteritems():
        if ((description[k] == 'final server parameter') or (description[k] == 'Hod generated parameter')):
            final = True
        else:
            final = False
        prop = self.__create_xml_element(doc, k, v, description[k], final)
        topElement.appendChild(prop)
    siteName = os.path.join(confDir, 'hadoop-site.xml')
    sitefile = file(siteName, 'w')
    print  >> sitefile, topElement.toxml()
    sitefile.close()
