{
  List<DiffInfo> diffs=new ArrayList<>();
  for (  SnapshotDiffReport.DiffReportEntry entry : report.getDiffList()) {
    if (entry.getType() == SnapshotDiffReport.DiffType.DELETE) {
      final Path source=new Path(targetDir,DFSUtil.bytes2String(entry.getSourcePath()));
      diffs.add(new DiffInfo(source,null));
    }
 else     if (entry.getType() == SnapshotDiffReport.DiffType.RENAME) {
      final Path source=new Path(targetDir,DFSUtil.bytes2String(entry.getSourcePath()));
      final Path target=new Path(targetDir,DFSUtil.bytes2String(entry.getTargetPath()));
      diffs.add(new DiffInfo(source,target));
    }
  }
  return diffs.toArray(new DiffInfo[diffs.size()]);
}
