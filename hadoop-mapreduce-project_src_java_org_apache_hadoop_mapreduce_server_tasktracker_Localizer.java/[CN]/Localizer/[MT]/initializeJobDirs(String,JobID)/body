{
  boolean initJobDirStatus=false;
  String jobDirPath=TaskTracker.getLocalJobDir(user,jobId.toString());
  for (  String localDir : localDirs) {
    Path jobDir=new Path(localDir,jobDirPath);
    if (fs.exists(jobDir)) {
      fs.delete(jobDir,true);
    }
    boolean jobDirStatus=fs.mkdirs(jobDir);
    if (!jobDirStatus) {
      LOG.warn("Not able to create job directory " + jobDir.toString());
    }
    initJobDirStatus=initJobDirStatus || jobDirStatus;
    fs.setPermission(jobDir,new FsPermission((short)0700));
  }
  if (!initJobDirStatus) {
    throw new IOException("Not able to initialize job directories " + "in any of the configured local directories for job " + jobId.toString());
  }
}
