{
  if (getTotalRequiredResources(priority) <= 0) {
    return null;
  }
  RMContainer rmContainer=new RMContainerImpl(container,this.getApplicationAttemptId(),node.getNodeID(),this.rmContext.getDispatcher().getEventHandler(),this.rmContext.getContainerAllocationExpirer());
  rmContainer.handle(new RMContainerEvent(container.getId(),RMContainerEventType.START));
  Resources.addTo(currentConsumption,container.getResource());
  if (LOG.isDebugEnabled()) {
    LOG.debug("allocate: applicationId=" + container.getId().getAppId() + " container="+ container.getId()+ " host="+ container.getNodeId().getHost()+ " type="+ type);
  }
  newlyAllocatedContainers.add(rmContainer);
  liveContainers.put(container.getId(),rmContainer);
  appSchedulingInfo.allocate(type,node,priority,request,container);
  return rmContainer;
}
