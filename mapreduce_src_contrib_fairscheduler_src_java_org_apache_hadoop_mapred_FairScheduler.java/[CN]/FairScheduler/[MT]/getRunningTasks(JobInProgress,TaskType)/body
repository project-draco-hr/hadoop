{
  Set<TaskInProgress> tips=new HashSet<TaskInProgress>();
  if (type == TaskType.MAP) {
    tips.addAll(job.nonLocalRunningMaps);
    for (    Set<TaskInProgress> set : job.runningMapCache.values()) {
      tips.addAll(set);
    }
  }
 else {
    tips.addAll(job.runningReduces);
  }
  List<TaskStatus> statuses=new ArrayList<TaskStatus>();
  for (  TaskInProgress tip : tips) {
    for (    TaskAttemptID id : tip.getActiveTasks().keySet()) {
      TaskStatus stat=tip.getTaskStatus(id);
      if (stat != null) {
        statuses.add(stat);
      }
    }
  }
  return statuses;
}
