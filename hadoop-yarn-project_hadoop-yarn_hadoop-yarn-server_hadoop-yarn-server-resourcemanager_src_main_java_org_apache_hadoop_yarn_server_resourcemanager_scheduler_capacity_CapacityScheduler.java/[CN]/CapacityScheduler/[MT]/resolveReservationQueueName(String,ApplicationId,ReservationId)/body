{
  CSQueue queue=getQueue(queueName);
  if ((queue == null) || !(queue instanceof PlanQueue)) {
    return queueName;
  }
  if (reservationID != null) {
    String resQName=reservationID.toString();
    queue=getQueue(resQName);
    if (queue == null) {
      String message="Application " + applicationId + " submitted to a reservation which is not yet currently active: "+ resQName;
      this.rmContext.getDispatcher().getEventHandler().handle(new RMAppRejectedEvent(applicationId,message));
      return null;
    }
    if (!queue.getParent().getQueueName().equals(queueName)) {
      String message="Application: " + applicationId + " submitted to a reservation "+ resQName+ " which does not belong to the specified queue: "+ queueName;
      this.rmContext.getDispatcher().getEventHandler().handle(new RMAppRejectedEvent(applicationId,message));
      return null;
    }
    queueName=resQName;
  }
 else {
    queueName=queueName + ReservationConstants.DEFAULT_QUEUE_SUFFIX;
  }
  return queueName;
}
