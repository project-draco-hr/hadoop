{
  if (labelManager != null) {
    labelManager.deactivateNode(nodeInfo.getNodeID());
  }
  NodeId nodeId=nodeInfo.getNodeID();
  FiCaSchedulerNode node=nodeTracker.getNode(nodeId);
  if (node == null) {
    LOG.error("Attempting to remove non-existent node " + nodeId);
    return;
  }
  List<RMContainer> runningContainers=node.getCopiedListOfRunningContainers();
  for (  RMContainer container : runningContainers) {
    super.completedContainer(container,SchedulerUtils.createAbnormalContainerStatus(container.getContainerId(),SchedulerUtils.LOST_CONTAINER),RMContainerEventType.KILL);
  }
  RMContainer reservedContainer=node.getReservedContainer();
  if (reservedContainer != null) {
    super.completedContainer(reservedContainer,SchedulerUtils.createAbnormalContainerStatus(reservedContainer.getContainerId(),SchedulerUtils.LOST_CONTAINER),RMContainerEventType.KILL);
  }
  nodeTracker.removeNode(nodeId);
  Resource clusterResource=getClusterResource();
  root.updateClusterResource(clusterResource,new ResourceLimits(clusterResource));
  int numNodes=nodeTracker.nodeCount();
  if (scheduleAsynchronously && numNodes == 0) {
    asyncSchedulerThread.suspendSchedule();
  }
  LOG.info("Removed node " + nodeInfo.getNodeAddress() + " clusterResource: "+ getClusterResource());
}
