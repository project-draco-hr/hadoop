{
  FiCaSchedulerNode node=this.nodes.get(nodeInfo.getNodeID());
  if (node == null) {
    return;
  }
  Resources.subtractFrom(clusterResource,node.getRMNode().getTotalCapability());
  root.updateClusterResource(clusterResource);
  --numNodeManagers;
  if (scheduleAsynchronously && numNodeManagers == 0) {
    asyncSchedulerThread.suspendSchedule();
  }
  List<RMContainer> runningContainers=node.getRunningContainers();
  for (  RMContainer container : runningContainers) {
    completedContainer(container,SchedulerUtils.createAbnormalContainerStatus(container.getContainerId(),SchedulerUtils.LOST_CONTAINER),RMContainerEventType.KILL);
  }
  RMContainer reservedContainer=node.getReservedContainer();
  if (reservedContainer != null) {
    completedContainer(reservedContainer,SchedulerUtils.createAbnormalContainerStatus(reservedContainer.getContainerId(),SchedulerUtils.LOST_CONTAINER),RMContainerEventType.KILL);
  }
  this.nodes.remove(nodeInfo.getNodeID());
  LOG.info("Removed node " + nodeInfo.getNodeAddress() + " clusterResource: "+ clusterResource);
}
