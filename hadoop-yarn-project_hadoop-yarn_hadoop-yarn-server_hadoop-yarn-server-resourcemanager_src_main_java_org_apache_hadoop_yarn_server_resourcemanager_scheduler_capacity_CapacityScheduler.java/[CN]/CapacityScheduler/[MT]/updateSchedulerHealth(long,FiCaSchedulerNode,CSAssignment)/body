{
  NodeId nodeId=node.getNodeID();
  List<AssignmentInformation.AssignmentDetails> allocations=assignment.getAssignmentInformation().getAllocationDetails();
  List<AssignmentInformation.AssignmentDetails> reservations=assignment.getAssignmentInformation().getReservationDetails();
  if (!allocations.isEmpty()) {
    ContainerId allocatedContainerId=allocations.get(allocations.size() - 1).containerId;
    String allocatedQueue=allocations.get(allocations.size() - 1).queue;
    schedulerHealth.updateAllocation(now,nodeId,allocatedContainerId,allocatedQueue);
  }
  if (!reservations.isEmpty()) {
    ContainerId reservedContainerId=reservations.get(reservations.size() - 1).containerId;
    String reservedQueue=reservations.get(reservations.size() - 1).queue;
    schedulerHealth.updateReservation(now,nodeId,reservedContainerId,reservedQueue);
  }
  schedulerHealth.updateSchedulerReservationCounts(assignment.getAssignmentInformation().getNumReservations());
  schedulerHealth.updateSchedulerAllocationCounts(assignment.getAssignmentInformation().getNumAllocations());
  schedulerHealth.updateSchedulerRunDetails(now,assignment.getAssignmentInformation().getAllocated(),assignment.getAssignmentInformation().getReserved());
}
