{
  LOG.info("Removing queue: " + queueName);
  CSQueue q=this.getQueue(queueName);
  if (!(q instanceof ReservationQueue)) {
    throw new SchedulerDynamicEditException("The queue that we are asked " + "to remove (" + queueName + ") is not a ReservationQueue");
  }
  ReservationQueue disposableLeafQueue=(ReservationQueue)q;
  if (disposableLeafQueue.getNumApplications() > 0) {
    throw new SchedulerDynamicEditException("The queue " + queueName + " is not empty "+ disposableLeafQueue.getApplications().size()+ " active apps "+ disposableLeafQueue.getPendingApplications().size()+ " pending apps");
  }
  ((PlanQueue)disposableLeafQueue.getParent()).removeChildQueue(q);
  this.queues.remove(queueName);
  LOG.info("Removal of ReservationQueue " + queueName + " has succeeded");
}
