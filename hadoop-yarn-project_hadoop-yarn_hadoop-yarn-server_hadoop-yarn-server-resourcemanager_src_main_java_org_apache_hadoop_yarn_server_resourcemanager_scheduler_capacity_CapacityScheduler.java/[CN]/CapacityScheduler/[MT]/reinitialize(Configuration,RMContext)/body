{
  Configuration configuration=new Configuration(conf);
  if (!initialized) {
    this.rmContext=rmContext;
    this.conf=loadCapacitySchedulerConfiguration(configuration);
    validateConf(this.conf);
    this.minimumAllocation=this.conf.getMinimumAllocation();
    this.maximumAllocation=this.conf.getMaximumAllocation();
    this.calculator=this.conf.getResourceCalculator();
    this.usePortForNodeName=this.conf.getUsePortForNodeName();
    this.applications=new ConcurrentHashMap<ApplicationId,SchedulerApplication>();
    initializeQueues(this.conf);
    initialized=true;
    LOG.info("Initialized CapacityScheduler with " + "calculator=" + getResourceCalculator().getClass() + ", "+ "minimumAllocation=<"+ getMinimumResourceCapability()+ ">, "+ "maximumAllocation=<"+ getMaximumResourceCapability()+ ">");
  }
 else {
    CapacitySchedulerConfiguration oldConf=this.conf;
    this.conf=loadCapacitySchedulerConfiguration(configuration);
    validateConf(this.conf);
    try {
      LOG.info("Re-initializing queues...");
      reinitializeQueues(this.conf);
    }
 catch (    Throwable t) {
      this.conf=oldConf;
      throw new IOException("Failed to re-init queues",t);
    }
  }
}
