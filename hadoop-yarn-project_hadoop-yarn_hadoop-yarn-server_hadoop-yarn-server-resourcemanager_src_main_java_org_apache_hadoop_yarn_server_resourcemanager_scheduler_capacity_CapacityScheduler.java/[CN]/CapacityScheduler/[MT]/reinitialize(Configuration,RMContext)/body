{
  Configuration configuration=new Configuration(conf);
  CapacitySchedulerConfiguration oldConf=this.conf;
  this.conf=loadCapacitySchedulerConfiguration(configuration);
  validateConf(this.conf);
  try {
    LOG.info("Re-initializing queues...");
    refreshMaximumAllocation(this.conf.getMaximumAllocation());
    reinitializeQueues(this.conf);
  }
 catch (  Throwable t) {
    this.conf=oldConf;
    refreshMaximumAllocation(this.conf.getMaximumAllocation());
    throw new IOException("Failed to re-init queues",t);
  }
}
