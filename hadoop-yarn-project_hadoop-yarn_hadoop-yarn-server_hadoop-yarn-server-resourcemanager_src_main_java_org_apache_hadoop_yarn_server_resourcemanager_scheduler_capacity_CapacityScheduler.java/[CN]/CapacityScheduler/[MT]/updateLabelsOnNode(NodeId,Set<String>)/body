{
  FiCaSchedulerNode node=nodes.get(nodeId);
  if (null == node) {
    return;
  }
  if (node.getLabels().size() == newLabels.size() && node.getLabels().containsAll(newLabels)) {
    return;
  }
  for (  RMContainer rmContainer : node.getRunningContainers()) {
    ContainerId containerId=rmContainer.getContainerId();
    completedContainer(rmContainer,ContainerStatus.newInstance(containerId,ContainerState.COMPLETE,String.format("Container=%s killed since labels on the node=%s changed",containerId.toString(),nodeId.toString()),ContainerExitStatus.KILLED_BY_RESOURCEMANAGER),RMContainerEventType.KILL);
  }
  RMContainer reservedContainer=node.getReservedContainer();
  if (null != reservedContainer) {
    dropContainerReservation(reservedContainer);
  }
  node.updateLabels(newLabels);
}
