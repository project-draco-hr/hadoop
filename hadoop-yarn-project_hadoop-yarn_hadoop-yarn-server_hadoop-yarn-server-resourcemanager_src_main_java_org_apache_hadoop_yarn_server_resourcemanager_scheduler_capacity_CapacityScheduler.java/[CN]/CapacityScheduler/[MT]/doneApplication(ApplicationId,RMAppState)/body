{
  SchedulerApplication<FiCaSchedulerApp> application=applications.get(applicationId);
  if (application == null) {
    LOG.warn("Couldn't find application " + applicationId);
    return;
  }
  CSQueue queue=(CSQueue)application.getQueue();
  if (!(queue instanceof LeafQueue)) {
    LOG.error("Cannot finish application " + "from non-leaf queue: " + queue.getQueueName());
  }
 else {
    queue.finishApplication(applicationId,application.getUser());
  }
  application.stop(finalState);
  applications.remove(applicationId);
}
