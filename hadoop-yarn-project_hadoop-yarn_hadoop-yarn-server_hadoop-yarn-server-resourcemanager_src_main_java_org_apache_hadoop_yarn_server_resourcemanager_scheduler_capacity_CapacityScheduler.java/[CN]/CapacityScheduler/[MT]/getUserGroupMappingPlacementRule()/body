{
  boolean overrideWithQueueMappings=conf.getOverrideWithQueueMappings();
  LOG.info("Initialized queue mappings, override: " + overrideWithQueueMappings);
  List<UserGroupMappingPlacementRule.QueueMapping> newMappings=conf.getQueueMappings();
  for (  QueueMapping mapping : newMappings) {
    String mappingQueue=mapping.getQueue();
    if (!mappingQueue.equals(UserGroupMappingPlacementRule.CURRENT_USER_MAPPING) && !mappingQueue.equals(UserGroupMappingPlacementRule.PRIMARY_GROUP_MAPPING)) {
      CSQueue queue=queues.get(mappingQueue);
      if (queue == null || !(queue instanceof LeafQueue)) {
        throw new IOException("mapping contains invalid or non-leaf queue " + mappingQueue);
      }
    }
  }
  if (newMappings.size() > 0) {
    Groups groups=new Groups(conf);
    return new UserGroupMappingPlacementRule(overrideWithQueueMappings,newMappings,groups);
  }
  return null;
}
