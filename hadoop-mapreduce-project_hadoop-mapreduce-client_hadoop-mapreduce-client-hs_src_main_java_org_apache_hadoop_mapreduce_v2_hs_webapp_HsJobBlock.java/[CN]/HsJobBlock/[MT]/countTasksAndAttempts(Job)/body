{
  Map<TaskId,Task> tasks=job.getTasks();
  for (  Task task : tasks.values()) {
    Map<TaskAttemptId,TaskAttempt> attempts=task.getAttempts();
    for (    TaskAttempt attempt : attempts.values()) {
      int successful=0, failed=0, killed=0;
      if (TaskAttemptStateUI.NEW.correspondsTo(attempt.getState())) {
      }
 else       if (TaskAttemptStateUI.RUNNING.correspondsTo(attempt.getState())) {
      }
 else       if (TaskAttemptStateUI.SUCCESSFUL.correspondsTo(attempt.getState())) {
        ++successful;
      }
 else       if (TaskAttemptStateUI.FAILED.correspondsTo(attempt.getState())) {
        ++failed;
      }
 else       if (TaskAttemptStateUI.KILLED.correspondsTo(attempt.getState())) {
        ++killed;
      }
switch (task.getType()) {
case MAP:
        successfulMapAttempts+=successful;
      failedMapAttempts+=failed;
    killedMapAttempts+=killed;
  break;
case REDUCE:
successfulReduceAttempts+=successful;
failedReduceAttempts+=failed;
killedReduceAttempts+=killed;
break;
}
}
}
}
