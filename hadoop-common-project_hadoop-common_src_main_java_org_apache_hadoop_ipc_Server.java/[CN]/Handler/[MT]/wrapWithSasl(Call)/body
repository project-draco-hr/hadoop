{
  if (call.connection.saslServer != null) {
    byte[] token=call.rpcResponse.array();
synchronized (call.connection.saslServer) {
      token=call.connection.saslServer.wrap(token,0,token.length);
    }
    if (LOG.isDebugEnabled())     LOG.debug("Adding saslServer wrapped token of size " + token.length + " as call response.");
    RpcResponseHeaderProto saslHeader=RpcResponseHeaderProto.newBuilder().setCallId(AuthProtocol.SASL.callId).setStatus(RpcStatusProto.SUCCESS).build();
    RpcSaslProto saslMessage=RpcSaslProto.newBuilder().setState(SaslState.WRAP).setToken(ByteString.copyFrom(token)).build();
    setupResponse(call,saslHeader,new RpcResponseWrapper(saslMessage));
  }
}
