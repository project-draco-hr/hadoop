{
  if (call.connection.saslServer != null) {
    byte[] token=response.toByteArray();
synchronized (call.connection.saslServer) {
      token=call.connection.saslServer.wrap(token,0,token.length);
    }
    if (LOG.isDebugEnabled())     LOG.debug("Adding saslServer wrapped token of size " + token.length + " as call response.");
    response.reset();
    DataOutputStream saslOut=new DataOutputStream(response);
    saslOut.writeInt(token.length);
    saslOut.write(token,0,token.length);
  }
}
