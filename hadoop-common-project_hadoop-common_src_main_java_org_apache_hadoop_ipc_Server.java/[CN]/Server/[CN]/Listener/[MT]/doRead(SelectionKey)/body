{
  int count;
  Connection c=(Connection)key.attachment();
  if (c == null) {
    return;
  }
  c.setLastContact(Time.now());
  try {
    count=c.readAndProcess();
  }
 catch (  InterruptedException ieo) {
    LOG.info(Thread.currentThread().getName() + ": readAndProcess caught InterruptedException",ieo);
    throw ieo;
  }
catch (  Exception e) {
    if (!(e instanceof WrappedRpcServerExceptionSuppressed)) {
      LOG.info(Thread.currentThread().getName() + ": readAndProcess from client " + c.getHostAddress()+ " threw exception ["+ e+ "]",(e instanceof WrappedRpcServerException) ? null : e);
    }
    count=-1;
  }
  if (count < 0) {
    closeConnection(c);
    c=null;
  }
 else {
    c.setLastContact(Time.now());
  }
}
