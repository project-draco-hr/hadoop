{
  try {
    if (user != null && user.getRealUser() != null && (authMethod != AuthMethod.DIGEST)) {
      ProxyUsers.authorize(user,this.getHostAddress(),conf);
    }
    authorize(user,protocolName,getHostInetAddress());
    if (LOG.isDebugEnabled()) {
      LOG.debug("Successfully authorized " + connectionContext);
    }
    rpcMetrics.incrAuthorizationSuccesses();
  }
 catch (  AuthorizationException ae) {
    rpcMetrics.incrAuthorizationFailures();
    setupResponse(authFailedResponse,authFailedCall,RpcStatusProto.FATAL,RpcErrorCodeProto.FATAL_UNAUTHORIZED,null,ae.getClass().getName(),ae.getMessage());
    responder.doRespond(authFailedCall);
    return false;
  }
  return true;
}
