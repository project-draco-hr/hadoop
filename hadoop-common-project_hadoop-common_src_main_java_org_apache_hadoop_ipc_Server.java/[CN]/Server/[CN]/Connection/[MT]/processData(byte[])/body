{
  DataInputStream dis=new DataInputStream(new ByteArrayInputStream(buf));
  RpcPayloadHeader header=new RpcPayloadHeader();
  header.readFields(dis);
  if (LOG.isDebugEnabled())   LOG.debug(" got #" + header.getCallId());
  if (header.getOperation() != RpcPayloadOperation.RPC_FINAL_PAYLOAD) {
    throw new IOException("IPC Server does not implement operation" + header.getOperation());
  }
  Writable rpcRequest;
  try {
    rpcRequest=ReflectionUtils.newInstance(paramClass,conf);
    rpcRequest.readFields(dis);
  }
 catch (  Throwable t) {
    LOG.warn("Unable to read call parameters for client " + getHostAddress(),t);
    final Call readParamsFailedCall=new Call(header.getCallId(),null,this);
    ByteArrayOutputStream responseBuffer=new ByteArrayOutputStream();
    setupResponse(responseBuffer,readParamsFailedCall,Status.FATAL,null,t.getClass().getName(),"IPC server unable to read call parameters: " + t.getMessage());
    responder.doRespond(readParamsFailedCall);
    return;
  }
  Call call=new Call(header.getCallId(),rpcRequest,this,header.getkind());
  callQueue.put(call);
  incRpcCount();
}
