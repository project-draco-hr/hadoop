{
  AuthenticationMethod confAuthenticationMethod=SecurityUtil.getAuthenticationMethod(conf);
  List<AuthMethod> authMethods=new ArrayList<AuthMethod>();
  if (confAuthenticationMethod == AuthenticationMethod.TOKEN) {
    if (secretManager == null) {
      throw new IllegalArgumentException(AuthenticationMethod.TOKEN + " authentication requires a secret manager");
    }
  }
 else   if (secretManager != null) {
    LOG.debug(AuthenticationMethod.TOKEN + " authentication enabled for secret manager");
    authMethods.add(AuthenticationMethod.TOKEN.getAuthMethod());
  }
  authMethods.add(confAuthenticationMethod.getAuthMethod());
  LOG.debug("Server accepts auth methods:" + authMethods);
  return authMethods;
}
