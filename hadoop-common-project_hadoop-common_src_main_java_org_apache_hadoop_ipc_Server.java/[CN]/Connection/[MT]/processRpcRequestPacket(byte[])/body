{
  if (saslContextEstablished && useWrap) {
    if (LOG.isDebugEnabled())     LOG.debug("Have read input token of size " + buf.length + " for processing by saslServer.unwrap()");
    final byte[] plaintextData=saslServer.unwrap(buf,0,buf.length);
    unwrapPacketAndProcessRpcs(plaintextData);
  }
 else {
    processOneRpc(buf);
  }
}
