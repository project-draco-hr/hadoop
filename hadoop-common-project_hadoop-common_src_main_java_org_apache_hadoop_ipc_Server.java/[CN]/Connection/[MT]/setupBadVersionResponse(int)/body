{
  String errMsg="Server IPC version " + CURRENT_VERSION + " cannot communicate with client version "+ clientVersion;
  ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  if (clientVersion >= 9) {
    RpcCall fakeCall=new RpcCall(this,-1);
    setupResponse(fakeCall,RpcStatusProto.FATAL,RpcErrorCodeProto.FATAL_VERSION_MISMATCH,null,VersionMismatch.class.getName(),errMsg);
    fakeCall.sendResponse();
  }
 else   if (clientVersion >= 3) {
    RpcCall fakeCall=new RpcCall(this,-1);
    setupResponseOldVersionFatal(buffer,fakeCall,null,VersionMismatch.class.getName(),errMsg);
    fakeCall.sendResponse();
  }
 else   if (clientVersion == 2) {
    RpcCall fakeCall=new RpcCall(this,0);
    DataOutputStream out=new DataOutputStream(buffer);
    out.writeInt(0);
    out.writeBoolean(true);
    WritableUtils.writeString(out,VersionMismatch.class.getName());
    WritableUtils.writeString(out,errMsg);
    fakeCall.setResponse(ByteBuffer.wrap(buffer.toByteArray()));
    fakeCall.sendResponse();
  }
}
