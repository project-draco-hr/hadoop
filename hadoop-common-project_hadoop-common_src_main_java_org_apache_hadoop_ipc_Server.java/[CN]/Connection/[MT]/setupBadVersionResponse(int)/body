{
  String errMsg="Server IPC version " + CURRENT_VERSION + " cannot communicate with client version "+ clientVersion;
  ByteArrayOutputStream buffer=new ByteArrayOutputStream();
  if (clientVersion >= 9) {
    Call fakeCall=new Call(-1,RpcConstants.INVALID_RETRY_COUNT,null,this);
    setupResponse(buffer,fakeCall,RpcStatusProto.FATAL,RpcErrorCodeProto.FATAL_VERSION_MISMATCH,null,VersionMismatch.class.getName(),errMsg);
    responder.doRespond(fakeCall);
  }
 else   if (clientVersion >= 3) {
    Call fakeCall=new Call(-1,RpcConstants.INVALID_RETRY_COUNT,null,this);
    setupResponseOldVersionFatal(buffer,fakeCall,null,VersionMismatch.class.getName(),errMsg);
    responder.doRespond(fakeCall);
  }
 else   if (clientVersion == 2) {
    Call fakeCall=new Call(0,RpcConstants.INVALID_RETRY_COUNT,null,this);
    DataOutputStream out=new DataOutputStream(buffer);
    out.writeInt(0);
    out.writeBoolean(true);
    WritableUtils.writeString(out,VersionMismatch.class.getName());
    WritableUtils.writeString(out,errMsg);
    fakeCall.setResponse(ByteBuffer.wrap(buffer.toByteArray()));
    responder.doRespond(fakeCall);
  }
}
