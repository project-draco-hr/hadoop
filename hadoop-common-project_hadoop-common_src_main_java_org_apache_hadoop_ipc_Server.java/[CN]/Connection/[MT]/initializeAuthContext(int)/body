{
  AuthProtocol authProtocol=AuthProtocol.valueOf(authType);
  if (authProtocol == null) {
    IOException ioe=new IpcException("Unknown auth protocol:" + authType);
    doSaslReply(ioe);
    throw ioe;
  }
  boolean isSimpleEnabled=enabledAuthMethods.contains(AuthMethod.SIMPLE);
switch (authProtocol) {
case NONE:
{
      if (!isSimpleEnabled) {
        IOException ioe=new AccessControlException("SIMPLE authentication is not enabled." + "  Available:" + enabledAuthMethods);
        doSaslReply(ioe);
        throw ioe;
      }
      break;
    }
case SASL:
{
    if (isSimpleEnabled && enabledAuthMethods.size() == 1) {
      skipInitialSaslHandshake=true;
      doSaslReply(buildSaslResponse(SaslState.SUCCESS,null));
    }
    break;
  }
}
return authProtocol;
}
