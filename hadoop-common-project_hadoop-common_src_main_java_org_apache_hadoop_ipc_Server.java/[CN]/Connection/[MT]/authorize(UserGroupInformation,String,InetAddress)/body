{
  if (authorize) {
    if (protocolName == null) {
      throw new AuthorizationException("Null protocol not authorized");
    }
    Class<?> protocol=null;
    try {
      protocol=getProtocolClass(protocolName,getConf());
    }
 catch (    ClassNotFoundException cfne) {
      throw new AuthorizationException("Unknown protocol: " + protocolName);
    }
    serviceAuthorizationManager.authorize(user,protocol,getConf(),addr);
  }
}
