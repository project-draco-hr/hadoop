{
  if (!saslMessage.hasToken()) {
    throw new SaslException("Client did not send a token");
  }
  byte[] saslToken=saslMessage.getToken().toByteArray();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Have read input token of size " + saslToken.length + " for processing by saslServer.evaluateResponse()");
  }
  saslToken=saslServer.evaluateResponse(saslToken);
  return buildSaslResponse(saslServer.isComplete() ? SaslState.SUCCESS : SaslState.CHALLENGE,saslToken);
}
