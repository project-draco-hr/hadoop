{
  keepRunning=false;
  if (failoverThread != null) {
    failoverThread.interrupt();
    try {
      failoverThread.join();
    }
 catch (    InterruptedException ex) {
      LOG.error("Error joining with failover thread",ex);
    }
  }
  cluster.stop();
}
