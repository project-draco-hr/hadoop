{
  conf.setBoolean(YarnConfiguration.RECOVERY_ENABLED,true);
  conf.setBoolean(YarnConfiguration.AUTO_FAILOVER_ENABLED,false);
  cluster=new MiniYARNClusterForHATesting(TestRMFailover.class.getName(),2,numOfNMs,1,1,false,overrideClientRMService,overrideRTS,overrideApplicationMasterService);
  cluster.resetStartFailoverFlag(false);
  cluster.init(conf);
  cluster.start();
  getAdminService(0).transitionToActive(req);
  assertFalse("RM never turned active",-1 == cluster.getActiveRMIndex());
  verifyConnections();
  explicitFailover();
  verifyConnections();
  failoverThread=createAndStartFailoverThread();
}
