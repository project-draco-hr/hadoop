{
  scheduler=new FairScheduler();
  conf=new YarnConfiguration();
  conf.setClass(YarnConfiguration.RM_SCHEDULER,FairScheduler.class,ResourceScheduler.class);
  conf.setInt(YarnConfiguration.RM_SCHEDULER_MINIMUM_ALLOCATION_MB,0);
  conf.setInt(FairSchedulerConfiguration.RM_SCHEDULER_INCREMENT_ALLOCATION_MB,1024);
  conf.setInt(YarnConfiguration.RM_SCHEDULER_MAXIMUM_ALLOCATION_MB,10240);
  conf.setBoolean(FairSchedulerConfiguration.ASSIGN_MULTIPLE,false);
  conf.setFloat(FairSchedulerConfiguration.PREEMPTION_THRESHOLD,0f);
  conf.setFloat(FairSchedulerConfiguration.RM_SCHEDULER_RESERVATION_THRESHOLD_INCREMENT_MULTIPLE,TEST_RESERVATION_THRESHOLD);
  resourceManager=new MockRM(conf);
  ((AsyncDispatcher)resourceManager.getRMContext().getDispatcher()).start();
  resourceManager.getRMContext().getStateStore().start();
  resourceManager.getRMContext().getContainerTokenSecretManager().rollMasterKey();
  scheduler.setRMContext(resourceManager.getRMContext());
}
