{
  LOG.info("Exiting...");
  try {
    killComponent(factory,FAC_SLEEP);
    killComponent(submitter,SUB_SLEEP);
    killComponent(monitor,MON_SLEEP);
    killComponent(statistics,MON_SLEEP);
  }
  finally {
    if (monitor == null) {
      return;
    }
    List<JobStats> remainingJobs=monitor.getRemainingJobs();
    if (remainingJobs.isEmpty()) {
      return;
    }
    LOG.info("Killing running jobs...");
    for (    JobStats stats : remainingJobs) {
      Job job=stats.getJob();
      try {
        if (!job.isComplete()) {
          job.killJob();
          LOG.info("Killed " + job.getJobName() + " ("+ job.getJobID()+ ")");
        }
 else {
          if (job.isSuccessful()) {
            monitor.onSuccess(job);
          }
 else {
            monitor.onFailure(job);
          }
        }
      }
 catch (      IOException e) {
        LOG.warn("Failure killing " + job.getJobName(),e);
      }
catch (      Exception e) {
        LOG.error("Unexpected exception",e);
      }
    }
    LOG.info("Done.");
  }
}
