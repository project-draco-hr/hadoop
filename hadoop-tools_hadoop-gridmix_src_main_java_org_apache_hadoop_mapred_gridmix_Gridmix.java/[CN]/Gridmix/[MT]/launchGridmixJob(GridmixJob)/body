{
  submitter.add(job);
  try {
    while (!job.isSubmitted()) {
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException ie) {
      }
    }
    job.getJob().waitForCompletion(false);
  }
 catch (  ClassNotFoundException e) {
    throw new IOException("Internal error",e);
  }
  if (!job.getJob().isSuccessful()) {
    throw new IOException(job.getJob().getJobName() + " job failed!");
  }
}
