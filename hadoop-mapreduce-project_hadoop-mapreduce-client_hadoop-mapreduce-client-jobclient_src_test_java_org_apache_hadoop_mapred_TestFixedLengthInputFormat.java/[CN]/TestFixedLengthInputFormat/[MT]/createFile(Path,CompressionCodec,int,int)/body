{
  ArrayList<String> recordList=new ArrayList<String>(numRecords);
  OutputStream ostream=localFs.create(targetFile);
  if (codec != null) {
    ostream=codec.createOutputStream(ostream);
  }
  Writer writer=new OutputStreamWriter(ostream);
  try {
    StringBuffer sb=new StringBuffer();
    for (int i=0; i < numRecords; i++) {
      for (int j=0; j < recordLen; j++) {
        sb.append(chars[charRand.nextInt(chars.length)]);
      }
      String recordData=sb.toString();
      recordList.add(recordData);
      writer.write(recordData);
      sb.setLength(0);
    }
  }
  finally {
    writer.close();
  }
  return recordList;
}
