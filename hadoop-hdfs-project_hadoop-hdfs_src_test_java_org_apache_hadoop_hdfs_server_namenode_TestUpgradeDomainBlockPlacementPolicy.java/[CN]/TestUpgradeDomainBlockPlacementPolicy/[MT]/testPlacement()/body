{
  String clientMachine="127.0.0.1";
  for (int i=0; i < 5; i++) {
    String src="/test-" + i;
    HdfsFileStatus fileStatus=namesystem.startFile(src,perm,clientMachine,clientMachine,EnumSet.of(CreateFlag.CREATE),true,REPLICATION_FACTOR,DEFAULT_BLOCK_SIZE,null,false);
    LocatedBlock locatedBlock=nameNodeRpc.addBlock(src,clientMachine,null,null,fileStatus.getFileId(),null,null);
    assertEquals("Block should be allocated sufficient locations",REPLICATION_FACTOR,locatedBlock.getLocations().length);
    Set<DatanodeInfo> locs=new HashSet<>(Arrays.asList(locatedBlock.getLocations()));
    for (    DatanodeID datanodeID : expectedDatanodeIDs) {
      locs.contains(datanodeID);
    }
    nameNodeRpc.abandonBlock(locatedBlock.getBlock(),fileStatus.getFileId(),src,clientMachine);
  }
}
