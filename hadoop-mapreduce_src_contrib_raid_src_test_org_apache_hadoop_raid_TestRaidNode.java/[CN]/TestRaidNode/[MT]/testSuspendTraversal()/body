{
  LOG.info("Test testSuspendTraversal started.");
  long targetReplication=2;
  long metaReplication=2;
  long stripeLength=3;
  short srcReplication=1;
  createClusters(false);
  ConfigBuilder cb=new ConfigBuilder();
  cb.addPolicy("policy1","/user/dhruba/raidtest",srcReplication,targetReplication,metaReplication,stripeLength);
  cb.persist();
  RaidNode cnode=null;
  try {
    createTestFiles("/user/dhruba/raidtest/1/","/destraid/user/dhruba/raidtest/1");
    createTestFiles("/user/dhruba/raidtest/2/","/destraid/user/dhruba/raidtest/2");
    createTestFiles("/user/dhruba/raidtest/3/","/destraid/user/dhruba/raidtest/3");
    createTestFiles("/user/dhruba/raidtest/4/","/destraid/user/dhruba/raidtest/4");
    LOG.info("Test testSuspendTraversal created test files");
    Configuration localConf=new Configuration(conf);
    localConf.set(RaidNode.RAID_LOCATION_KEY,"/destraid");
    localConf.setInt("raid.distraid.max.files",3);
    localConf.setInt("raid.directorytraversal.threads",1);
    final int numJobsExpected=2;
    cnode=RaidNode.createRaidNode(null,localConf);
    long start=System.currentTimeMillis();
    final int MAX_WAITTIME=300000;
    assertTrue("cnode is not DistRaidNode",cnode instanceof DistRaidNode);
    DistRaidNode dcnode=(DistRaidNode)cnode;
    start=System.currentTimeMillis();
    while (dcnode.jobMonitor.jobsSucceeded() < numJobsExpected && System.currentTimeMillis() - start < MAX_WAITTIME) {
      Thread.sleep(1000);
    }
    assertEquals(dcnode.jobMonitor.jobsMonitored(),numJobsExpected);
    assertEquals(dcnode.jobMonitor.jobsSucceeded(),numJobsExpected);
    LOG.info("Test testSuspendTraversal successful.");
  }
 catch (  Exception e) {
    LOG.info("testSuspendTraversal Exception " + e + StringUtils.stringifyException(e));
    throw e;
  }
 finally {
    if (cnode != null) {
      cnode.stop();
      cnode.join();
    }
    stopClusters();
  }
  LOG.info("Test testSuspendTraversal completed.");
}
