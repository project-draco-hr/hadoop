{
  int idx=startPos;
  for (  Map.Entry<K,V> entry : keyValues.entrySet()) {
    V value=entry.getValue();
    if (value instanceof Collection) {
      ps.setString(idx++,StringUtils.join((Collection)value,AGGREGATION_STORAGE_SEPARATOR));
    }
 else {
      if (converToBytes) {
        try {
          ps.setBytes(idx++,GenericObjectMapper.write(entry.getValue()));
        }
 catch (        IOException ie) {
          LOG.error("Exception in converting values into bytes " + ie.getMessage());
          throw new SQLException(ie);
        }
      }
 else {
        ps.setString(idx++,value.toString());
      }
    }
  }
  return idx;
}
