{
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,p,conf);
  ArrayList<K> parts=new ArrayList<K>();
  K key=ReflectionUtils.newInstance(keyClass,conf);
  NullWritable value=NullWritable.get();
  try {
    while (reader.next(key,value)) {
      parts.add(key);
      key=ReflectionUtils.newInstance(keyClass,conf);
    }
    reader.close();
    reader=null;
  }
  finally {
    IOUtils.cleanup(LOG,reader);
  }
  return parts.toArray((K[])Array.newInstance(keyClass,parts.size()));
}
