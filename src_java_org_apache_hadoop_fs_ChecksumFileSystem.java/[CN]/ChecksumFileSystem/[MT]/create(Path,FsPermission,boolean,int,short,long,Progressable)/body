{
  Path parent=f.getParent();
  if (parent != null && !mkdirs(parent)) {
    throw new IOException("Mkdirs failed to create " + parent);
  }
  final FSDataOutputStream out=new FSDataOutputStream(new ChecksumFSOutputSummer(this,f,overwrite,bufferSize,replication,blockSize,progress),null);
  if (permission != null) {
    setPermission(f,permission);
  }
  return out;
}
