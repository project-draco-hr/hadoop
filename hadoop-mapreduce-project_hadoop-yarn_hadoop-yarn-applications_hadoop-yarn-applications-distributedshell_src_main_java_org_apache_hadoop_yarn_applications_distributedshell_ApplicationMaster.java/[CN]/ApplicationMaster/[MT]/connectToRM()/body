{
  YarnConfiguration yarnConf=new YarnConfiguration(conf);
  InetSocketAddress rmAddress=yarnConf.getSocketAddr(YarnConfiguration.RM_SCHEDULER_ADDRESS,YarnConfiguration.DEFAULT_RM_SCHEDULER_ADDRESS,YarnConfiguration.DEFAULT_RM_SCHEDULER_PORT);
  LOG.info("Connecting to ResourceManager at " + rmAddress);
  return ((AMRMProtocol)rpc.getProxy(AMRMProtocol.class,rmAddress,conf));
}
