{
  FsPermission perms=file.getPermission();
  int existing=perms.toShort();
  boolean exeOk=file.isDir() || (existing & 0111) != 0;
  int newperms=(applyChmod(stickyBitType,stickyMode,(existing >>> 9),false) << 9 | applyChmod(userType,userMode,(existing >>> 6) & 7,exeOk) << 6 | applyChmod(groupType,groupMode,(existing >>> 3) & 7,exeOk) << 3 | applyChmod(othersType,othersMode,existing & 7,exeOk));
  if (existing != newperms) {
    try {
      srcFs.setPermission(file.getPath(),new FsPermission((short)newperms));
    }
 catch (    IOException e) {
      System.err.println(getName() + ": changing permissions of '" + file.getPath()+ "':"+ e.getMessage());
    }
  }
}
