{
  long localstart=System.currentTimeMillis();
  boolean fileComplete=false;
  while (!fileComplete) {
    fileComplete=dfsClient.namenode.complete(src,dfsClient.clientName,last);
    if (!fileComplete) {
      if (!dfsClient.clientRunning || (dfsClient.hdfsTimeout > 0 && localstart + dfsClient.hdfsTimeout < System.currentTimeMillis())) {
        String msg="Unable to close file because dfsclient " + " was unable to contact the HDFS servers." + " clientRunning " + dfsClient.clientRunning + " hdfsTimeout "+ dfsClient.hdfsTimeout;
        DFSClient.LOG.info(msg);
        throw new IOException(msg);
      }
      try {
        Thread.sleep(400);
        if (System.currentTimeMillis() - localstart > 5000) {
          DFSClient.LOG.info("Could not complete file " + src + " retrying...");
        }
      }
 catch (      InterruptedException ie) {
      }
    }
  }
}
