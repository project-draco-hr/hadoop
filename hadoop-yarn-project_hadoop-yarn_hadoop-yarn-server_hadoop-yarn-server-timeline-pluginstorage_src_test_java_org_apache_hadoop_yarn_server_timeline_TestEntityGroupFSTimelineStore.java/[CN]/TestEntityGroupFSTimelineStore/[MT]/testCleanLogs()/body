{
  Path irrelevantFilePath=new Path(TEST_DONE_DIR_PATH,"irrelevant.log");
  FSDataOutputStream stream=fs.create(irrelevantFilePath);
  stream.close();
  Path irrelevantDirPath=new Path(TEST_DONE_DIR_PATH,"irrelevant");
  fs.mkdirs(irrelevantDirPath);
  Path doneAppHomeDir=new Path(new Path(TEST_DONE_DIR_PATH,"0000"),"001");
  Path appDirClean=new Path(doneAppHomeDir,TEST_APP_DIR_NAME);
  Path attemptDirClean=new Path(appDirClean,TEST_ATTEMPT_DIR_NAME);
  fs.mkdirs(attemptDirClean);
  Path filePath=new Path(attemptDirClean,"test.log");
  stream=fs.create(filePath);
  stream.close();
  Path appDirHoldByFile=new Path(doneAppHomeDir,TEST_APP_DIR_NAME + "1");
  Path attemptDirHoldByFile=new Path(appDirHoldByFile,TEST_ATTEMPT_DIR_NAME);
  fs.mkdirs(attemptDirHoldByFile);
  Path filePathHold=new Path(attemptDirHoldByFile,"test1.log");
  stream=fs.create(filePathHold);
  stream.close();
  Path appDirHoldByDir=new Path(doneAppHomeDir,TEST_APP_DIR_NAME + "2");
  Path attemptDirHoldByDir=new Path(appDirHoldByDir,TEST_ATTEMPT_DIR_NAME);
  fs.mkdirs(attemptDirHoldByDir);
  Path dirPathHold=new Path(attemptDirHoldByDir,"hold");
  fs.mkdirs(dirPathHold);
  Path appDirEmpty=new Path(doneAppHomeDir,TEST_APP_DIR_NAME + "3");
  Path attemptDirEmpty=new Path(appDirEmpty,TEST_ATTEMPT_DIR_NAME);
  fs.mkdirs(attemptDirEmpty);
  Path dirPathEmpty=new Path(attemptDirEmpty,"empty");
  fs.mkdirs(dirPathEmpty);
  store.cleanLogs(TEST_DONE_DIR_PATH,fs,10000);
  assertTrue(fs.exists(irrelevantDirPath));
  assertTrue(fs.exists(irrelevantFilePath));
  assertTrue(fs.exists(filePath));
  assertTrue(fs.exists(filePathHold));
  assertTrue(fs.exists(dirPathHold));
  assertTrue(fs.exists(dirPathEmpty));
  Thread.sleep(2000);
  stream=fs.append(filePathHold);
  stream.writeBytes("append");
  stream.close();
  fs.mkdirs(new Path(dirPathHold,"holdByMe"));
  store.cleanLogs(TEST_DONE_DIR_PATH,fs,1000);
  assertTrue(fs.exists(irrelevantDirPath));
  assertTrue(fs.exists(irrelevantFilePath));
  assertTrue(fs.exists(filePathHold));
  assertTrue(fs.exists(dirPathHold));
  assertTrue(fs.exists(doneAppHomeDir));
  assertFalse(fs.exists(appDirClean));
  assertFalse(fs.exists(appDirEmpty));
}
