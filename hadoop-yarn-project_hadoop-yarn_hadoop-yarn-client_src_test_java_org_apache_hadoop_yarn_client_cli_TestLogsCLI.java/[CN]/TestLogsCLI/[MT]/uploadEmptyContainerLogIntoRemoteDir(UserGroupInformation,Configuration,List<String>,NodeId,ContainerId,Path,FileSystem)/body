{
  Path path=new Path(appDir,LogAggregationUtils.getNodeString(nodeId) + System.currentTimeMillis());
  AggregatedLogFormat.LogWriter writer=new AggregatedLogFormat.LogWriter(configuration,path,ugi);
  writer.writeApplicationOwner(ugi.getUserName());
  Map<ApplicationAccessType,String> appAcls=new HashMap<ApplicationAccessType,String>();
  appAcls.put(ApplicationAccessType.VIEW_APP,ugi.getUserName());
  writer.writeApplicationACLs(appAcls);
  DataOutputStream out=writer.getWriter().prepareAppendKey(-1);
  new AggregatedLogFormat.LogKey(containerId).write(out);
  out.close();
  out=writer.getWriter().prepareAppendValue(-1);
  new AggregatedLogFormat.LogValue(rootLogDirs,containerId,UserGroupInformation.getCurrentUser().getShortUserName()).write(out,new HashSet<File>());
  out.close();
  writer.close();
}
