{
  int counter=0;
  while (rs.getRootQueueMetrics().getAllocatedMB() != clusterMemory) {
    nm1.nodeHeartbeat(true);
    Thread.sleep(100);
    if (counter++ == 50) {
      Assert.fail("Wait for cluster memory is timed out.Expected=" + clusterMemory + " Actual="+ rs.getRootQueueMetrics().getAllocatedMB());
    }
  }
}
