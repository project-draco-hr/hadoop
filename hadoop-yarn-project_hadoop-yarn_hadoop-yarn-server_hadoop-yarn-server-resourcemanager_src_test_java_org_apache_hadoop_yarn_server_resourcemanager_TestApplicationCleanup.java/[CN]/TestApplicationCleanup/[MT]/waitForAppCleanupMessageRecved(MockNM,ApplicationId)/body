{
  while (true) {
    NodeHeartbeatResponse response=nm.nodeHeartbeat(true);
    if (response.getApplicationsToCleanup() != null && response.getApplicationsToCleanup().size() == 1 && appId.equals(response.getApplicationsToCleanup().get(0))) {
      return;
    }
    LOG.info("Haven't got application=" + appId.toString() + " in cleanup list from node heartbeat response, "+ "sleep for a while before next heartbeat");
    Thread.sleep(1000);
  }
}
