{
  URI[] tarchives=DistributedCache.getCacheArchives(job);
  URI[] tfiles=DistributedCache.getCacheFiles(job);
  int size=(tarchives != null ? tarchives.length : 0) + (tfiles != null ? tfiles.length : 0);
  Path[] ps=new Path[size];
  int i=0;
  if (tarchives != null) {
    for (i=0; i < tarchives.length; i++) {
      ps[i]=new Path(tarchives[i].toString());
    }
  }
  if (tfiles != null) {
    for (int j=0; j < tfiles.length; j++) {
      ps[i + j]=new Path(tfiles[j].toString());
    }
  }
  TokenCache.obtainTokensForNamenodes(credentials,ps,job);
}
