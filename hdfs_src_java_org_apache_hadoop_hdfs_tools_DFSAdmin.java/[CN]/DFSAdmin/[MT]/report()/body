{
  DistributedFileSystem dfs=getDFS();
  FsStatus ds=dfs.getStatus();
  long capacity=ds.getCapacity();
  long used=ds.getUsed();
  long remaining=ds.getRemaining();
  long presentCapacity=used + remaining;
  boolean mode=dfs.setSafeMode(FSConstants.SafeModeAction.SAFEMODE_GET);
  UpgradeStatusReport status=dfs.distributedUpgradeProgress(UpgradeAction.GET_STATUS);
  if (mode) {
    System.out.println("Safe mode is ON");
  }
  if (status != null) {
    System.out.println(status.getStatusText(false));
  }
  System.out.println("Configured Capacity: " + capacity + " ("+ StringUtils.byteDesc(capacity)+ ")");
  System.out.println("Present Capacity: " + presentCapacity + " ("+ StringUtils.byteDesc(presentCapacity)+ ")");
  System.out.println("DFS Remaining: " + remaining + " ("+ StringUtils.byteDesc(remaining)+ ")");
  System.out.println("DFS Used: " + used + " ("+ StringUtils.byteDesc(used)+ ")");
  System.out.println("DFS Used%: " + StringUtils.limitDecimalTo2(((1.0 * used) / presentCapacity) * 100) + "%");
  System.out.println("Under replicated blocks: " + dfs.getUnderReplicatedBlocksCount());
  System.out.println("Blocks with corrupt replicas: " + dfs.getCorruptBlocksCount());
  System.out.println("Missing blocks: " + dfs.getMissingBlocksCount());
  System.out.println();
  System.out.println("-------------------------------------------------");
  DatanodeInfo[] live=dfs.getDataNodeStats(DatanodeReportType.LIVE);
  DatanodeInfo[] dead=dfs.getDataNodeStats(DatanodeReportType.DEAD);
  System.out.println("Datanodes available: " + live.length + " ("+ (live.length + dead.length)+ " total, "+ dead.length+ " dead)\n");
  if (live.length > 0) {
    System.out.println("Live datanodes:");
    for (    DatanodeInfo dn : live) {
      System.out.println(dn.getDatanodeReport());
      System.out.println();
    }
  }
  if (dead.length > 0) {
    System.out.println("Dead datanodes:");
    for (    DatanodeInfo dn : dead) {
      System.out.println(dn.getDatanodeReport());
      System.out.println();
    }
  }
}
