{
  buf.position(bufPos);
  int n=((ByteBufferReadable)in).read(buf);
  Assert.assertEquals(bufPos + n,buf.position());
  byte[] readData=new byte[n];
  buf.rewind();
  buf.position(bufPos);
  buf.get(readData);
  byte[] expectedData=new byte[n];
  System.arraycopy(data,0,expectedData,0,n);
  Assert.assertArrayEquals(readData,expectedData);
}
