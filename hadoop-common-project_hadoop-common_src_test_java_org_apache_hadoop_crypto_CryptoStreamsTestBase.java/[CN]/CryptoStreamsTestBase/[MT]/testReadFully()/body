{
  OutputStream out=getOutputStream(defaultBufferSize);
  writeData(out);
  InputStream in=getInputStream(defaultBufferSize);
  final int len1=dataLen / 4;
  byte[] readData=new byte[len1];
  readAll(in,readData,0,len1);
  byte[] expectedData=new byte[len1];
  System.arraycopy(data,0,expectedData,0,len1);
  Assert.assertArrayEquals(readData,expectedData);
  readFullyCheck(in,dataLen / 3);
  readData=new byte[len1];
  readAll(in,readData,0,len1);
  expectedData=new byte[len1];
  System.arraycopy(data,len1,expectedData,0,len1);
  Assert.assertArrayEquals(readData,expectedData);
  readFullyCheck(in,dataLen / 2);
  readData=new byte[len1];
  readAll(in,readData,0,len1);
  expectedData=new byte[len1];
  System.arraycopy(data,2 * len1,expectedData,0,len1);
  Assert.assertArrayEquals(readData,expectedData);
  in.close();
}
