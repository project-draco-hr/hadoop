{
  OutputStream out=getOutputStream(defaultBufferSize);
  writeData(out);
  InputStream in=getInputStream(defaultBufferSize);
  byte[] result=new byte[dataLen];
  int n1=readAll(in,result,0,dataLen / 3);
  Assert.assertEquals(in.available(),dataLen - n1);
  int n2=readAll(in,result,n1,dataLen - n1);
  Assert.assertEquals(in.available(),dataLen - n1 - n2);
  in.close();
}
