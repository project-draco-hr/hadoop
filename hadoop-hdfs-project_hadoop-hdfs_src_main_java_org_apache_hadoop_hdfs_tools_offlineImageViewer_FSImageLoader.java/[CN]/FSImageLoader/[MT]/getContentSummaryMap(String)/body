{
  long id=lookup(path);
  INode inode=fromINodeId(id);
  long spaceQuota=0;
  long nsQuota=0;
  long[] data=new long[4];
  FsImageProto.INodeSection.INodeFile f=inode.getFile();
switch (inode.getType()) {
case FILE:
    data[0]=0;
  data[1]=1;
data[2]=getFileSize(f);
nsQuota=-1;
data[3]=data[2] * f.getReplication();
spaceQuota=-1;
return fillSummaryMap(spaceQuota,nsQuota,data);
case DIRECTORY:
fillDirSummary(id,data);
nsQuota=inode.getDirectory().getNsQuota();
spaceQuota=inode.getDirectory().getDsQuota();
return fillSummaryMap(spaceQuota,nsQuota,data);
case SYMLINK:
data[0]=0;
data[1]=1;
data[2]=0;
nsQuota=-1;
data[3]=0;
spaceQuota=-1;
return fillSummaryMap(spaceQuota,nsQuota,data);
default :
return null;
}
}
