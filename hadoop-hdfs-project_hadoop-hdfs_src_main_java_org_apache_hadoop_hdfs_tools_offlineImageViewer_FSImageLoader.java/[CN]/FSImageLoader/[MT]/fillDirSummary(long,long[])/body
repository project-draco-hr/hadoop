{
  data[0]++;
  long[] children=dirmap.get(id);
  if (children == null) {
    return;
  }
  for (  long cid : children) {
    INode node=fromINodeId(cid);
switch (node.getType()) {
case DIRECTORY:
      fillDirSummary(cid,data);
    break;
case FILE:
  FsImageProto.INodeSection.INodeFile f=node.getFile();
long curLength=getFileSize(f);
data[1]++;
data[2]+=curLength;
data[3]+=(curLength) * (f.getReplication());
break;
case SYMLINK:
data[1]++;
break;
default :
break;
}
}
}
