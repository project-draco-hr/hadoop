{
  YarnConfiguration conf=createNMConfig();
  nm.init(conf);
  try {
    nm.start();
    Assert.fail("NM should have failed to start. Didn't get exception!!");
  }
 catch (  Exception e) {
    Assert.assertEquals(errMessage,e.getCause().getMessage());
  }
  Assert.assertEquals("NM state is wrong!",Service.STATE.INITED,nm.getServiceState());
  Assert.assertEquals("Number of registered nodes is wrong!",0,this.registeredNodes.size());
}
