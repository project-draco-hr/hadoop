{
  fsTarget=FileSystem.getLocal(new Configuration());
  targetTestRoot=FileSystemTestHelper.getAbsoluteTestRootPath(fsTarget);
  fsTarget.delete(targetTestRoot,true);
  fsTarget.delete(new Path(fsTarget.getHomeDirectory(),".Trash/Current"),true);
  fsTarget.mkdirs(targetTestRoot);
  fsTarget.mkdirs(new Path(targetTestRoot,"dir1"));
  conf=ViewFileSystemTestSetup.configWithViewfsScheme();
  String homeDir=fsTarget.getHomeDirectory().toUri().getPath();
  int indexOf2ndSlash=homeDir.indexOf('/',1);
  String homeDirRoot=homeDir.substring(0,indexOf2ndSlash);
  ConfigUtil.addLink(conf,homeDirRoot,fsTarget.makeQualified(new Path(homeDirRoot)).toUri());
  ConfigUtil.setHomeDirConf(conf,homeDirRoot);
  Log.info("Home dir base " + homeDirRoot);
  fsView=ViewFileSystemTestSetup.setupForViewFs(conf,fsTarget);
  conf.set("fs.defaultFS",FsConstants.VIEWFS_URI.toString());
}
