{
  boolean success=true;
  if (expectedOwner != null && !expectedOwner.equals(owner)) {
    if (Path.WINDOWS) {
      UserGroupInformation ugi=UserGroupInformation.createRemoteUser(expectedOwner);
      final String adminsGroupString="Administrators";
      success=owner.equals(adminsGroupString) && Arrays.asList(ugi.getGroupNames()).contains(adminsGroupString);
    }
 else {
      success=false;
    }
  }
  if (!success) {
    throw new IOException("Owner '" + owner + "' for path "+ f+ " did not match "+ "expected owner '"+ expectedOwner+ "'");
  }
}
