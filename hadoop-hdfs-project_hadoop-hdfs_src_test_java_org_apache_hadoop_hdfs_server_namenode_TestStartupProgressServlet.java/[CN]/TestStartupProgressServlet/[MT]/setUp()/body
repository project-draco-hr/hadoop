{
  startupProgress=new StartupProgress();
  ServletContext context=mock(ServletContext.class);
  when(context.getAttribute(NameNodeHttpServer.STARTUP_PROGRESS_ATTRIBUTE_KEY)).thenReturn(startupProgress);
  servlet=mock(StartupProgressServlet.class);
  when(servlet.getServletContext()).thenReturn(context);
  doCallRealMethod().when(servlet).doGet(any(HttpServletRequest.class),any(HttpServletResponse.class));
  req=mock(HttpServletRequest.class);
  respOut=new ByteArrayOutputStream();
  PrintWriter writer=new PrintWriter(respOut);
  resp=mock(HttpServletResponse.class);
  when(resp.getWriter()).thenReturn(writer);
}
