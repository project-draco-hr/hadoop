{
  HAServiceTarget haServiceTarget;
  int rpcTimeoutForChecks=yarnConf.getInt(CommonConfigurationKeys.HA_FC_CLI_CHECK_TIMEOUT_KEY,CommonConfigurationKeys.HA_FC_CLI_CHECK_TIMEOUT_DEFAULT);
  yarnConf.set(CommonConfigurationKeys.HADOOP_SECURITY_SERVICE_USER_NAME_KEY,yarnConf.get(YarnConfiguration.RM_PRINCIPAL,""));
  haServiceTarget=new RMHAServiceTarget(yarnConf);
  HAServiceProtocol proto=haServiceTarget.getProxy(yarnConf,rpcTimeoutForChecks);
  HAServiceState haState=proto.getServiceStatus().getState();
  return haState;
}
