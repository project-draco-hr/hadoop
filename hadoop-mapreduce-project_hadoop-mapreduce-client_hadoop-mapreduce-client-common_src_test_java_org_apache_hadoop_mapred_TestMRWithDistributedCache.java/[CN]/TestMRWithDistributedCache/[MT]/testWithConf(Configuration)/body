{
  Path first=createTempFile("distributed.first","x");
  Path second=makeJar(new Path(TEST_ROOT_DIR,"distributed.second.jar"),2);
  Path third=makeJar(new Path(TEST_ROOT_DIR,"distributed.third.jar"),3);
  Path fourth=makeJar(new Path(TEST_ROOT_DIR,"distributed.fourth.jar"),4);
  Job job=Job.getInstance(conf);
  job.setMapperClass(DistributedCacheCheckerMapper.class);
  job.setReducerClass(DistributedCacheCheckerReducer.class);
  job.setOutputFormatClass(NullOutputFormat.class);
  FileInputFormat.setInputPaths(job,first);
  job.addCacheFile(new URI(first.toUri().toString() + "#distributed.first.symlink"));
  job.addFileToClassPath(second);
  job.addArchiveToClassPath(third);
  job.addCacheArchive(fourth.toUri());
  job.setMaxMapAttempts(1);
  job.submit();
  assertTrue(job.waitForCompletion(false));
}
