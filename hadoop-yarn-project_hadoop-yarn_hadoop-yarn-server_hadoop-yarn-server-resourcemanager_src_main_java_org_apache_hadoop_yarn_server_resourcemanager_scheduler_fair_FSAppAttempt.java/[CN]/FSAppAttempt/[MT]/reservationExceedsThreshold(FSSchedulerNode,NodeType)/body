{
  if (type != NodeType.NODE_LOCAL) {
    int existingReservations=getNumReservations(node.getRackName(),type == NodeType.OFF_SWITCH);
    int totalAvailNodes=(type == NodeType.OFF_SWITCH) ? scheduler.getNumClusterNodes() : scheduler.getNumNodesInRack(node.getRackName());
    int numAllowedReservations=(int)Math.ceil(totalAvailNodes * scheduler.getReservableNodesRatio());
    if (existingReservations >= numAllowedReservations) {
      DecimalFormat df=new DecimalFormat();
      df.setMaximumFractionDigits(2);
      LOG.info("Reservation Exceeds Allowed number of nodes:" + " app_id=" + getApplicationId() + " existingReservations="+ existingReservations+ " totalAvailableNodes="+ totalAvailNodes+ " reservableNodesRatio="+ df.format(scheduler.getReservableNodesRatio())+ " numAllowedReservations="+ numAllowedReservations);
      return true;
    }
  }
  return false;
}
