{
  if (file == null) {
    return null;
  }
  if (file.isEmpty()) {
    throw new IllegalArgumentException("File name can't be empty string");
  }
  String finalPath;
  URI pathURI;
  try {
    pathURI=new URI(file);
  }
 catch (  URISyntaxException e) {
    throw new IllegalArgumentException(e);
  }
  Path path=new Path(pathURI);
  FileSystem localFs=FileSystem.getLocal(conf);
  if (pathURI.getScheme() == null) {
    if (!localFs.exists(path)) {
      throw new FileNotFoundException("File " + file + " does not exist.");
    }
    finalPath=path.makeQualified(localFs.getUri(),localFs.getWorkingDirectory()).toString();
  }
 else {
    FileSystem fs=path.getFileSystem(conf);
    if (!fs.exists(path)) {
      throw new FileNotFoundException("File " + file + " does not exist.");
    }
    finalPath=path.makeQualified(fs.getUri(),fs.getWorkingDirectory()).toString();
  }
  return finalPath;
}
