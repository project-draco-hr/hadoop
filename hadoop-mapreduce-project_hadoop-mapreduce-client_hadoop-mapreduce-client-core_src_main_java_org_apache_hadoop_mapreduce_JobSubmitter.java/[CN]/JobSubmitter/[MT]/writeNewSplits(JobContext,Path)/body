{
  Configuration conf=job.getConfiguration();
  InputFormat<?,?> input=ReflectionUtils.newInstance(job.getInputFormatClass(),conf);
  List<InputSplit> splits=input.getSplits(job);
  T[] array=(T[])splits.toArray(new InputSplit[splits.size()]);
  Arrays.sort(array,new SplitComparator());
  JobSplitWriter.createSplitFiles(jobSubmitDir,conf,jobSubmitDir.getFileSystem(conf),array);
  return array.length;
}
