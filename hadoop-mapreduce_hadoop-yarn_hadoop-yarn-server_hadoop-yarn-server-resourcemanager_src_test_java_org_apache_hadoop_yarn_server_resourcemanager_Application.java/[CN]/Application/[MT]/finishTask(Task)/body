{
  Set<Task> tasks=this.tasks.get(task.getPriority());
  if (!tasks.remove(task)) {
    throw new IllegalStateException("Finishing unknown task " + task.getTaskId() + " from application "+ applicationId);
  }
  NodeManager nodeManager=task.getNodeManager();
  ContainerId containerId=task.getContainerId();
  task.stop();
  StopContainerRequest stopRequest=recordFactory.newRecordInstance(StopContainerRequest.class);
  stopRequest.setContainerId(containerId);
  nodeManager.stopContainer(stopRequest);
  Resources.subtractFrom(used,requestSpec.get(task.getPriority()));
  LOG.info("Finished task " + task.getTaskId() + " of application "+ applicationId+ " on node "+ nodeManager.getHostName()+ ", currently using "+ used+ " resources");
}
