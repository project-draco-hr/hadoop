{
  Configuration conf=new HdfsConfiguration();
  Collection<Path> protectedPaths=Arrays.asList(new Path("/a"),new Path("/b"),new Path("/c"));
  Collection<Path> unprotectedPaths=Arrays.asList();
  MiniDFSCluster cluster=setupTestCase(conf,protectedPaths,unprotectedPaths);
  SortedSet<String> protectedPathsNew=new TreeSet<>(FSDirectory.normalizePaths(Arrays.asList("/aa","/bb","/cc"),FS_PROTECTED_DIRECTORIES));
  String protectedPathsStrNew="/aa,/bb,/cc";
  NameNode nn=cluster.getNameNode();
  nn.reconfigureProperty(FS_PROTECTED_DIRECTORIES,protectedPathsStrNew);
  FSDirectory fsDirectory=nn.getNamesystem().getFSDirectory();
  assertEquals(String.format("%s has wrong value",FS_PROTECTED_DIRECTORIES),protectedPathsNew,fsDirectory.getProtectedDirectories());
  assertEquals(String.format("%s has wrong value",FS_PROTECTED_DIRECTORIES),protectedPathsStrNew,nn.getConf().get(FS_PROTECTED_DIRECTORIES));
  nn.reconfigureProperty(FS_PROTECTED_DIRECTORIES,null);
  assertEquals(String.format("%s has wrong value",FS_PROTECTED_DIRECTORIES),new TreeSet<String>(),fsDirectory.getProtectedDirectories());
  assertEquals(String.format("%s has wrong value",FS_PROTECTED_DIRECTORIES),null,nn.getConf().get(FS_PROTECTED_DIRECTORIES));
}
