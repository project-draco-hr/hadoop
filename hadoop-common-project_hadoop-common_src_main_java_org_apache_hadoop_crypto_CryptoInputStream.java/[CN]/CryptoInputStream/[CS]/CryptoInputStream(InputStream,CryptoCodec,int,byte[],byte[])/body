{
  super(in);
  Preconditions.checkArgument(bufferSize >= MIN_BUFFER_SIZE,"Minimum value of buffer size is 512.");
  this.key=key;
  this.initIV=iv;
  this.iv=iv.clone();
  inBuffer=ByteBuffer.allocateDirect(bufferSize);
  outBuffer=ByteBuffer.allocateDirect(bufferSize);
  outBuffer.limit(0);
  this.codec=codec;
  try {
    decryptor=codec.getDecryptor();
  }
 catch (  GeneralSecurityException e) {
    throw new IOException(e);
  }
  if (in instanceof Seekable) {
    streamOffset=((Seekable)in).getPos();
  }
  updateDecryptor();
}
