{
  super(in);
  this.bufferSize=CryptoStreamUtils.checkBufferSize(codec,bufferSize);
  this.codec=codec;
  this.key=key.clone();
  this.initIV=iv.clone();
  this.iv=iv.clone();
  inBuffer=ByteBuffer.allocateDirect(this.bufferSize);
  outBuffer=ByteBuffer.allocateDirect(this.bufferSize);
  decryptor=getDecryptor();
  if (in instanceof Seekable) {
    streamOffset=((Seekable)in).getPos();
  }
  resetStreamOffset(streamOffset);
}
