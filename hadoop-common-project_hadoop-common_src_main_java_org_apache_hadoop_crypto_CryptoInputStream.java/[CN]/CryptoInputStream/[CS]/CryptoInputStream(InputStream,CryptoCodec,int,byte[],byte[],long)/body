{
  super(in);
  this.bufferSize=CryptoStreamUtils.checkBufferSize(codec,bufferSize);
  this.codec=codec;
  this.key=key.clone();
  this.initIV=iv.clone();
  this.iv=iv.clone();
  this.streamOffset=streamOffset;
  isByteBufferReadable=in instanceof ByteBufferReadable;
  isReadableByteChannel=in instanceof ReadableByteChannel;
  inBuffer=ByteBuffer.allocateDirect(this.bufferSize);
  outBuffer=ByteBuffer.allocateDirect(this.bufferSize);
  decryptor=getDecryptor();
  resetStreamOffset(streamOffset);
}
