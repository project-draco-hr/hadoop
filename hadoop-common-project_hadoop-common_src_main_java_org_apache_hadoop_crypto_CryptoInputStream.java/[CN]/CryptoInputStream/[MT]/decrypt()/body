{
  Preconditions.checkState(inBuffer.position() >= padding);
  if (inBuffer.position() == padding) {
    return;
  }
  inBuffer.flip();
  outBuffer.clear();
  decryptor.decrypt(inBuffer,outBuffer);
  inBuffer.clear();
  outBuffer.flip();
  if (padding > 0) {
    outBuffer.position(padding);
    padding=0;
  }
  if (decryptor.isContextReset()) {
    updateDecryptor();
  }
}
