{
  try {
    addEntries(listFile,"multifile1/file3","multifile1/file4","multifile1/file5");
    createFiles("multifile1/file3","multifile1/file4","multifile1/file5");
    mkdirs(target.toString());
    Configuration conf=getConf();
    try {
      conf.setClass(DistCpConstants.CONF_LABEL_COPY_LISTING_CLASS,CustomCopyListing.class,CopyListing.class);
      DistCpOptions options=new DistCpOptions(Arrays.asList(new Path(root + "/" + "multifile1")),target);
      options.setSyncFolder(true);
      options.setDeleteMissing(false);
      options.setOverwrite(false);
      try {
        new DistCp(conf,options).execute();
      }
 catch (      Exception e) {
        LOG.error("Exception encountered ",e);
        throw new IOException(e);
      }
    }
  finally {
      conf.unset(DistCpConstants.CONF_LABEL_COPY_LISTING_CLASS);
    }
    checkResult(target,2,"file4","file5");
  }
 catch (  IOException e) {
    LOG.error("Exception encountered while testing distcp",e);
    Assert.fail("distcp failure");
  }
 finally {
    TestDistCpUtils.delete(fs,root);
  }
}
