{
  for (  String baseDir : baseDirs) {
    LOG.info("Checking namenode directory " + baseDir);
    LOG.info("==== Contents ====:\n  " + Joiner.on("  \n").join(new File(baseDir,"current").list()));
    LOG.info("==================");
    assertTrue(new File(baseDir,"current").isDirectory());
    assertTrue(new File(baseDir,"current/VERSION").isFile());
    assertTrue(new File(baseDir,"current/" + getInProgressEditsFileName(imageTxId + 1)).isFile());
    assertTrue(new File(baseDir,"current/" + getImageFileName(imageTxId)).isFile());
    assertTrue(new File(baseDir,"current/seen_txid").isFile());
    File previous=new File(baseDir,"previous");
    assertTrue(previous.isDirectory());
    assertEquals(UpgradeUtilities.checksumContents(NAME_NODE,previous),UpgradeUtilities.checksumMasterNameNodeContents());
  }
}
