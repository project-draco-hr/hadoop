{
  int snapshotIndex=0;
  for (  Modification[] modifications : modificationsList) {
    Path snapshotRoot=SnapshotTestHelper.createSnapshot(hdfs,snapshottedDir,genSnapshotName(snapshotIndex++));
    snapshotList.add(snapshotRoot);
    SnapshotTestHelper.checkSnapshotCreation(hdfs,snapshotRoot,snapshottedDir);
    for (    Modification m : modifications) {
      m.loadSnapshots();
      m.modify();
      m.checkSnapshots();
    }
  }
}
