{
  hdfs.mkdirs(sub1);
  Path sub2=new Path(dir,"sub2");
  Path file2=new Path(sub2,"file");
  DFSTestUtil.createFile(hdfs,file2,BLOCKSIZE,REPLICATION,seed);
  hdfs.rename(sub2,sub1,Rename.OVERWRITE);
  Path sub3=new Path(dir,"sub3");
  hdfs.mkdirs(sub3);
  SnapshotTestHelper.createSnapshot(hdfs,sub3,"s1");
  exception.expect(RemoteException.class);
  String error="The direcotry " + sub3.toString() + " cannot be deleted for renaming since "+ sub3.toString()+ " is snapshottable and already has snapshots";
  exception.expectMessage(error);
  hdfs.rename(sub1,sub3,Rename.OVERWRITE);
}
