{
  Path file0=new Path(sub1,"file0");
  Path file1=new Path(sub1,"file1");
  DFSTestUtil.createFile(hdfs,file0,BLOCKSIZE,REPLICATION,seed);
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPLICATION,seed);
  Path sub2=new Path(dir,"sub2");
  Path file2=new Path(sub2,"file");
  DFSTestUtil.createFile(hdfs,file2,BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,sub1,"s1");
  hdfs.delete(file0,true);
  hdfs.delete(file1,true);
  exception.expect(RemoteException.class);
  String error="The direcotry " + sub1.toString() + " cannot be deleted for renaming since "+ sub1.toString()+ " is snapshottable and already has snapshots";
  exception.expectMessage(error);
  hdfs.rename(sub2,sub1,Rename.OVERWRITE);
}
