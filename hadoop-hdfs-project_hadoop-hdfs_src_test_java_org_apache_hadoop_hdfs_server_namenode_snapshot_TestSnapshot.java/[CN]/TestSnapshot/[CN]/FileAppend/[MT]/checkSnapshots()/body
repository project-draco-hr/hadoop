{
  byte[] buffer=new byte[32];
  for (  Path snapshotRoot : snapshotList) {
    Path snapshotFile=new Path(snapshotRoot,file.getName());
    long currentSnapshotFileLen=-1L;
    if (fs.exists(snapshotFile)) {
      currentSnapshotFileLen=fs.getFileStatus(snapshotFile).getLen();
    }
    long originalSnapshotFileLen=snapshotFileLengthMap.get(snapshotFile);
    assertEquals(currentSnapshotFileLen,originalSnapshotFileLen);
    if (fs.exists(snapshotFile)) {
      FSDataInputStream input=fs.open(snapshotFile);
      int readLen=input.read(currentSnapshotFileLen,buffer,0,1);
      assertEquals(readLen,-1);
    }
  }
}
