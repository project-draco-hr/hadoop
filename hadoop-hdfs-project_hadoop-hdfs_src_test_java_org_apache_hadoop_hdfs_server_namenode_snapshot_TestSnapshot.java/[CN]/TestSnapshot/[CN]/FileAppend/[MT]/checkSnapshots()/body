{
  byte[] buffer=new byte[32];
  for (  Path snapshotFile : snapshotFileLengthMap.keySet()) {
    long currentSnapshotFileLen=fs.exists(snapshotFile) ? fs.getFileStatus(snapshotFile).getLen() : -1L;
    long originalSnapshotFileLen=snapshotFileLengthMap.get(snapshotFile);
    assertEquals(currentSnapshotFileLen,originalSnapshotFileLen);
    if (currentSnapshotFileLen != -1L) {
      FSDataInputStream input=fs.open(snapshotFile);
      int readLen=input.read(currentSnapshotFileLen,buffer,0,1);
      assertEquals(readLen,-1);
    }
  }
}
