{
  for (  Path snapshotFile : statusMap.keySet()) {
    FileStatus currentStatus=fs.exists(snapshotFile) ? fs.getFileStatus(snapshotFile) : null;
    FileStatus originalStatus=statusMap.get(snapshotFile);
    assertEquals(currentStatus,originalStatus);
    if (currentStatus != null) {
      String s=null;
      if (!currentStatus.toString().equals(originalStatus.toString())) {
        s="FAILED: " + getClass().getSimpleName() + ": file="+ file+ ", snapshotFile"+ snapshotFile+ "\n\n currentStatus = "+ currentStatus+ "\noriginalStatus = "+ originalStatus+ "\n\nfile        : "+ fsdir.getINode(file.toString()).toDetailString()+ "\n\nsnapshotFile: "+ fsdir.getINode(snapshotFile.toString()).toDetailString();
        SnapshotTestHelper.dumpTree(s,cluster);
      }
      assertEquals(s,currentStatus.toString(),originalStatus.toString());
    }
  }
}
