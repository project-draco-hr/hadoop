{
  List<Rule> result=new ArrayList<Rule>();
  String remaining=rules.trim();
  while (remaining.length() > 0) {
    Matcher matcher=ruleParser.matcher(remaining);
    if (!matcher.lookingAt()) {
      throw new IllegalArgumentException("Invalid rule: " + remaining);
    }
    if (matcher.group(2) != null) {
      result.add(new Rule());
    }
 else {
      result.add(new Rule(Integer.parseInt(matcher.group(4)),matcher.group(5),matcher.group(7),matcher.group(9),matcher.group(10),"g".equals(matcher.group(11)),"L".equals(matcher.group(12))));
    }
    remaining=remaining.substring(matcher.end());
  }
  return result;
}
