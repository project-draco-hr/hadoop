{
  String[] params;
  if (hostName == null) {
    if (realm == null) {
      return serviceName;
    }
    params=new String[]{realm,serviceName};
  }
 else {
    params=new String[]{realm,serviceName,hostName};
  }
  for (  Rule r : rules) {
    String result=r.apply(params);
    if (result != null) {
      return result;
    }
  }
  LOG.info("No auth_to_local rules applied to {}",this);
  return toString();
}
