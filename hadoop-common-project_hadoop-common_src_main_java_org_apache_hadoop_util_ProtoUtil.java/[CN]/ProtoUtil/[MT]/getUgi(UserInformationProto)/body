{
  UserGroupInformation ugi=null;
  String effectiveUser=userInfo.hasEffectiveUser() ? userInfo.getEffectiveUser() : null;
  String realUser=userInfo.hasRealUser() ? userInfo.getRealUser() : null;
  if (effectiveUser != null) {
    if (realUser != null) {
      UserGroupInformation realUserUgi=UserGroupInformation.createRemoteUser(realUser);
      ugi=UserGroupInformation.createProxyUser(effectiveUser,realUserUgi);
    }
 else {
      ugi=org.apache.hadoop.security.UserGroupInformation.createRemoteUser(effectiveUser);
    }
  }
  return ugi;
}
