{
  Configuration conf=new Configuration(false);
  Cluster cluster=null;
  try {
    cluster=new Cluster(conf);
    fail("Cluster should not be initialized with out any framework name");
  }
 catch (  IOException e) {
  }
  try {
    conf=new Configuration();
    conf.set(MRConfig.FRAMEWORK_NAME,MRConfig.YARN_FRAMEWORK_NAME);
    cluster=new Cluster(conf);
    ClientProtocol client=cluster.getClient();
    assertTrue(client instanceof YARNRunner);
  }
 catch (  IOException e) {
  }
 finally {
    if (cluster != null) {
      cluster.close();
    }
  }
}
