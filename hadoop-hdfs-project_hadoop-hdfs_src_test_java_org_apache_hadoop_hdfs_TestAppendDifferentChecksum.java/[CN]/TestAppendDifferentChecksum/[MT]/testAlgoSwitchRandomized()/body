{
  FileSystem fsWithCrc32=createFsWithChecksum("CRC32",512);
  FileSystem fsWithCrc32C=createFsWithChecksum("CRC32C",512);
  Path p=new Path("/testAlgoSwitchRandomized");
  long seed=Time.now();
  System.out.println("seed: " + seed);
  Random r=new Random(seed);
  IOUtils.closeStream(fsWithCrc32.create(p));
  long st=Time.now();
  int len=0;
  while (Time.now() - st < RANDOM_TEST_RUNTIME) {
    int thisLen=r.nextInt(500);
    FileSystem fs=(r.nextBoolean() ? fsWithCrc32 : fsWithCrc32C);
    FSDataOutputStream stm=fs.append(p);
    try {
      AppendTestUtil.write(stm,len,thisLen);
    }
  finally {
      stm.close();
    }
    len+=thisLen;
  }
  AppendTestUtil.check(fsWithCrc32,p,len);
  AppendTestUtil.check(fsWithCrc32C,p,len);
}
