{
  if (Path.WINDOWS) {
    LOGGER.info("Cannot run test for Windows");
    return;
  }
  Configuration conf=new Configuration();
  conf.set(CommonConfigurationKeys.FS_PERMISSIONS_UMASK_KEY,"044");
  LocalFileSystem localfs=FileSystem.getLocal(conf);
  String filename="bar";
  Path f=writeFile(localfs,filename);
  List<String> groups=null;
  try {
    groups=getGroups();
    LOGGER.info("{}: {}",filename,getPermission(localfs,f));
  }
 catch (  IOException e) {
    LOGGER.error("Cannot run test",e);
    return;
  }
  if (groups == null || groups.size() < 1) {
    LOGGER.error("Cannot run test: need at least one group. groups={}",groups);
    return;
  }
  try {
    String g0=groups.get(0);
    localfs.setOwner(f,null,g0);
    assertEquals(g0,getGroup(localfs,f));
    if (groups.size() > 1) {
      String g1=groups.get(1);
      localfs.setOwner(f,null,g1);
      assertEquals(g1,getGroup(localfs,f));
    }
 else {
      LOGGER.info("Not testing changing the group since user " + "belongs to only one group.");
    }
  }
  finally {
    cleanup(localfs,f);
  }
}
