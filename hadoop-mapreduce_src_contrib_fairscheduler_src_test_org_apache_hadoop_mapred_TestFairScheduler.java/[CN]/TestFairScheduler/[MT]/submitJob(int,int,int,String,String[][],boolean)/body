{
  JobConf jobConf=new JobConf(conf);
  jobConf.setNumMapTasks(maps);
  jobConf.setNumReduceTasks(reduces);
  if (pool != null)   jobConf.set(POOL_PROPERTY,pool);
  JobInProgress job=new FakeJobInProgress(jobConf,taskTrackerManager,mapInputLocations,UtilsForTests.getJobTracker());
  if (initializeJob) {
    taskTrackerManager.initJob(job);
  }
  job.getStatus().setRunState(state);
  taskTrackerManager.submitJob(job);
  job.startTime=clock.time;
  return job;
}
