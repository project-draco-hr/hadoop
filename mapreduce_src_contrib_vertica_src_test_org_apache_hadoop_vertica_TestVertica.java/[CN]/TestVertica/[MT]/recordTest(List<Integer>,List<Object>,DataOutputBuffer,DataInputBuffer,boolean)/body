{
  VerticaRecord record=new VerticaRecord(null,types,values,date_string);
  record.write(out);
  in.reset(out.getData(),out.getLength());
  List<Object> new_values=new ArrayList<Object>();
  record=new VerticaRecord(null,types,new_values,date_string);
  record.readFields(in);
  for (int i=0; i < values.size(); i++)   if (values.get(i) == null)   assertSame("Vertica Record serialized value " + i + " is null",values.get(i),new_values.get(i));
 else   if (values.get(i).getClass().isArray()) {
    Object a=values.get(i);
    Object b=new_values.get(i);
    for (int j=0; j < Array.getLength(a); j++)     assertEquals("Vertica Record serialized value " + i + "["+ j+ "] does not match",Array.get(a,j),Array.get(b,j));
  }
 else {
    assertEquals("Vertica Record serialized value " + i + " does not match",values.get(i),new_values.get(i));
  }
  return record.toSQLString();
}
