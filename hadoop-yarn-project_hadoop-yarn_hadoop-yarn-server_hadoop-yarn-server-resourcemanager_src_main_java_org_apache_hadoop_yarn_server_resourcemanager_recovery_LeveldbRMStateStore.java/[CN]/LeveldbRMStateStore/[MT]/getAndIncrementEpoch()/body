{
  long currentEpoch=0;
  byte[] dbKeyBytes=bytes(EPOCH_NODE);
  try {
    byte[] data=db.get(dbKeyBytes);
    if (data != null) {
      currentEpoch=EpochProto.parseFrom(data).getEpoch();
    }
    EpochProto proto=Epoch.newInstance(currentEpoch + 1).getProto();
    db.put(dbKeyBytes,proto.toByteArray());
  }
 catch (  DBException e) {
    throw new IOException(e);
  }
  return currentEpoch;
}
