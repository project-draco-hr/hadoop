{
  String tokenKey=getRMDTTokenNodeKey(tokenId);
  RMDelegationTokenIdentifierData tokenData=new RMDelegationTokenIdentifierData(tokenId,renewDate);
  ByteArrayOutputStream bs=new ByteArrayOutputStream();
  DataOutputStream ds=new DataOutputStream(bs);
  try {
    ds.writeInt(latestSequenceNumber);
  }
  finally {
    ds.close();
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Storing token to " + tokenKey);
    LOG.debug("Storing " + latestSequenceNumber + " to "+ RM_DT_SEQUENCE_NUMBER_KEY);
  }
  try {
    WriteBatch batch=db.createWriteBatch();
    try {
      batch.put(bytes(tokenKey),tokenData.toByteArray());
      batch.put(bytes(RM_DT_SEQUENCE_NUMBER_KEY),bs.toByteArray());
      db.write(batch);
    }
  finally {
      batch.close();
    }
  }
 catch (  DBException e) {
    throw new IOException(e);
  }
}
