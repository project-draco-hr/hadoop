{
  Configuration conf=getConf();
  conf.setLong(MAP_SLEEP_TIME,mapSleepTime);
  conf.setLong(REDUCE_SLEEP_TIME,reduceSleepTime);
  conf.setInt(MAP_SLEEP_COUNT,mapSleepCount);
  conf.setInt(REDUCE_SLEEP_COUNT,reduceSleepCount);
  conf.setInt(MRJobConfig.NUM_MAPS,numMapper);
  Job job=Job.getInstance(conf,"sleep");
  job.setNumReduceTasks(numReducer);
  job.setJarByClass(SleepJob.class);
  job.setMapperClass(SleepMapper.class);
  job.setMapOutputKeyClass(IntWritable.class);
  job.setMapOutputValueClass(NullWritable.class);
  job.setReducerClass(SleepReducer.class);
  job.setOutputFormatClass(NullOutputFormat.class);
  job.setInputFormatClass(SleepInputFormat.class);
  job.setPartitionerClass(SleepJobPartitioner.class);
  job.setSpeculativeExecution(false);
  job.setJobName("Sleep job");
  FileInputFormat.addInputPath(job,new Path("ignored"));
  return job;
}
