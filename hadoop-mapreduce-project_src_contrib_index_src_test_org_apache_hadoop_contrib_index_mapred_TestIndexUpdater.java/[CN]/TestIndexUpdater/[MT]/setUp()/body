{
  super.setUp();
  try {
    dfsCluster=new MiniDFSCluster(conf,numDataNodes,true,(String[])null);
    fs=dfsCluster.getFileSystem();
    if (fs.exists(inputPath)) {
      fs.delete(inputPath,true);
    }
    fs.copyFromLocalFile(localInputPath,inputPath);
    if (fs.exists(outputPath)) {
      fs.delete(outputPath,true);
    }
    if (fs.exists(indexPath)) {
      fs.delete(indexPath,true);
    }
    mrCluster=new MiniMRCluster(numTaskTrackers,fs.getUri().toString(),1);
  }
 catch (  IOException e) {
    if (dfsCluster != null) {
      dfsCluster.shutdown();
      dfsCluster=null;
    }
    if (fs != null) {
      fs.close();
      fs=null;
    }
    if (mrCluster != null) {
      mrCluster.shutdown();
      mrCluster=null;
    }
    throw e;
  }
}
