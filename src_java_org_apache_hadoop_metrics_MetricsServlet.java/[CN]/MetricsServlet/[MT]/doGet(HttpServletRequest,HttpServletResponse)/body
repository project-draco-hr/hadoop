{
  PrintWriter out=new PrintWriter(response.getOutputStream());
  String format=request.getParameter("format");
  Collection<MetricsContext> allContexts=ContextFactory.getFactory().getAllContexts();
  if ("json".equals(format)) {
    out.print(new JSON().toJSON(makeMap(allContexts)));
  }
 else {
    printMap(out,makeMap(allContexts));
  }
  out.close();
}
