{
  ByteArrayInputStream buf=new ByteArrayInputStream(token.getIdentifier());
  DataInputStream dis=new DataInputStream(buf);
  DelegationTokenIdentifier id=new DelegationTokenIdentifier(tokenKind);
  try {
    id.readFields(dis);
    dis.close();
    secretManager.verifyToken(id,token.getPassword());
  }
 catch (  Exception ex) {
    throw new DelegationTokenManagerException(DelegationTokenManagerException.ERROR.DT01,ex.toString(),ex);
  }
  return id.getUser();
}
