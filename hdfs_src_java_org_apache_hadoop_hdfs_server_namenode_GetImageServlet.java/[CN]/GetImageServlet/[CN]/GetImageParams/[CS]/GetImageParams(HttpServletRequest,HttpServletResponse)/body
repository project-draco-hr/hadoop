{
  @SuppressWarnings("unchecked") Map<String,String[]> pmap=request.getParameterMap();
  isGetImage=isGetEdit=isPutImage=false;
  remoteport=0;
  machineName=null;
  for (  Map.Entry<String,String[]> entry : pmap.entrySet()) {
    String key=entry.getKey();
    String[] val=entry.getValue();
    if (key.equals("getimage")) {
      isGetImage=true;
      txId=parseLongParam(request,TXID_PARAM);
    }
 else     if (key.equals("getedit")) {
      isGetEdit=true;
      startTxId=parseLongParam(request,START_TXID_PARAM);
      endTxId=parseLongParam(request,END_TXID_PARAM);
    }
 else     if (key.equals("putimage")) {
      isPutImage=true;
      txId=parseLongParam(request,TXID_PARAM);
    }
 else     if (key.equals("port")) {
      remoteport=new Integer(val[0]).intValue();
    }
 else     if (key.equals("machine")) {
      machineName=val[0];
    }
 else     if (key.equals(STORAGEINFO_PARAM)) {
      storageInfoString=val[0];
    }
  }
  int numGets=(isGetImage ? 1 : 0) + (isGetEdit ? 1 : 0);
  if ((numGets > 1) || (numGets == 0) && !isPutImage) {
    throw new IOException("Illegal parameters to TransferFsImage");
  }
}
