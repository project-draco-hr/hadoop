{
  Path root=getTestRootPath(fc);
  Path f=new Path(root,"d1/d2/d3");
  fc.mkdir(f,FileContext.DEFAULT_PERM,true);
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1")));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1/d2")));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1/d2/d3")));
  Path fPath=new Path(root,"d1/d2/f.txt");
  createFile(fc,fPath);
  assertIsFile(fPath,fc.getFileStatus(fPath));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1")));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1/d2")));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1/d2/d3")));
  Path f2Path=new Path(getTestRootPath(fc),"d1/d2/d3/f2.txt");
  createFile(fc,f2Path);
  assertIsFile(fPath,fc.getFileStatus(f2Path));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1")));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1/d2")));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1/d2/d3")));
  fc.rename(new Path(root,"d1/d2/d3"),new Path(root,"d1/d4"));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1")));
  assertIsDirectory(fc.getFileStatus(new Path(root,"d1/d4")));
  Path f2NewPath=new Path(root,"d1/d4/f2.txt");
  assertIsFile(f2NewPath,fc.getFileStatus(f2NewPath));
}
