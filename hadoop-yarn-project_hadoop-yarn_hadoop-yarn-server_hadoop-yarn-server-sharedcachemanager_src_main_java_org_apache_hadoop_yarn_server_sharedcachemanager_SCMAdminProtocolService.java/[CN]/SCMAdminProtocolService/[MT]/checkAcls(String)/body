{
  UserGroupInformation user;
  try {
    user=UserGroupInformation.getCurrentUser();
  }
 catch (  IOException ioe) {
    LOG.warn("Couldn't get current user",ioe);
    throw RPCUtil.getRemoteException(ioe);
  }
  if (!adminAcl.isUserAllowed(user)) {
    LOG.warn("User " + user.getShortUserName() + " doesn't have permission"+ " to call '"+ method+ "'");
    throw RPCUtil.getRemoteException(new AccessControlException("User " + user.getShortUserName() + " doesn't have permission"+ " to call '"+ method+ "'"));
  }
  LOG.info("SCM Admin: " + method + " invoked by user "+ user.getShortUserName());
}
