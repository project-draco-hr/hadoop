{
  int numDead=0;
synchronized (datanodeMap) {
    for (    DatanodeDescriptor dn : datanodeMap.values()) {
      if (isDatanodeDead(dn)) {
        numDead++;
      }
    }
  }
  return numDead;
}
