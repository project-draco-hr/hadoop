{
  RMNode node1=MockNodes.newNodeInfo(1,Resources.createResource(1024));
  NodeAddedSchedulerEvent nodeEvent1=new NodeAddedSchedulerEvent(node1);
  scheduler.handle(nodeEvent1);
  assertEquals(1024,scheduler.getClusterCapacity().getMemory());
  RMNode node2=MockNodes.newNodeInfo(1,Resources.createResource(512));
  NodeAddedSchedulerEvent nodeEvent2=new NodeAddedSchedulerEvent(node2);
  scheduler.handle(nodeEvent2);
  assertEquals(1536,scheduler.getClusterCapacity().getMemory());
  NodeRemovedSchedulerEvent nodeEvent3=new NodeRemovedSchedulerEvent(node1);
  scheduler.handle(nodeEvent3);
  assertEquals(512,scheduler.getClusterCapacity().getMemory());
}
