{
  Configuration conf=createConfiguration();
  conf.setClass(CommonConfigurationKeys.HADOOP_SECURITY_GROUP_MAPPING,SimpleGroupsMapping.class,GroupMappingServiceProvider.class);
  ApplicationAttemptId appId;
  Map<ApplicationAttemptId,FSSchedulerApp> apps=scheduler.applications;
  List<QueuePlacementRule> rules=new ArrayList<QueuePlacementRule>();
  rules.add(new QueuePlacementRule.Specified().initialize(true,null));
  rules.add(new QueuePlacementRule.User().initialize(false,null));
  rules.add(new QueuePlacementRule.PrimaryGroup().initialize(false,null));
  rules.add(new QueuePlacementRule.Default().initialize(true,null));
  Set<String> queues=Sets.newHashSet("root.user1","root.user3group");
  scheduler.getQueueManager().placementPolicy=new QueuePlacementPolicy(rules,queues,conf);
  appId=createSchedulingRequest(1024,"somequeue","user1");
  assertEquals("root.somequeue",apps.get(appId).getQueueName());
  appId=createSchedulingRequest(1024,"default","user1");
  assertEquals("root.user1",apps.get(appId).getQueueName());
  appId=createSchedulingRequest(1024,"default","user3");
  assertEquals("root.user3group",apps.get(appId).getQueueName());
  appId=createSchedulingRequest(1024,"default","otheruser");
  assertEquals("root.default",apps.get(appId).getQueueName());
  rules=new ArrayList<QueuePlacementRule>();
  rules.add(new QueuePlacementRule.User().initialize(false,null));
  rules.add(new QueuePlacementRule.Specified().initialize(true,null));
  rules.add(new QueuePlacementRule.Default().initialize(true,null));
  scheduler.getQueueManager().placementPolicy=new QueuePlacementPolicy(rules,queues,conf);
  appId=createSchedulingRequest(1024,"somequeue","user1");
  assertEquals("root.user1",apps.get(appId).getQueueName());
  appId=createSchedulingRequest(1024,"somequeue","otheruser");
  assertEquals("root.somequeue",apps.get(appId).getQueueName());
  appId=createSchedulingRequest(1024,"default","otheruser");
  assertEquals("root.default",apps.get(appId).getQueueName());
}
