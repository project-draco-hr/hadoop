{
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  assertEquals(1,scheduler.getQueueManager().getLeafQueues().size());
  ApplicationAttemptId appAttemptId1=createAppAttemptId(1,1);
  AppAddedSchedulerEvent appAddedEvent1=new AppAddedSchedulerEvent(appAttemptId1.getApplicationId(),"A","user1");
  scheduler.handle(appAddedEvent1);
  assertEquals(2,scheduler.getQueueManager().getLeafQueues().size());
  assertNotNull(scheduler.getSchedulerApplications().get(appAttemptId1.getApplicationId()));
  AppAttemptAddedSchedulerEvent attempAddedEvent=new AppAttemptAddedSchedulerEvent(appAttemptId1,false);
  scheduler.handle(attempAddedEvent);
  assertEquals(1,scheduler.getQueueManager().getLeafQueue("A",true).getNumRunnableApps());
  assertNotNull(scheduler.getSchedulerApp(appAttemptId1));
  ApplicationAttemptId appAttemptId2=createAppAttemptId(2,1);
  AppAddedSchedulerEvent appAddedEvent2=new AppAddedSchedulerEvent(appAttemptId2.getApplicationId(),"A ","user1");
  scheduler.handle(appAddedEvent2);
  assertEquals(2,scheduler.getQueueManager().getLeafQueues().size());
  assertNull(scheduler.getSchedulerApplications().get(appAttemptId2.getApplicationId()));
  assertNull(scheduler.getSchedulerApp(appAttemptId2));
  ApplicationAttemptId appAttemptId3=createAppAttemptId(3,1);
  AppAddedSchedulerEvent appAddedEvent3=new AppAddedSchedulerEvent(appAttemptId3.getApplicationId(),"B.C","user1");
  scheduler.handle(appAddedEvent3);
  assertEquals(3,scheduler.getQueueManager().getLeafQueues().size());
  assertNotNull(scheduler.getSchedulerApplications().get(appAttemptId3.getApplicationId()));
  attempAddedEvent=new AppAttemptAddedSchedulerEvent(appAttemptId3,false);
  scheduler.handle(attempAddedEvent);
  assertEquals(1,scheduler.getQueueManager().getLeafQueue("B.C",true).getNumRunnableApps());
  assertNotNull(scheduler.getSchedulerApp(appAttemptId3));
  ApplicationAttemptId appAttemptId4=createAppAttemptId(4,1);
  AppAddedSchedulerEvent appAddedEvent4=new AppAddedSchedulerEvent(appAttemptId4.getApplicationId(),"A\u00a0","user1");
  scheduler.handle(appAddedEvent4);
  assertEquals(3,scheduler.getQueueManager().getLeafQueues().size());
  assertNull(scheduler.getSchedulerApplications().get(appAttemptId4.getApplicationId()));
  assertNull(scheduler.getSchedulerApp(appAttemptId4));
}
