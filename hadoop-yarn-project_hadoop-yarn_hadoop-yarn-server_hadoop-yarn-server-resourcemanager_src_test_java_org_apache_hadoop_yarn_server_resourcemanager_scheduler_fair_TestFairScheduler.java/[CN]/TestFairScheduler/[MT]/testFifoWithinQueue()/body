{
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  RMNode node1=MockNodes.newNodeInfo(1,Resources.createResource(3072,3),1,"127.0.0.1");
  NodeAddedSchedulerEvent nodeEvent1=new NodeAddedSchedulerEvent(node1);
  scheduler.handle(nodeEvent1);
  ApplicationAttemptId attId1=createSchedulingRequest(1024,"queue1","user1",2);
  ApplicationAttemptId attId2=createSchedulingRequest(1024,"queue1","user1",2);
  FSSchedulerApp app1=scheduler.appAttempts.get(attId1);
  FSSchedulerApp app2=scheduler.appAttempts.get(attId2);
  FSLeafQueue queue1=scheduler.getQueueManager().getLeafQueue("queue1",true);
  queue1.setPolicy(new FifoPolicy());
  scheduler.update();
  NodeUpdateSchedulerEvent updateEvent=new NodeUpdateSchedulerEvent(node1);
  scheduler.handle(updateEvent);
  assertEquals(1,app1.getLiveContainers().size());
  assertEquals(0,app2.getLiveContainers().size());
  scheduler.handle(updateEvent);
  assertEquals(2,app1.getLiveContainers().size());
  assertEquals(0,app2.getLiveContainers().size());
  scheduler.handle(updateEvent);
  assertEquals(2,app1.getLiveContainers().size());
  assertEquals(1,app2.getLiveContainers().size());
}
