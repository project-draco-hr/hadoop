{
  conf.setBoolean(FairSchedulerConfiguration.ASSIGN_MULTIPLE,true);
  conf.setInt(FairSchedulerConfiguration.MAX_ASSIGN,3);
  conf.setBoolean(FairSchedulerConfiguration.SIZE_BASED_WEIGHT,true);
  conf.setDouble(FairSchedulerConfiguration.LOCALITY_THRESHOLD_NODE,.5);
  conf.setDouble(FairSchedulerConfiguration.LOCALITY_THRESHOLD_RACK,.7);
  conf.setBoolean(FairSchedulerConfiguration.CONTINUOUS_SCHEDULING_ENABLED,true);
  conf.setInt(FairSchedulerConfiguration.CONTINUOUS_SCHEDULING_SLEEP_MS,10);
  conf.setInt(FairSchedulerConfiguration.LOCALITY_DELAY_RACK_MS,5000);
  conf.setInt(FairSchedulerConfiguration.LOCALITY_DELAY_NODE_MS,5000);
  conf.setInt(YarnConfiguration.RM_SCHEDULER_MAXIMUM_ALLOCATION_MB,1024);
  conf.setInt(YarnConfiguration.RM_SCHEDULER_MINIMUM_ALLOCATION_MB,512);
  conf.setInt(FairSchedulerConfiguration.RM_SCHEDULER_INCREMENT_ALLOCATION_MB,128);
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  Assert.assertEquals(true,scheduler.assignMultiple);
  Assert.assertEquals(3,scheduler.maxAssign);
  Assert.assertEquals(true,scheduler.sizeBasedWeight);
  Assert.assertEquals(.5,scheduler.nodeLocalityThreshold,.01);
  Assert.assertEquals(.7,scheduler.rackLocalityThreshold,.01);
  Assert.assertTrue("The continuous scheduling should be enabled",scheduler.continuousSchedulingEnabled);
  Assert.assertEquals(10,scheduler.continuousSchedulingSleepMs);
  Assert.assertEquals(5000,scheduler.nodeLocalityDelayMs);
  Assert.assertEquals(5000,scheduler.rackLocalityDelayMs);
  Assert.assertEquals(1024,scheduler.getMaximumResourceCapability().getMemory());
  Assert.assertEquals(512,scheduler.getMinimumResourceCapability().getMemory());
  Assert.assertEquals(128,scheduler.getIncrementResourceCapability().getMemory());
}
