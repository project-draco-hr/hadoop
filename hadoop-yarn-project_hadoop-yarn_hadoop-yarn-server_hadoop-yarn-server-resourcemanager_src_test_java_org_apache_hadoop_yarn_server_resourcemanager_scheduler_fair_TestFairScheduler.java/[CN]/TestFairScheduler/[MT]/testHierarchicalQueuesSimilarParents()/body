{
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  QueueManager queueManager=scheduler.getQueueManager();
  FSLeafQueue leafQueue=queueManager.getLeafQueue("parent.child",true);
  Assert.assertEquals(2,queueManager.getLeafQueues().size());
  Assert.assertNotNull(leafQueue);
  Assert.assertEquals("root.parent.child",leafQueue.getName());
  FSLeafQueue leafQueue2=queueManager.getLeafQueue("parent",true);
  Assert.assertNull(leafQueue2);
  Assert.assertEquals(2,queueManager.getLeafQueues().size());
  FSLeafQueue leafQueue3=queueManager.getLeafQueue("parent.child.grandchild",true);
  Assert.assertNull(leafQueue3);
  Assert.assertEquals(2,queueManager.getLeafQueues().size());
  FSLeafQueue leafQueue4=queueManager.getLeafQueue("parent.sister",true);
  Assert.assertNotNull(leafQueue4);
  Assert.assertEquals("root.parent.sister",leafQueue4.getName());
  Assert.assertEquals(3,queueManager.getLeafQueues().size());
}
