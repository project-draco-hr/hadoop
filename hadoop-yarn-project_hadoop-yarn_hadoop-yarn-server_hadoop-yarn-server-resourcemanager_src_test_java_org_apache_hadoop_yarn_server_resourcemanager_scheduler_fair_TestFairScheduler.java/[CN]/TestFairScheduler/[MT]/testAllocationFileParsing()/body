{
  Configuration conf=new Configuration();
  conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,ALLOC_FILE);
  scheduler.reinitialize(conf,null,resourceManager.getRMContext());
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<queue name=\"queueA\">");
  out.println("<minResources>1024</minResources>");
  out.println("</queue>");
  out.println("<queue name=\"queueB\">");
  out.println("<minResources>2048</minResources>");
  out.println("<aclAdministerApps>alice,bob admins</aclAdministerApps>");
  out.println("</queue>");
  out.println("<queue name=\"queueC\">");
  out.println("<aclSubmitApps>alice,bob admins</aclSubmitApps>");
  out.println("</queue>");
  out.println("<queue name=\"queueD\">");
  out.println("<maxRunningApps>3</maxRunningApps>");
  out.println("</queue>");
  out.println("<queue name=\"queueE\">");
  out.println("<minSharePreemptionTimeout>60</minSharePreemptionTimeout>");
  out.println("</queue>");
  out.println("<queueMaxAppsDefault>15</queueMaxAppsDefault>");
  out.println("<userMaxAppsDefault>5</userMaxAppsDefault>");
  out.println("<user name=\"user1\">");
  out.println("<maxRunningApps>10</maxRunningApps>");
  out.println("</user>");
  out.println("<defaultMinSharePreemptionTimeout>120" + "</defaultMinSharePreemptionTimeout>");
  out.println("<fairSharePreemptionTimeout>300</fairSharePreemptionTimeout>");
  out.println("</allocations>");
  out.close();
  QueueManager queueManager=scheduler.getQueueManager();
  queueManager.initialize();
  assertEquals(6,queueManager.getQueues().size());
  assertEquals(Resources.createResource(0),queueManager.getMinResources(YarnConfiguration.DEFAULT_QUEUE_NAME));
  assertEquals(Resources.createResource(0),queueManager.getMinResources(YarnConfiguration.DEFAULT_QUEUE_NAME));
  assertEquals(Resources.createResource(1024),queueManager.getMinResources("queueA"));
  assertEquals(Resources.createResource(2048),queueManager.getMinResources("queueB"));
  assertEquals(Resources.createResource(0),queueManager.getMinResources("queueC"));
  assertEquals(Resources.createResource(0),queueManager.getMinResources("queueD"));
  assertEquals(Resources.createResource(0),queueManager.getMinResources("queueE"));
  assertEquals(15,queueManager.getQueueMaxApps(YarnConfiguration.DEFAULT_QUEUE_NAME));
  assertEquals(15,queueManager.getQueueMaxApps("queueA"));
  assertEquals(15,queueManager.getQueueMaxApps("queueB"));
  assertEquals(15,queueManager.getQueueMaxApps("queueC"));
  assertEquals(3,queueManager.getQueueMaxApps("queueD"));
  assertEquals(15,queueManager.getQueueMaxApps("queueE"));
  assertEquals(10,queueManager.getUserMaxApps("user1"));
  assertEquals(5,queueManager.getUserMaxApps("user2"));
  Map<QueueACL,AccessControlList> aclsA=queueManager.getQueueAcls("queueA");
  assertTrue(aclsA.containsKey(QueueACL.ADMINISTER_QUEUE));
  assertEquals("*",aclsA.get(QueueACL.ADMINISTER_QUEUE).getAclString());
  assertTrue(aclsA.containsKey(QueueACL.SUBMIT_APPLICATIONS));
  assertEquals("*",aclsA.get(QueueACL.SUBMIT_APPLICATIONS).getAclString());
  Map<QueueACL,AccessControlList> aclsB=queueManager.getQueueAcls("queueB");
  assertTrue(aclsB.containsKey(QueueACL.ADMINISTER_QUEUE));
  assertEquals("alice,bob admins",aclsB.get(QueueACL.ADMINISTER_QUEUE).getAclString());
  Map<QueueACL,AccessControlList> aclsC=queueManager.getQueueAcls("queueC");
  assertTrue(aclsC.containsKey(QueueACL.SUBMIT_APPLICATIONS));
  assertEquals("alice,bob admins",aclsC.get(QueueACL.SUBMIT_APPLICATIONS).getAclString());
  assertEquals(120000,queueManager.getMinSharePreemptionTimeout(YarnConfiguration.DEFAULT_QUEUE_NAME));
  assertEquals(120000,queueManager.getMinSharePreemptionTimeout("queueA"));
  assertEquals(120000,queueManager.getMinSharePreemptionTimeout("queueB"));
  assertEquals(120000,queueManager.getMinSharePreemptionTimeout("queueC"));
  assertEquals(120000,queueManager.getMinSharePreemptionTimeout("queueD"));
  assertEquals(120000,queueManager.getMinSharePreemptionTimeout("queueA"));
  assertEquals(60000,queueManager.getMinSharePreemptionTimeout("queueE"));
  assertEquals(300000,queueManager.getFairSharePreemptionTimeout());
}
