{
  ApplicationAttemptId id=createAppAttemptId(this.APP_ID++,this.ATTEMPT_ID++);
  scheduler.addApplication(id.getApplicationId(),queueId,userId);
  if (scheduler.applications.containsKey(id.getApplicationId())) {
    scheduler.addApplicationAttempt(id);
  }
  List<ResourceRequest> ask=new ArrayList<ResourceRequest>();
  ResourceRequest request=createResourceRequest(memory,vcores,ResourceRequest.ANY,priority,numContainers,true);
  ask.add(request);
  scheduler.allocate(id,ask,new ArrayList<ContainerId>(),null,null);
  return id;
}
