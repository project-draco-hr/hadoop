{
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  assertEquals(1,scheduler.getQueueManager().getLeafQueues().size());
  ApplicationAttemptId appAttemptId1=createAppAttemptId(1,1);
  AppAddedSchedulerEvent appAddedEvent1=new AppAddedSchedulerEvent(appAttemptId1.getApplicationId(),".A","user1");
  scheduler.handle(appAddedEvent1);
  assertEquals(1,scheduler.getQueueManager().getLeafQueues().size());
  assertNull(scheduler.getSchedulerApp(appAttemptId1));
  assertEquals(0,resourceManager.getRMContext().getRMApps().size());
  ApplicationAttemptId appAttemptId2=createAppAttemptId(2,1);
  AppAddedSchedulerEvent appAddedEvent2=new AppAddedSchedulerEvent(appAttemptId2.getApplicationId(),"A.","user1");
  scheduler.handle(appAddedEvent2);
  assertEquals(1,scheduler.getQueueManager().getLeafQueues().size());
  assertNull(scheduler.getSchedulerApp(appAttemptId2));
  assertEquals(0,resourceManager.getRMContext().getRMApps().size());
  ApplicationAttemptId appAttemptId3=createAppAttemptId(3,1);
  AppAddedSchedulerEvent appAddedEvent3=new AppAddedSchedulerEvent(appAttemptId3.getApplicationId(),"A.B","user1");
  scheduler.handle(appAddedEvent3);
  assertEquals(2,scheduler.getQueueManager().getLeafQueues().size());
  assertNull(scheduler.getSchedulerApp(appAttemptId3));
  assertEquals(0,resourceManager.getRMContext().getRMApps().size());
}
