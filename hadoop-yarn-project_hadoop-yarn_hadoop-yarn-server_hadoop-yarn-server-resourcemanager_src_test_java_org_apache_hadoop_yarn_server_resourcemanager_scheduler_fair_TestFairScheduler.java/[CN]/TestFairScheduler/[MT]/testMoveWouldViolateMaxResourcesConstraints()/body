{
  scheduler.init(conf);
  scheduler.start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  QueueManager queueMgr=scheduler.getQueueManager();
  FSLeafQueue oldQueue=queueMgr.getLeafQueue("queue1",true);
  FSQueue queue2=queueMgr.getLeafQueue("queue2",true);
  queue2.setMaxShare(Resource.newInstance(1024,1));
  ApplicationAttemptId appAttId=createSchedulingRequest(1024,1,"queue1","user1",3);
  RMNode node=MockNodes.newNodeInfo(1,Resources.createResource(2048,2));
  NodeAddedSchedulerEvent nodeEvent=new NodeAddedSchedulerEvent(node);
  NodeUpdateSchedulerEvent updateEvent=new NodeUpdateSchedulerEvent(node);
  scheduler.handle(nodeEvent);
  scheduler.handle(updateEvent);
  scheduler.handle(updateEvent);
  assertEquals(Resource.newInstance(2048,2),oldQueue.getResourceUsage());
  scheduler.moveApplication(appAttId.getApplicationId(),"queue2");
}
