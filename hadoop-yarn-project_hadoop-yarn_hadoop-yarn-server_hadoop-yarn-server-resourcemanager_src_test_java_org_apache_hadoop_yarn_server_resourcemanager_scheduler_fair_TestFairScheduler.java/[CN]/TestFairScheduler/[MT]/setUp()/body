{
  scheduler=new FairScheduler();
  Configuration conf=createConfiguration();
  conf.setInt(YarnConfiguration.RM_SCHEDULER_MINIMUM_ALLOCATION_MB,0);
  conf.setInt(FairSchedulerConfiguration.RM_SCHEDULER_INCREMENT_ALLOCATION_MB,1024);
  conf.setInt(YarnConfiguration.RM_SCHEDULER_MAXIMUM_ALLOCATION_MB,10240);
  conf.set(FairSchedulerConfiguration.ASSIGN_MULTIPLE,"false");
  resourceManager=new ResourceManager();
  resourceManager.init(conf);
  ((AsyncDispatcher)resourceManager.getRMContext().getDispatcher()).start();
  resourceManager.getRMContext().getStateStore().start();
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  resourceManager.getRMContainerTokenSecretManager().rollMasterKey();
}
