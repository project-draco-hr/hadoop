{
  scheduler.reinitialize(conf,resourceManager.getRMContext());
  QueueManager queueMgr=scheduler.getQueueManager();
  FSLeafQueue oldQueue=queueMgr.getLeafQueue("queue1",true);
  FSLeafQueue targetQueue=queueMgr.getLeafQueue("queue2",true);
  scheduler.getAllocationConfiguration().queueMaxApps.put("root.queue1",0);
  ApplicationAttemptId appAttId=createSchedulingRequest(1024,1,"queue1","user1",3);
  FSSchedulerApp app=scheduler.getSchedulerApp(appAttId);
  assertTrue(oldQueue.getNonRunnableAppSchedulables().contains(app.getAppSchedulable()));
  scheduler.moveApplication(appAttId.getApplicationId(),"queue2");
  assertFalse(oldQueue.getNonRunnableAppSchedulables().contains(app.getAppSchedulable()));
  assertFalse(targetQueue.getNonRunnableAppSchedulables().contains(app.getAppSchedulable()));
  assertTrue(targetQueue.getRunnableAppSchedulables().contains(app.getAppSchedulable()));
  assertEquals(1,targetQueue.getNumRunnableApps());
  assertEquals(1,queueMgr.getRootQueue().getNumRunnableApps());
}
