{
  Path dirName=new Path(TEST_DIR,"testMidKey.mapfile");
  FileSystem fs=FileSystem.getLocal(conf);
  Path qualifiedDirName=fs.makeQualified(dirName);
  MapFile.Writer writer=new MapFile.Writer(conf,fs,qualifiedDirName.toString(),IntWritable.class,IntWritable.class);
  writer.append(new IntWritable(1),new IntWritable(1));
  writer.close();
  MapFile.Reader reader=new MapFile.Reader(qualifiedDirName,conf);
  try {
    assertEquals(new IntWritable(1),reader.midKey());
  }
  finally {
    reader.close();
  }
}
