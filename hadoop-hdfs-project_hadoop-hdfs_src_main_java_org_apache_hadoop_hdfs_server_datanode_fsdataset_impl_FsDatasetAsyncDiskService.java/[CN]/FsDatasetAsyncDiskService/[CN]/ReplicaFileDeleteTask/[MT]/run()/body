{
  long dfsBytes=blockFile.length() + metaFile.length();
  if (!blockFile.delete() || (!metaFile.delete() && metaFile.exists())) {
    LOG.warn("Unexpected error trying to delete block " + block.getBlockPoolId() + " "+ block.getLocalBlock()+ " at file "+ blockFile+ ". Ignored.");
  }
 else {
    if (block.getLocalBlock().getNumBytes() != BlockCommand.NO_ACK) {
      datanode.notifyNamenodeDeletedBlock(block);
    }
    volume.decDfsUsed(block.getBlockPoolId(),dfsBytes);
    LOG.info("Deleted " + block.getBlockPoolId() + " "+ block.getLocalBlock()+ " file "+ blockFile);
  }
}
