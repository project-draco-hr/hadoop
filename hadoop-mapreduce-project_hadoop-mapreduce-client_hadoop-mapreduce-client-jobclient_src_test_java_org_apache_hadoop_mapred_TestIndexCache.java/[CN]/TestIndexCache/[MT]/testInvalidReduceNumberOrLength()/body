{
  fs.delete(p,true);
  conf.setInt(TTConfig.TT_INDEX_CACHE,1);
  final int partsPerMap=1000;
  final int bytesPerFile=partsPerMap * 24;
  IndexCache cache=new IndexCache(conf);
  Path feq=new Path(p,"invalidReduceOrPartsPerMap");
  writeFile(fs,feq,bytesPerFile,partsPerMap);
  try {
    cache.getIndexInformation("reduceEqualPartsPerMap",partsPerMap,feq,UserGroupInformation.getCurrentUser().getShortUserName());
    fail("Number of reducers equal to partsPerMap did not fail");
  }
 catch (  Exception e) {
    if (!(e instanceof IOException)) {
      throw e;
    }
  }
  try {
    cache.getIndexInformation("reduceMorePartsPerMap",partsPerMap + 1,feq,UserGroupInformation.getCurrentUser().getShortUserName());
    fail("Number of reducers more than partsPerMap did not fail");
  }
 catch (  Exception e) {
    if (!(e instanceof IOException)) {
      throw e;
    }
  }
}
