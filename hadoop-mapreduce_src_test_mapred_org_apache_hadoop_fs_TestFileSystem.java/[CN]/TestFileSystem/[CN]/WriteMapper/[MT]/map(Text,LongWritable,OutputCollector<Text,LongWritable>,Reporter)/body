{
  String name=key.toString();
  long size=value.get();
  long seed=Long.parseLong(name);
  random.setSeed(seed);
  reporter.setStatus("creating " + name);
  Path tempFile=new Path(DATA_DIR,name + suffix);
  OutputStream out=fs.create(tempFile);
  long written=0;
  try {
    while (written < size) {
      if (fastCheck) {
        Arrays.fill(buffer,(byte)random.nextInt(Byte.MAX_VALUE));
      }
 else {
        random.nextBytes(buffer);
      }
      long remains=size - written;
      int length=(remains <= buffer.length) ? (int)remains : buffer.length;
      out.write(buffer,0,length);
      written+=length;
      reporter.setStatus("writing " + name + "@"+ written+ "/"+ size);
    }
  }
  finally {
    out.close();
  }
  fs.rename(tempFile,new Path(DATA_DIR,name));
  collector.collect(new Text("bytes"),new LongWritable(written));
  reporter.setStatus("wrote " + name);
}
