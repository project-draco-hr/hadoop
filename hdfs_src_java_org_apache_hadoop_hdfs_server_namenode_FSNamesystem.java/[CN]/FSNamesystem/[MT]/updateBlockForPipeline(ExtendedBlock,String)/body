{
  LocatedBlock locatedBlock;
  writeLock();
  try {
    checkUCBlock(block,clientName);
    block.setGenerationStamp(nextGenerationStamp());
    locatedBlock=new LocatedBlock(block,new DatanodeInfo[0]);
    if (isBlockTokenEnabled) {
      locatedBlock.setBlockToken(blockTokenSecretManager.generateToken(block,EnumSet.of(BlockTokenSecretManager.AccessMode.WRITE)));
    }
  }
  finally {
    writeUnlock();
  }
  getEditLog().logSync();
  return locatedBlock;
}
