{
  readLock();
  try {
    final List<DatanodeDescriptor> results=getBlockManager().getDatanodeManager().getDatanodeListForReport(DatanodeReportType.ALL);
    for (Iterator<DatanodeDescriptor> it=results.iterator(); it.hasNext(); ) {
      DatanodeDescriptor node=it.next();
      if (isDatanodeDead(node))       dead.add(node);
 else       live.add(node);
    }
  }
  finally {
    readUnlock();
  }
}
