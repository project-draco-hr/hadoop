{
  boolean status=false;
  writeLock();
  try {
    if (isInSafeMode()) {
      throw new SafeModeException("Cannot set replication for " + src,safeMode);
    }
    status=setReplicationInternal(src,replication);
  }
  finally {
    writeUnlock();
  }
  getEditLog().logSync();
  if (status && auditLog.isInfoEnabled() && isExternalInvocation()) {
    logAuditEvent(UserGroupInformation.getCurrentUser(),Server.getRemoteIp(),"setReplication",src,null,null);
  }
  return status;
}
