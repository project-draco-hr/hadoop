{
  int numLive=0;
synchronized (datanodeMap) {
    for (Iterator<DatanodeDescriptor> it=datanodeMap.values().iterator(); it.hasNext(); ) {
      DatanodeDescriptor dn=it.next();
      if (!isDatanodeDead(dn)) {
        numLive++;
      }
    }
  }
  return numLive;
}
