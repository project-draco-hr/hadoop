{
  if (reached < 0)   return "Safe mode is OFF.";
  String leaveMsg="";
  if (areResourcesLow()) {
    leaveMsg="Resources are low on NN. Safe mode must be turned off manually";
  }
 else {
    leaveMsg="Safe mode will be turned off automatically";
  }
  if (isManual()) {
    if (getDistributedUpgradeState())     return leaveMsg + " upon completion of " + "the distributed upgrade: upgrade progress = "+ getDistributedUpgradeStatus()+ "%";
    leaveMsg="Use \"hdfs dfsadmin -safemode leave\" to turn safe mode off";
  }
  if (blockTotal < 0)   return leaveMsg + ".";
  int numLive=getNumLiveDataNodes();
  String msg="";
  if (reached == 0) {
    if (blockSafe < blockThreshold) {
      msg+=String.format("The reported blocks %d needs additional %d" + " blocks to reach the threshold %.4f of total blocks %d.",blockSafe,(blockThreshold - blockSafe),threshold,blockTotal);
    }
    if (numLive < datanodeThreshold) {
      if (!"".equals(msg)) {
        msg+="\n";
      }
      msg+=String.format("The number of live datanodes %d needs an additional %d live " + "datanodes to reach the minimum number %d.",numLive,datanodeThreshold - numLive,datanodeThreshold);
    }
    msg+=" " + leaveMsg;
  }
 else {
    msg=String.format("The reported blocks %d has reached the threshold" + " %.4f of total blocks %d.",blockSafe,threshold,blockTotal);
    if (datanodeThreshold > 0) {
      msg+=String.format(" The number of live datanodes %d has reached " + "the minimum number %d.",numLive,datanodeThreshold);
    }
    msg+=" " + leaveMsg;
  }
  if (reached == 0 || isManual()) {
    return msg + ".";
  }
  return msg + " in " + Math.abs(reached + extension - now()) / 1000 + " seconds.";
}
