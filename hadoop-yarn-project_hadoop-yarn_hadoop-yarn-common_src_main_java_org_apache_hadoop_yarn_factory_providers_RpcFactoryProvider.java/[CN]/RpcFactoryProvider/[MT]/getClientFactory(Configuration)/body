{
  String clientFactoryClassName=conf.get(YarnConfiguration.IPC_CLIENT_FACTORY);
  if (clientFactoryClassName == null) {
    if (conf.get(YarnConfiguration.IPC_SERIALIZER_TYPE,YarnConfiguration.DEFAULT_IPC_SERIALIZER_TYPE).equals(YarnConfiguration.DEFAULT_IPC_SERIALIZER_TYPE)) {
      return RpcClientFactoryPBImpl.get();
    }
 else {
      throw new YarnException("Unknown serializer: [" + conf.get(YarnConfiguration.IPC_SERIALIZER_TYPE) + "]. Use keys: ["+ YarnConfiguration.IPC_CLIENT_FACTORY+ "]["+ YarnConfiguration.IPC_SERVER_FACTORY+ "] to specify factories");
    }
  }
 else {
    return (RpcClientFactory)getFactoryClassInstance(clientFactoryClassName);
  }
}
