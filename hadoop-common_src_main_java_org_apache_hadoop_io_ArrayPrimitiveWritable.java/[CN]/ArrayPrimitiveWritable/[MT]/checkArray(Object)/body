{
  if (value == null) {
    throw new HadoopIllegalArgumentException("null value not allowed");
  }
  if (!value.getClass().isArray()) {
    throw new HadoopIllegalArgumentException("non-array value of class " + value.getClass() + " not allowed");
  }
}
