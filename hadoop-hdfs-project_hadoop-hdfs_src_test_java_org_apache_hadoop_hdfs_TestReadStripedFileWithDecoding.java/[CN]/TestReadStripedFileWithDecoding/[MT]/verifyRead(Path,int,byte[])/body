{
  try (FSDataInputStream fsdis=fs.open(file)){
    byte[] buf=new byte[length];
    int readLen=fsdis.read(0,buf,0,buf.length);
    Assert.assertEquals("The fileSize of file should be the same to write size",length,readLen);
    Assert.assertArrayEquals(expected,buf);
  }
   ByteBuffer result=ByteBuffer.allocate(length);
  ByteBuffer buf=ByteBuffer.allocate(1024);
  int readLen=0;
  int ret;
  try (FSDataInputStream in=fs.open(file)){
    while ((ret=in.read(buf)) >= 0) {
      readLen+=ret;
      buf.flip();
      result.put(buf);
      buf.clear();
    }
  }
   Assert.assertEquals("The length of file should be the same to write size",length,readLen);
  Assert.assertArrayEquals(expected,result.array());
}
