{
  configuration.set(YarnConfiguration.RM_CONFIGURATION_PROVIDER_CLASS,"org.apache.hadoop.yarn.FileSystemBasedConfigurationProvider");
  rm=new MockRM(configuration);
  rm.init(configuration);
  rm.start();
  cleanRemoteDirectory();
  try {
    rm.adminService.refreshAdminAcls(RefreshAdminAclsRequest.newInstance());
    fail("FileSystemBasedConfigurationProvider is used." + " Should get an exception here");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().contains("Can not find Configuration: yarn-site.xml"));
  }
  String aclStringBefore=rm.adminService.getAccessControlList().getAclString().trim();
  YarnConfiguration yarnConf=new YarnConfiguration();
  yarnConf.set(YarnConfiguration.YARN_ADMIN_ACL,"world:anyone:rwcda");
  String yarnConfFile=writeConfigurationXML(yarnConf,"yarn-site.xml");
  uploadToRemoteFileSystem(new Path(yarnConfFile));
  rm.adminService.refreshAdminAcls(RefreshAdminAclsRequest.newInstance());
  String aclStringAfter=rm.adminService.getAccessControlList().getAclString().trim();
  Assert.assertTrue(!aclStringAfter.equals(aclStringBefore));
  Assert.assertEquals(aclStringAfter,"world:anyone:rwcda");
}
