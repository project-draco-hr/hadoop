{
  configuration.set(YarnConfiguration.RM_CONFIGURATION_PROVIDER_CLASS,"org.apache.hadoop.yarn.FileSystemBasedConfigurationProvider");
  try {
    rm=new MockRM(configuration);
    rm.init(configuration);
    rm.start();
    fail("Should throw an exception");
  }
 catch (  Exception ex) {
  }
  uploadDefaultConfiguration();
  try {
    rm=new MockRM(configuration);
    rm.init(configuration);
    rm.start();
  }
 catch (  Exception ex) {
    fail("Should not get any exceptions");
  }
  Configuration coreConf=new Configuration(false);
  coreConf.set("hadoop.proxyuser.test.groups","test_groups");
  coreConf.set("hadoop.proxyuser.test.hosts","test_hosts");
  uploadConfiguration(coreConf,"core-site.xml");
  rm.adminService.refreshSuperUserGroupsConfiguration(RefreshSuperUserGroupsConfigurationRequest.newInstance());
  Assert.assertTrue(ProxyUsers.getProxyGroups().get("hadoop.proxyuser.test.groups").size() == 1);
  Assert.assertTrue(ProxyUsers.getProxyGroups().get("hadoop.proxyuser.test.groups").contains("test_groups"));
  Assert.assertTrue(ProxyUsers.getProxyHosts().get("hadoop.proxyuser.test.hosts").size() == 1);
  Assert.assertTrue(ProxyUsers.getProxyHosts().get("hadoop.proxyuser.test.hosts").contains("test_hosts"));
}
