{
  configuration.set(YarnConfiguration.RM_CONFIGURATION_PROVIDER_CLASS,"org.apache.hadoop.yarn.FileSystemBasedConfigurationProvider");
  rm=new MockRM(configuration);
  rm.init(configuration);
  rm.start();
  cleanRemoteDirectory();
  try {
    rm.adminService.refreshSuperUserGroupsConfiguration(RefreshSuperUserGroupsConfigurationRequest.newInstance());
    fail("FileSystemBasedConfigurationProvider is used." + " Should get an exception here");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().contains("Can not find Configuration: core-site.xml"));
  }
  Configuration coreConf=new Configuration(false);
  coreConf.set("hadoop.proxyuser.test.groups","test_groups");
  coreConf.set("hadoop.proxyuser.test.hosts","test_hosts");
  String coreConfFile=writeConfigurationXML(coreConf,"core-site.xml");
  uploadToRemoteFileSystem(new Path(coreConfFile));
  rm.adminService.refreshSuperUserGroupsConfiguration(RefreshSuperUserGroupsConfigurationRequest.newInstance());
  Assert.assertTrue(ProxyUsers.getProxyGroups().get("hadoop.proxyuser.test.groups").size() == 1);
  Assert.assertTrue(ProxyUsers.getProxyGroups().get("hadoop.proxyuser.test.groups").contains("test_groups"));
  Assert.assertTrue(ProxyUsers.getProxyHosts().get("hadoop.proxyuser.test.hosts").size() == 1);
  Assert.assertTrue(ProxyUsers.getProxyHosts().get("hadoop.proxyuser.test.hosts").contains("test_hosts"));
}
