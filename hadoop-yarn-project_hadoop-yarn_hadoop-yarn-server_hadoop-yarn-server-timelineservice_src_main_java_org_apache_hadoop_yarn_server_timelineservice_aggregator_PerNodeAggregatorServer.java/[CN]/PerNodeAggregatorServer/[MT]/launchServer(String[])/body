{
  Thread.setDefaultUncaughtExceptionHandler(new YarnUncaughtExceptionHandler());
  StringUtils.startupShutdownMessage(PerNodeAggregatorServer.class,args,LOG);
  PerNodeAggregatorServer server=null;
  try {
    server=new PerNodeAggregatorServer();
    ShutdownHookManager.get().addShutdownHook(new ShutdownHook(server),SHUTDOWN_HOOK_PRIORITY);
    YarnConfiguration conf=new YarnConfiguration();
    server.init(conf);
    server.start();
  }
 catch (  Throwable t) {
    LOG.fatal("Error starting PerNodeAggregatorServer",t);
    ExitUtil.terminate(-1,"Error starting PerNodeAggregatorServer");
  }
  return server;
}
