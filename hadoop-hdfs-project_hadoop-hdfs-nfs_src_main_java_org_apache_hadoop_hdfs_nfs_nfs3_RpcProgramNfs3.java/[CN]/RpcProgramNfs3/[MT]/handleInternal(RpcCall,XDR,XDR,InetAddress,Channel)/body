{
  final NFSPROC3 nfsproc3=NFSPROC3.fromValue(rpcCall.getProcedure());
  int xid=rpcCall.getXid();
  Credentials credentials=rpcCall.getCredential();
  if (nfsproc3 != NFSPROC3.NULL) {
    if (rpcCall.getCredential().getFlavor() != AuthFlavor.AUTH_SYS && rpcCall.getCredential().getFlavor() != AuthFlavor.RPCSEC_GSS) {
      LOG.info("Wrong RPC AUTH flavor, " + rpcCall.getCredential().getFlavor() + " is not AUTH_SYS or RPCSEC_GSS.");
      XDR reply=new XDR();
      reply=RpcDeniedReply.voidReply(reply,xid,RpcReply.ReplyState.MSG_ACCEPTED,RpcDeniedReply.RejectState.AUTH_ERROR);
      return reply;
    }
  }
  SecurityHandler securityHandler=getSecurityHandler(credentials,rpcCall.getVerifier());
  NFS3Response response=null;
  if (nfsproc3 == NFSPROC3.NULL) {
    response=nullProcedure();
  }
 else   if (nfsproc3 == NFSPROC3.GETATTR) {
    response=getattr(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.SETATTR) {
    response=setattr(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.LOOKUP) {
    response=lookup(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.ACCESS) {
    response=access(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.READLINK) {
    response=readlink(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.READ) {
    if (LOG.isDebugEnabled()) {
      LOG.debug(Nfs3Utils.READ_RPC_START + xid);
    }
    response=read(xdr,securityHandler,client);
    if (LOG.isDebugEnabled() && (nfsproc3 == NFSPROC3.READ)) {
      LOG.debug(Nfs3Utils.READ_RPC_END + xid);
    }
  }
 else   if (nfsproc3 == NFSPROC3.WRITE) {
    if (LOG.isDebugEnabled()) {
      LOG.debug(Nfs3Utils.WRITE_RPC_START + xid);
    }
    response=write(xdr,channel,xid,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.CREATE) {
    response=create(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.MKDIR) {
    response=mkdir(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.SYMLINK) {
    response=symlink(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.MKNOD) {
    response=mknod(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.REMOVE) {
    response=remove(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.RMDIR) {
    response=rmdir(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.RENAME) {
    response=rename(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.LINK) {
    response=link(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.READDIR) {
    response=readdir(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.READDIRPLUS) {
    response=readdirplus(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.FSSTAT) {
    response=fsstat(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.FSINFO) {
    response=fsinfo(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.PATHCONF) {
    response=pathconf(xdr,securityHandler,client);
  }
 else   if (nfsproc3 == NFSPROC3.COMMIT) {
    response=commit(xdr,securityHandler,client);
  }
 else {
    RpcAcceptedReply.voidReply(out,xid,RpcAcceptedReply.AcceptState.PROC_UNAVAIL);
  }
  if (response != null) {
    out=response.send(out,xid);
  }
  return out;
}
