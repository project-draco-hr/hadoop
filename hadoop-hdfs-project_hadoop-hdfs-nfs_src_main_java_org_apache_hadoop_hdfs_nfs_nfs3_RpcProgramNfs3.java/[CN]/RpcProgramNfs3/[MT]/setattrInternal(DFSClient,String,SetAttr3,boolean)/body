{
  EnumSet<SetAttrField> updateFields=newAttr.getUpdateFields();
  if (setMode && updateFields.contains(SetAttrField.MODE)) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("set new mode:" + newAttr.getMode());
    }
    dfsClient.setPermission(fileIdPath,new FsPermission((short)(newAttr.getMode())));
  }
  if (updateFields.contains(SetAttrField.UID) || updateFields.contains(SetAttrField.GID)) {
    String uname=updateFields.contains(SetAttrField.UID) ? iug.getUserName(newAttr.getUid(),IdMappingConstant.UNKNOWN_USER) : null;
    String gname=updateFields.contains(SetAttrField.GID) ? iug.getGroupName(newAttr.getGid(),IdMappingConstant.UNKNOWN_GROUP) : null;
    dfsClient.setOwner(fileIdPath,uname,gname);
  }
  long atime=updateFields.contains(SetAttrField.ATIME) ? newAttr.getAtime().getMilliSeconds() : -1;
  long mtime=updateFields.contains(SetAttrField.MTIME) ? newAttr.getMtime().getMilliSeconds() : -1;
  if (atime != -1 || mtime != -1) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("set atime:" + +atime + " mtime:"+ mtime);
    }
    dfsClient.setTimes(fileIdPath,mtime,atime);
  }
}
