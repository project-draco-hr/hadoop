{
  mySetup();
  try {
    Path topDir=new Path(TEST_DIR + "/testenumeration");
    createTestTree(topDir);
    LOG.info("Enumerating files");
    List<FileStatus> startPaths=new LinkedList<FileStatus>();
    startPaths.add(fs.getFileStatus(topDir));
    DirectoryTraversal dt=new DirectoryTraversal(fs,startPaths,2);
    List<FileStatus> selected=new LinkedList<FileStatus>();
    while (true) {
      FileStatus f=dt.getNextFile();
      if (f == null)       break;
      assertEquals(false,f.isDir());
      LOG.info(f.getPath());
      selected.add(f);
    }
    assertEquals(5,selected.size());
    LOG.info("Enumerating directories");
    startPaths.clear();
    startPaths.add(fs.getFileStatus(topDir));
    dt=new DirectoryTraversal(fs,startPaths);
    selected.clear();
    while (true) {
      FileStatus dir=dt.getNextDirectory();
      if (dir == null)       break;
      assertEquals(true,dir.isDir());
      LOG.info(dir.getPath());
      selected.add(dir);
    }
    assertEquals(4,selected.size());
  }
  finally {
    myTearDown();
  }
}
