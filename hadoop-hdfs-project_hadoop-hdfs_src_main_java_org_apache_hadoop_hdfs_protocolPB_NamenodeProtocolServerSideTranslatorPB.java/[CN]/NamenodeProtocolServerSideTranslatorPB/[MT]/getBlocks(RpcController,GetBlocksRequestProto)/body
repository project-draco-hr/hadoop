{
  DatanodeInfo dnInfo=new DatanodeInfo(PBHelper.convert(request.getDatanode()));
  BlocksWithLocations blocks;
  try {
    blocks=impl.getBlocks(dnInfo,request.getSize());
  }
 catch (  IOException e) {
    throw new ServiceException(e);
  }
  return GetBlocksResponseProto.newBuilder().setBlocks(PBHelper.convert(blocks)).build();
}
