{
  config=new Configuration();
  String baseDir=System.getProperty("test.build.data","build/test/data");
  hdfsDir=new File(baseDir,"dfs");
  if (hdfsDir.exists() && !FileUtil.fullyDelete(hdfsDir)) {
    throw new IOException("Could not delete hdfs directory '" + hdfsDir + "'");
  }
  LOG.info("hdfsdir is " + hdfsDir.getAbsolutePath());
  File nameDir1=new File(hdfsDir,"name1");
  File nameDir2=new File(hdfsDir,"name2");
  nameDir1.mkdirs();
  config.set(DFS_NAMENODE_NAME_DIR_KEY,nameDir1.getPath() + "," + nameDir2.getPath());
  config.set(DFS_DATANODE_DATA_DIR_KEY,new File(hdfsDir,"data").getPath());
  config.set(DFS_NAMENODE_CHECKPOINT_DIR_KEY,new File(hdfsDir,"secondary").getPath());
  FileSystem.setDefaultUri(config,"hdfs://" + NAME_NODE_HOST + "0");
}
