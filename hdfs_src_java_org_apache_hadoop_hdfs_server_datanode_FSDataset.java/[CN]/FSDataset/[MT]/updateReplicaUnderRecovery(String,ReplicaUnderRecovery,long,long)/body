{
  if (rur.getRecoveryID() != recoveryId) {
    throw new IOException("rur.getRecoveryID() != recoveryId = " + recoveryId + ", rur="+ rur);
  }
  bumpReplicaGS(rur,recoveryId);
  final File replicafile=rur.getBlockFile();
  if (rur.getNumBytes() < newlength) {
    throw new IOException("rur.getNumBytes() < newlength = " + newlength + ", rur="+ rur);
  }
  if (rur.getNumBytes() > newlength) {
    rur.unlinkBlock(1);
    truncateBlock(replicafile,rur.getMetaFile(),rur.getNumBytes(),newlength);
    rur.setNumBytes(newlength);
  }
  return finalizeReplica(bpid,rur);
}
