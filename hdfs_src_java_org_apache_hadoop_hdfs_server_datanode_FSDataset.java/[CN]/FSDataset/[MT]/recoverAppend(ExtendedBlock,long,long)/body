{
  DataNode.LOG.info("Recover failed append to " + b);
  ReplicaInfo replicaInfo=recoverCheck(b,newGS,expectedBlockLen);
  if (replicaInfo.getState() == ReplicaState.FINALIZED) {
    return append(b.getBlockPoolId(),(FinalizedReplica)replicaInfo,newGS,b.getNumBytes());
  }
 else {
    bumpReplicaGS(replicaInfo,newGS);
    return (ReplicaBeingWritten)replicaInfo;
  }
}
