{
  res.setCharacterEncoding("UTF-8");
  String uri=HtmlQuoting.quoteHtmlChars(req.getRequestURI());
  if (uri == null) {
    uri="/";
  }
  RMWebApp rmWebApp=(RMWebApp)webApp;
  rmWebApp.checkIfStandbyRM();
  if (rmWebApp.isStandby() && !uri.equals("/" + rmWebApp.name() + "/cluster")) {
    String redirectPath=rmWebApp.getRedirectPath() + uri;
    if (redirectPath != null && !redirectPath.isEmpty()) {
      String redirectMsg="This is standby RM. Redirecting to the current active RM: " + redirectPath;
      res.addHeader("Refresh","3; url=" + redirectPath);
      PrintWriter out=res.getWriter();
      out.println(redirectMsg);
      return;
    }
  }
  super.service(req,res);
}
