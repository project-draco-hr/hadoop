{
  LOG.info("JobHistory Init");
  this.conf=conf;
  this.appID=RecordFactoryProvider.getRecordFactory(conf).newRecordInstance(ApplicationId.class);
  this.appAttemptID=RecordFactoryProvider.getRecordFactory(conf).newRecordInstance(ApplicationAttemptId.class);
  moveThreadInterval=conf.getLong(JHAdminConfig.MR_HISTORY_MOVE_INTERVAL_MS,JHAdminConfig.DEFAULT_MR_HISTORY_MOVE_INTERVAL_MS);
  numMoveThreads=conf.getInt(JHAdminConfig.MR_HISTORY_MOVE_THREAD_COUNT,JHAdminConfig.DEFAULT_MR_HISTORY_MOVE_THREAD_COUNT);
  hsManager=new HistoryFileManager();
  hsManager.init(conf);
  try {
    hsManager.initExisting();
  }
 catch (  IOException e) {
    throw new YarnException("Failed to intialize existing directories",e);
  }
  storage=ReflectionUtils.newInstance(conf.getClass(JHAdminConfig.MR_HISTORY_STORAGE,CachedHistoryStorage.class,HistoryStorage.class),conf);
  if (storage instanceof Service) {
    ((Service)storage).init(conf);
  }
  storage.setHistoryFileManager(hsManager);
  super.init(conf);
}
