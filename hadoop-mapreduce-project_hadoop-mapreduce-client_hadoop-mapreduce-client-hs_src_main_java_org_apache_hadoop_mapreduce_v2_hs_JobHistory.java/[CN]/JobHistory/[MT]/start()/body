{
  moveIntermediateToDoneRunnable=new MoveIntermediateToDoneRunnable(moveThreadInterval,numMoveThreads);
  moveIntermediateToDoneThread=new Thread(moveIntermediateToDoneRunnable);
  moveIntermediateToDoneThread.setName("MoveIntermediateToDoneScanner");
  moveIntermediateToDoneThread.start();
  boolean startCleanerService=conf.getBoolean(JHAdminConfig.MR_HISTORY_CLEANER_ENABLE,true);
  if (startCleanerService) {
    long maxAgeOfHistoryFiles=conf.getLong(JHAdminConfig.MR_HISTORY_MAX_AGE_MS,DEFAULT_HISTORY_MAX_AGE);
    cleanerScheduledExecutor=new ScheduledThreadPoolExecutor(1,new ThreadFactoryBuilder().setNameFormat("LogCleaner").build());
    long runInterval=conf.getLong(JHAdminConfig.MR_HISTORY_CLEANER_INTERVAL_MS,DEFAULT_RUN_INTERVAL);
    cleanerScheduledExecutor.scheduleAtFixedRate(new HistoryCleaner(maxAgeOfHistoryFiles),30 * 1000l,runInterval,TimeUnit.MILLISECONDS);
  }
  super.start();
}
