{
  SortedMap<JobId,JobIndexInfo> result=new TreeMap<JobId,JobIndexInfo>(JOB_ID_COMPARATOR);
  try {
    scanIntermediateDirectory();
  }
 catch (  IOException e) {
    LOG.warn("Failed to scan intermediate directory",e);
    throw new YarnException(e);
  }
  for (  JobId jobId : intermediateListCache.keySet()) {
    MetaInfo mi=intermediateListCache.get(jobId);
    if (mi != null) {
      result.put(jobId,mi.getJobIndexInfo());
    }
  }
  for (  JobId jobId : jobListCache.keySet()) {
    MetaInfo mi=jobListCache.get(jobId);
    if (mi != null) {
      result.put(jobId,mi.getJobIndexInfo());
    }
  }
  return result;
}
