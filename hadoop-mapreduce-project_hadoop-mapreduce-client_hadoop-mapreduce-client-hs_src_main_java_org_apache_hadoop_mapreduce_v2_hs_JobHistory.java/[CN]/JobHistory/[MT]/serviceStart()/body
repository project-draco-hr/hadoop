{
  hsManager.start();
  if (storage instanceof Service) {
    ((Service)storage).start();
  }
  scheduledExecutor=new ScheduledThreadPoolExecutor(2,new ThreadFactoryBuilder().setNameFormat("Log Scanner/Cleaner #%d").build());
  scheduledExecutor.scheduleAtFixedRate(new MoveIntermediateToDoneRunnable(),moveThreadInterval,moveThreadInterval,TimeUnit.MILLISECONDS);
  boolean startCleanerService=conf.getBoolean(JHAdminConfig.MR_HISTORY_CLEANER_ENABLE,true);
  if (startCleanerService) {
    long runInterval=conf.getLong(JHAdminConfig.MR_HISTORY_CLEANER_INTERVAL_MS,JHAdminConfig.DEFAULT_MR_HISTORY_CLEANER_INTERVAL_MS);
    scheduledExecutor.scheduleAtFixedRate(new HistoryCleaner(),30 * 1000l,runInterval,TimeUnit.MILLISECONDS);
  }
  super.serviceStart();
}
