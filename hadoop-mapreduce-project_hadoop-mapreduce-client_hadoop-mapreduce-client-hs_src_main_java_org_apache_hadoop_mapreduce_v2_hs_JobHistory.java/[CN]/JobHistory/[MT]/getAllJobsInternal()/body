{
  SortedMap<JobId,Job> result=new TreeMap<JobId,Job>();
  try {
    scanIntermediateDirectory();
  }
 catch (  IOException e) {
    LOG.warn("Failed to scan intermediate directory",e);
    throw new YarnException(e);
  }
  for (  JobId jobId : intermediateListCache.keySet()) {
    MetaInfo mi=intermediateListCache.get(jobId);
    if (mi != null) {
      result.put(jobId,new PartialJob(mi.getJobIndexInfo(),mi.getJobIndexInfo().getJobId()));
    }
  }
  for (  JobId jobId : jobListCache.keySet()) {
    MetaInfo mi=jobListCache.get(jobId);
    if (mi != null) {
      result.put(jobId,new PartialJob(mi.getJobIndexInfo(),mi.getJobIndexInfo().getJobId()));
    }
  }
  return result;
}
