{
  Thread.currentThread().setName("IntermediateHistoryScanner");
  try {
    while (running) {
      LOG.info("Starting scan to move intermediate done files");
      scanIntermediateDirectory();
      for (      final MetaInfo metaInfo : intermediateListCache.values()) {
        moveToDoneExecutor.execute(new Runnable(){
          @Override public void run(){
            try {
              moveToDone(metaInfo);
            }
 catch (            IOException e) {
              LOG.info("Failed to process metaInfo for job: " + metaInfo.jobIndexInfo.getJobId(),e);
            }
          }
        }
);
      }
synchronized (this) {
        try {
          this.wait(sleepTime);
        }
 catch (        InterruptedException e) {
          LOG.info("IntermediateHistoryScannerThread interrupted");
        }
      }
    }
  }
 catch (  IOException e) {
    LOG.warn("Unable to get a list of intermediate files to be moved from: " + intermediateDoneDirPath);
  }
}
