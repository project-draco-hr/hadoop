{
  Thread.currentThread().setName("IntermediateHistoryScanner");
  try {
    while (true) {
      LOG.info("Starting scan to move intermediate done files");
      for (      final MetaInfo metaInfo : hsManager.getIntermediateMetaInfos()) {
        moveToDoneExecutor.execute(new Runnable(){
          @Override public void run(){
            try {
              hsManager.moveToDone(metaInfo);
            }
 catch (            IOException e) {
              LOG.info("Failed to process metaInfo for job: " + metaInfo.getJobId(),e);
            }
          }
        }
);
      }
synchronized (this) {
        try {
          this.wait(sleepTime);
        }
 catch (        InterruptedException e) {
          LOG.info("IntermediateHistoryScannerThread interrupted");
        }
        if (!running) {
          break;
        }
      }
    }
  }
 catch (  IOException e) {
    LOG.warn("Unable to get a list of intermediate files to be moved");
  }
}
