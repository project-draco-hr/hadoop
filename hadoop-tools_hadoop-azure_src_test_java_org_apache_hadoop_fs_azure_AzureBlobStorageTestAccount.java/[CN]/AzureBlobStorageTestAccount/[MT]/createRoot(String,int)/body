{
  NativeAzureFileSystem fs=null;
  CloudBlobContainer container=null;
  Configuration conf=createTestConfiguration();
  CloudStorageAccount account=createTestAccount(conf);
  if (account == null) {
    return null;
  }
  CloudBlobClient blobClient=account.createCloudBlobClient();
  String accountName=conf.get(TEST_ACCOUNT_NAME_PROPERTY_NAME);
  CloudBlockBlob blobRoot=primeRootContainer(blobClient,accountName,blobName,fileSize);
  container=blobClient.getContainerReference(AZURE_ROOT_CONTAINER);
  if (null == container || !container.exists()) {
    final String errMsg=String.format("Container '%s' expected but not found while creating SAS account.");
    throw new Exception(errMsg);
  }
  URI accountUri=createAccountUri(accountName);
  fs=new NativeAzureFileSystem();
  fs.initialize(accountUri,conf);
  AzureBlobStorageTestAccount testAcct=new AzureBlobStorageTestAccount(fs,account,blobRoot);
  return testAcct;
}
