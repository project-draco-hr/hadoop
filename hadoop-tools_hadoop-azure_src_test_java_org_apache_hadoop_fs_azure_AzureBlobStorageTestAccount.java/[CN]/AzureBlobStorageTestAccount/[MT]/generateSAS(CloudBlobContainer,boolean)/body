{
  container.createIfNotExists();
  SharedAccessBlobPolicy sasPolicy=new SharedAccessBlobPolicy();
  GregorianCalendar calendar=new GregorianCalendar(TimeZone.getTimeZone("UTC"));
  calendar.setTime(new Date());
  sasPolicy.setSharedAccessStartTime(calendar.getTime());
  calendar.add(Calendar.HOUR,10);
  sasPolicy.setSharedAccessExpiryTime(calendar.getTime());
  if (readonly) {
    sasPolicy.setPermissions(EnumSet.of(SharedAccessBlobPermissions.READ,SharedAccessBlobPermissions.LIST));
  }
 else {
    sasPolicy.setPermissions(EnumSet.of(SharedAccessBlobPermissions.READ,SharedAccessBlobPermissions.WRITE,SharedAccessBlobPermissions.LIST));
  }
  BlobContainerPermissions containerPermissions=new BlobContainerPermissions();
  containerPermissions.setPublicAccess(BlobContainerPublicAccessType.OFF);
  container.uploadPermissions(containerPermissions);
  String sas=container.generateSharedAccessSignature(sasPolicy,null);
  Thread.sleep(1500);
  return sas;
}
