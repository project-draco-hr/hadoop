{
  FileSplit split=(FileSplit)genericSplit;
  Configuration job=context.getConfiguration();
  this.maxLineLength=job.getInt(MAX_LINE_LENGTH,Integer.MAX_VALUE);
  start=split.getStart();
  end=start + split.getLength();
  final Path file=split.getPath();
  compressionCodecs=new CompressionCodecFactory(job);
  codec=compressionCodecs.getCodec(file);
  final FileSystem fs=file.getFileSystem(job);
  fileIn=fs.open(file);
  if (isCompressedInput()) {
    decompressor=CodecPool.getDecompressor(codec);
    if (codec instanceof SplittableCompressionCodec) {
      final SplitCompressionInputStream cIn=((SplittableCompressionCodec)codec).createInputStream(fileIn,decompressor,start,end,SplittableCompressionCodec.READ_MODE.BYBLOCK);
      if (null == this.recordDelimiterBytes) {
        in=new LineReader(cIn,job);
      }
 else {
        in=new LineReader(cIn,job,this.recordDelimiterBytes);
      }
      start=cIn.getAdjustedStart();
      end=cIn.getAdjustedEnd();
      filePosition=cIn;
    }
 else {
      if (null == this.recordDelimiterBytes) {
        in=new LineReader(codec.createInputStream(fileIn,decompressor),job);
      }
 else {
        in=new LineReader(codec.createInputStream(fileIn,decompressor),job,this.recordDelimiterBytes);
      }
      filePosition=fileIn;
    }
  }
 else {
    fileIn.seek(start);
    if (null == this.recordDelimiterBytes) {
      in=new LineReader(fileIn,job);
    }
 else {
      in=new LineReader(fileIn,job,this.recordDelimiterBytes);
    }
    filePosition=fileIn;
  }
  if (start != 0) {
    start+=in.readLine(new Text(),0,maxBytesToConsume(start));
  }
  this.pos=start;
}
