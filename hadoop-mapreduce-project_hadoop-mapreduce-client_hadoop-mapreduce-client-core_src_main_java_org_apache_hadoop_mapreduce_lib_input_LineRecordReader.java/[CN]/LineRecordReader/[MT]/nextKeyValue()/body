{
  if (key == null) {
    key=new LongWritable();
  }
  key.set(pos);
  if (value == null) {
    value=new Text();
  }
  int newSize=0;
  while (getFilePosition() <= end || in.needAdditionalRecordAfterSplit()) {
    newSize=in.readLine(value,maxLineLength,maxBytesToConsume(pos));
    pos+=newSize;
    if (newSize < maxLineLength) {
      break;
    }
    LOG.info("Skipped line of size " + newSize + " at pos "+ (pos - newSize));
  }
  if (newSize == 0) {
    key=null;
    value=null;
    return false;
  }
 else {
    return true;
  }
}
