{
  final DirectoryWithQuotaFeature q=getDirectoryWithQuotaFeature();
  if (q != null) {
    if (useCache && isQuotaSet()) {
      q.addNamespaceDiskspace(counts);
    }
 else {
      computeDirectoryQuotaUsage(counts,false,lastSnapshotId);
    }
    return counts;
  }
 else {
    return computeDirectoryQuotaUsage(counts,useCache,lastSnapshotId);
  }
}
