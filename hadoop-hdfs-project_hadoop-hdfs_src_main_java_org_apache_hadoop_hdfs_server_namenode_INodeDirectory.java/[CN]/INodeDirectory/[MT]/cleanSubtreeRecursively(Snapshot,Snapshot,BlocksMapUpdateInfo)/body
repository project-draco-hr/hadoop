{
  Quota.Counts counts=Quota.Counts.newInstance();
  Snapshot s=snapshot != null && prior != null ? prior : snapshot;
  for (  INode child : getChildrenList(s)) {
    Quota.Counts childCounts=child.cleanSubtree(snapshot,prior,collectedBlocks);
    counts.add(childCounts);
  }
  return counts;
}
