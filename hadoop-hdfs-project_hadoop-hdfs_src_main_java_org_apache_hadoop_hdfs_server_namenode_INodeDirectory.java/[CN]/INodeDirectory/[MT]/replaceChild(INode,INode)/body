{
  Preconditions.checkNotNull(children);
  final int i=searchChildren(newChild.getLocalNameBytes());
  Preconditions.checkState(i >= 0);
  Preconditions.checkState(oldChild == children.get(i));
  if (oldChild.isReference() && !newChild.isReference()) {
    final INode withCount=oldChild.asReference().getReferredINode();
    withCount.asReference().setReferredINode(newChild);
  }
 else {
    final INode removed=children.set(i,newChild);
    Preconditions.checkState(removed == oldChild);
  }
}
