{
  assertChildrenNonNull();
  if (latestSnapshot != null) {
    final INodeDirectoryWithSnapshot dir=INodeDirectoryWithSnapshot.replaceDir(this,latestSnapshot);
    return dir.replaceChild(newChild,latestSnapshot);
  }
  final int low=searchChildrenForExistingINode(newChild);
  final INode oldChild=children.set(low,newChild);
  for (  INode i : newChild.getChildrenList(null)) {
    i.parent=newChild;
  }
  return oldChild;
}
