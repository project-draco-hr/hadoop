{
  QuotaCounts counts=new QuotaCounts.Builder().build();
  int s=snapshot != Snapshot.CURRENT_STATE_ID && prior != Snapshot.NO_SNAPSHOT_ID ? prior : snapshot;
  for (  INode child : getChildrenList(s)) {
    if (snapshot != Snapshot.CURRENT_STATE_ID && excludedNodes != null && excludedNodes.containsKey(child)) {
      continue;
    }
 else {
      QuotaCounts childCounts=child.cleanSubtree(bsps,snapshot,prior,collectedBlocks,removedINodes);
      counts.add(childCounts);
    }
  }
  return counts;
}
