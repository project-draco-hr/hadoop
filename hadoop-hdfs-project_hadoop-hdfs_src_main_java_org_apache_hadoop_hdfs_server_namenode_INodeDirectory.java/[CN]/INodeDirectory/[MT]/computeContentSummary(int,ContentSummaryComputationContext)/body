{
  final DirectoryWithSnapshotFeature sf=getDirectoryWithSnapshotFeature();
  if (sf != null && snapshotId == Snapshot.CURRENT_STATE_ID) {
    sf.computeContentSummary4Snapshot(summary.getBlockStoragePolicySuite(),summary.getCounts());
    sf.computeContentSummary4Snapshot(summary.getBlockStoragePolicySuite(),summary.getSnapshotCounts());
  }
  final DirectoryWithQuotaFeature q=getDirectoryWithQuotaFeature();
  if (q != null && snapshotId == Snapshot.CURRENT_STATE_ID) {
    return q.computeContentSummary(this,summary);
  }
 else {
    return computeDirectoryContentSummary(summary,snapshotId);
  }
}
