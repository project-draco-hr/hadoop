{
  if (finished || flushOnPeriod) {
    registry.snapshot(collector.addRecord(registry.info()),all);
  }
  if (!finished && flushOnPeriod) {
    flushOnPeriod=false;
    scheduleTimerTaskIfRequired();
  }
}
