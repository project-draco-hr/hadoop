{
  StartupProgress prog=NameNode.getStartupProgress();
  Step step=new Step(StepType.CACHE_ENTRIES);
  prog.beginStep(Phase.LOADING_FSIMAGE,step);
  int numDirectives=in.readInt();
  prog.setTotal(Phase.LOADING_FSIMAGE,step,numDirectives);
  Counter counter=prog.getCounter(Phase.LOADING_FSIMAGE,step);
  for (int i=0; i < numDirectives; i++) {
    CacheDirectiveInfo info=FSImageSerialization.readCacheDirectiveInfo(in);
    final String poolName=info.getPool();
    CacheDirective directive=new CacheDirective(info.getId(),info.getPath().toUri().getPath(),info.getReplication(),info.getExpiration().getAbsoluteMillis());
    addCacheDirective(poolName,directive);
    counter.increment();
  }
  prog.endStep(Phase.LOADING_FSIMAGE,step);
}
