{
  try {
    directive.validate();
  }
 catch (  IOException ioe) {
    return new Fallible<PathCacheEntry>(ioe);
  }
  PathCacheEntry existing=entriesByDirective.get(directive);
  if (existing != null) {
    return new Fallible<PathCacheEntry>(existing);
  }
  PathCacheEntry entry;
  try {
    entry=new PathCacheEntry(getNextEntryId(),directive);
  }
 catch (  IOException ioe) {
    return new Fallible<PathCacheEntry>(new UnexpectedAddPathCacheDirectiveException(directive));
  }
  entriesByDirective.put(directive,entry);
  entriesById.put(entry.getEntryId(),entry);
  return new Fallible<PathCacheEntry>(entry);
}
