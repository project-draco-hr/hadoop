{
  CachedBlocksList cached=datanode.getCached();
  cached.clear();
  CachedBlocksList cachedList=datanode.getCached();
  CachedBlocksList pendingCachedList=datanode.getPendingCached();
  for (Iterator<Long> iter=blockIds.iterator(); iter.hasNext(); ) {
    long blockId=iter.next();
    LOG.trace("Cache report from datanode {} has block {}",datanode,blockId);
    CachedBlock cachedBlock=new CachedBlock(blockId,(short)0,false);
    CachedBlock prevCachedBlock=cachedBlocks.get(cachedBlock);
    if (prevCachedBlock != null) {
      cachedBlock=prevCachedBlock;
    }
 else {
      cachedBlocks.put(cachedBlock);
      LOG.trace("Added block {}  to cachedBlocks",cachedBlock);
    }
    if (!cachedBlock.isPresent(cachedList)) {
      cachedList.add(cachedBlock);
      LOG.trace("Added block {} to CACHED list.",cachedBlock);
    }
    if (cachedBlock.isPresent(pendingCachedList)) {
      pendingCachedList.remove(cachedBlock);
      LOG.trace("Removed block {} from PENDING_CACHED list.",cachedBlock);
    }
  }
}
