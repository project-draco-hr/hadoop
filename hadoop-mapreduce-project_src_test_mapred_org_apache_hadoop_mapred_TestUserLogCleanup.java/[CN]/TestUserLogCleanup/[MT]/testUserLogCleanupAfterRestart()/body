{
  File jobUserlog1=localizeJob(jobid1);
  File jobUserlog2=localizeJob(jobid2);
  File jobUserlog3=localizeJob(jobid3);
  File jobUserlog4=localizeJob(jobid4);
  foo.mkdirs();
  bar.createNewFile();
  jobFinished(jobid1,2);
  myClock.advance(ONE_HOUR);
  Configuration conf=new Configuration();
  conf.setInt(MRJobConfig.USER_LOG_RETAIN_HOURS,3);
  taskLogCleanupThread=new UserLogCleaner(conf);
  myClock=new FakeClock();
  taskLogCleanupThread.setClock(myClock);
  taskLogCleanupThread.clearOldUserLogs(conf);
  tt.setTaskLogCleanupThread(taskLogCleanupThread);
  assertFalse(foo.exists());
  assertFalse(bar.exists());
  assertTrue(jobUserlog1.exists());
  assertTrue(jobUserlog2.exists());
  assertTrue(jobUserlog3.exists());
  assertTrue(jobUserlog4.exists());
  assertTrue(new File(TaskLog.getUserLogDir(),MRAsyncDiskService.TOBEDELETED).exists());
  myClock.advance(ONE_HOUR);
  taskLogCleanupThread.processCompletedJobs();
  assertTrue(jobUserlog1.exists());
  assertTrue(jobUserlog2.exists());
  assertTrue(jobUserlog3.exists());
  assertTrue(jobUserlog4.exists());
  jobUserlog3=localizeJob(jobid3);
  jobFinished(jobid3,3);
  jobUserlog4=localizeJob(jobid4);
  myClock.advance(2 * ONE_HOUR);
  taskLogCleanupThread.processCompletedJobs();
  assertFalse(jobUserlog1.exists());
  assertFalse(jobUserlog2.exists());
  assertTrue(jobUserlog3.exists());
  assertTrue(jobUserlog4.exists());
  myClock.advance(ONE_HOUR);
  taskLogCleanupThread.processCompletedJobs();
  assertFalse(jobUserlog1.exists());
  assertFalse(jobUserlog2.exists());
  assertFalse(jobUserlog3.exists());
  assertTrue(jobUserlog4.exists());
}
