{
  app.dispatcher.getEventHandler().handle(new LogHandlerAppFinishedEvent(app.appId));
  app.context.getNMTokenSecretManager().appFinished(app.getAppId());
  Map<ApplicationId,String> registeredCollectors=app.context.getRegisteredCollectors();
  if (registeredCollectors != null) {
    registeredCollectors.remove(app.getAppId());
  }
  TimelineClient timelineClient=app.getTimelineClient();
  if (timelineClient != null) {
    timelineClient.stop();
  }
}
