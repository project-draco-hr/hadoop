{
  getEditLog().open();
  StorageDirectory sdName=null;
  StorageDirectory sdEdits=null;
  Iterator<StorageDirectory> it=null;
  if (loadImage) {
    it=getStorage().dirIterator(NameNodeDirType.IMAGE);
    if (it.hasNext())     sdName=it.next();
    if (sdName == null) {
      throw new IOException("Could not locate checkpoint fsimage");
    }
  }
  it=getStorage().dirIterator(NameNodeDirType.EDITS);
  if (it.hasNext())   sdEdits=it.next();
  if (sdEdits == null)   throw new IOException("Could not locate checkpoint edits");
  if (loadImage) {
    this.getStorage().layoutVersion=-1;
    getStorage();
    loadFSImage(NNStorage.getStorageFile(sdName,NameNodeFile.IMAGE));
  }
  loadFSEdits(sdEdits);
  storage.setClusterID(sig.getClusterID());
  storage.setBlockPoolID(sig.getBlockpoolID());
  sig.validateStorageInfo(this);
  saveNamespace(false);
}
