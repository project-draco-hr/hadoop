{
  long period=Math.min(checkpointCheckPeriod,checkpointPeriod);
  while (shouldRun) {
    try {
      Thread.sleep(1000 * period);
    }
 catch (    InterruptedException ie) {
    }
    if (!shouldRun) {
      break;
    }
    try {
      if (UserGroupInformation.isSecurityEnabled())       UserGroupInformation.getCurrentUser().reloginFromKeytab();
      long now=System.currentTimeMillis();
      if (shouldCheckpointBasedOnCount() || now >= lastCheckpointTime + 1000 * checkpointPeriod) {
        doCheckpoint();
        lastCheckpointTime=now;
      }
    }
 catch (    IOException e) {
      LOG.error("Exception in doCheckpoint",e);
      e.printStackTrace();
    }
catch (    Throwable e) {
      LOG.error("Throwable Exception in doCheckpoint",e);
      e.printStackTrace();
      Runtime.getRuntime().exit(-1);
    }
  }
}
