{
  try {
    conf.setBooleanIfUnset("mapred.mapper.new-api",false);
    conf.setBooleanIfUnset("mapred.reducer.new-api",false);
    if (getDelegationTokenCalled) {
      conf.setBoolean(HS_DELEGATION_TOKEN_REQUIRED,getDelegationTokenCalled);
      getDelegationTokenCalled=false;
    }
    Job job=clientUgi.doAs(new PrivilegedExceptionAction<Job>(){
      @Override public Job run() throws IOException, ClassNotFoundException, InterruptedException {
        Job job=Job.getInstance(conf);
        job.submit();
        return job;
      }
    }
);
    cluster=job.getCluster();
    return new NetworkedJob(job);
  }
 catch (  InterruptedException ie) {
    throw new IOException("interrupted",ie);
  }
}
