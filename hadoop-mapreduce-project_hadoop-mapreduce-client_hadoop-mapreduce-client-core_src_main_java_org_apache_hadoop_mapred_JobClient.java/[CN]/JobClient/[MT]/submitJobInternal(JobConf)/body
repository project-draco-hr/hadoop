{
  try {
    conf.setBooleanIfUnset("mapred.mapper.new-api",false);
    conf.setBooleanIfUnset("mapred.reducer.new-api",false);
    Job job=clientUgi.doAs(new PrivilegedExceptionAction<Job>(){
      @Override public Job run() throws IOException, ClassNotFoundException, InterruptedException {
        Job job=Job.getInstance(conf);
        job.submit();
        return job;
      }
    }
);
    Cluster prev=cluster;
    cluster=job.getCluster();
    if (prev != null) {
      prev.close();
    }
    return new NetworkedJob(job);
  }
 catch (  InterruptedException ie) {
    throw new IOException("interrupted",ie);
  }
}
