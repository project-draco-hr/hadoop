{
  if (conf.getDomainSocketPath().isEmpty())   return PathInfo.NOT_CONFIGURED;
  if (!conf.isDomainSocketDataTraffic() && (!conf.isShortCircuitLocalReads() || conf.isUseLegacyBlockReaderLocal())) {
    return PathInfo.NOT_CONFIGURED;
  }
  if (DomainSocket.getLoadingFailureReason() != null) {
    return PathInfo.NOT_CONFIGURED;
  }
  if (!DFSUtilClient.isLocalAddress(addr))   return PathInfo.NOT_CONFIGURED;
  String escapedPath=DomainSocket.getEffectivePath(conf.getDomainSocketPath(),addr.getPort());
  PathState status=pathMap.getIfPresent(escapedPath);
  if (status == null) {
    return new PathInfo(escapedPath,PathState.VALID);
  }
 else {
    return new PathInfo(escapedPath,status);
  }
}
