{
  Configuration conf=createJobConf();
  Job job=MapReduceTestUtil.createJob(conf,inDir,outDir,0,0,input);
  job.setJobName("chain");
  Throwable th=null;
  try {
    ChainMapper.addMapper(job,Mapper.class,LongWritable.class,Text.class,IntWritable.class,Text.class,null);
    ChainMapper.addMapper(job,Mapper.class,LongWritable.class,Text.class,LongWritable.class,Text.class,null);
  }
 catch (  IllegalArgumentException iae) {
    th=iae;
  }
  assertTrue(th != null);
  th=null;
  try {
    ChainReducer.setReducer(job,Reducer.class,LongWritable.class,Text.class,IntWritable.class,Text.class,null);
    ChainMapper.addMapper(job,Mapper.class,LongWritable.class,Text.class,LongWritable.class,Text.class,null);
  }
 catch (  IllegalArgumentException iae) {
    th=iae;
  }
  assertTrue(th != null);
}
