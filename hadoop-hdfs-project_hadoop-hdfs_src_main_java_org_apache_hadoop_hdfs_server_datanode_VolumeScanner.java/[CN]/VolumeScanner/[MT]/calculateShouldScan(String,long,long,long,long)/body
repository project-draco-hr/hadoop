{
  long runMinutes=curMinute - startMinute;
  long effectiveBytesPerSec;
  if (runMinutes <= 0) {
    effectiveBytesPerSec=scannedBytesSum;
  }
 else {
    if (runMinutes > MINUTES_PER_HOUR) {
      runMinutes=MINUTES_PER_HOUR;
    }
    effectiveBytesPerSec=scannedBytesSum / (SECONDS_PER_MINUTE * runMinutes);
  }
  boolean shouldScan=effectiveBytesPerSec <= targetBytesPerSec;
  LOG.trace("{}: calculateShouldScan: effectiveBytesPerSec = {}, and " + "targetBytesPerSec = {}.  startMinute = {}, curMinute = {}, " + "shouldScan = {}",storageId,effectiveBytesPerSec,targetBytesPerSec,startMinute,curMinute,shouldScan);
  return shouldScan;
}
