{
  Enum<?> pRole=process.getRole();
  if (Role.NN.equals(pRole)) {
    return createNNClient(process);
  }
 else   if (Role.DN.equals(pRole)) {
    return createDNClient(process);
  }
 else   throw new IOException("Role " + pRole + " is not supported by HDFSCluster");
}
