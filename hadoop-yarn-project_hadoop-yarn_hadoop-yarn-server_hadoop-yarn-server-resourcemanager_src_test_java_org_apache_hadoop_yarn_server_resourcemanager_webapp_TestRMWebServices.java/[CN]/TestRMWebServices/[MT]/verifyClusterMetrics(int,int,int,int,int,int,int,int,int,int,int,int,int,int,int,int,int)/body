{
  ResourceScheduler rs=rm.getResourceScheduler();
  QueueMetrics metrics=rs.getRootQueueMetrics();
  ClusterMetrics clusterMetrics=ClusterMetrics.getMetrics();
  long totalMBExpect=metrics.getAvailableMB() + metrics.getAllocatedMB();
  long totalVirtualCoresExpect=metrics.getAvailableVirtualCores() + metrics.getAllocatedVirtualCores();
  assertEquals("appsSubmitted doesn't match",metrics.getAppsSubmitted(),submittedApps);
  assertEquals("appsCompleted doesn't match",metrics.getAppsCompleted(),completedApps);
  assertEquals("reservedMB doesn't match",metrics.getReservedMB(),reservedMB);
  assertEquals("availableMB doesn't match",metrics.getAvailableMB(),availableMB);
  assertEquals("allocatedMB doesn't match",metrics.getAllocatedMB(),allocMB);
  assertEquals("reservedVirtualCores doesn't match",metrics.getReservedVirtualCores(),reservedVirtualCores);
  assertEquals("availableVirtualCores doesn't match",metrics.getAvailableVirtualCores(),availableVirtualCores);
  assertEquals("allocatedVirtualCores doesn't match",totalVirtualCoresExpect,allocVirtualCores);
  assertEquals("containersAllocated doesn't match",0,containersAlloc);
  assertEquals("totalMB doesn't match",totalMBExpect,totalMB);
  assertEquals("totalNodes doesn't match",clusterMetrics.getNumActiveNMs() + clusterMetrics.getNumLostNMs() + clusterMetrics.getNumDecommisionedNMs()+ clusterMetrics.getNumRebootedNMs()+ clusterMetrics.getUnhealthyNMs(),totalNodes);
  assertEquals("lostNodes doesn't match",clusterMetrics.getNumLostNMs(),lostNodes);
  assertEquals("unhealthyNodes doesn't match",clusterMetrics.getUnhealthyNMs(),unhealthyNodes);
  assertEquals("decommissionedNodes doesn't match",clusterMetrics.getNumDecommisionedNMs(),decommissionedNodes);
  assertEquals("rebootedNodes doesn't match",clusterMetrics.getNumRebootedNMs(),rebootedNodes);
  assertEquals("activeNodes doesn't match",clusterMetrics.getNumActiveNMs(),activeNodes);
}
