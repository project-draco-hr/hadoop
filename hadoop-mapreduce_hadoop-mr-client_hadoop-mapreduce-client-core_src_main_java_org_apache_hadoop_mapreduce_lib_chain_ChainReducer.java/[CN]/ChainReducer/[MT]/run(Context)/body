{
  setup(context);
  if (chain.getReducer() == null) {
    return;
  }
  int numMappers=chain.getAllMappers().size();
  if (numMappers == 0) {
    chain.runReducer(context);
    return;
  }
  ChainBlockingQueue<Chain.KeyValuePair<?,?>> inputqueue;
  ChainBlockingQueue<Chain.KeyValuePair<?,?>> outputqueue;
  outputqueue=chain.createBlockingQueue();
  chain.addReducer(context,outputqueue);
  for (int i=0; i < numMappers - 1; i++) {
    inputqueue=outputqueue;
    outputqueue=chain.createBlockingQueue();
    chain.addMapper(inputqueue,outputqueue,context,i);
  }
  chain.addMapper(outputqueue,context,numMappers - 1);
  chain.startAllThreads();
  chain.joinAllThreads();
}
