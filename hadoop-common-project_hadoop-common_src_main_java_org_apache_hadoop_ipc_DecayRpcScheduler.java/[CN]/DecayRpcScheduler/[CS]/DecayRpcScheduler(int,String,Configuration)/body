{
  if (numQueues < 1) {
    throw new IllegalArgumentException("number of queues must be > 0");
  }
  this.numQueues=numQueues;
  this.decayFactor=parseDecayFactor(ns,conf);
  this.decayPeriodMillis=parseDecayPeriodMillis(ns,conf);
  this.identityProvider=this.parseIdentityProvider(ns,conf);
  this.thresholds=parseThresholds(ns,conf,numQueues);
  Timer timer=new Timer();
  DecayTask task=new DecayTask(this,timer);
  timer.scheduleAtFixedRate(task,0,this.decayPeriodMillis);
  MetricsProxy prox=MetricsProxy.getInstance(ns);
  prox.setDelegate(this);
}
