{
  String[] names={"one","two"};
  String[] hosts={"three","four"};
  String[] topologyPaths={"five","six"};
  long offset=25l;
  long length=55l;
  BlockLocation bl=new BlockLocation(names,hosts,topologyPaths,offset,length);
  DataOutputBuffer dob=new DataOutputBuffer();
  try {
    bl.write(dob);
  }
 catch (  IOException e) {
    fail("Unable to serialize data: " + e.getMessage());
  }
  byte[] bytes=dob.getData();
  DataInput da=new DataInputStream(new ByteArrayInputStream(bytes));
  BlockLocation bl2=new BlockLocation();
  try {
    bl2.readFields(da);
  }
 catch (  IOException e) {
    fail("Unable to deserialize BlockLocation: " + e.getMessage());
  }
  verifyDeserialization(bl2.getHosts(),hosts);
  verifyDeserialization(bl2.getNames(),names);
  verifyDeserialization(bl2.getTopologyPaths(),topologyPaths);
  assertEquals(bl2.getOffset(),offset);
  assertEquals(bl2.getLength(),length);
}
