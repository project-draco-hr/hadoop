{
  Configuration conf=new Configuration();
  conf.set("yarn.resourcemanager.nodes.exclude-path",hostFile.getAbsolutePath());
  MockRM rm=new MockRM(conf);
  rm.start();
  MockNM nm1=rm.registerNode("host1:1234",5120);
  Assert.assertEquals(0,ClusterMetrics.getMetrics().getUnhealthyNMs());
  nm1.nodeHeartbeat(true);
  nm1.nodeHeartbeat(false);
  checkUnealthyNMCount(rm,nm1,true,1);
  nm1.nodeHeartbeat(true);
  checkUnealthyNMCount(rm,nm1,false,0);
}
