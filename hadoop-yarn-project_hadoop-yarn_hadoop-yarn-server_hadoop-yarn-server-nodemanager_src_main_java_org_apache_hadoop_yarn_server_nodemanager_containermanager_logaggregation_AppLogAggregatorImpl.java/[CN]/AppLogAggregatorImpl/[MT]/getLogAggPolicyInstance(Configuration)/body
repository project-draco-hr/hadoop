{
  Class<? extends ContainerLogAggregationPolicy> policyClass=null;
  if (this.logAggregationContext != null) {
    String className=this.logAggregationContext.getLogAggregationPolicyClassName();
    if (className != null) {
      try {
        Class<?> policyFromContext=conf.getClassByName(className);
        if (ContainerLogAggregationPolicy.class.isAssignableFrom(policyFromContext)) {
          policyClass=policyFromContext.asSubclass(ContainerLogAggregationPolicy.class);
        }
 else {
          LOG.warn(this.appId + " specified invalid log aggregation policy " + className);
        }
      }
 catch (      ClassNotFoundException cnfe) {
        LOG.warn(this.appId + " specified invalid log aggregation policy " + className);
      }
    }
  }
  if (policyClass == null) {
    policyClass=conf.getClass(YarnConfiguration.NM_LOG_AGG_POLICY_CLASS,AllContainerLogAggregationPolicy.class,ContainerLogAggregationPolicy.class);
  }
 else {
    LOG.info(this.appId + " specifies ContainerLogAggregationPolicy of " + policyClass);
  }
  return ReflectionUtils.newInstance(policyClass,conf);
}
