{
  if (this.logAggregationDisabled) {
    return;
  }
  if (this.writer == null) {
    LOG.info("Starting aggregate log-file for app " + this.applicationId + " at "+ this.remoteNodeTmpLogFileForApp);
    try {
      this.writer=new LogWriter(this.conf,this.remoteNodeTmpLogFileForApp,this.userUgi);
      this.writer.writeApplicationACLs(appAcls);
      this.writer.writeApplicationOwner(this.userUgi.getShortUserName());
    }
 catch (    IOException e) {
      LOG.error("Cannot create writer for app " + this.applicationId + ". Disabling log-aggregation for this app.",e);
      this.logAggregationDisabled=true;
      return;
    }
  }
  LOG.info("Uploading logs for container " + containerId + ". Current good log dirs are "+ StringUtils.join(",",dirsHandler.getLogDirs()));
  LogKey logKey=new LogKey(containerId);
  LogValue logValue=new LogValue(dirsHandler.getLogDirs(),containerId,userUgi.getShortUserName());
  try {
    this.writer.append(logKey,logValue);
  }
 catch (  IOException e) {
    LOG.error("Couldn't upload logs for " + containerId + ". Skipping this container.");
  }
}
