{
  SerializationFactory factory=new SerializationFactory(conf);
  Map<String,String> metadata=SerializationBase.getMetadataFromClass(c);
  this.serializer=factory.getSerializer(metadata);
  this.deserializer=factory.getDeserializer(metadata);
  this.inBuf=new DataInputBuffer();
  this.outBuf=new DataOutputBuffer();
  try {
    serializer.open(outBuf);
    deserializer.open(inBuf);
  }
 catch (  IOException ex) {
    throw new RuntimeException(ex);
  }
}
