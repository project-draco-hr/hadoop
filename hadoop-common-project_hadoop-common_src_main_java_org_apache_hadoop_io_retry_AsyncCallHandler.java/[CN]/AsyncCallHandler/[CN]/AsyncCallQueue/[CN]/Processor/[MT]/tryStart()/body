{
  final Thread current=Thread.currentThread();
  if (running.compareAndSet(null,current)) {
    final Daemon daemon=new Daemon(){
      @Override public void run(){
        for (; isRunning(this); ) {
          final long waitTime=checkCalls();
          tryStop(this);
          try {
synchronized (AsyncCallHandler.this) {
              AsyncCallHandler.this.wait(waitTime);
            }
          }
 catch (          InterruptedException e) {
            kill(this);
          }
        }
      }
    }
;
    final boolean set=running.compareAndSet(current,daemon);
    Preconditions.checkState(set);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Starting AsyncCallQueue.Processor " + daemon);
    }
    daemon.start();
  }
}
