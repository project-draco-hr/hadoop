{
  return unprivilegedUser.doAs(new PrivilegedExceptionAction<Long>(){
    @Override public Long run() throws IOException {
      DistributedFileSystem myDfs=(DistributedFileSystem)FileSystem.get(conf);
      return myDfs.addPathBasedCacheDirective(directive);
    }
  }
);
}
