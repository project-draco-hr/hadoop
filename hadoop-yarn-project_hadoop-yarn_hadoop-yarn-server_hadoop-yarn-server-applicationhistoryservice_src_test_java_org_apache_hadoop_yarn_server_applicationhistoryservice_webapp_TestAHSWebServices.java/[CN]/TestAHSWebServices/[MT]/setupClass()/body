{
  conf=new YarnConfiguration();
  TimelineStore store=TestApplicationHistoryManagerOnTimelineStore.createStore(MAX_APPS);
  TimelineACLsManager aclsManager=new TimelineACLsManager(conf);
  aclsManager.setTimelineStore(store);
  TimelineDataManager dataManager=new TimelineDataManager(store,aclsManager);
  conf.setBoolean(YarnConfiguration.YARN_ACL_ENABLE,true);
  conf.set(YarnConfiguration.YARN_ADMIN_ACL,"foo");
  conf.setBoolean(YarnConfiguration.LOG_AGGREGATION_ENABLED,true);
  conf.set(YarnConfiguration.NM_REMOTE_APP_LOG_DIR,remoteLogRootDir);
  dataManager.init(conf);
  ApplicationACLsManager appAclsManager=new ApplicationACLsManager(conf);
  ApplicationHistoryManagerOnTimelineStore historyManager=new ApplicationHistoryManagerOnTimelineStore(dataManager,appAclsManager);
  historyManager.init(conf);
  historyClientService=new ApplicationHistoryClientService(historyManager){
    @Override protected void serviceStart() throws Exception {
    }
  }
;
  historyClientService.init(conf);
  historyClientService.start();
  ahsWebservice=new AHSWebServices(historyClientService,conf);
  fs=FileSystem.get(conf);
}
