{
  Configuration conf=new Configuration();
  conf.set("ns." + DecayRpcScheduler.IPC_CALLQUEUE_DECAYSCHEDULER_PERIOD_KEY,"99999999");
  conf.set("ns." + DecayRpcScheduler.IPC_CALLQUEUE_DECAYSCHEDULER_THRESHOLDS_KEY,"25, 50, 75");
  scheduler=new DecayRpcScheduler(4,"ns",conf);
  assertEquals(0,scheduler.getPriorityLevel(mockCall("A")));
  assertEquals(2,scheduler.getPriorityLevel(mockCall("A")));
  assertEquals(0,scheduler.getPriorityLevel(mockCall("B")));
  assertEquals(1,scheduler.getPriorityLevel(mockCall("B")));
  assertEquals(0,scheduler.getPriorityLevel(mockCall("C")));
  assertEquals(0,scheduler.getPriorityLevel(mockCall("C")));
  assertEquals(1,scheduler.getPriorityLevel(mockCall("A")));
  assertEquals(1,scheduler.getPriorityLevel(mockCall("A")));
  assertEquals(1,scheduler.getPriorityLevel(mockCall("A")));
  assertEquals(2,scheduler.getPriorityLevel(mockCall("A")));
}
