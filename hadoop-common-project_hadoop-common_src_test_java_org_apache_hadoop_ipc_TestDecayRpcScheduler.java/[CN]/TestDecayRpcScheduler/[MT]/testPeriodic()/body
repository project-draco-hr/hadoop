{
  Configuration conf=new Configuration();
  conf.set("ns." + DecayRpcScheduler.IPC_CALLQUEUE_DECAYSCHEDULER_PERIOD_KEY,"10");
  conf.set("ns." + DecayRpcScheduler.IPC_CALLQUEUE_DECAYSCHEDULER_FACTOR_KEY,"0.5");
  scheduler=new DecayRpcScheduler(1,"ns",conf);
  assertEquals(10,scheduler.getDecayPeriodMillis());
  assertEquals(0,scheduler.getTotalCallSnapshot());
  for (int i=0; i < 64; i++) {
    scheduler.getPriorityLevel(mockCall("A"));
  }
  while (scheduler.getTotalCallSnapshot() > 0) {
    Thread.sleep(10);
  }
}
