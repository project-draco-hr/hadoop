{
  int prevJobsNum=0;
  JTProtocol wovenClient=cluster.getJTClient().getProxy();
  JobStatus[] jobStatus=null;
  JobID id=null;
  RunningJob rJob=null;
  JobInfo jInfo=null;
  jobStatus=client.getAllJobs();
  prevJobsNum=jobStatus.length;
  Assert.assertEquals(ToolRunner.run(job,tool,args),0);
  jobStatus=client.getAllJobs();
  while (jobStatus.length - prevJobsNum == 0) {
    LOG.info("Waiting for the job to appear in the jobStatus");
    Thread.sleep(1000);
    jobStatus=client.getAllJobs();
  }
  id=jobStatus[0].getJobID();
  rJob=client.getJob(id);
  jInfo=wovenClient.getJobInfo(id);
  while (jInfo != null && !jInfo.getStatus().isJobComplete()) {
    Thread.sleep(10000);
    jInfo=wovenClient.getJobInfo(id);
  }
  cluster.getJTClient().verifyCompletedJob(id);
}
