{
  banner("Starting with NN0 active and NN1 standby, creating some blocks");
  DFSTestUtil.createFile(fs,new Path("/test"),3 * BLOCK_SIZE,(short)3,1L);
  nn0.getRpcServer().rollEditLog();
  banner("Creating some blocks that won't be in the edit log");
  DFSTestUtil.createFile(fs,new Path("/test2"),5 * BLOCK_SIZE,(short)3,1L);
  banner("Deleting the original blocks");
  fs.delete(new Path("/test"),true);
  banner("Restarting standby");
  restartStandby();
  FSNamesystem namesystem=nn1.getNamesystem();
  String status=namesystem.getSafemode();
  assertTrue("Bad safemode status: '" + status + "'",status.startsWith("Safe mode is ON."));
  NameNodeAdapter.enterSafeMode(nn1,false);
  assertTrue("Failed to enter into safemode in standby",namesystem.isInSafeMode());
  NameNodeAdapter.enterSafeMode(nn1,false);
  assertTrue("Failed to enter into safemode in standby",namesystem.isInSafeMode());
}
