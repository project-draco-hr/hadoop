{
  MyMRApp app=new MyMRApp(1,0,true,this.getClass().getName(),true);
  Configuration conf=new Configuration();
  conf.setBoolean(MRConfig.MAPREDUCE_APP_SUBMISSION_CROSS_PLATFORM,true);
  Job job=app.submit(conf);
  app.waitForState(job,JobState.SUCCEEDED);
  app.verifyCompleted();
  for (  String content : expectedContents) {
    Assert.assertTrue("Missing argument",app.launchCmdList.get(0).contains(content));
  }
  Assert.assertTrue("Missing argument",app.launchCmdList.get(0).contains("-Dlog4j.configuration=container-log4j.properties"));
  Assert.assertTrue("HADOOP_ROOT_LOGGER not set for job",app.cmdEnvironment.containsKey("HADOOP_ROOT_LOGGER"));
  Assert.assertEquals("INFO,console",app.cmdEnvironment.get("HADOOP_ROOT_LOGGER"));
  Assert.assertTrue("HADOOP_CLIENT_OPTS not set for job",app.cmdEnvironment.containsKey("HADOOP_CLIENT_OPTS"));
  Assert.assertEquals("",app.cmdEnvironment.get("HADOOP_CLIENT_OPTS"));
}
