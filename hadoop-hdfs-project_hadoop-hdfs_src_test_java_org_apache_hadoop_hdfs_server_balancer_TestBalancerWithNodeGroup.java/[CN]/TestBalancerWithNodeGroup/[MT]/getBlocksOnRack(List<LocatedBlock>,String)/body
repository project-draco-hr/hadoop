{
  Set<ExtendedBlock> ret=new HashSet<ExtendedBlock>();
  for (  LocatedBlock blk : blks) {
    for (    DatanodeInfo di : blk.getLocations()) {
      if (rack.equals(NetworkTopology.getFirstHalf(di.getNetworkLocation()))) {
        ret.add(blk.getBlock());
        break;
      }
    }
  }
  return ret;
}
