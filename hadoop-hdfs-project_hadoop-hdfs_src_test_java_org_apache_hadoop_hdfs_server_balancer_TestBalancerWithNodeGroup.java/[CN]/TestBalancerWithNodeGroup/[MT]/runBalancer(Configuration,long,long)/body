{
  waitForHeartBeat(totalUsedSpace,totalCapacity);
  Collection<URI> namenodes=DFSUtil.getNsServiceRpcUris(conf);
  final int r=Balancer.run(namenodes,Balancer.Parameters.DEFAULT,conf);
  assertEquals(Balancer.ReturnStatus.SUCCESS.code,r);
  waitForHeartBeat(totalUsedSpace,totalCapacity);
  LOG.info("Rebalancing with default factor.");
  waitForBalancer(totalUsedSpace,totalCapacity);
}
