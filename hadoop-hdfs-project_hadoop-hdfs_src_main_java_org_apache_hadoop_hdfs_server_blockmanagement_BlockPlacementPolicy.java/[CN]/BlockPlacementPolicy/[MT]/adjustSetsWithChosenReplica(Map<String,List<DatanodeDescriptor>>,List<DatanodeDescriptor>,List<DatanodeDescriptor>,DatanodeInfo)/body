{
  String rack=getRack(cur);
  final List<DatanodeDescriptor> datanodes=rackMap.get(rack);
  datanodes.remove(cur);
  if (datanodes.isEmpty()) {
    rackMap.remove(rack);
  }
  if (moreThanOne.remove(cur)) {
    if (datanodes.size() == 1) {
      moreThanOne.remove(datanodes.get(0));
      exactlyOne.add(datanodes.get(0));
    }
  }
 else {
    exactlyOne.remove(cur);
  }
}
