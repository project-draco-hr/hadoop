{
  for (  DatanodeStorageInfo s : storages) {
    final String rackName=getRack(s.getDatanodeDescriptor());
    List<DatanodeStorageInfo> storageList=rackMap.get(rackName);
    if (storageList == null) {
      storageList=new ArrayList<DatanodeStorageInfo>();
      rackMap.put(rackName,storageList);
    }
    storageList.add(s);
  }
  for (  List<DatanodeStorageInfo> storageList : rackMap.values()) {
    if (storageList.size() == 1) {
      exactlyOne.add(storageList.get(0));
    }
 else {
      moreThanOne.addAll(storageList);
    }
  }
}
