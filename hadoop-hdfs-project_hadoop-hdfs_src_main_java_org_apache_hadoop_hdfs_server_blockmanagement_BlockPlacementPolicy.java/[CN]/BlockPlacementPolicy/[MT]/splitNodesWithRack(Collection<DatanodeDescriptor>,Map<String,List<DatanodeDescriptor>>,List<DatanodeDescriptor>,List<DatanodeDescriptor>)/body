{
  for (  DatanodeDescriptor node : dataNodes) {
    final String rackName=getRack(node);
    List<DatanodeDescriptor> datanodeList=rackMap.get(rackName);
    if (datanodeList == null) {
      datanodeList=new ArrayList<DatanodeDescriptor>();
      rackMap.put(rackName,datanodeList);
    }
    datanodeList.add(node);
  }
  for (  List<DatanodeDescriptor> datanodeList : rackMap.values()) {
    if (datanodeList.size() == 1) {
      exactlyOne.add(datanodeList.get(0));
    }
 else {
      moreThanOne.addAll(datanodeList);
    }
  }
}
