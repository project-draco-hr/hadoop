{
  final Class<? extends BlockPlacementPolicy> replicatorClass=conf.getClass(DFSConfigKeys.DFS_BLOCK_REPLICATOR_CLASSNAME_KEY,DFSConfigKeys.DFS_BLOCK_REPLICATOR_CLASSNAME_DEFAULT,BlockPlacementPolicy.class);
  final BlockPlacementPolicy replicator=ReflectionUtils.newInstance(replicatorClass,conf);
  replicator.initialize(conf,stats,clusterMap);
  return replicator;
}
