{
  long remaining=0;
  for (  DatanodeStorageInfo s : getStorageInfos()) {
    if (s.getState() == State.NORMAL && (t == null || s.getStorageType() == t)) {
      long r=s.getRemaining();
      if (r >= minSize) {
        remaining+=r;
      }
    }
  }
  return remaining;
}
