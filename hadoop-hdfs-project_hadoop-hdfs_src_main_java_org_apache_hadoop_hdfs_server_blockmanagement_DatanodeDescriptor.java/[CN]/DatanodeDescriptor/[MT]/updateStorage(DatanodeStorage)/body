{
  DatanodeStorageInfo storage=getStorageInfo(s.getStorageID());
  if (storage == null) {
    storage=new DatanodeStorageInfo(this,s);
    storageMap.put(s.getStorageID(),storage);
  }
 else {
    storage.setState(s.getState());
  }
  return storage;
}
