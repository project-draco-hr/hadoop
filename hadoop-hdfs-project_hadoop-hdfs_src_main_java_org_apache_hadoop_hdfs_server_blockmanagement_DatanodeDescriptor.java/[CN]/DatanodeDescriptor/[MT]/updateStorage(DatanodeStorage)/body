{
synchronized (storageMap) {
    DatanodeStorageInfo storage=storageMap.get(s.getStorageID());
    if (storage == null) {
      LOG.info("Adding new storage ID " + s.getStorageID() + " for DN "+ getXferAddr());
      storage=new DatanodeStorageInfo(this,s);
      storageMap.put(s.getStorageID(),storage);
    }
 else {
      storage.setState(s.getState());
    }
    return storage;
  }
}
