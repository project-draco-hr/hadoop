{
  Snapshot latest=null;
  for (; inode != null; inode=inode.getParent()) {
    if (inode instanceof INodeDirectoryWithSnapshot) {
      final Snapshot s=((INodeDirectoryWithSnapshot)inode).getDiffs().getPrior(anchor);
      if (latest == null || (s != null && ID_COMPARATOR.compare(latest,s) < 0)) {
        latest=s;
      }
    }
  }
  return latest;
}
