{
  final DatanodeStorageReport[] reports=namesystem.getDatanodeStorageReport(type);
  if (reports == null) {
    throw new IOException("Failed to get datanode storage report for " + type + " datanodes.");
  }
  return reports;
}
