{
  checkNNStartup();
  String dnName=(nodeReg == null) ? "Unknown DataNode" : nodeReg.toString();
  if (errorCode == DatanodeProtocol.NOTIFY) {
    LOG.info("Error report from " + dnName + ": "+ msg);
    return;
  }
  verifyRequest(nodeReg);
  if (errorCode == DatanodeProtocol.DISK_ERROR) {
    LOG.warn("Disk error on " + dnName + ": "+ msg);
  }
 else   if (errorCode == DatanodeProtocol.FATAL_DISK_ERROR) {
    LOG.warn("Fatal disk error on " + dnName + ": "+ msg);
    namesystem.getBlockManager().getDatanodeManager().removeDatanode(nodeReg);
  }
 else {
    LOG.info("Error report from " + dnName + ": "+ msg);
  }
}
