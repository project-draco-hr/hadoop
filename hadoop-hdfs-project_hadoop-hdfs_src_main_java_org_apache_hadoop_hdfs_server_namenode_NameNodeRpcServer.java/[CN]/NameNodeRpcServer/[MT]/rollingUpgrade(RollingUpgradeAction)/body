{
  checkNNStartup();
  LOG.info("rollingUpgrade " + action);
switch (action) {
case QUERY:
    return namesystem.queryRollingUpgrade();
case PREPARE:
  return namesystem.startRollingUpgrade();
case FINALIZE:
namesystem.finalizeRollingUpgrade();
return null;
default :
throw new UnsupportedActionException(action + " is not yet supported.");
}
}
