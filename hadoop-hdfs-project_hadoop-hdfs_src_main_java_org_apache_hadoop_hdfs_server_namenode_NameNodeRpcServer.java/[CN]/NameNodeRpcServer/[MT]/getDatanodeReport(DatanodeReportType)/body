{
  DatanodeInfo results[]=namesystem.datanodeReport(type);
  if (results == null) {
    throw new IOException("Failed to get datanode report for " + type + " datanodes.");
  }
  return results;
}
