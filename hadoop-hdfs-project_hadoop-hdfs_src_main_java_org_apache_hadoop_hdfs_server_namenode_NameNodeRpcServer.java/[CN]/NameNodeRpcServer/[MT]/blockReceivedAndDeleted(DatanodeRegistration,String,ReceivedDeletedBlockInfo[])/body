{
  verifyRequest(nodeReg);
  if (nn.isStandbyState()) {
    if (receivedAndDeletedBlocks.length > 0) {
      long maxGs=receivedAndDeletedBlocks[0].getBlock().getGenerationStamp();
      for (      ReceivedDeletedBlockInfo binfo : receivedAndDeletedBlocks) {
        if (binfo.getBlock().getGenerationStamp() > maxGs) {
          maxGs=binfo.getBlock().getGenerationStamp();
        }
      }
      if (namesystem.isGenStampInFuture(maxGs)) {
        LOG.info("Required GS=" + maxGs + ", Queuing blockReceivedAndDeleted message");
        namesystem.getPendingDataNodeMessages().queueMessage(new PendingDataNodeMessages.BlockReceivedDeleteMessage(nodeReg,poolId,receivedAndDeletedBlocks,maxGs));
        return;
      }
    }
  }
  if (stateChangeLog.isDebugEnabled()) {
    stateChangeLog.debug("*BLOCK* NameNode.blockReceivedAndDeleted: " + "from " + nodeReg.getName() + " "+ receivedAndDeletedBlocks.length+ " blocks.");
  }
  namesystem.getBlockManager().processIncrementalBlockReport(nodeReg,poolId,receivedAndDeletedBlocks);
}
