{
  checkNNStartup();
  metrics.incrGetLinkTargetOps();
  HdfsFileStatus stat=null;
  try {
    stat=namesystem.getFileInfo(path,false);
  }
 catch (  UnresolvedPathException e) {
    return e.getResolvedPath().toString();
  }
catch (  UnresolvedLinkException e) {
    throw new AssertionError("UnresolvedLinkException thrown");
  }
  if (stat == null) {
    throw new FileNotFoundException("File does not exist: " + path);
  }
 else   if (!stat.isSymlink()) {
    throw new IOException("Path " + path + " is not a symbolic link");
  }
  return stat.getSymlink();
}
