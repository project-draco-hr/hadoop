{
  if (protocol.equals(ClientProtocol.class.getName())) {
    throw new IOException("Old Namenode Client protocol is not supported:" + protocol + "Switch your clientside to "+ ClientNamenodeProtocol.class);
  }
 else   if (protocol.equals(DatanodeProtocol.class.getName())) {
    return DatanodeProtocol.versionID;
  }
 else   if (protocol.equals(NamenodeProtocol.class.getName())) {
    return NamenodeProtocol.versionID;
  }
 else   if (protocol.equals(RefreshAuthorizationPolicyProtocol.class.getName())) {
    return RefreshAuthorizationPolicyProtocol.versionID;
  }
 else   if (protocol.equals(RefreshUserMappingsProtocol.class.getName())) {
    return RefreshUserMappingsProtocol.versionID;
  }
 else   if (protocol.equals(GetUserMappingsProtocol.class.getName())) {
    return GetUserMappingsProtocol.versionID;
  }
 else {
    throw new IOException("Unknown protocol to name node: " + protocol);
  }
}
