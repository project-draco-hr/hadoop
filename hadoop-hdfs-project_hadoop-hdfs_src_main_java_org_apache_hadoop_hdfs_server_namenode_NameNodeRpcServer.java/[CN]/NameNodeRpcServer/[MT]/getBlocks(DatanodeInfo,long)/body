{
  if (size <= 0) {
    throw new IllegalArgumentException("Unexpected not positive size: " + size);
  }
  namesystem.checkOperation(OperationCategory.READ);
  namesystem.checkSuperuserPrivilege();
  return namesystem.getBlockManager().getBlocks(datanode,size);
}
