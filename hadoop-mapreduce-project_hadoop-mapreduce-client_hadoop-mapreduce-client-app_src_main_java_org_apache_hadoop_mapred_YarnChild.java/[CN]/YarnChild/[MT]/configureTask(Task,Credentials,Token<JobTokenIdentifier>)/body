{
  final JobConf job=new JobConf(MRConstants.JOB_CONF_FILE);
  job.setCredentials(credentials);
  job.setBoolean("ipc.client.tcpnodelay",true);
  job.setClass(MRConfig.TASK_LOCAL_OUTPUT_CLASS,YarnOutputFiles.class,MapOutputFile.class);
  task.setJobTokenSecret(JobTokenSecretManager.createSecretKey(jt.getPassword()));
  configureLocalDirs(task,job);
  task.localizeConfiguration(job);
  setupDistributedCacheConfig(job);
  Path localTaskFile=new Path(Constants.JOBFILE);
  writeLocalJobFile(localTaskFile,job);
  task.setJobFile(localTaskFile.toString());
  task.setConf(job);
  return job;
}
