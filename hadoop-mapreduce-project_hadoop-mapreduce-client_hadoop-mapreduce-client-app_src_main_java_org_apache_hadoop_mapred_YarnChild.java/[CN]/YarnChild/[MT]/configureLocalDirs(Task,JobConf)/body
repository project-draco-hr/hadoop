{
  String[] localSysDirs=StringUtils.getTrimmedStrings(System.getenv(Environment.LOCAL_DIRS.name()));
  job.setStrings(MRConfig.LOCAL_DIR,localSysDirs);
  LOG.info(MRConfig.LOCAL_DIR + " for child: " + job.get(MRConfig.LOCAL_DIR));
  LocalDirAllocator lDirAlloc=new LocalDirAllocator(MRConfig.LOCAL_DIR);
  Path workDir=null;
  try {
    workDir=lDirAlloc.getLocalPathToRead("work",job);
  }
 catch (  DiskErrorException e) {
  }
  if (workDir == null) {
    workDir=lDirAlloc.getLocalPathForWrite("work",job);
    FileSystem lfs=FileSystem.getLocal(job).getRaw();
    boolean madeDir=false;
    try {
      madeDir=lfs.mkdirs(workDir);
    }
 catch (    FileAlreadyExistsException e) {
      madeDir=true;
      workDir=lDirAlloc.getLocalPathToRead("work",job);
    }
    if (!madeDir) {
      throw new IOException("Mkdirs failed to create " + workDir.toString());
    }
  }
  job.set(MRJobConfig.JOB_LOCAL_DIR,workDir.toString());
}
