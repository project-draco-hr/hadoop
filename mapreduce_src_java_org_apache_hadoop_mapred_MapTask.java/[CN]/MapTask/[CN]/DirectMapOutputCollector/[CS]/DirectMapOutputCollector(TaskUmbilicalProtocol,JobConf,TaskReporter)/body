{
  this.reporter=reporter;
  String finalName=getOutputName(getPartition());
  FileSystem fs=FileSystem.get(job);
  out=job.getOutputFormat().getRecordWriter(fs,job,finalName,reporter);
  mapOutputRecordCounter=reporter.getCounter(TaskCounter.MAP_OUTPUT_RECORDS);
}
