{
  this.umbilical=umbilical;
  if (isMapTask()) {
    if (conf.getNumReduceTasks() == 0) {
      mapPhase=getProgress().addPhase("map",1.0f);
    }
 else {
      mapPhase=getProgress().addPhase("map",0.667f);
      sortPhase=getProgress().addPhase("sort",0.333f);
    }
  }
  TaskReporter reporter=startReporter(umbilical);
  boolean useNewApi=job.getUseNewMapper();
  initialize(job,getJobID(),reporter,useNewApi);
  if (jobCleanup) {
    runJobCleanupTask(umbilical,reporter);
    return;
  }
  if (jobSetup) {
    runJobSetupTask(umbilical,reporter);
    return;
  }
  if (taskCleanup) {
    runTaskCleanupTask(umbilical,reporter);
    return;
  }
  if (useNewApi) {
    runNewMapper(job,splitMetaInfo,umbilical,reporter);
  }
 else {
    runOldMapper(job,splitMetaInfo,umbilical,reporter);
  }
  done(umbilical,reporter);
}
