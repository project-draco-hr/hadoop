{
  AzureBlobStorageTestAccount testAccount=AzureBlobStorageTestAccount.create();
  assumeNotNull(testAccount);
  try {
    NativeAzureFileSystem fs=testAccount.getFileSystem();
    injectTransientError(fs,new ConnectionRecognizer(){
      @Override public boolean isTargetConnection(      HttpURLConnection connection){
        return connection.getRequestMethod().equals("DELETE");
      }
    }
);
    Path testFile=new Path("/a/b");
    assertTrue(fs.createNewFile(testFile));
    assertTrue(fs.rename(testFile,new Path("/x")));
  }
  finally {
    testAccount.cleanup();
  }
}
