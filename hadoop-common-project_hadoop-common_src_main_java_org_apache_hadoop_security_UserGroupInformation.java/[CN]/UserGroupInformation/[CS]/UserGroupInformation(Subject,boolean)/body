{
  this.subject=subject;
  this.user=subject.getPrincipals(User.class).iterator().next();
  if (externalKeyTab) {
    this.isKeytab=false;
  }
 else {
    this.isKeytab=KerberosUtil.hasKerberosKeyTab(subject);
  }
  this.isKrbTkt=KerberosUtil.hasKerberosTicket(subject);
}
