{
  if (!isSecurityEnabled())   return;
  keytabFile=path;
  keytabPrincipal=user;
  Subject subject=new Subject();
  LoginContext login;
  long start=0;
  try {
    login=newLoginContext(HadoopConfiguration.KEYTAB_KERBEROS_CONFIG_NAME,subject,new HadoopConfiguration());
    start=Time.now();
    login.login();
    metrics.loginSuccess.add(Time.now() - start);
    loginUser=new UserGroupInformation(subject);
    loginUser.setLogin(login);
    loginUser.setAuthenticationMethod(AuthenticationMethod.KERBEROS);
  }
 catch (  LoginException le) {
    if (start > 0) {
      metrics.loginFailure.add(Time.now() - start);
    }
    throw new IOException("Login failure for " + user + " from keytab "+ path+ ": "+ le,le);
  }
  LOG.info("Login successful for user " + keytabPrincipal + " using keytab file "+ keytabFile);
}
