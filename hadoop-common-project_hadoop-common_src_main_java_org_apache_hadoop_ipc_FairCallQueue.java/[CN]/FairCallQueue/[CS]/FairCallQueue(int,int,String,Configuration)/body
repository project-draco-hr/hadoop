{
  if (priorityLevels < 1) {
    throw new IllegalArgumentException("Number of Priority Levels must be " + "at least 1");
  }
  int numQueues=priorityLevels;
  LOG.info("FairCallQueue is in use with " + numQueues + " queues.");
  this.queues=new ArrayList<BlockingQueue<E>>(numQueues);
  this.overflowedCalls=new ArrayList<AtomicLong>(numQueues);
  for (int i=0; i < numQueues; i++) {
    this.queues.add(new LinkedBlockingQueue<E>(capacity));
    this.overflowedCalls.add(new AtomicLong(0));
  }
  this.multiplexer=new WeightedRoundRobinMultiplexer(numQueues,ns,conf);
  MetricsProxy mp=MetricsProxy.getInstance(ns);
  mp.setDelegate(this);
}
