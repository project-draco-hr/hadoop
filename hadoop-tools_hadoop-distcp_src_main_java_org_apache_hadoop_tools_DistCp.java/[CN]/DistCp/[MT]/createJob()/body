{
  String jobName="distcp";
  String userChosenName=getConf().get(JobContext.JOB_NAME);
  if (userChosenName != null)   jobName+=": " + userChosenName;
  Job job=Job.getInstance(getConf());
  job.setJobName(jobName);
  job.setInputFormatClass(DistCpUtils.getStrategy(getConf(),inputOptions));
  job.setJarByClass(CopyMapper.class);
  configureOutputFormat(job);
  job.setMapperClass(CopyMapper.class);
  job.setNumReduceTasks(0);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputFormatClass(CopyOutputFormat.class);
  job.getConfiguration().set(JobContext.MAP_SPECULATIVE,"false");
  job.getConfiguration().set(JobContext.NUM_MAPS,String.valueOf(inputOptions.getMaxMaps()));
  if (inputOptions.getSslConfigurationFile() != null) {
    setupSSLConfig(job);
  }
  inputOptions.appendToConf(job.getConfiguration());
  return job;
}
