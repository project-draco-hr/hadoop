{
synchronized (this) {
    if (queue.equals(queueName)) {
      throw new AccessControlException("Cannot submit application " + "to non-leaf queue: " + queueName);
    }
    if (state != QueueState.RUNNING) {
      throw new AccessControlException("Queue " + getQueuePath() + " is STOPPED. Cannot accept submission of application: "+ application.getApplicationId());
    }
    addApplication(application,user);
  }
  if (parent != null) {
    try {
      parent.submitApplication(application,user,queue);
    }
 catch (    AccessControlException ace) {
      LOG.info("Failed to submit application to parent-queue: " + parent.getQueuePath(),ace);
      removeApplication(application,user);
      throw ace;
    }
  }
}
