{
  scheduleApplicationAttempt();
  Container container=mock(Container.class);
  when(container.getId()).thenReturn(BuilderUtils.newContainerId(applicationAttempt.getAppAttemptId(),1));
  Allocation allocation=mock(Allocation.class);
  when(allocation.getContainers()).thenReturn(Collections.singletonList(container));
  when(scheduler.allocate(any(ApplicationAttemptId.class),any(List.class),any(List.class))).thenReturn(allocation);
  applicationAttempt.handle(new RMAppAttemptContainerAllocatedEvent(applicationAttempt.getAppAttemptId(),container));
  testAppAttemptAllocatedState(container);
  return container;
}
