{
  rm=new MockRM(new YarnConfiguration());
  rm.start();
  EventHandler handler=spy(rm.getRMContext().getDispatcher().getEventHandler());
  RMApp app=rm.submitApp(1024,true);
  NMContainerStatus report=NMContainerStatus.newInstance(ContainerId.newContainerId(ApplicationAttemptId.newInstance(app.getApplicationId(),2),1),0,ContainerState.COMPLETE,Resource.newInstance(1024,1),"Dummy Completed",0,Priority.newInstance(10),1234);
  rm.getResourceTrackerService().handleNMContainerStatus(report,null);
  verify(handler,never()).handle((Event)any());
  RMAppAttemptImpl currentAttempt=(RMAppAttemptImpl)app.getCurrentAppAttempt();
  currentAttempt.setMasterContainer(null);
  report=NMContainerStatus.newInstance(ContainerId.newContainerId(currentAttempt.getAppAttemptId(),0),0,ContainerState.COMPLETE,Resource.newInstance(1024,1),"Dummy Completed",0,Priority.newInstance(10),1234);
  rm.getResourceTrackerService().handleNMContainerStatus(report,null);
  verify(handler,never()).handle((Event)any());
  app=rm.submitApp(1024);
  report=NMContainerStatus.newInstance(ContainerId.newContainerId(ApplicationAttemptId.newInstance(app.getApplicationId(),2),1),0,ContainerState.COMPLETE,Resource.newInstance(1024,1),"Dummy Completed",0,Priority.newInstance(10),1234);
  try {
    rm.getResourceTrackerService().handleNMContainerStatus(report,null);
  }
 catch (  Exception e) {
  }
  verify(handler,never()).handle((Event)any());
  currentAttempt=(RMAppAttemptImpl)app.getCurrentAppAttempt();
  currentAttempt.setMasterContainer(null);
  report=NMContainerStatus.newInstance(ContainerId.newContainerId(currentAttempt.getAppAttemptId(),0),0,ContainerState.COMPLETE,Resource.newInstance(1024,1),"Dummy Completed",0,Priority.newInstance(10),1234);
  try {
    rm.getResourceTrackerService().handleNMContainerStatus(report,null);
  }
 catch (  Exception e) {
  }
  verify(handler,never()).handle((Event)any());
}
