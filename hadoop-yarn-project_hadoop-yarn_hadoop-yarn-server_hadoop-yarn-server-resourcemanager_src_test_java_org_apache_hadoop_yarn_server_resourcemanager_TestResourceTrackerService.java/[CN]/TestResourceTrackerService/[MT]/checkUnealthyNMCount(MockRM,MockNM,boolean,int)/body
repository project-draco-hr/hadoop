{
  int waitCount=0;
  while (rm.getRMContext().getRMNodes().get(nm1.getNodeId()).getNodeHealthStatus().getIsNodeHealthy() == health && waitCount++ < 20) {
synchronized (this) {
      wait(100);
    }
  }
  Assert.assertFalse(rm.getRMContext().getRMNodes().get(nm1.getNodeId()).getNodeHealthStatus().getIsNodeHealthy() == health);
  Assert.assertEquals("Unhealthy metrics not incremented",count,ClusterMetrics.getMetrics().getUnhealthyNMs());
}
