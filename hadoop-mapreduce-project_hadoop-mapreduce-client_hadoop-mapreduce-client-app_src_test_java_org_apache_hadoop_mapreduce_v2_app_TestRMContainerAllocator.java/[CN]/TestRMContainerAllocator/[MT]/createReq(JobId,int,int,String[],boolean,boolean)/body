{
  TaskId taskId;
  if (reduce) {
    taskId=MRBuilderUtils.newTaskId(jobId,0,TaskType.REDUCE);
  }
 else {
    taskId=MRBuilderUtils.newTaskId(jobId,0,TaskType.MAP);
  }
  TaskAttemptId attemptId=MRBuilderUtils.newTaskAttemptId(taskId,taskAttemptId);
  Resource containerNeed=BuilderUtils.newResource(memory);
  if (earlierFailedAttempt) {
    return ContainerRequestEvent.createContainerRequestEventForFailedContainer(attemptId,containerNeed);
  }
  return new ContainerRequestEvent(attemptId,containerNeed,hosts,new String[]{NetworkTopology.DEFAULT_RACK});
}
