{
  ApplicationAttemptId attemptId=getContext().getApplicationAttemptId();
  UserGroupInformation ugi=UserGroupInformation.createRemoteUser(attemptId.toString());
  Token<AMRMTokenIdentifier> token=rm.getRMContext().getRMApps().get(attemptId.getApplicationId()).getRMAppAttempt(attemptId).getAMRMToken();
  try {
    ugi.addTokenIdentifier(token.decodeIdentifier());
  }
 catch (  IOException e) {
    throw new YarnRuntimeException(e);
  }
  UserGroupInformation.setLoginUser(ugi);
  super.register();
}
