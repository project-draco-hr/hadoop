{
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    public Boolean get(){
      return eventQueue.isEmpty();
    }
  }
,100,10000);
  try {
    super.heartbeat();
  }
 catch (  Exception e) {
    LOG.error("error in heartbeat ",e);
    throw new YarnRuntimeException(e);
  }
  List<TaskAttemptContainerAssignedEvent> result=new ArrayList<TaskAttemptContainerAssignedEvent>(events);
  events.clear();
  return result;
}
