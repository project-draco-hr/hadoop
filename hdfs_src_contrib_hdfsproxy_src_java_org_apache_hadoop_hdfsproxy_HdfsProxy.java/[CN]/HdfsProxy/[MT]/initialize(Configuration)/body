{
  sslAddr=getSslAddr(conf);
  String nn=conf.get("hdfsproxy.dfs.namenode.address");
  if (nn == null)   throw new IOException("HDFS NameNode address is not specified");
  InetSocketAddress nnAddr=NetUtils.createSocketAddr(nn);
  LOG.info("HDFS NameNode is at: " + nnAddr.getHostName() + ":"+ nnAddr.getPort());
  Configuration sslConf=new HdfsConfiguration(false);
  sslConf.addResource(conf.get("hdfsproxy.https.server.keystore.resource","ssl-server.xml"));
  sslConf.set("proxy.http.test.listener.addr",conf.get("proxy.http.test.listener.addr"));
  this.server=new ProxyHttpServer(sslAddr,sslConf);
  this.server.setAttribute("proxy.https.port",server.getPort());
  this.server.setAttribute(NameNodeHttpServer.NAMENODE_ADDRESS_ATTRIBUTE_KEY,nnAddr);
  this.server.setAttribute(JspHelper.CURRENT_CONF,new HdfsConfiguration());
  this.server.addGlobalFilter("ProxyFilter",ProxyFilter.class.getName(),null);
  this.server.addServlet("listPaths","/listPaths/*",ProxyListPathsServlet.class);
  this.server.addServlet("data","/data/*",ProxyFileDataServlet.class);
  this.server.addServlet("streamFile","/streamFile/*",ProxyStreamFile.class);
}
