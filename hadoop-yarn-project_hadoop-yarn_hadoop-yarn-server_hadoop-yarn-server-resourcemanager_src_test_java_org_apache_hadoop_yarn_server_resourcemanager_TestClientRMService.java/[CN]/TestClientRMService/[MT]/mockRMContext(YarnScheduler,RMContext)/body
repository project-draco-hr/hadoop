{
  Dispatcher dispatcher=mock(Dispatcher.class);
  when(rmContext.getDispatcher()).thenReturn(dispatcher);
  EventHandler eventHandler=mock(EventHandler.class);
  when(dispatcher.getEventHandler()).thenReturn(eventHandler);
  QueueInfo queInfo=recordFactory.newRecordInstance(QueueInfo.class);
  queInfo.setQueueName("testqueue");
  when(yarnScheduler.getQueueInfo(eq("testqueue"),anyBoolean(),anyBoolean())).thenReturn(queInfo);
  when(yarnScheduler.getQueueInfo(eq("nonexistentqueue"),anyBoolean(),anyBoolean())).thenThrow(new IOException("queue does not exist"));
  ConcurrentHashMap<ApplicationId,RMApp> apps=getRMApps(rmContext,yarnScheduler);
  when(rmContext.getRMApps()).thenReturn(apps);
  when(yarnScheduler.getAppsInQueue(eq("testqueue"))).thenReturn(getSchedulerApps(apps));
}
