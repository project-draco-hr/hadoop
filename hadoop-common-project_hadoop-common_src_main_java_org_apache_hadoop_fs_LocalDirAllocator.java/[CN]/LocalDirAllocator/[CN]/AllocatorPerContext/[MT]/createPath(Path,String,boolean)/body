{
  Path file=new Path(dir,path);
  if (checkWrite) {
    try {
      DiskChecker.checkDir(new File(file.getParent().toUri().getPath()));
      return file;
    }
 catch (    DiskErrorException d) {
      LOG.warn("Disk Error Exception: ",d);
      return null;
    }
  }
  return file;
}
