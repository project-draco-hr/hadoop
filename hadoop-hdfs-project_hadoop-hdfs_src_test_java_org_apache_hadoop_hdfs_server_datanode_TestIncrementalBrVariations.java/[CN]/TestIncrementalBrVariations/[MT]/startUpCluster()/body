{
  conf=new Configuration();
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(NUM_DATANODES).build();
  fs=cluster.getFileSystem();
  client=new DFSClient(new InetSocketAddress("localhost",cluster.getNameNodePort()),cluster.getConfiguration(0));
  dn0=cluster.getDataNodes().get(0);
  poolId=cluster.getNamesystem().getBlockPoolId();
  dn0Reg=dn0.getDNRegistrationForBP(poolId);
}
