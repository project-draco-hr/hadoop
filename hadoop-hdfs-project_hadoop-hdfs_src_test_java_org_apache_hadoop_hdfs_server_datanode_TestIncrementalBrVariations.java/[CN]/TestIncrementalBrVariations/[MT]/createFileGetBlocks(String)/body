{
  Path filePath=new Path("/" + filenamePrefix + ".dat");
  DFSTestUtil.createFile(fs,filePath,BLOCK_SIZE,BLOCK_SIZE * NUM_BLOCKS,BLOCK_SIZE,NUM_DATANODES,seed);
  LocatedBlocks blocks=client.getLocatedBlocks(filePath.toString(),0,BLOCK_SIZE * NUM_BLOCKS);
  assertThat(cluster.getNamesystem().getUnderReplicatedBlocks(),is(0L));
  return blocks;
}
