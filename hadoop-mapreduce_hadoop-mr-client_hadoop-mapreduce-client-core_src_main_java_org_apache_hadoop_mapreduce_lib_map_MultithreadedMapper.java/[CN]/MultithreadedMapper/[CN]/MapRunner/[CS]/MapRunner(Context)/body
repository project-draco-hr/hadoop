{
  mapper=ReflectionUtils.newInstance(mapClass,context.getConfiguration());
  MapContext<K1,V1,K2,V2> mapContext=new MapContextImpl<K1,V1,K2,V2>(outer.getConfiguration(),outer.getTaskAttemptID(),reader,new SubMapRecordWriter(),context.getOutputCommitter(),new SubMapStatusReporter(),outer.getInputSplit());
  subcontext=new WrappedMapper<K1,V1,K2,V2>().getMapContext(mapContext);
  reader.initialize(context.getInputSplit(),context);
}
