{
  if (storage != null) {
    for (int i=0; i < storage.getNumStorageDirs(); ++i) {
      storage.createStorageID(storage.getStorageDir(i));
    }
    this.datanodeUuid=storage.getDatanodeUuid();
  }
 else {
    this.datanodeUuid="unknownStorageId-" + UUID.randomUUID();
  }
  registerMBean(datanodeUuid);
  this.storage=new SimulatedStorage(conf.getLong(CONFIG_PROPERTY_CAPACITY,DEFAULT_CAPACITY));
}
