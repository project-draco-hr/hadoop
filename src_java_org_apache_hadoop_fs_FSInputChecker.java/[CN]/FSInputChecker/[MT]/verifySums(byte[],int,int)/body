{
  int leftToVerify=read;
  int verifyOff=0;
  checksumInts.rewind();
  checksumInts.limit((read - 1) / maxChunkSize + 1);
  while (leftToVerify > 0) {
    sum.update(b,off + verifyOff,Math.min(leftToVerify,maxChunkSize));
    int expected=checksumInts.get();
    int calculated=(int)sum.getValue();
    sum.reset();
    if (expected != calculated) {
      long errPos=chunkPos + verifyOff;
      throw new ChecksumException("Checksum error: " + file + " at "+ errPos+ " exp: "+ expected+ " got: "+ calculated,errPos);
    }
    leftToVerify-=maxChunkSize;
    verifyOff+=maxChunkSize;
  }
}
