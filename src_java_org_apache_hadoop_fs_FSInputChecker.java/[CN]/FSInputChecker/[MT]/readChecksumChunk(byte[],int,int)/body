{
  count=pos=0;
  int read=0;
  boolean retry=true;
  int retriesLeft=numOfRetries;
  do {
    retriesLeft--;
    try {
      read=readChunk(chunkPos,b,off,len,checksum);
      if (read > 0) {
        if (needChecksum()) {
          sum.update(b,off,read);
          verifySum(chunkPos);
        }
        chunkPos+=read;
      }
      retry=false;
    }
 catch (    ChecksumException ce) {
      LOG.info("Found checksum error: b[" + off + ", "+ (off + read)+ "]="+ StringUtils.byteToHexString(b,off,off + read),ce);
      if (retriesLeft == 0) {
        throw ce;
      }
      if (seekToNewSource(chunkPos)) {
        seek(chunkPos);
      }
 else {
        throw ce;
      }
    }
  }
 while (retry);
  return read;
}
