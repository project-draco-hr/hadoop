{
  String localWorkDir=System.getenv("PWD");
  URI[] cacheArchives=DistributedCache.getCacheArchives(job);
  if (cacheArchives != null) {
    List<String> localArchives=new ArrayList<String>();
    for (int i=0; i < cacheArchives.length; ++i) {
      URI u=cacheArchives[i];
      Path p=new Path(u);
      Path name=new Path((null == u.getFragment()) ? p.getName() : u.getFragment());
      String linkName=name.toUri().getPath();
      localArchives.add(new Path(localWorkDir,linkName).toUri().getPath());
    }
    if (!localArchives.isEmpty()) {
      job.set(MRJobConfig.CACHE_LOCALARCHIVES,StringUtils.arrayToString(localArchives.toArray(new String[localArchives.size()])));
    }
  }
  URI[] cacheFiles=DistributedCache.getCacheFiles(job);
  if (cacheFiles != null) {
    List<String> localFiles=new ArrayList<String>();
    for (int i=0; i < cacheFiles.length; ++i) {
      URI u=cacheFiles[i];
      Path p=new Path(u);
      Path name=new Path((null == u.getFragment()) ? p.getName() : u.getFragment());
      String linkName=name.toUri().getPath();
      localFiles.add(new Path(localWorkDir,linkName).toUri().getPath());
    }
    if (!localFiles.isEmpty()) {
      job.set(MRJobConfig.CACHE_LOCALFILES,StringUtils.arrayToString(localFiles.toArray(new String[localFiles.size()])));
    }
  }
}
