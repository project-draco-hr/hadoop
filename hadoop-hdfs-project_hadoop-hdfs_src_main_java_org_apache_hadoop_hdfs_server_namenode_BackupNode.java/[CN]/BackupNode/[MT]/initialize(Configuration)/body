{
  conf.setLong(CommonConfigurationKeys.FS_TRASH_INTERVAL_KEY,CommonConfigurationKeys.FS_TRASH_INTERVAL_DEFAULT);
  NamespaceInfo nsInfo=handshake(conf);
  super.initialize(conf);
  namesystem.setBlockPoolId(nsInfo.getBlockPoolID());
  if (false == namesystem.isInSafeMode()) {
    namesystem.setSafeMode(SafeModeAction.SAFEMODE_ENTER);
  }
  namesystem.leaseManager.setLeasePeriod(HdfsConstants.LEASE_SOFTLIMIT_PERIOD,Long.MAX_VALUE);
  registerWith(nsInfo);
  runCheckpointDaemon(conf);
}
