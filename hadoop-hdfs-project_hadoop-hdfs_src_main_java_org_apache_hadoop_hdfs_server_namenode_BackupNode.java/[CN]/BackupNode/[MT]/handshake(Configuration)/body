{
  InetSocketAddress nnAddress=NameNode.getServiceAddress(conf,true);
  NamenodeProtocolPB proxy=RPC.waitForProxy(NamenodeProtocolPB.class,RPC.getProtocolVersion(NamenodeProtocolPB.class),nnAddress,conf);
  this.namenode=new NamenodeProtocolTranslatorPB(proxy);
  this.nnRpcAddress=getHostPortString(nnAddress);
  this.nnHttpAddress=getHostPortString(super.getHttpServerAddress(conf));
  NamespaceInfo nsInfo=null;
  while (!isStopRequested()) {
    try {
      nsInfo=handshake(namenode);
      break;
    }
 catch (    SocketTimeoutException e) {
      LOG.info("Problem connecting to server: " + nnAddress);
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException ie) {
        LOG.warn("Encountered exception ",e);
      }
    }
  }
  return nsInfo;
}
