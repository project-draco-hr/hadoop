{
  FileSystem.mkdirs(hdfs,path,FsPermission.createImmutable((short)0700));
  SnapshotTestHelper.createSnapshot(hdfs,path,snapshotName);
  List<AclEntry> aclSpec=Lists.newArrayList(aclEntry(ACCESS,USER,"bruce",ALL));
  hdfs.modifyAclEntries(path,aclSpec);
  hdfs.removeAcl(path);
  AclEntry[] expected=new AclEntry[]{};
  AclStatus s=hdfs.getAclStatus(path);
  AclEntry[] returned=s.getEntries().toArray(new AclEntry[0]);
  assertArrayEquals(expected,returned);
  assertPermission((short)0700,path);
  assertDirPermissionDenied(fsAsBruce,BRUCE,path);
  assertDirPermissionDenied(fsAsDiana,DIANA,path);
}
