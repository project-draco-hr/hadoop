{
  String httpAddress=null;
  String httpAddressKey=(UserGroupInformation.isSecurityEnabled() && httpsAddress) ? DFSConfigKeys.DFS_NAMENODE_HTTPS_ADDRESS_KEY : DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY;
  String httpAddressDefault=(UserGroupInformation.isSecurityEnabled() && httpsAddress) ? DFSConfigKeys.DFS_NAMENODE_HTTPS_ADDRESS_DEFAULT : DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_DEFAULT;
  if (namenode != null) {
    String nameServiceId=DFSUtil.getNameServiceIdFromAddress(conf,namenode,DFSConfigKeys.DFS_NAMENODE_SERVICE_RPC_ADDRESS_KEY,DFSConfigKeys.DFS_NAMENODE_RPC_ADDRESS_KEY);
    if (nameServiceId != null) {
      httpAddress=conf.get(DFSUtil.getNameServiceIdKey(httpAddressKey,nameServiceId));
    }
  }
  if (httpAddress == null) {
    httpAddress=conf.get(httpAddressKey,httpAddressDefault);
  }
  return httpAddress;
}
