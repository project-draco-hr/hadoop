{
  AllocateRequest allocateRequest=recordFactory.newRecordInstance(AllocateRequest.class);
  allocateRequest.setApplicationAttemptId(applicationAttemptId);
  allocateRequest.setResponseId(lastResponseID);
  allocateRequest.addAllAsks(new ArrayList<ResourceRequest>(ask));
  allocateRequest.addAllReleases(new ArrayList<ContainerId>(release));
  AllocateResponse allocateResponse=scheduler.allocate(allocateRequest);
  AMResponse response=allocateResponse.getAMResponse();
  lastResponseID=response.getResponseId();
  availableResources=response.getAvailableResources();
  LOG.info("getResources() for " + applicationId + ":"+ " ask="+ ask.size()+ " release= "+ release.size()+ " newContainers="+ response.getNewContainerCount()+ " finishedContainers="+ response.getFinishedContainerCount()+ " resourcelimit="+ availableResources);
  ask.clear();
  release.clear();
  return response;
}
