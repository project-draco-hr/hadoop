{
  Iterator<ResourceRequest> iter=requestLimits.values().iterator();
  while (iter.hasNext()) {
    ResourceRequest reqLimit=iter.next();
    int limit=reqLimit.getNumContainers();
    Map<String,Map<Resource,ResourceRequest>> remoteRequests=remoteRequestsTable.get(reqLimit.getPriority());
    Map<Resource,ResourceRequest> reqMap=(remoteRequests != null) ? remoteRequests.get(ResourceRequest.ANY) : null;
    ResourceRequest req=(reqMap != null) ? reqMap.get(reqLimit.getCapability()) : null;
    if (req == null) {
      continue;
    }
    if (ask.remove(req) || requestLimitsToUpdate.contains(req)) {
      ResourceRequest newReq=req.getNumContainers() > limit ? reqLimit : req;
      ask.add(newReq);
      LOG.info("Applying ask limit of " + newReq.getNumContainers() + " for priority:"+ reqLimit.getPriority()+ " and capability:"+ reqLimit.getCapability());
    }
    if (limit == Integer.MAX_VALUE) {
      iter.remove();
    }
  }
  requestLimitsToUpdate.clear();
}
