{
  ArrayList<TaskStatus> statuses=new ArrayList<TaskStatus>();
  Set<TaskAttemptID> mark=new HashSet<TaskAttemptID>();
  for (  SimulatorTaskInProgress tip : tasks.values()) {
    statuses.add((TaskStatus)tip.getTaskStatus().clone());
    if (tip.getFinalRunState() == State.SUCCEEDED) {
      mark.add(tip.getTaskStatus().getTaskID());
    }
  }
  for (  TaskAttemptID taskId : mark) {
    tasks.remove(taskId);
  }
  return statuses;
}
