{
  JobId jobId=request.getJobId();
  TaskType taskType=request.getTaskType();
  GetTaskReportsResponse response=recordFactory.newRecordInstance(GetTaskReportsResponse.class);
  Job job=verifyAndGetJob(jobId,JobACL.VIEW_JOB,true);
  Collection<Task> tasks=job.getTasks(taskType).values();
  LOG.info("Getting task report for " + taskType + "   "+ jobId+ ". Report-size will be "+ tasks.size());
synchronized (getTaskReportsLock) {
    for (    Task task : tasks) {
      response.addTaskReport(task.getReport());
    }
  }
  return response;
}
