{
  ChildrenDiff diff=new ChildrenDiff();
  if (dir instanceof INodeDirectoryWithSnapshot) {
    boolean change=((INodeDirectoryWithSnapshot)dir).computeDiffBetweenSnapshots(diffReport.from,diffReport.to,diff);
    if (change) {
      diffReport.addDiff((INodeDirectoryWithSnapshot)dir,diff);
    }
  }
  ReadOnlyList<INode> children=dir.getChildrenList(null);
  for (  INode child : children) {
    if (child instanceof INodeDirectory && diff.searchCreated(child.getLocalNameBytes()) == null) {
      computeDiffInDir((INodeDirectory)child,diffReport);
    }
  }
}
