{
  final int indexOfOld=searchSnapshot(DFSUtil.string2Bytes(snapshotName));
  if (indexOfOld < 0) {
    throw new SnapshotException("Cannot delete snapshot " + snapshotName + " from path "+ this.getFullPathName()+ ": the snapshot does not exist.");
  }
 else {
    Snapshot snapshot=snapshotsByNames.remove(indexOfOld);
    deleteDiffsForSnapshot(snapshot,this,collectedBlocks);
    return snapshot;
  }
}
