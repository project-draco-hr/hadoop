{
  if (snapshots.size() + 1 > snapshotQuota) {
    throw new SnapshotException("Failed to add snapshot: there are already " + snapshots.size() + " snapshot(s) and the snapshot quota is "+ snapshotQuota);
  }
  snapshots.add(s);
  final long timestamp=Time.now();
  s.getRoot().setModificationTime(timestamp);
  setModificationTime(timestamp);
}
