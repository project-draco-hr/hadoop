{
  boolean result=false;
  try {
    ApplicationMaster appMaster=new ApplicationMaster();
    LOG.info("Initializing ApplicationMaster");
    boolean doRun=appMaster.init(args);
    if (!doRun) {
      System.exit(0);
    }
    appMaster.run();
    result=appMaster.finish();
    threadPool.shutdown();
    while (!threadPool.isTerminated()) {
      try {
        if (!threadPool.awaitTermination(30,TimeUnit.SECONDS)) {
          threadPool.shutdownNow();
        }
      }
 catch (      InterruptedException e) {
        LOG.warn("Timeline client service stop interrupted!");
        break;
      }
    }
  }
 catch (  Throwable t) {
    LOG.fatal("Error running ApplicationMaster",t);
    LogManager.shutdown();
    ExitUtil.terminate(1,t);
  }
  if (result) {
    LOG.info("Application Master completed successfully. exiting");
    System.exit(0);
  }
 else {
    LOG.info("Application Master failed. exiting");
    System.exit(2);
  }
}
