{
  LOG.info("Starting ApplicationMaster");
  AMRMClientAsync.CallbackHandler allocListener=new RMCallbackHandler();
  resourceManager=new AMRMClientAsync(appAttemptID,1000,allocListener);
  resourceManager.init(conf);
  resourceManager.start();
  containerListener=new NMCallbackHandler();
  nmClientAsync=new NMClientAsync(containerListener);
  nmClientAsync.init(conf);
  nmClientAsync.start();
  RegisterApplicationMasterResponse response=resourceManager.registerApplicationMaster(appMasterHostname,appMasterRpcPort,appMasterTrackingUrl);
  int minMem=response.getMinimumResourceCapability().getMemory();
  int maxMem=response.getMaximumResourceCapability().getMemory();
  LOG.info("Min mem capabililty of resources in this cluster " + minMem);
  LOG.info("Max mem capabililty of resources in this cluster " + maxMem);
  if (containerMemory < minMem) {
    LOG.info("Container memory specified below min threshold of cluster." + " Using min value." + ", specified=" + containerMemory + ", min="+ minMem);
    containerMemory=minMem;
  }
 else   if (containerMemory > maxMem) {
    LOG.info("Container memory specified above max threshold of cluster." + " Using max value." + ", specified=" + containerMemory + ", max="+ maxMem);
    containerMemory=maxMem;
  }
  ContainerRequest containerAsk=setupContainerAskForRM(numTotalContainers);
  resourceManager.addContainerRequest(containerAsk);
  numRequestedContainers.set(numTotalContainers);
  while (!done) {
    try {
      Thread.sleep(200);
    }
 catch (    InterruptedException ex) {
    }
  }
  finish();
  return success;
}
