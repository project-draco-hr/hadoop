{
  AllocateRequest req=Records.newRecord(AllocateRequest.class);
  req.setResponseId(rmRequestID.incrementAndGet());
  req.setApplicationAttemptId(appAttemptID);
  req.addAllAsks(requestedContainers);
  req.addAllReleases(releasedContainers);
  req.setProgress((float)numCompletedContainers.get() / numTotalContainers);
  LOG.info("Sending request to RM for containers" + ", requestedSet=" + requestedContainers.size() + ", releasedSet="+ releasedContainers.size()+ ", progress="+ req.getProgress());
  for (  ResourceRequest rsrcReq : requestedContainers) {
    LOG.info("Requested container ask: " + rsrcReq.toString());
  }
  for (  ContainerId id : releasedContainers) {
    LOG.info("Released container, id=" + id.getId());
  }
  AllocateResponse resp=resourceManager.allocate(req);
  return resp.getAMResponse();
}
