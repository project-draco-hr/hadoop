{
  LOG.info("Got response from RM for container ask, completedCnt=" + completedContainers.size());
  for (  ContainerStatus containerStatus : completedContainers) {
    LOG.info(appAttemptID + " got container status for containerID=" + containerStatus.getContainerId()+ ", state="+ containerStatus.getState()+ ", exitStatus="+ containerStatus.getExitStatus()+ ", diagnostics="+ containerStatus.getDiagnostics());
    assert(containerStatus.getState() == ContainerState.COMPLETE);
    int exitStatus=containerStatus.getExitStatus();
    if (0 != exitStatus) {
      if (ContainerExitStatus.ABORTED != exitStatus) {
        numCompletedContainers.incrementAndGet();
        numFailedContainers.incrementAndGet();
      }
 else {
        numAllocatedContainers.decrementAndGet();
        numRequestedContainers.decrementAndGet();
      }
    }
 else {
      numCompletedContainers.incrementAndGet();
      LOG.info("Container completed successfully." + ", containerId=" + containerStatus.getContainerId());
    }
    try {
      publishContainerEndEvent(timelineClient,containerStatus);
    }
 catch (    Exception e) {
      LOG.error("Container start event could not be pulished for " + containerStatus.getContainerId().toString(),e);
    }
  }
  int askCount=numTotalContainers - numRequestedContainers.get();
  numRequestedContainers.addAndGet(askCount);
  if (askCount > 0) {
    for (int i=0; i < askCount; ++i) {
      ContainerRequest containerAsk=setupContainerAskForRM();
      amRMClient.addContainerRequest(containerAsk);
    }
  }
  if (numCompletedContainers.get() == numTotalContainers) {
    done=true;
  }
}
