{
  final String uri;
  if (WebHdfsConstants.WEBHDFS_SCHEME.equals(scheme)) {
    uri=WebHdfsConstants.WEBHDFS_SCHEME + "://" + conf.get(DFSConfigKeys.DFS_NAMENODE_HTTP_ADDRESS_KEY);
  }
 else   if (WebHdfsConstants.SWEBHDFS_SCHEME.equals(scheme)) {
    uri=WebHdfsConstants.SWEBHDFS_SCHEME + "://" + conf.get(DFSConfigKeys.DFS_NAMENODE_HTTPS_ADDRESS_KEY);
  }
 else {
    throw new IllegalArgumentException("unknown scheme:" + scheme);
  }
  return (WebHdfsFileSystem)FileSystem.get(new URI(uri),conf);
}
