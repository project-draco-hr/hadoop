{
  assertTrue("data directory does not exist",dataDir.exists());
  File[] blocks=dataDir.listFiles();
  assertTrue("Blocks do not exist in dataDir",(blocks != null) && (blocks.length > 0));
  int idx=0;
  String blockFileName=null;
  for (; idx < blocks.length; idx++) {
    blockFileName=blocks[idx].getName();
    if (blockFileName.startsWith("blk_") && !blockFileName.endsWith(".meta")) {
      break;
    }
  }
  if (blockFileName == null) {
    return null;
  }
  long blockId=Long.parseLong(blockFileName.substring("blk_".length()));
  long blockTimeStamp=GenerationStamp.GRANDFATHER_GENERATION_STAMP;
  for (idx=0; idx < blocks.length; idx++) {
    String fileName=blocks[idx].getName();
    if (fileName.startsWith(blockFileName) && fileName.endsWith(".meta")) {
      int startIndex=blockFileName.length() + 1;
      int endIndex=fileName.length() - ".meta".length();
      blockTimeStamp=Long.parseLong(fileName.substring(startIndex,endIndex));
      break;
    }
  }
  return new ExtendedBlock(bpid,blockId,blocks[idx].length(),blockTimeStamp);
}
