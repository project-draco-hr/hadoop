{
  if (cluster != null) {
    cluster.shutdown();
    cluster=null;
  }
  cluster=new MiniDFSCluster.Builder(CONF).numDataNodes(1).format(false).build();
  cluster.waitClusterUp();
  fc=FileContext.getFileContext(cluster.getURI(0),CONF);
  defaultWorkingDirectory=fc.makeQualified(new Path("/user/" + UserGroupInformation.getCurrentUser().getShortUserName()));
  fc.mkdir(defaultWorkingDirectory,FileContext.DEFAULT_PERM,true);
  cluster.getFileSystem().allowSnapshot(defaultWorkingDirectory);
}
