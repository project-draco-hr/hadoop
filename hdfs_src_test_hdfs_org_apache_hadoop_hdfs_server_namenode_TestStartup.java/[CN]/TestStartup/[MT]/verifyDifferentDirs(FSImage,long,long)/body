{
  StorageDirectory sd=null;
  for (Iterator<StorageDirectory> it=img.getStorage().dirIterator(); it.hasNext(); ) {
    sd=it.next();
    if (sd.getStorageDirType().isOfType(NameNodeDirType.IMAGE)) {
      File imf=img.getStorage().getStorageFile(sd,NameNodeFile.IMAGE,0);
      LOG.info("--image file " + imf.getAbsolutePath() + "; len = "+ imf.length()+ "; expected = "+ expectedImgSize);
      assertEquals(expectedImgSize,imf.length());
    }
 else     if (sd.getStorageDirType().isOfType(NameNodeDirType.EDITS)) {
      File edf=img.getStorage().getStorageFile(sd,NameNodeFile.EDITS,0);
      LOG.info("-- edits file " + edf.getAbsolutePath() + "; len = "+ edf.length()+ "; expected = "+ expectedEditsSize);
      assertEquals(expectedEditsSize,edf.length());
    }
 else {
      fail("Image/Edits directories are not different");
    }
  }
}
