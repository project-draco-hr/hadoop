{
  if (ranges == null || ranges.size() != 1) {
    response.setContentLength(0);
    response.setStatus(HttpServletResponse.SC_REQUESTED_RANGE_NOT_SATISFIABLE);
    response.setHeader("Content-Range",InclusiveByteRange.to416HeaderRangeString(contentLength));
  }
 else {
    InclusiveByteRange singleSatisfiableRange=ranges.get(0);
    long singleLength=singleSatisfiableRange.getSize(contentLength);
    response.setStatus(HttpServletResponse.SC_PARTIAL_CONTENT);
    response.setHeader("Content-Range",singleSatisfiableRange.toHeaderRangeString(contentLength));
    copyFromOffset(in,out,singleSatisfiableRange.getFirst(contentLength),singleLength,close);
  }
}
