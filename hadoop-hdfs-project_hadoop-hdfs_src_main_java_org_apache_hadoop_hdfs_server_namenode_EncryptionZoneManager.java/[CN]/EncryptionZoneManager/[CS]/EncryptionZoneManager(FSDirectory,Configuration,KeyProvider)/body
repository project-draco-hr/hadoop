{
  this.dir=dir;
  this.provider=provider;
  lock=new ReentrantReadWriteLock();
  encryptionZones=new HashMap<Long,EncryptionZoneInt>();
  monitor=Executors.newScheduledThreadPool(1,new ThreadFactoryBuilder().setDaemon(true).setNameFormat(EncryptionZoneMonitor.class.getSimpleName() + "-%d").build());
  final int refreshMs=conf.getInt(DFSConfigKeys.DFS_NAMENODE_KEY_VERSION_REFRESH_INTERVAL_MS_KEY,DFSConfigKeys.DFS_NAMENODE_KEY_VERSION_REFRESH_INTERVAL_MS_DEFAULT);
  Preconditions.checkArgument(refreshMs >= 0,"%s cannot be negative",DFSConfigKeys.DFS_NAMENODE_KEY_VERSION_REFRESH_INTERVAL_MS_KEY);
  monitor.scheduleAtFixedRate(new EncryptionZoneMonitor(),0,refreshMs,TimeUnit.MILLISECONDS);
}
