{
  final boolean srcInEZ=(getEncryptionZoneForPath(srcIIP) != null);
  final boolean dstInEZ=(getEncryptionZoneForPath(dstIIP) != null);
  if (srcInEZ) {
    if (!dstInEZ) {
      throw new IOException(src + " can't be moved from an encryption zone.");
    }
  }
 else {
    if (dstInEZ) {
      throw new IOException(src + " can't be moved into an encryption zone.");
    }
  }
  if (srcInEZ || dstInEZ) {
    final EncryptionZoneInt srcEZI=getEncryptionZoneForPath(srcIIP);
    final EncryptionZoneInt dstEZI=getEncryptionZoneForPath(dstIIP);
    Preconditions.checkArgument(srcEZI != null,"couldn't find src EZ?");
    Preconditions.checkArgument(dstEZI != null,"couldn't find dst EZ?");
    if (srcEZI != dstEZI) {
      final String srcEZPath=srcEZI.getFullPathName();
      final String dstEZPath=dstEZI.getFullPathName();
      final StringBuilder sb=new StringBuilder(src);
      sb.append(" can't be moved from encryption zone ");
      sb.append(srcEZPath);
      sb.append(" to encryption zone ");
      sb.append(dstEZPath);
      sb.append(".");
      throw new IOException(sb.toString());
    }
  }
}
