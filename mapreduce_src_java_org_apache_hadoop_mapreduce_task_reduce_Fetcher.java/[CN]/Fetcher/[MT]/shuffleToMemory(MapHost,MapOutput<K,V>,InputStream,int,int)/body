{
  IFileInputStream checksumIn=new IFileInputStream(input,compressedLength);
  input=checksumIn;
  if (codec != null) {
    decompressor.reset();
    input=codec.createInputStream(input,decompressor);
  }
  byte[] shuffleData=mapOutput.getMemory();
  try {
    IOUtils.readFully(input,shuffleData,0,shuffleData.length);
    metrics.inputBytes(shuffleData.length);
    reporter.progress();
    LOG.info("Read " + shuffleData.length + " bytes from map-output for "+ mapOutput.getMapId());
  }
 catch (  IOException ioe) {
    IOUtils.cleanup(LOG,input);
    throw ioe;
  }
}
