{
  conf=iconf;
  storageId=conf.get(DFSConfigKeys.DFS_DATANODE_STORAGEID_KEY,"unknownStorageId" + new Random().nextInt());
  registerMBean(storageId);
  storage=new SimulatedStorage(conf.getLong(CONFIG_PROPERTY_CAPACITY,DEFAULT_CAPACITY));
  blockMap=new HashMap<String,Map<Block,BInfo>>();
}
