{
  final Map<Block,BInfo> map=getMap(b.getBlockPoolId());
  BInfo binfo=map.get(b.getLocalBlock());
  if (binfo == null || !binfo.isFinalized()) {
    throw new ReplicaNotFoundException("Block " + b + " is not valid, and cannot be appended to.");
  }
  binfo.unfinalizeBlock();
  return binfo;
}
