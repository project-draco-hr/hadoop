{
  GenericTestUtils.waitFor(new Supplier<Boolean>(){
    @Override public Boolean get(){
      try {
        LocatedBlocks locs=NameNodeAdapter.getBlockLocations(nn,path,0,1000);
        LOG.info("Got locs: " + locs);
        return locs.getLastLocatedBlock().getLocations().length == expectedReplicas;
      }
 catch (      IOException e) {
        LOG.warn("No block locations yet: " + e.getMessage());
        return false;
      }
    }
  }
,500,10000);
}
