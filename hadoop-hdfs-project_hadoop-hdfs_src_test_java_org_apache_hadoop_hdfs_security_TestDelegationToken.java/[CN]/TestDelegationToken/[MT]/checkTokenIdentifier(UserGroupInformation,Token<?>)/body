{
  Assert.assertNotNull(token);
  DelegationTokenIdentifier identifier=new DelegationTokenIdentifier();
  byte[] tokenId=token.getIdentifier();
  DataInputStream in=new DataInputStream(new ByteArrayInputStream(tokenId));
  try {
    identifier.readFields(in);
  }
  finally {
    in.close();
  }
  Assert.assertNotNull(identifier);
  LOG.info("A valid token should have non-null password, and should be renewed successfully");
  Assert.assertTrue(null != dtSecretManager.retrievePassword(identifier));
  dtSecretManager.renewToken((Token<DelegationTokenIdentifier>)token,"JobTracker");
  ugi.doAs(new PrivilegedExceptionAction<Object>(){
    @Override public Object run() throws Exception {
      token.renew(config);
      token.cancel(config);
      return null;
    }
  }
);
}
