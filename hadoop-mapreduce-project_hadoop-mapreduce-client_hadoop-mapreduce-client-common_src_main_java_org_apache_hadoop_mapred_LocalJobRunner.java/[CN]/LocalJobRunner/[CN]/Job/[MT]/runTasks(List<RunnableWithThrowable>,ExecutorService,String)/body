{
  for (  Runnable r : runnables) {
    service.submit(r);
  }
  try {
    service.shutdown();
    LOG.info("Waiting for " + taskType + " tasks");
    service.awaitTermination(Long.MAX_VALUE,TimeUnit.NANOSECONDS);
  }
 catch (  InterruptedException ie) {
    service.shutdownNow();
    throw ie;
  }
  LOG.info(taskType + " task executor complete.");
  for (  RunnableWithThrowable r : runnables) {
    if (r.storedException != null) {
      throw new Exception(r.storedException);
    }
  }
}
