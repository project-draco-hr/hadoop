{
  int maxMapThreads=job.getInt(LOCAL_MAX_MAPS,1);
  if (maxMapThreads < 1) {
    throw new IllegalArgumentException("Configured " + LOCAL_MAX_MAPS + " must be >= 1");
  }
  this.numMapTasks=numMapTasks;
  maxMapThreads=Math.min(maxMapThreads,this.numMapTasks);
  maxMapThreads=Math.max(maxMapThreads,1);
  initCounters(this.numMapTasks);
  LOG.debug("Starting thread pool executor.");
  LOG.debug("Max local threads: " + maxMapThreads);
  LOG.debug("Map tasks to process: " + this.numMapTasks);
  ThreadFactory tf=new ThreadFactoryBuilder().setNameFormat("LocalJobRunner Map Task Executor #%d").build();
  ExecutorService executor=Executors.newFixedThreadPool(maxMapThreads,tf);
  return executor;
}
