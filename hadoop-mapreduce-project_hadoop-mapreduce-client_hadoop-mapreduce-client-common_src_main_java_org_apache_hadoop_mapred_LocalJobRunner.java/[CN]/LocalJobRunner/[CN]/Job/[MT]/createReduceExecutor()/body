{
  int maxReduceThreads=job.getInt(LOCAL_MAX_REDUCES,1);
  if (maxReduceThreads < 1) {
    throw new IllegalArgumentException("Configured " + LOCAL_MAX_REDUCES + " must be >= 1");
  }
  maxReduceThreads=Math.min(maxReduceThreads,this.numReduceTasks);
  maxReduceThreads=Math.max(maxReduceThreads,1);
  LOG.debug("Starting reduce thread pool executor.");
  LOG.debug("Max local threads: " + maxReduceThreads);
  LOG.debug("Reduce tasks to process: " + this.numReduceTasks);
  ExecutorService executor=Executors.newFixedThreadPool(maxReduceThreads);
  return executor;
}
