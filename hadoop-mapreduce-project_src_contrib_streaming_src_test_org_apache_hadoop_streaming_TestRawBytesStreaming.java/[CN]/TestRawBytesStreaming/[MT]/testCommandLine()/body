{
  try {
    try {
      FileUtil.fullyDelete(OUTPUT_DIR.getAbsoluteFile());
    }
 catch (    Exception e) {
    }
    createInput();
    OUTPUT_DIR.delete();
    StreamJob job=new StreamJob();
    job.setConf(new Configuration());
    job.run(genArgs());
    File outFile=new File(OUTPUT_DIR,"part-00000").getAbsoluteFile();
    String output=StreamUtil.slurp(outFile);
    outFile.delete();
    System.out.println("   map=" + map);
    System.out.println("reduce=" + reduce);
    System.err.println("outEx1=" + outputExpect);
    System.err.println("  out1=" + output);
    assertEquals(outputExpect,output);
  }
  finally {
    INPUT_FILE.delete();
    FileUtil.fullyDelete(OUTPUT_DIR.getAbsoluteFile());
  }
}
