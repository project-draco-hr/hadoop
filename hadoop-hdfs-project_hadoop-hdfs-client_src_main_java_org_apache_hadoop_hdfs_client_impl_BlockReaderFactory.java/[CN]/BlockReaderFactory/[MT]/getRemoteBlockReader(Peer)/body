{
  int networkDistance=clientContext.getNetworkDistance(datanode);
  if (conf.getShortCircuitConf().isUseLegacyBlockReader()) {
    return BlockReaderRemote.newBlockReader(fileName,block,token,startOffset,length,conf.getIoBufferSize(),verifyChecksum,clientName,peer,datanode,clientContext.getPeerCache(),cachingStrategy,tracer,networkDistance);
  }
 else {
    return BlockReaderRemote2.newBlockReader(fileName,block,token,startOffset,length,verifyChecksum,clientName,peer,datanode,clientContext.getPeerCache(),cachingStrategy,tracer,networkDistance);
  }
}
