{
  LOG.trace("{}: trying to create a remote block reader from a TCP socket",this);
  BlockReader blockReader=null;
  while (true) {
    BlockReaderPeer curPeer=null;
    Peer peer=null;
    try {
      curPeer=nextTcpPeer();
      if (curPeer.fromCache)       remainingCacheTries--;
      peer=curPeer.peer;
      blockReader=getRemoteBlockReader(peer);
      return blockReader;
    }
 catch (    IOException ioe) {
      if (isSecurityException(ioe)) {
        LOG.trace("{}: got security exception while constructing a remote " + "block reader from {}",this,peer,ioe);
        throw ioe;
      }
      if ((curPeer != null) && curPeer.fromCache) {
        LOG.debug("Closed potentially stale remote peer {}",peer,ioe);
      }
 else {
        LOG.warn("I/O error constructing remote block reader.",ioe);
        throw ioe;
      }
    }
 finally {
      if (blockReader == null) {
        IOUtilsClient.cleanup(LOG,peer);
      }
    }
  }
}
