{
  nodeLabelManager.addToCluserNodeLabels(ImmutableSet.of("red","blue"));
  CapacitySchedulerConfiguration csConf=new CapacitySchedulerConfiguration();
  setupQueueConfigurationWithoutLabels(csConf);
  YarnConfiguration conf=new YarnConfiguration(csConf);
  CapacityScheduler capacityScheduler=new CapacityScheduler();
  RMContextImpl rmContext=new RMContextImpl(null,null,null,null,null,null,new RMContainerTokenSecretManager(conf),new NMTokenSecretManagerInRM(conf),new ClientToAMTokenSecretManagerInRM(),null);
  rmContext.setNodeLabelManager(nodeLabelManager);
  capacityScheduler.setConf(conf);
  capacityScheduler.setRMContext(rmContext);
  capacityScheduler.init(conf);
  capacityScheduler.start();
  csConf=new CapacitySchedulerConfiguration();
  setupQueueConfigurationWithLabels(csConf);
  conf=new YarnConfiguration(csConf);
  capacityScheduler.reinitialize(conf,rmContext);
  checkQueueLabels(capacityScheduler);
  ServiceOperations.stopQuietly(capacityScheduler);
}
