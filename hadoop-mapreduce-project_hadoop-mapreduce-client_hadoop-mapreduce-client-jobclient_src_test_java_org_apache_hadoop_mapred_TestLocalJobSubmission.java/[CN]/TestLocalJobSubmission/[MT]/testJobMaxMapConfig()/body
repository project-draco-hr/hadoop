{
  Configuration conf=new Configuration();
  conf.set(MRConfig.FRAMEWORK_NAME,"local");
  conf.setInt(MRJobConfig.JOB_MAX_MAP,0);
  final String[] args={"-m","1","-r","1","-mt","1","-rt","1"};
  int res=-1;
  try {
    res=ToolRunner.run(conf,new SleepJob(),args);
    fail("Job should fail");
  }
 catch (  IllegalArgumentException e) {
    assertTrue(e.getLocalizedMessage().contains("The number of map tasks 1 exceeded limit"));
  }
}
