{
  int threadsBefore=countThreads("Server$Listener$Reader");
  assertEquals("Expect no Reader threads running before test",0,threadsBefore);
  final Server server=RPC.getServer(TestProtocol.class,new TestImpl(),ADDRESS,0,5,true,conf,null);
  server.start();
  try {
    int threadsRunning=countThreads("Server$Listener$Reader");
    assertTrue(threadsRunning > 0);
  }
  finally {
    server.stop();
  }
  int threadsAfter=countThreads("Server$Listener$Reader");
  assertEquals("Expect no Reader threads left running after test",0,threadsAfter);
}
