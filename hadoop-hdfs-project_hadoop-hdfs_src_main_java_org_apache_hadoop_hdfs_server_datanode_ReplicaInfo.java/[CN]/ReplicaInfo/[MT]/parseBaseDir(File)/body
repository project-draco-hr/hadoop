{
  File currentDir=dir;
  boolean hasSubdirs=false;
  while (currentDir.getName().startsWith(DataStorage.BLOCK_SUBDIR_PREFIX)) {
    hasSubdirs=true;
    currentDir=currentDir.getParentFile();
  }
  return new ReplicaDirInfo(currentDir.getAbsolutePath(),hasSubdirs);
}
