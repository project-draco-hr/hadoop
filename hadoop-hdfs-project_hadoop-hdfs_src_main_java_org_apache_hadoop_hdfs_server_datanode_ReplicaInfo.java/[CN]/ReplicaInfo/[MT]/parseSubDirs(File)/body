{
  ReplicaDirInfo ret=new ReplicaDirInfo();
  File currentDir=dir;
  List<Integer> subDirList=new ArrayList<Integer>();
  while (currentDir.getName().startsWith(DataStorage.BLOCK_SUBDIR_PREFIX)) {
    subDirList.add(0,Integer.parseInt(currentDir.getName().replaceFirst(DataStorage.BLOCK_SUBDIR_PREFIX,"")));
    currentDir=currentDir.getParentFile();
  }
  ret.subDirs=new int[subDirList.size()];
  for (int i=0; i < subDirList.size(); i++) {
    ret.subDirs[i]=subDirList.get(i);
  }
  ret.baseDirPath=currentDir.getAbsolutePath();
  return ret;
}
