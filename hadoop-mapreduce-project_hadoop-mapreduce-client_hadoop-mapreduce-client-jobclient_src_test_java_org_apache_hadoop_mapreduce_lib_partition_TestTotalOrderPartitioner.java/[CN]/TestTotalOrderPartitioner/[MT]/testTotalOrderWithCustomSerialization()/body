{
  TotalOrderPartitioner<String,NullWritable> partitioner=new TotalOrderPartitioner<String,NullWritable>();
  Configuration conf=new Configuration();
  conf.setStrings(CommonConfigurationKeys.IO_SERIALIZATIONS_KEY,JavaSerialization.class.getName(),WritableSerialization.class.getName());
  conf.setClass(MRJobConfig.KEY_COMPARATOR,JavaSerializationComparator.class,Comparator.class);
  Path p=TestTotalOrderPartitioner.<String>writePartitionFile("totalordercustomserialization",conf,splitJavaStrings);
  conf.setClass(MRJobConfig.MAP_OUTPUT_KEY_CLASS,String.class,Object.class);
  try {
    partitioner.setConf(conf);
    NullWritable nw=NullWritable.get();
    for (    Check<String> chk : testJavaStrings) {
      assertEquals(chk.data.toString(),chk.part,partitioner.getPartition(chk.data,nw,splitJavaStrings.length + 1));
    }
  }
  finally {
    p.getFileSystem(conf).delete(p,true);
  }
}
