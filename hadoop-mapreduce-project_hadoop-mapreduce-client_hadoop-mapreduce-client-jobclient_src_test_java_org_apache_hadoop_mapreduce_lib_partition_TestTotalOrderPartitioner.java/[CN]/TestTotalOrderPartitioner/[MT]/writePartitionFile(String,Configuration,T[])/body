{
  final FileSystem fs=FileSystem.getLocal(conf);
  final Path testdir=new Path(System.getProperty("test.build.data","/tmp")).makeQualified(fs.getUri(),fs.getWorkingDirectory());
  Path p=new Path(testdir,testname + "/_partition.lst");
  TotalOrderPartitioner.setPartitionFile(conf,p);
  conf.setInt(MRJobConfig.NUM_REDUCES,splits.length + 1);
  SequenceFile.Writer w=null;
  try {
    w=SequenceFile.createWriter(conf,SequenceFile.Writer.file(p),SequenceFile.Writer.keyClass(splits[0].getClass()),SequenceFile.Writer.valueClass(NullWritable.class),SequenceFile.Writer.compression(CompressionType.NONE));
    for (int i=0; i < splits.length; ++i) {
      w.append(splits[i],NullWritable.get());
    }
  }
  finally {
    if (null != w)     w.close();
  }
  return p;
}
