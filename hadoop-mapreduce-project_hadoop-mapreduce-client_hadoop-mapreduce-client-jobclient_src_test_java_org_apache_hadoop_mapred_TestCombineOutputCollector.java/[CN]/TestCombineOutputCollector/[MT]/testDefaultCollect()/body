{
  TaskReporter mockTaskReporter=mock(TaskReporter.class);
  @SuppressWarnings("unchecked") Writer<String,Integer> mockWriter=mock(Writer.class);
  Configuration conf=new Configuration();
  coc=new CombineOutputCollector<String,Integer>(outCounter,mockTaskReporter,conf);
  coc.setWriter(mockWriter);
  verify(mockTaskReporter,never()).progress();
  for (int i=0; i < Task.DEFAULT_COMBINE_RECORDS_BEFORE_PROGRESS; i++) {
    coc.collect("dummy",i);
  }
  verify(mockTaskReporter,times(1)).progress();
  for (int i=0; i < Task.DEFAULT_COMBINE_RECORDS_BEFORE_PROGRESS; i++) {
    coc.collect("dummy",i);
  }
  verify(mockTaskReporter,times(2)).progress();
}
