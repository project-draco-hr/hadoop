{
  RPC.setProtocolEngine(conf,CollectorNodemanagerProtocolPB.class,ProtobufRpcEngine.class);
  UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
  int expireIntvl=conf.getInt(NM_COMMAND_TIMEOUT,DEFAULT_COMMAND_TIMEOUT);
  proxy=(CollectorNodemanagerProtocolPB)RPC.getProxy(CollectorNodemanagerProtocolPB.class,clientVersion,addr,ugi,conf,NetUtils.getDefaultSocketFactory(conf),expireIntvl);
}
