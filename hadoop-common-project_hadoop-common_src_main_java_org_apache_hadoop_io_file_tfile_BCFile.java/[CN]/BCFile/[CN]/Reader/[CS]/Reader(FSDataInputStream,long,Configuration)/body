{
  this.in=fin;
  this.conf=conf;
  fin.seek(fileLength - Magic.size() - Version.size()- Long.SIZE / Byte.SIZE);
  long offsetIndexMeta=fin.readLong();
  version=new Version(fin);
  Magic.readAndVerify(fin);
  if (!version.compatibleWith(BCFile.API_VERSION)) {
    throw new RuntimeException("Incompatible BCFile fileBCFileVersion.");
  }
  fin.seek(offsetIndexMeta);
  metaIndex=new MetaIndex(fin);
  BlockReader blockR=getMetaBlock(DataIndex.BLOCK_NAME);
  try {
    dataIndex=new DataIndex(blockR);
  }
  finally {
    blockR.close();
  }
}
