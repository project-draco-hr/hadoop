def main(cfg, log):
    try:
        rm = None
        dGen = DescGenerator(cfg)
        cfg = dGen.initializeDesc()
        rm = RingMaster(cfg, log)
        rm.start()
        while (not rm.shouldStop()):
            time.sleep(1)
        rm.stop()
        log.debug('returning from main')
        return rm.getExitCode()
    except Exception as e:
        if log:
            log.critical(get_exception_string())
        raise Exception(e)
