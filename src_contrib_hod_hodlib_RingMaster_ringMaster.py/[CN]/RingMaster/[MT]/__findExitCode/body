def __findExitCode(self):
    'Determine the exit code based on the status of the cluster or jobs run on them'
    xmlrpcServer = ringMasterServer.instance.logMasterSources
    if ((xmlrpcServer.getServiceAddr('hdfs') == 'not found') or xmlrpcServer.getServiceAddr('hdfs').startswith('Error: ')):
        self.__exitCode = 7
    elif ((xmlrpcServer.getServiceAddr('mapred') == 'not found') or xmlrpcServer.getServiceAddr('mapred').startswith('Error: ')):
        self.__exitCode = 8
    else:
        clusterStatus = get_cluster_status(xmlrpcServer.getServiceAddr('hdfs'), xmlrpcServer.getServiceAddr('mapred'))
        if (clusterStatus != 0):
            self.__exitCode = clusterStatus
        else:
            self.__exitCode = self.__findHadoopJobsExitCode()
    self.log.debug(('exit code %s' % self.__exitCode))
