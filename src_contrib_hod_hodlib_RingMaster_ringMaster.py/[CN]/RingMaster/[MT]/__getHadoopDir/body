def __getHadoopDir(self):
    hadoopDir = None
    if self.cfg['ringmaster'].has_key('hadoop-tar-ball'):
        tarFile = os.path.join(os.getcwd(), self.basename)
        ret = untar(tarFile, os.getcwd())
        if (not ret):
            raise Exception(('Untarring tarfile %s to directory %s failed. Cannot find hadoop directory.' % (tarFile, os.getcwd())))
        hadoopDir = os.path.join(os.getcwd(), self.__get_dir(tarFile))
    else:
        hadoopDir = self.cfg['gridservice-mapred']['pkgs']
    self.log.debug(('Returning Hadoop directory as: %s' % hadoopDir))
    return hadoopDir
