{
  final int txIdsPerSegment=10;
  for (int txid=1; txid <= 5 * txIdsPerSegment; txid+=txIdsPerSegment) {
    writeSegment(cluster,qjm,txid,txIdsPerSegment,true);
  }
  File curDir=cluster.getCurrentDir(0,JID);
  GenericTestUtils.assertGlobEquals(curDir,"edits_.*",NNStorage.getFinalizedEditsFileName(1,10),NNStorage.getFinalizedEditsFileName(11,20),NNStorage.getFinalizedEditsFileName(21,30),NNStorage.getFinalizedEditsFileName(31,40),NNStorage.getFinalizedEditsFileName(41,50));
  ArrayList<EditLogInputStream> streams=new ArrayList<EditLogInputStream>();
  qjm.selectInputStreams(streams,25,false,false);
  verifyEdits(streams,25,50);
}
