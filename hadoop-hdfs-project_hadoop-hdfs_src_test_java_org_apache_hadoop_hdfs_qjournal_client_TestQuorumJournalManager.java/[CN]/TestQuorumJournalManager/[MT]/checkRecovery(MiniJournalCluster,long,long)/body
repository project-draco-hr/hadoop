{
  int numFinalized=0;
  for (int i=0; i < cluster.getNumNodes(); i++) {
    File logDir=cluster.getCurrentDir(i,JID);
    EditLogFile elf=FileJournalManager.getLogFile(logDir,segmentTxId);
    if (elf == null) {
      continue;
    }
    if (!elf.isInProgress()) {
      numFinalized++;
      if (elf.getLastTxId() != expectedEndTxId) {
        fail("File " + elf + " finalized to wrong txid, expected "+ expectedEndTxId);
      }
    }
  }
  if (numFinalized < cluster.getQuorumSize()) {
    fail("Did not find a quorum of finalized logs starting at " + segmentTxId);
  }
}
