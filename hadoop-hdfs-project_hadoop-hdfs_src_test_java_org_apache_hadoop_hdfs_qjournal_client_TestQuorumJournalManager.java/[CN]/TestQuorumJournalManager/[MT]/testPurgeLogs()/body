{
  for (int txid=1; txid <= 5; txid++) {
    writeSegment(cluster,qjm,txid,1,true);
  }
  File curDir=cluster.getCurrentDir(0,JID);
  GenericTestUtils.assertGlobEquals(curDir,"edits_.*",NNStorage.getFinalizedEditsFileName(1,1),NNStorage.getFinalizedEditsFileName(2,2),NNStorage.getFinalizedEditsFileName(3,3),NNStorage.getFinalizedEditsFileName(4,4),NNStorage.getFinalizedEditsFileName(5,5));
  File paxosDir=new File(curDir,"paxos");
  GenericTestUtils.assertExists(paxosDir);
  assertTrue(new File(paxosDir,"1").createNewFile());
  assertTrue(new File(paxosDir,"3").createNewFile());
  GenericTestUtils.assertGlobEquals(paxosDir,"\\d+","1","3");
  assertTrue(new File(curDir,"edits_inprogress_0000000000000000001.epoch=140").createNewFile());
  assertTrue(new File(curDir,"edits_inprogress_0000000000000000002.empty").createNewFile());
  qjm.purgeLogsOlderThan(3);
  waitForAllPendingCalls(qjm.getLoggerSetForTests());
  GenericTestUtils.assertGlobEquals(curDir,"edits_.*",NNStorage.getFinalizedEditsFileName(3,3),NNStorage.getFinalizedEditsFileName(4,4),NNStorage.getFinalizedEditsFileName(5,5));
  GenericTestUtils.assertGlobEquals(paxosDir,"\\d+","3");
}
