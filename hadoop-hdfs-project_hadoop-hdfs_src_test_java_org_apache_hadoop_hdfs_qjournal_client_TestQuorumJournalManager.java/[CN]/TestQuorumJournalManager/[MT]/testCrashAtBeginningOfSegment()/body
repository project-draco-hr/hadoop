{
  writeSegment(cluster,qjm,1,3,true);
  waitForAllPendingCalls(qjm.getLoggerSetForTests());
  EditLogOutputStream stm=qjm.startLogSegment(4,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  try {
    waitForAllPendingCalls(qjm.getLoggerSetForTests());
  }
  finally {
    stm.abort();
  }
  qjm=closeLater(new QuorumJournalManager(conf,cluster.getQuorumJournalURI(JID),FAKE_NSINFO));
  qjm.recoverUnfinalizedSegments();
  checkRecovery(cluster,1,3);
  writeSegment(cluster,qjm,4,3,true);
}
