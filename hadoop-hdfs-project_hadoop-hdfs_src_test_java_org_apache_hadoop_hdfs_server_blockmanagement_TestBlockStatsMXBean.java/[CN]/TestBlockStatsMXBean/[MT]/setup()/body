{
  HdfsConfiguration conf=new HdfsConfiguration();
  cluster=null;
  StorageType[][] types=new StorageType[6][];
  for (int i=0; i < 3; i++) {
    types[i]=new StorageType[]{StorageType.RAM_DISK,StorageType.DISK};
  }
  for (int i=3; i < 5; i++) {
    types[i]=new StorageType[]{StorageType.RAM_DISK,StorageType.ARCHIVE};
  }
  types[5]=new StorageType[]{StorageType.RAM_DISK,StorageType.ARCHIVE,StorageType.ARCHIVE};
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(6).storageTypes(types).storagesPerDatanode(3).build();
  cluster.waitActive();
}
