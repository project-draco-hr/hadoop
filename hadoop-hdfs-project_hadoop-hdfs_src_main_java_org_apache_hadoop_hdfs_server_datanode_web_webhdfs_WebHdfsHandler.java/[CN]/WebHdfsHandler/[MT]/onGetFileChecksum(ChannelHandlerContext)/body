{
  MD5MD5CRC32FileChecksum checksum=null;
  final String nnId=params.namenodeId();
  DFSClient dfsclient=newDfsClient(nnId,conf);
  try {
    checksum=dfsclient.getFileChecksum(path,Long.MAX_VALUE);
    dfsclient.close();
    dfsclient=null;
  }
  finally {
    IOUtils.cleanup(LOG,dfsclient);
  }
  final byte[] js=JsonUtil.toJsonString(checksum).getBytes(Charsets.UTF_8);
  DefaultFullHttpResponse resp=new DefaultFullHttpResponse(HTTP_1_1,OK,Unpooled.wrappedBuffer(js));
  resp.headers().set(CONTENT_TYPE,APPLICATION_JSON_UTF8);
  resp.headers().set(CONTENT_LENGTH,js.length);
  resp.headers().set(CONNECTION,CLOSE);
  ctx.writeAndFlush(resp).addListener(ChannelFutureListener.CLOSE);
}
