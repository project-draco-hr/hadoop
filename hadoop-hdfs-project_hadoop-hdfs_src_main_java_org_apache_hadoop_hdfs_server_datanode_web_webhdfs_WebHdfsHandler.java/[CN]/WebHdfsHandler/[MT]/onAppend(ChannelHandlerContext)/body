{
  writeContinueHeader(ctx);
  final String nnId=params.namenodeId();
  final int bufferSize=params.bufferSize();
  DFSClient dfsClient=newDfsClient(nnId,conf);
  OutputStream out=dfsClient.append(path,bufferSize,null,null);
  DefaultHttpResponse resp=new DefaultHttpResponse(HTTP_1_1,OK);
  resp.headers().set(CONTENT_LENGTH,0);
  ctx.pipeline().replace(this,HdfsWriter.class.getSimpleName(),new HdfsWriter(dfsClient,out,resp));
}
