{
  ClientResponse response=mock(ClientResponse.class);
  if (hasRuntimeError) {
    doThrow(new ClientHandlerException(new ConnectException())).when(spyTimelineWriter).doPostingObject(any(TimelineEntities.class),any(String.class));
    return response;
  }
  doReturn(response).when(spyTimelineWriter).doPostingObject(any(TimelineEntities.class),any(String.class));
  when(response.getStatusInfo()).thenReturn(status);
  TimelinePutResponse.TimelinePutError error=new TimelinePutResponse.TimelinePutError();
  error.setEntityId("test entity id");
  error.setEntityType("test entity type");
  error.setErrorCode(TimelinePutResponse.TimelinePutError.IO_EXCEPTION);
  TimelinePutResponse putResponse=new TimelinePutResponse();
  if (hasError) {
    putResponse.addError(error);
  }
  when(response.getEntity(TimelinePutResponse.class)).thenReturn(putResponse);
  return response;
}
