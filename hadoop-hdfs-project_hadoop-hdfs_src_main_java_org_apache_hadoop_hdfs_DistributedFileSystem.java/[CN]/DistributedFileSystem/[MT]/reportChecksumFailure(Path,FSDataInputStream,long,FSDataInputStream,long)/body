{
  if (!(in instanceof DFSDataInputStream && sums instanceof DFSDataInputStream))   throw new IllegalArgumentException("Input streams must be types " + "of DFSDataInputStream");
  LocatedBlock lblocks[]=new LocatedBlock[2];
  DFSClient.DFSDataInputStream dfsIn=(DFSClient.DFSDataInputStream)in;
  ExtendedBlock dataBlock=dfsIn.getCurrentBlock();
  if (dataBlock == null) {
    LOG.error("Error: Current block in data stream is null! ");
    return false;
  }
  DatanodeInfo[] dataNode={dfsIn.getCurrentDatanode()};
  lblocks[0]=new LocatedBlock(dataBlock,dataNode);
  LOG.info("Found checksum error in data stream at block=" + dataBlock + " on datanode="+ dataNode[0].getName());
  DFSClient.DFSDataInputStream dfsSums=(DFSClient.DFSDataInputStream)sums;
  ExtendedBlock sumsBlock=dfsSums.getCurrentBlock();
  if (sumsBlock == null) {
    LOG.error("Error: Current block in checksum stream is null! ");
    return false;
  }
  DatanodeInfo[] sumsNode={dfsSums.getCurrentDatanode()};
  lblocks[1]=new LocatedBlock(sumsBlock,sumsNode);
  LOG.info("Found checksum error in checksum stream at block=" + sumsBlock + " on datanode="+ sumsNode[0].getName());
  dfs.reportChecksumFailure(f.toString(),lblocks);
  return true;
}
