{
  if (!(in instanceof HdfsDataInputStream && sums instanceof HdfsDataInputStream))   throw new IllegalArgumentException("Input streams must be types of HdfsDataInputStream");
  LocatedBlock lblocks[]=new LocatedBlock[2];
  HdfsDataInputStream dfsIn=(HdfsDataInputStream)in;
  ExtendedBlock dataBlock=dfsIn.getCurrentBlock();
  if (dataBlock == null) {
    LOG.error("Error: Current block in data stream is null! ");
    return false;
  }
  DatanodeInfo[] dataNode={dfsIn.getCurrentDatanode()};
  lblocks[0]=new LocatedBlock(dataBlock,dataNode);
  LOG.info("Found checksum error in data stream at block=" + dataBlock + " on datanode="+ dataNode[0]);
  HdfsDataInputStream dfsSums=(HdfsDataInputStream)sums;
  ExtendedBlock sumsBlock=dfsSums.getCurrentBlock();
  if (sumsBlock == null) {
    LOG.error("Error: Current block in checksum stream is null! ");
    return false;
  }
  DatanodeInfo[] sumsNode={dfsSums.getCurrentDatanode()};
  lblocks[1]=new LocatedBlock(sumsBlock,sumsNode);
  LOG.info("Found checksum error in checksum stream at block=" + sumsBlock + " on datanode="+ sumsNode[0]);
  dfs.reportChecksumFailure(f.toString(),lblocks);
  return true;
}
