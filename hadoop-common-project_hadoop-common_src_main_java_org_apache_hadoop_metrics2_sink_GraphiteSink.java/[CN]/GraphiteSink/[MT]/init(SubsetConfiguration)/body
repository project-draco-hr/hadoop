{
  String serverHost=conf.getString(SERVER_HOST_KEY);
  Integer serverPort=Integer.parseInt(conf.getString(SERVER_PORT_KEY));
  metricsPrefix=conf.getString(METRICS_PREFIX);
  if (metricsPrefix == null)   metricsPrefix="";
  try {
    socket=new Socket(serverHost,serverPort);
    writer=new OutputStreamWriter(socket.getOutputStream());
  }
 catch (  Exception e) {
    throw new MetricsException("Error creating connection, " + serverHost + ":"+ serverPort,e);
  }
}
