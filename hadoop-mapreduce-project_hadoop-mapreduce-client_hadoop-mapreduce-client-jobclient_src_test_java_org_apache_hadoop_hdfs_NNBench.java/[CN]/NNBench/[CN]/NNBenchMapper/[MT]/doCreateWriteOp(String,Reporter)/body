{
  FSDataOutputStream out;
  byte[] buffer=new byte[bytesToWrite];
  for (long l=0l; l < numberOfFiles; l++) {
    Path filePath=new Path(new Path(baseDir,dataDirName),name + "_" + l);
    boolean successfulOp=false;
    while (!successfulOp && numOfExceptions < MAX_OPERATION_EXCEPTIONS) {
      try {
        startTimeAL=System.currentTimeMillis();
        out=filesystem.create(filePath,true,512,replFactor,blkSize);
        out.write(buffer);
        totalTimeAL1+=(System.currentTimeMillis() - startTimeAL);
        startTimeAL=System.currentTimeMillis();
        out.close();
        totalTimeAL2+=(System.currentTimeMillis() - startTimeAL);
        successfulOp=true;
        successfulFileOps++;
        reporter.setStatus("Finish " + l + " files");
      }
 catch (      IOException e) {
        LOG.error("Exception recorded in op: Create/Write/Close, " + "file: \"" + filePath + "\"",e);
        numOfExceptions++;
      }
    }
  }
}
