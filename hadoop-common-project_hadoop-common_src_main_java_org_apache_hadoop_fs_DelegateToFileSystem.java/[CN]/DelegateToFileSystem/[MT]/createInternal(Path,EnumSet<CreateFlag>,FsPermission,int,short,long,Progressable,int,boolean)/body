{
  checkPath(f);
  if (!createParent) {
    final FileStatus stat=getFileStatus(f.getParent());
    if (stat == null) {
      throw new FileNotFoundException("Missing parent:" + f);
    }
    if (!stat.isDirectory()) {
      throw new ParentNotDirectoryException("parent is not a dir:" + f);
    }
  }
  return fsImpl.primitiveCreate(f,absolutePermission,flag,bufferSize,replication,blockSize,progress,bytesPerChecksum);
}
