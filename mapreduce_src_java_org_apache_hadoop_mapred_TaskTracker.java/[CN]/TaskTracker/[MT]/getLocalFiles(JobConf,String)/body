{
  String[] localDirs=conf.getLocalDirs();
  Path[] paths=new Path[localDirs.length];
  FileSystem localFs=FileSystem.getLocal(conf);
  boolean subdirNeeded=(subdir != null) && (subdir.length() > 0);
  for (int i=0; i < localDirs.length; i++) {
    paths[i]=(subdirNeeded) ? new Path(localDirs[i],subdir) : new Path(localDirs[i]);
    paths[i]=paths[i].makeQualified(localFs);
  }
  return paths;
}
