{
  if (taskStatus.getRunState() == TaskStatus.State.RUNNING || taskStatus.getRunState() == TaskStatus.State.COMMIT_PENDING || isCleaningup()) {
    wasKilled=true;
    if (wasFailure) {
      failures+=1;
    }
    if (runner != null) {
      runner.kill();
    }
    setTaskFailState(wasFailure);
  }
 else   if (taskStatus.getRunState() == TaskStatus.State.UNASSIGNED) {
    if (wasFailure) {
      failures+=1;
      taskStatus.setRunState(TaskStatus.State.FAILED);
    }
 else {
      taskStatus.setRunState(TaskStatus.State.KILLED);
    }
  }
  taskStatus.setFinishTime(System.currentTimeMillis());
  removeFromMemoryManager(task.getTaskID());
  releaseSlot();
  myInstrumentation.statusUpdate(task,taskStatus);
  notifyTTAboutTaskCompletion();
}
