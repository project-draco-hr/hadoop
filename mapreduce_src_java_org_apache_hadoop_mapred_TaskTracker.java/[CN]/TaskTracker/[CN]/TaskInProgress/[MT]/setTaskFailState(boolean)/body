{
  if (taskStatus.getRunState() == TaskStatus.State.FAILED_UNCLEAN) {
    taskStatus.setRunState(TaskStatus.State.FAILED);
  }
 else   if (taskStatus.getRunState() == TaskStatus.State.KILLED_UNCLEAN) {
    taskStatus.setRunState(TaskStatus.State.KILLED);
  }
 else   if (task.isMapOrReduce() && taskStatus.getPhase() != TaskStatus.Phase.CLEANUP) {
    if (wasFailure) {
      taskStatus.setRunState(TaskStatus.State.FAILED_UNCLEAN);
    }
 else {
      taskStatus.setRunState(TaskStatus.State.KILLED_UNCLEAN);
    }
  }
 else {
    if (wasFailure) {
      taskStatus.setRunState(TaskStatus.State.FAILED);
    }
 else {
      taskStatus.setRunState(TaskStatus.State.KILLED);
    }
  }
}
