{
  Configuration conf=new Configuration();
  conf.setLong(DFSConfigKeys.DFS_DATANODE_DU_RESERVED_KEY,100L);
  File volDir=new File(baseDir,"volume-0");
  volDir.mkdirs();
  FsVolumeImpl volume=new FsVolumeImpl(dataset,"storage-id",volDir,conf,StorageType.RAM_DISK);
  assertEquals("",100L,volume.getReserved());
  conf.setLong(DFSConfigKeys.DFS_DATANODE_DU_RESERVED_KEY + "." + StringUtils.toLowerCase(StorageType.RAM_DISK.toString()),1L);
  conf.setLong(DFSConfigKeys.DFS_DATANODE_DU_RESERVED_KEY + "." + StringUtils.toLowerCase(StorageType.SSD.toString()),2L);
  FsVolumeImpl volume1=new FsVolumeImpl(dataset,"storage-id",volDir,conf,StorageType.RAM_DISK);
  assertEquals("",1L,volume1.getReserved());
  FsVolumeImpl volume2=new FsVolumeImpl(dataset,"storage-id",volDir,conf,StorageType.SSD);
  assertEquals("",2L,volume2.getReserved());
  FsVolumeImpl volume3=new FsVolumeImpl(dataset,"storage-id",volDir,conf,StorageType.DISK);
  assertEquals("",100L,volume3.getReserved());
  FsVolumeImpl volume4=new FsVolumeImpl(dataset,"storage-id",volDir,conf,StorageType.DEFAULT);
  assertEquals("",100L,volume4.getReserved());
}
