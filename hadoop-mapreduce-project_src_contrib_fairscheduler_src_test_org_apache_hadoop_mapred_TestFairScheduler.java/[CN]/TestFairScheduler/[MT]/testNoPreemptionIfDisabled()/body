{
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<pool name=\"poolA\">");
  out.println("<minMaps>2</minMaps>");
  out.println("<minReduces>2</minReduces>");
  out.println("<minSharePreemptionTimeout>60</minSharePreemptionTimeout>");
  out.println("</pool>");
  out.println("<fairSharePreemptionTimeout>60</fairSharePreemptionTimeout>");
  out.println("</allocations>");
  out.close();
  scheduler.getPoolManager().reloadAllocs();
  JobInProgress job1=submitJob(JobStatus.RUNNING,10,10);
  checkAssignment("tt1","attempt_test_0001_m_000000_0 on tt1");
  checkAssignment("tt1","attempt_test_0001_r_000000_0 on tt1");
  checkAssignment("tt1","attempt_test_0001_m_000001_0 on tt1");
  checkAssignment("tt1","attempt_test_0001_r_000001_0 on tt1");
  advanceTime(100);
  checkAssignment("tt2","attempt_test_0001_m_000002_0 on tt2");
  checkAssignment("tt2","attempt_test_0001_r_000002_0 on tt2");
  checkAssignment("tt2","attempt_test_0001_m_000003_0 on tt2");
  checkAssignment("tt2","attempt_test_0001_r_000003_0 on tt2");
  advanceTime(10000);
  JobInProgress job2=submitJob(JobStatus.RUNNING,10,10,"poolA");
  advanceTime(61000);
  scheduler.preemptTasksIfNecessary();
  scheduler.update();
  assertEquals(4,job1.runningMaps());
  assertEquals(4,job1.runningReduces());
  assertNull(scheduler.assignTasks(tracker("tt1")));
  assertNull(scheduler.assignTasks(tracker("tt2")));
}
