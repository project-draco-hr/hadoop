{
  for (int map=0; map < maps.length; map++) {
    FakeTaskInProgress tip=(FakeTaskInProgress)maps[map];
    if (!tip.isRunning() && !tip.isComplete() && getLocalityLevel(tip,tts) < localityLevel) {
      TaskAttemptID attemptId=getTaskAttemptID(tip);
      JobSplit.TaskSplitMetaInfo split=JobSplit.EMPTY_TASK_SPLIT;
      Task task=new MapTask("",attemptId,0,split.getSplitIndex(),1){
        @Override public String toString(){
          return String.format("%s on %s",getTaskID(),tts.getTrackerName());
        }
      }
;
      runningMapTasks++;
      tip.createTaskAttempt(task,tts.getTrackerName());
      nonLocalRunningMaps.add(tip);
      taskTrackerManager.startTask(tts.getTrackerName(),task,tip);
      return task;
    }
  }
  return null;
}
