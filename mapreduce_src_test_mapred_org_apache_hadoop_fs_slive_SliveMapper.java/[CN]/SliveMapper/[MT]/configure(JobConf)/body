{
  try {
    filesystem=FileSystem.get(conf);
  }
 catch (  Exception e) {
    throw new RuntimeException("Unable to get the filesystem from provided configuration",e);
  }
  try {
    config=new ConfigExtractor(conf);
    Long rndSeed=config.getRandomSeed();
    if (rndSeed != null) {
      rnd=new Random(rndSeed);
    }
 else {
      rnd=new Random();
    }
    selector=new WeightSelector(config,rnd);
    ConfigExtractor.dumpOptions(config);
  }
 catch (  Exception e) {
    LOG.error("Unable to setup slive " + StringUtils.stringifyException(e));
    throw new RuntimeException("Unable to setup slive configuration",e);
  }
}
