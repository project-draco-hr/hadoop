{
  JobConf job=new JobConf();
  Path file=new Path(workDir,"test.txt");
  int seed=new Random().nextInt();
  Random random=new Random(seed);
  localFs.delete(workDir,true);
  FileInputFormat.setInputPaths(job,workDir);
  int numLinesPerMap=5;
  job.setInt("mapreduce.input.lineinputformat.linespermap",numLinesPerMap);
  for (int length=0; length < MAX_LENGTH; length+=random.nextInt(MAX_LENGTH / 10) + 1) {
    Writer writer=new OutputStreamWriter(localFs.create(file));
    try {
      for (int i=0; i < length; i++) {
        writer.write(Integer.toString(i));
        writer.write("\n");
      }
    }
  finally {
      writer.close();
    }
    checkFormat(job,numLinesPerMap);
  }
}
