{
  final NameNode nameNode=cluster.getNameNode();
  final FSNamesystem nameSystem=nameNode.getNamesystem();
  nameNode.reconfigureProperty(HADOOP_CALLER_CONTEXT_ENABLED_KEY,"text");
  assertEquals(HADOOP_CALLER_CONTEXT_ENABLED_KEY + " has wrong value",false,nameSystem.getCallerContextEnabled());
  assertEquals(HADOOP_CALLER_CONTEXT_ENABLED_KEY + " has wrong value",false,nameNode.getConf().getBoolean(HADOOP_CALLER_CONTEXT_ENABLED_KEY,HADOOP_CALLER_CONTEXT_ENABLED_DEFAULT));
  nameNode.reconfigureProperty(HADOOP_CALLER_CONTEXT_ENABLED_KEY,"true");
  assertEquals(HADOOP_CALLER_CONTEXT_ENABLED_KEY + " has wrong value",true,nameSystem.getCallerContextEnabled());
  assertEquals(HADOOP_CALLER_CONTEXT_ENABLED_KEY + " has wrong value",true,nameNode.getConf().getBoolean(HADOOP_CALLER_CONTEXT_ENABLED_KEY,HADOOP_CALLER_CONTEXT_ENABLED_DEFAULT));
  nameNode.reconfigureProperty(HADOOP_CALLER_CONTEXT_ENABLED_KEY,"false");
  assertEquals(HADOOP_CALLER_CONTEXT_ENABLED_KEY + " has wrong value",false,nameSystem.getCallerContextEnabled());
  assertEquals(HADOOP_CALLER_CONTEXT_ENABLED_KEY + " has wrong value",false,nameNode.getConf().getBoolean(HADOOP_CALLER_CONTEXT_ENABLED_KEY,HADOOP_CALLER_CONTEXT_ENABLED_DEFAULT));
  nameNode.reconfigureProperty(HADOOP_CALLER_CONTEXT_ENABLED_KEY,null);
  assertEquals(HADOOP_CALLER_CONTEXT_ENABLED_KEY + " has wrong value",false,nameSystem.getCallerContextEnabled());
  assertEquals(HADOOP_CALLER_CONTEXT_ENABLED_KEY + " has wrong value",null,nameNode.getConf().get(HADOOP_CALLER_CONTEXT_ENABLED_KEY));
}
