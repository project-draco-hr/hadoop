{
  final NameNode nameNode=cluster.getNameNode();
  final DatanodeManager datanodeManager=nameNode.namesystem.getBlockManager().getDatanodeManager();
  nameNode.reconfigureProperty(DFS_HEARTBEAT_INTERVAL_KEY,"" + 6);
  nameNode.reconfigureProperty(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY,"" + (10 * 60 * 1000));
  try {
    nameNode.reconfigureProperty(DFS_HEARTBEAT_INTERVAL_KEY,"text");
    fail("ReconfigurationException expected");
  }
 catch (  ReconfigurationException expected) {
    assertTrue(expected.getCause() instanceof NumberFormatException);
  }
  try {
    nameNode.reconfigureProperty(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY,"text");
    fail("ReconfigurationException expected");
  }
 catch (  ReconfigurationException expected) {
    assertTrue(expected.getCause() instanceof NumberFormatException);
  }
  assertEquals(DFS_HEARTBEAT_INTERVAL_KEY + " has wrong value",6,nameNode.getConf().getLong(DFS_HEARTBEAT_INTERVAL_KEY,DFS_HEARTBEAT_INTERVAL_DEFAULT));
  assertEquals(DFS_HEARTBEAT_INTERVAL_KEY + " has wrong value",6,datanodeManager.getHeartbeatInterval());
  assertEquals(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY + " has wrong value",10 * 60 * 1000,nameNode.getConf().getInt(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY,DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_DEFAULT));
  assertEquals(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY + " has wrong value",10 * 60 * 1000,datanodeManager.getHeartbeatRecheckInterval());
  nameNode.reconfigureProperty(DFS_HEARTBEAT_INTERVAL_KEY,null);
  nameNode.reconfigureProperty(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY,null);
  assertEquals(DFS_HEARTBEAT_INTERVAL_KEY + " has wrong value",null,nameNode.getConf().get(DFS_HEARTBEAT_INTERVAL_KEY));
  assertEquals(DFS_HEARTBEAT_INTERVAL_KEY + " has wrong value",DFS_HEARTBEAT_INTERVAL_DEFAULT,datanodeManager.getHeartbeatInterval());
  assertEquals(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY + " has wrong value",null,nameNode.getConf().get(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY));
  assertEquals(DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_KEY + " has wrong value",DFS_NAMENODE_HEARTBEAT_RECHECK_INTERVAL_DEFAULT,datanodeManager.getHeartbeatRecheckInterval());
}
