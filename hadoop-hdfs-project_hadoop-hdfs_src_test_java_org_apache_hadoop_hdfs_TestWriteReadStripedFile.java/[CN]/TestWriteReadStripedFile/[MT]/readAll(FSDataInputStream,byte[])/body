{
  int readLen=0;
  int ret;
  do {
    ret=in.read(buf,readLen,buf.length - readLen);
    if (ret > 0) {
      readLen+=ret;
    }
  }
 while (ret >= 0 && readLen < buf.length);
  return readLen;
}
