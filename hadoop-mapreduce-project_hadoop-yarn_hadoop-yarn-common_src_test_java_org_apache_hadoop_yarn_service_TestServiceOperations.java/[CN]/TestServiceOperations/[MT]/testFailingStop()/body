{
  BreakableService svc=new BreakableService(false,false,true);
  ServiceOperations.deploy(svc,new Configuration());
  try {
    ServiceOperations.stop(svc);
    fail("Expected a failure, got " + svc);
  }
 catch (  BreakableService.BrokenLifecycleEvent e) {
  }
  assertStateCount(svc,Service.STATE.STOPPED,1);
  Exception exception=ServiceOperations.stopQuietly(svc);
  assertTrue("Wrong exception type : " + exception,exception instanceof BreakableService.BrokenLifecycleEvent);
  assertStateCount(svc,Service.STATE.STOPPED,2);
}
