{
  ResourceRequestInfo resourceRequestInfo=get(priority,resourceName,execTypeReq.getExecutionType(),capability);
  if (resourceRequestInfo == null) {
    resourceRequestInfo=new ResourceRequestInfo(priority,resourceName,capability,relaxLocality);
    put(priority,resourceName,execTypeReq.getExecutionType(),capability,resourceRequestInfo);
  }
  resourceRequestInfo.remoteRequest.setExecutionTypeRequest(execTypeReq);
  resourceRequestInfo.remoteRequest.setNumContainers(resourceRequestInfo.remoteRequest.getNumContainers() + 1);
  if (relaxLocality) {
    resourceRequestInfo.containerRequests.add(req);
  }
  if (ResourceRequest.ANY.equals(resourceName)) {
    resourceRequestInfo.remoteRequest.setNodeLabelExpression(labelExpression);
  }
  return resourceRequestInfo;
}
