{
  Configuration conf=new YarnConfiguration();
  conf.setBoolean(YarnConfiguration.RM_HA_ENABLED,true);
  conf.set(YarnConfiguration.RM_HA_IDS,rmIds);
  conf.setBoolean(YarnConfiguration.RECOVERY_ENABLED,true);
  conf.set(YarnConfiguration.RM_STORE,ZKRMStateStore.class.getName());
  conf.set(YarnConfiguration.RM_ZK_ADDRESS,curatorTestingServer.getConnectString());
  conf.setInt(YarnConfiguration.RM_ZK_TIMEOUT_MS,ZK_TIMEOUT_MS);
  conf.set(YarnConfiguration.RM_HA_ID,rmId);
  conf.set(YarnConfiguration.RM_WEBAPP_ADDRESS,"localhost:0");
  for (  String rpcAddress : YarnConfiguration.getServiceAddressConfKeys(conf)) {
    for (    String id : HAUtil.getRMHAIds(conf)) {
      conf.set(HAUtil.addSuffix(rpcAddress,id),"localhost:0");
    }
  }
  conf.set(HAUtil.addSuffix(YarnConfiguration.RM_ADMIN_ADDRESS,rmId),"localhost:" + adminPort);
  return conf;
}
