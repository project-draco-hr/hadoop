{
  TestZKRMStateStoreTester zkTester=new TestZKRMStateStoreTester(){
    Version VERSION_INFO=Version.newInstance(Integer.MAX_VALUE,0);
    @Override public Version getCurrentVersion() throws Exception {
      return VERSION_INFO;
    }
    @Override public RMStateStore getRMStateStore() throws Exception {
      YarnConfiguration conf=new YarnConfiguration();
      workingZnode="/jira/issue/3077/rmstore";
      conf.set(YarnConfiguration.RM_ZK_ADDRESS,hostPort);
      conf.set(YarnConfiguration.ZK_RM_STATE_STORE_PARENT_PATH,workingZnode);
      this.client=createClient();
      this.store=new TestZKRMStateStoreInternal(conf,workingZnode){
        Version storedVersion=null;
        @Override public Version getCurrentVersion(){
          return VERSION_INFO;
        }
        @Override protected synchronized Version loadVersion() throws Exception {
          return storedVersion;
        }
        @Override protected synchronized void storeVersion() throws Exception {
          storedVersion=VERSION_INFO;
        }
      }
;
      return this.store;
    }
  }
;
  RMStateStore store=zkTester.getRMStateStore();
  Version defaultVersion=zkTester.getCurrentVersion();
  store.checkVersion();
  Assert.assertEquals(defaultVersion,store.loadVersion());
}
