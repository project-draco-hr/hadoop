{
  String fileName=jhFileName.substring(0,jhFileName.indexOf(JobHistoryUtils.JOB_HISTORY_FILE_EXTENSION));
  JobIndexInfo indexInfo=new JobIndexInfo();
  String[] jobDetails=fileName.split(DELIMITER);
  if (jobDetails.length != MAX_INDEX + 1) {
    throw new IOException("Failed to parse file: [" + jhFileName + "]. Expected "+ (MAX_INDEX + 1)+ "parts.");
  }
  JobID oldJobId=JobID.forName(decodeJobHistoryFileName(jobDetails[JOB_ID_INDEX]));
  JobId jobId=TypeConverter.toYarn(oldJobId);
  indexInfo.setJobId(jobId);
  indexInfo.setSubmitTime(Long.parseLong(decodeJobHistoryFileName(jobDetails[SUBMIT_TIME_INDEX])));
  indexInfo.setUser(decodeJobHistoryFileName(jobDetails[USER_INDEX]));
  indexInfo.setJobName(decodeJobHistoryFileName(jobDetails[JOB_NAME_INDEX]));
  indexInfo.setFinishTime(Long.parseLong(decodeJobHistoryFileName(jobDetails[FINISH_TIME_INDEX])));
  indexInfo.setNumMaps(Integer.parseInt(decodeJobHistoryFileName(jobDetails[NUM_MAPS_INDEX])));
  indexInfo.setNumReduces(Integer.parseInt(decodeJobHistoryFileName(jobDetails[NUM_REDUCES_INDEX])));
  indexInfo.setJobStatus(decodeJobHistoryFileName(jobDetails[JOB_STATUS_INDEX]));
  return indexInfo;
}
