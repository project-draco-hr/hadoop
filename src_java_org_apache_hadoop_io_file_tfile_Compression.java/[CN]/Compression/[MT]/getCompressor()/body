{
  CompressionCodec codec=getCodec();
  if (codec != null) {
    Compressor compressor=CodecPool.getCompressor(codec);
    if (compressor != null) {
      if (compressor.finished()) {
        LOG.warn("Compressor obtained from CodecPool already finished()");
      }
 else {
        if (LOG.isDebugEnabled()) {
          LOG.debug("Got a compressor: " + compressor.hashCode());
        }
      }
      compressor.reset();
    }
    return compressor;
  }
  return null;
}
