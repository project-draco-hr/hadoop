{
  String aid=$(APPLICATION_ID);
  if (aid.isEmpty()) {
    puts("Bad request: requires Application ID");
    return;
  }
  ApplicationId appID=null;
  try {
    appID=Apps.toAppID(aid);
  }
 catch (  Exception e) {
    puts("Invalid Application ID: " + aid);
    return;
  }
  final ApplicationId appIDFinal=appID;
  UserGroupInformation callerUGI=getCallerUGI();
  ApplicationReport appReport;
  try {
    if (callerUGI == null) {
      appReport=appContext.getApplication(appID);
    }
 else {
      appReport=callerUGI.doAs(new PrivilegedExceptionAction<ApplicationReport>(){
        @Override public ApplicationReport run() throws Exception {
          return appContext.getApplication(appIDFinal);
        }
      }
);
    }
  }
 catch (  Exception e) {
    String message="Failed to read the application " + appID + ".";
    LOG.error(message,e);
    html.p()._(message)._();
    return;
  }
  if (appReport == null) {
    puts("Application not found: " + aid);
    return;
  }
  AppInfo app=new AppInfo(appReport);
  setTitle(join("Application ",aid));
  info("Application Overview")._("User:",app.getUser())._("Name:",app.getName())._("Application Type:",app.getType())._("State:",app.getAppState())._("FinalStatus:",app.getFinalAppStatus())._("Started:",Times.format(app.getStartedTime()))._("Elapsed:",StringUtils.formatTime(Times.elapsed(app.getStartedTime(),app.getFinishedTime())))._("Tracking URL:",app.getTrackingUrl() == null ? "#" : root_url(app.getTrackingUrl()),"History")._("Diagnostics:",app.getDiagnosticsInfo());
  html._(InfoBlock.class);
  Collection<ApplicationAttemptReport> attempts;
  try {
    if (callerUGI == null) {
      attempts=appContext.getApplicationAttempts(appID).values();
    }
 else {
      attempts=callerUGI.doAs(new PrivilegedExceptionAction<Collection<ApplicationAttemptReport>>(){
        @Override public Collection<ApplicationAttemptReport> run() throws Exception {
          return appContext.getApplicationAttempts(appIDFinal).values();
        }
      }
);
    }
  }
 catch (  Exception e) {
    String message="Failed to read the attempts of the application " + appID + ".";
    LOG.error(message,e);
    html.p()._(message)._();
    return;
  }
  TBODY<TABLE<Hamlet>> tbody=html.table("#attempts").thead().tr().th(".id","Attempt ID").th(".started","Started").th(".node","Node").th(".logs","Logs")._()._().tbody();
  StringBuilder attemptsTableData=new StringBuilder("[\n");
  for (  final ApplicationAttemptReport appAttemptReport : attempts) {
    AppAttemptInfo appAttempt=new AppAttemptInfo(appAttemptReport);
    ContainerReport containerReport;
    try {
      if (callerUGI == null) {
        containerReport=appContext.getAMContainer(appAttemptReport.getApplicationAttemptId());
      }
 else {
        containerReport=callerUGI.doAs(new PrivilegedExceptionAction<ContainerReport>(){
          @Override public ContainerReport run() throws Exception {
            return appContext.getAMContainer(appAttemptReport.getApplicationAttemptId());
          }
        }
);
      }
    }
 catch (    Exception e) {
      String message="Failed to read the AM container of the application attempt " + appAttemptReport.getApplicationAttemptId() + ".";
      LOG.error(message,e);
      html.p()._(message)._();
      return;
    }
    long startTime=Long.MAX_VALUE;
    String logsLink=null;
    if (containerReport != null) {
      ContainerInfo container=new ContainerInfo(containerReport);
      startTime=container.getStartedTime();
      logsLink=containerReport.getLogUrl();
    }
    String nodeLink=null;
    if (appAttempt.getHost() != null && appAttempt.getRpcPort() >= 0 && appAttempt.getRpcPort() < 65536) {
      nodeLink=appAttempt.getHost() + ":" + appAttempt.getRpcPort();
    }
    attemptsTableData.append("[\"<a href='").append(url("appattempt",appAttempt.getAppAttemptId())).append("'>").append(appAttempt.getAppAttemptId()).append("</a>\",\"").append(startTime).append("\",\"<a href='").append(nodeLink == null ? "#" : url("//",nodeLink)).append("'>").append(nodeLink == null ? "N/A" : StringEscapeUtils.escapeJavaScript(StringEscapeUtils.escapeHtml(nodeLink))).append("</a>\",\"<a href='").append(logsLink == null ? "#" : logsLink).append("'>").append(logsLink == null ? "N/A" : "Logs").append("</a>\"],\n");
  }
  if (attemptsTableData.charAt(attemptsTableData.length() - 2) == ',') {
    attemptsTableData.delete(attemptsTableData.length() - 2,attemptsTableData.length() - 1);
  }
  attemptsTableData.append("]");
  html.script().$type("text/javascript")._("var attemptsTableData=" + attemptsTableData)._();
  tbody._()._();
}
