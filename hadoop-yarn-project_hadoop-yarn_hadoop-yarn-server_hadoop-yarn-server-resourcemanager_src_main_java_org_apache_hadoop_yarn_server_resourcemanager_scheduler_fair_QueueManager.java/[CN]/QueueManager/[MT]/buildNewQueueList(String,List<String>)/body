{
  newQueueNames.add(name);
  int sepIndex=name.length();
  FSParentQueue parent=null;
  while (sepIndex != -1) {
    int prevSepIndex=sepIndex;
    sepIndex=name.lastIndexOf('.',sepIndex - 1);
    String node=name.substring(sepIndex + 1,prevSepIndex);
    if (!isQueueNameValid(node)) {
      throw new InvalidQueueNameException("Illegal node name at offset " + (sepIndex + 1) + " for queue name "+ name);
    }
    String curName=name.substring(0,sepIndex);
    FSQueue queue=queues.get(curName);
    if (queue == null) {
      newQueueNames.add(0,curName);
    }
 else {
      if (queue instanceof FSParentQueue) {
        parent=(FSParentQueue)queue;
      }
      break;
    }
  }
  return parent;
}
