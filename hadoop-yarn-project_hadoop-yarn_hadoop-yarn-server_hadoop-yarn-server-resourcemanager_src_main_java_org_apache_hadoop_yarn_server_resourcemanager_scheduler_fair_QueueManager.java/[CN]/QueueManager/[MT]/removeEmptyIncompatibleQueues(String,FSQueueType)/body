{
  queueToCreate=ensureRootPrefix(queueToCreate);
  if (queueToCreate.equals(ROOT_QUEUE) || queueToCreate.startsWith(ROOT_QUEUE + "." + YarnConfiguration.DEFAULT_QUEUE_NAME+ ".")) {
    return false;
  }
  FSQueue queue=queues.get(queueToCreate);
  if (queue != null) {
    if (queue instanceof FSLeafQueue) {
      if (queueType == FSQueueType.LEAF) {
        return true;
      }
      return removeQueueIfEmpty(queue);
    }
 else {
      if (queueType == FSQueueType.PARENT) {
        return true;
      }
      return removeQueueIfEmpty(queue);
    }
  }
  int sepIndex=queueToCreate.length();
  sepIndex=queueToCreate.lastIndexOf('.',sepIndex - 1);
  while (sepIndex != -1) {
    String prefixString=queueToCreate.substring(0,sepIndex);
    FSQueue prefixQueue=queues.get(prefixString);
    if (prefixQueue != null && prefixQueue instanceof FSLeafQueue) {
      return removeQueueIfEmpty(prefixQueue);
    }
    sepIndex=queueToCreate.lastIndexOf('.',sepIndex - 1);
  }
  return true;
}
