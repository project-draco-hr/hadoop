{
  leafToCreate=ensureRootPrefix(leafToCreate);
  if (leafToCreate.equals(ROOT_QUEUE) || leafToCreate.startsWith(ROOT_QUEUE + "." + YarnConfiguration.DEFAULT_QUEUE_NAME+ ".")) {
    return false;
  }
  FSQueue queue=queues.get(leafToCreate);
  if (queue != null) {
    if (queue instanceof FSLeafQueue) {
      return true;
    }
 else {
      return removeQueueIfEmpty(queue);
    }
  }
  int sepIndex=leafToCreate.length();
  sepIndex=leafToCreate.lastIndexOf('.',sepIndex - 1);
  while (sepIndex != -1) {
    String prefixString=leafToCreate.substring(0,sepIndex);
    FSQueue prefixQueue=queues.get(prefixString);
    if (prefixQueue != null && prefixQueue instanceof FSLeafQueue) {
      return removeQueueIfEmpty(prefixQueue);
    }
    sepIndex=leafToCreate.lastIndexOf('.',sepIndex - 1);
  }
  return true;
}
