{
  for (  String name : queueConf.getQueueNames()) {
    if (removeEmptyIncompatibleQueues(name)) {
      getLeafQueue(name,true);
    }
  }
  for (  FSQueue queue : queues.values()) {
    FSQueueMetrics queueMetrics=queue.getMetrics();
    queueMetrics.setMinShare(queue.getMinShare());
    queueMetrics.setMaxShare(queue.getMaxShare());
    try {
      SchedulingPolicy policy=queueConf.getSchedulingPolicy(queue.getName());
      policy.initialize(scheduler.getClusterCapacity());
      queue.setPolicy(policy);
    }
 catch (    AllocationConfigurationException ex) {
      LOG.warn("Cannot apply configured scheduling policy to queue " + queue.getName(),ex);
    }
  }
}
