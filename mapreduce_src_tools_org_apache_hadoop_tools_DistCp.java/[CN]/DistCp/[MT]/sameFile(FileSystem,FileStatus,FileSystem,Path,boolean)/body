{
  FileStatus dststatus;
  try {
    dststatus=dstfs.getFileStatus(dstpath);
  }
 catch (  FileNotFoundException fnfe) {
    return false;
  }
  if (srcstatus.getLen() != dststatus.getLen()) {
    return false;
  }
  if (skipCRCCheck) {
    LOG.debug("Skipping the CRC check");
    return true;
  }
  final FileChecksum srccs;
  try {
    srccs=srcfs.getFileChecksum(srcstatus.getPath());
  }
 catch (  FileNotFoundException fnfe) {
    return true;
  }
  try {
    final FileChecksum dstcs=dstfs.getFileChecksum(dststatus.getPath());
    return srccs == null || dstcs == null || srccs.equals(dstcs);
  }
 catch (  FileNotFoundException fnfe) {
    return false;
  }
}
