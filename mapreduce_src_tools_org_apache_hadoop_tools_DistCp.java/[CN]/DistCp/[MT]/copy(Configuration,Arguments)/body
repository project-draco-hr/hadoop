{
  LOG.info("srcPaths=" + args.srcs);
  if (!args.dryrun || args.flags.contains(Options.UPDATE)) {
    LOG.info("destPath=" + args.dst);
  }
  JobConf job=createJobConf(conf);
  checkSrcPath(job,args.srcs);
  if (args.preservedAttributes != null) {
    job.set(PRESERVE_STATUS_LABEL,args.preservedAttributes);
  }
  if (args.mapredSslConf != null) {
    job.set("dfs.https.client.keystore.resource",args.mapredSslConf);
  }
  try {
    if (setup(conf,job,args)) {
      JobClient.runJob(job);
    }
    if (!args.dryrun) {
      finalize(conf,job,args.dst,args.preservedAttributes);
    }
  }
  finally {
    if (!args.dryrun) {
      fullyDelete(job.get(TMP_DIR_LABEL),job);
    }
    fullyDelete(job.get(JOB_DIR_LABEL),job);
  }
}
