{
  int numMaxMaps=new JobClient(jobConf).getClusterStatus().getMaxMapTasks();
  short replication=(short)Math.ceil(Math.sqrt(Math.min(numMaxMaps,numMaps)));
  FileSystem fs=srcfilelist.getFileSystem(conf);
  FileStatus srcStatus=fs.getFileStatus(srcfilelist);
  if (srcStatus.getReplication() < replication) {
    if (!fs.setReplication(srcfilelist,replication)) {
      throw new IOException("Unable to increase the replication of file " + srcfilelist);
    }
  }
}
