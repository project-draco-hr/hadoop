{
  if (presevedAttributes == null) {
    return;
  }
  EnumSet<FileAttribute> preseved=FileAttribute.parse(presevedAttributes);
  if (!preseved.contains(FileAttribute.USER) && !preseved.contains(FileAttribute.GROUP) && !preseved.contains(FileAttribute.PERMISSION)) {
    return;
  }
  FileSystem dstfs=destPath.getFileSystem(conf);
  Path dstdirlist=new Path(jobconf.get(DST_DIR_LIST_LABEL));
  SequenceFile.Reader in=null;
  try {
    in=new SequenceFile.Reader(dstdirlist.getFileSystem(jobconf),dstdirlist,jobconf);
    Text dsttext=new Text();
    FilePair pair=new FilePair();
    for (; in.next(dsttext,pair); ) {
      Path absdst=new Path(destPath,pair.output);
      updateDestStatus(pair.input,dstfs.getFileStatus(absdst),preseved,dstfs);
    }
  }
  finally {
    checkAndClose(in);
  }
}
