{
  final int maxRetries=job.getInt(FILE_RETRIES_LABEL,DEFAULT_FILE_RETRIES);
  final boolean saveUpdate=update;
  int retryCnt=1;
  for (; retryCnt <= maxRetries; retryCnt++) {
    try {
      copy(srcstat,relativedst,out,reporter);
      break;
    }
 catch (    IOException e) {
      LOG.warn("Copy of " + srcstat.getPath() + " failed.",e);
      if (retryCnt < maxRetries) {
        LOG.info("Retrying copy of file " + srcstat.getPath());
        update=true;
      }
 else {
        update=saveUpdate;
        throw new IOException("Copy of file failed even with " + retryCnt + " tries.",e);
      }
    }
  }
}
