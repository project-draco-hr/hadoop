{
  FSDataInputStream in=null;
  FSDataOutputStream out=null;
  long bytesCopied=0L;
  try {
    Path srcPath=srcstat.getPath();
    in=srcPath.getFileSystem(job).open(srcPath);
    reporter.incrCounter(Counter.BYTESEXPECTED,srcstat.getLen());
    out=create(tmpfile,reporter,srcstat);
    LOG.info("Copying file " + srcPath + " of size "+ srcstat.getLen()+ " bytes...");
    for (int bytesRead; (bytesRead=in.read(buffer)) >= 0; ) {
      out.write(buffer,0,bytesRead);
      bytesCopied+=bytesRead;
      reporter.setStatus(String.format("%.2f ",bytesCopied * 100.0 / srcstat.getLen()) + absdst + " [ "+ StringUtils.humanReadableInt(bytesCopied)+ " / "+ StringUtils.humanReadableInt(srcstat.getLen())+ " ]");
    }
  }
  finally {
    checkAndClose(in);
    checkAndClose(out);
  }
  return bytesCopied;
}
