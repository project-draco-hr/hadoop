{
  FSDataOutputStream appendStream=null;
  try {
    int baseDataSize=50;
    byte[] baseDataBuffer=createBaseFileWithData(baseDataSize,TEST_PATH);
    int appendDataSize=20;
    byte[] appendDataBuffer=getTestData(appendDataSize);
    appendStream=fs.append(TEST_PATH,10);
    appendStream.write(appendDataBuffer);
    appendStream.close();
    byte[] testData=new byte[baseDataSize + appendDataSize];
    System.arraycopy(baseDataBuffer,0,testData,0,baseDataSize);
    System.arraycopy(appendDataBuffer,0,testData,baseDataSize,appendDataSize);
    Assert.assertTrue(verifyAppend(testData,TEST_PATH));
  }
  finally {
    if (appendStream != null) {
      appendStream.close();
    }
  }
}
