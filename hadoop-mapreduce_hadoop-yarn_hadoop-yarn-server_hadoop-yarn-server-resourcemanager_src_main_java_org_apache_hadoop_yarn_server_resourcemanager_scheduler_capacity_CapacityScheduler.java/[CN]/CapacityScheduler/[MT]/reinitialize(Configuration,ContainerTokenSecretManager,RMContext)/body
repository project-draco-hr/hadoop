{
  if (!initialized) {
    this.conf=new CapacitySchedulerConfiguration(conf);
    this.minimumAllocation=this.conf.getMinimumAllocation();
    this.maximumAllocation=this.conf.getMaximumAllocation();
    this.containerTokenSecretManager=containerTokenSecretManager;
    this.rmContext=rmContext;
    initializeQueues(this.conf);
    initialized=true;
  }
 else {
    CapacitySchedulerConfiguration oldConf=this.conf;
    this.conf=new CapacitySchedulerConfiguration(conf);
    try {
      LOG.info("Re-initializing queues...");
      reinitializeQueues(this.conf);
    }
 catch (    Throwable t) {
      this.conf=oldConf;
      throw new IOException("Failed to re-init queues",t);
    }
  }
}
