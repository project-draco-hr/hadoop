{
  this.in=in;
  this.version=in.readLine();
  if (!EventWriter.VERSION.equals(version)) {
    throw new IOException("Incompatible event log version: " + version);
  }
  this.schema=Schema.parse(in.readLine());
  this.reader=new SpecificDatumReader(schema);
  this.decoder=new JsonDecoder(schema,in);
}
