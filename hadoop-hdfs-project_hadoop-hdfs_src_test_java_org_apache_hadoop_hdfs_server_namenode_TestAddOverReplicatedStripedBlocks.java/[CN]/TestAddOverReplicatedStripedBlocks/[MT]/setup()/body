{
  Configuration conf=new Configuration();
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,BLOCK_SIZE);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_REPLICATION_MAX_STREAMS_KEY,0);
  conf.setInt(DFSConfigKeys.DFS_NAMENODE_REPLICATION_INTERVAL_KEY,1);
  conf.setInt(DFSConfigKeys.DFS_HEARTBEAT_INTERVAL_KEY,1);
  SimulatedFSDataset.setFactory(conf);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDNs).build();
  cluster.waitActive();
  fs=cluster.getFileSystem();
  fs.mkdirs(dirPath);
  fs.getClient().setErasureCodingPolicy(dirPath.toString(),null);
}
