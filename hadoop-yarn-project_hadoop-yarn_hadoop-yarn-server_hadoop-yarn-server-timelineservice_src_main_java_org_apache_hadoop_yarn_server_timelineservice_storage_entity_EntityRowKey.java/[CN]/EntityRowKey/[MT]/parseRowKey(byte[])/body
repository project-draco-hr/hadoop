{
  byte[][] rowKeyComponents=Separator.QUALIFIERS.split(rowKey);
  if (rowKeyComponents.length < 7) {
    throw new IllegalArgumentException("the row key is not valid for " + "an entity");
  }
  String userId=Separator.QUALIFIERS.decode(Bytes.toString(rowKeyComponents[0]));
  String clusterId=Separator.QUALIFIERS.decode(Bytes.toString(rowKeyComponents[1]));
  String flowId=Separator.QUALIFIERS.decode(Bytes.toString(rowKeyComponents[2]));
  long flowRunId=TimelineStorageUtils.invertLong(Bytes.toLong(rowKeyComponents[3]));
  String appId=TimelineStorageUtils.decodeAppId(rowKeyComponents[4]);
  String entityType=Separator.QUALIFIERS.decode(Bytes.toString(rowKeyComponents[5]));
  String entityId=Separator.QUALIFIERS.decode(Bytes.toString(rowKeyComponents[6]));
  return new EntityRowKey(clusterId,userId,flowId,flowRunId,appId,entityType,entityId);
}
