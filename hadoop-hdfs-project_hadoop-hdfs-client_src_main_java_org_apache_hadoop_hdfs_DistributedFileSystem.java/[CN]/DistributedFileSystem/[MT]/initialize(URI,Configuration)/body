{
  super.initialize(uri,conf);
  setConf(conf);
  String host=uri.getHost();
  if (host == null) {
    throw new IOException("Incomplete HDFS URI, no host: " + uri);
  }
  homeDirPrefix=conf.get(HdfsClientConfigKeys.DFS_USER_HOME_DIR_PREFIX_KEY,HdfsClientConfigKeys.DFS_USER_HOME_DIR_PREFIX_DEFAULT);
  this.dfs=new DFSClient(uri,conf,statistics);
  this.uri=URI.create(uri.getScheme() + "://" + uri.getAuthority());
  this.workingDir=getHomeDirectory();
  storageStatistics=(DFSOpsCountStatistics)GlobalStorageStatistics.INSTANCE.put(DFSOpsCountStatistics.NAME,new StorageStatisticsProvider(){
    @Override public StorageStatistics provide(){
      return new DFSOpsCountStatistics();
    }
  }
);
}
