{
  String src=getPathName(p);
  DirectoryListing thisListing=dfs.listPaths(src,HdfsFileStatus.EMPTY_NAME);
  if (thisListing == null) {
    throw new FileNotFoundException("File " + p + " does not exist.");
  }
  HdfsFileStatus[] partialListing=thisListing.getPartialListing();
  if (!thisListing.hasMore()) {
    FileStatus[] stats=new FileStatus[partialListing.length];
    for (int i=0; i < partialListing.length; i++) {
      stats[i]=partialListing[i].makeQualified(getUri(),p);
    }
    statistics.incrementReadOps(1);
    return stats;
  }
  int totalNumEntries=partialListing.length + thisListing.getRemainingEntries();
  ArrayList<FileStatus> listing=new ArrayList<>(totalNumEntries);
  for (  HdfsFileStatus fileStatus : partialListing) {
    listing.add(fileStatus.makeQualified(getUri(),p));
  }
  statistics.incrementLargeReadOps(1);
  do {
    thisListing=dfs.listPaths(src,thisListing.getLastName());
    if (thisListing == null) {
      throw new FileNotFoundException("File " + p + " does not exist.");
    }
    partialListing=thisListing.getPartialListing();
    for (    HdfsFileStatus fileStatus : partialListing) {
      listing.add(fileStatus.makeQualified(getUri(),p));
    }
    statistics.incrementLargeReadOps(1);
  }
 while (thisListing.hasMore());
  return listing.toArray(new FileStatus[listing.size()]);
}
