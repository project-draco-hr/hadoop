{
  long fileCount=fsn.getTotalFiles();
  Preconditions.checkState(fileCount == 1,"FSImage.format should be called with an uninitialized namesystem, has " + fileCount + " files");
  blockIdGenerator=createBlockIdGenerator(fsn);
  NamespaceInfo ns=NNStorage.newNamespaceInfo();
  ns.clusterID=clusterId;
  storage.format(ns);
  editLog.formatNonFileJournals(ns);
  saveFSImageInAllDirs(fsn,0);
}
