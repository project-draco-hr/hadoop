{
  long fileCount=fsn.getTotalFiles();
  Preconditions.checkState(fileCount == 1,"FSImage.format should be called with an uninitialized namesystem, has " + fileCount + " files");
  NamespaceInfo ns=NNStorage.newNamespaceInfo();
  LOG.info("Allocated new BlockPoolId: " + ns.getBlockPoolID());
  ns.clusterID=clusterId;
  storage.format(ns);
  editLog.formatNonFileJournals(ns);
  saveFSImageInAllDirs(fsn,0);
}
