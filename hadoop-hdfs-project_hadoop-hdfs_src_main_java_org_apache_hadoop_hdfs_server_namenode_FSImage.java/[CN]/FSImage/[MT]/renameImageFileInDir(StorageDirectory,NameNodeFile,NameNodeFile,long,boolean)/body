{
  final File fromFile=NNStorage.getStorageFile(sd,fromNnf,txid);
  final File toFile=NNStorage.getStorageFile(sd,toNnf,txid);
  if (LOG.isDebugEnabled()) {
    LOG.debug("renaming  " + fromFile.getAbsolutePath() + " to "+ toFile.getAbsolutePath());
  }
  if (!fromFile.renameTo(toFile)) {
    if (!toFile.delete() || !fromFile.renameTo(toFile)) {
      throw new IOException("renaming  " + fromFile.getAbsolutePath() + " to "+ toFile.getAbsolutePath()+ " FAILED");
    }
  }
  if (renameMD5) {
    MD5FileUtils.renameMD5File(fromFile,toFile);
  }
}
