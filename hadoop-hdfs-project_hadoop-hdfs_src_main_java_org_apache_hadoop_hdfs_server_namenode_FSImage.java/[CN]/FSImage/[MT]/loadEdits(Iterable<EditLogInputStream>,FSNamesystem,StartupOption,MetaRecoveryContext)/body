{
  LOG.debug("About to load edits:\n  " + Joiner.on("\n  ").join(editStreams));
  StartupProgress prog=NameNode.getStartupProgress();
  prog.beginPhase(Phase.LOADING_EDITS);
  long prevLastAppliedTxId=lastAppliedTxId;
  try {
    FSEditLogLoader loader=new FSEditLogLoader(target,lastAppliedTxId);
    for (    EditLogInputStream editIn : editStreams) {
      LOG.info("Reading " + editIn + " expecting start txid #"+ (lastAppliedTxId + 1));
      try {
        loader.loadFSEdits(editIn,lastAppliedTxId + 1,startOpt,recovery);
      }
  finally {
        lastAppliedTxId=loader.getLastAppliedTxId();
      }
      boolean rollingRollback=startOpt == StartupOption.ROLLINGUPGRADE && startOpt.getRollingUpgradeStartupOption() == RollingUpgradeStartupOption.ROLLBACK;
      if (editIn.getLastTxId() != HdfsConstants.INVALID_TXID && !rollingRollback) {
        lastAppliedTxId=editIn.getLastTxId();
      }
    }
  }
  finally {
    FSEditLog.closeAllStreams(editStreams);
    updateCountForQuota(target.dir.rootDir);
  }
  prog.endPhase(Phase.LOADING_EDITS);
  return lastAppliedTxId - prevLastAppliedTxId;
}
