{
  File newFile=NNStorage.getStorageFile(sd,NameNodeFile.IMAGE_NEW,txid);
  File dstFile=NNStorage.getStorageFile(sd,NameNodeFile.IMAGE,txid);
  FSImageFormat.Saver saver=new FSImageFormat.Saver();
  FSImageCompression compression=FSImageCompression.createCompression(conf);
  saver.save(newFile,txid,source,compression);
  MD5FileUtils.saveMD5File(dstFile,saver.getSavedDigest());
  storage.setMostRecentCheckpointTxId(txid);
}
