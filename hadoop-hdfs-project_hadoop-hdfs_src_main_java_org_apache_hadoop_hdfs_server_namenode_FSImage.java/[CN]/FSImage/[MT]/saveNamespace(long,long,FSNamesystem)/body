{
  if (timeWindow > 0 || txGap > 0) {
    final FSImageStorageInspector inspector=storage.readAndInspectDirs(EnumSet.of(NameNodeFile.IMAGE,NameNodeFile.IMAGE_ROLLBACK),StartupOption.REGULAR);
    FSImageFile image=inspector.getLatestImages().get(0);
    File imageFile=image.getFile();
    final long checkpointTxId=image.getCheckpointTxId();
    final long checkpointAge=Time.now() - imageFile.lastModified();
    if (checkpointAge <= timeWindow * 1000 && checkpointTxId >= this.getLastAppliedOrWrittenTxId() - txGap) {
      return false;
    }
  }
  saveNamespace(source,NameNodeFile.IMAGE,null);
  return true;
}
