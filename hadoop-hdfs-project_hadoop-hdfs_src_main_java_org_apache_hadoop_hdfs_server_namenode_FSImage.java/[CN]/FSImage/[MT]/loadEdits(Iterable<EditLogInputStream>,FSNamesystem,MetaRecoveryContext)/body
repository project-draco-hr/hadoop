{
  LOG.debug("About to load edits:\n  " + Joiner.on("\n  ").join(editStreams));
  long prevLastAppliedTxId=lastAppliedTxId;
  try {
    FSEditLogLoader loader=new FSEditLogLoader(target,lastAppliedTxId);
    for (    EditLogInputStream editIn : editStreams) {
      LOG.info("Reading " + editIn + " expecting start txid #"+ (lastAppliedTxId + 1));
      try {
        loader.loadFSEdits(editIn,lastAppliedTxId + 1,recovery);
      }
  finally {
        lastAppliedTxId=loader.getLastAppliedTxId();
      }
      if (editIn.getLastTxId() != HdfsConstants.INVALID_TXID) {
        lastAppliedTxId=editIn.getLastTxId();
      }
    }
  }
  finally {
    FSEditLog.closeAllStreams(editStreams);
    target.dir.updateCountForINodeWithQuota();
  }
  return lastAppliedTxId - prevLastAppliedTxId;
}
