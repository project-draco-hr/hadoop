{
  final long checkpointPeriod=conf.getTimeDuration(DFSConfigKeys.DFS_NAMENODE_CHECKPOINT_PERIOD_KEY,DFSConfigKeys.DFS_NAMENODE_CHECKPOINT_PERIOD_DEFAULT,TimeUnit.SECONDS);
  final long checkpointTxnCount=conf.getLong(DFSConfigKeys.DFS_NAMENODE_CHECKPOINT_TXNS_KEY,DFSConfigKeys.DFS_NAMENODE_CHECKPOINT_TXNS_DEFAULT);
  long checkpointAge=Time.now() - imageFile.lastModified();
  return (checkpointAge > checkpointPeriod * 1000) || (numEditsLoaded > checkpointTxnCount);
}
