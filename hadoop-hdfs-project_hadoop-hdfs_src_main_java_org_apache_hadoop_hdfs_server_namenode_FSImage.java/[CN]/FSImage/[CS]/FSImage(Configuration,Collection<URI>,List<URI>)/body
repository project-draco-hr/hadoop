{
  this.conf=conf;
  storage=new NNStorage(conf,imageDirs,editsDirs);
  if (conf.getBoolean(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_RESTORE_KEY,DFSConfigKeys.DFS_NAMENODE_NAME_DIR_RESTORE_DEFAULT)) {
    storage.setRestoreFailedStorage(true);
  }
  this.quotaInitThreads=conf.getInt(DFSConfigKeys.DFS_NAMENODE_QUOTA_INIT_THREADS_KEY,DFSConfigKeys.DFS_NAMENODE_QUOTA_INIT_THREADS_DEFAULT);
  this.editLog=new FSEditLog(conf,storage,editsDirs);
  archivalManager=new NNStorageRetentionManager(conf,storage,editLog);
}
