{
  this.conf=conf;
  storage=new NNStorage(conf,imageDirs,editsDirs);
  if (conf.getBoolean(DFSConfigKeys.DFS_NAMENODE_NAME_DIR_RESTORE_KEY,DFSConfigKeys.DFS_NAMENODE_NAME_DIR_RESTORE_DEFAULT)) {
    storage.setRestoreFailedStorage(true);
  }
  this.editLog=new FSEditLog(storage);
  archivalManager=new NNStorageRetentionManager(conf,storage,editLog);
}
