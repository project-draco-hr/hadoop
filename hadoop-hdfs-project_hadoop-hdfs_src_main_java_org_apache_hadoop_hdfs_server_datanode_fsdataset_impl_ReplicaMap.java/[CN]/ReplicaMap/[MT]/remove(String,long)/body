{
  checkBlockPool(bpid);
synchronized (mutex) {
    LightWeightResizableGSet<Block,ReplicaInfo> m=map.get(bpid);
    if (m != null) {
      return m.remove(new Block(blockId));
    }
  }
  return null;
}
