{
  checkBlockPool(bpid);
  try (AutoCloseableLock l=lock.acquire()){
    FoldedTreeSet<ReplicaInfo> set=map.get(bpid);
    if (set != null) {
      return set.removeAndGet(blockId,LONG_AND_BLOCK_COMPARATOR);
    }
  }
   return null;
}
