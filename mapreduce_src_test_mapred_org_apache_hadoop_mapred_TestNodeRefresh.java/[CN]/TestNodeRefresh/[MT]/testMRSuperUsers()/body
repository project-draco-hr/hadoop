{
  Configuration conf=new Configuration();
  conf.set(MRConfig.MR_SUPERGROUP,"supergroup");
  conf.set(MRConfig.MR_ADMINS,"user5 abc");
  startCluster(2,1,0,UserGroupInformation.createRemoteUser("user1"),conf);
  conf=mr.createJobConf(new JobConf(conf));
  AdminOperationsProtocol client=getClient(conf,user2);
  boolean success=false;
  try {
    client.refreshNodes();
    success=true;
  }
 catch (  IOException ioe) {
  }
  assertFalse("Invalid user performed privileged refresh operation",success);
  success=false;
  client=getClient(conf,user1);
  try {
    client.refreshNodes();
    success=true;
  }
 catch (  IOException ioe) {
  }
  assertTrue("Privileged user denied permission for refresh operation",success);
  success=false;
  client=getClient(conf,user3);
  try {
    client.refreshNodes();
    success=true;
  }
 catch (  IOException ioe) {
  }
  assertTrue("Admin group member denied permission for refresh operation",success);
  success=false;
  client=getClient(conf,user5);
  try {
    client.refreshNodes();
    success=true;
  }
 catch (  IOException ioe) {
  }
  assertTrue("Admin user denied permission for refresh operation",success);
  success=false;
  client=getClient(conf,user4);
  try {
    client.refreshNodes();
    success=true;
  }
 catch (  IOException ioe) {
  }
  assertTrue("Deprecated Super group member denied permission for refresh" + " operation",success);
  stopCluster();
}
