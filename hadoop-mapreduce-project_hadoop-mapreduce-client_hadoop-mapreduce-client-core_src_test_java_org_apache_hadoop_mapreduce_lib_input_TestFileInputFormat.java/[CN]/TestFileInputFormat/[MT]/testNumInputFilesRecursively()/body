{
  Configuration conf=getConfiguration();
  conf.set(FileInputFormat.INPUT_DIR_RECURSIVE,"true");
  Job job=Job.getInstance(conf);
  FileInputFormat<?,?> fileInputFormat=new TextInputFormat();
  List<InputSplit> splits=fileInputFormat.getSplits(job);
  Assert.assertEquals("Input splits are not correct",3,splits.size());
  Assert.assertEquals("test:/a1/a2/file2",((FileSplit)splits.get(0)).getPath().toString());
  Assert.assertEquals("test:/a1/a2/file3",((FileSplit)splits.get(1)).getPath().toString());
  Assert.assertEquals("test:/a1/file1",((FileSplit)splits.get(2)).getPath().toString());
  conf=getConfiguration();
  conf.set("mapred.input.dir.recursive","true");
  job=Job.getInstance(conf);
  splits=fileInputFormat.getSplits(job);
  Assert.assertEquals("Input splits are not correct",3,splits.size());
  Assert.assertEquals("test:/a1/a2/file2",((FileSplit)splits.get(0)).getPath().toString());
  Assert.assertEquals("test:/a1/a2/file3",((FileSplit)splits.get(1)).getPath().toString());
  Assert.assertEquals("test:/a1/file1",((FileSplit)splits.get(2)).getPath().toString());
}
