{
  Configuration conf=getConfiguration();
  conf.setBoolean("fs.test.impl.disable.cache",false);
  conf.set(FileInputFormat.INPUT_DIR,"test:///a1/a2");
  MockFileSystem mockFs=(MockFileSystem)new Path("test:///").getFileSystem(conf);
  Assert.assertEquals("listLocatedStatus already called",0,mockFs.numListLocatedStatusCalls);
  Job job=Job.getInstance(conf);
  FileInputFormat<?,?> fileInputFormat=new TextInputFormat();
  List<InputSplit> splits=fileInputFormat.getSplits(job);
  Assert.assertEquals("Input splits are not correct",2,splits.size());
  Assert.assertEquals("listLocatedStatuss calls",1,mockFs.numListLocatedStatusCalls);
}
