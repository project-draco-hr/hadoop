{
  LOG.info("Starting the cleanup phase.");
  for (  RecordFactory factory : reduces) {
    key.setSeed(r.nextLong());
    while (factory.next(key,val)) {
      context.progress();
      context.write(key,val);
      key.setSeed(r.nextLong());
      try {
        matcher.match();
      }
 catch (      Exception e) {
        LOG.debug("Error in resource usage emulation! Message: ",e);
      }
    }
  }
  if (context.getNumReduceTasks() > 0 && context.getCounter(TaskCounter.SPILLED_RECORDS).getValue() == 0) {
    LOG.info("Boosting the map phase progress.");
    matcher.boost(0.33f);
    matcher.match();
  }
  matcher.start();
}
