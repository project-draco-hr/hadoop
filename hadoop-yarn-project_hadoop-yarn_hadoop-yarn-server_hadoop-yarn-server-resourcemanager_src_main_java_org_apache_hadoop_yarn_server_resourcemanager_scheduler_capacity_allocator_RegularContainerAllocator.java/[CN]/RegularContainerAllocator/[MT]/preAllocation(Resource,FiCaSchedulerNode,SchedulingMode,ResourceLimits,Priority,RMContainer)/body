{
  ContainerAllocation result;
  if (null == reservedContainer) {
    result=preCheckForNewContainer(clusterResource,node,schedulingMode,resourceLimits,priority);
    if (null != result) {
      return result;
    }
  }
 else {
    if (application.getTotalRequiredResources(priority) == 0) {
      return new ContainerAllocation(reservedContainer,null,AllocationState.QUEUE_SKIPPED);
    }
  }
  result=assignContainersOnNode(clusterResource,node,priority,reservedContainer,schedulingMode,resourceLimits);
  if (null == reservedContainer) {
    if (result.state == AllocationState.PRIORITY_SKIPPED) {
      application.subtractSchedulingOpportunity(priority);
    }
  }
  return result;
}
