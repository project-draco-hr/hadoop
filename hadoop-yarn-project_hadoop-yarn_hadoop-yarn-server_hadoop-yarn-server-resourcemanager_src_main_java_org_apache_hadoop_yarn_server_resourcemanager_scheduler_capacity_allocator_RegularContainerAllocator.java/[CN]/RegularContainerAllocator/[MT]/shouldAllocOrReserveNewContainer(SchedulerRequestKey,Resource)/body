{
  int requiredContainers=application.getTotalRequiredResources(schedulerKey);
  int reservedContainers=application.getNumReservedContainers(schedulerKey);
  int starvation=0;
  if (reservedContainers > 0) {
    float nodeFactor=Resources.ratio(rc,required,application.getCSLeafQueue().getMaximumAllocation());
    starvation=(int)((application.getReReservations(schedulerKey) / (float)reservedContainers) * (1.0f - (Math.min(nodeFactor,application.getCSLeafQueue().getMinimumAllocationFactor()))));
    if (LOG.isDebugEnabled()) {
      LOG.debug("needsContainers:" + " app.#re-reserve=" + application.getReReservations(schedulerKey) + " reserved="+ reservedContainers+ " nodeFactor="+ nodeFactor+ " minAllocFactor="+ application.getCSLeafQueue().getMinimumAllocationFactor()+ " starvation="+ starvation);
    }
  }
  return (((starvation + requiredContainers) - reservedContainers) > 0);
}
