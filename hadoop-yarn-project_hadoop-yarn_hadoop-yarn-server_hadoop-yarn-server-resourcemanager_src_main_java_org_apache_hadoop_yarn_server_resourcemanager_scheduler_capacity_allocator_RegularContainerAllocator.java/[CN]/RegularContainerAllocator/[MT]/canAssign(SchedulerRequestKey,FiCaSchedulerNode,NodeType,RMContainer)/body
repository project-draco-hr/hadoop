{
  if (type == NodeType.OFF_SWITCH) {
    if (reservedContainer != null) {
      return true;
    }
    ResourceRequest offSwitchRequest=application.getResourceRequest(schedulerKey,ResourceRequest.ANY);
    long missedOpportunities=application.getSchedulingOpportunities(schedulerKey);
    long requiredContainers=offSwitchRequest.getNumContainers();
    float localityWaitFactor=getLocalityWaitFactor(schedulerKey,rmContext.getScheduler().getNumClusterNodes());
    return (Math.min(rmContext.getScheduler().getNumClusterNodes(),(requiredContainers * localityWaitFactor)) < missedOpportunities);
  }
  ResourceRequest rackLocalRequest=application.getResourceRequest(schedulerKey,node.getRackName());
  if (rackLocalRequest == null || rackLocalRequest.getNumContainers() <= 0) {
    return false;
  }
  if (type == NodeType.RACK_LOCAL) {
    long missedOpportunities=application.getSchedulingOpportunities(schedulerKey);
    return getActualNodeLocalityDelay() < missedOpportunities;
  }
  if (type == NodeType.NODE_LOCAL) {
    ResourceRequest nodeLocalRequest=application.getResourceRequest(schedulerKey,node.getNodeName());
    if (nodeLocalRequest != null) {
      return nodeLocalRequest.getNumContainers() > 0;
    }
  }
  return false;
}
