{
  active=conf.getBoolean(JTConfig.JT_PERSIST_JOBSTATUS,true);
  if (active) {
    retainTime=conf.getInt(JTConfig.JT_PERSIST_JOBSTATUS_HOURS,1) * HOUR;
    jobInfoDir=conf.get(JTConfig.JT_PERSIST_JOBSTATUS_DIR,JOB_INFO_STORE_DIR);
    Path path=new Path(jobInfoDir);
    this.fs=path.getFileSystem(conf);
    if (!fs.exists(path)) {
      if (!fs.mkdirs(path,new FsPermission(JOB_STATUS_STORE_DIR_PERMISSION))) {
        throw new IOException("CompletedJobStatusStore mkdirs failed to create " + path.toString());
      }
    }
 else {
      FileStatus stat=fs.getFileStatus(path);
      FsPermission actual=stat.getPermission();
      if (!stat.isDir())       throw new DiskErrorException("not a directory: " + path.toString());
      FsAction user=actual.getUserAction();
      if (!user.implies(FsAction.READ))       throw new DiskErrorException("directory is not readable: " + path.toString());
      if (!user.implies(FsAction.WRITE))       throw new DiskErrorException("directory is not writable: " + path.toString());
    }
    if (retainTime == 0) {
      deleteJobStatusDirs();
    }
    this.aclsManager=aclsManager;
    LOG.info("Completed job store activated/configured with retain-time : " + retainTime + " , job-info-dir : "+ jobInfoDir);
  }
 else {
    LOG.info("Completed job store is inactive");
  }
}
