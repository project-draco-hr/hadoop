{
  LOG.info("Recovering Reservation system");
  writeLock.lock();
  try {
    Map<String,Map<ReservationId,ReservationAllocationStateProto>> reservationSystemState=state.getReservationState();
    if (planFollower != null) {
      for (      String plan : plans.keySet()) {
        if (reservationSystemState.containsKey(plan)) {
          loadPlan(plan,reservationSystemState.get(plan));
        }
        synchronizePlan(plan,false);
      }
      startPlanFollower(conf.getLong(YarnConfiguration.RM_WORK_PRESERVING_RECOVERY_SCHEDULING_WAIT_MS,YarnConfiguration.DEFAULT_RM_WORK_PRESERVING_RECOVERY_SCHEDULING_WAIT_MS));
    }
  }
  finally {
    writeLock.unlock();
  }
}
