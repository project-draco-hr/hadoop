{
  String planQueuePath=getPlanQueuePath(planQueueName);
  SharingPolicy adPolicy=getAdmissionPolicy(planQueuePath);
  adPolicy.init(planQueuePath,getReservationSchedulerConfiguration());
  Resource minAllocation=getMinAllocation();
  Resource maxAllocation=getMaxAllocation();
  ResourceCalculator rescCalc=getResourceCalculator();
  Resource totCap=getPlanQueueCapacity(planQueueName);
  Plan plan=new InMemoryPlan(getRootQueueMetrics(),adPolicy,getAgent(planQueuePath),totCap,planStepSize,rescCalc,minAllocation,maxAllocation,planQueueName,getReplanner(planQueuePath),getReservationSchedulerConfiguration().getMoveOnExpiry(planQueuePath),rmContext);
  LOG.info("Initialized plan {} based on reservable queue {}",plan.toString(),planQueueName);
  return plan;
}
