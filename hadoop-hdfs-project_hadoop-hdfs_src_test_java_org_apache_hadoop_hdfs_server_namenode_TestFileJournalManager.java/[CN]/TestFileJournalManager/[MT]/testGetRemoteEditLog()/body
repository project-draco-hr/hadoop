{
  StorageDirectory sd=FSImageTestUtil.mockStorageDirectory(NameNodeDirType.EDITS,false,NNStorage.getFinalizedEditsFileName(1,100),NNStorage.getFinalizedEditsFileName(101,200),NNStorage.getInProgressEditsFileName(201),NNStorage.getFinalizedEditsFileName(1001,1100));
  FileJournalManager fjm=new FileJournalManager(conf,sd,null);
  assertEquals("[1,100],[101,200],[1001,1100]",getLogsAsString(fjm,1));
  assertEquals("[101,200],[1001,1100]",getLogsAsString(fjm,101));
  assertEquals("[1001,1100]",getLogsAsString(fjm,201));
  try {
    assertEquals("[]",getLogsAsString(fjm,150));
    fail("Did not throw when asking for a txn in the middle of a log");
  }
 catch (  IllegalStateException ioe) {
    GenericTestUtils.assertExceptionContains("150 which is in the middle",ioe);
  }
  assertEquals("Asking for a newer log than exists should return empty list","",getLogsAsString(fjm,9999));
}
