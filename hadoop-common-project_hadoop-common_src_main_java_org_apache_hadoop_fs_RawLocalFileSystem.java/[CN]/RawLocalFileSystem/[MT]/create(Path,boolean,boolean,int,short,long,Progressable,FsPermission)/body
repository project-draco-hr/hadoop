{
  if (exists(f) && !overwrite) {
    throw new FileAlreadyExistsException("File already exists: " + f);
  }
  Path parent=f.getParent();
  if (parent != null && !mkdirs(parent)) {
    throw new IOException("Mkdirs failed to create " + parent.toString());
  }
  return new FSDataOutputStream(new BufferedOutputStream(createOutputStreamWithMode(f,false,permission),bufferSize),statistics);
}
