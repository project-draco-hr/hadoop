{
  if (!exists(f)) {
    throw new FileNotFoundException("File " + f + " not found");
  }
  if (getFileStatus(f).isDirectory()) {
    throw new IOException("Cannot append to a diretory (=" + f + " )");
  }
  return new FSDataOutputStream(new BufferedOutputStream(createOutputStreamWithMode(f,true,null),bufferSize),statistics);
}
