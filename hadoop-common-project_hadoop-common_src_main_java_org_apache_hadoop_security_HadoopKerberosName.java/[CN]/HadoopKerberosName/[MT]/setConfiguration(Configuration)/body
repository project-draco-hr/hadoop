{
  final String defaultRule;
switch (SecurityUtil.getAuthenticationMethod(conf)) {
case KERBEROS:
case KERBEROS_SSL:
    try {
      KerberosUtil.getDefaultRealm();
    }
 catch (    Exception ke) {
      throw new IllegalArgumentException("Can't get Kerberos realm",ke);
    }
  defaultRule="DEFAULT";
break;
default :
defaultRule="RULE:[1:$1] RULE:[2:$1]";
break;
}
String ruleString=conf.get(HADOOP_SECURITY_AUTH_TO_LOCAL,defaultRule);
setRules(ruleString);
}
