{
  AbstractYarnScheduler scheduler=(AbstractYarnScheduler)rm.getResourceScheduler();
  SchedulerApplicationAttempt attempt=scheduler.getApplicationAttempt(attemptId);
  while (attempt == null) {
    System.out.println("Wait for scheduler attempt " + attemptId + " to be created");
    Thread.sleep(200);
    attempt=scheduler.getApplicationAttempt(attemptId);
  }
  while (attempt.getLiveContainers().size() < num) {
    System.out.println("Wait for " + num + " containers to recover.");
    Thread.sleep(200);
  }
}
