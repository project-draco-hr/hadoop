{
  conf.setBoolean(YarnConfiguration.RM_RESERVATION_SYSTEM_ENABLE,true);
  conf.setTimeDuration(YarnConfiguration.RM_RESERVATION_SYSTEM_PLAN_FOLLOWER_TIME_STEP,1L,TimeUnit.SECONDS);
  if (getSchedulerType() == SchedulerType.CAPACITY) {
    CapacitySchedulerConfiguration schedulerConf=new CapacitySchedulerConfiguration(conf);
    ReservationSystemTestUtil.setupDynamicQueueConfiguration(schedulerConf);
    return schedulerConf;
  }
 else {
    String allocFile=new File(FairSchedulerTestBase.TEST_DIR,TestWorkPreservingRMRestart.class.getSimpleName() + ".xml").getAbsolutePath();
    ReservationSystemTestUtil.setupFSAllocationFile(allocFile);
    conf.setClass(YarnConfiguration.RM_SCHEDULER,FairScheduler.class,ResourceScheduler.class);
    conf.set(FairSchedulerConfiguration.ALLOCATION_FILE,allocFile);
    return conf;
  }
}
