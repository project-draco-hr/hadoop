{
  checkCSLeafQueue(rm,app,clusterResource,queueResource,usedResource,numContainers);
  LeafQueue queue=(LeafQueue)app.getQueue();
  Resource availableResources=Resources.subtract(queueResource,usedResource);
  SchedulerApplicationAttempt schedulerAttempt=app.getCurrentAppAttempt();
  assertEquals(availableResources,schedulerAttempt.getHeadroom());
  QueueMetrics queueMetrics=queue.getMetrics();
  assertMetrics(queueMetrics,1,0,1,0,2,availableResources.getMemorySize(),availableResources.getVirtualCores(),usedResource.getMemorySize(),usedResource.getVirtualCores());
  QueueMetrics userMetrics=queueMetrics.getUserMetrics(app.getUser());
  assertMetrics(userMetrics,1,0,1,0,2,availableResources.getMemorySize(),availableResources.getVirtualCores(),usedResource.getMemorySize(),usedResource.getVirtualCores());
}
