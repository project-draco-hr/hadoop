{
  int retry=0;
  Resource assumedFairShare=Resource.newInstance(8192,8);
  while (true) {
    Thread.sleep(100);
    if (assumedFairShare.equals(((FairScheduler)rm.getResourceScheduler()).getQueueManager().getRootQueue().getFairShare())) {
      break;
    }
    retry++;
    if (retry > 30) {
      Assert.fail("Apps are not scheduled within assumed timeout");
    }
  }
  FairScheduler scheduler=(FairScheduler)rm.getResourceScheduler();
  FSParentQueue root=scheduler.getQueueManager().getRootQueue();
  assertTrue(root.getPolicy() instanceof DominantResourceFairnessPolicy);
  assertEquals(usedResources,root.getResourceUsage());
  FSAppAttempt schedulerAttempt=(FSAppAttempt)schedulerApp.getCurrentAppAttempt();
  assertEquals(availableResources,schedulerAttempt.getHeadroom());
  QueueMetrics queueMetrics=scheduler.getRootQueueMetrics();
  assertMetrics(queueMetrics,1,0,1,0,2,availableResources.getMemorySize(),availableResources.getVirtualCores(),usedResources.getMemorySize(),usedResources.getVirtualCores());
}
