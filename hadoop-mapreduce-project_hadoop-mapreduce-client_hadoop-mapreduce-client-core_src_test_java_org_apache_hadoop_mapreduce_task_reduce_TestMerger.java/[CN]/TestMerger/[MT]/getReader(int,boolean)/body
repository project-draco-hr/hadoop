{
  Reader<Text,Text> readerMock=mock(Reader.class);
  when(readerMock.getLength()).thenReturn(30l);
  when(readerMock.getPosition()).thenReturn(0l).thenReturn(10l).thenReturn(20l);
  when(readerMock.nextRawKey(any(DataInputBuffer.class))).thenAnswer(getKeyAnswer("Segment" + i,isCompressedInput));
  doAnswer(getValueAnswer("Segment" + i)).when(readerMock).nextRawValue(any(DataInputBuffer.class));
  return readerMock;
}
