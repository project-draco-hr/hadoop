{
  Path tmpDir=new Path("localpath");
  Class<Text> keyClass=(Class<Text>)jobConf.getMapOutputKeyClass();
  Class<Text> valueClass=(Class<Text>)jobConf.getMapOutputValueClass();
  RawComparator<Text> comparator=jobConf.getOutputKeyComparator();
  Counter readsCounter=new Counter();
  Counter writesCounter=new Counter();
  Progress mergePhase=new Progress();
  RawKeyValueIterator mergeQueue=Merger.merge(conf,fs,keyClass,valueClass,segments,2,tmpDir,comparator,getReporter(),readsCounter,writesCounter,mergePhase);
  Assert.assertEquals(1.0f,mergeQueue.getProgress().get(),0.0f);
}
