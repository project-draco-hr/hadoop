{
  conf.set(DFSConfigKeys.DFS_HTTP_POLICY_KEY,HttpConfig.Policy.HTTP_AND_HTTPS.name());
  conf.set(NfsConfigKeys.NFS_HTTP_ADDRESS_KEY,"localhost:0");
  conf.set(NfsConfigKeys.NFS_HTTPS_ADDRESS_KEY,"localhost:0");
  conf.setInt(NfsConfigKeys.DFS_NFS_SERVER_PORT_KEY,0);
  conf.setInt(NfsConfigKeys.DFS_NFS_MOUNTD_PORT_KEY,0);
  File base=new File(BASEDIR);
  FileUtil.fullyDelete(base);
  base.mkdirs();
  keystoresDir=new File(BASEDIR).getAbsolutePath();
  sslConfDir=KeyStoreTestUtil.getClasspathDir(TestNfs3HttpServer.class);
  KeyStoreTestUtil.setupSSLConfig(keystoresDir,sslConfDir,conf,false);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(1).build();
  cluster.waitActive();
}
