{
  short whichSize;
  boolean useDefaultType;
  if (userBytesPerChecksum > 0) {
    whichSize=1;
  }
 else   if (userOpt != null && userOpt.getBytesPerChecksum() > 0) {
    whichSize=2;
  }
 else {
    whichSize=0;
  }
  if (userOpt != null && userOpt.getChecksumType() != DataChecksum.Type.DEFAULT) {
    useDefaultType=false;
  }
 else {
    useDefaultType=true;
  }
  if (whichSize == 0 && useDefaultType) {
    return defaultOpt;
  }
 else   if (whichSize == 2 && !useDefaultType) {
    return userOpt;
  }
  DataChecksum.Type type=useDefaultType ? defaultOpt.getChecksumType() : userOpt.getChecksumType();
  if (whichSize == 0) {
    return new ChecksumOpt(type,defaultOpt.getBytesPerChecksum());
  }
 else   if (whichSize == 1) {
    return new ChecksumOpt(type,userBytesPerChecksum);
  }
 else {
    return new ChecksumOpt(type,userOpt.getBytesPerChecksum());
  }
}
