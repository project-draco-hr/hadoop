{
  final int taskSize=1024;
  monitor.setTaskName("Download file " + this.path);
  BufferedOutputStream ostream=null;
  DataInputStream istream=null;
  try {
    istream=getDFS().open(this.path);
    ostream=new BufferedOutputStream(new FileOutputStream(file));
    int bytes;
    byte[] buffer=new byte[taskSize];
    while ((bytes=istream.read(buffer)) >= 0) {
      if (monitor.isCanceled())       return;
      ostream.write(buffer,0,bytes);
      monitor.worked(1);
    }
  }
 catch (  Exception e) {
    throw new InvocationTargetException(e);
  }
 finally {
    if (istream != null) {
      try {
        istream.close();
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
    }
    try {
      ostream.close();
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
  }
}
