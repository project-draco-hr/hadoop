{
  UserGroupInformation ugi=null;
  try {
    ugi=UserGroupInformation.login(conf);
  }
 catch (  LoginException le) {
    throw new RuntimeException("Couldn't login!");
  }
  return getProxy(protocol,addr,ugi,conf,NetUtils.getDefaultSocketFactory(conf));
}
