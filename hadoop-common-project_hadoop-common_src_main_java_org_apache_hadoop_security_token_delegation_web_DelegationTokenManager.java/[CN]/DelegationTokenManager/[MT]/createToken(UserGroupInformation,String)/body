{
  LOG.debug("Creating token with ugi:{}, renewer:{}.",ugi,renewer);
  renewer=(renewer == null) ? ugi.getShortUserName() : renewer;
  String user=ugi.getUserName();
  Text owner=new Text(user);
  Text realUser=null;
  if (ugi.getRealUser() != null) {
    realUser=new Text(ugi.getRealUser().getUserName());
  }
  AbstractDelegationTokenIdentifier tokenIdentifier=(AbstractDelegationTokenIdentifier)secretManager.createIdentifier();
  tokenIdentifier.setOwner(owner);
  tokenIdentifier.setRenewer(new Text(renewer));
  tokenIdentifier.setRealUser(realUser);
  return new Token(tokenIdentifier,secretManager);
}
