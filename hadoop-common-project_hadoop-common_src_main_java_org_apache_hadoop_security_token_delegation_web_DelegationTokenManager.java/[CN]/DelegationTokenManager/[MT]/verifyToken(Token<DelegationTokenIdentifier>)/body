{
  ByteArrayInputStream buf=new ByteArrayInputStream(token.getIdentifier());
  DataInputStream dis=new DataInputStream(buf);
  DelegationTokenIdentifier id=new DelegationTokenIdentifier(tokenKind);
  id.readFields(dis);
  dis.close();
  secretManager.verifyToken(id,token.getPassword());
  return id.getUser();
}
