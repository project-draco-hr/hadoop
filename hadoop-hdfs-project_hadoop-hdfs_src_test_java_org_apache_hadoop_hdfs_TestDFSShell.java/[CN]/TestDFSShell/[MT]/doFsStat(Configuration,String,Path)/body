{
  if (files == null || files.length == 0) {
    final String[] argv=(format == null ? new String[]{"-stat"} : new String[]{"-stat",format});
    assertEquals("Should have failed with missing arguments",-1,ToolRunner.run(new FsShell(conf),argv));
  }
 else {
    List<String> argv=new LinkedList<>();
    argv.add("-stat");
    if (format != null) {
      argv.add(format);
    }
    for (    Path f : files) {
      argv.add(f.toString());
    }
    int ret=ToolRunner.run(new FsShell(conf),argv.toArray(new String[0]));
    assertEquals(argv + " returned non-zero status " + ret,0,ret);
  }
}
