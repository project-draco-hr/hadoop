{
  List<File> files=new ArrayList<File>();
  List<DataNode> datanodes=cluster.getDataNodes();
  String poolId=cluster.getNamesystem().getBlockPoolId();
  List<Map<DatanodeStorage,BlockListAsLongs>> blocks=cluster.getAllBlockReports(poolId);
  for (int i=0; i < blocks.size(); i++) {
    DataNode dn=datanodes.get(i);
    Map<DatanodeStorage,BlockListAsLongs> map=blocks.get(i);
    for (    Map.Entry<DatanodeStorage,BlockListAsLongs> e : map.entrySet()) {
      for (      Block b : e.getValue()) {
        files.add(DataNodeTestUtils.getFile(dn,poolId,b.getBlockId()));
      }
    }
  }
  return files;
}
