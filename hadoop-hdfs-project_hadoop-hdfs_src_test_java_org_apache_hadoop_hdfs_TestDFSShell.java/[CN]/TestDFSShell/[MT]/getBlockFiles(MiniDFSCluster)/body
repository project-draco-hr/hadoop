{
  List<File> files=new ArrayList<File>();
  List<DataNode> datanodes=cluster.getDataNodes();
  String poolId=cluster.getNamesystem().getBlockPoolId();
  Iterable<Block>[] blocks=cluster.getAllBlockReports(poolId);
  for (int i=0; i < blocks.length; i++) {
    DataNode dn=datanodes.get(i);
    for (    Block b : blocks[i]) {
      files.add(DataNodeTestUtils.getFile(dn,poolId,b.getBlockId()));
    }
  }
  return files;
}
