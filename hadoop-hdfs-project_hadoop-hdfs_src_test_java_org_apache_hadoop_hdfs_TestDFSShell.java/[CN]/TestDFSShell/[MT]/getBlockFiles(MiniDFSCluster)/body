{
  List<File> files=new ArrayList<File>();
  List<DataNode> datanodes=cluster.getDataNodes();
  String poolId=cluster.getNamesystem().getBlockPoolId();
  Iterable<Block>[] blocks=cluster.getAllBlockReports(poolId);
  for (int i=0; i < blocks.length; i++) {
    FSDataset ds=(FSDataset)datanodes.get(i).getFSDataset();
    for (    Block b : blocks[i]) {
      files.add(DataNodeTestUtils.getBlockFile(ds,poolId,b.getBlockId()));
    }
  }
  return files;
}
