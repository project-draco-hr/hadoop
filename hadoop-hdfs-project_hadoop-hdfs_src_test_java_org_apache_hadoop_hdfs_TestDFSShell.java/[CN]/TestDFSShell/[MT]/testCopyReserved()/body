{
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(2).build();
  FileSystem fs=cluster.getFileSystem();
  final File localFile=new File(TEST_ROOT_DIR,"testFileForPut");
  localFile.createNewFile();
  final String localfilepath=new Path(localFile.getAbsolutePath()).toUri().toString();
  try {
    fs.copyFromLocalFile(new Path(localfilepath),new Path("/.reserved"));
    fail("Can't copyFromLocal to /.reserved");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Invalid path name /.reserved"));
  }
  final String testdir=System.getProperty("test.build.data") + "/TestDFSShell-testCopyReserved";
  final Path hdfsTestDir=new Path(testdir);
  writeFile(fs,new Path(testdir,"testFileForPut"));
  final Path src=new Path(hdfsTestDir,"srcfile");
  fs.create(src).close();
  assertTrue(fs.exists(src));
  PrintStream syserr=System.err;
  final ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(baos);
  System.setErr(ps);
  FsShell shell=new FsShell();
  shell.setConf(conf);
  runCmd(shell,"-cp",src.toString(),"/.reserved");
  assertTrue(baos.toString().contains("Invalid path name /.reserved"));
  System.setErr(syserr);
  cluster.shutdown();
}
