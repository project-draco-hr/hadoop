{
  final int currentPartNumber=partETagsFutures.size() + 1;
  final UploadPartRequest request=new UploadPartRequest().withBucketName(bucket).withKey(key).withUploadId(uploadId).withInputStream(inputStream).withPartNumber(currentPartNumber).withPartSize(partSize);
  request.setGeneralProgressListener(progressListener);
  ListenableFuture<PartETag> partETagFuture=executorService.submit(new Callable<PartETag>(){
    @Override public PartETag call() throws Exception {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Uploading part {} for id '{}'",currentPartNumber,uploadId);
      }
      return client.uploadPart(request).getPartETag();
    }
  }
);
  partETagsFutures.add(partETagFuture);
}
