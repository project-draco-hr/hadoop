{
  deleteQueuesConfigFile();
  Document doc=createDocument();
  createSimpleDocument(doc);
  writeToFile(doc,QUEUES_CONFIG_FILE_PATH);
  QueueManager qm=new QueueManager(QUEUES_CONFIG_FILE_PATH,true);
  Set<Queue> rootQueues=qm.getRoot().getChildren();
  List<String> names=new ArrayList<String>();
  for (  Queue q : rootQueues) {
    names.add(q.getName());
  }
  assertEquals(rootQueues.size(),2);
  assertTrue(names.contains("q1"));
  assertTrue(names.contains("p1"));
  Set<String> leafNames=qm.getLeafQueueNames();
  Queue p=qm.getQueue("p1");
  Set<Queue> children=p.getChildren();
  assertTrue(children.size() == 2);
  assertTrue(leafNames.contains("p1" + NAME_SEPARATOR + "p11"));
  assertTrue(leafNames.contains("p1" + NAME_SEPARATOR + "p12"));
  Queue q=qm.getQueue("p1" + NAME_SEPARATOR + "p12");
  assertTrue(q.getAcls().get(toFullPropertyName(q.getName(),ACL_SUBMIT_JOB_TAG)).isUserAllowed(createUGI("u1")));
  assertTrue(q.getAcls().get(toFullPropertyName(q.getName(),ACL_ADMINISTER_JOB_TAG)).isUserAllowed(createUGI("u2")));
  assertTrue(q.getState().equals(QueueState.STOPPED));
}
