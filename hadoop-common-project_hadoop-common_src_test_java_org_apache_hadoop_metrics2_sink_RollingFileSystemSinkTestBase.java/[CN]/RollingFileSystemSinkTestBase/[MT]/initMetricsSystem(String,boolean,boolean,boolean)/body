{
  String prefix=methodName.getMethodName().toLowerCase();
  ConfigBuilder builder=new ConfigBuilder().add("*.period",10000).add(prefix + ".sink.mysink0.class",MockSink.class.getName()).add(prefix + ".sink.mysink0.basepath",path).add(prefix + ".sink.mysink0.source","testsrc").add(prefix + ".sink.mysink0.context","test1").add(prefix + ".sink.mysink0.ignore-error",ignoreErrors).add(prefix + ".sink.mysink0.allow-append",allowAppend);
  if (useSecureParams) {
    builder.add(prefix + ".sink.mysink0.keytab-key",SINK_KEYTAB_FILE_KEY).add(prefix + ".sink.mysink0.principal-key",SINK_PRINCIPAL_KEY);
  }
  builder.save(TestMetricsConfig.getTestFilename("hadoop-metrics2-" + prefix));
  MetricsSystemImpl ms=new MetricsSystemImpl(prefix);
  ms.start();
  return ms;
}
