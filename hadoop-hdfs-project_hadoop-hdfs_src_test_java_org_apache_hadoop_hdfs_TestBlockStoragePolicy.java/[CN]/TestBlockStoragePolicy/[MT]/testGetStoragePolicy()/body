{
  final MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(REPLICATION).build();
  cluster.waitActive();
  final DistributedFileSystem fs=cluster.getFileSystem();
  try {
    final Path dir=new Path("/testGetStoragePolicy");
    final Path fooFile=new Path(dir,"foo");
    DFSTestUtil.createFile(fs,fooFile,FILE_LEN,REPLICATION,0L);
    DFSClient client=new DFSClient(cluster.getNameNode(0).getNameNodeAddress(),conf);
    client.setStoragePolicy("/testGetStoragePolicy/foo",HdfsConstants.COLD_STORAGE_POLICY_NAME);
    String policyName=client.getStoragePolicy("/testGetStoragePolicy/foo").getName();
    Assert.assertEquals("File storage policy should be COLD",HdfsConstants.COLD_STORAGE_POLICY_NAME,policyName);
  }
  finally {
    cluster.shutdown();
  }
}
