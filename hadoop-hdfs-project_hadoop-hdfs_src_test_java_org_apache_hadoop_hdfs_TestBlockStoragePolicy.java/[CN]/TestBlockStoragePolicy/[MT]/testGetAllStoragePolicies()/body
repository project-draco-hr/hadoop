{
  final MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(0).build();
  cluster.waitActive();
  final DistributedFileSystem fs=cluster.getFileSystem();
  try {
    BlockStoragePolicy[] policies=fs.getStoragePolicySuite();
    Assert.assertEquals(3,policies.length);
    Assert.assertEquals(POLICY_SUITE.getPolicy(COLD).toString(),policies[0].toString());
    Assert.assertEquals(POLICY_SUITE.getPolicy(WARM).toString(),policies[1].toString());
    Assert.assertEquals(POLICY_SUITE.getPolicy(HOT).toString(),policies[2].toString());
  }
  finally {
    IOUtils.cleanup(null,fs);
    cluster.shutdown();
  }
}
