{
  try {
    if (!isAllowedDelegationTokenOp()) {
      throw new IOException("Delegation Token can be cancelled only with kerberos authentication");
    }
    DelegationToken protoToken=request.getDelegationToken();
    Token<RMDelegationTokenIdentifier> token=new Token<RMDelegationTokenIdentifier>(protoToken.getIdentifier().array(),protoToken.getPassword().array(),new Text(protoToken.getKind()),new Text(protoToken.getService()));
    String user=UserGroupInformation.getCurrentUser().getShortUserName();
    rmDTSecretManager.cancelToken(token,user);
    return Records.newRecord(CancelDelegationTokenResponse.class);
  }
 catch (  IOException e) {
    throw RPCUtil.getRemoteException(e);
  }
}
