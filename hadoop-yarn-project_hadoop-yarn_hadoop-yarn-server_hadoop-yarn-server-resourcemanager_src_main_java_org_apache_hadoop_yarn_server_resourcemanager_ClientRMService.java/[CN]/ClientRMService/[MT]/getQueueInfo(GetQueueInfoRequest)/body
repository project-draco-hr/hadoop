{
  UserGroupInformation callerUGI;
  try {
    callerUGI=UserGroupInformation.getCurrentUser();
  }
 catch (  IOException ie) {
    LOG.info("Error getting UGI ",ie);
    throw RPCUtil.getRemoteException(ie);
  }
  GetQueueInfoResponse response=recordFactory.newRecordInstance(GetQueueInfoResponse.class);
  try {
    QueueInfo queueInfo=scheduler.getQueueInfo(request.getQueueName(),request.getIncludeChildQueues(),request.getRecursive());
    List<ApplicationReport> appReports=EMPTY_APPS_REPORT;
    if (request.getIncludeApplications()) {
      List<ApplicationAttemptId> apps=scheduler.getAppsInQueue(request.getQueueName());
      appReports=new ArrayList<ApplicationReport>(apps.size());
      for (      ApplicationAttemptId app : apps) {
        RMApp rmApp=rmContext.getRMApps().get(app.getApplicationId());
        if (rmApp != null) {
          if (!checkAccess(callerUGI,rmApp.getUser(),ApplicationAccessType.VIEW_APP,rmApp)) {
            continue;
          }
          appReports.add(rmApp.createAndGetApplicationReport(callerUGI.getUserName(),true));
        }
      }
    }
    queueInfo.setApplications(appReports);
    response.setQueueInfo(queueInfo);
  }
 catch (  IOException ioe) {
    LOG.info("Failed to getQueueInfo for " + request.getQueueName(),ioe);
  }
  return response;
}
