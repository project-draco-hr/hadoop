{
  Configuration conf=new Configuration();
  conf.set(JHAdminConfig.MR_HISTORY_INTERMEDIATE_DONE_DIR,"/mapred/history/done_intermediate");
  conf.set(MRJobConfig.USER_NAME,System.getProperty("user.name"));
  String pathStr=JobHistoryUtils.getHistoryIntermediateDoneDirForUser(conf);
  Assert.assertEquals("/mapred/history/done_intermediate/" + System.getProperty("user.name"),pathStr);
  conf.set(CommonConfigurationKeysPublic.FS_DEFAULT_NAME_KEY,dfsCluster.getURI().toString());
  FileOutputStream os=new FileOutputStream(coreSitePath);
  conf.writeXml(os);
  os.close();
  conf.set(CommonConfigurationKeysPublic.FS_DEFAULT_NAME_KEY,"file:///");
  pathStr=JobHistoryUtils.getHistoryIntermediateDoneDirForUser(conf);
  Assert.assertEquals(dfsCluster.getURI().toString() + "/mapred/history/done_intermediate/" + System.getProperty("user.name"),pathStr);
}
