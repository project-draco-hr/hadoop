{
  JobId jobId=TypeConverter.toYarn(TypeConverter.fromYarn(appId));
  AppContext mockContext=mock(contextClass);
  Job mockJob=mockJob();
  when(mockContext.getJob(jobId)).thenReturn(mockJob);
  when(mockContext.getApplicationID()).thenReturn(appId);
  when(mockContext.isLastAMRetry()).thenReturn(isLastAMRetry);
  if (mockContext instanceof RunningAppContext) {
    when(((RunningAppContext)mockContext).getTimelineClient()).thenReturn(TimelineClient.createTimelineClient());
  }
  return mockContext;
}
