{
  conf=new HdfsConfiguration();
  conf.setInt(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,100);
  conf.setInt(DFSConfigKeys.DFS_BYTES_PER_CHECKSUM_KEY,100);
  cluster=new MiniDFSCluster.Builder(conf).numNameNodes(3).nameNodePort(port).build();
  for (int i=0; i < 3; i++) {
    cluster.waitActive(i);
  }
  for (int i=0; i < 3; i++) {
    bpids[i]=cluster.getNamesystem(i).getBlockPoolId();
  }
  for (int i=0; i < 3; i++) {
    fs[i]=cluster.getFileSystem(i);
  }
  for (int i=0; i < 3; i++) {
    DFSTestUtil.createFile(fs[i],new Path("file1"),1000,(short)1,0);
    DFSTestUtil.createFile(fs[i],new Path("file2"),1000,(short)1,1);
  }
}
