{
  new Thread(){
    @Override public void run(){
      try {
        LOG.info("Notifying ContainerManager to block new container-requests");
        containerManager.setBlockNewContainerRequests(true);
        if (!rmWorkPreservingRestartEnabled) {
          LOG.info("Cleaning up running containers on resync");
          containerManager.cleanupContainersOnNMResync();
        }
 else {
          LOG.info("Preserving containers on resync");
        }
        ((NodeStatusUpdaterImpl)nodeStatusUpdater).rebootNodeStatusUpdaterAndRegisterWithRM();
      }
 catch (      YarnRuntimeException e) {
        LOG.fatal("Error while rebooting NodeStatusUpdater.",e);
        shutDown();
      }
    }
  }
.start();
}
