{
  if (getConfig().getBoolean(YarnConfiguration.NM_CONTAINER_QUEUING_ENABLED,YarnConfiguration.NM_CONTAINER_QUEUING_ENABLED_DEFAULT)) {
    return new QueuingContainerManagerImpl(context,exec,del,nodeStatusUpdater,metrics,dirsHandler);
  }
 else {
    return new ContainerManagerImpl(context,exec,del,nodeStatusUpdater,metrics,dirsHandler);
  }
}
