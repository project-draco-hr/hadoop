{
  final String key=node.getDatanodeUuid();
synchronized (datanodeMap) {
    host2DatanodeMap.remove(datanodeMap.remove(key));
  }
  blockManager.removeFromInvalidates(new DatanodeInfo(node));
  if (LOG.isDebugEnabled()) {
    LOG.debug(getClass().getSimpleName() + ".wipeDatanode(" + node+ "): storage "+ key+ " is removed from datanodeMap.");
  }
}
