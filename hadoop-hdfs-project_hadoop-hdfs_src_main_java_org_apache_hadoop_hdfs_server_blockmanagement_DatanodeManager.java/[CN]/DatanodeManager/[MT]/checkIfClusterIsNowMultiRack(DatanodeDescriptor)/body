{
  if (!hasClusterEverBeenMultiRack && networktopology.getNumOfRacks() > 1) {
    String message="DN " + node + " joining cluster has expanded a formerly "+ "single-rack cluster to be multi-rack. ";
    if (blockManager.isPopulatingReplQueues()) {
      message+="Re-checking all blocks for replication, since they should " + "now be replicated cross-rack";
      LOG.info(message);
    }
 else {
      message+="Not checking for mis-replicated blocks because this NN is " + "not yet processing repl queues.";
      LOG.debug(message);
    }
    hasClusterEverBeenMultiRack=true;
    if (blockManager.isPopulatingReplQueues()) {
      blockManager.processMisReplicatedBlocks();
    }
  }
}
