{
  refreshHostsReader(conf);
  namesystem.writeLock();
  try {
    refreshDatanodes();
    countSoftwareVersions();
  }
  finally {
    namesystem.writeUnlock();
  }
}
