{
  int numLive=0;
synchronized (datanodeMap) {
    for (    DatanodeDescriptor dn : datanodeMap.values()) {
      if (!isDatanodeDead(dn)) {
        numLive++;
      }
    }
  }
  return numLive;
}
