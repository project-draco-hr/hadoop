{
  boolean sendingCachingCommands=false;
  final long nowMs=monotonicNow();
  if (shouldSendCachingCommands && ((nowMs - nodeinfo.getLastCachingDirectiveSentTimeMs()) >= timeBetweenResendingCachingDirectivesMs)) {
    DatanodeCommand pendingCacheCommand=getCacheCommand(nodeinfo.getPendingCached(),DatanodeProtocol.DNA_CACHE,blockPoolId);
    if (pendingCacheCommand != null) {
      cmds.add(pendingCacheCommand);
      sendingCachingCommands=true;
    }
    DatanodeCommand pendingUncacheCommand=getCacheCommand(nodeinfo.getPendingUncached(),DatanodeProtocol.DNA_UNCACHE,blockPoolId);
    if (pendingUncacheCommand != null) {
      cmds.add(pendingUncacheCommand);
      sendingCachingCommands=true;
    }
    if (sendingCachingCommands) {
      nodeinfo.setLastCachingDirectiveSentTimeMs(nowMs);
    }
  }
}
