{
  LOG.info("Marking all datandoes as stale");
synchronized (this) {
    for (    DatanodeDescriptor dn : datanodeMap.values()) {
      for (      DatanodeStorageInfo storage : dn.getStorageInfos()) {
        storage.markStaleAfterFailover();
      }
    }
  }
}
