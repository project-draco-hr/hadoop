{
  for (  DatanodeDescriptor node : datanodeMap.values()) {
    if (!inHostsList(node)) {
      node.setDisallowed(true);
    }
 else {
      if (inExcludedHostsList(node)) {
        startDecommission(node);
      }
 else {
        stopDecommission(node);
      }
    }
  }
}
