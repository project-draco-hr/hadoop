{
  int length=list.size();
  if (length == 0) {
    return null;
  }
  long[] blockIds=new long[length];
  int i=0;
  for (Iterator<CachedBlock> iter=list.iterator(); iter.hasNext(); ) {
    CachedBlock cachedBlock=iter.next();
    blockIds[i++]=cachedBlock.getBlockId();
    iter.remove();
  }
  if (!sendCachingCommands) {
    return null;
  }
  return new BlockIdCommand(action,poolId,blockIds);
}
