{
  DatanodeID dnId;
  String hostStr;
  int port;
  int idx=hostLine.indexOf(':');
  if (-1 == idx) {
    hostStr=hostLine;
    port=DFSConfigKeys.DFS_DATANODE_DEFAULT_PORT;
  }
 else {
    hostStr=hostLine.substring(0,idx);
    port=Integer.parseInt(hostLine.substring(idx + 1));
  }
  if (InetAddresses.isInetAddress(hostStr)) {
    dnId=new DatanodeID(hostStr,"","",port,DFSConfigKeys.DFS_DATANODE_HTTP_DEFAULT_PORT,DFSConfigKeys.DFS_DATANODE_HTTPS_DEFAULT_PORT,DFSConfigKeys.DFS_DATANODE_IPC_DEFAULT_PORT);
  }
 else {
    String ipAddr="";
    try {
      ipAddr=InetAddress.getByName(hostStr).getHostAddress();
    }
 catch (    UnknownHostException e) {
      LOG.warn("Invalid hostname " + hostStr + " in hosts file");
    }
    dnId=new DatanodeID(ipAddr,hostStr,"",port,DFSConfigKeys.DFS_DATANODE_HTTP_DEFAULT_PORT,DFSConfigKeys.DFS_DATANODE_HTTPS_DEFAULT_PORT,DFSConfigKeys.DFS_DATANODE_IPC_DEFAULT_PORT);
  }
  return dnId;
}
