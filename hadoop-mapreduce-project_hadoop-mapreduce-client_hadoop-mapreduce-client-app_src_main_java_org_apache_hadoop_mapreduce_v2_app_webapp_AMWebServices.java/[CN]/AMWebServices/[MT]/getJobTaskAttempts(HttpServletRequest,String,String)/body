{
  TaskAttemptsInfo attempts=new TaskAttemptsInfo();
  Job job=this.appCtx.getJob(MRApps.toJobID(jid));
  if (job == null) {
    throw new NotFoundException("job, " + jid + ", is not found");
  }
  checkAccess(job,hsr);
  TaskId taskID=MRApps.toTaskID(tid);
  if (taskID == null) {
    throw new NotFoundException("taskid " + tid + " not found or invalid");
  }
  Task task=job.getTask(taskID);
  if (task == null) {
    throw new NotFoundException("task not found with id " + tid);
  }
  for (  TaskAttempt ta : task.getAttempts().values()) {
    if (ta != null) {
      if (task.getType() == TaskType.REDUCE) {
        attempts.add(new ReduceTaskAttemptInfo(ta,task.getType()));
      }
 else {
        attempts.add(new TaskAttemptInfo(ta,task.getType(),true));
      }
    }
  }
  return attempts;
}
