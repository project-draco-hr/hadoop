{
  final Configuration conf=new Configuration();
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,BLOCK_SIZE);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(GROUP_SIZE).build();
  cluster.waitActive();
  dir=cluster.getNamesystem().getFSDirectory();
  dfs=cluster.getFileSystem();
  dfs.mkdirs(ecDir);
  dfs.getClient().createErasureCodingZone(ecDir.toString(),ecSchema,0);
  dfs.setQuota(ecDir,Long.MAX_VALUE - 1,DISK_QUOTA);
  dfs.setQuotaByStorageType(ecDir,StorageType.DISK,DISK_QUOTA);
  dfs.setStoragePolicy(ecDir,HdfsServerConstants.HOT_STORAGE_POLICY_NAME);
}
