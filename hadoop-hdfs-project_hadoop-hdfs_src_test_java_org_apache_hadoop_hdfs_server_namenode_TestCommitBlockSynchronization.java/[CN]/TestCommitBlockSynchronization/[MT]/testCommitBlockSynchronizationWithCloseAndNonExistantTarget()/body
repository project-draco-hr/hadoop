{
  INodeFile file=mockFileUnderConstruction();
  Block block=new Block(blockId,length,genStamp);
  FSNamesystem namesystemSpy=makeNameSystemSpy(block,file);
  DatanodeID[] newTargets=new DatanodeID[]{new DatanodeID("0.0.0.0","nonexistantHost","1",0,0,0,0)};
  String[] storageIDs=new String[]{"fake-storage-ID"};
  ExtendedBlock lastBlock=new ExtendedBlock();
  namesystemSpy.commitBlockSynchronization(lastBlock,genStamp,length,true,false,newTargets,storageIDs);
  namesystemSpy.commitBlockSynchronization(lastBlock,genStamp,length,true,false,newTargets,storageIDs);
}
