{
  JobEndStatusInfo notification=null;
  String uri=conf.getJobEndNotificationURI();
  if (uri != null) {
    int retryAttempts=conf.getInt(JobContext.END_NOTIFICATION_RETRIES,0) + 1;
    long retryInterval=conf.getInt(JobContext.END_NOTIFICATION_RETRIE_INTERVAL,30000);
    if (uri.contains("$jobId")) {
      uri=uri.replace("$jobId",status.getJobID().toString());
    }
    if (uri.contains("$jobStatus")) {
      String statusStr=(status.getRunState() == JobStatus.SUCCEEDED) ? "SUCCEEDED" : (status.getRunState() == JobStatus.FAILED) ? "FAILED" : "KILLED";
      uri=uri.replace("$jobStatus",statusStr);
    }
    notification=new JobEndStatusInfo(uri,retryAttempts,retryInterval);
  }
  return notification;
}
