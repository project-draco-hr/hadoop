{
  final PriorityQueue<EditLogInputStream> allStreams=new PriorityQueue<EditLogInputStream>(64,EDIT_LOG_INPUT_STREAM_COMPARATOR);
  for (  JournalAndStream jas : journals) {
    if (jas.isDisabled()) {
      LOG.info("Skipping jas " + jas + " since it's disabled");
      continue;
    }
    jas.getManager().selectInputStreams(allStreams,fromTxId,inProgressOk);
  }
  LinkedList<EditLogInputStream> acc=new LinkedList<EditLogInputStream>();
  EditLogInputStream elis;
  while ((elis=allStreams.poll()) != null) {
    if (acc.isEmpty()) {
      acc.add(elis);
    }
 else {
      long accFirstTxId=acc.get(0).getFirstTxId();
      if (accFirstTxId == elis.getFirstTxId()) {
        acc.add(elis);
      }
 else       if (accFirstTxId < elis.getFirstTxId()) {
        streams.add(new RedundantEditLogInputStream(acc,fromTxId));
        acc.clear();
        acc.add(elis);
      }
 else       if (accFirstTxId > elis.getFirstTxId()) {
        throw new RuntimeException("sorted set invariants violated!  " + "Got stream with first txid " + elis.getFirstTxId() + ", but the last firstTxId was "+ accFirstTxId);
      }
    }
  }
  if (!acc.isEmpty()) {
    streams.add(new RedundantEditLogInputStream(acc,fromTxId));
    acc.clear();
  }
}
