{
  NavigableMap<String,NavigableMap<Long,V>> results=new TreeMap<String,NavigableMap<Long,V>>();
  if (result != null) {
    NavigableMap<byte[],NavigableMap<byte[],NavigableMap<Long,byte[]>>> resultMap=result.getMap();
    NavigableMap<byte[],NavigableMap<Long,byte[]>> columnCellMap=resultMap.get(columnFamilyBytes);
    if (columnCellMap != null) {
      for (      Entry<byte[],NavigableMap<Long,byte[]>> entry : columnCellMap.entrySet()) {
        String columnName=null;
        if (columnPrefixBytes == null) {
          LOG.info("null prefix was specified; returning all columns");
          columnName=Separator.decode(entry.getKey(),Separator.SPACE);
        }
 else {
          byte[][] columnNameParts=Separator.QUALIFIERS.split(entry.getKey(),2);
          byte[] actualColumnPrefixBytes=columnNameParts[0];
          if (Bytes.equals(columnPrefixBytes,actualColumnPrefixBytes) && columnNameParts.length == 2) {
            columnName=Separator.decode(columnNameParts[1]);
          }
        }
        if (columnName != null) {
          NavigableMap<Long,V> cellResults=new TreeMap<Long,V>();
          NavigableMap<Long,byte[]> cells=entry.getValue();
          if (cells != null) {
            for (            Entry<Long,byte[]> cell : cells.entrySet()) {
              V value=(V)GenericObjectMapper.read(cell.getValue());
              cellResults.put(cell.getKey(),value);
            }
          }
          results.put(columnName,cellResults);
        }
      }
    }
  }
  return results;
}
