{
  Map<String,Object> results=new HashMap<String,Object>();
  if (result != null) {
    Map<byte[],byte[]> columns=result.getFamilyMap(columnFamilyBytes);
    for (    Entry<byte[],byte[]> entry : columns.entrySet()) {
      if (entry.getKey() != null && entry.getKey().length > 0) {
        String columnName=null;
        if (columnPrefixBytes == null) {
          columnName=Separator.decode(entry.getKey(),Separator.SPACE);
        }
 else {
          byte[][] columnNameParts=Separator.QUALIFIERS.split(entry.getKey(),2);
          byte[] actualColumnPrefixBytes=columnNameParts[0];
          if (Bytes.equals(columnPrefixBytes,actualColumnPrefixBytes) && columnNameParts.length == 2) {
            columnName=Separator.decode(columnNameParts[1]);
          }
        }
        if (columnName != null) {
          Object value=GenericObjectMapper.read(entry.getValue());
          results.put(columnName,value);
        }
      }
    }
  }
  return results;
}
