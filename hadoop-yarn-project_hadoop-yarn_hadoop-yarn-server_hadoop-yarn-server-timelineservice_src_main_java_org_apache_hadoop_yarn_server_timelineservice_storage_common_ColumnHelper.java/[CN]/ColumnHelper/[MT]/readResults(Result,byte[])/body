{
  Map<String,Object> results=new HashMap<String,Object>();
  if (result != null) {
    Map<byte[],byte[]> columns=result.getFamilyMap(columnFamilyBytes);
    for (    Entry<byte[],byte[]> entry : columns.entrySet()) {
      byte[] columnKey=entry.getKey();
      if (columnKey != null && columnKey.length > 0) {
        String columnName=null;
        if (columnPrefixBytes == null) {
          if (LOG.isDebugEnabled()) {
            LOG.debug("null prefix was specified; returning all columns");
          }
          columnName=Separator.decode(columnKey,Separator.SPACE);
        }
 else {
          byte[][] columnNameParts=Separator.QUALIFIERS.split(columnKey,2);
          byte[] actualColumnPrefixBytes=columnNameParts[0];
          if (Bytes.equals(columnPrefixBytes,actualColumnPrefixBytes) && columnNameParts.length == 2) {
            columnName=Separator.decode(columnNameParts[1]);
          }
        }
        if (columnName != null) {
          Object value=converter.decodeValue(entry.getValue());
          results.put(columnName,value);
        }
      }
    }
  }
  return results;
}
