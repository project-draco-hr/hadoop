{
  for (  String rootLogDir : this.rootLogDirs) {
    File appLogDir=new File(rootLogDir,ConverterUtils.toString(this.containerId.getApplicationAttemptId().getApplicationId()));
    File containerLogDir=new File(appLogDir,ConverterUtils.toString(this.containerId));
    if (!containerLogDir.isDirectory()) {
      continue;
    }
    File[] logFiles=containerLogDir.listFiles();
    Arrays.sort(logFiles);
    for (    File logFile : logFiles) {
      out.writeUTF(logFile.getName());
      out.writeUTF(String.valueOf(logFile.length()));
      FileInputStream in=null;
      try {
        in=SecureIOUtils.openForRead(logFile,getUser(),null);
        byte[] buf=new byte[65535];
        int len=0;
        while ((len=in.read(buf)) != -1) {
          out.write(buf,0,len);
        }
      }
 catch (      IOException e) {
        String message="Error aggregating log file. Log file : " + logFile.getAbsolutePath() + e.getMessage();
        LOG.error(message,e);
        out.write(message.getBytes());
      }
 finally {
        if (in != null) {
          in.close();
        }
      }
    }
  }
}
