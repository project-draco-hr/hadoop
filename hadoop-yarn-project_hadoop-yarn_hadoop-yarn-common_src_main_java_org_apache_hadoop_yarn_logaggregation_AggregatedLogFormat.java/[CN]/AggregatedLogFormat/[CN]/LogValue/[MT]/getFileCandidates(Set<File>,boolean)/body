{
  filterFiles(useRegularPattern ? this.logAggregationContext.getIncludePattern() : this.logAggregationContext.getRolledLogsIncludePattern(),candidates,false);
  filterFiles(useRegularPattern ? this.logAggregationContext.getExcludePattern() : this.logAggregationContext.getRolledLogsExcludePattern(),candidates,true);
  Iterable<File> mask=Iterables.filter(candidates,new Predicate<File>(){
    @Override public boolean apply(    File next){
      return !alreadyUploadedLogFiles.contains(getLogFileMetaData(next));
    }
  }
);
  return Sets.newHashSet(mask);
}
