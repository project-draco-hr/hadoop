{
  if (conf == null)   conf=new HdfsConfiguration();
  StartupOption startOpt=parseArguments(argv);
  if (startOpt == null) {
    printUsage();
    return null;
  }
  setStartupOption(conf,startOpt);
switch (startOpt) {
case FORMAT:
    boolean aborted=format(conf,true);
  System.exit(aborted ? 1 : 0);
return null;
case GENCLUSTERID:
System.err.println("Generating new cluster id:");
System.out.println(NNStorage.newClusterID());
System.exit(0);
return null;
case FINALIZE:
aborted=finalize(conf,true);
System.exit(aborted ? 1 : 0);
return null;
case BACKUP:
case CHECKPOINT:
NamenodeRole role=startOpt.toNodeRole();
DefaultMetricsSystem.initialize(role.toString().replace(" ",""));
return new BackupNode(conf,role);
default :
DefaultMetricsSystem.initialize("NameNode");
return new NameNode(conf);
}
}
