{
  checkOperation(OperationCategory.READ);
  Collection<FSNamesystem.CorruptFileBlockInfo> fbs=namesystem.listCorruptFileBlocks(path,cookie);
  String[] files=new String[fbs.size()];
  String lastCookie="";
  int i=0;
  for (  FSNamesystem.CorruptFileBlockInfo fb : fbs) {
    files[i++]=fb.path;
    lastCookie=fb.block.getBlockName();
  }
  return new CorruptFileBlocks(files,lastCookie);
}
