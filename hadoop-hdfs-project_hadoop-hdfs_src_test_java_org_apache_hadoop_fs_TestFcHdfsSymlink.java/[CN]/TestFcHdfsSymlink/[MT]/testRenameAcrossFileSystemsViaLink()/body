{
  FileContext localFc=FileContext.getLocalFSFileContext();
  Path localDir=new Path("file://" + fileContextTestHelper.getAbsoluteTestRootDir(localFc) + "/test");
  Path hdfsFile=new Path(testBaseDir1(),"file");
  Path link=new Path(testBaseDir1(),"link");
  Path hdfsFileNew=new Path(testBaseDir1(),"fileNew");
  Path hdfsFileNewViaLink=new Path(link,"fileNew");
  localFc.delete(localDir,true);
  localFc.mkdir(localDir,FileContext.DEFAULT_PERM,true);
  localFc.setWorkingDirectory(localDir);
  createAndWriteFile(fc,hdfsFile);
  fc.createSymlink(localDir,link,false);
  try {
    fc.rename(hdfsFile,hdfsFileNewViaLink);
    fail("Renamed across file systems");
  }
 catch (  InvalidPathException ipe) {
  }
  createAndWriteFile(fc,hdfsFileNewViaLink);
  try {
    fc.rename(hdfsFileNewViaLink,hdfsFileNew);
    fail("Renamed across file systems");
  }
 catch (  InvalidPathException ipe) {
  }
}
