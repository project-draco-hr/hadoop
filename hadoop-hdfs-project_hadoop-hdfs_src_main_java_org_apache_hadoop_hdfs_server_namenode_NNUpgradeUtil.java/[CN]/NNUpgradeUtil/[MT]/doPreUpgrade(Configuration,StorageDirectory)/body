{
  LOG.info("Starting upgrade of storage directory " + sd.getRoot());
  renameCurToTmp(sd);
  final File curDir=sd.getCurrentDir();
  final File tmpDir=sd.getPreviousTmp();
  List<String> fileNameList=IOUtils.listDirectory(tmpDir,new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      return dir.equals(tmpDir) && name.startsWith(NNStorage.NameNodeFile.EDITS.getName());
    }
  }
);
  for (  String s : fileNameList) {
    File prevFile=new File(tmpDir,s);
    File newFile=new File(curDir,prevFile.getName());
    Files.createLink(newFile.toPath(),prevFile.toPath());
  }
}
