{
  int threadsNew=0;
  int threadsRunnable=0;
  int threadsBlocked=0;
  int threadsWaiting=0;
  int threadsTimedWaiting=0;
  int threadsTerminated=0;
  long threadIds[]=threadMXBean.getAllThreadIds();
  for (  ThreadInfo threadInfo : threadMXBean.getThreadInfo(threadIds,0)) {
    if (threadInfo == null)     continue;
switch (threadInfo.getThreadState()) {
case NEW:
      threadsNew++;
    break;
case RUNNABLE:
  threadsRunnable++;
break;
case BLOCKED:
threadsBlocked++;
break;
case WAITING:
threadsWaiting++;
break;
case TIMED_WAITING:
threadsTimedWaiting++;
break;
case TERMINATED:
threadsTerminated++;
break;
}
}
rb.addGauge(ThreadsNew,threadsNew).addGauge(ThreadsRunnable,threadsRunnable).addGauge(ThreadsBlocked,threadsBlocked).addGauge(ThreadsWaiting,threadsWaiting).addGauge(ThreadsTimedWaiting,threadsTimedWaiting).addGauge(ThreadsTerminated,threadsTerminated);
}
