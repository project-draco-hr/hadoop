{
  for (blockIdx=0; blockIdx < getLocatedBlocks().size() && getRemaining() >= 0; blockIdx++) {
    if (isRefetchBlocks()) {
      setBlockLocations(getClient().getBlockLocations(getSrc(),getLength()));
      setLocatedBlocks(getBlockLocations().getLocatedBlocks());
      setRefetchBlocks(false);
    }
    LocatedBlock locatedBlock=getLocatedBlocks().get(blockIdx);
    if (!checksumBlock(locatedBlock)) {
      throw new IOException("Fail to get block MD5 for " + locatedBlock);
    }
  }
}
