{
  ClientRMProtocol client=getClientRMService();
  GetNewApplicationIdResponse resp=client.getNewApplicationId(Records.newRecord(GetNewApplicationIdRequest.class));
  ApplicationId appId=resp.getApplicationId();
  SubmitApplicationRequest req=Records.newRecord(SubmitApplicationRequest.class);
  ApplicationSubmissionContext sub=Records.newRecord(ApplicationSubmissionContext.class);
  sub.setApplicationId(appId);
  sub.setApplicationName("");
  sub.setUser("");
  Resource capability=Records.newRecord(Resource.class);
  capability.setMemory(masterMemory);
  sub.setMasterCapability(capability);
  req.setApplicationSubmissionContext(sub);
  client.submitApplication(req);
  waitForState(appId,RMAppState.ACCEPTED);
  return getRMContext().getRMApps().get(appId);
}
