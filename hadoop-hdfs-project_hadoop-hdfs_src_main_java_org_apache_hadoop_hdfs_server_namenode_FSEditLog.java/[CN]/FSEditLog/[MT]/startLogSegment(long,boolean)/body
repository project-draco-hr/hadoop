{
  LOG.info("Started a new log segment at txid " + txid);
  if (isSegmentOpen()) {
    if (getLastWrittenTxId() == txid - 1) {
      endCurrentLogSegment(false);
    }
 else {
      final String mess="Cannot start a new log segment at txid " + txid + " since only up to txid "+ getLastWrittenTxId()+ " have been written in the log segment starting at "+ getCurSegmentTxId()+ ".";
      if (abortCurrentLogSegment) {
        LOG.warn(mess);
        abortCurrentLogSegment();
      }
 else {
        throw new IOException(mess);
      }
    }
  }
  setNextTxId(txid);
  startLogSegment(txid);
}
