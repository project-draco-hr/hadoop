{
  int minimumRedundantJournals=conf.getInt(DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_MINIMUM_KEY,DFSConfigKeys.DFS_NAMENODE_EDITS_DIR_MINIMUM_DEFAULT);
  journalSet=new JournalSet(minimumRedundantJournals);
  this.journalSet.setRuntimeForTesting(runtime);
  for (  URI u : dirs) {
    boolean required=FSNamesystem.getRequiredNamespaceEditsDirs(conf).contains(u);
    if (u.getScheme().equals(NNStorage.LOCAL_URI_SCHEME)) {
      StorageDirectory sd=storage.getStorageDirectory(u);
      if (sd != null) {
        journalSet.add(new FileJournalManager(sd,storage),required);
      }
    }
 else {
      journalSet.add(createJournal(u),required);
    }
  }
  if (journalSet.isEmpty()) {
    LOG.error("No edits directories configured!");
  }
}
