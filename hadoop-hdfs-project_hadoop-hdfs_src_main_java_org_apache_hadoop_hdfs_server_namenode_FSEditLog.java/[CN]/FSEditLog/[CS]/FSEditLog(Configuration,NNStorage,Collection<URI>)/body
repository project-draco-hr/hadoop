{
  this.conf=conf;
  isSyncRunning=false;
  this.storage=storage;
  metrics=NameNode.getNameNodeMetrics();
  lastPrintTime=now();
  if (editsDirs.isEmpty()) {
    try {
      editsDirs=Lists.newArrayList(storage.getEditsDirectories());
    }
 catch (    IOException ioe) {
    }
    this.editsDirs=editsDirs;
  }
 else {
    this.editsDirs=Lists.newArrayList(editsDirs);
  }
  this.journalSet=new JournalSet();
  for (  URI u : this.editsDirs) {
    if (u.getScheme().equals(NNStorage.LOCAL_URI_SCHEME)) {
      StorageDirectory sd=storage.getStorageDirectory(u);
      if (sd != null) {
        journalSet.add(new FileJournalManager(sd));
      }
    }
 else {
      journalSet.add(createJournal(u));
    }
  }
  if (journalSet.isEmpty()) {
    LOG.error("No edits directories configured!");
  }
  state=State.BETWEEN_LOG_SEGMENTS;
}
