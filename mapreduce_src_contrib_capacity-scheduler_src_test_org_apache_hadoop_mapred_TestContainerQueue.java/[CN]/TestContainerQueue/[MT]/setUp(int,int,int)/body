{
  taskTrackerManager=new CapacityTestUtils.FakeTaskTrackerManager(numTaskTrackers,numMapTasksPerTracker,numReduceTasksPerTracker);
  clock=new CapacityTestUtils.FakeClock();
  scheduler=new CapacityTaskScheduler(clock);
  scheduler.setTaskTrackerManager(taskTrackerManager);
  controlledInitializationPoller=new CapacityTestUtils.ControlledInitializationPoller(scheduler.jobQueuesManager,taskTrackerManager);
  scheduler.setInitializationPoller(controlledInitializationPoller);
  scheduler.setConf(taskTrackerManager.defaultJobConf);
}
