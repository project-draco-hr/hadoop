{
  int cellSize=ecSchema.getChunkSize();
  int dataBlkNum=ecSchema.getNumDataUnits();
  StripingCell[] cells=getStripingCellsOfByteRange(ecSchema,blockGroup,rangeStartInBlockGroup,rangeEndInBlockGroup);
  VerticalRange[] ranges=getRangesForInternalBlocks(ecSchema,cells);
  AlignedStripe[] stripes=mergeRangesForInternalBlocks(ecSchema,ranges);
  calcualteChunkPositionsInBuf(ecSchema,stripes,cells,buf,offsetInBuf);
  prepareAllZeroChunks(blockGroup,buf,stripes,cellSize,dataBlkNum);
  return stripes;
}
