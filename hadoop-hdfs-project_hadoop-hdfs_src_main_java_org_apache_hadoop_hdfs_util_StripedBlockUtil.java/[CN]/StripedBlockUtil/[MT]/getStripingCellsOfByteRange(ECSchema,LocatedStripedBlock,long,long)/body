{
  Preconditions.checkArgument(rangeStartInBlockGroup <= rangeEndInBlockGroup && rangeEndInBlockGroup < blockGroup.getBlockSize());
  int cellSize=ecSchema.getChunkSize();
  int len=(int)(rangeEndInBlockGroup - rangeStartInBlockGroup + 1);
  int firstCellIdxInBG=(int)(rangeStartInBlockGroup / cellSize);
  int lastCellIdxInBG=(int)(rangeEndInBlockGroup / cellSize);
  int numCells=lastCellIdxInBG - firstCellIdxInBG + 1;
  StripingCell[] cells=new StripingCell[numCells];
  cells[0]=new StripingCell(ecSchema,firstCellIdxInBG);
  cells[numCells - 1]=new StripingCell(ecSchema,lastCellIdxInBG);
  cells[0].offset=(int)(rangeStartInBlockGroup % cellSize);
  cells[0].size=Math.min(cellSize - (int)(rangeStartInBlockGroup % cellSize),len);
  if (lastCellIdxInBG != firstCellIdxInBG) {
    cells[numCells - 1].size=(int)(rangeEndInBlockGroup % cellSize) + 1;
  }
  for (int i=1; i < numCells - 1; i++) {
    cells[i]=new StripingCell(ecSchema,i + firstCellIdxInBG);
  }
  return cells;
}
