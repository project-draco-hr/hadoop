{
  int[] decodeIndices=new int[parityBlkNum];
  int pos=0;
  for (int i=0; i < alignedStripe.chunks.length; i++) {
    if (alignedStripe.chunks[i].state == StripingChunk.MISSING) {
      decodeIndices[pos++]=convertIndex4Decode(i,dataBlkNum,parityBlkNum);
    }
  }
  decodeIndices=Arrays.copyOf(decodeIndices,pos);
  byte[][] decodeOutputs=new byte[decodeIndices.length][(int)alignedStripe.getSpanInBlock()];
  decoder.decode(decodeInputs,decodeIndices,decodeOutputs);
  for (int i=0; i < decodeIndices.length; i++) {
    int missingBlkIdx=convertDecodeIndexBack(decodeIndices[i],dataBlkNum,parityBlkNum);
    StripingChunk chunk=alignedStripe.chunks[missingBlkIdx];
    if (chunk.state == StripingChunk.MISSING) {
      int srcPos=0;
      for (int j=0; j < chunk.offsetsInBuf.size(); j++) {
        System.arraycopy(decodeOutputs[i],srcPos,buf,chunk.offsetsInBuf.get(j),chunk.lengthsInBuf.get(j));
        srcPos+=chunk.lengthsInBuf.get(j);
      }
    }
  }
}
