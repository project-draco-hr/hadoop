{
  int dataBlkNum=ecSchema.getNumDataUnits();
  StripingCell[] cells=getStripingCellsOfByteRange(ecSchema,cellSize,blockGroup,rangeStartInBlockGroup,rangeEndInBlockGroup);
  VerticalRange[] ranges=getRangesForInternalBlocks(ecSchema,cellSize,cells);
  AlignedStripe[] stripes=mergeRangesForInternalBlocks(ecSchema,ranges);
  calcualteChunkPositionsInBuf(ecSchema,cellSize,stripes,cells,buf,offsetInBuf);
  prepareAllZeroChunks(blockGroup,buf,stripes,cellSize,dataBlkNum);
  return stripes;
}
