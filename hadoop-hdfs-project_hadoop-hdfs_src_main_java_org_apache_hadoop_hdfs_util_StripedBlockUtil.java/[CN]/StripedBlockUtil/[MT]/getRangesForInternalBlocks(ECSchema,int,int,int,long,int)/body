{
  int cellSize=ecSchema.getChunkSize();
  int dataBlkNum=ecSchema.getNumDataUnits();
  StripingCell firstCell=new StripingCell(ecSchema,firstCellIdxInBG);
  StripingCell lastCell=new StripingCell(ecSchema,lastCellIdxInBG);
  VerticalRange ranges[]=new VerticalRange[dataBlkNum];
  ranges[firstCell.idxInStripe]=new VerticalRange(firstCellOffsetInBlk,firstCellSize);
  for (int i=firstCellIdxInBG + 1; i < lastCellIdxInBG; i++) {
    StripingCell cell=new StripingCell(ecSchema,i);
    if (ranges[cell.idxInStripe] == null) {
      ranges[cell.idxInStripe]=new VerticalRange(cell.idxInInternalBlk * cellSize,cellSize);
    }
 else {
      ranges[cell.idxInStripe].spanInBlock+=cellSize;
    }
  }
  if (ranges[lastCell.idxInStripe] == null) {
    ranges[lastCell.idxInStripe]=new VerticalRange(lastCell.idxInInternalBlk * cellSize,lastCellSize);
  }
 else   if (lastCell.idxInBlkGroup != firstCell.idxInBlkGroup) {
    ranges[lastCell.idxInStripe].spanInBlock+=lastCellSize;
  }
  return ranges;
}
