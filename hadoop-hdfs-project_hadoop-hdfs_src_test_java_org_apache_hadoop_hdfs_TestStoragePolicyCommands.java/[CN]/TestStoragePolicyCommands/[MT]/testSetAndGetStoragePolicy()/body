{
  final Path foo=new Path("/foo");
  final Path bar=new Path(foo,"bar");
  DFSTestUtil.createFile(fs,bar,SIZE,REPL,0);
  DFSTestUtil.DFSAdminRun("-getStoragePolicy /foo",0,"The storage policy of " + foo.toString() + " is unspecified",conf);
  DFSTestUtil.DFSAdminRun("-getStoragePolicy /foo/bar",0,"The storage policy of " + bar.toString() + " is unspecified",conf);
  DFSTestUtil.DFSAdminRun("-setStoragePolicy /foo WARM",0,"Set storage policy WARM on " + foo.toString(),conf);
  DFSTestUtil.DFSAdminRun("-setStoragePolicy /foo/bar COLD",0,"Set storage policy COLD on " + bar.toString(),conf);
  DFSTestUtil.DFSAdminRun("-setStoragePolicy /fooz WARM",-1,"File/Directory does not exist: /fooz",conf);
  final BlockStoragePolicySuite suite=BlockStoragePolicySuite.createDefaultSuite();
  final BlockStoragePolicy warm=suite.getPolicy("WARM");
  final BlockStoragePolicy cold=suite.getPolicy("COLD");
  DFSTestUtil.DFSAdminRun("-getStoragePolicy /foo",0,"The storage policy of " + foo.toString() + ":\n"+ warm,conf);
  DFSTestUtil.DFSAdminRun("-getStoragePolicy /foo/bar",0,"The storage policy of " + bar.toString() + ":\n"+ cold,conf);
  DFSTestUtil.DFSAdminRun("-getStoragePolicy /fooz",-1,"File/Directory does not exist: /fooz",conf);
}
