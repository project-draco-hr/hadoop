{
  TaskInfo taskInfo=info.tasksMap.get(event.getTaskId());
  if (taskInfo == null) {
    LOG.warn("TaskInfo is null for TaskAttemptUnsuccessfulCompletionEvent" + " taskId:  " + event.getTaskId().toString());
    return;
  }
  TaskAttemptInfo attemptInfo=taskInfo.attemptsMap.get(event.getTaskAttemptId());
  if (attemptInfo == null) {
    LOG.warn("AttemptInfo is null for TaskAttemptUnsuccessfulCompletionEvent" + " taskAttemptId:  " + event.getTaskAttemptId().toString());
    return;
  }
  attemptInfo.finishTime=event.getFinishTime();
  attemptInfo.error=StringInterner.weakIntern(event.getError());
  attemptInfo.status=StringInterner.weakIntern(event.getTaskStatus());
  attemptInfo.hostname=StringInterner.weakIntern(event.getHostname());
  attemptInfo.port=event.getPort();
  attemptInfo.rackname=StringInterner.weakIntern(event.getRackName());
  attemptInfo.shuffleFinishTime=event.getFinishTime();
  attemptInfo.sortFinishTime=event.getFinishTime();
  attemptInfo.mapFinishTime=event.getFinishTime();
  attemptInfo.counters=event.getCounters();
  if (TaskStatus.State.SUCCEEDED.toString().equals(taskInfo.status)) {
    if (attemptInfo.getAttemptId().equals(taskInfo.getSuccessfulAttemptId())) {
      taskInfo.counters=null;
      taskInfo.finishTime=-1;
      taskInfo.status=null;
      taskInfo.successfulAttemptId=null;
    }
  }
  info.completedTaskAttemptsMap.put(event.getTaskAttemptId(),attemptInfo);
}
