{
  this.conf=conf;
  this.role=role;
  this.haEnabled=DFSUtil.isHAEnabled(conf);
  this.haContext=new NameNodeHAContext();
  try {
    initializeGenericKeys(conf,getNameServiceId(conf));
    initialize(conf);
    if (!haEnabled) {
      state=ACTIVE_STATE;
    }
 else {
      state=STANDBY_STATE;
      ;
    }
    state.enterState(haContext);
  }
 catch (  IOException e) {
    this.stop();
    throw e;
  }
catch (  ServiceFailedException e) {
    this.stop();
    throw new IOException("Service failed to start",e);
  }
catch (  HadoopIllegalArgumentException e) {
    this.stop();
    throw e;
  }
}
