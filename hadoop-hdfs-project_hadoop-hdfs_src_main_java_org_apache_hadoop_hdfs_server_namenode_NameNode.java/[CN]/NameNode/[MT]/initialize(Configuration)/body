{
  UserGroupInformation.setConfiguration(conf);
  loginAsNameNodeUser(conf);
  NameNode.initMetrics(conf,this.getRole());
  StartupProgressMetrics.register(startupProgress);
  if (NamenodeRole.NAMENODE == role) {
    startHttpServer(conf);
    validateConfigurationSettingsOrAbort(conf);
  }
  loadNamesystem(conf);
  rpcServer=createRpcServer(conf);
  if (NamenodeRole.NAMENODE == role) {
    httpServer.setNameNodeAddress(getNameNodeAddress());
    httpServer.setFSImage(getFSImage());
  }
 else {
    validateConfigurationSettingsOrAbort(conf);
  }
  pauseMonitor=new JvmPauseMonitor(conf);
  pauseMonitor.start();
  startCommonServices(conf);
}
