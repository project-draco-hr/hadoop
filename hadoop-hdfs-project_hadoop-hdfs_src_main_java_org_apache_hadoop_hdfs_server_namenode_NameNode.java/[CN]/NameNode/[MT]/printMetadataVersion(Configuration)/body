{
  final String nsId=DFSUtil.getNamenodeNameServiceId(conf);
  final String namenodeId=HAUtil.getNameNodeId(conf,nsId);
  NameNode.initializeGenericKeys(conf,nsId,namenodeId);
  final FSImage fsImage=new FSImage(conf);
  final FSNamesystem fs=new FSNamesystem(conf,fsImage,false);
  return fsImage.recoverTransitionRead(StartupOption.METADATAVERSION,fs,null);
}
