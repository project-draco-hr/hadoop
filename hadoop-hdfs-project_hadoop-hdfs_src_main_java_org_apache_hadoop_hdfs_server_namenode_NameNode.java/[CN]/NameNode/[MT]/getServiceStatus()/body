{
  namesystem.checkSuperuserPrivilege();
  if (!haEnabled) {
    throw new ServiceFailedException("HA for namenode is not enabled");
  }
  if (state == null) {
    return new HAServiceStatus(HAServiceState.INITIALIZING);
  }
  HAServiceState retState=state.getServiceState();
  HAServiceStatus ret=new HAServiceStatus(retState);
  if (retState == HAServiceState.STANDBY) {
    String safemodeTip=namesystem.getSafeModeTip();
    if (!safemodeTip.isEmpty()) {
      ret.setNotReadyToBecomeActive("The NameNode is in safemode. " + safemodeTip);
    }
 else {
      ret.setReadyToBecomeActive();
    }
  }
 else   if (retState == HAServiceState.ACTIVE) {
    ret.setReadyToBecomeActive();
  }
 else {
    ret.setNotReadyToBecomeActive("State is " + state);
  }
  return ret;
}
