{
  namesystem.checkSuperuserPrivilege();
  if (!haEnabled) {
    throw new ServiceFailedException("HA for namenode is not enabled");
  }
  if (state == null) {
    return new HAServiceStatus(HAServiceState.INITIALIZING);
  }
  HAServiceState retState=state.getServiceState();
  HAServiceStatus ret=new HAServiceStatus(retState);
  if (retState == HAServiceState.STANDBY) {
    if (namesystem.isInSafeMode()) {
      ret.setNotReadyToBecomeActive("The NameNode is in safemode. " + namesystem.getSafeModeTip());
    }
 else {
      ret.setReadyToBecomeActive();
    }
  }
 else   if (retState == HAServiceState.ACTIVE) {
    ret.setReadyToBecomeActive();
  }
 else {
    ret.setNotReadyToBecomeActive("State is " + state);
  }
  return ret;
}
