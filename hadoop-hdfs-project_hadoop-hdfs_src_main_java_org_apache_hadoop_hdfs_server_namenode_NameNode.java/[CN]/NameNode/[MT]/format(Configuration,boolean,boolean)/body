{
  String nsId=DFSUtil.getNamenodeNameServiceId(conf);
  String namenodeId=HAUtil.getNameNodeId(conf,nsId);
  initializeGenericKeys(conf,nsId,namenodeId);
  checkAllowFormat(conf);
  Collection<URI> dirsToFormat=FSNamesystem.getNamespaceDirs(conf);
  List<URI> editDirsToFormat=FSNamesystem.getNamespaceEditsDirs(conf);
  if (!confirmFormat(dirsToFormat,force,isInteractive)) {
    return true;
  }
  String clusterId=StartupOption.FORMAT.getClusterId();
  if (clusterId == null || clusterId.equals("")) {
    clusterId=NNStorage.newClusterID();
  }
  System.out.println("Formatting using clusterid: " + clusterId);
  FSImage fsImage=new FSImage(conf,dirsToFormat,editDirsToFormat);
  FSNamesystem fsn=new FSNamesystem(conf,fsImage);
  fsImage.format(fsn,clusterId);
  return false;
}
