{
  if ((nameserviceId != null && !nameserviceId.isEmpty()) || (namenodeId != null && !namenodeId.isEmpty())) {
    if (nameserviceId != null) {
      conf.set(DFS_FEDERATION_NAMESERVICE_ID,nameserviceId);
    }
    if (namenodeId != null) {
      conf.set(DFS_HA_NAMENODE_ID_KEY,namenodeId);
    }
    DFSUtil.setGenericConf(conf,nameserviceId,namenodeId,NAMENODE_SPECIFIC_KEYS);
    DFSUtil.setGenericConf(conf,nameserviceId,null,NAMESERVICE_SPECIFIC_KEYS);
  }
  if (conf.get(DFS_NAMENODE_RPC_ADDRESS_KEY) != null) {
    URI defaultUri=URI.create(HdfsConstants.HDFS_URI_SCHEME + "://" + conf.get(DFS_NAMENODE_RPC_ADDRESS_KEY));
    conf.set(FS_DEFAULT_NAME_KEY,defaultUri.toString());
  }
}
