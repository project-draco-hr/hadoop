{
  String host=uri.getHost();
  if (host == null) {
    return uri;
  }
  String fqHost=canonicalizeHost(host);
  int port=uri.getPort();
  if (host.equals(fqHost) && port != -1) {
    return uri;
  }
  try {
    uri=new URI(uri.getScheme(),uri.getUserInfo(),fqHost,(port == -1) ? defaultPort : port,uri.getPath(),uri.getQuery(),uri.getFragment());
  }
 catch (  URISyntaxException e) {
    throw new IllegalArgumentException(e);
  }
  return uri;
}
