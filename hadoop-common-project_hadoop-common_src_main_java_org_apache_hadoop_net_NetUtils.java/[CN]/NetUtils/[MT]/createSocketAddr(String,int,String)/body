{
  String helpText="";
  if (configName != null) {
    helpText=" (configuration property '" + configName + "')";
  }
  if (target == null) {
    throw new IllegalArgumentException("Target address cannot be null." + helpText);
  }
  int colonIndex=target.indexOf(':');
  if (colonIndex < 0 && defaultPort == -1) {
    throw new RuntimeException("Not a host:port pair: " + target + helpText);
  }
  String hostname;
  int port=-1;
  if (!target.contains("/")) {
    if (colonIndex == -1) {
      hostname=target;
    }
 else {
      hostname=target.substring(0,colonIndex);
      String portStr=target.substring(colonIndex + 1);
      try {
        port=Integer.parseInt(portStr);
      }
 catch (      NumberFormatException nfe) {
        throw new IllegalArgumentException("Can't parse port '" + portStr + "'"+ helpText);
      }
    }
  }
 else {
    URI addr=new Path(target).toUri();
    hostname=addr.getHost();
    port=addr.getPort();
  }
  if (port == -1) {
    port=defaultPort;
  }
  if (getStaticResolution(hostname) != null) {
    hostname=getStaticResolution(hostname);
  }
  return new InetSocketAddress(hostname,port);
}
