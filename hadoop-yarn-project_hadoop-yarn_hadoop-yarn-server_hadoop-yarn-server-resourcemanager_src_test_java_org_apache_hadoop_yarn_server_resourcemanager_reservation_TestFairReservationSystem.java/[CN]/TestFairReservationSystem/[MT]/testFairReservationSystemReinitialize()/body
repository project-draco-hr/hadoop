{
  ReservationSystemTestUtil.setupFSAllocationFile(ALLOC_FILE);
  ReservationSystemTestUtil testUtil=new ReservationSystemTestUtil();
  RMContext mockContext=testUtil.createRMContext(conf);
  setupFairScheduler(testUtil,mockContext);
  FairReservationSystem reservationSystem=new FairReservationSystem();
  reservationSystem.setRMContext(mockContext);
  try {
    reservationSystem.reinitialize(scheduler.getConf(),mockContext);
  }
 catch (  YarnException e) {
    Assert.fail(e.getMessage());
  }
  final String planQNam=testUtil.getFullReservationQueueName();
  ReservationSystemTestUtil.validateReservationQueue(reservationSystem,planQNam);
  ReservationSystemTestUtil.updateFSAllocationFile(ALLOC_FILE);
  scheduler.reinitialize(conf,mockContext);
  try {
    reservationSystem.reinitialize(conf,mockContext);
  }
 catch (  YarnException e) {
    Assert.fail(e.getMessage());
  }
  String newQueue="root.reservation";
  ReservationSystemTestUtil.validateNewReservationQueue(reservationSystem,newQueue);
}
