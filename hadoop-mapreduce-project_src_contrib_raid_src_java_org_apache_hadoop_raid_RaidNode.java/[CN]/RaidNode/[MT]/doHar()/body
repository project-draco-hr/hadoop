{
  long prevExec=0;
  while (running) {
    while (now() < prevExec + configMgr.getPeriodicity()) {
      Thread.sleep(SLEEP_TIME);
    }
    LOG.info("Started archive scan");
    prevExec=now();
    for (    PolicyList category : configMgr.getAllPolicies()) {
      for (      PolicyInfo info : category.getAll()) {
        String tmpHarPath=tmpHarPathForCode(conf,info.getErasureCode());
        String str=info.getProperty("time_before_har");
        if (str != null) {
          try {
            long cutoff=now() - (Long.parseLong(str) * 24L * 3600000L);
            Path destPref=getDestinationPath(info.getErasureCode(),conf);
            FileSystem destFs=destPref.getFileSystem(conf);
            Path[] srcPaths=info.getSrcPathExpanded();
            if (srcPaths != null) {
              for (              Path srcPath : srcPaths) {
                Path destPath=getOriginalParityFile(destPref,srcPath);
                FileStatus stat=null;
                try {
                  stat=destFs.getFileStatus(destPath);
                }
 catch (                FileNotFoundException e) {
                }
                if (stat != null) {
                  LOG.info("Haring parity files for policy " + info.getName() + " "+ destPath);
                  recurseHar(info,destFs,stat,destPref.toUri().getPath(),srcPath.getFileSystem(conf),cutoff,tmpHarPath);
                }
              }
            }
          }
 catch (          Exception e) {
            LOG.warn("Ignoring Exception while processing policy " + info.getName() + " "+ StringUtils.stringifyException(e));
          }
        }
      }
    }
  }
  return;
}
