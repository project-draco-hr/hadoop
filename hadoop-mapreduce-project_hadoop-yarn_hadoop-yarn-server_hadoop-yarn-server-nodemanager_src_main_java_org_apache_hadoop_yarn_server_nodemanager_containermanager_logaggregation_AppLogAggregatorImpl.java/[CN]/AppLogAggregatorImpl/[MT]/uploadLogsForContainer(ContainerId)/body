{
  if (this.logAggregationDisabled) {
    return;
  }
  if (this.writer == null) {
    LOG.info("Starting aggregate log-file for app " + this.applicationId);
    try {
      this.writer=new LogWriter(this.conf,this.remoteNodeLogFileForApp,this.userUgi);
    }
 catch (    IOException e) {
      LOG.error("Cannot create writer for app " + this.applicationId + ". Disabling log-aggregation for this app.",e);
      this.logAggregationDisabled=true;
      return;
    }
  }
  LOG.info("Uploading logs for container " + containerId);
  LogKey logKey=new LogKey(containerId);
  LogValue logValue=new LogValue(this.rootLogDirs,containerId);
  try {
    this.writer.append(logKey,logValue);
  }
 catch (  IOException e) {
    LOG.error("Couldn't upload logs for " + containerId + ". Skipping this container.");
  }
}
