{
  for (int i=0; i < NUM_FILES; i++) {
    Random rand=new Random(System.currentTimeMillis() + i);
    InetSocketAddress datanode[]=getDatanodes(rand);
    Path p=new Path("/filename" + i);
    FSDataOutputStream out=dfs.create(p,FsPermission.getDefault(),true,4096,(short)3,(long)4096,null,datanode);
    out.write(SOME_BYTES);
    out.close();
    BlockLocation[] locations=dfs.getClient().getBlockLocations(p.toUri().getPath(),0,Long.MAX_VALUE);
    assertTrue(locations.length == 1 && locations[0].getHosts().length == 3);
    for (    BlockLocation loc : locations) {
      String[] hosts=loc.getNames();
      String[] hosts1=getStringForInetSocketAddrs(datanode);
      assertTrue(compareNodes(hosts,hosts1));
    }
  }
}
