{
  Random rand=new Random(System.currentTimeMillis());
  int port=rand.nextInt(65535);
  while (true) {
    boolean conflict=false;
    for (    DataNode d : datanodes) {
      if (d.getXferAddress().getPort() == port) {
        port=rand.nextInt(65535);
        conflict=true;
      }
    }
    if (conflict == false) {
      break;
    }
  }
  return new InetSocketAddress(InetAddress.getLocalHost(),port);
}
