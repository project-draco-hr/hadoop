{
  Configuration rmConf=new YarnConfiguration();
  String schedulerClass=rmConf.get(YarnConfiguration.RM_SCHEDULER);
  if (Class.forName(schedulerClass) == CapacityScheduler.class) {
    rmConf.set(YarnConfiguration.RM_SCHEDULER,SLSCapacityScheduler.class.getName());
  }
 else {
    rmConf.set(YarnConfiguration.RM_SCHEDULER,ResourceSchedulerWrapper.class.getName());
    rmConf.set(SLSConfiguration.RM_SCHEDULER,schedulerClass);
  }
  rmConf.set(SLSConfiguration.METRICS_OUTPUT_DIR,metricsOutputDir);
  rm=new ResourceManager();
  rm.init(rmConf);
  rm.start();
}
