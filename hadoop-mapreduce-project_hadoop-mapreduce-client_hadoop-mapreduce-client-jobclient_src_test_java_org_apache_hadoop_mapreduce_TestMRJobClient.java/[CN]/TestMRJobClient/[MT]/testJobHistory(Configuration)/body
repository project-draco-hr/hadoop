{
  CLI jc=createJobClient();
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  File f=new File("src/test/resources/job_1329348432655_0001-10.jhist");
  FileSystem localFs=FileSystem.getLocal(conf);
  String historyFileUri=new Path(f.getAbsolutePath()).makeQualified(localFs.getUri(),localFs.getWorkingDirectory()).toUri().toString();
  int exitCode=runTool(conf,jc,new String[]{"-history","pul",historyFileUri},out);
  assertEquals("Exit code",-1,exitCode);
  exitCode=runTool(conf,jc,new String[]{"-history","all",historyFileUri},out);
  assertEquals("Exit code",0,exitCode);
  String line;
  BufferedReader br=new BufferedReader(new InputStreamReader(new ByteArrayInputStream(out.toByteArray())));
  int counter=0;
  while ((line=br.readLine()) != null) {
    LOG.info("line = " + line);
    if (line.startsWith("task_")) {
      counter++;
    }
  }
  assertEquals(23,counter);
}
