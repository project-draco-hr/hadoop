{
  FileSystem fileSys=null;
  try {
    final int taskTrackers=2;
    JobConf conf=new JobConf();
    fileSys=FileSystem.get(conf);
    conf.set(JTConfig.JT_IPC_HANDLER_COUNT,"1");
    conf.set(JTConfig.JT_IPC_ADDRESS,"127.0.0.1:0");
    conf.set(JTConfig.JT_HTTP_ADDRESS,"127.0.0.1:0");
    conf.set(TTConfig.TT_HTTP_ADDRESS,"127.0.0.1:0");
    mr=new MiniMRCluster(taskTrackers,fileSys.getUri().toString(),1,null,null,conf);
    assertTrue(launchEmptyJob(fileSys.getUri(),3,1));
    assertTrue(launchEmptyJob(fileSys.getUri(),0,0));
  }
  finally {
    if (fileSys != null) {
      fileSys.close();
    }
    if (mr != null) {
      mr.shutdown();
    }
  }
}
