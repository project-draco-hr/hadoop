{
  final short expected=bc.getPreferredBlockReplication();
  for (  BlockInfo block : bc.getBlocks()) {
    final NumberReplicas n=countNodes(block);
    if (isNeededReplication(block,expected,n.liveReplicas())) {
      neededReplications.add(block,n.liveReplicas(),n.decommissionedAndDecommissioning(),expected);
    }
 else     if (n.liveReplicas() > expected) {
      processOverReplicatedBlock(block,expected,null,null);
    }
  }
}
