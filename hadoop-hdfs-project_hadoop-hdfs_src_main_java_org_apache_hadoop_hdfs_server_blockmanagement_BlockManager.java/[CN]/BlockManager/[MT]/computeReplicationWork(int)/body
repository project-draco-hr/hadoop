{
  List<List<Block>> blocksToReplicate=chooseUnderReplicatedBlocks(blocksToProcess);
  int scheduledReplicationCount=0;
  for (int i=0; i < blocksToReplicate.size(); i++) {
    for (    Block block : blocksToReplicate.get(i)) {
      if (computeReplicationWorkForBlock(block,i)) {
        scheduledReplicationCount++;
      }
    }
  }
  return scheduledReplicationCount;
}
