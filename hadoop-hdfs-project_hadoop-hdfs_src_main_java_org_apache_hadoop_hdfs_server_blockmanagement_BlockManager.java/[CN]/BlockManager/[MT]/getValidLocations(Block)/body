{
  final List<DatanodeStorageInfo> locations=new ArrayList<DatanodeStorageInfo>(blocksMap.numNodes(block));
  for (  DatanodeStorageInfo storage : blocksMap.getStorages(block)) {
    if (!invalidateBlocks.contains(storage.getDatanodeDescriptor(),block)) {
      locations.add(storage);
    }
  }
  return locations;
}
