{
  Collection<DatanodeDescriptor> nodes=corruptReplicas.getNodes(blk);
  boolean gotException=false;
  if (nodes == null)   return;
  DatanodeDescriptor[] nodesCopy=nodes.toArray(new DatanodeDescriptor[0]);
  for (  DatanodeDescriptor node : nodesCopy) {
    try {
      invalidateBlock(new BlockToMarkCorrupt(blk,null),node);
    }
 catch (    IOException e) {
      blockLog.info("invalidateCorruptReplicas " + "error in deleting bad block " + blk + " on "+ node,e);
      gotException=true;
    }
  }
  if (!gotException)   corruptReplicas.removeFromCorruptReplicasMap(blk);
}
