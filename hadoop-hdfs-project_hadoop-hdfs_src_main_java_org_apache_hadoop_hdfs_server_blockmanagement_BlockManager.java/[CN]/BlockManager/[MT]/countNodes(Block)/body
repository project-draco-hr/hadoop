{
  int count=0;
  int live=0;
  int corrupt=0;
  int excess=0;
  Iterator<DatanodeDescriptor> nodeIter=blocksMap.nodeIterator(b);
  Collection<DatanodeDescriptor> nodesCorrupt=corruptReplicas.getNodes(b);
  while (nodeIter.hasNext()) {
    DatanodeDescriptor node=nodeIter.next();
    if ((nodesCorrupt != null) && (nodesCorrupt.contains(node))) {
      corrupt++;
    }
 else     if (node.isDecommissionInProgress() || node.isDecommissioned()) {
      count++;
    }
 else {
      Collection<Block> blocksExcess=excessReplicateMap.get(node.getStorageID());
      if (blocksExcess != null && blocksExcess.contains(b)) {
        excess++;
      }
 else {
        live++;
      }
    }
  }
  return new NumberReplicas(live,count,corrupt,excess);
}
