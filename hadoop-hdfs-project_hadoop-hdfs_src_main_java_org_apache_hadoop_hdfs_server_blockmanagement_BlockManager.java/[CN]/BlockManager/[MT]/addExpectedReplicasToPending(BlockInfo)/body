{
  DatanodeStorageInfo[] expectedStorages=lastBlock.getUnderConstructionFeature().getExpectedStorageLocations();
  if (expectedStorages.length - lastBlock.numNodes() > 0) {
    ArrayList<DatanodeDescriptor> pendingNodes=new ArrayList<DatanodeDescriptor>();
    for (    DatanodeStorageInfo storage : expectedStorages) {
      DatanodeDescriptor dnd=storage.getDatanodeDescriptor();
      if (lastBlock.findStorageInfo(dnd) == null) {
        pendingNodes.add(dnd);
      }
    }
    pendingReplications.increment(lastBlock,pendingNodes.toArray(new DatanodeDescriptor[pendingNodes.size()]));
  }
}
