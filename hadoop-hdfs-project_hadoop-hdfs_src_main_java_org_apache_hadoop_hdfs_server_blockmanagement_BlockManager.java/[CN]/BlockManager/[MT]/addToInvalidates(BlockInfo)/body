{
  if (!isPopulatingReplQueues()) {
    return;
  }
  StringBuilder datanodes=blockLog.isDebugEnabled() ? new StringBuilder() : null;
  for (  DatanodeStorageInfo storage : blocksMap.getStorages(storedBlock)) {
    if (storage.getState() != State.NORMAL) {
      continue;
    }
    final DatanodeDescriptor node=storage.getDatanodeDescriptor();
    final Block b=getBlockOnStorage(storedBlock,storage);
    if (b != null) {
      invalidateBlocks.add(b,node,false);
      if (datanodes != null) {
        datanodes.append(node).append(" ");
      }
    }
  }
  if (datanodes != null && datanodes.length() != 0) {
    blockLog.debug("BLOCK* addToInvalidates: {} {}",storedBlock,datanodes);
  }
}
