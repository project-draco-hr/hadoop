{
  if (block.isStriped()) {
    final BlockInfoStriped sblock=(BlockInfoStriped)block;
    short dataBlockNum=sblock.getDataBlockNum();
    if (sblock.isComplete() || sblock.getBlockUCState() == BlockUCState.COMMITTED) {
      dataBlockNum=(short)Math.min(dataBlockNum,(sblock.getNumBytes() - 1) / HdfsConstants.BLOCK_STRIPED_CELL_SIZE + 1);
    }
    return dataBlockNum;
  }
 else {
    return minReplication;
  }
}
