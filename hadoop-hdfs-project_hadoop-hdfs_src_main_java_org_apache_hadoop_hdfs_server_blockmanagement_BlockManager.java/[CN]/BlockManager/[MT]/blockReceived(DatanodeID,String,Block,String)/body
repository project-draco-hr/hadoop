{
  namesystem.writeLock();
  try {
    final DatanodeDescriptor node=datanodeManager.getDatanode(nodeID);
    if (node == null || !node.isAlive) {
      final String s=block + " is received from dead or unregistered node " + nodeID.getName();
      NameNode.stateChangeLog.warn("BLOCK* blockReceived: " + s);
      throw new IOException(s);
    }
    if (NameNode.stateChangeLog.isDebugEnabled()) {
      NameNode.stateChangeLog.debug("BLOCK* blockReceived: " + block + " is received from "+ nodeID.getName());
    }
    addBlock(node,block,delHint);
  }
  finally {
    namesystem.writeUnlock();
  }
}
