{
  List<List<BlockInfo>> blocksToReplicate=null;
  namesystem.writeLock();
  try {
    blocksToReplicate=neededReplications.chooseUnderReplicatedBlocks(blocksToProcess);
  }
  finally {
    namesystem.writeUnlock();
  }
  return computeReconstructionWorkForBlocks(blocksToReplicate);
}
