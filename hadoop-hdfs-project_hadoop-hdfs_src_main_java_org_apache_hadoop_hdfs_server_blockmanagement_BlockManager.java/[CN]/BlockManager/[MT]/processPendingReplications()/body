{
  BlockInfo[] timedOutItems=pendingReplications.getTimedOutBlocks();
  if (timedOutItems != null) {
    namesystem.writeLock();
    try {
      for (int i=0; i < timedOutItems.length; i++) {
        BlockInfo bi=blocksMap.getStoredBlock(timedOutItems[i]);
        if (bi == null) {
          continue;
        }
        NumberReplicas num=countNodes(timedOutItems[i]);
        if (isNeededReplication(bi,getReplication(bi),num.liveReplicas())) {
          neededReplications.add(bi,num.liveReplicas(),num.decommissionedAndDecommissioning(),getReplication(bi));
        }
      }
    }
  finally {
      namesystem.writeUnlock();
    }
  }
}
