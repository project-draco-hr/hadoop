{
  final List<DatanodeStorageInfo> locations=getValidLocations(block);
  if (locations.size() == 0) {
    return 0;
  }
 else {
    final String[] datanodeUuids=new String[locations.size()];
    final String[] storageIDs=new String[datanodeUuids.length];
    final StorageType[] storageTypes=new StorageType[datanodeUuids.length];
    for (int i=0; i < locations.size(); i++) {
      final DatanodeStorageInfo s=locations.get(i);
      datanodeUuids[i]=s.getDatanodeDescriptor().getDatanodeUuid();
      storageIDs[i]=s.getStorageID();
      storageTypes[i]=s.getStorageType();
    }
    results.add(new BlockWithLocations(block,datanodeUuids,storageIDs,storageTypes));
    return block.getNumBytes();
  }
}
