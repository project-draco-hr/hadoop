{
  final Iterator<? extends Block> it=node.getBlockIterator();
  while (it.hasNext()) {
    removeStoredBlock(it.next(),node);
  }
  pendingDNMessages.removeAllMessagesForDatanode(node);
  node.resetBlocks();
  invalidateBlocks.remove(node);
}
