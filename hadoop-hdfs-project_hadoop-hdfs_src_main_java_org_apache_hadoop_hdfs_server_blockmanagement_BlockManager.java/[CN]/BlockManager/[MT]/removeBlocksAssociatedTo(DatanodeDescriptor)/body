{
  for (  DatanodeStorageInfo storage : node.getStorageInfos()) {
    final Iterator<BlockInfo> it=storage.getBlockIterator();
    while (it.hasNext()) {
      BlockInfo block=it.next();
      it.remove();
      removeStoredBlock(block,node);
    }
  }
  pendingDNMessages.removeAllMessagesForDatanode(node);
  node.resetBlocks();
  invalidateBlocks.remove(node);
}
