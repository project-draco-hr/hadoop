{
  final List<DatanodeInfo> nodes=invalidateBlocks.getDatanodes();
  Collections.shuffle(nodes);
  nodesToProcess=Math.min(nodes.size(),nodesToProcess);
  int blockCnt=0;
  for (int nodeCnt=0; nodeCnt < nodesToProcess; nodeCnt++) {
    blockCnt+=invalidateWorkForOneNode(nodes.get(nodeCnt));
  }
  return blockCnt;
}
