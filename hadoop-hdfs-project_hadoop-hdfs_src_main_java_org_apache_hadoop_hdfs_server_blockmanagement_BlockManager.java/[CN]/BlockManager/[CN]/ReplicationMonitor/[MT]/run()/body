{
  while (namesystem.isRunning()) {
    try {
      if (isPopulatingReplQueues()) {
        computeDatanodeWork();
        processPendingReconstructions();
        rescanPostponedMisreplicatedBlocks();
      }
      Thread.sleep(replicationRecheckInterval);
    }
 catch (    Throwable t) {
      if (!namesystem.isRunning()) {
        LOG.info("Stopping ReplicationMonitor.");
        if (!(t instanceof InterruptedException)) {
          LOG.info("ReplicationMonitor received an exception" + " while shutting down.",t);
        }
        break;
      }
 else       if (!checkNSRunning && t instanceof InterruptedException) {
        LOG.info("Stopping ReplicationMonitor for testing.");
        break;
      }
      LOG.error("ReplicationMonitor thread received Runtime exception. ",t);
      terminate(1,t);
    }
  }
}
