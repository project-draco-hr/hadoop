{
  while (namesystem.isRunning()) {
    try {
      computeDatanodeWork();
      processPendingReplications();
      Thread.sleep(replicationRecheckInterval);
    }
 catch (    Throwable t) {
      if (!namesystem.isRunning()) {
        LOG.info("Stopping ReplicationMonitor.");
        if (!(t instanceof InterruptedException)) {
          LOG.info("ReplicationMonitor received an exception" + " while shutting down.",t);
        }
        break;
      }
      LOG.fatal("ReplicationMonitor thread received Runtime exception. ",t);
      terminate(1,t);
    }
  }
}
