{
  JobContext jobContext=mock(JobContext.class);
  Configuration configuration=new Configuration();
  configuration.setInt(MRJobConfig.NUM_MAPS,1);
  when(jobContext.getConfiguration()).thenReturn(configuration);
  DataDrivenDBInputFormat<NullDBWritable> format=new DataDrivenDBInputFormat<NullDBWritable>();
  List<InputSplit> splits=format.getSplits(jobContext);
  assertEquals(1,splits.size());
  DataDrivenDBInputSplit split=(DataDrivenDBInputSplit)splits.get(0);
  assertEquals("1=1",split.getLowerClause());
  assertEquals("1=1",split.getUpperClause());
  configuration.setInt(MRJobConfig.NUM_MAPS,2);
  DataDrivenDBInputFormat.setBoundingQuery(configuration,"query");
  assertEquals("query",configuration.get(DBConfiguration.INPUT_BOUNDING_QUERY));
  Job job=mock(Job.class);
  when(job.getConfiguration()).thenReturn(configuration);
  DataDrivenDBInputFormat.setInput(job,NullDBWritable.class,"query","Bounding Query");
  assertEquals("Bounding Query",configuration.get(DBConfiguration.INPUT_BOUNDING_QUERY));
}
