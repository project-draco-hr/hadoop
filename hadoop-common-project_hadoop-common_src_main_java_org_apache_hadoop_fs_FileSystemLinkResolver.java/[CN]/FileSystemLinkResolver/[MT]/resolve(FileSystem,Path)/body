{
  int count=0;
  T in=null;
  Path p=path;
  FileSystem fs=filesys;
  for (boolean isLink=true; isLink; ) {
    try {
      in=doCall(p);
      isLink=false;
    }
 catch (    UnresolvedLinkException e) {
      if (!filesys.resolveSymlinks) {
        throw new IOException("Path " + path + " contains a symlink"+ " and symlink resolution is disabled ("+ CommonConfigurationKeys.FS_CLIENT_RESOLVE_REMOTE_SYMLINKS_KEY+ ").",e);
      }
      if (count++ > FsConstants.MAX_PATH_LINKS) {
        throw new IOException("Possible cyclic loop while " + "following symbolic link " + path);
      }
      p=FSLinkResolver.qualifySymlinkTarget(fs.getUri(),p,filesys.resolveLink(p));
      fs=FileSystem.getFSofPath(p,filesys.getConf());
      if (!fs.equals(filesys)) {
        return next(fs,p);
      }
    }
  }
  return in;
}
