{
  final String prop=String.format("javaSort.%sJobs.inputFiles",size);
  final String indir=getInputDirsFor(prop,size.defaultPath(VARINFLTEXT));
  final String outdir=addTSSuffix("perf-out/sort-out-dir-" + size);
  clearDir(outdir);
  try {
    Configuration conf=new Configuration();
    conf.setBoolean(FileOutputFormat.COMPRESS,outputCompressed);
    conf.setBoolean(MRJobConfig.MAP_OUTPUT_COMPRESS,mapoutputCompressed);
    Job job=new Job(conf);
    job.setJarByClass(Sort.class);
    job.setJobName("GridmixJavaSorter." + size);
    job.setMapperClass(Mapper.class);
    job.setReducerClass(Reducer.class);
    job.setNumReduceTasks(numReducers);
    job.setInputFormatClass(KeyValueTextInputFormat.class);
    job.setOutputFormatClass(TextOutputFormat.class);
    job.setOutputKeyClass(org.apache.hadoop.io.Text.class);
    job.setOutputValueClass(org.apache.hadoop.io.Text.class);
    FileInputFormat.addInputPaths(job,indir);
    FileOutputFormat.setOutputPath(job,new Path(outdir));
    ControlledJob cjob=new ControlledJob(job,null);
    gridmix.addJob(cjob);
  }
 catch (  Exception ex) {
    ex.printStackTrace();
  }
}
