{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Rolling current file: " + curFile.getAbsolutePath() + " to previous file: "+ prevFile.getAbsolutePath());
  }
  if (!prevFile.delete() && prevFile.exists()) {
    throw new IOException("Could not delete " + prevFile);
  }
  close();
  if (!curFile.renameTo(prevFile)) {
    throw new IOException("Could not rename " + curFile + " to "+ prevFile);
  }
}
