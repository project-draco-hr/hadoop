{
  JobConf conf=new JobConf();
  fileSys=FileSystem.get(conf);
  fileSys.delete(new Path(TEST_ROOT_DIR),true);
  conf.set("mapred.job.tracker.handler.count","1");
  conf.set("mapred.job.tracker","127.0.0.1:0");
  conf.set("mapred.job.tracker.http.address","127.0.0.1:0");
  conf.set("mapred.task.tracker.http.address","127.0.0.1:0");
  conf.set(JHAdminConfig.MR_HISTORY_INTERMEDIATE_DONE_DIR,TEST_ROOT_DIR + "/intermediate");
  conf.set(org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.SUCCESSFUL_JOB_OUTPUT_DIR_MARKER,"true");
  mr=new MiniMRCluster(1,"file:///",1,null,null,conf);
  inDir=new Path(TEST_ROOT_DIR,"test-input");
  String input="The quick brown fox\n" + "has many silly\n" + "red fox sox\n";
  DataOutputStream file=fileSys.create(new Path(inDir,"part-" + 0));
  file.writeBytes(input);
  file.close();
  emptyInDir=new Path(TEST_ROOT_DIR,"empty-input");
  fileSys.mkdirs(emptyInDir);
}
