{
  if (node.right == null) {
    if (node.left != null) {
      attachToParent(node,node.left);
    }
 else {
      attachNullToParent(node);
    }
  }
 else   if (node.left == null) {
    attachToParent(node,node.right);
  }
 else {
    Node<E> toMoveUp=node.next;
    if (toMoveUp.right == null) {
      attachNullToParent(toMoveUp);
    }
 else {
      attachToParent(toMoveUp,toMoveUp.right);
    }
    toMoveUp.left=node.left;
    if (toMoveUp.left != null) {
      toMoveUp.left.parent=toMoveUp;
    }
    toMoveUp.right=node.right;
    if (toMoveUp.right != null) {
      toMoveUp.right.parent=toMoveUp;
    }
    attachToParentNoBalance(node,toMoveUp);
    toMoveUp.color=node.color;
  }
  if (node.prev != null) {
    node.prev.next=node.next;
  }
  if (node.next != null) {
    node.next.prev=node.prev;
  }
  nodeCount--;
  cacheAndClear(node);
}
