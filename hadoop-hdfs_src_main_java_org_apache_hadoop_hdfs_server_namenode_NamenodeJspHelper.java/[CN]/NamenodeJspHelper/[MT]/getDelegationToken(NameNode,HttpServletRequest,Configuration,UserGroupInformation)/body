{
  Token<DelegationTokenIdentifier> token=ugi.doAs(new PrivilegedExceptionAction<Token<DelegationTokenIdentifier>>(){
    public Token<DelegationTokenIdentifier> run() throws IOException {
      return nn.getDelegationToken(new Text(ugi.getUserName()));
    }
  }
);
  return token == null ? null : token.encodeToUrlString();
}
