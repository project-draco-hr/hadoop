{
  BlockPoolTokenSecretManager bpMgr=new BlockPoolTokenSecretManager();
  for (int i=0; i < 10; i++) {
    String bpid=Integer.toString(i);
    BlockTokenSecretManager masterHandler=new BlockTokenSecretManager(true,blockKeyUpdateInterval,blockTokenLifetime);
    BlockTokenSecretManager slaveHandler=new BlockTokenSecretManager(false,blockKeyUpdateInterval,blockTokenLifetime);
    bpMgr.addBlockPool(bpid,slaveHandler);
    ExportedBlockKeys keys=masterHandler.exportKeys();
    bpMgr.setKeys(bpid,keys);
    tokenGenerationAndVerification(masterHandler,bpMgr.get(bpid));
    masterHandler.updateKeys();
    tokenGenerationAndVerification(masterHandler,bpMgr.get(bpid));
    keys=masterHandler.exportKeys();
    bpMgr.setKeys(bpid,keys);
    tokenGenerationAndVerification(masterHandler,bpMgr.get(bpid));
  }
}
