{
  LOG.info("creating control file: " + megaBytes + " bytes, "+ numFiles+ " files");
  Path controlFile=new Path(CONTROL_DIR,"files");
  fs.delete(controlFile,true);
  Random random=new Random(seed);
  SequenceFile.Writer writer=SequenceFile.createWriter(fs,conf,controlFile,Text.class,LongWritable.class,CompressionType.NONE);
  long totalSize=0;
  long maxSize=((megaBytes / numFiles) * 2) + 1;
  try {
    while (totalSize < megaBytes) {
      Text name=new Text(Long.toString(random.nextLong()));
      long size=random.nextLong();
      if (size < 0)       size=-size;
      size=size % maxSize;
      writer.append(name,new LongWritable(size));
      totalSize+=size;
    }
  }
  finally {
    writer.close();
  }
  LOG.info("created control file for: " + totalSize + " bytes");
}
