{
  if (schedulingMode == SchedulingMode.RESPECT_PARTITION_EXCLUSIVITY) {
    Resource queueMaxResource=Resources.multiplyAndNormalizeDown(resourceCalculator,labelManager.getResourceByLabel(nodePartition,clusterResource),queueCapacities.getAbsoluteMaximumCapacity(nodePartition),minimumAllocation);
    if (nodePartition.equals(RMNodeLabelsManager.NO_LABEL)) {
      return Resources.min(resourceCalculator,clusterResource,queueMaxResource,currentResourceLimits.getLimit());
    }
    return queueMaxResource;
  }
 else   if (schedulingMode == SchedulingMode.IGNORE_PARTITION_EXCLUSIVITY) {
    return labelManager.getResourceByLabel(nodePartition,clusterResource);
  }
  return Resources.none();
}
