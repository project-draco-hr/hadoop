{
  if (schedulingMode == SchedulingMode.RESPECT_PARTITION_EXCLUSIVITY) {
    Resource queueMaxResource=getQueueMaxResource(nodePartition,clusterResource);
    return Resources.min(resourceCalculator,clusterResource,queueMaxResource,currentResourceLimits.getLimit());
  }
 else   if (schedulingMode == SchedulingMode.IGNORE_PARTITION_EXCLUSIVITY) {
    return labelManager.getResourceByLabel(nodePartition,clusterResource);
  }
  return Resources.none();
}
