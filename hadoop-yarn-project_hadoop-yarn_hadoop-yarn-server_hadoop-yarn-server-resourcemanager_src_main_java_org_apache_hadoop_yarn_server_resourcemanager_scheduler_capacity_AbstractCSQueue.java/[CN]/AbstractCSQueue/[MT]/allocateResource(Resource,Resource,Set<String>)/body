{
  Resources.addTo(usedResources,resource);
  if (nodeLabels == null || nodeLabels.isEmpty()) {
    if (!usedResourcesByNodeLabels.containsKey(RMNodeLabelsManager.NO_LABEL)) {
      usedResourcesByNodeLabels.put(RMNodeLabelsManager.NO_LABEL,Resources.createResource(0));
    }
    Resources.addTo(usedResourcesByNodeLabels.get(RMNodeLabelsManager.NO_LABEL),resource);
  }
 else {
    for (    String label : Sets.intersection(accessibleLabels,nodeLabels)) {
      if (!usedResourcesByNodeLabels.containsKey(label)) {
        usedResourcesByNodeLabels.put(label,Resources.createResource(0));
      }
      Resources.addTo(usedResourcesByNodeLabels.get(label),resource);
    }
  }
  ++numContainers;
  CSQueueUtils.updateQueueStatistics(resourceCalculator,this,getParent(),clusterResource,minimumAllocation);
}
