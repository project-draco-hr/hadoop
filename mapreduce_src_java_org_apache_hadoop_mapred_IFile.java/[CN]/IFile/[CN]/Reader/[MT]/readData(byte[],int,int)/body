{
  int bytesRead=0;
  while (bytesRead < len) {
    int n=in.read(buf,off + bytesRead,len - bytesRead);
    if (n < 0) {
      return bytesRead;
    }
    bytesRead+=n;
  }
  return len;
}
