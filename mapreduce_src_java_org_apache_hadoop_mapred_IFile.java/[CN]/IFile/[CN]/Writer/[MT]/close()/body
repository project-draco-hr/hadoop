{
  if (keyClass != null) {
    keySerializer.close();
    valueSerializer.close();
  }
  WritableUtils.writeVInt(out,EOF_MARKER);
  WritableUtils.writeVInt(out,EOF_MARKER);
  decompressedBytesWritten+=2 * WritableUtils.getVIntSize(EOF_MARKER);
  out.flush();
  if (compressOutput) {
    compressedOut.finish();
    compressedOut.resetState();
  }
  if (ownOutputStream) {
    out.close();
  }
 else {
    checksumOut.finish();
  }
  compressedBytesWritten=rawOut.getPos() - start;
  if (compressOutput) {
    CodecPool.returnCompressor(compressor);
    compressor=null;
  }
  out=null;
  if (writtenRecordsCounter != null) {
    writtenRecordsCounter.increment(numRecordsWritten);
  }
}
