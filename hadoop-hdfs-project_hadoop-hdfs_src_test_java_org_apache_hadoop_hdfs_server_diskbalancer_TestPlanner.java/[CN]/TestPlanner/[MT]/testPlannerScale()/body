{
  final int diskCount=256;
  DiskBalancerTestUtil util=new DiskBalancerTestUtil();
  DiskBalancerVolumeSet vSet=util.createRandomVolumeSet(StorageType.SSD,diskCount);
  NullConnector nullConnector=new NullConnector();
  DiskBalancerCluster cluster=new DiskBalancerCluster(nullConnector);
  DiskBalancerDataNode node=new DiskBalancerDataNode(UUID.randomUUID().toString());
  int diskNum=0;
  for (  DiskBalancerVolume vol : vSet.getVolumes()) {
    vol.setPath("volume" + diskNum++);
    node.addVolume(vol);
  }
  nullConnector.addNode(node);
  cluster.readClusterInfo();
  GreedyPlanner newPlanner=new GreedyPlanner(01.0f,node);
  NodePlan newPlan=new NodePlan(node.getDataNodeName(),node.getDataNodePort());
  newPlanner.balanceVolumeSet(node,node.getVolumeSets().get("SSD"),newPlan);
  assertTrue("No Steps Generated from random disks, very unlikely",newPlan.getVolumeSetPlans().size() > 0);
  assertTrue("Steps Generated less than disk count - false",newPlan.getVolumeSetPlans().size() < diskCount);
  LOG.info("Number of steps are : %d%n",newPlan.getVolumeSetPlans().size());
}
