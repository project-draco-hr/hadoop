{
  Preconditions.checkNotNull(dataNode);
  Preconditions.checkState(destDiskindex >= 0);
  try (FsDatasetSpi.FsVolumeReferences refs=dataNode.getFSDataset().getFsVolumeReferences()){
    if (refs.size() <= destDiskindex) {
      throw new IllegalArgumentException("Invalid Disk index.");
    }
    FsVolumeImpl dest=(FsVolumeImpl)refs.get(destDiskindex);
    for (int x=0; x < refs.size(); x++) {
      if (x == destDiskindex) {
        continue;
      }
      FsVolumeImpl source=(FsVolumeImpl)refs.get(x);
      DiskBalancerTestUtil.moveAllDataToDestVolume(dataNode.getFSDataset(),source,dest);
    }
  }
 }
