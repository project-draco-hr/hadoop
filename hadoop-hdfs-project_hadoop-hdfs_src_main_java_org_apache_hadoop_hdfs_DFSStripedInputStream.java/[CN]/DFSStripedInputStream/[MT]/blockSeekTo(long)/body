{
  if (target >= getFileLength()) {
    throw new IOException("Attempted to read past end of file");
  }
  closeCurrentBlockReaders();
  LocatedStripedBlock targetBlockGroup=getBlockGroupAt(target);
  this.pos=target;
  this.blockEnd=targetBlockGroup.getStartOffset() + targetBlockGroup.getBlockSize() - 1;
  currentLocatedBlock=targetBlockGroup;
  final long offsetIntoBlockGroup=getOffsetInBlockGroup();
  LocatedBlock[] targetBlocks=parseStripedBlockGroup(targetBlockGroup,cellSize,dataBlkNum,parityBlkNum);
  long[] offsetsForInternalBlocks=getStartOffsetsForInternalBlocks(schema,cellSize,targetBlockGroup,offsetIntoBlockGroup);
  Preconditions.checkState(offsetsForInternalBlocks.length == dataBlkNum + parityBlkNum);
  long minOffset=offsetsForInternalBlocks[dataBlkNum];
  retry=new ReaderRetryPolicy();
  for (int i=0; i < dataBlkNum; i++) {
    LocatedBlock targetBlock=targetBlocks[i];
    if (targetBlock != null) {
      DNAddrPair dnInfo=getBestNodeDNAddrPair(targetBlock,null);
      if (dnInfo != null) {
        BlockReader reader=getBlockReaderWithRetry(targetBlock,minOffset,targetBlock.getBlockSize() - minOffset,dnInfo.addr,dnInfo.storageType,dnInfo.info,target,retry);
        if (reader != null) {
          blockReaders[i]=new BlockReaderInfo(reader,targetBlock,dnInfo.info,minOffset);
        }
      }
    }
  }
}
