{
  List<String> localDirs=dirsHandler.getLocalDirs();
  List<String> logDirs=dirsHandler.getLogDirs();
  createUserLocalDirs(localDirs,user);
  createUserCacheDirs(localDirs,user);
  createAppDirs(localDirs,user,appId);
  createAppLogDirs(appId,logDirs,user);
  Path appStorageDir=getWorkingDir(localDirs,user,appId);
  String tokenFn=String.format(ContainerLocalizer.TOKEN_FILE_NAME_FMT,locId);
  Path tokenDst=new Path(appStorageDir,tokenFn);
  copyFile(nmPrivateContainerTokensPath,tokenDst,user);
  LOG.info("Copying from " + nmPrivateContainerTokensPath + " to "+ tokenDst);
  FileContext localizerFc=FileContext.getFileContext(lfs.getDefaultFileSystem(),getConf());
  localizerFc.setUMask(lfs.getUMask());
  localizerFc.setWorkingDirectory(appStorageDir);
  LOG.info("Localizer CWD set to " + appStorageDir + " = "+ localizerFc.getWorkingDirectory());
  ContainerLocalizer localizer=new ContainerLocalizer(localizerFc,user,appId,locId,getPaths(localDirs),RecordFactoryProvider.getRecordFactory(getConf()));
  localizer.runLocalization(nmAddr);
}
