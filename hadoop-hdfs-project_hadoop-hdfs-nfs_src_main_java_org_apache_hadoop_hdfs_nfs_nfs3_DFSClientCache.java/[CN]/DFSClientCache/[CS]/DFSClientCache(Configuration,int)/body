{
  this.config=config;
  this.clientCache=CacheBuilder.newBuilder().maximumSize(clientCache).removalListener(clientRemovalListener()).build(clientLoader());
  this.inputstreamCache=CacheBuilder.newBuilder().maximumSize(DEFAULT_DFS_INPUTSTREAM_CACHE_SIZE).expireAfterAccess(DEFAULT_DFS_INPUTSTREAM_CACHE_TTL,TimeUnit.SECONDS).removalListener(inputStreamRemovalListener()).build(inputStreamLoader());
  ShutdownHookManager.get().addShutdownHook(new CacheFinalizer(),SHUTDOWN_HOOK_PRIORITY);
}
