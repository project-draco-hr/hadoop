{
  LOG.debug("Called getAllPartialJobs()");
  SortedMap<JobId,Job> result=new TreeMap<JobId,Job>();
  try {
    for (    HistoryFileInfo mi : hsManager.getAllFileInfo()) {
      if (mi != null) {
        JobId id=mi.getJobId();
        result.put(id,new PartialJob(mi.getJobIndexInfo(),id));
      }
    }
  }
 catch (  IOException e) {
    LOG.warn("Error trying to scan for all FileInfos",e);
    throw new YarnRuntimeException(e);
  }
  return result;
}
