{
  validateParams();
  augmentParams(hbaseConf,conn);
  NavigableSet<TimelineEntity> entities=new TreeSet<>();
  Iterable<Result> results=getResults(hbaseConf,conn);
  for (  Result result : results) {
    TimelineEntity entity=parseEntity(result);
    if (entity == null) {
      continue;
    }
    entities.add(entity);
    if (entities.size() > limit) {
      entities.pollLast();
    }
  }
  return entities;
}
