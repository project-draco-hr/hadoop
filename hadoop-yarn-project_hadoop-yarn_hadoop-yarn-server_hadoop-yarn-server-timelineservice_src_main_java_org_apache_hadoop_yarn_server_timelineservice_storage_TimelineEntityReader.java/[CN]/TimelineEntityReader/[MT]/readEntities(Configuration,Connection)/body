{
  validateParams();
  augmentParams(hbaseConf,conn);
  NavigableSet<TimelineEntity> entities=new TreeSet<>();
  ResultScanner results=getResults(hbaseConf,conn);
  try {
    for (    Result result : results) {
      TimelineEntity entity=parseEntity(result);
      if (entity == null) {
        continue;
      }
      entities.add(entity);
      if (entities.size() > limit) {
        entities.pollLast();
      }
    }
    return entities;
  }
  finally {
    results.close();
  }
}
