{
  int assignedContainers=0;
  ResourceRequest request=application.getResourceRequest(schedulerKey,node.getNodeName());
  if (request != null) {
    ResourceRequest rackRequest=application.getResourceRequest(schedulerKey,node.getRMNode().getRackName());
    if (rackRequest == null || rackRequest.getNumContainers() <= 0) {
      return 0;
    }
    int assignableContainers=Math.min(getMaxAllocatableContainers(application,schedulerKey,node,NodeType.NODE_LOCAL),request.getNumContainers());
    assignedContainers=assignContainer(node,application,schedulerKey,assignableContainers,request,NodeType.NODE_LOCAL);
  }
  return assignedContainers;
}
