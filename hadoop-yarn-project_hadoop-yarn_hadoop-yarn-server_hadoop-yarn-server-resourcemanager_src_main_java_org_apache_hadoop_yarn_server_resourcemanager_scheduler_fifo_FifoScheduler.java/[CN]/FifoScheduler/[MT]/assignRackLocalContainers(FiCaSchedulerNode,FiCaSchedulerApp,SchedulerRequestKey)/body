{
  int assignedContainers=0;
  ResourceRequest request=application.getResourceRequest(schedulerKey,node.getRMNode().getRackName());
  if (request != null) {
    ResourceRequest offSwitchRequest=application.getResourceRequest(schedulerKey,ResourceRequest.ANY);
    if (offSwitchRequest.getNumContainers() <= 0) {
      return 0;
    }
    int assignableContainers=Math.min(getMaxAllocatableContainers(application,schedulerKey,node,NodeType.RACK_LOCAL),request.getNumContainers());
    assignedContainers=assignContainer(node,application,schedulerKey,assignableContainers,request,NodeType.RACK_LOCAL);
  }
  return assignedContainers;
}
