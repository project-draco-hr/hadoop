{
switch (event.getType()) {
case NODE_ADDED:
{
      NodeAddedSchedulerEvent nodeAddedEvent=(NodeAddedSchedulerEvent)event;
      addNode(nodeAddedEvent.getAddedRMNode());
      recoverContainersOnNode(nodeAddedEvent.getContainerReports(),nodeAddedEvent.getAddedRMNode());
    }
  break;
case NODE_REMOVED:
{
  NodeRemovedSchedulerEvent nodeRemovedEvent=(NodeRemovedSchedulerEvent)event;
  removeNode(nodeRemovedEvent.getRemovedRMNode());
}
break;
case NODE_UPDATE:
{
NodeUpdateSchedulerEvent nodeUpdatedEvent=(NodeUpdateSchedulerEvent)event;
nodeUpdate(nodeUpdatedEvent.getRMNode());
}
break;
case APP_ADDED:
{
AppAddedSchedulerEvent appAddedEvent=(AppAddedSchedulerEvent)event;
addApplication(appAddedEvent.getApplicationId(),appAddedEvent.getQueue(),appAddedEvent.getUser(),appAddedEvent.getIsAppRecovering());
}
break;
case APP_REMOVED:
{
AppRemovedSchedulerEvent appRemovedEvent=(AppRemovedSchedulerEvent)event;
doneApplication(appRemovedEvent.getApplicationID(),appRemovedEvent.getFinalState());
}
break;
case APP_ATTEMPT_ADDED:
{
AppAttemptAddedSchedulerEvent appAttemptAddedEvent=(AppAttemptAddedSchedulerEvent)event;
addApplicationAttempt(appAttemptAddedEvent.getApplicationAttemptId(),appAttemptAddedEvent.getTransferStateFromPreviousAttempt(),appAttemptAddedEvent.getIsAttemptRecovering());
}
break;
case APP_ATTEMPT_REMOVED:
{
AppAttemptRemovedSchedulerEvent appAttemptRemovedEvent=(AppAttemptRemovedSchedulerEvent)event;
try {
doneApplicationAttempt(appAttemptRemovedEvent.getApplicationAttemptID(),appAttemptRemovedEvent.getFinalAttemptState(),appAttemptRemovedEvent.getKeepContainersAcrossAppAttempts());
}
 catch (IOException ie) {
LOG.error("Unable to remove application " + appAttemptRemovedEvent.getApplicationAttemptID(),ie);
}
}
break;
case CONTAINER_EXPIRED:
{
ContainerExpiredSchedulerEvent containerExpiredEvent=(ContainerExpiredSchedulerEvent)event;
ContainerId containerid=containerExpiredEvent.getContainerId();
containerCompleted(getRMContainer(containerid),SchedulerUtils.createAbnormalContainerStatus(containerid,SchedulerUtils.EXPIRED_CONTAINER),RMContainerEventType.EXPIRE);
}
break;
default :
LOG.error("Invalid eventtype " + event.getType() + ". Ignoring!");
}
}
