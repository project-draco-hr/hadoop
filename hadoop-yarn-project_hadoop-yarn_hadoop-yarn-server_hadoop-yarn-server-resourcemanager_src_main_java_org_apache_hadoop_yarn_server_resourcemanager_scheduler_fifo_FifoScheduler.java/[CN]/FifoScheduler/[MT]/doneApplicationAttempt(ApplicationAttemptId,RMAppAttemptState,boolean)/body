{
  FiCaSchedulerApp attempt=getApplicationAttempt(applicationAttemptId);
  SchedulerApplication<FiCaSchedulerApp> application=applications.get(applicationAttemptId.getApplicationId());
  if (application == null || attempt == null) {
    throw new IOException("Unknown application " + applicationAttemptId + " has completed!");
  }
  for (  RMContainer container : attempt.getLiveContainers()) {
    if (keepContainers && container.getState().equals(RMContainerState.RUNNING)) {
      LOG.info("Skip killing " + container.getContainerId());
      continue;
    }
    containerCompleted(container,SchedulerUtils.createAbnormalContainerStatus(container.getContainerId(),SchedulerUtils.COMPLETED_APPLICATION),RMContainerEventType.KILL);
  }
  attempt.stop(rmAppAttemptFinalState);
}
