{
  BreakableService svc=new BreakableService(false,false,false);
  BreakableStateChangeListener listener=new SelfUnregisteringBreakableStateChangeListener();
  BreakableStateChangeListener l2=new BreakableStateChangeListener();
  svc.register(listener);
  svc.register(l2);
  svc.init(new Configuration());
  assertEventCount(listener,1);
  assertEventCount(l2,1);
  svc.unregister(listener);
  svc.start();
  assertEventCount(listener,1);
  assertEventCount(l2,2);
  svc.stop();
  assertEventCount(listener,1);
  svc.stop();
}
