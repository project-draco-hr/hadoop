{
  if (TimelineEntityType.YARN_APPLICATION.matches(entityType)) {
    return new ApplicationEntityReader(userId,clusterId,flowName,flowRunId,appId,entityType,entityId,confs,metrics,fieldsToRetrieve);
  }
 else   if (TimelineEntityType.YARN_FLOW_RUN.matches(entityType)) {
    return new FlowRunEntityReader(userId,clusterId,flowName,flowRunId,appId,entityType,entityId,confs,metrics,fieldsToRetrieve);
  }
 else   if (TimelineEntityType.YARN_FLOW_ACTIVITY.matches(entityType)) {
    return new FlowActivityEntityReader(userId,clusterId,flowName,flowRunId,appId,entityType,entityId,fieldsToRetrieve);
  }
 else {
    return new GenericEntityReader(userId,clusterId,flowName,flowRunId,appId,entityType,entityId,confs,metrics,fieldsToRetrieve);
  }
}
