{
  conf=new Configuration();
  conf.setInt(CommonConfigurationKeys.IPC_MAXIMUM_DATA_LENGTH,1024);
  conf.setBoolean(CommonConfigurationKeys.IPC_SERVER_LOG_SLOW_RPC,true);
  RPC.setProtocolEngine(conf,TestRpcService.class,ProtobufRpcEngine.class);
  PBServerImpl serverImpl=new PBServerImpl();
  BlockingService service=TestProtobufRpcProto.newReflectiveBlockingService(serverImpl);
  server=new RPC.Builder(conf).setProtocol(TestRpcService.class).setInstance(service).setBindAddress(ADDRESS).setPort(PORT).build();
  addr=NetUtils.getConnectAddress(server);
  PBServer2Impl server2Impl=new PBServer2Impl();
  BlockingService service2=TestProtobufRpc2Proto.newReflectiveBlockingService(server2Impl);
  server.addProtocol(RPC.RpcKind.RPC_PROTOCOL_BUFFER,TestRpcService2.class,service2);
  server.start();
}
