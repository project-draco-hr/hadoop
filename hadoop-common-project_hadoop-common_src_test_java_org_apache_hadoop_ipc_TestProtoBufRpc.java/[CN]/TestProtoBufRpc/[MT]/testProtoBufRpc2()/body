{
  TestRpcService2 client=getClient2();
  client.ping2(null,newEmptyRequest());
  EchoResponseProto echoResponse=client.echo2(null,newEchoRequest("hello"));
  Assert.assertEquals(echoResponse.getMessage(),"hello");
  MetricsRecordBuilder rpcMetrics=getMetrics(server.getRpcMetrics().name());
  assertCounterGt("RpcQueueTimeNumOps",0L,rpcMetrics);
  assertCounterGt("RpcProcessingTimeNumOps",0L,rpcMetrics);
  MetricsRecordBuilder rpcDetailedMetrics=getMetrics(server.getRpcDetailedMetrics().name());
  assertCounterGt("Echo2NumOps",0L,rpcDetailedMetrics);
}
