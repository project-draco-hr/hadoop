{
  Path outDir=getOutputPath(job);
  if (outDir == null) {
    throw new InvalidJobConfException("Output directory not set in JobConf.");
  }
  TokenCache.obtainTokensForNamenodes(job.getCredentials(),new Path[]{outDir},job.getConfiguration());
  if (outDir.getFileSystem(job.getConfiguration()).exists(outDir)) {
    throw new FileAlreadyExistsException("Output directory " + outDir + " already exists");
  }
}
