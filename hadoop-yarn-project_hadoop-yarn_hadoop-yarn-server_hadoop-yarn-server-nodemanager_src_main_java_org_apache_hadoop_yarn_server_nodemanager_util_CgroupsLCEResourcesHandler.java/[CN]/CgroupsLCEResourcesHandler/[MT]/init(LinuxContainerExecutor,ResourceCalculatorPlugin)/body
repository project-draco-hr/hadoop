{
  initConfig();
  if (cgroupMount && cgroupMountPath != null) {
    ArrayList<String> cgroupKVs=new ArrayList<String>();
    cgroupKVs.add(CONTROLLER_CPU + "=" + cgroupMountPath+ "/"+ CONTROLLER_CPU);
    lce.mountCgroups(cgroupKVs,cgroupPrefix);
  }
  initializeControllerPaths();
  nodeVCores=NodeManagerHardwareUtils.getVCores(plugin,conf);
  yarnProcessors=NodeManagerHardwareUtils.getContainersCPUs(plugin,conf);
  int systemProcessors=NodeManagerHardwareUtils.getNodeCPUs(plugin,conf);
  if (systemProcessors != (int)yarnProcessors) {
    LOG.info("YARN containers restricted to " + yarnProcessors + " cores");
    int[] limits=getOverallLimits(yarnProcessors);
    updateCgroup(CONTROLLER_CPU,"",CPU_PERIOD_US,String.valueOf(limits[0]));
    updateCgroup(CONTROLLER_CPU,"",CPU_QUOTA_US,String.valueOf(limits[1]));
  }
 else   if (CGroupsCpuResourceHandlerImpl.cpuLimitsExist(pathForCgroup(CONTROLLER_CPU,""))) {
    LOG.info("Removing CPU constraints for YARN containers.");
    updateCgroup(CONTROLLER_CPU,"",CPU_QUOTA_US,String.valueOf(-1));
  }
}
