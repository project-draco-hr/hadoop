{
  try {
    jobCommitStarted();
    committer.commitJob(event.getJobContext());
    context.getEventHandler().handle(new JobCommitCompletedEvent(event.getJobID()));
  }
 catch (  Exception e) {
    LOG.error("Could not commit job",e);
    context.getEventHandler().handle(new JobCommitFailedEvent(event.getJobID(),StringUtils.stringifyException(e)));
  }
 finally {
    jobCommitEnded();
  }
}
