{
  Path inputPath=getInputPath();
  Path outputPath=getOutputPath();
  Configuration conf=new Configuration();
  FileSystem fs=FileSystem.getLocal(conf);
  if (fs.exists(outputPath)) {
    fs.delete(outputPath,true);
  }
  if (fs.exists(inputPath)) {
    fs.delete(inputPath,true);
  }
  createInputFile(inputPath,0,20);
  Job job=Job.getInstance();
  job.setMapperClass(GCMapper.class);
  job.setNumReduceTasks(0);
  job.getConfiguration().set(MRJobConfig.IO_SORT_MB,"25");
  FileInputFormat.addInputPath(job,inputPath);
  FileOutputFormat.setOutputPath(job,outputPath);
  boolean ret=job.waitForCompletion(true);
  assertTrue("job failed",ret);
  Counter gcCounter=job.getCounters().findCounter(TaskCounter.GC_TIME_MILLIS);
  assertNotNull(gcCounter);
  assertTrue("No time spent in gc",gcCounter.getValue() > 0);
}
