{
  Configuration conf=new Configuration();
  LocalFileSystem fs=FileSystem.getLocal(conf);
  Path path1=new Path(GenericTestUtils.getTempPath("test1.seq"));
  SequenceFile.Writer writer=SequenceFile.createWriter(fs,conf,path1,Text.class,NullWritable.class,CompressionType.BLOCK);
  writer.append(new Text("file1-1"),NullWritable.get());
  writer.append(new Text("file1-2"),NullWritable.get());
  writer.close();
  Path path2=new Path(GenericTestUtils.getTempPath("test2.seq"));
  writer=SequenceFile.createWriter(fs,conf,path2,Text.class,NullWritable.class,CompressionType.BLOCK);
  writer.append(new Text("file2-1"),NullWritable.get());
  writer.append(new Text("file2-2"),NullWritable.get());
  writer.close();
  SequenceFile.Reader reader=new SequenceFile.Reader(fs,path1,conf);
  reader.close();
  reader.close();
  SequenceFile.Reader reader1=new SequenceFile.Reader(fs,path1,conf);
  Text text=new Text();
  reader1.next(text);
  assertEquals("file1-1",text.toString());
  SequenceFile.Reader reader2=new SequenceFile.Reader(fs,path2,conf);
  reader2.next(text);
  assertEquals("file2-1",text.toString());
  reader1.next(text);
  assertEquals("file1-2",text.toString());
  reader2.next(text);
  assertEquals("file2-2",text.toString());
  assertFalse(reader1.next(text));
  assertFalse(reader2.next(text));
}
