{
  if (numOfReplicas == 0) {
    return writer;
  }
  writer=chooseLocalStorage(writer,excludedNodes,blocksize,maxNodesPerRack,results,avoidStaleNodes,storageTypes,true).getDatanodeDescriptor();
  if (--numOfReplicas == 0) {
    return writer;
  }
  chooseRandom(numOfReplicas,NodeBase.ROOT,excludedNodes,blocksize,maxNodesPerRack,results,avoidStaleNodes,storageTypes);
  return writer;
}
