{
  Priority priority=allocated.getPriority();
  ContainerRequest toBeReplaced=null;
  if (PRIORITY_FAST_FAIL_MAP.equals(priority) || PRIORITY_MAP.equals(priority)) {
    String host=allocated.getNodeId().getHost();
    LinkedList<TaskAttemptId> list=mapsHostMapping.get(host);
    if (list != null && list.size() > 0) {
      TaskAttemptId tId=list.removeLast();
      if (maps.containsKey(tId)) {
        toBeReplaced=maps.remove(tId);
      }
    }
 else {
      TaskAttemptId tId=maps.keySet().iterator().next();
      toBeReplaced=maps.remove(tId);
    }
  }
 else   if (PRIORITY_REDUCE.equals(priority)) {
    TaskAttemptId tId=reduces.keySet().iterator().next();
    toBeReplaced=reduces.remove(tId);
  }
  return toBeReplaced;
}
