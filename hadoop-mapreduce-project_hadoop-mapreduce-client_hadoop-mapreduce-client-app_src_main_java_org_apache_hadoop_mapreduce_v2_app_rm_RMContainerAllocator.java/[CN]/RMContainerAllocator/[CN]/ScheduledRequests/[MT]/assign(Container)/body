{
  ContainerRequest assigned=null;
  Priority priority=allocated.getPriority();
  if (PRIORITY_FAST_FAIL_MAP.equals(priority)) {
    LOG.info("Assigning container " + allocated + " to fast fail map");
    assigned=assignToFailedMap(allocated);
  }
 else   if (PRIORITY_REDUCE.equals(priority)) {
    LOG.info("Assigning container " + allocated + " to reduce");
    assigned=assignToReduce(allocated);
  }
 else   if (PRIORITY_MAP.equals(priority)) {
    LOG.info("Assigning container " + allocated + " to map");
    assigned=assignToMap(allocated);
  }
 else {
    LOG.warn("Container allocated at unwanted priority: " + priority + ". Returning to RM...");
  }
  return assigned;
}
