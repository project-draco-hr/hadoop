{
  LOG.info("Before Scheduling: " + getStat());
  List<Container> allocatedContainers=getResources();
  LOG.info("After Scheduling: " + getStat());
  if (allocatedContainers.size() > 0) {
    LOG.info("Before Assign: " + getStat());
    scheduledRequests.assign(allocatedContainers);
    LOG.info("After Assign: " + getStat());
  }
  int completedMaps=getJob().getCompletedMaps();
  int completedTasks=completedMaps + getJob().getCompletedReduces();
  if (lastCompletedTasks != completedTasks) {
    lastCompletedTasks=completedTasks;
    recalculateReduceSchedule=true;
  }
  if (recalculateReduceSchedule) {
    preemptReducesIfNeeded();
    scheduleReduces(getJob().getTotalMaps(),completedMaps,scheduledRequests.maps.size(),scheduledRequests.reduces.size(),assignedRequests.maps.size(),assignedRequests.reduces.size(),mapResourceReqt,reduceResourceReqt,pendingReduces.size(),maxReduceRampupLimit,reduceSlowStart);
    recalculateReduceSchedule=false;
  }
}
