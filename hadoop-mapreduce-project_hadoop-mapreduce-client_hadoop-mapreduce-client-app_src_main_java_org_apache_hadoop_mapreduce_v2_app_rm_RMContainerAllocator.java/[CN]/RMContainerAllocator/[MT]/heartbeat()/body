{
  LOG.info("Before Scheduling: " + getStat());
  List<Container> allocatedContainers=getResources();
  LOG.info("After Scheduling: " + getStat());
  if (allocatedContainers.size() > 0) {
    LOG.info("Before Assign: " + getStat());
    scheduledRequests.assign(allocatedContainers);
    LOG.info("After Assign: " + getStat());
  }
  if (recalculateReduceSchedule) {
    preemptReducesIfNeeded();
    scheduleReduces(getJob().getTotalMaps(),getJob().getCompletedMaps(),scheduledRequests.maps.size(),scheduledRequests.reduces.size(),assignedRequests.maps.size(),assignedRequests.reduces.size(),mapResourceReqt,reduceResourceReqt,pendingReduces.size(),maxReduceRampupLimit,reduceSlowStart);
    recalculateReduceSchedule=false;
  }
}
