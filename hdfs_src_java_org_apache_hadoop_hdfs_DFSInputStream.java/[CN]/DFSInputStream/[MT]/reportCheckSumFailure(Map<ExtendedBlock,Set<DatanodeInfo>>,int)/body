{
  if (corruptedBlockMap.isEmpty()) {
    return;
  }
  Iterator<Entry<ExtendedBlock,Set<DatanodeInfo>>> it=corruptedBlockMap.entrySet().iterator();
  Entry<ExtendedBlock,Set<DatanodeInfo>> entry=it.next();
  ExtendedBlock blk=entry.getKey();
  Set<DatanodeInfo> dnSet=entry.getValue();
  if (((dnSet.size() < dataNodeCount) && (dnSet.size() > 0)) || ((dataNodeCount == 1) && (dnSet.size() == dataNodeCount))) {
    DatanodeInfo[] locs=new DatanodeInfo[dnSet.size()];
    int i=0;
    for (    DatanodeInfo dn : dnSet) {
      locs[i++]=dn;
    }
    LocatedBlock[] lblocks={new LocatedBlock(blk,locs)};
    dfsClient.reportChecksumFailure(src,lblocks);
  }
  corruptedBlockMap.clear();
}
