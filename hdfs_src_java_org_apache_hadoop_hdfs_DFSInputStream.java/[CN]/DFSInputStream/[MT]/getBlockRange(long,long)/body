{
  final List<LocatedBlock> blocks;
  if (locatedBlocks.isLastBlockComplete()) {
    blocks=getFinalizedBlockRange(offset,length);
  }
 else {
    final boolean readPastEnd=offset + length > locatedBlocks.getFileLength();
    if (readPastEnd)     length=locatedBlocks.getFileLength() - offset;
    blocks=getFinalizedBlockRange(offset,length);
    if (readPastEnd)     blocks.add(locatedBlocks.getLastLocatedBlock());
  }
  return blocks;
}
