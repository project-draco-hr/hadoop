{
  final Configuration conf=new Configuration();
  conf.set(SimulatorJobSubmissionPolicy.JOB_SUBMISSION_POLICY,policy.name());
  final FileSystem lfs=FileSystem.getLocal(conf);
  final Path rootInputDir=new Path(System.getProperty("src.test.data","data")).makeQualified(lfs);
  final Path traceFile=new Path(rootInputDir,"19-jobs.trace.json.gz");
  final Path topologyFile=new Path(rootInputDir,"19-jobs.topology.json.gz");
  LOG.info("traceFile = " + traceFile.toString() + " topology = "+ topologyFile.toString());
  int numJobs=getNumberJobs(traceFile,conf);
  int nTrackers=getNumberTaskTrackers(topologyFile,conf);
  MockSimulatorEngine mockMumak=new MockSimulatorEngine(numJobs,nTrackers);
  Configuration mumakConf=new Configuration();
  mumakConf.set("mapred.jobtracker.taskScheduler",JobQueueTaskScheduler.class.getName());
  mumakConf.setBoolean(JTConfig.JT_PERSIST_JOBSTATUS,false);
  String[] args={traceFile.toString(),topologyFile.toString()};
  int res=ToolRunner.run(mumakConf,mockMumak,args);
  Assert.assertEquals(res,0);
}
