{
  DBConfiguration dbConf=getDBConf();
  @SuppressWarnings("unchecked") Class<T> inputClass=(Class<T>)(dbConf.getInputClass());
  String dbProductName=getDBProductName();
  LOG.debug("Creating db record reader for db product: " + dbProductName);
  try {
    if (dbProductName.startsWith("MYSQL")) {
      return new MySQLDataDrivenDBRecordReader<T>(split,inputClass,conf,createConnection(),dbConf,dbConf.getInputConditions(),dbConf.getInputFieldNames(),dbConf.getInputTableName());
    }
 else {
      return new DataDrivenDBRecordReader<T>(split,inputClass,conf,createConnection(),dbConf,dbConf.getInputConditions(),dbConf.getInputFieldNames(),dbConf.getInputTableName(),dbProductName);
    }
  }
 catch (  SQLException ex) {
    throw new IOException(ex.getMessage());
  }
}
