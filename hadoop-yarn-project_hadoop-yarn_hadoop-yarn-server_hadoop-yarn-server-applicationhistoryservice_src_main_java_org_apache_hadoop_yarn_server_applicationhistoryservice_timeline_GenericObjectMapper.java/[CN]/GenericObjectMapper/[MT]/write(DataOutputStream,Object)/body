{
  if (o == null)   return;
  if (o instanceof Long) {
    dos.write(LONG);
    WritableUtils.writeVLong(dos,(Long)o);
  }
 else   if (o instanceof Integer) {
    dos.write(INTEGER);
    WritableUtils.writeVInt(dos,(Integer)o);
  }
 else   if (o instanceof Double) {
    dos.write(DOUBLE);
    dos.writeDouble((Double)o);
  }
 else   if (o instanceof String) {
    dos.write(STRING);
    WritableUtils.writeString(dos,(String)o);
  }
 else   if (o instanceof Boolean) {
    dos.write(BOOLEAN);
    dos.writeBoolean((Boolean)o);
  }
 else   if (o instanceof List) {
    dos.write(LIST);
    ObjectMapper mapper=new ObjectMapper();
    mapper.writeValue(dos,o);
  }
 else   if (o instanceof Map) {
    dos.write(MAP);
    ObjectMapper mapper=new ObjectMapper();
    mapper.writeValue(dos,o);
  }
 else {
    throw new IOException("Couldn't serialize object");
  }
}
