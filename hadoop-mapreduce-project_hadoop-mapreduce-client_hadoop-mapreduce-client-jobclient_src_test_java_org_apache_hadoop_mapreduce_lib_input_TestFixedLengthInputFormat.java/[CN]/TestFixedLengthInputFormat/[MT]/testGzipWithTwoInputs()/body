{
  CompressionCodec gzip=new GzipCodec();
  localFs.delete(workDir,true);
  Job job=Job.getInstance(defaultConf);
  FixedLengthInputFormat format=new FixedLengthInputFormat();
  format.setRecordLength(job.getConfiguration(),5);
  ReflectionUtils.setConf(gzip,job.getConfiguration());
  FileInputFormat.setInputPaths(job,workDir);
  writeFile(localFs,new Path(workDir,"part1.txt.gz"),gzip,"one  two  threefour five six  seveneightnine ten  ");
  writeFile(localFs,new Path(workDir,"part2.txt.gz"),gzip,"ten  nine eightsevensix  five four threetwo  one  ");
  List<InputSplit> splits=format.getSplits(job);
  assertEquals("compressed splits == 2",2,splits.size());
  FileSplit tmp=(FileSplit)splits.get(0);
  if (tmp.getPath().getName().equals("part2.txt.gz")) {
    splits.set(0,splits.get(1));
    splits.set(1,tmp);
  }
  List<String> results=readSplit(format,splits.get(0),job);
  assertEquals("splits[0] length",10,results.size());
  assertEquals("splits[0][5]","six  ",results.get(5));
  results=readSplit(format,splits.get(1),job);
  assertEquals("splits[1] length",10,results.size());
  assertEquals("splits[1][0]","ten  ",results.get(0));
  assertEquals("splits[1][1]","nine ",results.get(1));
}
