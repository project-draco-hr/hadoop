{
  try {
    S3Object object=s3Service.getObject(bucket.getName(),key);
    if (checkMetadata) {
      checkMetadata(object);
    }
    return object.getDataInputStream();
  }
 catch (  S3ServiceException e) {
    if ("NoSuchKey".equals(e.getS3ErrorCode())) {
      throw new IOException(key + " doesn't exist");
    }
    if (e.getCause() instanceof IOException) {
      throw (IOException)e.getCause();
    }
    throw new S3Exception(e);
  }
catch (  ServiceException e) {
    handleServiceException(e);
    return null;
  }
}
