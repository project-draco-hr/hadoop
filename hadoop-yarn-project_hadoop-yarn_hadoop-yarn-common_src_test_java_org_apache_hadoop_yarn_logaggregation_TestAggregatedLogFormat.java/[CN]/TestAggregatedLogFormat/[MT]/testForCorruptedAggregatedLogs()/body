{
  Configuration conf=new Configuration();
  File workDir=new File(testWorkDir,"testReadAcontainerLogs1");
  Path remoteAppLogFile=new Path(workDir.getAbsolutePath(),"aggregatedLogFile");
  Path srcFileRoot=new Path(workDir.getAbsolutePath(),"srcFiles");
  ContainerId testContainerId=TestContainerId.newContainerId(1,1,1,1);
  Path t=new Path(srcFileRoot,testContainerId.getApplicationAttemptId().getApplicationId().toString());
  Path srcFilePath=new Path(t,testContainerId.toString());
  long numChars=950000;
  writeSrcFileAndALog(srcFilePath,"stdout",numChars,remoteAppLogFile,srcFileRoot,testContainerId);
  LogReader logReader=new LogReader(conf,remoteAppLogFile);
  LogKey rLogKey=new LogKey();
  DataInputStream dis=logReader.next(rLogKey);
  Writer writer=new StringWriter();
  try {
    LogReader.readAcontainerLogs(dis,writer);
  }
 catch (  Exception e) {
    if (e.toString().contains("NumberFormatException")) {
      Assert.fail("Aggregated logs are corrupted.");
    }
  }
}
