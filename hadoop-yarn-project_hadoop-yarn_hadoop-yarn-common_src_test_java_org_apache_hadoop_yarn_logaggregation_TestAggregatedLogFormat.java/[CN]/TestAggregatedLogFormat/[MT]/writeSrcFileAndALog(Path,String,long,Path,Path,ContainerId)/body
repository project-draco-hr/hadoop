{
  File dir=new File(srcFilePath.toString());
  if (!dir.exists()) {
    if (!dir.mkdirs()) {
      throw new IOException("Unable to create directory : " + dir);
    }
  }
  File outputFile=new File(new File(srcFilePath.toString()),fileName);
  FileOutputStream os=new FileOutputStream(outputFile);
  final OutputStreamWriter osw=new OutputStreamWriter(os,"UTF8");
  final int ch=filler;
  UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
  LogWriter logWriter=new LogWriter(conf,remoteAppLogFile,ugi);
  LogKey logKey=new LogKey(testContainerId);
  LogValue logValue=spy(new LogValue(Collections.singletonList(srcFileRoot.toString()),testContainerId,ugi.getShortUserName()));
  final CountDownLatch latch=new CountDownLatch(1);
  Thread t=new Thread(){
    public void run(){
      try {
        for (int i=0; i < length / 3; i++) {
          osw.write(ch);
        }
        latch.countDown();
        for (int i=0; i < (2 * length) / 3; i++) {
          osw.write(ch);
        }
        osw.close();
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
    }
  }
;
  t.start();
  latch.await();
  logWriter.append(logKey,logValue);
  logWriter.close();
}
