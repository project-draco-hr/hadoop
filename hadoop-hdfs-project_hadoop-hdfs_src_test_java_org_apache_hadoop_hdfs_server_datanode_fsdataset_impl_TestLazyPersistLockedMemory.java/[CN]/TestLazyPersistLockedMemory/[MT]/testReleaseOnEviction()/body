{
  getClusterBuilder().setNumDatanodes(1).setMaxLockedMemory(BLOCK_SIZE).setRamDiskReplicaCapacity(BLOCK_SIZE * 2 - 1).build();
  final String METHOD_NAME=GenericTestUtils.getMethodName();
  final FsDatasetSpi<?> fsd=cluster.getDataNodes().get(0).getFSDataset();
  Path path=new Path("/" + METHOD_NAME + ".dat");
  makeTestFile(path,BLOCK_SIZE,true);
  waitForLockedBytesUsed(fsd,0);
  MetricsRecordBuilder rb=MetricsAsserts.getMetrics(cluster.getDataNodes().get(0).getMetrics().name());
  MetricsAsserts.assertCounter("RamDiskBlocksEvicted",1L,rb);
}
