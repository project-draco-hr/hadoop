{
  if ((long)bufSize > blockSize) {
    bufSize=(int)blockSize;
    allocateBuffers();
  }
 else   if (blockSize % bufSize != 0) {
    bufSize=(int)(blockSize / 256L);
    if (bufSize == 0) {
      bufSize=1024;
    }
    bufSize=Math.min(bufSize,1024 * 1024);
    allocateBuffers();
  }
}
