{
  Iterator itr=conf.iterator();
  ArrayList<String> proxyUsers=new ArrayList<String>();
  while (itr.hasNext()) {
    if (itr.next().toString().indexOf("hadoop.proxyuser") >= 0 && itr.next().toString().indexOf("groups=") >= 0) {
      proxyUsers.add(itr.next().toString().split("\\.")[2]);
    }
  }
  if (proxyUsers.size() == 0) {
    LOG.error("No proxy users found in the configuration.");
    throw new Exception("No proxy users found in the configuration.");
  }
  ProxyUserDefinitions pud=new ProxyUserDefinitions(){
    @Override public boolean writeToFile(    URI filePath) throws IOException {
      throw new UnsupportedOperationException("No such method exists.");
    }
  }
;
  for (  String userName : proxyUsers) {
    List<String> groups=Arrays.asList(conf.get("hadoop.proxyuser." + userName + ".groups").split("//,"));
    List<String> hosts=Arrays.asList(conf.get("hadoop.proxyuser." + userName + ".hosts").split("//,"));
    ProxyUserDefinitions.GroupsAndHost definitions=pud.new GroupsAndHost();
    definitions.setGroups(groups);
    definitions.setHosts(hosts);
    pud.addProxyUser(userName,definitions);
  }
  return pud;
}
