{
  final int attempts=60;
  for (int i=0; i < attempts; i++) {
    LocatedBlocks locatedBlocks=getLocatedBlocks(file,fs);
    LocatedStripedBlock lastBlock=(LocatedStripedBlock)locatedBlocks.getLastLocatedBlock();
    DatanodeInfo[] storageInfos=lastBlock.getLocations();
    if (storageInfos.length >= groupSize) {
      return locatedBlocks;
    }
    Thread.sleep(1000);
  }
  throw new IOException("Time out waiting for EC block reconstruction.");
}
