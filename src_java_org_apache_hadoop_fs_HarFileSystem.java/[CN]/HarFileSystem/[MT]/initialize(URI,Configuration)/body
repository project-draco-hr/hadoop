{
  underLyingURI=decodeHarURI(name,conf);
  Path harPath=archivePath(new Path(name.toString()));
  if (harPath == null) {
    throw new IOException("Invalid path for the Har Filesystem. " + name.toString());
  }
  if (fs == null) {
    fs=FileSystem.get(underLyingURI,conf);
  }
  this.uri=harPath.toUri();
  this.archivePath=new Path(this.uri.getPath());
  this.harAuth=getHarAuth(this.underLyingURI);
  this.masterIndex=new Path(archivePath,"_masterindex");
  this.archiveIndex=new Path(archivePath,"_index");
  if (!fs.exists(masterIndex) || !fs.exists(archiveIndex)) {
    throw new IOException("Invalid path for the Har Filesystem. " + "No index file in " + harPath);
  }
  try {
    this.version=getHarVersion();
  }
 catch (  IOException io) {
    throw new IOException("Unable to " + "read the version of the Har file system: " + this.archivePath);
  }
  if (this.version > HarFileSystem.VERSION) {
    throw new IOException("Invalid version " + this.version + " expected "+ HarFileSystem.VERSION);
  }
}
