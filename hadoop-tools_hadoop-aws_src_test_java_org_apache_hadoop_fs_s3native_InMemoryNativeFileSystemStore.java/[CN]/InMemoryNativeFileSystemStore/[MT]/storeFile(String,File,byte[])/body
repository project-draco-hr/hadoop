{
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  byte[] buf=new byte[8192];
  int numRead;
  BufferedInputStream in=null;
  try {
    in=new BufferedInputStream(new FileInputStream(file));
    while ((numRead=in.read(buf)) >= 0) {
      out.write(buf,0,numRead);
    }
  }
  finally {
    if (in != null) {
      in.close();
    }
  }
  metadataMap.put(key,new FileMetadata(key,file.length(),Time.now()));
  dataMap.put(key,out.toByteArray());
}
