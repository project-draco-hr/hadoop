{
  final boolean firstReferred=in.readBoolean();
  final INodeReference.WithCount withCount;
  if (firstReferred) {
    final INode referred=loader.loadINodeWithLocalName(isSnapshotINode,in);
    withCount=new INodeReference.WithCount(null,referred);
    referenceMap.put(++referenceId,withCount);
  }
 else {
    final long id=in.readLong();
    withCount=referenceMap.get(id);
    withCount.incrementReferenceCount();
  }
  return withCount;
}
