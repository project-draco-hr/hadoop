{
  if (key == null) {
    key=createKey();
  }
  if (value == null) {
    value=createValue();
  }
  if (jc.flush(ivalue)) {
    ReflectionUtils.copy(conf,jc.key(),key);
    ReflectionUtils.copy(conf,emit(ivalue),value);
    return true;
  }
  if (ivalue == null) {
    ivalue=createTupleWritable();
  }
  jc.clear();
  final PriorityQueue<ComposableRecordReader<K,?>> q=getRecordReaderQueue();
  K iterkey=createKey();
  while (q != null && !q.isEmpty()) {
    fillJoinCollector(iterkey);
    jc.reset(iterkey);
    if (jc.flush(ivalue)) {
      ReflectionUtils.copy(conf,jc.key(),key);
      ReflectionUtils.copy(conf,emit(ivalue),value);
      return true;
    }
    jc.clear();
  }
  return false;
}
