{
  if (!isMaster)   return;
  setSerialNo(serialNo + 1);
  currentKey=new BlockKey(serialNo,Time.now() + 2 * keyUpdateInterval + tokenLifetime,generateSecret());
  setSerialNo(serialNo + 1);
  nextKey=new BlockKey(serialNo,Time.now() + 3 * keyUpdateInterval + tokenLifetime,generateSecret());
  allKeys.put(currentKey.getKeyId(),currentKey);
  allKeys.put(nextKey.getKeyId(),nextKey);
}
