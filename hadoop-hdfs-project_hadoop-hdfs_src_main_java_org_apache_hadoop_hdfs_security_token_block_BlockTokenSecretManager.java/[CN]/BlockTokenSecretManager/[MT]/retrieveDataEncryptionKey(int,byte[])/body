{
  BlockKey key=null;
synchronized (this) {
    key=allKeys.get(keyId);
    if (key == null) {
      throw new InvalidEncryptionKeyException("Can't re-compute encryption key" + " for nonce, since the required block key (keyID=" + keyId + ") doesn't exist. Current key: "+ currentKey.getKeyId());
    }
  }
  return createPassword(nonce,key.getKey());
}
