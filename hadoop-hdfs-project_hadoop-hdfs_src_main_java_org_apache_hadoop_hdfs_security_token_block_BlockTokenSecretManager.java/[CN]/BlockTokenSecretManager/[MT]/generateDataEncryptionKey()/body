{
  byte[] nonce=new byte[8];
  nonceGenerator.nextBytes(nonce);
  BlockKey key=null;
synchronized (this) {
    key=currentKey;
  }
  byte[] encryptionKey=createPassword(nonce,key.getKey());
  return new DataEncryptionKey(key.getKeyId(),blockPoolId,nonce,encryptionKey,Time.now() + tokenLifetime,encryptionAlgorithm);
}
