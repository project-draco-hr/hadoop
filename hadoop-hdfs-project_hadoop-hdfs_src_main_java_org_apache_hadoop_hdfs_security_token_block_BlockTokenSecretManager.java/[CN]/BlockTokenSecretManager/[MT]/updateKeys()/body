{
  if (!isMaster)   return false;
  LOG.info("Updating block keys");
  removeExpiredKeys();
  allKeys.put(currentKey.getKeyId(),new BlockKey(currentKey.getKeyId(),Time.now() + keyUpdateInterval + tokenLifetime,currentKey.getKey()));
  currentKey=new BlockKey(nextKey.getKeyId(),Time.now() + 2 * keyUpdateInterval + tokenLifetime,nextKey.getKey());
  allKeys.put(currentKey.getKeyId(),currentKey);
  setSerialNo(serialNo + 1);
  nextKey=new BlockKey(serialNo,Time.now() + 3 * keyUpdateInterval + tokenLifetime,generateSecret());
  allKeys.put(nextKey.getKeyId(),nextKey);
  return true;
}
