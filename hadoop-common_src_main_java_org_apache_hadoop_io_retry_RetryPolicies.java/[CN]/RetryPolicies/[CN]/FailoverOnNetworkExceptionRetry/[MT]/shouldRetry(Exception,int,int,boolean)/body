{
  if (failovers >= maxFailovers) {
    LOG.info("Failovers (" + failovers + ") exceeded maximum allowed ("+ maxFailovers+ ")");
    return RetryAction.FAIL;
  }
  if (e instanceof ConnectException || e instanceof NoRouteToHostException || e instanceof UnknownHostException|| e instanceof StandbyException) {
    return RetryAction.FAILOVER_AND_RETRY;
  }
 else   if (e instanceof SocketException || e instanceof IOException) {
    if (isMethodIdempotent) {
      return RetryAction.FAILOVER_AND_RETRY;
    }
 else {
      return RetryAction.FAIL;
    }
  }
 else {
    return fallbackPolicy.shouldRetry(e,retries,failovers,isMethodIdempotent);
  }
}
