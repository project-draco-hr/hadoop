{
  Configuration conf=new Configuration();
  Map<String,String> metadata=new HashMap<String,String>();
  metadata.put(SerializationBase.SERIALIZATION_KEY,WritableSerialization.class.getName());
  SerializationFactory factory=new SerializationFactory(conf);
  SerializationBase serialization=factory.getSerialization(metadata);
  assertNull("Got serializer without any class info",serialization);
  metadata.put(SerializationBase.CLASS_KEY,Text.class.getName());
  serialization=factory.getSerialization(metadata);
  assertNotNull("Didn't get serialization!",serialization);
  assertTrue("Wrong serialization class",serialization instanceof WritableSerialization);
}
