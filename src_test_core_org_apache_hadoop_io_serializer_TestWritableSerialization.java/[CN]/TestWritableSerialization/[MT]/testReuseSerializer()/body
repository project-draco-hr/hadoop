{
  DataOutputBuffer out=new DataOutputBuffer();
  SerializationFactory factory=new SerializationFactory(new Configuration());
  Foo foo=new Foo();
  Foo foo2=new Foo();
  Map<String,String> metadata=SerializationBase.getMetadataFromClass(GenericsUtil.getClass(foo));
  SerializerBase fooSerializer=factory.getSerializer(metadata);
  fooSerializer.open(out);
  fooSerializer.serialize(foo);
  fooSerializer.serialize(foo2);
  fooSerializer.close();
  out.reset();
  Bar bar=new Bar();
  Baz baz=new Baz();
  metadata=SerializationBase.getMetadataFromClass(GenericsUtil.getClass(bar));
  SerializerBase barSerializer=factory.getSerializer(metadata);
  barSerializer.open(out);
  barSerializer.serialize(bar);
  try {
    barSerializer.serialize(baz);
    fail("Expected IOException serializing baz via bar serializer.");
  }
 catch (  IOException ioe) {
  }
  try {
    barSerializer.serialize(foo);
    fail("Expected IOException serializing foo via bar serializer.");
  }
 catch (  IOException ioe) {
  }
  barSerializer.close();
  out.reset();
}
