{
  Path dir=new Path(testBaseDir1());
  Path file=new Path(testBaseDir1(),"file");
  final int maxPathLen=HdfsServerConstants.MAX_PATH_LENGTH;
  final int dirLen=dir.toString().length() + 1;
  int len=maxPathLen - dirLen;
  StringBuilder sb=new StringBuilder("");
  for (int i=0; i < (len / 10); i++) {
    sb.append("0123456789");
  }
  for (int i=0; i < (len % 10); i++) {
    sb.append("x");
  }
  Path link=new Path(sb.toString());
  assertEquals(maxPathLen,dirLen + link.toString().length());
  createAndWriteFile(file);
  wrapper.setWorkingDirectory(dir);
  wrapper.createSymlink(file,link,false);
  readFile(link);
  link=new Path(sb.toString() + "x");
  try {
    wrapper.createSymlink(file,link,false);
    fail("Path name should be too long");
  }
 catch (  IOException x) {
  }
}
