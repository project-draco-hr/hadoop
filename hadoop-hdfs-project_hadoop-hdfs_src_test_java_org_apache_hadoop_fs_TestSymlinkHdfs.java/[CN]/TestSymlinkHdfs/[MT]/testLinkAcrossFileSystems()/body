{
  Path localDir=new Path("file://" + wrapper.getAbsoluteTestRootDir() + "/test");
  Path localFile=new Path("file://" + wrapper.getAbsoluteTestRootDir() + "/test/file");
  Path link=new Path(testBaseDir1(),"linkToFile");
  FSTestWrapper localWrapper=wrapper.getLocalFSWrapper();
  localWrapper.delete(localDir,true);
  localWrapper.mkdir(localDir,FileContext.DEFAULT_PERM,true);
  localWrapper.setWorkingDirectory(localDir);
  assertEquals(localDir,localWrapper.getWorkingDirectory());
  createAndWriteFile(localWrapper,localFile);
  wrapper.createSymlink(localFile,link,false);
  readFile(link);
  assertEquals(fileSize,wrapper.getFileStatus(link).getLen());
}
