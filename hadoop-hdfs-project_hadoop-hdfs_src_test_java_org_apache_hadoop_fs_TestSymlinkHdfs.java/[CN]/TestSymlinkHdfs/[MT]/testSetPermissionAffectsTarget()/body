{
  Path file=new Path(testBaseDir1(),"file");
  Path dir=new Path(testBaseDir2());
  Path linkToFile=new Path(testBaseDir1(),"linkToFile");
  Path linkToDir=new Path(testBaseDir1(),"linkToDir");
  createAndWriteFile(file);
  wrapper.createSymlink(file,linkToFile,false);
  wrapper.createSymlink(dir,linkToDir,false);
  FsPermission perms=wrapper.getFileLinkStatus(linkToFile).getPermission();
  wrapper.setPermission(linkToFile,new FsPermission((short)0664));
  wrapper.setOwner(linkToFile,"user","group");
  assertEquals(perms,wrapper.getFileLinkStatus(linkToFile).getPermission());
  FileStatus stat=wrapper.getFileStatus(file);
  assertEquals(0664,stat.getPermission().toShort());
  assertEquals("user",stat.getOwner());
  assertEquals("group",stat.getGroup());
  assertEquals(stat.getPermission(),wrapper.getFileStatus(linkToFile).getPermission());
  perms=wrapper.getFileLinkStatus(linkToDir).getPermission();
  wrapper.setPermission(linkToDir,new FsPermission((short)0664));
  wrapper.setOwner(linkToDir,"user","group");
  assertEquals(perms,wrapper.getFileLinkStatus(linkToDir).getPermission());
  stat=wrapper.getFileStatus(dir);
  assertEquals(0664,stat.getPermission().toShort());
  assertEquals("user",stat.getOwner());
  assertEquals("group",stat.getGroup());
  assertEquals(stat.getPermission(),wrapper.getFileStatus(linkToDir).getPermission());
}
