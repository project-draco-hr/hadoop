{
  ClientResponse resp;
  try {
    resp=authUgi.doAs(new PrivilegedExceptionAction<ClientResponse>(){
      @Override public ClientResponse run() throws Exception {
        return doPostingObject(obj,path);
      }
    }
);
  }
 catch (  UndeclaredThrowableException e) {
    Throwable cause=e.getCause();
    if (cause instanceof IOException) {
      throw (IOException)cause;
    }
 else {
      throw new IOException(cause);
    }
  }
catch (  InterruptedException ie) {
    throw (IOException)new InterruptedIOException().initCause(ie);
  }
  if (resp == null || resp.getClientResponseStatus() != ClientResponse.Status.OK) {
    String msg="Failed to get the response from the timeline server.";
    LOG.error(msg);
    if (resp != null) {
      msg+=" HTTP error code: " + resp.getStatus();
      if (LOG.isDebugEnabled()) {
        String output=resp.getEntity(String.class);
        LOG.debug("HTTP error code: " + resp.getStatus() + " Server response : \n"+ output);
      }
    }
    throw new YarnException(msg);
  }
  return resp;
}
