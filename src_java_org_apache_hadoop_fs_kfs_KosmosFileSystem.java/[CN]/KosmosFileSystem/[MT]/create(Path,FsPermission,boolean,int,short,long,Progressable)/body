{
  if (exists(file)) {
    if (overwrite) {
      delete(file,true);
    }
 else {
      throw new IOException("File already exists: " + file);
    }
  }
  Path parent=file.getParent();
  if (parent != null && !mkdirs(parent)) {
    throw new IOException("Mkdirs failed to create " + parent);
  }
  Path absolute=makeAbsolute(file);
  String srep=absolute.toUri().getPath();
  return kfsImpl.create(srep,replication,bufferSize,progress);
}
