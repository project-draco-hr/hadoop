{
  if (ts == null)   return;
  Collection<Token<? extends TokenIdentifier>> tokens=ts.getAllTokens();
  long now=System.currentTimeMillis();
  for (  Token<? extends TokenIdentifier> t : tokens) {
    if (!t.getKind().equals(kindHdfs)) {
      continue;
    }
    Token<DelegationTokenIdentifier> dt=(Token<DelegationTokenIdentifier>)t;
    DelegationTokenToRenew dtr=new DelegationTokenToRenew(jobId,dt,conf,now);
    addTokenToList(dtr);
    setTimerForTokenRenewal(dtr,true);
    LOG.info("registering token for renewal for service =" + dt.getService() + " and jobID = "+ jobId);
  }
}
