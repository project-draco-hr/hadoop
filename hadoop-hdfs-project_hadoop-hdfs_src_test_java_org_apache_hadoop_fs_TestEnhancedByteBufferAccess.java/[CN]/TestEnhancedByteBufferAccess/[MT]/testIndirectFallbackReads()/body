{
  final File TEST_DIR=new File(System.getProperty("test.build.data","build/test/data"));
  final String TEST_PATH=TEST_DIR + File.separator + "indirectFallbackTestFile";
  final int TEST_FILE_LENGTH=16385;
  final int RANDOM_SEED=23453;
  FileOutputStream fos=null;
  FileInputStream fis=null;
  try {
    fos=new FileOutputStream(TEST_PATH);
    Random random=new Random(RANDOM_SEED);
    byte original[]=new byte[TEST_FILE_LENGTH];
    random.nextBytes(original);
    fos.write(original);
    fos.close();
    fos=null;
    fis=new FileInputStream(TEST_PATH);
    testFallbackImpl(fis,original);
  }
  finally {
    IOUtils.cleanup(LOG,fos,fis);
    new File(TEST_PATH).delete();
  }
}
