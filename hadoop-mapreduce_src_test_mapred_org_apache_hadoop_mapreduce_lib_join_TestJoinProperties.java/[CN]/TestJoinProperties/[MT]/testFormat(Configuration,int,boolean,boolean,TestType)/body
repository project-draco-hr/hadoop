{
  Job job=Job.getInstance(conf);
  CompositeInputFormat format=new CompositeInputFormat();
  int count=0;
  for (  InputSplit split : (List<InputSplit>)format.getSplits(job)) {
    TaskAttemptContext context=MapReduceTestUtil.createDummyMapTaskAttemptContext(conf);
    RecordReader reader=format.createRecordReader(split,context);
    MapContext mcontext=new MapContextImpl(conf,context.getTaskAttemptID(),reader,null,null,MapReduceTestUtil.createDummyReporter(),split);
    reader.initialize(split,mcontext);
    WritableComparable key=null;
    Writable value=null;
    while (reader.nextKeyValue()) {
      key=(WritableComparable)reader.getCurrentKey();
      value=(Writable)reader.getCurrentValue();
      validateKeyValue(key,value,tupleSize,firstTuple,secondTuple,ttype);
      count++;
    }
  }
  return count;
}
