{
  final Configuration conf=new Configuration(inputConf);
  conf.set("fileoutputpath",outputpath);
  final FileSystem fs=FileSystem.get(conf);
  if (fs.exists(new Path(outputpath))) {
    fs.delete(new Path(outputpath),true);
  }
  fs.close();
  final Job job=Job.getInstance(conf,jobname);
  job.setJarByClass(WordCount.class);
  job.setMapperClass(TokenizerMapper.class);
  job.setCombinerClass(IntSumReducer.class);
  job.setReducerClass(IntSumReducer.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(IntWritable.class);
  job.setInputFormatClass(SequenceFileInputFormat.class);
  FileInputFormat.addInputPath(job,new Path(inputpath));
  FileOutputFormat.setOutputPath(job,new Path(outputpath));
  return job;
}
