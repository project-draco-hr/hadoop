{
  final Configuration nativeConf=ScenarioConfiguration.getNativeConfiguration();
  nativeConf.addResource(TestConstants.COMBINER_CONF_PATH);
  final Job nativejob=getJob("nativewordcount",nativeConf,inputpath,nativeoutputpath);
  final Configuration commonConf=ScenarioConfiguration.getNormalConfiguration();
  commonConf.addResource(TestConstants.COMBINER_CONF_PATH);
  final Job normaljob=getJob("normalwordcount",commonConf,inputpath,hadoopoutputpath);
  assertTrue(nativejob.waitForCompletion(true));
  Counter nativeReduceGroups=nativejob.getCounters().findCounter(Task.Counter.REDUCE_INPUT_RECORDS);
  assertTrue(normaljob.waitForCompletion(true));
  Counter normalReduceGroups=normaljob.getCounters().findCounter(Task.Counter.REDUCE_INPUT_RECORDS);
  assertEquals(true,ResultVerifier.verify(nativeoutputpath,hadoopoutputpath));
  assertEquals("Native Reduce reduce group counter should equal orignal reduce group counter",nativeReduceGroups.getValue(),normalReduceGroups.getValue());
}
