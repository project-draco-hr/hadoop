{
  if (!fjm.getStorageDirectory().getCurrentDir().exists()) {
    return;
  }
  LOG.info("Scanning storage " + fjm);
  List<EditLogFile> files=fjm.getLogFiles(0);
  curSegmentTxId=HdfsConstants.INVALID_TXID;
  while (!files.isEmpty()) {
    EditLogFile latestLog=files.remove(files.size() - 1);
    latestLog.validateLog();
    LOG.info("Latest log is " + latestLog);
    if (latestLog.getLastTxId() == HdfsConstants.INVALID_TXID) {
      LOG.warn("Latest log " + latestLog + " has no transactions. "+ "moving it aside and looking for previous log");
      latestLog.moveAsideEmptyFile();
    }
 else {
      curSegmentTxId=latestLog.getFirstTxId();
      break;
    }
  }
}
