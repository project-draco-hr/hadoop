{
  if (!fjm.getStorageDirectory().getCurrentDir().exists()) {
    return;
  }
  LOG.info("Scanning storage " + fjm);
  List<EditLogFile> files=fjm.getLogFiles(0);
  if (files.isEmpty()) {
    curSegmentTxId=HdfsConstants.INVALID_TXID;
    return;
  }
  EditLogFile latestLog=files.get(files.size() - 1);
  latestLog.validateLog();
  LOG.info("Latest log is " + latestLog);
  if (latestLog.getLastTxId() == HdfsConstants.INVALID_TXID) {
    LOG.warn("Latest log " + latestLog + " has no transactions. "+ "moving it aside");
    latestLog.moveAsideEmptyFile();
    curSegmentTxId=HdfsConstants.INVALID_TXID;
  }
 else {
    curSegmentTxId=latestLog.getFirstTxId();
  }
}
