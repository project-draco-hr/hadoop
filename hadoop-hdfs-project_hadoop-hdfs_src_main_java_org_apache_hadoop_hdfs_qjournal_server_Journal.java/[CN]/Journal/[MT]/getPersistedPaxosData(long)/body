{
  File f=storage.getPaxosFile(segmentTxId);
  if (!f.exists()) {
    return null;
  }
  InputStream in=new FileInputStream(f);
  try {
    PersistedRecoveryPaxosData ret=PersistedRecoveryPaxosData.parseDelimitedFrom(in);
    Preconditions.checkState(ret != null && ret.getSegmentState().getStartTxId() == segmentTxId,"Bad persisted data for segment %s: %s",segmentTxId,ret);
    return ret;
  }
  finally {
    IOUtils.closeStream(in);
  }
}
