{
  checkRequest(reqInfo);
  checkFormatted();
  Preconditions.checkState(curSegment != null,"Can't write, no segment open");
  Preconditions.checkState(nextTxId == firstTxnId,"Can't write txid " + firstTxnId + " expecting nextTxId="+ nextTxId);
  if (LOG.isTraceEnabled()) {
    LOG.trace("Writing txid " + firstTxnId + "-"+ (firstTxnId + numTxns - 1));
  }
  curSegment.writeRaw(records,0,records.length);
  curSegment.setReadyToFlush();
  curSegment.flush();
  nextTxId+=numTxns;
}
