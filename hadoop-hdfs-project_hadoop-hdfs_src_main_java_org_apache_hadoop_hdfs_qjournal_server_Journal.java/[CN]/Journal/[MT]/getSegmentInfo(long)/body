{
  EditLogFile elf=fjm.getLogFile(segmentTxId);
  if (elf == null) {
    return null;
  }
  if (elf.isInProgress()) {
    elf.validateLog();
  }
  if (elf.getLastTxId() == HdfsConstants.INVALID_TXID) {
    throw new AssertionError("TODO: no transactions in file " + elf);
  }
  SegmentStateProto ret=SegmentStateProto.newBuilder().setStartTxId(segmentTxId).setEndTxId(elf.getLastTxId()).setIsInProgress(elf.isInProgress()).setMd5Sum(ByteString.EMPTY).build();
  LOG.info("getSegmentInfo(" + segmentTxId + "): "+ elf+ " -> "+ TextFormat.shortDebugString(ret));
  return ret;
}
