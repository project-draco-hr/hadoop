{
  HashMap<String,List<File>> groupedByName=new HashMap<String,List<File>>();
  for (  File dir : dirs) {
    for (    File f : dir.listFiles()) {
      if (ignoredFileNames.contains(f.getName())) {
        continue;
      }
      List<File> fileList=groupedByName.get(f.getName());
      if (fileList == null) {
        fileList=new ArrayList<File>();
        groupedByName.put(f.getName(),fileList);
      }
      fileList.add(f);
    }
  }
  for (  List<File> sameNameList : groupedByName.values()) {
    if (sameNameList.get(0).isDirectory()) {
      assertParallelFilesAreIdentical(sameNameList,ignoredFileNames);
    }
 else {
      assertFileContentsSame(sameNameList.toArray(new File[0]));
    }
  }
}
