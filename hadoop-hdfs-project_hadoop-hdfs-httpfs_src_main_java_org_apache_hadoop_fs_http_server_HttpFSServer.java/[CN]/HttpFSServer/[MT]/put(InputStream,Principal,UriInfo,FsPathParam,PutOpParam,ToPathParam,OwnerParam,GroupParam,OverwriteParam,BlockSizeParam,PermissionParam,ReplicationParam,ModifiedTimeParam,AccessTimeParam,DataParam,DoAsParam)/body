{
  Response response=null;
  if (op == null) {
    throw new UnsupportedOperationException(MessageFormat.format("Missing [{0}] parameter",PutOpParam.NAME));
  }
  path.makeAbsolute();
  MDC.put(HttpFSFileSystem.OP_PARAM,op.value().name());
switch (op.value()) {
case CREATE:
{
      if (!hasData.value()) {
        response=Response.temporaryRedirect(createUploadRedirectionURL(uriInfo,HttpFSFileSystem.PutOpValues.CREATE)).build();
      }
 else {
        FSOperations.FSCreate command=new FSOperations.FSCreate(is,path.value(),permission.value(),override.value(),replication.value(),blockSize.value());
        fsExecute(user,doAs.value(),command);
        AUDIT_LOG.info("[{}] permission [{}] override [{}] replication [{}] blockSize [{}]",new Object[]{path,permission,override,replication,blockSize});
        response=Response.status(Response.Status.CREATED).build();
      }
      break;
    }
case MKDIRS:
{
    FSOperations.FSMkdirs command=new FSOperations.FSMkdirs(path.value(),permission.value());
    JSONObject json=fsExecute(user,doAs.value(),command);
    AUDIT_LOG.info("[{}] permission [{}]",path,permission.value());
    response=Response.ok(json).type(MediaType.APPLICATION_JSON).build();
    break;
  }
case RENAME:
{
  FSOperations.FSRename command=new FSOperations.FSRename(path.value(),toPath.value());
  JSONObject json=fsExecute(user,doAs.value(),command);
  AUDIT_LOG.info("[{}] to [{}]",path,toPath);
  response=Response.ok(json).type(MediaType.APPLICATION_JSON).build();
  break;
}
case SETOWNER:
{
FSOperations.FSSetOwner command=new FSOperations.FSSetOwner(path.value(),owner.value(),group.value());
fsExecute(user,doAs.value(),command);
AUDIT_LOG.info("[{}] to (O/G)[{}]",path,owner.value() + ":" + group.value());
response=Response.ok().build();
break;
}
case SETPERMISSION:
{
FSOperations.FSSetPermission command=new FSOperations.FSSetPermission(path.value(),permission.value());
fsExecute(user,doAs.value(),command);
AUDIT_LOG.info("[{}] to [{}]",path,permission.value());
response=Response.ok().build();
break;
}
case SETREPLICATION:
{
FSOperations.FSSetReplication command=new FSOperations.FSSetReplication(path.value(),replication.value());
JSONObject json=fsExecute(user,doAs.value(),command);
AUDIT_LOG.info("[{}] to [{}]",path,replication.value());
response=Response.ok(json).build();
break;
}
case SETTIMES:
{
FSOperations.FSSetTimes command=new FSOperations.FSSetTimes(path.value(),modifiedTime.value(),accessTime.value());
fsExecute(user,doAs.value(),command);
AUDIT_LOG.info("[{}] to (M/A)[{}]",path,modifiedTime.value() + ":" + accessTime.value());
response=Response.ok().build();
break;
}
case RENEWDELEGATIONTOKEN:
{
response=Response.status(Response.Status.BAD_REQUEST).build();
break;
}
case CANCELDELEGATIONTOKEN:
{
response=Response.status(Response.Status.BAD_REQUEST).build();
break;
}
}
return response;
}
