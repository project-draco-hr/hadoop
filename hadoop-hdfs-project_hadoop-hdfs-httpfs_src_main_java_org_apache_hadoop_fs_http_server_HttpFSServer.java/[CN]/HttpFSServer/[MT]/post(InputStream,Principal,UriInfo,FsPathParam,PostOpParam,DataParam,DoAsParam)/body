{
  Response response=null;
  if (op == null) {
    throw new UnsupportedOperationException(MessageFormat.format("Missing [{0}] parameter",PostOpParam.NAME));
  }
  path.makeAbsolute();
  MDC.put(HttpFSFileSystem.OP_PARAM,op.value().name());
switch (op.value()) {
case APPEND:
{
      if (!hasData.value()) {
        response=Response.temporaryRedirect(createUploadRedirectionURL(uriInfo,HttpFSFileSystem.PostOpValues.APPEND)).build();
      }
 else {
        FSOperations.FSAppend command=new FSOperations.FSAppend(is,path.value());
        fsExecute(user,doAs.value(),command);
        AUDIT_LOG.info("[{}]",path);
        response=Response.ok().type(MediaType.APPLICATION_JSON).build();
      }
      break;
    }
}
return response;
}
