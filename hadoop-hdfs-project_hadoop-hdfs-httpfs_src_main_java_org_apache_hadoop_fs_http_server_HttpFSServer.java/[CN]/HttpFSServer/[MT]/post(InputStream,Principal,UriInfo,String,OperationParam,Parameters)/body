{
  Response response;
  path=makeAbsolute(path);
  MDC.put(HttpFSFileSystem.OP_PARAM,op.value().name());
  String doAs=params.get(DoAsParam.NAME,DoAsParam.class);
switch (op.value()) {
case APPEND:
{
      Boolean hasData=params.get(DataParam.NAME,DataParam.class);
      if (!hasData) {
        response=Response.temporaryRedirect(createUploadRedirectionURL(uriInfo,HttpFSFileSystem.Operation.APPEND)).build();
      }
 else {
        FSOperations.FSAppend command=new FSOperations.FSAppend(is,path);
        fsExecute(user,doAs,command);
        AUDIT_LOG.info("[{}]",path);
        response=Response.ok().type(MediaType.APPLICATION_JSON).build();
      }
      break;
    }
default :
{
    throw new IOException(MessageFormat.format("Invalid HTTP POST operation [{0}]",op.value()));
  }
}
return response;
}
