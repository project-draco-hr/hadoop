{
  String effectiveUser=user.getName();
  if (doAs != null && !doAs.equals(user.getName())) {
    ProxyUser proxyUser=HttpFSServerWebApp.get().get(ProxyUser.class);
    proxyUser.validate(user.getName(),HostnameFilter.get(),doAs);
    effectiveUser=doAs;
    AUDIT_LOG.info("Proxy user [{}] DoAs user [{}]",user.getName(),doAs);
  }
  return effectiveUser;
}
