{
  conf=new Configuration();
  String endpoint=conf.getTrimmed(TEST_ENDPOINT,"");
  if (endpoint.isEmpty()) {
    LOG.warn("Custom endpoint test skipped as " + TEST_ENDPOINT + "config "+ "setting was not detected");
  }
 else {
    conf.set(Constants.ENDPOINT,endpoint);
    fs=S3ATestUtils.createTestFileSystem(conf);
    AmazonS3Client s3=fs.getAmazonS3Client();
    String endPointRegion="";
    String[] endpointParts=StringUtils.split(endpoint,'.');
    if (endpointParts.length == 3) {
      endPointRegion=endpointParts[0].substring(3);
    }
 else     if (endpointParts.length == 4) {
      endPointRegion=endpointParts[1];
    }
 else {
      fail("Unexpected endpoint");
    }
    assertEquals("Endpoint config setting and bucket location differ: ",endPointRegion,s3.getBucketLocation(fs.getUri().getHost()));
  }
}
