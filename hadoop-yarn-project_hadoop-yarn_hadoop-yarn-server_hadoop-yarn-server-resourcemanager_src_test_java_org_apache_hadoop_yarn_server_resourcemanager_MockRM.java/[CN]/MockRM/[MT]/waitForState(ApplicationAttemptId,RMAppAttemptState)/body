{
  RMApp app=getRMContext().getRMApps().get(attemptId.getApplicationId());
  Assert.assertNotNull("app shouldn't be null",app);
  RMAppAttempt attempt=app.getRMAppAttempt(attemptId);
  int timeoutSecs=0;
  while (!finalState.equals(attempt.getAppAttemptState()) && timeoutSecs++ < 40) {
    System.out.println("AppAttempt : " + attemptId + " State is : "+ attempt.getAppAttemptState()+ " Waiting for state : "+ finalState);
    Thread.sleep(1000);
  }
  System.out.println("Attempt State is : " + attempt.getAppAttemptState());
  Assert.assertEquals("Attempt state is not correct (timedout)",finalState,attempt.getAppAttemptState());
}
