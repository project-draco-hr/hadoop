{
  RMApp app=getRMContext().getRMApps().get(appId);
  Assert.assertNotNull("app shouldn't be null",app);
  int timeoutSecs=0;
  while (!finalState.equals(app.getState()) && timeoutSecs++ < 40) {
    System.out.println("App : " + appId + " State is : "+ app.getState()+ " Waiting for state : "+ finalState);
    Thread.sleep(2000);
  }
  System.out.println("App State is : " + app.getState());
  Assert.assertEquals("App state is not correct (timedout)",finalState,app.getState());
}
