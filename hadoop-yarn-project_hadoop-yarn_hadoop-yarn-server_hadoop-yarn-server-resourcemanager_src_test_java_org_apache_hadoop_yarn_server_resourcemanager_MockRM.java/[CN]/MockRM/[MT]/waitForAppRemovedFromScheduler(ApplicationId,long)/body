{
  int timeWaiting=0;
  Map<ApplicationId,SchedulerApplication> apps=((AbstractYarnScheduler)getResourceScheduler()).getSchedulerApplications();
  while (apps.containsKey(appId)) {
    if (timeWaiting >= timeoutMsecs) {
      break;
    }
    LOG.info("wait for app removed, " + appId);
    Thread.sleep(WAIT_MS_PER_LOOP);
    timeWaiting+=WAIT_MS_PER_LOOP;
  }
  Assert.assertTrue("app is not removed from scheduler (timeout).",!apps.containsKey(appId));
  LOG.info("app is removed from scheduler, " + appId);
}
