{
  rm.waitForState(app.getApplicationId(),RMAppState.ACCEPTED);
  RMAppAttempt attempt=app.getCurrentAppAttempt();
  waitForSchedulerAppAttemptAdded(attempt.getAppAttemptId(),rm);
  rm.waitForState(attempt.getAppAttemptId(),RMAppAttemptState.SCHEDULED);
  System.out.println("Launch AM " + attempt.getAppAttemptId());
  nm.nodeHeartbeat(true);
  MockAM am=rm.sendAMLaunched(attempt.getAppAttemptId());
  rm.waitForState(attempt.getAppAttemptId(),RMAppAttemptState.LAUNCHED);
  return am;
}
