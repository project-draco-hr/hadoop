{
  FinishApplicationMasterRequest req=FinishApplicationMasterRequest.newInstance(FinalApplicationStatus.SUCCEEDED,"","");
  am.unregisterAppAttempt(req,true);
  rm.waitForState(am.getApplicationAttemptId(),RMAppAttemptState.FINISHING);
  nm.nodeHeartbeat(am.getApplicationAttemptId(),1,ContainerState.COMPLETE);
  rm.waitForState(am.getApplicationAttemptId(),RMAppAttemptState.FINISHED);
  rm.waitForState(rmApp.getApplicationId(),RMAppState.FINISHED);
}
