{
  RMContainer container=getResourceScheduler().getRMContainer(containerId);
  int timeoutSecs=0;
  while (((container == null) || !containerState.equals(container.getState())) && timeoutSecs++ < timeoutMillisecs / 100) {
    if (container == null) {
      container=getResourceScheduler().getRMContainer(containerId);
    }
    System.out.println("Container : " + containerId + " Waiting for state : "+ containerState);
    Thread.sleep(100);
    if (timeoutMillisecs <= timeoutSecs * 100) {
      return false;
    }
  }
  System.out.println("Container State is : " + container.getState());
  Assert.assertEquals("Container state is not correct (timedout)",containerState,container.getState());
  return true;
}
