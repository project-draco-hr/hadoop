{
  rm.waitForState(app.getApplicationId(),RMAppState.ACCEPTED);
  RMAppAttempt attempt=app.getCurrentAppAttempt();
  waitForSchedulerAppAttemptAdded(attempt.getAppAttemptId(),rm);
  System.out.println("Launch AM " + attempt.getAppAttemptId());
  nm.nodeHeartbeat(true);
  MockAM am=new MockAM(rm.getRMContext(),rm.masterService,attempt.getAppAttemptId());
  rm.waitForState(attempt.getAppAttemptId(),RMAppAttemptState.LAUNCHED);
  return am;
}
