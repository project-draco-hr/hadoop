{
  checkScheme(uri,supportedScheme);
  if (defaultPort < 0 && authorityNeeded) {
    throw new HadoopIllegalArgumentException("FileSystem implementation error -  default port " + defaultPort + " is not valid");
  }
  String authority=uri.getAuthority();
  if (authority == null) {
    if (authorityNeeded) {
      throw new HadoopIllegalArgumentException("Uri without authority: " + uri);
    }
 else {
      return new URI(supportedScheme + ":///");
    }
  }
  int port=uri.getPort();
  port=(port == -1 ? defaultPort : port);
  if (port == -1) {
    return new URI(supportedScheme,authority,"/",null);
  }
  return new URI(supportedScheme + "://" + uri.getHost()+ ":"+ port);
}
