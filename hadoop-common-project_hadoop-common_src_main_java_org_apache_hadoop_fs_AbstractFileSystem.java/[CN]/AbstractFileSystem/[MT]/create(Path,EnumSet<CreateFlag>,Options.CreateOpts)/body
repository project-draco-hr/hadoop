{
  checkPath(f);
  int bufferSize=-1;
  short replication=-1;
  long blockSize=-1;
  int bytesPerChecksum=-1;
  ChecksumOpt checksumOpt=null;
  FsPermission permission=null;
  Progressable progress=null;
  Boolean createParent=null;
  for (  CreateOpts iOpt : opts) {
    if (CreateOpts.BlockSize.class.isInstance(iOpt)) {
      if (blockSize != -1) {
        throw new HadoopIllegalArgumentException("BlockSize option is set multiple times");
      }
      blockSize=((CreateOpts.BlockSize)iOpt).getValue();
    }
 else     if (CreateOpts.BufferSize.class.isInstance(iOpt)) {
      if (bufferSize != -1) {
        throw new HadoopIllegalArgumentException("BufferSize option is set multiple times");
      }
      bufferSize=((CreateOpts.BufferSize)iOpt).getValue();
    }
 else     if (CreateOpts.ReplicationFactor.class.isInstance(iOpt)) {
      if (replication != -1) {
        throw new HadoopIllegalArgumentException("ReplicationFactor option is set multiple times");
      }
      replication=((CreateOpts.ReplicationFactor)iOpt).getValue();
    }
 else     if (CreateOpts.BytesPerChecksum.class.isInstance(iOpt)) {
      if (bytesPerChecksum != -1) {
        throw new HadoopIllegalArgumentException("BytesPerChecksum option is set multiple times");
      }
      bytesPerChecksum=((CreateOpts.BytesPerChecksum)iOpt).getValue();
    }
 else     if (CreateOpts.ChecksumParam.class.isInstance(iOpt)) {
      if (checksumOpt != null) {
        throw new HadoopIllegalArgumentException("CreateChecksumType option is set multiple times");
      }
      checksumOpt=((CreateOpts.ChecksumParam)iOpt).getValue();
    }
 else     if (CreateOpts.Perms.class.isInstance(iOpt)) {
      if (permission != null) {
        throw new HadoopIllegalArgumentException("Perms option is set multiple times");
      }
      permission=((CreateOpts.Perms)iOpt).getValue();
    }
 else     if (CreateOpts.Progress.class.isInstance(iOpt)) {
      if (progress != null) {
        throw new HadoopIllegalArgumentException("Progress option is set multiple times");
      }
      progress=((CreateOpts.Progress)iOpt).getValue();
    }
 else     if (CreateOpts.CreateParent.class.isInstance(iOpt)) {
      if (createParent != null) {
        throw new HadoopIllegalArgumentException("CreateParent option is set multiple times");
      }
      createParent=((CreateOpts.CreateParent)iOpt).getValue();
    }
 else {
      throw new HadoopIllegalArgumentException("Unkown CreateOpts of type " + iOpt.getClass().getName());
    }
  }
  if (permission == null) {
    throw new HadoopIllegalArgumentException("no permission supplied");
  }
  FsServerDefaults ssDef=getServerDefaults();
  if (ssDef.getBlockSize() % ssDef.getBytesPerChecksum() != 0) {
    throw new IOException("Internal error: default blockSize is" + " not a multiple of default bytesPerChecksum ");
  }
  if (blockSize == -1) {
    blockSize=ssDef.getBlockSize();
  }
  ChecksumOpt defaultOpt=new ChecksumOpt(ssDef.getChecksumType(),ssDef.getBytesPerChecksum());
  checksumOpt=ChecksumOpt.processChecksumOpt(defaultOpt,checksumOpt,bytesPerChecksum);
  if (bufferSize == -1) {
    bufferSize=ssDef.getFileBufferSize();
  }
  if (replication == -1) {
    replication=ssDef.getReplication();
  }
  if (createParent == null) {
    createParent=false;
  }
  if (blockSize % bytesPerChecksum != 0) {
    throw new HadoopIllegalArgumentException("blockSize should be a multiple of checksumsize");
  }
  return this.createInternal(f,createFlag,permission,bufferSize,replication,blockSize,progress,checksumOpt,createParent);
}
