{
  Path path=path("/test/hadoop/file");
  fs.mkdirs(path.getParent());
  FSDataOutputStream out=fs.create(path,false,fs.getConf().getInt("io.file.buffer.size",4096),(short)1,getBlockSize());
  out.write(data,0,len);
  out.close();
  assertTrue("Exists",fs.exists(path));
  assertEquals("Length",len,fs.getFileStatus(path).getLen());
  FSDataInputStream in=fs.open(path);
  for (int i=0; i < len; i++) {
    final int b=in.read();
    assertEquals("Position " + i,data[i],b);
  }
  in.close();
  assertTrue("Deleted",fs.delete(path,false));
  assertFalse("No longer exists",fs.exists(path));
}
