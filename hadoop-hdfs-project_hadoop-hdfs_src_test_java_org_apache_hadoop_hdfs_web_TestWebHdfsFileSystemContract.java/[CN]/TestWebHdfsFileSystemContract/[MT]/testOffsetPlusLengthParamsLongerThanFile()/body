{
  WebHdfsFileSystem webhdfs=(WebHdfsFileSystem)fs;
  Path dir=new Path("/test");
  assertTrue(webhdfs.mkdirs(dir));
  Path testFile=new Path("/test/testOffsetPlusLengthParamsLongerThanFile");
  String content="testOffsetPlusLengthParamsLongerThanFile";
  FSDataOutputStream testFileOut=webhdfs.create(testFile);
  try {
    testFileOut.write(content.getBytes("US-ASCII"));
  }
  finally {
    IOUtils.closeStream(testFileOut);
  }
  HttpOpParam.Op op=GetOpParam.Op.OPEN;
  URL url=webhdfs.toUrl(op,testFile,new LengthParam(Long.valueOf(content.length())),new OffsetParam(1L));
  HttpURLConnection conn=null;
  InputStream is=null;
  try {
    conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod(op.getType().toString());
    conn.setDoOutput(op.getDoOutput());
    conn.setInstanceFollowRedirects(true);
    assertEquals(HttpServletResponse.SC_OK,conn.getResponseCode());
    assertEquals(String.valueOf(content.length() - 1),conn.getHeaderField("Content-Length"));
    byte[] respBody=new byte[content.length() - 1];
    is=conn.getInputStream();
    IOUtils.readFully(is,respBody,0,content.length() - 1);
    assertEquals(content.substring(1),new String(respBody,"US-ASCII"));
  }
  finally {
    IOUtils.closeStream(is);
    if (conn != null) {
      conn.disconnect();
    }
  }
}
