{
  final WebHdfsFileSystem webhdfs=(WebHdfsFileSystem)fs;
  final Path dir=new Path("/test/testUrl");
  assertTrue(webhdfs.mkdirs(dir));
{
    final URL url=webhdfs.toUrl(PutOpParam.Op.SETOWNER,dir);
    final HttpURLConnection conn=(HttpURLConnection)url.openConnection();
    conn.connect();
    assertEquals(HttpServletResponse.SC_BAD_REQUEST,conn.getResponseCode());
    conn.disconnect();
  }
{
    final HttpOpParam.Op op=PutOpParam.Op.SETREPLICATION;
    final URL url=webhdfs.toUrl(op,dir);
    final HttpURLConnection conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod(op.getType().toString());
    conn.connect();
    assertEquals(HttpServletResponse.SC_FORBIDDEN,conn.getResponseCode());
    assertFalse(webhdfs.setReplication(dir,(short)1));
    conn.disconnect();
  }
{
    final Path p=new Path(dir,"non-exist");
    final URL url=webhdfs.toUrl(GetOpParam.Op.GETFILESTATUS,p);
    final HttpURLConnection conn=(HttpURLConnection)url.openConnection();
    conn.connect();
    assertEquals(HttpServletResponse.SC_NOT_FOUND,conn.getResponseCode());
    conn.disconnect();
  }
{
    final HttpOpParam.Op op=PutOpParam.Op.SETPERMISSION;
    final URL url=webhdfs.toUrl(op,dir);
    final HttpURLConnection conn=(HttpURLConnection)url.openConnection();
    conn.setRequestMethod(op.getType().toString());
    conn.connect();
    assertEquals(HttpServletResponse.SC_OK,conn.getResponseCode());
    assertEquals((short)0755,webhdfs.getFileStatus(dir).getPermission().toShort());
    conn.disconnect();
  }
}
