{
  query=addDelegationTokenParam(query);
  final URL url=new URL("https",nnUri.getHost(),nnUri.getPort(),path + '?' + query);
  HttpsURLConnection conn;
  conn=(HttpsURLConnection)connectionFactory.openConnection(url);
  conn.setHostnameVerifier(new DummyHostnameVerifier());
  conn.setRequestMethod("GET");
  conn.connect();
  final int warnDays=ExpWarnDays;
  if (warnDays > 0) {
    ExpWarnDays=0;
    long expTimeThreshold=warnDays * MM_SECONDS_PER_DAY + Time.now();
    X509Certificate[] clientCerts=(X509Certificate[])conn.getLocalCertificates();
    if (clientCerts != null) {
      for (      X509Certificate cert : clientCerts) {
        long expTime=cert.getNotAfter().getTime();
        if (expTime < expTimeThreshold) {
          StringBuilder sb=new StringBuilder();
          sb.append("\n Client certificate " + cert.getSubjectX500Principal().getName());
          int dayOffSet=(int)((expTime - Time.now()) / MM_SECONDS_PER_DAY);
          sb.append(" have " + dayOffSet + " days to expire");
          LOG.warn(sb.toString());
        }
      }
    }
  }
  return (HttpURLConnection)conn;
}
