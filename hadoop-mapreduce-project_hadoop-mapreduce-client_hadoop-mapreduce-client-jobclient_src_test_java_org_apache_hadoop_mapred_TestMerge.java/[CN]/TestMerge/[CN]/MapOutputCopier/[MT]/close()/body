{
  long totalSize=0;
  for (int i=0; i < numberOfPartitions; i++) {
    recordWriters[i].close();
    outStreams[i].close();
    totalSize+=outStreams[i].size();
  }
  MapOutputFile mapOutputFile=mapTask.getMapOutputFile();
  Path finalOutput=mapOutputFile.getOutputFileForWrite(totalSize);
  Path indexPath=mapOutputFile.getOutputIndexFileForWrite(numberOfPartitions * mapTask.MAP_OUTPUT_INDEX_RECORD_LENGTH);
  copyPartitions(finalOutput,indexPath);
}
