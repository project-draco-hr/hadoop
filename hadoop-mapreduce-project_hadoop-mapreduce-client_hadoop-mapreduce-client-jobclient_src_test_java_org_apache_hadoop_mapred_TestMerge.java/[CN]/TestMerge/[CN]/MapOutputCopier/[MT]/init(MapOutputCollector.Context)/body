{
  this.mapTask=context.getMapTask();
  this.jobConf=context.getJobConf();
  this.reporter=context.getReporter();
  numberOfPartitions=jobConf.getNumReduceTasks();
  keyClass=(Class<K>)jobConf.getMapOutputKeyClass();
  valueClass=(Class<V>)jobConf.getMapOutputValueClass();
  recordWriters=new KeyValueWriter[numberOfPartitions];
  outStreams=new ByteArrayOutputStream[numberOfPartitions];
  for (int i=0; i < numberOfPartitions; i++) {
    outStreams[i]=new ByteArrayOutputStream();
    recordWriters[i]=new KeyValueWriter<K,V>(jobConf,outStreams[i],keyClass,valueClass);
  }
}
