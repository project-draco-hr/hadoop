{
  fileSystem.delete(OUTPUT,true);
  job.setJobName("MergeTest");
  JobClient client=new JobClient(job);
  RunningJob submittedJob=null;
  FileInputFormat.setInputPaths(job,INPUT_DIR);
  FileOutputFormat.setOutputPath(job,OUTPUT);
  job.set("mapreduce.output.textoutputformat.separator"," ");
  job.setInputFormat(TextInputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(Text.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(Text.class);
  job.setMapperClass(MyMapper.class);
  job.setPartitionerClass(MyPartitioner.class);
  job.setOutputFormat(TextOutputFormat.class);
  job.setNumReduceTasks(NUM_REDUCERS);
  job.set(JobContext.MAP_OUTPUT_COLLECTOR_CLASS_ATTR,MapOutputCopier.class.getName());
  try {
    submittedJob=client.submitJob(job);
    try {
      if (!client.monitorAndPrintJob(job,submittedJob)) {
        throw new IOException("Job failed!");
      }
    }
 catch (    InterruptedException ie) {
      Thread.currentThread().interrupt();
    }
  }
 catch (  IOException ioe) {
    System.err.println("Job failed with: " + ioe);
  }
 finally {
    verifyOutput(submittedJob,fileSystem);
  }
}
