{
  FSDataInputStream dis=null;
  long numValidRecords=0;
  long numInvalidRecords=0;
  long numMappersLaunched=NUM_MAPPERS;
  String prevKeyValue="000000000";
  Path[] fileList=FileUtil.stat2Paths(fileSystem.listStatus(OUTPUT,new Utils.OutputFileUtils.OutputFilesFilter()));
  for (  Path outFile : fileList) {
    try {
      dis=fileSystem.open(outFile);
      String record;
      while ((record=dis.readLine()) != null) {
        int blankPos=record.indexOf(" ");
        String keyString=record.substring(0,blankPos);
        String valueString=record.substring(blankPos + 1);
        if (keyString.compareTo(prevKeyValue) >= 0 && keyString.equals(valueString)) {
          prevKeyValue=keyString;
          numValidRecords++;
        }
 else {
          numInvalidRecords++;
        }
      }
    }
  finally {
      if (dis != null) {
        dis.close();
        dis=null;
      }
    }
  }
  assertEquals((long)(NUM_MAPPERS * NUM_LINES),numValidRecords);
  assertEquals(0,numInvalidRecords);
}
