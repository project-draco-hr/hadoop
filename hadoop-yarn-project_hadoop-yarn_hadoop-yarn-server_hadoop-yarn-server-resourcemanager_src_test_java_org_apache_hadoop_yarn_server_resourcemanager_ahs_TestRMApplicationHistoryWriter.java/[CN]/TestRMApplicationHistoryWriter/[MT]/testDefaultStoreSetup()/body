{
  Configuration conf=new YarnConfiguration();
  conf.setBoolean(YarnConfiguration.APPLICATION_HISTORY_ENABLED,true);
  RMApplicationHistoryWriter writer=new RMApplicationHistoryWriter();
  writer.init(conf);
  writer.start();
  try {
    Assert.assertFalse(writer.historyServiceEnabled);
    Assert.assertNull(writer.writer);
  }
  finally {
    writer.stop();
    writer.close();
  }
}
