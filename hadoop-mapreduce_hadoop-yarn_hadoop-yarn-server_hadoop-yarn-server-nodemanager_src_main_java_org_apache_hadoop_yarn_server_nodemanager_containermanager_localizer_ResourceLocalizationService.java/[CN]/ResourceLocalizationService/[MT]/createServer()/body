{
  YarnRPC rpc=YarnRPC.create(getConfig());
  Configuration conf=new Configuration(getConfig());
  LocalizerTokenSecretManager secretManager=null;
  if (UserGroupInformation.isSecurityEnabled()) {
    conf.setClass(YarnConfiguration.YARN_SECURITY_INFO,LocalizerSecurityInfo.class,SecurityInfo.class);
    secretManager=new LocalizerTokenSecretManager();
  }
  return rpc.getServer(LocalizationProtocol.class,this,localizationServerAddress,conf,secretManager,conf.getInt(NMConfig.NM_LOCALIZATION_THREADS,NMConfig.DEFAULT_NM_LOCALIZATION_THREADS));
}
