{
  final SSLFactory factory;
  final SSLSocketFactory sf;
  final HostnameVerifier hv;
  final int connectTimeout;
  final int readTimeout;
  factory=new SSLFactory(SSLFactory.Mode.CLIENT,conf);
  factory.init();
  sf=factory.createSSLSocketFactory();
  hv=factory.getHostnameVerifier();
  connectTimeout=(int)conf.getTimeDuration(HdfsClientConfigKeys.DFS_WEBHDFS_SOCKET_CONNECT_TIMEOUT_KEY,defaultTimeout,TimeUnit.MILLISECONDS);
  readTimeout=(int)conf.getTimeDuration(HdfsClientConfigKeys.DFS_WEBHDFS_SOCKET_READ_TIMEOUT_KEY,defaultTimeout,TimeUnit.MILLISECONDS);
  return new ConnectionConfigurator(){
    @Override public HttpURLConnection configure(    HttpURLConnection conn) throws IOException {
      if (conn instanceof HttpsURLConnection) {
        HttpsURLConnection c=(HttpsURLConnection)conn;
        c.setSSLSocketFactory(sf);
        c.setHostnameVerifier(hv);
      }
      URLConnectionFactory.setTimeouts(conn,connectTimeout,readTimeout);
      return conn;
    }
  }
;
}
