{
  FsVolumeImpl volume;
  try (FsVolumeReferences references=dataset.getFsVolumeReferences()){
    volume=(FsVolumeImpl)references.get(0);
  }
   File bpDir=new File(volume.getCurrentDir(),bpid);
  File bpCurrentDir=new File(bpDir,DataStorage.STORAGE_DIR_CURRENT);
  File finalizedDir=new File(bpCurrentDir,DataStorage.STORAGE_DIR_FINALIZED);
  File rbwDir=new File(bpCurrentDir,DataStorage.STORAGE_DIR_RBW);
  File versionFile=new File(bpCurrentDir,"VERSION");
  if (!finalizedDir.isDirectory()) {
    throw new IOException(finalizedDir.getPath() + " is not a directory.");
  }
  if (!rbwDir.isDirectory()) {
    throw new IOException(finalizedDir.getPath() + " is not a directory.");
  }
  if (!versionFile.exists()) {
    throw new IOException("Version file: " + versionFile.getPath() + " does not exist.");
  }
}
