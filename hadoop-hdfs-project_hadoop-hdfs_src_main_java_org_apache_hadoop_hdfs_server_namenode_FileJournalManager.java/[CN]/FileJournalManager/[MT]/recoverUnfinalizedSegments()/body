{
  File currentDir=sd.getCurrentDir();
  LOG.info("Recovering unfinalized segments in " + currentDir);
  List<EditLogFile> allLogFiles=matchEditLogs(currentDir.listFiles());
  findMaxTransaction(true);
  for (  EditLogFile elf : allLogFiles) {
    if (elf.getFile().equals(currentInProgress)) {
      continue;
    }
    if (elf.isInProgress()) {
      elf.validateLog();
      if (elf.isCorrupt()) {
        elf.moveAsideCorruptFile();
        continue;
      }
      finalizeLogSegment(elf.getFirstTxId(),elf.getLastTxId());
    }
  }
}
