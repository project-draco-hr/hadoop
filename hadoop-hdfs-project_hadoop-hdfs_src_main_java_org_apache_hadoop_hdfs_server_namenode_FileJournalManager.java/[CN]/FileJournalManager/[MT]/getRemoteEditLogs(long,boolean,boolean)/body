{
  Preconditions.checkArgument(!(forReading && inProgressOk));
  File currentDir=sd.getCurrentDir();
  List<EditLogFile> allLogFiles=matchEditLogs(currentDir);
  List<RemoteEditLog> ret=Lists.newArrayListWithCapacity(allLogFiles.size());
  for (  EditLogFile elf : allLogFiles) {
    if (elf.hasCorruptHeader() || (!inProgressOk && elf.isInProgress())) {
      continue;
    }
    if (elf.getFirstTxId() >= firstTxId) {
      ret.add(new RemoteEditLog(elf.firstTxId,elf.lastTxId));
    }
 else     if (elf.getFirstTxId() < firstTxId && firstTxId <= elf.getLastTxId()) {
      if (forReading) {
        throw new IllegalStateException("Asked for firstTxId " + firstTxId + " which is in the middle of file "+ elf.file);
      }
 else {
        ret.add(new RemoteEditLog(elf.firstTxId,elf.lastTxId));
      }
    }
  }
  Collections.sort(ret);
  return ret;
}
