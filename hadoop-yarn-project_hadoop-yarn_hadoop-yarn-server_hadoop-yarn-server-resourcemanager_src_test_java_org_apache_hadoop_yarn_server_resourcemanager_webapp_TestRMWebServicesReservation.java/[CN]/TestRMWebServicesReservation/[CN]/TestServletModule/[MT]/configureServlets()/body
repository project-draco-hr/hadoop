{
  configureScheduler();
  bind(JAXBContextResolver.class);
  bind(RMWebServices.class);
  bind(GenericExceptionHandler.class);
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,YarnConfiguration.DEFAULT_RM_AM_MAX_ATTEMPTS);
  Configuration conf=new Configuration();
  conf.setBoolean(YarnConfiguration.RM_RESERVATION_SYSTEM_ENABLE,true);
  conf.setInt(YarnConfiguration.RM_AM_MAX_ATTEMPTS,YarnConfiguration.DEFAULT_RM_AM_MAX_ATTEMPTS);
  conf.setClass(YarnConfiguration.RM_SCHEDULER,CapacityScheduler.class,ResourceScheduler.class);
  CapacitySchedulerConfiguration csconf=new CapacitySchedulerConfiguration(conf);
  String[] queues={"default","dedicated"};
  csconf.setQueues("root",queues);
  csconf.setCapacity("root.default",50.0f);
  csconf.setCapacity("root.dedicated",50.0f);
  csconf.setReservable("root.dedicated",true);
  rm=new MockRM(csconf);
  bind(ResourceManager.class).toInstance(rm);
  if (setAuthFilter) {
    filter("/*").through(TestRMCustomAuthFilter.class);
  }
  serve("/*").with(GuiceContainer.class);
}
