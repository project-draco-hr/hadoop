{
  Path testFile=new Path(testFilePath);
  Path firstDir=new Path(firstDirPath);
  Path middleDir=new Path(middleDirPath);
  FsPermission permission=FsPermission.createImmutable(permissionShort);
  FsPermission umaskedPermission=FsPermission.createImmutable(umaskedPermissionShort);
  createEmptyFile(testFile,permission);
  FsPermission rootPerm=fs.getFileStatus(firstDir.getParent()).getPermission();
  FsPermission inheritPerm=FsPermission.createImmutable((short)(rootPerm.toShort() | 0300));
  assertTrue(fs.exists(testFile));
  assertTrue(fs.exists(firstDir));
  assertTrue(fs.exists(middleDir));
  FileStatus directoryStatus=fs.getFileStatus(middleDir);
  assertTrue(directoryStatus.isDirectory());
  assertEqualsIgnoreStickyBit(inheritPerm,directoryStatus.getPermission());
  FileStatus fileStatus=fs.getFileStatus(testFile);
  assertFalse(fileStatus.isDirectory());
  assertEqualsIgnoreStickyBit(umaskedPermission,fileStatus.getPermission());
  assertTrue(fs.delete(firstDir,true));
  assertFalse(fs.exists(testFile));
}
