{
  String parent="parent";
  Path parentFolder=new Path(parent);
  assertTrue(fs.mkdirs(parentFolder));
  Path inner=new Path(parentFolder,"innerFolder");
  assertTrue(fs.mkdirs(inner));
  Path inner2=new Path(parentFolder,"innerFolder2");
  assertTrue(fs.mkdirs(inner2));
  Path innerFile=new Path(inner2,"file");
  assertTrue(fs.createNewFile(innerFile));
  Path inner2renamed=new Path(parentFolder,"innerFolder2Renamed");
  Path home=fs.getHomeDirectory();
  String relativeHomeDir=getRelativePath(home.toString());
  NativeAzureFileSystem.FolderRenamePending pending=new NativeAzureFileSystem.FolderRenamePending(relativeHomeDir + "/" + inner2,relativeHomeDir + "/" + inner2renamed,null,(NativeAzureFileSystem)fs);
  final String renamePendingStr=inner2 + FolderRenamePending.SUFFIX;
  Path renamePendingFile=new Path(renamePendingStr);
  FSDataOutputStream out=fs.create(renamePendingFile,true);
  assertTrue(out != null);
  writeString(out,pending.makeRenamePendingFileContents());
  FileStatus[] listed=fs.listStatus(parentFolder);
  assertEquals(2,listed.length);
  assertTrue(listed[0].isDirectory());
  assertTrue(listed[1].isDirectory());
  assertFalse(fs.exists(inner2));
  assertTrue(fs.exists(inner2renamed));
  assertTrue(fs.exists(new Path(inner2renamed,"file")));
}
