{
  SelfRenewingLease lease;
  final String FILE_KEY="file";
  fs.create(new Path(FILE_KEY));
  NativeAzureFileSystem nfs=(NativeAzureFileSystem)fs;
  String fullKey=nfs.pathToKey(nfs.makeAbsolute(new Path(FILE_KEY)));
  AzureNativeFileSystemStore store=nfs.getStore();
  lease=store.acquireLease(fullKey);
  assertTrue(lease.getLeaseID() != null);
  Thread.sleep(42000);
  lease.free();
  CloudBlob blob=lease.getCloudBlob();
  String differentLeaseID=null;
  try {
    differentLeaseID=blob.acquireLease(15,null);
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Caught exception trying to directly re-acquire lease from Azure");
  }
 finally {
    assertTrue(differentLeaseID != null);
    AccessCondition accessCondition=AccessCondition.generateEmptyCondition();
    accessCondition.setLeaseID(differentLeaseID);
    blob.releaseLease(accessCondition);
  }
}
