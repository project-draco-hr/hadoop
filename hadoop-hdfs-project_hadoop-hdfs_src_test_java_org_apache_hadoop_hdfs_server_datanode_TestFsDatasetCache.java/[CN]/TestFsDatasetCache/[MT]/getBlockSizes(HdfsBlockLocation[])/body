{
  long[] sizes=new long[locs.length];
  for (int i=0; i < locs.length; i++) {
    HdfsBlockLocation loc=locs[i];
    String bpid=loc.getLocatedBlock().getBlock().getBlockPoolId();
    Block block=loc.getLocatedBlock().getBlock().getLocalBlock();
    ExtendedBlock extBlock=new ExtendedBlock(bpid,block);
    FileInputStream blockInputStream=null;
    FileChannel blockChannel=null;
    try {
      blockInputStream=(FileInputStream)fsd.getBlockInputStream(extBlock,0);
      blockChannel=blockInputStream.getChannel();
      sizes[i]=blockChannel.size();
    }
  finally {
      IOUtils.cleanup(LOG,blockChannel,blockInputStream);
    }
  }
  return sizes;
}
