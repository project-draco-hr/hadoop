{
  long[] sizes=new long[locs.length];
  for (int i=0; i < locs.length; i++) {
    HdfsBlockLocation loc=locs[i];
    String bpid=loc.getLocatedBlock().getBlock().getBlockPoolId();
    Block block=loc.getLocatedBlock().getBlock().getLocalBlock();
    ExtendedBlock extBlock=new ExtendedBlock(bpid,block);
    FileChannel blockChannel=((FileInputStream)fsd.getBlockInputStream(extBlock,0)).getChannel();
    sizes[i]=blockChannel.size();
  }
  return sizes;
}
