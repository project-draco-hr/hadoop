{
  if (!UserGroupInformation.isSecurityEnabled()) {
    return;
  }
  boolean unauthorized=false;
  StringBuilder messageBuilder=new StringBuilder("Unauthorized request to start container. ");
  if (!remoteUgi.getUserName().equals(containerIDStr)) {
    unauthorized=true;
    messageBuilder.append("\nExpected containerId: " + remoteUgi.getUserName() + " Found: "+ containerIDStr);
  }
 else   if (launchContext != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Number of TokenIdentifiers in the UGI from RPC: " + remoteUgi.getTokenIdentifiers().size());
    }
    ContainerTokenIdentifier tokenId=selectContainerTokenIdentifier(remoteUgi);
    if (tokenId == null) {
      unauthorized=true;
      messageBuilder.append("\nContainerTokenIdentifier cannot be null! Null found for " + containerIDStr);
    }
 else {
      if (!tokenId.getApplicationSubmitter().equals(launchContext.getUser())) {
        unauthorized=true;
        messageBuilder.append("\n Expected user-name " + tokenId.getApplicationSubmitter() + " but found "+ launchContext.getUser());
      }
      if (!this.context.getContainerTokenSecretManager().isValidStartContainerRequest(tokenId)) {
        unauthorized=true;
        messageBuilder.append("\n Attempt to relaunch the same " + "container with id " + containerIDStr + ".");
      }
      if (tokenId.getExpiryTimeStamp() < System.currentTimeMillis()) {
        unauthorized=true;
        messageBuilder.append("\nThis token is expired. current time is " + System.currentTimeMillis() + " found "+ tokenId.getExpiryTimeStamp());
      }
      Resource resource=tokenId.getResource();
      if (!resource.equals(container.getResource())) {
        unauthorized=true;
        messageBuilder.append("\nExpected resource " + resource + " but found "+ container.getResource());
      }
    }
  }
  if (unauthorized) {
    String msg=messageBuilder.toString();
    LOG.error(msg);
    throw RPCUtil.getRemoteException(msg);
  }
}
