{
  UserGroupInformation remoteUgi=getRemoteUgi();
  NMTokenIdentifier nmTokenIdentifier=selectNMTokenIdentifier(remoteUgi);
  authorizeUser(remoteUgi,nmTokenIdentifier);
  if (!nmTokenIdentifier.getApplicationAttemptId().getApplicationId().equals(containerId.getApplicationAttemptId().getApplicationId())) {
    throw new YarnException("ApplicationMaster not autorized to perform " + "[" + op + "] on Container ["+ containerId+ "]!!");
  }
  Container container=context.getContainers().get(containerId);
  if (container == null) {
    throw new YarnException("Specified " + containerId + " does not exist!");
  }
  if (!container.isRunning() || container.isReInitializing()) {
    throw new YarnException("Cannot perform " + op + " on ["+ containerId+ "]. Current state is ["+ container.getContainerState()+ ", "+ "isReInitializing="+ container.isReInitializing()+ "].");
  }
  return container;
}
