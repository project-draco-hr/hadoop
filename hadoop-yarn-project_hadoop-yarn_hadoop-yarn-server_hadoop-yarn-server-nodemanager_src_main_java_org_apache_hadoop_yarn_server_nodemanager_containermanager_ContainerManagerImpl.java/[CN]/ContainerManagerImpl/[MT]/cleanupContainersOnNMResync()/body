{
  Map<ContainerId,Container> containers=context.getContainers();
  if (containers.isEmpty()) {
    return;
  }
  LOG.info("Containers still running on " + CMgrCompletedContainersEvent.Reason.ON_NODEMANAGER_RESYNC + " : "+ containers.keySet());
  List<ContainerId> containerIds=new ArrayList<ContainerId>(containers.keySet());
  LOG.info("Waiting for containers to be killed");
  this.handle(new CMgrCompletedContainersEvent(containerIds,CMgrCompletedContainersEvent.Reason.ON_NODEMANAGER_RESYNC));
  while (!containers.isEmpty()) {
    try {
      Thread.sleep(1000);
      nodeStatusUpdater.getNodeStatusAndUpdateContainersInContext();
    }
 catch (    InterruptedException ex) {
      LOG.warn("Interrupted while sleeping on container kill on resync",ex);
    }
  }
  if (containers.isEmpty()) {
    LOG.info("All containers in DONE state");
  }
 else {
    LOG.info("Done waiting for containers to be killed. Still alive: " + containers.keySet());
  }
}
