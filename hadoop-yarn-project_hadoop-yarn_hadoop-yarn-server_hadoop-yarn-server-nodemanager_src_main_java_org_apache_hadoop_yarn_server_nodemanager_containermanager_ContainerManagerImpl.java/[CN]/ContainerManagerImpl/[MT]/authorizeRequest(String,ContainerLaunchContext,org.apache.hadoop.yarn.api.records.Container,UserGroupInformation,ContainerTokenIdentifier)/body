{
  boolean unauthorized=false;
  StringBuilder messageBuilder=new StringBuilder("Unauthorized request to start container. ");
  if (!remoteUgi.getUserName().equals(containerIDStr)) {
    unauthorized=true;
    messageBuilder.append("\nExpected containerId: " + remoteUgi.getUserName() + " Found: "+ containerIDStr);
  }
 else   if (launchContext != null) {
    if (tokenId == null) {
      unauthorized=true;
      messageBuilder.append("\nNo ContainerToken found for " + containerIDStr);
    }
 else {
      if (!this.context.getContainerTokenSecretManager().isValidStartContainerRequest(tokenId.getContainerID())) {
        unauthorized=true;
        messageBuilder.append("\n Attempt to relaunch the same " + "container with id " + containerIDStr + ".");
      }
      if (tokenId.getExpiryTimeStamp() < System.currentTimeMillis()) {
        unauthorized=true;
        messageBuilder.append("\nThis token is expired. current time is " + System.currentTimeMillis() + " found "+ tokenId.getExpiryTimeStamp());
      }
      Resource resource=tokenId.getResource();
      if (resource == null || !resource.equals(container.getResource())) {
        unauthorized=true;
        messageBuilder.append("\nExpected resource " + resource + " but found "+ container.getResource());
      }
    }
  }
  if (unauthorized) {
    String msg=messageBuilder.toString();
    LOG.error(msg);
    throw RPCUtil.getRemoteException(msg);
  }
}
