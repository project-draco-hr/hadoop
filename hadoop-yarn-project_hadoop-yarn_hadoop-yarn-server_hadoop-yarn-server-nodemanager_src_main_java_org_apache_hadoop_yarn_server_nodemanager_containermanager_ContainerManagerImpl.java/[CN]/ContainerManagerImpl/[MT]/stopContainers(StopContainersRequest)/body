{
  List<ContainerId> succeededRequests=new ArrayList<ContainerId>();
  Map<ContainerId,SerializedException> failedRequests=new HashMap<ContainerId,SerializedException>();
  UserGroupInformation remoteUgi=getRemoteUgi();
  NMTokenIdentifier identifier=selectNMTokenIdentifier(remoteUgi);
  if (identifier == null) {
    throw RPCUtil.getRemoteException(INVALID_NMTOKEN_MSG);
  }
  for (  ContainerId id : requests.getContainerIds()) {
    try {
      stopContainerInternal(identifier,id);
      succeededRequests.add(id);
    }
 catch (    YarnException e) {
      failedRequests.put(id,SerializedException.newInstance(e));
    }
  }
  return StopContainersResponse.newInstance(succeededRequests,failedRequests);
}
