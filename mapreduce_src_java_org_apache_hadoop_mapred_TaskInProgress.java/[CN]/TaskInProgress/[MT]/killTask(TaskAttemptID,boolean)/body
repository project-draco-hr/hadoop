{
  TaskStatus st=taskStatuses.get(taskId);
  if (st != null && (st.getRunState() == TaskStatus.State.RUNNING || st.getRunState() == TaskStatus.State.COMMIT_PENDING || st.inTaskCleanupPhase() || st.getRunState() == TaskStatus.State.UNASSIGNED) && tasksToKill.put(taskId,shouldFail) == null) {
    String logStr="Request received to " + (shouldFail ? "fail" : "kill") + " task '"+ taskId+ "' by user";
    addDiagnosticInfo(taskId,logStr);
    LOG.info(logStr);
    return true;
  }
  return false;
}
