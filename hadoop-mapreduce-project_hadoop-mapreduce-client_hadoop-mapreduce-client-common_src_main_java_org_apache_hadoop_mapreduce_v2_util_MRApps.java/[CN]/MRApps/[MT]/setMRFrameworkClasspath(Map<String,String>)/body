{
  InputStream classpathFileStream=null;
  BufferedReader reader=null;
  try {
    ClassLoader thisClassLoader=Thread.currentThread().getContextClassLoader();
    String mrAppGeneratedClasspathFile="mrapp-generated-classpath";
    classpathFileStream=thisClassLoader.getResourceAsStream(mrAppGeneratedClasspathFile);
    String classpathElement=thisClassLoader.getResource(mrAppGeneratedClasspathFile).getFile();
    if (classpathElement.contains("!")) {
      classpathElement=classpathElement.substring(0,classpathElement.indexOf("!"));
    }
 else {
      classpathElement=new File(classpathElement).getParent();
    }
    Apps.addToEnvironment(environment,Environment.CLASSPATH.name(),classpathElement);
    reader=new BufferedReader(new InputStreamReader(classpathFileStream));
    String cp=reader.readLine();
    if (cp != null) {
      Apps.addToEnvironment(environment,Environment.CLASSPATH.name(),cp.trim());
    }
    for (    String c : ApplicationConstants.APPLICATION_CLASSPATH) {
      Apps.addToEnvironment(environment,Environment.CLASSPATH.name(),c);
    }
  }
  finally {
    if (classpathFileStream != null) {
      classpathFileStream.close();
    }
    if (reader != null) {
      reader.close();
    }
  }
}
