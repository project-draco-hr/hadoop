{
  if (conf.getBoolean(YarnConfiguration.IS_MINI_YARN_CLUSTER,false)) {
    MRApps.addToEnvironment(environment,Environment.CLASSPATH.name(),System.getProperty("java.class.path"),conf);
  }
  boolean crossPlatform=conf.getBoolean(MRConfig.MAPREDUCE_APP_SUBMISSION_CROSS_PLATFORM,MRConfig.DEFAULT_MAPREDUCE_APP_SUBMISSION_CROSS_PLATFORM);
  String frameworkName=getMRFrameworkName(conf);
  if (frameworkName == null) {
    for (    String c : conf.getStrings(YarnConfiguration.YARN_APPLICATION_CLASSPATH,crossPlatform ? YarnConfiguration.DEFAULT_YARN_CROSS_PLATFORM_APPLICATION_CLASSPATH : YarnConfiguration.DEFAULT_YARN_APPLICATION_CLASSPATH)) {
      MRApps.addToEnvironment(environment,Environment.CLASSPATH.name(),c.trim(),conf);
    }
  }
  boolean foundFrameworkInClasspath=(frameworkName == null);
  for (  String c : conf.getStrings(MRJobConfig.MAPREDUCE_APPLICATION_CLASSPATH,crossPlatform ? StringUtils.getStrings(MRJobConfig.DEFAULT_MAPREDUCE_CROSS_PLATFORM_APPLICATION_CLASSPATH) : StringUtils.getStrings(MRJobConfig.DEFAULT_MAPREDUCE_APPLICATION_CLASSPATH))) {
    MRApps.addToEnvironment(environment,Environment.CLASSPATH.name(),c.trim(),conf);
    if (!foundFrameworkInClasspath) {
      foundFrameworkInClasspath=c.contains(frameworkName);
    }
  }
  if (!foundFrameworkInClasspath) {
    throw new IllegalArgumentException("Could not locate MapReduce framework name '" + frameworkName + "' in "+ MRJobConfig.MAPREDUCE_APPLICATION_CLASSPATH);
  }
}
