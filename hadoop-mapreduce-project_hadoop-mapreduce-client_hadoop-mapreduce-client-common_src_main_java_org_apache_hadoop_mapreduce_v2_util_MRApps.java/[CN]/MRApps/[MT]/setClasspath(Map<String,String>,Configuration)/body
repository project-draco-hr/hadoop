{
  boolean userClassesTakesPrecedence=conf.getBoolean(MRJobConfig.MAPREDUCE_JOB_USER_CLASSPATH_FIRST,false);
  String classpathEnvVar=conf.getBoolean(MRJobConfig.MAPREDUCE_JOB_CLASSLOADER,false) ? Environment.APP_CLASSPATH.name() : Environment.CLASSPATH.name();
  Apps.addToEnvironment(environment,classpathEnvVar,Environment.PWD.$());
  if (!userClassesTakesPrecedence) {
    MRApps.setMRFrameworkClasspath(environment,conf);
  }
  Apps.addToEnvironment(environment,classpathEnvVar,MRJobConfig.JOB_JAR + Path.SEPARATOR + MRJobConfig.JOB_JAR);
  Apps.addToEnvironment(environment,classpathEnvVar,MRJobConfig.JOB_JAR + Path.SEPARATOR + "classes"+ Path.SEPARATOR);
  Apps.addToEnvironment(environment,classpathEnvVar,MRJobConfig.JOB_JAR + Path.SEPARATOR + "lib"+ Path.SEPARATOR+ "*");
  Apps.addToEnvironment(environment,classpathEnvVar,Environment.PWD.$() + Path.SEPARATOR + "*");
  addToClasspathIfNotJar(DistributedCache.getFileClassPaths(conf),DistributedCache.getCacheFiles(conf),conf,environment,classpathEnvVar);
  addToClasspathIfNotJar(DistributedCache.getArchiveClassPaths(conf),DistributedCache.getCacheArchives(conf),conf,environment,classpathEnvVar);
  if (userClassesTakesPrecedence) {
    MRApps.setMRFrameworkClasspath(environment,conf);
  }
}
