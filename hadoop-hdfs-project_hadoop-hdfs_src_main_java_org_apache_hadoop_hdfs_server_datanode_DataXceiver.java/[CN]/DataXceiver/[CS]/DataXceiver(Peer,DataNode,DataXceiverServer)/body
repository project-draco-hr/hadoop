{
  super(datanode.getTracer());
  this.peer=peer;
  this.dnConf=datanode.getDnConf();
  this.socketIn=peer.getInputStream();
  this.socketOut=peer.getOutputStream();
  this.datanode=datanode;
  this.dataXceiverServer=dataXceiverServer;
  this.connectToDnViaHostname=datanode.getDnConf().connectToDnViaHostname;
  this.ioFileBufferSize=DFSUtilClient.getIoFileBufferSize(datanode.getConf());
  this.smallBufferSize=DFSUtilClient.getSmallBufferSize(datanode.getConf());
  remoteAddress=peer.getRemoteAddressString();
  final int colonIdx=remoteAddress.indexOf(':');
  remoteAddressWithoutPort=(colonIdx < 0) ? remoteAddress : remoteAddress.substring(0,colonIdx);
  localAddress=peer.getLocalAddressString();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Number of active connections is: " + datanode.getXceiverCount());
  }
}
