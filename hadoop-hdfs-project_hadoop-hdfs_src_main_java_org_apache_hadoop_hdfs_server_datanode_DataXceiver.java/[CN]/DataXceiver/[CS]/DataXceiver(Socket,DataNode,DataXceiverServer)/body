{
  super(new DataInputStream(new BufferedInputStream(NetUtils.getInputStream(s),HdfsConstants.SMALL_BUFFER_SIZE)));
  this.s=s;
  this.isLocal=s.getInetAddress().equals(s.getLocalAddress());
  this.datanode=datanode;
  this.dataXceiverServer=dataXceiverServer;
  remoteAddress=s.getRemoteSocketAddress().toString();
  localAddress=s.getLocalSocketAddress().toString();
  socketKeepaliveTimeout=datanode.getConf().getInt(DFSConfigKeys.DFS_DATANODE_SOCKET_REUSE_KEEPALIVE_KEY,DFSConfigKeys.DFS_DATANODE_SOCKET_REUSE_KEEPALIVE_DEFAULT);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Number of active connections is: " + datanode.getXceiverCount());
  }
}
