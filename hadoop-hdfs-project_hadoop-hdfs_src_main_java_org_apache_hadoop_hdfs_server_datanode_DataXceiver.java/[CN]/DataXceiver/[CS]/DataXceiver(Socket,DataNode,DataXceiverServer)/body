{
  this.s=s;
  this.dnConf=datanode.getDnConf();
  this.socketIn=NetUtils.getInputStream(s);
  this.socketOut=NetUtils.getOutputStream(s,dnConf.socketWriteTimeout);
  this.isLocal=s.getInetAddress().equals(s.getLocalAddress());
  this.datanode=datanode;
  this.dataXceiverServer=dataXceiverServer;
  this.connectToDnViaHostname=datanode.getDnConf().connectToDnViaHostname;
  remoteAddress=s.getRemoteSocketAddress().toString();
  localAddress=s.getLocalSocketAddress().toString();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Number of active connections is: " + datanode.getXceiverCount());
  }
}
