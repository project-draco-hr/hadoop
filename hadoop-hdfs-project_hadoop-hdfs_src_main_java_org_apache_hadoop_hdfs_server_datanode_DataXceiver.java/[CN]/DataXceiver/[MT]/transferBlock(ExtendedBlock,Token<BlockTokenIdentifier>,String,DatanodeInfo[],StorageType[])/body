{
  checkAccess(socketOut,true,blk,blockToken,Op.TRANSFER_BLOCK,BlockTokenSecretManager.AccessMode.COPY);
  previousOpClientName=clientName;
  updateCurrentThreadName(Op.TRANSFER_BLOCK + " " + blk);
  final DataOutputStream out=new DataOutputStream(getOutputStream());
  try {
    datanode.transferReplicaForPipelineRecovery(blk,targets,targetStorageTypes,clientName);
    writeResponse(Status.SUCCESS,null,out);
  }
  finally {
    IOUtils.closeStream(out);
  }
}
