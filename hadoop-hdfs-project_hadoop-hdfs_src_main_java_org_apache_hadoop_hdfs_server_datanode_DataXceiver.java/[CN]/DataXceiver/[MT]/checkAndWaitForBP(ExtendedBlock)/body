{
  String bpId=block.getBlockPoolId();
  try {
    datanode.getDNRegistrationForBP(bpId);
    return;
  }
 catch (  IOException ioe) {
  }
  long bpReadyTimeout=dnConf.getBpReadyTimeout();
  StopWatch sw=new StopWatch();
  sw.start();
  while (sw.now(TimeUnit.SECONDS) <= bpReadyTimeout) {
    try {
      datanode.getDNRegistrationForBP(bpId);
      return;
    }
 catch (    IOException ioe) {
    }
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException ie) {
      throw new IOException("Interrupted while serving request. Aborting.");
    }
  }
  throw new IOException("Not ready to serve the block pool, " + bpId + ".");
}
