{
  configure(conf,inDir,outDir,input,MapClass.class,IdentityReducer.class);
  FileSystem outFs=outDir.getFileSystem(conf);
  JobClient.runJob(conf);
  outFs.delete(outDir,true);
  final String DEFAULT_ABS_TMP_PATH="/tmp";
  final String DEFAULT_REL_TMP_PATH="../temp";
  String absoluteTempPath=null;
  String relativeTempPath=null;
  for (  String key : new String[]{"test.temp.dir","test.tmp.dir"}) {
    String p=conf.get(key);
    if (p == null || p.isEmpty()) {
      continue;
    }
    if (new Path(p).isAbsolute()) {
      if (absoluteTempPath == null) {
        absoluteTempPath=p;
      }
    }
 else {
      if (relativeTempPath == null) {
        relativeTempPath=p;
      }
    }
  }
  if (absoluteTempPath == null) {
    absoluteTempPath=DEFAULT_ABS_TMP_PATH;
  }
  if (relativeTempPath == null) {
    relativeTempPath=DEFAULT_REL_TMP_PATH;
  }
  LOG.info("Testing with relative temp dir = " + relativeTempPath);
  conf.set("mapred.child.tmp",relativeTempPath);
  JobClient.runJob(conf);
  outFs.delete(outDir,true);
  LOG.info("Testing with absolute temp dir = " + absoluteTempPath);
  conf.set("mapred.child.tmp",absoluteTempPath);
  JobClient.runJob(conf);
  outFs.delete(outDir,true);
}
