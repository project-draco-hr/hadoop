{
  String dir="/testNamenodeRetryCache/testCreateSnapshot/src";
  resetCall();
  nnRpc.mkdirs(dir,perm,true);
  nnRpc.allowSnapshot(dir);
  newCall();
  String name=nnRpc.createSnapshot(dir,"snap1");
  Assert.assertEquals(name,nnRpc.createSnapshot(dir,"snap1"));
  Assert.assertEquals(name,nnRpc.createSnapshot(dir,"snap1"));
  Assert.assertEquals(name,nnRpc.createSnapshot(dir,"snap1"));
  newCall();
  try {
    nnRpc.createSnapshot(dir,"snap1");
    Assert.fail("testSnapshotMethods expected exception is not thrown");
  }
 catch (  IOException e) {
  }
  newCall();
  nnRpc.renameSnapshot(dir,"snap1","snap2");
  nnRpc.renameSnapshot(dir,"snap1","snap2");
  nnRpc.renameSnapshot(dir,"snap1","snap2");
  newCall();
  try {
    nnRpc.renameSnapshot(dir,"snap1","snap2");
    Assert.fail("testSnapshotMethods expected exception is not thrown");
  }
 catch (  IOException e) {
  }
  newCall();
  nnRpc.deleteSnapshot(dir,"snap2");
  nnRpc.deleteSnapshot(dir,"snap2");
  nnRpc.deleteSnapshot(dir,"snap2");
  newCall();
  try {
    nnRpc.deleteSnapshot(dir,"snap2");
    Assert.fail("testSnapshotMethods expected exception is not thrown");
  }
 catch (  IOException e) {
  }
}
