{
  boolean mayExit=false;
  StreamJob job=new StreamJob(genArgs(mr.getJobTrackerPort(),map,reduce),mayExit);
  int returnValue=job.go();
  assertEquals(0,returnValue);
  int expectedCounterValue=0;
  if (type == TaskType.MAP || !isEmptyInput) {
    validateTaskStatus(job,type);
    validateJobOutput(job.getConf());
    expectedCounterValue=2;
  }
  validateUserCounter(job,expectedCounterValue);
  validateTaskStderr(job,type);
  deleteOutDir(fs);
}
