{
  String masterAddress;
  String framework=conf.get(MRConfig.FRAMEWORK_NAME,MRConfig.YARN_FRAMEWORK_NAME);
  if (framework.equals(MRConfig.CLASSIC_FRAMEWORK_NAME)) {
    masterAddress=conf.get(MRConfig.MASTER_ADDRESS,"localhost:8012");
    return NetUtils.createSocketAddr(masterAddress,8012,MRConfig.MASTER_ADDRESS);
  }
 else   if (framework.equals(MRConfig.YARN_FRAMEWORK_NAME) && HAUtil.isHAEnabled(conf)) {
    YarnConfiguration yarnConf=new YarnConfiguration(conf);
    if (yarnConf.get(YarnConfiguration.RM_HA_ID) == null) {
      String[] rmIds=yarnConf.getStrings(YarnConfiguration.RM_HA_IDS);
      if (rmIds != null && rmIds.length > 0) {
        yarnConf.set(YarnConfiguration.RM_HA_ID,rmIds[0]);
      }
 else {
        LOG.warn("RM_HA_IDS is not configured when RM HA is enabled");
      }
    }
    return yarnConf.getSocketAddr(YarnConfiguration.RM_ADDRESS,YarnConfiguration.DEFAULT_RM_ADDRESS,YarnConfiguration.DEFAULT_RM_PORT);
  }
 else {
    return conf.getSocketAddr(YarnConfiguration.RM_ADDRESS,YarnConfiguration.DEFAULT_RM_ADDRESS,YarnConfiguration.DEFAULT_RM_PORT);
  }
}
