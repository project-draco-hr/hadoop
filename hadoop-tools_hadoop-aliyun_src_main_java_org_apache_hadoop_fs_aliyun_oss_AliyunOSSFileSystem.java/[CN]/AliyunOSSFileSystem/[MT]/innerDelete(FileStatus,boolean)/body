{
  Path f=status.getPath();
  String key=pathToKey(f);
  if (status.isDirectory()) {
    if (!recursive) {
      FileStatus[] statuses=listStatus(status.getPath());
      if (statuses.length > 0) {
        throw new IOException("Cannot remove directory " + f + ": It is not empty!");
      }
 else {
        key=AliyunOSSUtils.maybeAddTrailingSlash(key);
        store.deleteObject(key);
      }
    }
 else {
      store.deleteDirs(key);
    }
  }
 else {
    store.deleteObject(key);
  }
  createFakeDirectoryIfNecessary(f);
  return true;
}
