{
  if (loggedTaskMap == null) {
    loggedTaskMap=new HashMap<TaskID,LoggedTask>();
    loggedTaskAttemptMap=new HashMap<TaskAttemptID,LoggedTaskAttempt>();
    for (    LoggedTask map : job.getMapTasks()) {
      map=sanitizeLoggedTask(map);
      if (map != null) {
        loggedTaskMap.put(maskTaskID(map.taskID),map);
        for (        LoggedTaskAttempt mapAttempt : map.getAttempts()) {
          mapAttempt=sanitizeLoggedTaskAttempt(mapAttempt);
          if (mapAttempt != null) {
            TaskAttemptID id=mapAttempt.getAttemptID();
            loggedTaskAttemptMap.put(maskAttemptID(id),mapAttempt);
          }
        }
      }
    }
    for (    LoggedTask reduce : job.getReduceTasks()) {
      reduce=sanitizeLoggedTask(reduce);
      if (reduce != null) {
        loggedTaskMap.put(maskTaskID(reduce.taskID),reduce);
        for (        LoggedTaskAttempt reduceAttempt : reduce.getAttempts()) {
          reduceAttempt=sanitizeLoggedTaskAttempt(reduceAttempt);
          if (reduceAttempt != null) {
            TaskAttemptID id=reduceAttempt.getAttemptID();
            loggedTaskAttemptMap.put(maskAttemptID(id),reduceAttempt);
          }
        }
      }
    }
  }
}
