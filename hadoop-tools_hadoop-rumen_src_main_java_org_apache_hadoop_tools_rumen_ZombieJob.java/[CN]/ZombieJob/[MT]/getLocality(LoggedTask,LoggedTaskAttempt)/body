{
  int distance=cluster.getMaximumDistance();
  String rackHostName=loggedAttempt.getHostName().getValue();
  if (rackHostName == null) {
    return distance;
  }
  MachineNode mn=getMachineNode(rackHostName);
  if (mn == null) {
    return distance;
  }
  List<LoggedLocation> locations=loggedTask.getPreferredLocations();
  if (locations != null) {
    for (    LoggedLocation location : locations) {
      List<NodeName> layers=location.getLayers();
      if ((layers == null) || (layers.isEmpty())) {
        continue;
      }
      String dataNodeName=layers.get(layers.size() - 1).getValue();
      MachineNode dataNode=cluster.getMachineByName(dataNodeName);
      if (dataNode != null) {
        distance=Math.min(distance,cluster.distance(mn,dataNode));
      }
    }
  }
  return distance;
}
