{
  this.datanode=dn;
  this.dataset=dataset;
  int interval=conf.getInt(DFSConfigKeys.DFS_DATANODE_DIRECTORYSCAN_INTERVAL_KEY,DEFAULT_SCAN_INTERVAL);
  scanPeriodMsecs=interval * 1000L;
  int threads=conf.getInt(DFSConfigKeys.DFS_DATANODE_DIRECTORYSCAN_THREADS_KEY,DFSConfigKeys.DFS_DATANODE_DIRECTORYSCAN_THREADS_DEFAULT);
  reportCompileThreadPool=Executors.newFixedThreadPool(threads,new Daemon.DaemonFactory());
  masterThread=new ScheduledThreadPoolExecutor(1,new Daemon.DaemonFactory());
}
