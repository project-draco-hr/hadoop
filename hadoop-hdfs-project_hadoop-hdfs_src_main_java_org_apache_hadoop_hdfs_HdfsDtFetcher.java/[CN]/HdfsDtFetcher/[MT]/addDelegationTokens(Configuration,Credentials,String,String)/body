{
  if (!url.startsWith(getServiceName().toString())) {
    url=getServiceName().toString() + "://" + url;
  }
  FileSystem fs=FileSystem.get(URI.create(url),conf);
  Token<?> token=fs.getDelegationToken(renewer);
  if (token == null) {
    LOG.error(FETCH_FAILED);
    throw new IOException(FETCH_FAILED);
  }
  creds.addToken(token.getService(),token);
  return token;
}
