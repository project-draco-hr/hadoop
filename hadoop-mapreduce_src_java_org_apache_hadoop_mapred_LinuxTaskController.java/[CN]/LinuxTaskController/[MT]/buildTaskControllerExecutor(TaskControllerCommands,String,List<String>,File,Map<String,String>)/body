{
  String[] taskControllerCmd=new String[3 + cmdArgs.size()];
  taskControllerCmd[0]=getTaskControllerExecutablePath();
  taskControllerCmd[1]=userName;
  taskControllerCmd[2]=String.valueOf(command.ordinal());
  int i=3;
  for (  String cmdArg : cmdArgs) {
    taskControllerCmd[i++]=cmdArg;
  }
  if (LOG.isDebugEnabled()) {
    for (    String cmd : taskControllerCmd) {
      LOG.debug("taskctrl command = " + cmd);
    }
  }
  ShellCommandExecutor shExec=null;
  if (workDir != null && workDir.exists()) {
    shExec=new ShellCommandExecutor(taskControllerCmd,workDir,env);
  }
 else {
    shExec=new ShellCommandExecutor(taskControllerCmd);
  }
  return shExec;
}
