{
  TestTimelineClient client=new TestTimelineClient();
  try {
    client.init(conf);
    client.start();
    TimelineEntity expectedEntity=new TimelineEntity();
    expectedEntity.setEntityType("test entity type");
    expectedEntity.setEntityId("test entity id");
    TimelineEvent event=new TimelineEvent();
    event.setEventType("test event type");
    event.setTimestamp(0L);
    expectedEntity.addEvent(event);
    TimelinePutResponse response=client.putEntities(expectedEntity);
    Assert.assertEquals(0,response.getErrors().size());
    Assert.assertTrue(client.resp.toString().contains("https"));
    TimelineEntity actualEntity=store.getEntity(expectedEntity.getEntityId(),expectedEntity.getEntityType(),EnumSet.allOf(Field.class));
    Assert.assertNotNull(actualEntity);
    Assert.assertEquals(expectedEntity.getEntityId(),actualEntity.getEntityId());
    Assert.assertEquals(expectedEntity.getEntityType(),actualEntity.getEntityType());
  }
  finally {
    client.stop();
    client.close();
  }
}
