{
  if (state == JobState.DEFINE) {
    conf.setJobPriority(org.apache.hadoop.mapred.JobPriority.valueOf(priority.name()));
  }
 else {
    ensureState(JobState.RUNNING);
    final JobPriority tmpPriority=priority;
    ugi.doAs(new PrivilegedExceptionAction<Object>(){
      @Override public Object run() throws IOException, InterruptedException {
        cluster.getClient().setJobPriority(getJobID(),tmpPriority.toString());
        return null;
      }
    }
);
  }
}
