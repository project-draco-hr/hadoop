{
  int failCount=1;
  TaskCompletionEvent lastEvent=null;
  TaskCompletionEvent[] events=ugi.doAs(new PrivilegedExceptionAction<TaskCompletionEvent[]>(){
    @Override public TaskCompletionEvent[] run() throws IOException, InterruptedException {
      return cluster.getClient().getTaskCompletionEvents(status.getJobID(),0,10);
    }
  }
);
  for (  TaskCompletionEvent event : events) {
    if (event.getStatus().equals(TaskCompletionEvent.Status.FAILED)) {
      failCount++;
      lastEvent=event;
    }
  }
  if (lastEvent == null) {
    return "There are no failed tasks for the job. " + "Job is failed due to some other reason and reason " + "can be found in the logs.";
  }
  String[] taskAttemptID=lastEvent.getTaskAttemptId().toString().split("_",2);
  String taskID=taskAttemptID[1].substring(0,taskAttemptID[1].length() - 2);
  return (" task " + taskID + " failed "+ failCount+ " times "+ "For details check tasktracker at: "+ lastEvent.getTaskTrackerHttp());
}
