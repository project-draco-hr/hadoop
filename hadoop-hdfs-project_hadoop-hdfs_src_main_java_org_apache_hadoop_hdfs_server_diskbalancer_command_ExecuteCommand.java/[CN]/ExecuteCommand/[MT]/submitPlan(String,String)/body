{
  Preconditions.checkNotNull(planData);
  NodePlan plan=NodePlan.parseJson(planData);
  String dataNodeAddress=plan.getNodeName() + ":" + plan.getPort();
  Preconditions.checkNotNull(dataNodeAddress);
  ClientDatanodeProtocol dataNode=getDataNodeProxy(dataNodeAddress);
  String planHash=DigestUtils.shaHex(planData);
  try {
    dataNode.submitDiskBalancerPlan(planHash,DiskBalancerCLI.PLAN_VERSION,planFile,planData,false);
  }
 catch (  DiskBalancerException ex) {
    LOG.error("Submitting plan on  {} failed. Result: {}, Message: {}",plan.getNodeName(),ex.getResult().toString(),ex.getMessage());
    throw ex;
  }
}
