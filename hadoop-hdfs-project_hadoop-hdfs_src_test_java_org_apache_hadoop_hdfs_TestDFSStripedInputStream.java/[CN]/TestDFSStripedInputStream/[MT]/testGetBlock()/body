{
  final int numBlocks=4;
  DFSTestUtil.createStripedFile(cluster,filePath,null,numBlocks,NUM_STRIPE_PER_BLOCK,false);
  LocatedBlocks lbs=fs.getClient().namenode.getBlockLocations(filePath.toString(),0,BLOCK_GROUP_SIZE * numBlocks);
  final DFSStripedInputStream in=new DFSStripedInputStream(fs.getClient(),filePath.toString(),false,schema,CELLSIZE);
  List<LocatedBlock> lbList=lbs.getLocatedBlocks();
  for (  LocatedBlock aLbList : lbList) {
    LocatedStripedBlock lsb=(LocatedStripedBlock)aLbList;
    LocatedBlock[] blks=StripedBlockUtil.parseStripedBlockGroup(lsb,CELLSIZE,DATA_BLK_NUM,PARITY_BLK_NUM);
    for (int j=0; j < DATA_BLK_NUM; j++) {
      LocatedBlock refreshed=in.getBlockAt(blks[j].getStartOffset());
      assertEquals(blks[j].getBlock(),refreshed.getBlock());
      assertEquals(blks[j].getStartOffset(),refreshed.getStartOffset());
      assertArrayEquals(blks[j].getLocations(),refreshed.getLocations());
    }
  }
}
