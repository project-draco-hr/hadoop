{
  RMContext rmContext=distShellTest.yarnCluster.getResourceManager(0).getRMContext();
  RMNodeLabelsManager labelsMgr=rmContext.getNodeLabelManager();
  Set<String> labels=new HashSet<String>();
  labels.add("x");
  labelsMgr.addToCluserNodeLabels(labels);
  distShellTest.conf.set("yarn.scheduler.capacity.root.accessible-node-labels","x");
  distShellTest.conf.set("yarn.scheduler.capacity.root.accessible-node-labels.x.capacity","100");
  distShellTest.conf.set("yarn.scheduler.capacity.root.default.accessible-node-labels","x");
  distShellTest.conf.set("yarn.scheduler.capacity.root.default.accessible-node-labels.x.capacity","100");
  rmContext.getScheduler().reinitialize(distShellTest.conf,rmContext);
  NodeId[] nodeIds=new NodeId[NUM_NMS];
  for (int i=0; i < NUM_NMS; i++) {
    NodeManager mgr=distShellTest.yarnCluster.getNodeManager(i);
    nodeIds[i]=mgr.getNMContext().getNodeId();
  }
  labelsMgr.addLabelsToNode(ImmutableMap.of(nodeIds[1],labels));
}
