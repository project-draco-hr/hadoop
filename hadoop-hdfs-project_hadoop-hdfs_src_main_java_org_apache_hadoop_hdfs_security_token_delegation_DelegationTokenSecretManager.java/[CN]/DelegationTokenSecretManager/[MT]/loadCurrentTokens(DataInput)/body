{
  StartupProgress prog=NameNode.getStartupProgress();
  Step step=new Step(StepType.DELEGATION_TOKENS);
  prog.beginStep(Phase.LOADING_FSIMAGE,step);
  int numberOfTokens=in.readInt();
  prog.setTotal(Phase.LOADING_FSIMAGE,step,numberOfTokens);
  Counter counter=prog.getCounter(Phase.LOADING_FSIMAGE,step);
  for (int i=0; i < numberOfTokens; i++) {
    DelegationTokenIdentifier id=new DelegationTokenIdentifier();
    id.readFields(in);
    long expiryTime=in.readLong();
    addPersistedDelegationToken(id,expiryTime);
    counter.increment();
  }
  prog.endStep(Phase.LOADING_FSIMAGE,step);
}
