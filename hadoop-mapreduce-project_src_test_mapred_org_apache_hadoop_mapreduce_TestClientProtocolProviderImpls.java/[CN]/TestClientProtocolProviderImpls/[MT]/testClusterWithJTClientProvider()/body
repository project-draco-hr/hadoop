{
  Configuration conf=new Configuration();
  try {
    conf.set(MRConfig.FRAMEWORK_NAME,"incorrect");
    new Cluster(conf);
    fail("Cluster should not be initialized with incorrect framework name");
  }
 catch (  IOException e) {
  }
  try {
    conf.set(MRConfig.FRAMEWORK_NAME,"classic");
    conf.set(JTConfig.JT_IPC_ADDRESS,"local");
    new Cluster(conf);
    fail("Cluster with classic Framework name shouldnot use local JT address");
  }
 catch (  IOException e) {
  }
  try {
    conf=new Configuration();
    conf.set(MRConfig.FRAMEWORK_NAME,"classic");
    conf.set(JTConfig.JT_IPC_ADDRESS,"127.0.0.1:0");
    Cluster cluster=new Cluster(conf);
    cluster.close();
  }
 catch (  IOException e) {
  }
}
