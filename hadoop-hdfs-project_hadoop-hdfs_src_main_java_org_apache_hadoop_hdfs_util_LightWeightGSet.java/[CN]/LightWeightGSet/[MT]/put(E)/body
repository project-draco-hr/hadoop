{
  if (element == null) {
    throw new NullPointerException("Null element is not supported.");
  }
  if (!(element instanceof LinkedElement)) {
    throw new HadoopIllegalArgumentException("!(element instanceof LinkedElement), element.getClass()=" + element.getClass());
  }
  final LinkedElement e=(LinkedElement)element;
  final int index=getIndex(element);
  final E existing=remove(index,element);
  modification++;
  size++;
  e.setNext(entries[index]);
  entries[index]=e;
  return existing;
}
