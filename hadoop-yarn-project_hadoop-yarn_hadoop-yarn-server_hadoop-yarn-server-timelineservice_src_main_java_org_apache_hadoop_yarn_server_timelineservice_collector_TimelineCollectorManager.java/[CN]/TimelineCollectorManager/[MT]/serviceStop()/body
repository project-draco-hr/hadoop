{
  if (collectors != null && collectors.size() > 1) {
    for (    TimelineCollector c : collectors.values()) {
      c.serviceStop();
    }
  }
  if (writerFlusher != null) {
    writerFlusher.shutdown();
    writerFlusherRunning=false;
    if (!writerFlusher.awaitTermination(30,TimeUnit.SECONDS)) {
      LOG.warn("failed to stop the flusher task in time. " + "will still proceed to close the writer.");
    }
  }
  if (writer != null) {
    writer.close();
  }
  super.serviceStop();
}
