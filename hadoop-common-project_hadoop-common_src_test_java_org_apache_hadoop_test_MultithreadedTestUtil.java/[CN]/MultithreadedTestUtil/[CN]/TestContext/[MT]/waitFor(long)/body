{
  long endTime=Time.now() + millis;
  while (shouldRun() && finishedThreads.size() < testThreads.size()) {
    long left=endTime - Time.now();
    if (left <= 0)     break;
    checkException();
    wait(left);
  }
  checkException();
}
