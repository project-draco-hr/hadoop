{
  conf.set(FsPermission.UMASK_LABEL,String.format("%1$03o",umask));
switch (op) {
case CREATE:
    FSDataOutputStream out=fs.create(name,permission,true,conf.getInt(CommonConfigurationKeys.IO_FILE_BUFFER_SIZE_KEY,4096),fs.getDefaultReplication(),fs.getDefaultBlockSize(),null);
  out.close();
break;
case MKDIRS:
fs.mkdirs(name,permission);
break;
default :
throw new IOException("Unsupported operation: " + op);
}
}
