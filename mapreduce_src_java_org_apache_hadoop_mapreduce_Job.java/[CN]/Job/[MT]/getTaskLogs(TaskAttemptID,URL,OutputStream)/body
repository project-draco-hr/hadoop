{
  try {
    int tasklogtimeout=cluster.getConf().getInt(TASKLOG_PULL_TIMEOUT_KEY,DEFAULT_TASKLOG_TIMEOUT);
    URLConnection connection=taskLogUrl.openConnection();
    connection.setReadTimeout(tasklogtimeout);
    connection.setConnectTimeout(tasklogtimeout);
    BufferedReader input=new BufferedReader(new InputStreamReader(connection.getInputStream()));
    BufferedWriter output=new BufferedWriter(new OutputStreamWriter(out));
    try {
      String logData=null;
      while ((logData=input.readLine()) != null) {
        if (logData.length() > 0) {
          output.write(taskId + ": " + logData+ "\n");
          output.flush();
        }
      }
    }
  finally {
      input.close();
    }
  }
 catch (  IOException ioe) {
    LOG.warn("Error reading task output " + ioe.getMessage());
  }
}
