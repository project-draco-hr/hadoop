{
  localFS.delete(new Path(localDir.getAbsolutePath()),true);
  localFS.delete(new Path(tmpDir.getAbsolutePath()),true);
  localFS.delete(new Path(localLogDir.getAbsolutePath()),true);
  localFS.delete(new Path(remoteLogDir.getAbsolutePath()),true);
  localDir.mkdir();
  tmpDir.mkdir();
  localLogDir.mkdir();
  remoteLogDir.mkdir();
  LOG.info("Created localDir in " + localDir.getAbsolutePath());
  LOG.info("Created tmpDir in " + tmpDir.getAbsolutePath());
  String bindAddress="0.0.0.0:5555";
  conf.set(NMConfig.NM_BIND_ADDRESS,bindAddress);
  conf.set(NMConfig.NM_LOCAL_DIR,localDir.getAbsolutePath());
  conf.set(NMConfig.NM_LOG_DIR,localLogDir.getAbsolutePath());
  conf.set(NMConfig.REMOTE_USER_LOG_DIR,remoteLogDir.getAbsolutePath());
  delSrvc=new DeletionService(exec){
    @Override public void delete(    String user,    Path subDir,    Path[] baseDirs){
      LOG.info("Psuedo delete: user - " + user + ", subDir - "+ subDir+ ", baseDirs - "+ baseDirs);
    }
  }
;
  delSrvc.init(conf);
  exec=createContainerExecutor();
  containerManager=new ContainerManagerImpl(context,exec,delSrvc,nodeStatusUpdater,metrics);
  containerManager.init(conf);
}
