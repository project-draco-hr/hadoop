{
  this.store=store;
  this.key=key;
  this.progress=progress;
  this.statistics=statistics;
  partSizeThreshold=conf.getLong(MIN_MULTIPART_UPLOAD_THRESHOLD_KEY,MIN_MULTIPART_UPLOAD_THRESHOLD_DEFAULT);
  if (conf.get(BUFFER_DIR_KEY) == null) {
    conf.set(BUFFER_DIR_KEY,conf.get("hadoop.tmp.dir") + "/oss");
  }
  dirAlloc=new LocalDirAllocator(BUFFER_DIR_KEY);
  tmpFile=dirAlloc.createTmpFileForWrite("output-",LocalDirAllocator.SIZE_UNKNOWN,conf);
  backupStream=new BufferedOutputStream(new FileOutputStream(tmpFile));
  closed=false;
}
