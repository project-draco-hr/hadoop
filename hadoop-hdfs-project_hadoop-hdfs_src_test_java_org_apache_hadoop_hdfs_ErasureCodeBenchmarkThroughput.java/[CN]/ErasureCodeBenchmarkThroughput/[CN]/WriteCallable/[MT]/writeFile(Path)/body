{
  StopWatch sw=new StopWatch().start();
  System.out.println("Writing " + path);
  long dataSize=dataSizeMB * 1024 * 1024L;
  long remaining=dataSize;
  try (FSDataOutputStream outputStream=fs.create(path)){
    if (!isGen) {
      fs.deleteOnExit(path);
    }
    int toWrite;
    while (remaining > 0) {
      toWrite=(int)Math.min(remaining,data.length);
      outputStream.write(data,0,toWrite);
      remaining-=toWrite;
    }
    System.out.println("Finished writing " + path + ". Time taken: "+ sw.now(TimeUnit.SECONDS)+ " s.");
    return dataSize - remaining;
  }
 }
