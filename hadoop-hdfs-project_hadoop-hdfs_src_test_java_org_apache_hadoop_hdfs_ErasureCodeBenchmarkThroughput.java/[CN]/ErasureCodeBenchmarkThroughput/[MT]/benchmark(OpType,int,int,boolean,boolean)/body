{
  List<Long> sizes=null;
  StopWatch sw=new StopWatch().start();
switch (type) {
case READ:
    sizes=doBenchmark(true,dataSizeMB,numClients,isEc,statefulRead,false);
  break;
case WRITE:
sizes=doBenchmark(false,dataSizeMB,numClients,isEc,statefulRead,false);
break;
case GEN:
sizes=doBenchmark(false,dataSizeMB,numClients,isEc,statefulRead,true);
}
long elapsedSec=sw.now(TimeUnit.SECONDS);
double totalDataSizeMB=0;
for (Long size : sizes) {
if (size >= 0) {
totalDataSizeMB+=size.doubleValue() / 1024 / 1024;
}
}
double throughput=totalDataSizeMB / elapsedSec;
DecimalFormat df=getDecimalFormat();
System.out.println(type + " " + df.format(totalDataSizeMB)+ " MB data takes: "+ elapsedSec+ " s.\nTotal throughput: "+ df.format(throughput)+ " MB/s.");
}
