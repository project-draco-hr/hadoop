{
  CompletionService<Long> cs=new ExecutorCompletionService<Long>(Executors.newFixedThreadPool(numClients));
  for (int i=0; i < numClients; i++) {
    cs.submit(isRead ? new ReadCallable(dataSizeMB,isEc,i,statefulRead) : new WriteCallable(dataSizeMB,isEc,i,isGen));
  }
  List<Long> results=new ArrayList<>(numClients);
  for (int i=0; i < numClients; i++) {
    results.add(cs.take().get());
  }
  return results;
}
