{
  DummyService svc1=new DummyService(HAServiceState.ACTIVE);
  DummyService svc2=new DummyService(HAServiceState.STANDBY);
  NodeFencer fencer=setupFencer(AlwaysFailFencer.class.getName());
  AlwaysFailFencer.fenceCalled=0;
  try {
    FailoverController.failover(svc1,svc1Addr,svc2,svc2Addr,fencer,true);
    fail("Failed over even though fencing requested and failed");
  }
 catch (  FailoverFailedException ffe) {
  }
  assertEquals(1,AlwaysFailFencer.fenceCalled);
  assertEquals("svc1:1234",AlwaysFailFencer.fencedSvc);
  assertEquals(HAServiceState.STANDBY,svc1.getServiceState());
  assertEquals(HAServiceState.STANDBY,svc2.getServiceState());
}
