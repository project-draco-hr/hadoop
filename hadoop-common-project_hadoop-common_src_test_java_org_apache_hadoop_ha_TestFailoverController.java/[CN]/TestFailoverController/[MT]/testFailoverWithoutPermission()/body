{
  DummyService svc1=new DummyService(HAServiceState.ACTIVE){
    @Override public HAServiceState getServiceState() throws IOException {
      throw new AccessControlException("Access denied");
    }
  }
;
  DummyService svc2=new DummyService(HAServiceState.STANDBY){
    @Override public HAServiceState getServiceState() throws IOException {
      throw new AccessControlException("Access denied");
    }
  }
;
  NodeFencer fencer=setupFencer(AlwaysSucceedFencer.class.getName());
  try {
    FailoverController.failover(svc1,svc1Addr,svc2,svc2Addr,fencer,false,false);
    fail("Can't failover when access is denied");
  }
 catch (  FailoverFailedException ffe) {
    assertTrue(ffe.getCause().getMessage().contains("Access denied"));
  }
}
