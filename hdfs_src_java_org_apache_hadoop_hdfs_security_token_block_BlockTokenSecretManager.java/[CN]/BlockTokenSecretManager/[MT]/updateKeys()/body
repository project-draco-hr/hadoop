{
  if (!isMaster)   return;
  LOG.info("Updating block keys");
  removeExpiredKeys();
  allKeys.put(currentKey.getKeyId(),new BlockKey(currentKey.getKeyId(),System.currentTimeMillis() + keyUpdateInterval + tokenLifetime,currentKey.getKey()));
  currentKey=new BlockKey(nextKey.getKeyId(),System.currentTimeMillis() + 2 * keyUpdateInterval + tokenLifetime,nextKey.getKey());
  allKeys.put(currentKey.getKeyId(),currentKey);
  serialNo++;
  nextKey=new BlockKey(serialNo,System.currentTimeMillis() + 3 * keyUpdateInterval + tokenLifetime,generateSecret());
  allKeys.put(nextKey.getKeyId(),nextKey);
}
