{
  Principal user=null;
  if (useKerberos) {
    user=getCanonicalUser(KerberosPrincipal.class);
  }
  if (user == null) {
    user=getCanonicalUser(OS_PRINCIPAL_CLASS);
  }
  if (user != null) {
    subject.getPrincipals().add(new User(user.getName()));
    return true;
  }
  LOG.error("Can't find user in " + subject);
  throw new LoginException("Can't find user name");
}
