{
  if (!isSecurityEnabled())   return;
  LoginContext login=getLogin();
  if (login == null || keytabFile == null) {
    throw new IOException("loginUserFromKeyTab must be done first");
  }
  long now=System.currentTimeMillis();
  if (now - lastReloginTime < MIN_TIME_BEFORE_RELOGIN) {
    LOG.warn("Not attempting to re-login since the last re-login was " + "attempted less than " + (MIN_TIME_BEFORE_RELOGIN / 1000) + " seconds"+ " before.");
    return;
  }
  lastReloginTime=System.currentTimeMillis();
  try {
    LOG.info("Initiating logout for " + getUserName());
    login.logout();
    login=new LoginContext(HadoopConfiguration.KEYTAB_KERBEROS_CONFIG_NAME,getSubject());
    LOG.info("Initiating re-login for " + keytabPrincipal);
    login.login();
    setLogin(login);
  }
 catch (  LoginException le) {
    throw new IOException("Login failure for " + keytabPrincipal + " from keytab "+ keytabFile,le);
  }
}
