{
  if (!isSecurityEnabled())   return;
  keytabFile=path;
  keytabPrincipal=user;
  Subject subject=new Subject();
  LoginContext login;
  try {
    login=new LoginContext(HadoopConfiguration.KEYTAB_KERBEROS_CONFIG_NAME,subject);
    login.login();
    loginUser=new UserGroupInformation(subject);
    loginUser.setLogin(login);
    loginUser.setAuthenticationMethod(AuthenticationMethod.KERBEROS);
  }
 catch (  LoginException le) {
    throw new IOException("Login failure for " + user + " from keytab "+ path,le);
  }
  LOG.info("Login successful for user " + keytabPrincipal + " using keytab file "+ keytabFile);
}
