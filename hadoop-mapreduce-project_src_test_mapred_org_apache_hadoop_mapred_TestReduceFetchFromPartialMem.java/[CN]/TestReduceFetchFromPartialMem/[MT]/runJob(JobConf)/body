{
  conf.setMapperClass(MapMB.class);
  conf.setReducerClass(MBValidate.class);
  conf.setOutputKeyClass(Text.class);
  conf.setOutputValueClass(Text.class);
  conf.setNumReduceTasks(1);
  conf.setInputFormat(FakeIF.class);
  conf.setNumTasksToExecutePerJvm(1);
  conf.setInt(JobContext.MAP_MAX_ATTEMPTS,0);
  conf.setInt(JobContext.REDUCE_MAX_ATTEMPTS,0);
  FileInputFormat.setInputPaths(conf,new Path("/in"));
  final Path outp=new Path("/out");
  FileOutputFormat.setOutputPath(conf,outp);
  RunningJob job=null;
  try {
    job=JobClient.runJob(conf);
    assertTrue(job.isSuccessful());
  }
  finally {
    FileSystem fs=dfsCluster.getFileSystem();
    if (fs.exists(outp)) {
      fs.delete(outp,true);
    }
  }
  return job.getCounters();
}
