{
  if (!checkUser(userID,cert)) {
    return false;
  }
  Set<Path> pathSet=permsMap.get(userID);
  if (pathSet == null) {
    LOG.info("User " + userID + " is not listed in the user permissions file");
    return false;
  }
  if (pathInfo == null || pathInfo.length() == 0) {
    LOG.info("Can't get file path from HTTPS request; user is " + userID);
    return false;
  }
  Path userPath=new Path(pathInfo);
  while (userPath != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("\n Checking file path " + userPath);
    }
    if (pathSet.contains(userPath))     return true;
    userPath=userPath.getParent();
  }
  LOG.info("User " + userID + " is not authorized to access "+ pathInfo);
  return false;
}
