{
  String permLoc=conf.get("hdfsproxy.user.permissions.file.location","user-permissions.xml");
  if (conf.getResource(permLoc) == null) {
    LOG.warn("HdfsProxy user permissions file not found");
    return null;
  }
  Configuration permConf=new HdfsConfiguration(false);
  permConf.addResource(permLoc);
  Map<String,Set<Path>> map=new HashMap<String,Set<Path>>();
  for (  Map.Entry<String,String> e : permConf) {
    String k=e.getKey();
    String v=e.getValue();
    if (k != null && k.length() != 0 && v != null && v.length() != 0) {
      Set<Path> pathSet=new HashSet<Path>();
      String[] paths=v.split(",\\s*");
      for (      String p : paths) {
        if (p.length() != 0) {
          pathSet.add(new Path(p));
        }
      }
      map.put(k,pathSet);
    }
  }
  return map;
}
