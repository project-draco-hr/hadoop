{
  String certsLoc=conf.get("hdfsproxy.user.certs.file.location","user-certs.xml");
  if (conf.getResource(certsLoc) == null) {
    LOG.warn("HdfsProxy user certs file not found");
    return null;
  }
  Configuration certsConf=new HdfsConfiguration(false);
  certsConf.addResource(certsLoc);
  Map<String,Set<BigInteger>> map=new HashMap<String,Set<BigInteger>>();
  for (  Map.Entry<String,String> e : certsConf) {
    String k=e.getKey();
    String v=e.getValue().trim();
    if (k != null && k.length() != 0 && v != null && v.length() != 0) {
      Set<BigInteger> numSet=new HashSet<BigInteger>();
      String[] serialnumbers=v.split("\\s*,\\s*");
      for (      String num : serialnumbers) {
        if (num.length() != 0) {
          numSet.add(new BigInteger(num,16));
        }
      }
      map.put(k,numSet);
    }
  }
  return map;
}
