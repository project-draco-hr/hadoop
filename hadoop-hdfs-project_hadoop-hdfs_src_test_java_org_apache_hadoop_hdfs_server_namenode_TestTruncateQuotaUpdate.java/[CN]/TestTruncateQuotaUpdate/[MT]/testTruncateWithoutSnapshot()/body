{
  INodeFile file=createMockFile(BLOCKSIZE * 2 + BLOCKSIZE / 2,REPLICATION);
  QuotaCounts count=new QuotaCounts.Builder().build();
  file.computeQuotaDeltaForTruncate(BLOCKSIZE + BLOCKSIZE / 2,null,count);
  Assert.assertEquals(-BLOCKSIZE / 2 * REPLICATION,count.getStorageSpace());
  count=new QuotaCounts.Builder().build();
  file.computeQuotaDeltaForTruncate(BLOCKSIZE,null,count);
  Assert.assertEquals(-(BLOCKSIZE + BLOCKSIZE / 2) * REPLICATION,count.getStorageSpace());
  count=new QuotaCounts.Builder().build();
  file.computeQuotaDeltaForTruncate(0,null,count);
  Assert.assertEquals(-(BLOCKSIZE * 2 + BLOCKSIZE / 2) * REPLICATION,count.getStorageSpace());
}
