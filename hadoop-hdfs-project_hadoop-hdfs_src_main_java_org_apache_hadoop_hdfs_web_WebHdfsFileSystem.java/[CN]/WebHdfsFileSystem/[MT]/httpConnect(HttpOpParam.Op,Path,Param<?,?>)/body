{
  final URL url=toUrl(op,fspath,parameters);
  final HttpURLConnection conn=getHttpUrlConnection(url);
  try {
    conn.setRequestMethod(op.getType().toString());
    conn.setDoOutput(op.getDoOutput());
    if (op.getDoOutput()) {
      conn.setRequestProperty("Expect","100-Continue");
      conn.setInstanceFollowRedirects(true);
    }
    conn.connect();
    return conn;
  }
 catch (  IOException e) {
    conn.disconnect();
    throw e;
  }
}
