{
  final String uripath="/" + PATH_PREFIX + makeQualified(fspath).toUri().getPath();
  final String query=op.toQueryString() + Param.toSortedString("&",parameters);
  final HttpURLConnection conn=openConnection(uripath,query);
  try {
    conn.setRequestMethod(op.getType().toString());
    conn.setDoOutput(op.getDoOutput());
    if (op.getDoOutput()) {
      conn.setRequestProperty("Expect","100-Continue");
      conn.setInstanceFollowRedirects(true);
    }
    conn.connect();
    return conn;
  }
 catch (  IOException e) {
    conn.disconnect();
    throw e;
  }
}
