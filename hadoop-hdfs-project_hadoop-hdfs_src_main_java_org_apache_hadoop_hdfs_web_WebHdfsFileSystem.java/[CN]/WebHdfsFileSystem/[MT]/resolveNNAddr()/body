{
  Configuration conf=getConf();
  final String scheme=uri.getScheme();
  ArrayList<InetSocketAddress> ret=new ArrayList<InetSocketAddress>();
  if (!HAUtil.isLogicalUri(conf,uri)) {
    InetSocketAddress addr=NetUtils.createSocketAddr(uri.getAuthority(),getDefaultPort());
    ret.add(addr);
  }
 else {
    Map<String,Map<String,InetSocketAddress>> addresses=DFSUtil.getHaNnWebHdfsAddresses(conf,scheme);
    for (    Map<String,InetSocketAddress> addrs : addresses.values()) {
      for (      InetSocketAddress addr : addrs.values()) {
        ret.add(addr);
      }
    }
  }
  InetSocketAddress[] r=new InetSocketAddress[ret.size()];
  return ret.toArray(r);
}
