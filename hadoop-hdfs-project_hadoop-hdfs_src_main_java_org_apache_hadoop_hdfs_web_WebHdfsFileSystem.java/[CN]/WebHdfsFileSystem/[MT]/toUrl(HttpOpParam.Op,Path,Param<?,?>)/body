{
  final String path="/" + PATH_PREFIX + (fspath == null ? "/" : makeQualified(fspath).toUri().getPath());
  final String query=op.toQueryString() + '&' + new UserParam(ugi)+ Param.toSortedString("&",parameters);
  final URL url=getNamenodeURL(path,addDelegationTokenParam(query));
  if (LOG.isTraceEnabled()) {
    LOG.trace("url=" + url);
  }
  return url;
}
