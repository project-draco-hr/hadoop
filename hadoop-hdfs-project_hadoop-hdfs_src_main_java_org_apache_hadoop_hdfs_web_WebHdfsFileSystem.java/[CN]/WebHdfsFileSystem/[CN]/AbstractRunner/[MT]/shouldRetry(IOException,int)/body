{
  InetSocketAddress nnAddr=getCurrentNNAddr();
  if (checkRetry) {
    try {
      final RetryPolicy.RetryAction a=retryPolicy.shouldRetry(ioe,retry,0,true);
      boolean isRetry=a.action == RetryPolicy.RetryAction.RetryDecision.RETRY;
      boolean isFailoverAndRetry=a.action == RetryPolicy.RetryAction.RetryDecision.FAILOVER_AND_RETRY;
      if (isRetry || isFailoverAndRetry) {
        LOG.info("Retrying connect to namenode: " + nnAddr + ". Already tried "+ retry+ " time(s); retry policy is "+ retryPolicy+ ", delay "+ a.delayMillis+ "ms.");
        if (isFailoverAndRetry) {
          resetStateToFailOver();
        }
        Thread.sleep(a.delayMillis);
        return;
      }
    }
 catch (    Exception e) {
      LOG.warn("Original exception is ",ioe);
      throw toIOException(e);
    }
  }
  throw toIOException(ioe);
}
