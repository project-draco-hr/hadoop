{
  if (useKrb) {
    SSLSocket sslSocket=(SSLSocket)endpoint.getTransport();
    Principal remotePrincipal=sslSocket.getSession().getPeerPrincipal();
    logIfDebug("Remote principal = " + remotePrincipal);
    request.setScheme(HttpSchemes.HTTPS);
    request.setAttribute(REMOTE_PRINCIPAL,remotePrincipal);
    if (!useCerts) {
      String cipherSuite=sslSocket.getSession().getCipherSuite();
      Integer keySize=Integer.valueOf(ServletSSL.deduceKeyLength(cipherSuite));
      ;
      request.setAttribute("javax.servlet.request.cipher_suite",cipherSuite);
      request.setAttribute("javax.servlet.request.key_size",keySize);
    }
  }
  if (useCerts)   super.customize(endpoint,request);
}
