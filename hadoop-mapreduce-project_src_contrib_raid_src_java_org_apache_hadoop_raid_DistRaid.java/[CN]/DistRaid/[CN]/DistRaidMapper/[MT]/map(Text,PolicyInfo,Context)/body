{
  try {
    Configuration jobConf=context.getConfiguration();
    LOG.info("Raiding file=" + key.toString() + " policy="+ policy);
    Path p=new Path(key.toString());
    FileStatus fs=p.getFileSystem(jobConf).getFileStatus(p);
    st.clear();
    RaidNode.doRaid(jobConf,policy,fs,st,context);
    ++succeedcount;
    context.getCounter(Counter.PROCESSED_BLOCKS).increment(st.numProcessedBlocks);
    context.getCounter(Counter.PROCESSED_SIZE).increment(st.processedSize);
    context.getCounter(Counter.META_BLOCKS).increment(st.numMetaBlocks);
    context.getCounter(Counter.META_SIZE).increment(st.metaSize);
    context.getCounter(Counter.FILES_SUCCEEDED).increment(1);
  }
 catch (  IOException e) {
    ++failcount;
    context.getCounter(Counter.FILES_FAILED).increment(1);
    String s="FAIL: " + policy + ", "+ key+ " "+ StringUtils.stringifyException(e);
    context.write(new Text(key),new Text(s));
    LOG.error(s);
  }
 finally {
    context.setStatus(getCountString());
  }
}
