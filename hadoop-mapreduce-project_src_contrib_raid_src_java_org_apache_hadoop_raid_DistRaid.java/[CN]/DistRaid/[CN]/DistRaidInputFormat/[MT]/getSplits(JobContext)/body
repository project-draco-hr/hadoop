{
  Configuration conf=job.getConfiguration();
  Path inDir=getInputPaths(job)[0];
  FileSystem fs=inDir.getFileSystem(conf);
  FileStatus[] inputFiles=fs.listStatus(inDir);
  Path inputFile=inputFiles[0].getPath();
  List<InputSplit> splits=new ArrayList<InputSplit>();
  SequenceFile.Reader in=new SequenceFile.Reader(conf,Reader.file(inputFile));
  long prev=0L;
  final int opsPerTask=conf.getInt(OPS_PER_TASK,DEFAULT_OPS_PER_TASK);
  try {
    Text key=new Text();
    PolicyInfo value=new PolicyInfo();
    int count=0;
    while (in.next(key,value)) {
      long curr=in.getPosition();
      long delta=curr - prev;
      if (++count > opsPerTask) {
        count=0;
        splits.add(new FileSplit(inputFile,prev,delta,(String[])null));
        prev=curr;
      }
    }
  }
  finally {
    in.close();
  }
  long remaining=fs.getFileStatus(inputFile).getLen() - prev;
  if (remaining != 0) {
    splits.add(new FileSplit(inputFile,prev,remaining,(String[])null));
  }
  return splits;
}
