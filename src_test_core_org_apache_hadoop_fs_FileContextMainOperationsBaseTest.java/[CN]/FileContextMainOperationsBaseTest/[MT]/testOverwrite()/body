{
  Path path=getTestRootPath(fc,"test/hadoop/file");
  fc.mkdir(path.getParent(),FsPermission.getDefault(),true);
  createFile(path);
  Assert.assertTrue("Exists",exists(fc,path));
  Assert.assertEquals("Length",data.length,fc.getFileStatus(path).getLen());
  try {
    fc.create(path,EnumSet.of(CreateFlag.CREATE));
    Assert.fail("Should throw IOException.");
  }
 catch (  IOException e) {
  }
  FSDataOutputStream out=fc.create(path,EnumSet.of(CreateFlag.OVERWRITE));
  out.write(data,0,data.length);
  out.close();
  Assert.assertTrue("Exists",exists(fc,path));
  Assert.assertEquals("Length",data.length,fc.getFileStatus(path).getLen());
}
