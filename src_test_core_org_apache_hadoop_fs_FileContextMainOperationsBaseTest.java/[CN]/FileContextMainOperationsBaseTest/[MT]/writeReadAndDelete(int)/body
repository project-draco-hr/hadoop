{
  Path path=getTestRootPath(fc,"test/hadoop/file");
  fc.mkdir(path.getParent(),FsPermission.getDefault(),true);
  FSDataOutputStream out=fc.create(path,EnumSet.of(CreateFlag.CREATE),CreateOpts.repFac((short)1),CreateOpts.blockSize(getDefaultBlockSize()));
  out.write(data,0,len);
  out.close();
  Assert.assertTrue("Exists",exists(fc,path));
  Assert.assertEquals("Length",len,fc.getFileStatus(path).getLen());
  FSDataInputStream in=fc.open(path);
  byte[] buf=new byte[len];
  in.readFully(0,buf);
  in.close();
  Assert.assertEquals(len,buf.length);
  for (int i=0; i < buf.length; i++) {
    Assert.assertEquals("Position " + i,data[i],buf[i]);
  }
  Assert.assertTrue("Deleted",fc.delete(path,false));
  Assert.assertFalse("No longer exists",exists(fc,path));
}
