{
  Path dir=getTestRootPath(fc,"test/hadoop");
  Path file=getTestRootPath(fc,"test/hadoop/file");
  Path subdir=getTestRootPath(fc,"test/hadoop/subdir");
  createFile(file);
  fc.mkdir(subdir,FsPermission.getDefault(),true);
  Assert.assertTrue("File exists",exists(fc,file));
  Assert.assertTrue("Dir exists",exists(fc,dir));
  Assert.assertTrue("Subdir exists",exists(fc,subdir));
  try {
    fc.delete(dir,false);
    Assert.fail("Should throw IOException.");
  }
 catch (  IOException e) {
  }
  Assert.assertTrue("File still exists",exists(fc,file));
  Assert.assertTrue("Dir still exists",exists(fc,dir));
  Assert.assertTrue("Subdir still exists",exists(fc,subdir));
  Assert.assertTrue("Deleted",fc.delete(dir,true));
  Assert.assertFalse("File doesn't exist",exists(fc,file));
  Assert.assertFalse("Dir doesn't exist",exists(fc,dir));
  Assert.assertFalse("Subdir doesn't exist",exists(fc,subdir));
}
