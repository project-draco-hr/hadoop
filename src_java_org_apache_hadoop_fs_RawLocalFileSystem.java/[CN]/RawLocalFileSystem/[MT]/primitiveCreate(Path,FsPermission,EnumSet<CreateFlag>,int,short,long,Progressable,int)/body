{
  if (flag.contains(CreateFlag.APPEND)) {
    if (!exists(f)) {
      if (flag.contains(CreateFlag.CREATE)) {
        return create(f,false,bufferSize,replication,blockSize,null);
      }
    }
    return append(f,bufferSize,null);
  }
  FSDataOutputStream out=create(f,flag.contains(CreateFlag.OVERWRITE),bufferSize,replication,blockSize,progress);
  setPermission(f,absolutePermission);
  return out;
}
