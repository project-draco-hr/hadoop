{
  RMContext rmContext=yarnCluster.getResourceManager(0).getRMContext();
  RMNodeLabelsManager labelsMgr=rmContext.getNodeLabelManager();
  Set<String> labels=new HashSet<String>();
  labels.add("x");
  labelsMgr.addToCluserNodeLabels(labels);
  conf.set("yarn.scheduler.capacity.root.accessible-node-labels","x");
  conf.set("yarn.scheduler.capacity.root.accessible-node-labels.x.capacity","100");
  conf.set("yarn.scheduler.capacity.root.default.accessible-node-labels","x");
  conf.set("yarn.scheduler.capacity.root.default.accessible-node-labels.x.capacity","100");
  rmContext.getScheduler().reinitialize(conf,rmContext);
  NodeId[] nodeIds=new NodeId[numNodeManager];
  for (int i=0; i < numNodeManager; i++) {
    NodeManager mgr=this.yarnCluster.getNodeManager(i);
    nodeIds[i]=mgr.getNMContext().getNodeId();
  }
  labelsMgr.addLabelsToNode(ImmutableMap.of(nodeIds[1],labels));
}
