{
  String tmpRoot=FileSystemTimelineWriterImpl.DEFAULT_TIMELINE_SERVICE_STORAGE_DIR_ROOT + "/entities/";
  File tmpRootFolder=new File(tmpRoot);
  try {
    Assert.assertTrue(tmpRootFolder.isDirectory());
    String basePath=tmpRoot + YarnConfiguration.DEFAULT_RM_CLUSTER_ID + "/"+ UserGroupInformation.getCurrentUser().getShortUserName()+ (defaultFlow ? "/" + TimelineUtils.generateDefaultFlowIdBasedOnAppId(appId) + "/1/1/" : "/test_flow_name/test_flow_version/12345678/")+ appId.toString();
    String outputDirApp=basePath + "/DS_APP_ATTEMPT/";
    File entityFolder=new File(outputDirApp);
    Assert.assertTrue(entityFolder.isDirectory());
    String appTimestampFileName="appattempt_" + appId.getClusterTimestamp() + "_000"+ appId.getId()+ "_000001"+ FileSystemTimelineWriterImpl.TIMELINE_SERVICE_STORAGE_EXTENSION;
    String appAttemptFileName=outputDirApp + appTimestampFileName;
    File appAttemptFile=new File(appAttemptFileName);
    Assert.assertTrue(appAttemptFile.exists());
    String outputDirContainer=basePath + "/DS_CONTAINER/";
    File containerFolder=new File(outputDirContainer);
    Assert.assertTrue(containerFolder.isDirectory());
    String containerTimestampFileName="container_" + appId.getClusterTimestamp() + "_000"+ appId.getId()+ "_01_000002.thist";
    String containerFileName=outputDirContainer + containerTimestampFileName;
    File containerFile=new File(containerFileName);
    Assert.assertTrue(containerFile.exists());
    String outputDirContainerMetrics=basePath + "/" + TimelineEntityType.YARN_CONTAINER+ "/";
    File containerMetricsFolder=new File(outputDirContainerMetrics);
    Assert.assertTrue(containerMetricsFolder.isDirectory());
    String containerMetricsTimestampFileName="container_" + appId.getClusterTimestamp() + "_000"+ appId.getId()+ "_01_000001.thist";
    String containerMetricsFileName=outputDirContainerMetrics + containerMetricsTimestampFileName;
    File containerMetricsFile=new File(containerMetricsFileName);
    Assert.assertTrue(containerMetricsFile.exists());
  }
  finally {
    FileUtils.deleteDirectory(tmpRootFolder.getParentFile());
  }
}
