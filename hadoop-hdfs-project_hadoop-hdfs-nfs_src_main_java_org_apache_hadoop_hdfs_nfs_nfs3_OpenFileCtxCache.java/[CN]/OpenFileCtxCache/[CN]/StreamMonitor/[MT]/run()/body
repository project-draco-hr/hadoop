{
  while (shouldRun) {
    scan(streamTimeout);
    try {
      long workedTime=Time.monotonicNow() - lastWakeupTime;
      if (workedTime < rotation) {
        if (LOG.isTraceEnabled()) {
          LOG.trace("StreamMonitor can still have a sleep:" + ((rotation - workedTime) / 1000));
        }
        Thread.sleep(rotation - workedTime);
      }
      lastWakeupTime=Time.monotonicNow();
    }
 catch (    InterruptedException e) {
      LOG.info("StreamMonitor got interrupted");
      return;
    }
  }
}
