{
  ArrayList<OpenFileCtx> cleanedContext=new ArrayList<OpenFileCtx>();
synchronized (this) {
    Iterator<Entry<FileHandle,OpenFileCtx>> it=openFileMap.entrySet().iterator();
    if (LOG.isTraceEnabled()) {
      LOG.trace("openFileMap size:" + openFileMap.size());
    }
    while (it.hasNext()) {
      Entry<FileHandle,OpenFileCtx> pairs=it.next();
      OpenFileCtx ctx=pairs.getValue();
      it.remove();
      cleanedContext.add(ctx);
    }
  }
  for (  OpenFileCtx ofc : cleanedContext) {
    ofc.cleanup();
  }
}
