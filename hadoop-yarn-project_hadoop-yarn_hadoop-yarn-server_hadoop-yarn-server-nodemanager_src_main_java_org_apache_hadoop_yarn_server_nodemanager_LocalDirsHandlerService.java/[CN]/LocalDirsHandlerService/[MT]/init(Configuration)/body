{
  Configuration conf=new Configuration(config);
  diskHealthCheckInterval=conf.getLong(YarnConfiguration.NM_DISK_HEALTH_CHECK_INTERVAL_MS,YarnConfiguration.DEFAULT_NM_DISK_HEALTH_CHECK_INTERVAL_MS);
  monitoringTimerTask=new MonitoringTimerTask(conf);
  isDiskHealthCheckerEnabled=conf.getBoolean(YarnConfiguration.NM_DISK_HEALTH_CHECK_ENABLE,true);
  minNeededHealthyDisksFactor=conf.getFloat(YarnConfiguration.NM_MIN_HEALTHY_DISKS_FRACTION,YarnConfiguration.DEFAULT_NM_MIN_HEALTHY_DISKS_FRACTION);
  lastDisksCheckTime=System.currentTimeMillis();
  super.init(conf);
  FileContext localFs;
  try {
    localFs=FileContext.getLocalFSFileContext(config);
  }
 catch (  IOException e) {
    throw new YarnException("Unable to get the local filesystem",e);
  }
  FsPermission perm=new FsPermission((short)0755);
  boolean createSucceeded=localDirs.createNonExistentDirs(localFs,perm);
  createSucceeded&=logDirs.createNonExistentDirs(localFs,perm);
  if (!createSucceeded) {
    updateDirsAfterFailure();
  }
  checkDirs();
}
