{
  LOG.info("Disk(s) failed. " + getDisksHealthReport());
  Configuration conf=getConfig();
  List<String> localDirs=getLocalDirs();
  conf.setStrings(YarnConfiguration.NM_LOCAL_DIRS,localDirs.toArray(new String[localDirs.size()]));
  List<String> logDirs=getLogDirs();
  conf.setStrings(YarnConfiguration.NM_LOG_DIRS,logDirs.toArray(new String[logDirs.size()]));
  if (!areDisksHealthy()) {
    LOG.error("Most of the disks failed. " + getDisksHealthReport());
  }
}
