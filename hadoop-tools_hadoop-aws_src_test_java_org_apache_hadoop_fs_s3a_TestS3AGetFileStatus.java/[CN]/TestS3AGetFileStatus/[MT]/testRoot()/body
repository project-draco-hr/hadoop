{
  Path path=new Path("/");
  String key=path.toUri().getPath().substring(1);
  when(s3.getObjectMetadata(BUCKET,key)).thenThrow(NOT_FOUND);
  when(s3.getObjectMetadata(BUCKET,key + "/")).thenThrow(NOT_FOUND);
  ObjectListing objects=mock(ObjectListing.class);
  when(objects.getCommonPrefixes()).thenReturn(Collections.<String>emptyList());
  when(objects.getObjectSummaries()).thenReturn(Collections.<S3ObjectSummary>emptyList());
  when(s3.listObjects(any(ListObjectsRequest.class))).thenReturn(objects);
  FileStatus stat=fs.getFileStatus(path);
  assertNotNull(stat);
  assertEquals(fs.makeQualified(path),stat.getPath());
  assertTrue(stat.isDirectory());
  assertTrue(stat.getPath().isRoot());
}
