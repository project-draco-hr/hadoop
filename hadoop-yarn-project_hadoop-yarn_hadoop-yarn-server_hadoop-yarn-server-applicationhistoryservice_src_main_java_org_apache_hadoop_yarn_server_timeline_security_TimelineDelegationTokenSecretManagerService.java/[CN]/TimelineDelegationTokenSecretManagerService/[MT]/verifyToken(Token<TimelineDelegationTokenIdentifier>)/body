{
  ByteArrayInputStream buf=new ByteArrayInputStream(token.getIdentifier());
  DataInputStream dis=new DataInputStream(buf);
  TimelineDelegationTokenIdentifier id=new TimelineDelegationTokenIdentifier();
  try {
    id.readFields(dis);
    secretManager.verifyToken(id,token.getPassword());
  }
  finally {
    dis.close();
  }
  return id.getUser();
}
