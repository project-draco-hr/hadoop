{
  if (jar_ != null && isLocalHadoop()) {
    File wd=new File(".").getAbsoluteFile();
    RunJar.unJar(new File(jar_),wd);
  }
  jc_=new JobClient(jobConf_);
  running_=null;
  try {
    running_=jc_.submitJob(jobConf_);
    jobId_=running_.getID();
    if (background_) {
      LOG.info("Job is running in background.");
    }
 else     if (!jc_.monitorAndPrintJob(jobConf_,running_)) {
      LOG.error("Job not successful!");
      return 1;
    }
    LOG.info("Output directory: " + output_);
  }
 catch (  FileNotFoundException fe) {
    LOG.error("Error launching job , bad input path : " + fe.getMessage());
    return 2;
  }
catch (  InvalidJobConfException je) {
    LOG.error("Error launching job , Invalid job conf : " + je.getMessage());
    return 3;
  }
catch (  FileAlreadyExistsException fae) {
    LOG.error("Error launching job , Output path already exists : " + fae.getMessage());
    return 4;
  }
catch (  IOException ioe) {
    LOG.error("Error Launching job : " + ioe.getMessage());
    return 5;
  }
catch (  InterruptedException ie) {
    LOG.error("Error monitoring job : " + ie.getMessage());
    return 6;
  }
 finally {
    jc_.close();
  }
  return 0;
}
