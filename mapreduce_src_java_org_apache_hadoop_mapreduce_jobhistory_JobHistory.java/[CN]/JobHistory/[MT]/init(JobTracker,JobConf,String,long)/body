{
  final String logDirLoc=conf.get(JTConfig.JT_JOBHISTORY_LOCATION,"file:///" + new File(System.getProperty("hadoop.log.dir")).getAbsolutePath() + File.separator+ "history");
  LOG.info("History log directory is " + logDirLoc);
  logDir=new Path(logDirLoc);
  logDirFs=logDir.getFileSystem(conf);
  if (!logDirFs.exists(logDir)) {
    if (!logDirFs.mkdirs(logDir,new FsPermission(HISTORY_DIR_PERMISSION))) {
      throw new IOException("Mkdirs failed to create " + logDir.toString());
    }
  }
  conf.set(JTConfig.JT_JOBHISTORY_LOCATION,logDirLoc);
  jobHistoryBlockSize=conf.getLong(JTConfig.JT_JOBHISTORY_BLOCK_SIZE,3 * 1024 * 1024);
  jobTracker=jt;
}
