{
  logIfDebug("Creating new KrbServerSocket for: " + host);
  SSLServerSocket ss=null;
  if (useCerts)   ss=(SSLServerSocket)super.newServerSocket(host,port,backlog);
 else {
    try {
      ss=(SSLServerSocket)(host == null ? createFactory().createServerSocket(port,backlog) : createFactory().createServerSocket(port,backlog,InetAddress.getByName(host)));
    }
 catch (    Exception e) {
      LOG.warn("Could not create KRB5 Listener",e);
      throw new IOException("Could not create KRB5 Listener: " + e.toString());
    }
  }
  if (useKrb) {
    ss.setNeedClientAuth(true);
    String[] combined;
    if (useCerts) {
      String[] certs=ss.getEnabledCipherSuites();
      combined=new String[certs.length + KRB5_CIPHER_SUITES.size()];
      System.arraycopy(certs,0,combined,0,certs.length);
      System.arraycopy(KRB5_CIPHER_SUITES.toArray(new String[0]),0,combined,certs.length,KRB5_CIPHER_SUITES.size());
    }
 else {
      combined=KRB5_CIPHER_SUITES.toArray(new String[0]);
    }
    ss.setEnabledCipherSuites(combined);
  }
  return ss;
}
