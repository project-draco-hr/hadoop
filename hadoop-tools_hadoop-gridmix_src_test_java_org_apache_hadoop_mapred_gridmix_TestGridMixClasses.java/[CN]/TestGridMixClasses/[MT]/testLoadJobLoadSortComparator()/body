{
  LoadJob.LoadSortComparator test=new LoadJob.LoadSortComparator();
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(data);
  WritableUtils.writeVInt(dos,2);
  WritableUtils.writeVInt(dos,1);
  WritableUtils.writeVInt(dos,4);
  WritableUtils.writeVInt(dos,7);
  WritableUtils.writeVInt(dos,4);
  byte[] b1=data.toByteArray();
  byte[] b2=data.toByteArray();
  assertEquals(0,test.compare(b1,0,1,b2,0,1));
  b2[2]=5;
  assertEquals(-1,test.compare(b1,0,1,b2,0,1));
  b2[2]=2;
  assertEquals(2,test.compare(b1,0,1,b2,0,1));
  b2[2]=4;
  assertEquals(1,test.compare(b1,0,1,b2,1,1));
}
