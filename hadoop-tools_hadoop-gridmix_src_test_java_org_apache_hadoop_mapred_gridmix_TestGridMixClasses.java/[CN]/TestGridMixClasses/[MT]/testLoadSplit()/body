{
  LoadSplit test=getLoadSplit();
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(data);
  test.write(out);
  LoadSplit copy=new LoadSplit();
  copy.readFields(new DataInputStream(new ByteArrayInputStream(data.toByteArray())));
  assertEquals(test.getId(),copy.getId());
  assertEquals(test.getMapCount(),copy.getMapCount());
  assertEquals(test.getInputRecords(),copy.getInputRecords());
  assertEquals(test.getOutputBytes()[0],copy.getOutputBytes()[0]);
  assertEquals(test.getOutputRecords()[0],copy.getOutputRecords()[0]);
  assertEquals(test.getReduceBytes(0),copy.getReduceBytes(0));
  assertEquals(test.getReduceRecords(0),copy.getReduceRecords(0));
  assertEquals(test.getMapResourceUsageMetrics().getCumulativeCpuUsage(),copy.getMapResourceUsageMetrics().getCumulativeCpuUsage());
  assertEquals(test.getReduceResourceUsageMetrics(0).getCumulativeCpuUsage(),copy.getReduceResourceUsageMetrics(0).getCumulativeCpuUsage());
}
