{
  RecordFactory rf=new FakeRecordFactory();
  FakeInputStream input=new FakeInputStream();
  ReadRecordFactory test=new ReadRecordFactory(rf,input,new Configuration());
  GridmixKey key=new GridmixKey(GridmixKey.DATA,100,2);
  GridmixRecord val=new GridmixRecord(200,2);
  while (test.next(key,val)) {
  }
  assertEquals(3000,input.getCounter());
  assertEquals(-1,rf.getProgress(),0.01);
  test.close();
}
