{
  RMApp app=rmContext.getRMApps().get(appId);
  if (app == null) {
    throw new YarnRuntimeException("Unable to get the timeline collector context info for a non-existing app " + appId);
  }
  String userId=app.getUser();
  if (userId != null && !userId.isEmpty()) {
    collector.getTimelineEntityContext().setUserId(userId);
  }
  for (  String tag : app.getApplicationTags()) {
    String[] parts=tag.split(":",2);
    if (parts.length != 2 || parts[1].isEmpty()) {
      continue;
    }
switch (parts[0].toUpperCase()) {
case TimelineUtils.FLOW_NAME_TAG_PREFIX:
      collector.getTimelineEntityContext().setFlowName(parts[1]);
    break;
case TimelineUtils.FLOW_VERSION_TAG_PREFIX:
  collector.getTimelineEntityContext().setFlowVersion(parts[1]);
break;
case TimelineUtils.FLOW_RUN_ID_TAG_PREFIX:
collector.getTimelineEntityContext().setFlowRunId(Long.parseLong(parts[1]));
break;
default :
break;
}
}
}
