{
  if (packages == null) {
    getPackages();
  }
  if (getClass().getName().equals(metadata.get(SERIALIZATION_KEY))) {
    return true;
  }
  Class<?> c=getClassFromMetadata(metadata);
  if (c == null) {
    return false;
  }
  return AvroReflectSerializable.class.isAssignableFrom(c) || packages.contains(c.getPackage().getName());
}
