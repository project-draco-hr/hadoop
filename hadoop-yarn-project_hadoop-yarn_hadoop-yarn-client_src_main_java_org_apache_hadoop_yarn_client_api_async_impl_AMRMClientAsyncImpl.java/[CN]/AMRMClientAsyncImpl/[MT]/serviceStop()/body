{
  keepRunning=false;
  heartbeatThread.interrupt();
  try {
    heartbeatThread.join();
  }
 catch (  InterruptedException ex) {
    LOG.error("Error joining with heartbeat thread",ex);
  }
  client.stop();
  handlerThread.interrupt();
  super.serviceStop();
}
