{
  final short repl=3;
  final int corruptBlockNumber=3;
  for (int i=0; i < 2; i++) {
    String fileName="/tmp/testClientReportBadBlock/testCorruptAllReplicas" + i;
    Path filePath=new Path(fileName);
    createAFileWithCorruptedBlockReplicas(filePath,repl,corruptBlockNumber);
    if (i == 0) {
      dfsClientReadFile(filePath);
    }
 else {
      dfsClientReadFileFromPosition(filePath);
    }
    int expectedReplicasReturned=repl;
    verifyCorruptedBlockCount(filePath,expectedReplicasReturned);
    verifyFirstBlockCorrupted(filePath,false);
    verifyFsckHealth("");
    testFsckListCorruptFilesBlocks(filePath,0);
  }
}
