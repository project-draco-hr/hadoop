{
  node.handle(new RMNodeStartedEvent(null,null,null));
  NodeId nodeId=BuilderUtils.newNodeId("localhost:1",1);
  RMNodeImpl node2=new RMNodeImpl(nodeId,rmContext,null,0,0,null,null,null);
  node2.handle(new RMNodeStartedEvent(null,null,null));
  ContainerId completedContainerIdFromNode1=BuilderUtils.newContainerId(BuilderUtils.newApplicationAttemptId(BuilderUtils.newApplicationId(0,0),0),0);
  ContainerId completedContainerIdFromNode2_1=BuilderUtils.newContainerId(BuilderUtils.newApplicationAttemptId(BuilderUtils.newApplicationId(1,1),1),1);
  ContainerId completedContainerIdFromNode2_2=BuilderUtils.newContainerId(BuilderUtils.newApplicationAttemptId(BuilderUtils.newApplicationId(1,1),1),2);
  RMNodeStatusEvent statusEventFromNode1=getMockRMNodeStatusEvent();
  RMNodeStatusEvent statusEventFromNode2_1=getMockRMNodeStatusEvent();
  RMNodeStatusEvent statusEventFromNode2_2=getMockRMNodeStatusEvent();
  ContainerStatus containerStatusFromNode1=mock(ContainerStatus.class);
  ContainerStatus containerStatusFromNode2_1=mock(ContainerStatus.class);
  ContainerStatus containerStatusFromNode2_2=mock(ContainerStatus.class);
  doReturn(completedContainerIdFromNode1).when(containerStatusFromNode1).getContainerId();
  doReturn(Collections.singletonList(containerStatusFromNode1)).when(statusEventFromNode1).getContainers();
  node.handle(statusEventFromNode1);
  Assert.assertEquals(1,completedContainers.size());
  Assert.assertEquals(completedContainerIdFromNode1,completedContainers.get(0).getContainerId());
  completedContainers.clear();
  doReturn(completedContainerIdFromNode2_1).when(containerStatusFromNode2_1).getContainerId();
  doReturn(Collections.singletonList(containerStatusFromNode2_1)).when(statusEventFromNode2_1).getContainers();
  doReturn(completedContainerIdFromNode2_2).when(containerStatusFromNode2_2).getContainerId();
  doReturn(Collections.singletonList(containerStatusFromNode2_2)).when(statusEventFromNode2_2).getContainers();
  node2.setNextHeartBeat(false);
  node2.handle(statusEventFromNode2_1);
  node2.setNextHeartBeat(true);
  node2.handle(statusEventFromNode2_2);
  Assert.assertEquals(2,completedContainers.size());
  Assert.assertEquals(completedContainerIdFromNode2_1,completedContainers.get(0).getContainerId());
  Assert.assertEquals(completedContainerIdFromNode2_2,completedContainers.get(1).getContainerId());
}
