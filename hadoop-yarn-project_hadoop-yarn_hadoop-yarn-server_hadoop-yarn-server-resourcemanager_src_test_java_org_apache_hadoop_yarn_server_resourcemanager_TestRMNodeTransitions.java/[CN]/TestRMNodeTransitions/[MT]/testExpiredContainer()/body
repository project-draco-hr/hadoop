{
  node.handle(new RMNodeStartedEvent(null,null,null));
  verify(scheduler).handle(any(NodeAddedSchedulerEvent.class));
  ContainerId completedContainerId=BuilderUtils.newContainerId(BuilderUtils.newApplicationAttemptId(BuilderUtils.newApplicationId(0,0),0),0);
  node.handle(new RMNodeCleanContainerEvent(null,completedContainerId));
  Assert.assertEquals(1,node.getContainersToCleanUp().size());
  RMNodeStatusEvent statusEvent=getMockRMNodeStatusEvent();
  ContainerStatus containerStatus=mock(ContainerStatus.class);
  doReturn(completedContainerId).when(containerStatus).getContainerId();
  doReturn(Collections.singletonList(containerStatus)).when(statusEvent).getContainers();
  node.handle(statusEvent);
  verify(scheduler,times(2)).handle(any(NodeUpdateSchedulerEvent.class));
}
