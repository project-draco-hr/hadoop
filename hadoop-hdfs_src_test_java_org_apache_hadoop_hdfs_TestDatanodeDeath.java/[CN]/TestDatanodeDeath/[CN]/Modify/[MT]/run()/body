{
  while (running) {
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      continue;
    }
    boolean loop=false;
    for (int i=0; i < numThreads; i++) {
      if (workload[i].getStamp() == 0) {
        loop=true;
        break;
      }
    }
    if (loop) {
      continue;
    }
    for (int i=0; i < replication - 1; i++) {
      int victim=AppendTestUtil.nextInt(numDatanodes);
      try {
        System.out.println("Stopping datanode " + victim);
        cluster.restartDataNode(victim);
      }
 catch (      IOException e) {
        System.out.println("TestDatanodeDeath Modify exception " + e);
        assertTrue("TestDatanodeDeath Modify exception " + e,false);
        running=false;
      }
    }
    for (int i=0; i < numThreads; i++) {
      workload[i].resetStamp();
    }
  }
}
