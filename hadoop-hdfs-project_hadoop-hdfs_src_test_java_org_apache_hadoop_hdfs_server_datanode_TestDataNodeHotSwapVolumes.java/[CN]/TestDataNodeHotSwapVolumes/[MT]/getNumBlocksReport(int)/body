{
  List<List<Integer>> results=new ArrayList<List<Integer>>();
  final String bpid=cluster.getNamesystem(namesystemIdx).getBlockPoolId();
  List<Map<DatanodeStorage,BlockListAsLongs>> blockReports=cluster.getAllBlockReports(bpid);
  for (  Map<DatanodeStorage,BlockListAsLongs> datanodeReport : blockReports) {
    List<Integer> numBlocksPerDN=new ArrayList<Integer>();
    for (    BlockListAsLongs blocks : datanodeReport.values()) {
      numBlocksPerDN.add(blocks.getNumberOfBlocks());
    }
    results.add(numBlocksPerDN);
  }
  return results;
}
