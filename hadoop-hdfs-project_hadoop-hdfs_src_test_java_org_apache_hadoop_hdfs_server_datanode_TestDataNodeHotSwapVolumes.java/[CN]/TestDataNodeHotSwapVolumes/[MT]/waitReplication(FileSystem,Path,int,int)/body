{
  int attempts=50;
  while (attempts > 0) {
    if (getNumReplicas(fs,file,blockIdx) == numReplicas) {
      return;
    }
    Thread.sleep(100);
    attempts--;
  }
  throw new TimeoutException("Timed out waiting the " + blockIdx + "-th block"+ " of "+ file+ " to have "+ numReplicas+ " replicas.");
}
