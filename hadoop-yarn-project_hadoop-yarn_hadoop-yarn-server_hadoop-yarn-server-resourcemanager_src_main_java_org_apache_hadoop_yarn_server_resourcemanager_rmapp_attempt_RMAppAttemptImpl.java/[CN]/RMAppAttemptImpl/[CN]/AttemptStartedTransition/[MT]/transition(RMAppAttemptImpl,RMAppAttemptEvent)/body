{
  appAttempt.startTime=System.currentTimeMillis();
  appAttempt.masterService.registerAppAttempt(appAttempt.applicationAttemptId);
  if (UserGroupInformation.isSecurityEnabled()) {
    appAttempt.clientTokenMasterKey=appAttempt.rmContext.getClientToAMTokenSecretManager().createMasterKey(appAttempt.applicationAttemptId);
  }
  AMRMTokenIdentifier id=new AMRMTokenIdentifier(appAttempt.applicationAttemptId);
  appAttempt.amrmToken=new Token<AMRMTokenIdentifier>(id,appAttempt.rmContext.getAMRMTokenSecretManager());
  appAttempt.eventHandler.handle(new AppAttemptAddedSchedulerEvent(appAttempt.applicationAttemptId));
}
