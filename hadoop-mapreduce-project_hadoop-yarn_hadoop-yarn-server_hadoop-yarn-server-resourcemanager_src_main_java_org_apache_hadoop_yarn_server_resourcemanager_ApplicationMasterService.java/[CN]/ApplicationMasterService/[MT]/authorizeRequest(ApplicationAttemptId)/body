{
  if (!UserGroupInformation.isSecurityEnabled()) {
    return;
  }
  String appAttemptIDStr=appAttemptID.toString();
  UserGroupInformation remoteUgi;
  try {
    remoteUgi=UserGroupInformation.getCurrentUser();
  }
 catch (  IOException e) {
    String msg="Cannot obtain the user-name for ApplicationAttemptID: " + appAttemptIDStr + ". Got exception: "+ StringUtils.stringifyException(e);
    LOG.warn(msg);
    throw RPCUtil.getRemoteException(msg);
  }
  if (!remoteUgi.getUserName().equals(appAttemptIDStr)) {
    String msg="Unauthorized request from ApplicationMaster. " + "Expected ApplicationAttemptID: " + remoteUgi.getUserName() + " Found: "+ appAttemptIDStr;
    LOG.warn(msg);
    throw RPCUtil.getRemoteException(msg);
  }
}
