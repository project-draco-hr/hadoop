{
  Map<DatanodeStorage,BlockListAsLongs> blockReportMap=new HashMap<DatanodeStorage,BlockListAsLongs>();
  for (  FsVolumeImpl v : getVolumes()) {
    ReplicaMap rMap=perVolumeReplicaMap.get(v.getStorageID());
    BlockListAsLongs blockList=getBlockReportWithReplicaMap(bpid,rMap);
    blockReportMap.put(v.toDatanodeStorage(),blockList);
  }
  return blockReportMap;
}
