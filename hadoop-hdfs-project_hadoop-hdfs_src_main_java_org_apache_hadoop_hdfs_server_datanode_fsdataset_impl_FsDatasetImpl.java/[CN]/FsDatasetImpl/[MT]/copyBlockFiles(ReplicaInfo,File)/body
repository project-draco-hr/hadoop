{
  final File destDir=DatanodeUtil.idToBlockDir(destRoot,replicaInfo.getBlockId());
  final File dstFile=new File(destDir,replicaInfo.getBlockName());
  final File dstMeta=FsDatasetUtil.getMetaFile(dstFile,replicaInfo.getGenerationStamp());
  final File srcMeta=replicaInfo.getMetaFile();
  final File srcFile=replicaInfo.getBlockFile();
  try {
    FileUtils.copyFile(srcMeta,dstMeta);
  }
 catch (  IOException e) {
    throw new IOException("Failed to copy " + srcMeta + " to "+ dstMeta,e);
  }
  try {
    FileUtils.copyFile(srcFile,dstFile);
  }
 catch (  IOException e) {
    throw new IOException("Failed to copy " + srcFile + " to "+ dstFile,e);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("addBlock: Moved " + srcMeta + " to "+ dstMeta);
    LOG.debug("addBlock: Moved " + srcFile + " to "+ dstFile);
  }
  return dstMeta;
}
