{
  final File destDir=DatanodeUtil.idToBlockDir(destRoot,blockId);
  final File dstFile=new File(destDir,srcFile.getName());
  final File dstMeta=FsDatasetUtil.getMetaFile(dstFile,genStamp);
  try {
    Storage.nativeCopyFileUnbuffered(srcMeta,dstMeta,true);
  }
 catch (  IOException e) {
    throw new IOException("Failed to copy " + srcMeta + " to "+ dstMeta,e);
  }
  try {
    Storage.nativeCopyFileUnbuffered(srcFile,dstFile,true);
  }
 catch (  IOException e) {
    throw new IOException("Failed to copy " + srcFile + " to "+ dstFile,e);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Copied " + srcMeta + " to "+ dstMeta);
    LOG.debug("Copied " + srcFile + " to "+ dstFile);
  }
  return new File[]{dstMeta,dstFile};
}
