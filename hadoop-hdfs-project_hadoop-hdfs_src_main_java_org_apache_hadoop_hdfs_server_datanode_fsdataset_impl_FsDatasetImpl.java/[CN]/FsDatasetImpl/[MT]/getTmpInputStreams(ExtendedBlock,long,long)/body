{
  ReplicaInfo info=getReplicaInfo(b);
  FsVolumeReference ref=info.getVolume().obtainReference();
  try {
    File blockFile=info.getBlockFile();
    RandomAccessFile blockInFile=new RandomAccessFile(blockFile,"r");
    if (blkOffset > 0) {
      blockInFile.seek(blkOffset);
    }
    File metaFile=info.getMetaFile();
    RandomAccessFile metaInFile=new RandomAccessFile(metaFile,"r");
    if (ckoff > 0) {
      metaInFile.seek(ckoff);
    }
    InputStream blockInStream=new FileInputStream(blockInFile.getFD());
    try {
      InputStream metaInStream=new FileInputStream(metaInFile.getFD());
      return new ReplicaInputStreams(blockInStream,metaInStream,ref);
    }
 catch (    IOException e) {
      IOUtils.cleanup(null,blockInStream);
      throw e;
    }
  }
 catch (  IOException e) {
    IOUtils.cleanup(null,ref);
    throw e;
  }
}
