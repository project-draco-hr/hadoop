{
  try (AutoCloseableLock lock=datasetLock.acquire()){
    ReplicaInfo info=getReplicaInfo(b);
    FsVolumeReference ref=info.getVolume().obtainReference();
    try {
      InputStream blockInStream=info.getDataInputStream(blkOffset);
      try {
        InputStream metaInStream=info.getMetadataInputStream(metaOffset);
        return new ReplicaInputStreams(blockInStream,metaInStream,ref);
      }
 catch (      IOException e) {
        IOUtils.cleanup(null,blockInStream);
        throw e;
      }
    }
 catch (    IOException e) {
      IOUtils.cleanup(null,ref);
      throw e;
    }
  }
 }
