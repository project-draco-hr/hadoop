{
  ReplicaInfo info=getReplicaInfo(b);
  FsVolumeReference ref=info.getVolume().obtainReference();
  try {
    File blockFile=info.getBlockFile();
    RandomAccessFile blockInFile=new RandomAccessFile(blockFile,"r");
    if (blkOffset > 0) {
      blockInFile.seek(blkOffset);
    }
    File metaFile=info.getMetaFile();
    RandomAccessFile metaInFile=new RandomAccessFile(metaFile,"r");
    if (ckoff > 0) {
      metaInFile.seek(ckoff);
    }
    return new ReplicaInputStreams(blockInFile.getFD(),metaInFile.getFD(),ref);
  }
 catch (  IOException e) {
    IOUtils.cleanup(null,ref);
    throw e;
  }
}
