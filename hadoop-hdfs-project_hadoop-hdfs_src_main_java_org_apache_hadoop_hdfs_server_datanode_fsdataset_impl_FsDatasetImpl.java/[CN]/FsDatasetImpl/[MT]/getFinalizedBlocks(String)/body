{
  try (AutoCloseableLock lock=datasetLock.acquire()){
    ArrayList<ReplicaInfo> finalized=new ArrayList<ReplicaInfo>(volumeMap.size(bpid));
    for (    ReplicaInfo b : volumeMap.replicas(bpid)) {
      if (b.getState() == ReplicaState.FINALIZED) {
        finalized.add(new ReplicaBuilder(ReplicaState.FINALIZED).from(b).build());
      }
    }
    return finalized;
  }
 }
