{
  String blockFileName=Block.BLOCK_FILE_PREFIX + newBlkId;
  FsVolumeImpl v=(FsVolumeImpl)replicaInfo.getVolume();
  final File tmpDir=v.getBlockPoolSlice(bpid).getTmpDir();
  final File destDir=DatanodeUtil.idToBlockDir(tmpDir,newBlkId);
  final File dstBlockFile=new File(destDir,blockFileName);
  final File dstMetaFile=FsDatasetUtil.getMetaFile(dstBlockFile,newGS);
  return copyBlockFiles(replicaInfo.getMetaFile(),replicaInfo.getBlockFile(),dstMetaFile,dstBlockFile,true,smallBufferSize,conf);
}
