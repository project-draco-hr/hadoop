{
  String blockFileName=Block.BLOCK_FILE_PREFIX + newBlkId;
  try (FsVolumeReference ref=volumes.getNextVolume(replicaInfo.getVolume().getStorageType(),replicaInfo.getNumBytes())){
    FsVolumeImpl v=(FsVolumeImpl)ref.getVolume();
    final File tmpDir=v.getBlockPoolSlice(bpid).getTmpDir();
    final File destDir=DatanodeUtil.idToBlockDir(tmpDir,newBlkId);
    final File dstBlockFile=new File(destDir,blockFileName);
    final File dstMetaFile=FsDatasetUtil.getMetaFile(dstBlockFile,newGS);
    return copyBlockFiles(replicaInfo.getMetaFile(),replicaInfo.getBlockFile(),dstMetaFile,dstBlockFile,true);
  }
 }
