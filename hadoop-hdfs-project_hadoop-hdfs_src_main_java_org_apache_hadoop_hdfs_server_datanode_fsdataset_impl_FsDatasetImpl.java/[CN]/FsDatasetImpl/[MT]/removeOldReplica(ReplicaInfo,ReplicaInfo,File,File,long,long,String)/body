{
  ExtendedBlock extendedBlock=new ExtendedBlock(bpid,newReplicaInfo);
  datanode.getShortCircuitRegistry().processBlockInvalidation(ExtendedBlockId.fromExtendedBlock(extendedBlock));
  datanode.notifyNamenodeReceivedBlock(extendedBlock,null,newReplicaInfo.getStorageUuid());
  if (blockFile.delete() || !blockFile.exists()) {
    ((FsVolumeImpl)replicaInfo.getVolume()).decDfsUsed(bpid,blockFileUsed);
    if (metaFile.delete() || !metaFile.exists()) {
      ((FsVolumeImpl)replicaInfo.getVolume()).decDfsUsed(bpid,metaFileUsed);
    }
  }
}
