{
  ExtendedBlock extendedBlock=new ExtendedBlock(bpid,newReplicaInfo);
  datanode.getShortCircuitRegistry().processBlockInvalidation(ExtendedBlockId.fromExtendedBlock(extendedBlock));
  datanode.notifyNamenodeReceivedBlock(extendedBlock,null,newReplicaInfo.getStorageUuid(),newReplicaInfo.isOnTransientStorage());
  if (blockFile.delete() || !blockFile.exists()) {
    FsVolumeImpl volume=(FsVolumeImpl)replicaInfo.getVolume();
    volume.onBlockFileDeletion(bpid,blockFileUsed);
    if (metaFile.delete() || !metaFile.exists()) {
      volume.onMetaFileDeletion(bpid,metaFileUsed);
    }
  }
}
