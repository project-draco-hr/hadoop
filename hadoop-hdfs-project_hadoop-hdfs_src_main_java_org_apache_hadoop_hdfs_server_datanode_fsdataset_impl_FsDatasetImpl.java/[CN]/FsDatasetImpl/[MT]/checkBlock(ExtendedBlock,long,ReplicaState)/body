{
  final ReplicaInfo replicaInfo=volumeMap.get(b.getBlockPoolId(),b.getLocalBlock());
  if (replicaInfo == null) {
    throw new ReplicaNotFoundException(b);
  }
  if (replicaInfo.getState() != state) {
    throw new UnexpectedReplicaStateException(b,state);
  }
  if (!replicaInfo.blockDataExists()) {
    throw new FileNotFoundException(replicaInfo.getBlockURI().toString());
  }
  long onDiskLength=getLength(b);
  if (onDiskLength < minLength) {
    throw new EOFException(b + "'s on-disk length " + onDiskLength+ " is shorter than minLength "+ minLength);
  }
}
