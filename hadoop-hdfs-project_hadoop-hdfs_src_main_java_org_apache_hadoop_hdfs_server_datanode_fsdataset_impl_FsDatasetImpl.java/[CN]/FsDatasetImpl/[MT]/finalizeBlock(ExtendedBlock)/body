{
  try (AutoCloseableLock lock=datasetLock.acquire()){
    if (Thread.interrupted()) {
      throw new IOException("Cannot finalize block from Interrupted Thread");
    }
    ReplicaInfo replicaInfo=getReplicaInfo(b);
    if (replicaInfo.getState() == ReplicaState.FINALIZED) {
      return;
    }
    finalizeReplica(b.getBlockPoolId(),replicaInfo);
  }
 }
