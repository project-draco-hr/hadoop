{
  try (AutoCloseableLock lock=datasetLock.acquire()){
    LOG.info("Removing block pool " + bpid);
    Map<DatanodeStorage,BlockListAsLongs> blocksPerVolume=getBlockReports(bpid);
    volumeMap.cleanUpBlockPool(bpid);
    volumes.removeBlockPool(bpid,blocksPerVolume);
  }
 }
