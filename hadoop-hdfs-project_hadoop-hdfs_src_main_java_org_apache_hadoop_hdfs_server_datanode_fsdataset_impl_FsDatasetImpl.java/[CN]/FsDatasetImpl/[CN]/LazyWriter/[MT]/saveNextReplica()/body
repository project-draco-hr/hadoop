{
  BlockIdPair blockIdPair=null;
  int moreWorkThreshold=0;
  try {
synchronized (this) {
      blockIdPair=blocksPendingCheckpoint.poll();
      if (blockIdPair == null) {
        LOG.info("LazyWriter has no blocks to persist. " + "Thread going to sleep.");
        return false;
      }
    }
    moveReplicaToNewVolume(blockIdPair.bpid,blockIdPair.blockId);
  }
 catch (  IOException ioe) {
synchronized (this) {
      blocksPendingCheckpoint.add(blockIdPair);
      ++moreWorkThreshold;
    }
  }
synchronized (this) {
    return blocksPendingCheckpoint.size() > moreWorkThreshold;
  }
}
