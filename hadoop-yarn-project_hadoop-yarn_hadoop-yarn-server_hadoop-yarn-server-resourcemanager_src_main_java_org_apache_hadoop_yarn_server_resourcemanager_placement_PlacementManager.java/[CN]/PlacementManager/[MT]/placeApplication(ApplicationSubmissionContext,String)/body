{
  try {
    readLock.lock();
    if (null == rules || rules.isEmpty()) {
      return;
    }
    String newQueueName=null;
    for (    PlacementRule rule : rules) {
      newQueueName=rule.getQueueForApp(asc,user);
      if (newQueueName != null) {
        break;
      }
    }
    if (null == newQueueName && null == asc.getQueue()) {
      String msg="Failed to get where to place application=" + asc.getApplicationId();
      LOG.error(msg);
      throw new YarnException(msg);
    }
    if (!StringUtils.equals(asc.getQueue(),newQueueName)) {
      LOG.info("Placed application=" + asc.getApplicationId() + " to queue="+ newQueueName+ ", original queue="+ asc.getQueue());
      asc.setQueue(newQueueName);
    }
  }
  finally {
    readLock.unlock();
  }
}
