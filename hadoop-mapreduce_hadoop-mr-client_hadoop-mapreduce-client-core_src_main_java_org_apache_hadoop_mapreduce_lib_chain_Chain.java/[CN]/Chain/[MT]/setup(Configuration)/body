{
  String prefix=getPrefix(isMap);
  int index=jobConf.getInt(prefix + CHAIN_MAPPER_SIZE,0);
  for (int i=0; i < index; i++) {
    Class<? extends Mapper> klass=jobConf.getClass(prefix + CHAIN_MAPPER_CLASS + i,null,Mapper.class);
    Configuration mConf=getChainElementConf(jobConf,prefix + CHAIN_MAPPER_CONFIG + i);
    confList.add(mConf);
    Mapper mapper=ReflectionUtils.newInstance(klass,mConf);
    mappers.add(mapper);
  }
  Class<? extends Reducer> klass=jobConf.getClass(prefix + CHAIN_REDUCER_CLASS,null,Reducer.class);
  if (klass != null) {
    rConf=getChainElementConf(jobConf,prefix + CHAIN_REDUCER_CONFIG);
    reducer=ReflectionUtils.newInstance(klass,rConf);
  }
}
