{
  this.context.getQueuingContext().getQueuedContainers().put(containerTokenIdentifier.getContainerID(),containerTokenIdentifier);
  AllocatedContainerInfo allocatedContInfo=new AllocatedContainerInfo(containerTokenIdentifier,request,containerTokenIdentifier.getExecutionType(),containerTokenIdentifier.getResource(),getConfig());
  if (queuedGuaranteedContainers.isEmpty() && queuedOpportunisticContainers.isEmpty() && getContainersMonitor().hasResourcesAvailable(allocatedContInfo.getPti())) {
    startAllocatedContainer(allocatedContInfo);
  }
 else {
    this.context.getNMStateStore().storeContainer(containerTokenIdentifier.getContainerID(),request);
    this.context.getNMStateStore().storeContainerQueued(containerTokenIdentifier.getContainerID());
    if (allocatedContInfo.getExecutionType() == ExecutionType.GUARANTEED) {
      queuedGuaranteedContainers.add(allocatedContInfo);
      killOpportunisticContainers(allocatedContInfo);
    }
 else {
      queuedOpportunisticContainers.add(allocatedContInfo);
    }
  }
}
