{
  this.context.getQueuingContext().getQueuedContainers().put(containerTokenIdentifier.getContainerID(),containerTokenIdentifier);
  AllocatedContainerInfo allocatedContInfo=new AllocatedContainerInfo(containerTokenIdentifier,nmTokenIdentifier,request,containerTokenIdentifier.getExecutionType(),containerTokenIdentifier.getResource(),getConfig());
  if (queuedGuaranteedContainers.isEmpty() && queuedOpportunisticContainers.isEmpty() && getContainersMonitor().hasResourcesAvailable(allocatedContInfo.getPti())) {
    startAllocatedContainer(allocatedContInfo);
  }
 else {
    if (allocatedContInfo.getExecutionType() == ExecutionType.GUARANTEED) {
      queuedGuaranteedContainers.add(allocatedContInfo);
      killOpportunisticContainers(allocatedContInfo);
    }
 else {
      queuedOpportunisticContainers.add(allocatedContInfo);
    }
  }
}
