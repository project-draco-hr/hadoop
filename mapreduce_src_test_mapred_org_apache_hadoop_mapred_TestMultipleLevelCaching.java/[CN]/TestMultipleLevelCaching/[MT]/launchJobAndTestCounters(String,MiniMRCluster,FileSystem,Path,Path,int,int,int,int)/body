{
  JobConf jobConf=mr.createJobConf();
  if (fileSys.exists(out)) {
    fileSys.delete(out,true);
  }
  RunningJob job=launchJob(jobConf,in,out,numMaps,jobName);
  Counters counters=job.getCounters();
  assertEquals("Number of local maps",counters.getCounter(JobCounter.OTHER_LOCAL_MAPS),otherLocalMaps);
  assertEquals("Number of Data-local maps",counters.getCounter(JobCounter.DATA_LOCAL_MAPS),dataLocalMaps);
  assertEquals("Number of Rack-local maps",counters.getCounter(JobCounter.RACK_LOCAL_MAPS),rackLocalMaps);
  mr.waitUntilIdle();
  mr.shutdown();
}
