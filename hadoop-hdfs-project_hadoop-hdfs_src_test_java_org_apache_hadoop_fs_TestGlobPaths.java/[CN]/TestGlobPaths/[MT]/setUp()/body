{
  final Configuration conf=new HdfsConfiguration();
  dfsCluster=new MiniDFSCluster.Builder(conf).build();
  fs=FileSystem.get(conf);
  unprivilegedFs=unprivilegedUser.doAs(new PrivilegedExceptionAction<FileSystem>(){
    @Override public FileSystem run() throws IOException {
      return FileSystem.get(conf);
    }
  }
);
  fc=FileContext.getFileContext(conf);
  unprivilegedFc=unprivilegedUser.doAs(new PrivilegedExceptionAction<FileContext>(){
    @Override public FileContext run() throws IOException {
      return FileContext.getFileContext(conf);
    }
  }
);
  USER_DIR=fs.getHomeDirectory().toUri().getPath().toString();
}
