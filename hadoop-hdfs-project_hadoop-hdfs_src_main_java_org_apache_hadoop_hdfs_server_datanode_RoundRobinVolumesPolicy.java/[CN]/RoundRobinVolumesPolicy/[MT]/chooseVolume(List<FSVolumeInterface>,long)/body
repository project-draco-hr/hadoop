{
  if (volumes.size() < 1) {
    throw new DiskOutOfSpaceException("No more available volumes");
  }
  if (curVolume >= volumes.size()) {
    curVolume=0;
  }
  int startVolume=curVolume;
  long maxAvailable=0;
  while (true) {
    FSVolumeInterface volume=volumes.get(curVolume);
    curVolume=(curVolume + 1) % volumes.size();
    long availableVolumeSize=volume.getAvailable();
    if (availableVolumeSize > blockSize) {
      return volume;
    }
    if (availableVolumeSize > maxAvailable) {
      maxAvailable=availableVolumeSize;
    }
    if (curVolume == startVolume) {
      throw new DiskOutOfSpaceException("Insufficient space for an additional block. Volume with the most available space has " + maxAvailable + " bytes free, configured block size is "+ blockSize);
    }
  }
}
