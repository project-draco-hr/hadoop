{
  Collection<String> ids=conf.getTrimmedStringCollection(YarnConfiguration.RM_HA_IDS);
  if (ids.size() < 2) {
    throwBadConfigurationException(getInvalidValueMessage(YarnConfiguration.RM_HA_IDS,conf.get(YarnConfiguration.RM_HA_IDS) + "\nHA mode requires atleast two RMs"));
  }
  StringBuilder setValue=new StringBuilder();
  for (  String id : ids) {
    for (    String prefix : YarnConfiguration.RM_SERVICES_ADDRESS_CONF_KEYS) {
      String confKey=null;
      try {
        confKey=addSuffix(prefix,id);
        if (conf.getTrimmed(confKey) == null) {
          throwBadConfigurationException(getNeedToSetValueMessage(confKey));
        }
      }
 catch (      IllegalArgumentException iae) {
        String errmsg=iae.getMessage();
        if (confKey == null) {
          errmsg=getInvalidValueMessage(YarnConfiguration.RM_HA_ID,getRMHAId(conf));
        }
        throwBadConfigurationException(errmsg);
      }
    }
    setValue.append(id);
    setValue.append(",");
  }
  conf.set(YarnConfiguration.RM_HA_IDS,setValue.substring(0,setValue.length() - 1));
}
