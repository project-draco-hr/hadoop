{
  DistributedFileSystem fs=cluster.getFileSystem();
  FSDirectory fsdir=cluster.getNamesystem().getFSDirectory();
  final Path file1=new Path("/file1");
  DFSTestUtil.createFile(fs,file1,BLOCKSIZE * 2,REPLICATION,0L);
  INodeFile file1Node=fsdir.getINode4Write(file1.toString()).asFile();
  BlockInfoContiguous[] file1Blocks=file1Node.getBlocks();
  assertEquals(2,file1Blocks.length);
  assertEquals(GROUP_SIZE,file1Blocks[0].numNodes());
  assertEquals(HdfsConstants.MAX_BLOCKS_IN_GROUP,file1Blocks[1].getBlockId() - file1Blocks[0].getBlockId());
}
