{
  ContainerLocalizer localizer=setupContainerLocalizerForTest();
  doNothing().when(localizer).localizeFiles(any(LocalizationProtocol.class),any(CompletionService.class),any(UserGroupInformation.class));
  verify(localizer,never()).closeFileSystems(any(UserGroupInformation.class));
  localizer.runLocalization(nmAddr);
  verify(localizer).closeFileSystems(any(UserGroupInformation.class));
  localizer=setupContainerLocalizerForTest();
  doThrow(new YarnException("Forced Failure")).when(localizer).localizeFiles(any(LocalizationProtocol.class),any(CompletionService.class),any(UserGroupInformation.class));
  verify(localizer,never()).closeFileSystems(any(UserGroupInformation.class));
  localizer.runLocalization(nmAddr);
  verify(localizer).closeFileSystems(any(UserGroupInformation.class));
}
