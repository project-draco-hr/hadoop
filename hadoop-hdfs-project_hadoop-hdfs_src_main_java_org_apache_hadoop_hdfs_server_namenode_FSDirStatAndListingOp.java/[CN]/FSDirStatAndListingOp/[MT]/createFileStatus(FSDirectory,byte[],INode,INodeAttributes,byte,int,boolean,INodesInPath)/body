{
  long size=0;
  short replication=0;
  long blocksize=0;
  final boolean isEncrypted;
  final FileEncryptionInfo feInfo=isRawPath ? null : fsd.getFileEncryptionInfo(node,snapshot,iip);
  final ErasureCodingZoneInfo ecZoneInfo=fsd.getECZoneInfo(iip);
  final ECSchema schema=ecZoneInfo != null ? ecZoneInfo.getSchema() : null;
  final int cellSize=ecZoneInfo != null ? ecZoneInfo.getCellSize() : 0;
  if (node.isFile()) {
    final INodeFile fileNode=node.asFile();
    size=fileNode.computeFileSize(snapshot);
    replication=fileNode.getFileReplication(snapshot);
    blocksize=fileNode.getPreferredBlockSize();
    isEncrypted=(feInfo != null) || (isRawPath && fsd.isInAnEZ(INodesInPath.fromINode(node)));
  }
 else {
    isEncrypted=fsd.isInAnEZ(INodesInPath.fromINode(node));
  }
  int childrenNum=node.isDirectory() ? node.asDirectory().getChildrenNum(snapshot) : 0;
  return new HdfsFileStatus(size,node.isDirectory(),replication,blocksize,node.getModificationTime(snapshot),node.getAccessTime(snapshot),getPermissionForFileStatus(nodeAttrs,isEncrypted),nodeAttrs.getUserName(),nodeAttrs.getGroupName(),node.isSymlink() ? node.asSymlink().getSymlink() : null,path,node.getId(),childrenNum,feInfo,storagePolicy,schema,cellSize);
}
