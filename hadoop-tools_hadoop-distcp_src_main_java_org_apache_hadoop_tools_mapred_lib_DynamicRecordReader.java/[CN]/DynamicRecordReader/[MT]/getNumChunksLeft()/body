{
  long now=System.currentTimeMillis();
  boolean tooLongSinceLastDirScan=now - timeOfLastChunkDirScan > TIME_THRESHOLD_FOR_DIR_SCANS;
  if (tooLongSinceLastDirScan || (!isChunkDirAlreadyScanned && numRecordsProcessedByThisMap % numRecordsPerChunk > numRecordsPerChunk / 2)) {
    DynamicInputChunk.getListOfChunkFiles();
    isChunkDirAlreadyScanned=true;
    timeOfLastChunkDirScan=now;
  }
  return DynamicInputChunk.getNumChunksLeft();
}
