{
  if (event.getType() == ContainerAllocator.EventType.CONTAINER_REQ) {
    LOG.info("Processing the event " + event.toString());
    ContainerId cID=recordFactory.newRecordInstance(ContainerId.class);
    cID.setAppId(appID);
    cID.setId((-1) * containerCount.getAndIncrement());
    Container container=recordFactory.newRecordInstance(Container.class);
    container.setId(cID);
    NodeId nodeId=Records.newRecord(NodeId.class);
    nodeId.setHost("localhost");
    nodeId.setPort(1234);
    container.setNodeId(nodeId);
    container.setContainerToken(null);
    container.setNodeHttpAddress("localhost:9999");
    if (event.getAttemptID().getTaskId().getTaskType() == TaskType.MAP) {
      JobCounterUpdateEvent jce=new JobCounterUpdateEvent(event.getAttemptID().getTaskId().getJobId());
      jce.addCounterUpdate(JobCounter.OTHER_LOCAL_MAPS,1);
      eventHandler.handle(jce);
    }
    eventHandler.handle(new TaskAttemptContainerAssignedEvent(event.getAttemptID(),container));
  }
}
