{
  bkthread=new Thread(){
    public void run(){
      try {
        String[] args=new String[1];
        args[0]=String.valueOf(numBookies);
        LOG.info("Starting bk");
        LocalBookKeeper.main(args);
      }
 catch (      InterruptedException e) {
      }
catch (      Exception e) {
        LOG.error("Error starting local bk",e);
      }
    }
  }
;
  bkthread.start();
  if (!LocalBookKeeper.waitForServerUp(zkEnsemble,10000)) {
    throw new Exception("Error starting zookeeper/bookkeeper");
  }
  assertEquals("Not all bookies started",numBookies,checkBookiesUp(numBookies,10));
}
