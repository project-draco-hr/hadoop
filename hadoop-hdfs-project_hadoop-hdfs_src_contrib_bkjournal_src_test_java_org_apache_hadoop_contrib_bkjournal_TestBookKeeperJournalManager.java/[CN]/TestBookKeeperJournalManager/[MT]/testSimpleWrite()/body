{
  NamespaceInfo nsi=newNSInfo();
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,BKJMUtil.createJournalURI("/hdfsjournal-simplewrite"),nsi);
  bkjm.format(nsi);
  EditLogOutputStream out=bkjm.startLogSegment(1,NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION);
  for (long i=1; i <= 100; i++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(i);
    out.write(op);
  }
  out.close();
  bkjm.finalizeLogSegment(1,100);
  String zkpath=bkjm.finalizedLedgerZNode(1,100);
  assertNotNull(zkc.exists(zkpath,false));
  assertNull(zkc.exists(bkjm.inprogressZNode(1),false));
}
