{
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,URI.create("bookkeeper://" + zkEnsemble + "/hdfsjournal-txncount"));
  long txid=1;
  EditLogOutputStream out=bkjm.startLogSegment(1);
  for (long i=1; i <= 100; i++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(i);
    out.write(op);
  }
  out.close();
  bkjm.finalizeLogSegment(1,100);
  long numTrans=bkjm.getNumberOfTransactions(1);
  assertEquals(100,numTrans);
}
