{
  final CountDownLatch latch=new CountDownLatch(1);
  ZooKeeper zkc=new ZooKeeper(zkEnsemble,3600,new Watcher(){
    public void process(    WatchedEvent event){
      if (event.getState() == Watcher.Event.KeeperState.SyncConnected) {
        latch.countDown();
      }
    }
  }
);
  if (!latch.await(3,TimeUnit.SECONDS)) {
    throw new IOException("Zookeeper took too long to connect");
  }
  return zkc;
}
