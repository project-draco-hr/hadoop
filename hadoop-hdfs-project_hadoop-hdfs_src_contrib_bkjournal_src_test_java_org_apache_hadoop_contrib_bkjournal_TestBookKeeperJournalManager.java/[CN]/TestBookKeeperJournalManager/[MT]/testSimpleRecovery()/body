{
  BookKeeperJournalManager bkjm=new BookKeeperJournalManager(conf,URI.create("bookkeeper://" + zkEnsemble + "/hdfsjournal-simplerecovery"));
  EditLogOutputStream out=bkjm.startLogSegment(1);
  long txid=1;
  for (long i=1; i <= 100; i++) {
    FSEditLogOp op=FSEditLogTestUtil.getNoOpInstance();
    op.setTransactionId(i);
    out.write(op);
  }
  out.setReadyToFlush();
  out.flush();
  out.abort();
  out.close();
  assertNull(zkc.exists(bkjm.finalizedLedgerZNode(1,100),false));
  assertNotNull(zkc.exists(bkjm.inprogressZNode(1),false));
  bkjm.recoverUnfinalizedSegments();
  assertNotNull(zkc.exists(bkjm.finalizedLedgerZNode(1,100),false));
  assertNull(zkc.exists(bkjm.inprogressZNode(1),false));
}
