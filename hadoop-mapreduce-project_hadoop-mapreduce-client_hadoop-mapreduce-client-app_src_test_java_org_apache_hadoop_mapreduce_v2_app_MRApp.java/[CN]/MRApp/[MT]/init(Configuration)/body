{
  try {
    String user=UserGroupInformation.getCurrentUser().getShortUserName();
    Path stagingDir=MRApps.getStagingAreaDir(conf,user);
    FileSystem fs=getFileSystem(conf);
    fs.mkdirs(stagingDir);
  }
 catch (  Exception e) {
    throw new YarnException("Error creating staging dir",e);
  }
  super.init(conf);
  if (this.clusterInfo != null) {
    getContext().getClusterInfo().setMinContainerCapability(this.clusterInfo.getMinContainerCapability());
    getContext().getClusterInfo().setMaxContainerCapability(this.clusterInfo.getMaxContainerCapability());
  }
 else {
    getContext().getClusterInfo().setMinContainerCapability(BuilderUtils.newResource(1024));
    getContext().getClusterInfo().setMaxContainerCapability(BuilderUtils.newResource(10240));
  }
}
