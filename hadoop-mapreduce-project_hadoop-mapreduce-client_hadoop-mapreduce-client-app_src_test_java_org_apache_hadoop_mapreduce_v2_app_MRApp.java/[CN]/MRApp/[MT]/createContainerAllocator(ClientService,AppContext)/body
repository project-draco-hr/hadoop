{
  return new ContainerAllocator(){
    private int containerCount;
    @Override public void handle(    ContainerAllocatorEvent event){
      ContainerId cId=recordFactory.newRecordInstance(ContainerId.class);
      cId.setApplicationAttemptId(getContext().getApplicationAttemptId());
      cId.setId(containerCount++);
      NodeId nodeId=BuilderUtils.newNodeId("localhost",1234);
      Container container=BuilderUtils.newContainer(cId,nodeId,"localhost:9999",null,null,null);
      JobID id=TypeConverter.fromYarn(applicationId);
      JobId jobId=TypeConverter.toYarn(id);
      getContext().getEventHandler().handle(new JobHistoryEvent(jobId,new NormalizedResourceEvent(org.apache.hadoop.mapreduce.TaskType.REDUCE,100)));
      getContext().getEventHandler().handle(new JobHistoryEvent(jobId,new NormalizedResourceEvent(org.apache.hadoop.mapreduce.TaskType.MAP,100)));
      getContext().getEventHandler().handle(new TaskAttemptContainerAssignedEvent(event.getAttemptID(),container,null));
    }
  }
;
}
