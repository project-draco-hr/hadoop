{
  super(appAttemptId,amContainerId,NM_HOST,NM_PORT,NM_HTTP_PORT,clock,System.currentTimeMillis(),MRJobConfig.DEFAULT_MR_AM_MAX_ATTEMPTS);
  this.testWorkDir=new File("target",testName);
  testAbsPath=new Path(testWorkDir.getAbsolutePath());
  LOG.info("PathUsed: " + testAbsPath);
  if (cleanOnStart) {
    testAbsPath=new Path(testWorkDir.getAbsolutePath());
    try {
      FileContext.getLocalFSFileContext().delete(testAbsPath,true);
    }
 catch (    Exception e) {
      LOG.warn("COULD NOT CLEANUP: " + testAbsPath,e);
      throw new YarnRuntimeException("could not cleanup test dir",e);
    }
  }
  this.maps=maps;
  this.reduces=reduces;
  this.autoComplete=autoComplete;
  this.safeToReportTerminationToUser.set(shutdown);
}
