{
  new File(TEST_DIR).mkdirs();
  PrintWriter out=new PrintWriter(new FileWriter(ALLOC_FILE));
  out.println("<?xml version=\"1.0\"?>");
  out.println("<allocations>");
  out.println("<pool name=\"poolA\">");
  out.println("<minMaps>1</minMaps>");
  out.println("<minReduces>1</minReduces>");
  out.println("</pool>");
  out.println("</allocations>");
  out.close();
  Configuration conf=new Configuration();
  miniDFSCluster=new MiniDFSCluster(conf,1,true,null);
  namenode=miniDFSCluster.getFileSystem().getUri().toString();
  JobConf clusterConf=new JobConf();
  clusterConf.set("mapred.jobtracker.taskScheduler",FairScheduler.class.getName());
  clusterConf.set("mapred.fairscheduler.allocation.file",ALLOC_FILE);
  clusterConf.set("mapred.fairscheduler.poolnameproperty",POOL_PROPERTY);
  clusterConf.setBoolean(FairScheduler.ALLOW_UNDECLARED_POOLS_KEY,false);
  miniMRCluster=new MiniMRCluster(1,namenode,1,null,null,clusterConf);
}
