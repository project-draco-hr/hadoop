{
  try {
    testAccount=AzureBlobStorageTestAccount.createMock();
    Configuration conf=testAccount.getFileSystem().getConf();
    String authority=testAccount.getFileSystem().getUri().getAuthority();
    URI defaultUri=new URI("wasb",authority,null,null,null);
    conf.set(FS_DEFAULT_NAME_KEY,defaultUri.toString());
    conf.addResource("azure-test.xml");
    FileSystem fs=FileSystem.get(conf);
    assertTrue(fs instanceof NativeAzureFileSystem);
    assertEquals(-1,fs.getUri().getPort());
    AbstractFileSystem afs=FileContext.getFileContext(conf).getDefaultFileSystem();
    assertTrue(afs instanceof Wasb);
    assertEquals(-1,afs.getUri().getPort());
  }
  finally {
    FileSystem.closeAll();
  }
}
