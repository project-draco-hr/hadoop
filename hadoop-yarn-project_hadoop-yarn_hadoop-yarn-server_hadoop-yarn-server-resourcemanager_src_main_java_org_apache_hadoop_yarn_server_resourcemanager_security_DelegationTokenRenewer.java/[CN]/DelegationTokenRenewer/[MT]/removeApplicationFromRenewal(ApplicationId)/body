{
  rmContext.getSystemCredentialsForApps().remove(applicationId);
  Set<DelegationTokenToRenew> tokens=appTokens.get(applicationId);
  if (tokens != null && !tokens.isEmpty()) {
synchronized (tokens) {
      Iterator<DelegationTokenToRenew> it=tokens.iterator();
      while (it.hasNext()) {
        DelegationTokenToRenew dttr=it.next();
        if (LOG.isDebugEnabled()) {
          LOG.debug("Removing delegation token for appId=" + applicationId + "; token="+ dttr.token.getService());
        }
synchronized (dttr.referringAppIds) {
          dttr.referringAppIds.remove(applicationId);
          if (!dttr.referringAppIds.isEmpty()) {
            continue;
          }
        }
        dttr.cancelTimer();
        cancelToken(dttr);
        it.remove();
        allTokens.remove(dttr.token);
      }
    }
  }
  if (tokens != null && tokens.isEmpty()) {
    appTokens.remove(applicationId);
  }
}
