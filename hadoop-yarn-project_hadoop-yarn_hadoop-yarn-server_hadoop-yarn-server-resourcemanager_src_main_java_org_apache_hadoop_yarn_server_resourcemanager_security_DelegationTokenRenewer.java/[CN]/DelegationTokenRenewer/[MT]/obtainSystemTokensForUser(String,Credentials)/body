{
  UserGroupInformation proxyUser=UserGroupInformation.createProxyUser(user,UserGroupInformation.getLoginUser());
  Token<?>[] newTokens=proxyUser.doAs(new PrivilegedExceptionAction<Token<?>[]>(){
    @Override public Token<?>[] run() throws Exception {
      return FileSystem.get(getConfig()).addDelegationTokens(UserGroupInformation.getLoginUser().getUserName(),credentials);
    }
  }
);
  return newTokens;
}
