{
  BufferedInputStream bin=new BufferedInputStream(edits);
  DataInputStream in=new DataInputStream(bin);
  int numEdits=0;
  int logVersion=0;
  try {
    logVersion=readLogVersion(in);
    Checksum checksum=null;
    if (LayoutVersion.supports(Feature.EDITS_CHESKUM,logVersion)) {
      checksum=FSEditLog.getChecksum();
      in=new DataInputStream(new CheckedInputStream(bin,checksum));
    }
    numEdits=loadEditRecords(logVersion,in,checksum,false);
  }
  finally {
    if (closeOnExit)     in.close();
  }
  if (logVersion != FSConstants.LAYOUT_VERSION)   numEdits++;
  return numEdits;
}
