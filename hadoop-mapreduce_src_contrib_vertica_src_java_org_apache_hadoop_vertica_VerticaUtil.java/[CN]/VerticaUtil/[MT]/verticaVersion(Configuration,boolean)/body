{
  int ver=-1;
  try {
    VerticaConfiguration vtconfig=new VerticaConfiguration(conf);
    Connection conn=vtconfig.getConnection(output);
    DatabaseMetaData dbmd=conn.getMetaData();
    ver=dbmd.getDatabaseMajorVersion() * 100;
    ver+=dbmd.getDatabaseMinorVersion();
  }
 catch (  ClassNotFoundException e) {
    throw new IOException("Vertica Driver required to use Vertica Input or Output Formatters");
  }
catch (  SQLException e) {
    throw new IOException(e);
  }
  return ver;
}
