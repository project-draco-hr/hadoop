{
  final String rackName="rack" + rack;
  final int nid=hostnum;
  final String nodeAddr=hostName + ":" + nid;
  final int port=123;
  if (hostName == null) {
    hostName="host" + nid;
  }
  final NodeId nodeID=newNodeID(hostName,port);
  final String httpAddress=httpAddr;
  final NodeHealthStatus nodeHealthStatus=recordFactory.newRecordInstance(NodeHealthStatus.class);
  if (state != NodeState.UNHEALTHY) {
    nodeHealthStatus.setIsNodeHealthy(true);
    nodeHealthStatus.setHealthReport("HealthyMe");
  }
  return new MockRMNodeImpl(nodeID,nodeAddr,httpAddress,perNode,rackName,nodeHealthStatus,nid,hostName,state);
}
