{
  final String rackName="rack" + rack;
  final int nid=hostnum;
  final String nodeAddr=hostName + ":" + nid;
  if (hostName == null) {
    hostName="host" + nid;
  }
  final NodeId nodeID=NodeId.newInstance(hostName,port);
  final String httpAddress=httpAddr;
  String healthReport=(state == NodeState.UNHEALTHY) ? null : "HealthyMe";
  return new MockRMNodeImpl(nodeID,nodeAddr,httpAddress,perNode,rackName,healthReport,0,nid,hostName,state);
}
