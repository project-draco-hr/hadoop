{
  float numTasks=tasks.size();
  if (numTasks == 0) {
    return true;
  }
  int speculativeTaskCount=type == TaskType.MAP ? speculativeMapTasks : speculativeReduceTasks;
  if (speculativeTaskCount < MIN_SPEC_CAP) {
    return false;
  }
  ClusterStatus c=jobtracker.getClusterStatus(false);
  int numSlots=(type == TaskType.MAP ? c.getMaxMapTasks() : c.getMaxReduceTasks());
  if ((float)speculativeTaskCount < numSlots * MIN_SLOTS_CAP) {
    return false;
  }
  boolean atCap=(((float)(speculativeTaskCount) / numTasks) >= speculativeCap);
  if (LOG.isDebugEnabled()) {
    LOG.debug("SpeculativeCap is " + speculativeCap + ", specTasks/numTasks is "+ ((float)(speculativeTaskCount) / numTasks)+ ", so atSpecCap() is returning "+ atCap);
  }
  return atCap;
}
