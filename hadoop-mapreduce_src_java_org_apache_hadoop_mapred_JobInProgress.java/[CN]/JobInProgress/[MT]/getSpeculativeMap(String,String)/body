{
  Set<TaskInProgress> allTips=new HashSet<TaskInProgress>();
  Collection<Node> nodesAtMaxLevel=jobtracker.getNodesAtMaxLevel();
  for (  Node parent : nodesAtMaxLevel) {
    Set<TaskInProgress> cache=runningMapCache.get(parent);
    if (cache != null) {
      allTips.addAll(cache);
    }
  }
  allTips.addAll(nonLocalRunningMaps);
  TaskInProgress tip=findSpeculativeTask(allTips,taskTrackerName,taskTrackerHost,TaskType.MAP);
  if (tip != null) {
    LOG.info("Choosing map task " + tip.getTIPId() + " for speculative execution");
  }
 else {
    if (LOG.isDebugEnabled()) {
      LOG.debug("No speculative map task found for tracker " + taskTrackerName);
    }
  }
  return tip;
}
