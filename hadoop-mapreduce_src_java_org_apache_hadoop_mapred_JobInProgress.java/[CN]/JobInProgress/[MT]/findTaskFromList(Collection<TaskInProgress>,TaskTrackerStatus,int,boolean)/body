{
  Iterator<TaskInProgress> iter=tips.iterator();
  while (iter.hasNext()) {
    TaskInProgress tip=iter.next();
    if (tip.isRunnable() && !tip.isRunning()) {
      if (!tip.hasFailedOnMachine(ttStatus.getHost()) || tip.getNumberOfFailedMachines() >= numUniqueHosts) {
        iter.remove();
        return tip;
      }
 else       if (removeFailedTip) {
        iter.remove();
      }
    }
 else {
      iter.remove();
    }
  }
  return null;
}
