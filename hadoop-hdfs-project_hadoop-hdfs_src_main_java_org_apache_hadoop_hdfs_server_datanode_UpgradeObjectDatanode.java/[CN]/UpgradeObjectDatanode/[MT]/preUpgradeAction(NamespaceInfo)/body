{
  int nsUpgradeVersion=nsInfo.getDistributedUpgradeVersion();
  if (nsUpgradeVersion >= getVersion())   return false;
  String errorMsg="\n   Data-node missed a distributed upgrade and will shutdown." + "\n   " + getDescription() + "."+ " Name-node version = "+ nsInfo.getLayoutVersion()+ ".";
  DataNode.LOG.fatal(errorMsg);
  String bpid=nsInfo.getBlockPoolID();
  dataNode.trySendErrorReport(bpid,DatanodeProtocol.NOTIFY,errorMsg);
  throw new IOException(errorMsg);
}
