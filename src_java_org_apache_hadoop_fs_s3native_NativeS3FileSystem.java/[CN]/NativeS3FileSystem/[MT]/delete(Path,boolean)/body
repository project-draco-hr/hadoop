{
  FileStatus status;
  try {
    status=getFileStatus(f);
  }
 catch (  FileNotFoundException e) {
    return false;
  }
  Path absolutePath=makeAbsolute(f);
  String key=pathToKey(absolutePath);
  if (status.isDir()) {
    FileStatus[] contents=listStatus(f);
    if (!recursive && contents.length > 0) {
      throw new IOException("Directory " + f.toString() + " is not empty.");
    }
    for (    FileStatus p : contents) {
      if (!delete(p.getPath(),recursive)) {
        return false;
      }
    }
    store.delete(key + FOLDER_SUFFIX);
  }
 else {
    store.delete(key);
  }
  return true;
}
