{
  final InputStreamAndFileLength fin=openInputStream(position);
  if (fin.length != null && length + position > fin.length) {
    throw new EOFException("The length to read " + length + " exceeds the file length "+ fin.length);
  }
  try {
    int nread=0;
    while (nread < length) {
      int nbytes=fin.in.read(buffer,offset + nread,length - nread);
      if (nbytes < 0) {
        throw new EOFException("End of file reached before reading fully.");
      }
      nread+=nbytes;
    }
  }
  finally {
    fin.in.close();
  }
}
