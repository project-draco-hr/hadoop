{
  JobConf job=new JobConf(mr.getConfig());
  FileSystem fileSys=FileSystem.get(job);
  Path testDir=new Path(TEST_ROOT_DIR + "/test_mini_mr_local");
  Path outDir=new Path(testDir,"out");
  System.out.println("testDir= " + testDir);
  fileSys.delete(testDir,true);
  job.setInputFormat(MyInputFormat.class);
  job.setOutputFormat(MyOutputFormat.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(IntWritable.class);
  job.setMapperClass(MyMapper.class);
  job.setReducerClass(MyReducer.class);
  job.setNumMapTasks(100);
  job.setNumReduceTasks(1);
  job.set("non.std.out",outDir.toString());
  try {
    JobClient.runJob(job);
    assertTrue(false);
  }
 catch (  IOException ie) {
    System.out.println("Failed job " + StringUtils.stringifyException(ie));
  }
 finally {
    fileSys.delete(testDir,true);
  }
}
