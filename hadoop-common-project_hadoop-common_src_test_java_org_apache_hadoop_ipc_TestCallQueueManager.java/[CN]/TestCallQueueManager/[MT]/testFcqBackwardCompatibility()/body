{
  Configuration conf=new Configuration();
  final String ns=CommonConfigurationKeys.IPC_NAMESPACE + ".0";
  final String queueClassName="org.apache.hadoop.ipc.FairCallQueue";
  conf.setStrings(ns + "." + CommonConfigurationKeys.IPC_CALLQUEUE_IMPL_KEY,queueClassName);
  Class<? extends RpcScheduler> scheduler=Server.getSchedulerClass(ns,conf);
  assertTrue(scheduler.getCanonicalName().equals("org.apache.hadoop.ipc.DecayRpcScheduler"));
  Class<? extends BlockingQueue<FakeCall>> queue=(Class<? extends BlockingQueue<FakeCall>>)getQueueClass(ns,conf);
  assertTrue(queue.getCanonicalName().equals(queueClassName));
  manager=new CallQueueManager<FakeCall>(queue,scheduler,false,8,"",conf);
  assertCanPut(manager,3,3);
}
