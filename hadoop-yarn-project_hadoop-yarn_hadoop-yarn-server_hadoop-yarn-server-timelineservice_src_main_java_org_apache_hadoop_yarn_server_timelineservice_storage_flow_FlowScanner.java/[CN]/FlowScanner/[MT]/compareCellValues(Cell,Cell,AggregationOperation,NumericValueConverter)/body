{
  if (previouslyChosenCell == null) {
    return currentCell;
  }
  try {
    Number previouslyChosenCellValue=(Number)converter.decodeValue(CellUtil.cloneValue(previouslyChosenCell));
    Number currentCellValue=(Number)converter.decodeValue(CellUtil.cloneValue(currentCell));
switch (currentAggOp) {
case MIN:
      if (converter.compare(currentCellValue,previouslyChosenCellValue) < 0) {
        return currentCell;
      }
 else {
        return previouslyChosenCell;
      }
case MAX:
    if (converter.compare(currentCellValue,previouslyChosenCellValue) > 0) {
      return currentCell;
    }
 else {
      return previouslyChosenCell;
    }
default :
  return currentCell;
}
}
 catch (IllegalArgumentException iae) {
LOG.error("caught iae during conversion to long ",iae);
return currentCell;
}
}
