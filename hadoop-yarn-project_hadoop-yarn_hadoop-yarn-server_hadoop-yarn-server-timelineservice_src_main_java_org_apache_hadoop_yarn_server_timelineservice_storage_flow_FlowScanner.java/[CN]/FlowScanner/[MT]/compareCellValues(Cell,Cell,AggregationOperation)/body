{
  if (previouslyChosenCell == null) {
    return currentCell;
  }
  try {
    long previouslyChosenCellValue=((Number)GenericObjectMapper.read(CellUtil.cloneValue(previouslyChosenCell))).longValue();
    long currentCellValue=((Number)GenericObjectMapper.read(CellUtil.cloneValue(currentCell))).longValue();
switch (currentAggOp) {
case MIN:
      if (currentCellValue < previouslyChosenCellValue) {
        return currentCell;
      }
 else {
        return previouslyChosenCell;
      }
case MAX:
    if (currentCellValue > previouslyChosenCellValue) {
      return currentCell;
    }
 else {
      return previouslyChosenCell;
    }
default :
  return currentCell;
}
}
 catch (IllegalArgumentException iae) {
LOG.error("caught iae during conversion to long ",iae);
return currentCell;
}
}
