{
  if (currentAggOp == null) {
    currentColumnCells.add(cell);
    nextCell(limit);
    return;
  }
switch (currentAggOp) {
case GLOBAL_MIN:
    if (currentColumnCells.size() == 0) {
      currentColumnCells.add(cell);
    }
 else {
      Cell currentMinCell=currentColumnCells.first();
      Cell newMinCell=compareCellValues(currentMinCell,cell,currentAggOp,converter);
      if (!currentMinCell.equals(newMinCell)) {
        currentColumnCells.remove(currentMinCell);
        currentColumnCells.add(newMinCell);
      }
    }
  break;
case GLOBAL_MAX:
if (currentColumnCells.size() == 0) {
  currentColumnCells.add(cell);
}
 else {
  Cell currentMaxCell=currentColumnCells.first();
  Cell newMaxCell=compareCellValues(currentMaxCell,cell,currentAggOp,converter);
  if (!currentMaxCell.equals(newMaxCell)) {
    currentColumnCells.remove(currentMaxCell);
    currentColumnCells.add(newMaxCell);
  }
}
break;
case SUM:
case SUM_FINAL:
if (LOG.isTraceEnabled()) {
LOG.trace("In collect cells " + " FlowSannerOperation=" + this.action + " currentAggOp="+ currentAggOp+ " cell qualifier="+ Bytes.toString(CellUtil.cloneQualifier(cell))+ " cell value= "+ converter.decodeValue(CellUtil.cloneValue(cell))+ " timestamp="+ cell.getTimestamp());
}
List<Tag> tags=Tag.asList(cell.getTagsArray(),cell.getTagsOffset(),cell.getTagsLength());
String aggDim=TimelineStorageUtils.getAggregationCompactionDimension(tags);
if (!alreadySeenAggDim.contains(aggDim)) {
currentColumnCells.add(cell);
alreadySeenAggDim.add(aggDim);
}
break;
default :
break;
}
}
