{
  Credentials ts=context.getCredentials();
  Collection<Token<? extends TokenIdentifier>> dts=ts.getAllTokens();
  if (dts.size() != 2) {
    throw new RuntimeException("tokens are not available");
  }
  Token<? extends TokenIdentifier> dt=ts.getToken(new Text("Hdfs"));
  String tokenFile=context.getConfiguration().get("mapreduce.job.credentials.binary");
  Credentials cred=new Credentials();
  cred.readTokenStorageStream(new DataInputStream(new FileInputStream(tokenFile)));
  for (  Token<? extends TokenIdentifier> t : cred.getAllTokens()) {
    if (!dt.equals(t)) {
      throw new RuntimeException("Delegation token in job is not same as the token passed in file." + " tokenInFile=" + t + ", dt="+ dt);
    }
  }
  super.map(key,value,context);
}
