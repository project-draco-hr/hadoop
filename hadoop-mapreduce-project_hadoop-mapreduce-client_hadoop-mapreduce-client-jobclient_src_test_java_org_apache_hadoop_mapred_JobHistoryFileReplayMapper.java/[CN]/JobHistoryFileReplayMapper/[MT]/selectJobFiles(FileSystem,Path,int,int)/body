{
  Map<String,JobFiles> jobs=new HashMap<>();
  RemoteIterator<LocatedFileStatus> it=fs.listFiles(processingRoot,true);
  while (it.hasNext()) {
    LocatedFileStatus status=it.next();
    Path path=status.getPath();
    String fileName=path.getName();
    Matcher m=JOB_ID_PARSER.matcher(fileName);
    if (!m.matches()) {
      continue;
    }
    String jobId=m.group(1);
    int lastId=Integer.parseInt(m.group(2));
    int mod=lastId % size;
    if (mod != i) {
      continue;
    }
    LOG.info("this mapper will process file " + fileName);
    JobFiles jobFiles=jobs.get(jobId);
    if (jobFiles == null) {
      jobFiles=new JobFiles(jobId);
      jobs.put(jobId,jobFiles);
    }
    setFilePath(fileName,path,jobFiles);
  }
  return jobs.values();
}
