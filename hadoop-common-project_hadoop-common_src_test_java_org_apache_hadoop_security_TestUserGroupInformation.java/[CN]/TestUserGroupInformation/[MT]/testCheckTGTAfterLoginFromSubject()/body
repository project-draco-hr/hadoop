{
  SecurityUtil.setAuthenticationMethod(AuthenticationMethod.KERBEROS,conf);
  UserGroupInformation.setConfiguration(conf);
  final Subject subject=new Subject();
  KeyTab keytab=KeyTab.getInstance();
  subject.getPrivateCredentials().add(keytab);
  UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
  ugi.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws IOException {
      UserGroupInformation.loginUserFromSubject(subject);
      UserGroupInformation.getLoginUser().checkTGTAndReloginFromKeytab();
      return null;
    }
  }
);
}
