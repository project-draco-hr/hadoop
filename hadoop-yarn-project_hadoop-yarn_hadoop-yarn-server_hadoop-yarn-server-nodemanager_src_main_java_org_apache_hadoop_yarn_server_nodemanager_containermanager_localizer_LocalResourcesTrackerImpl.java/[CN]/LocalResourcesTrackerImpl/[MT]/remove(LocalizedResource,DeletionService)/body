{
  LocalizedResource rsrc=localrsrc.get(rem.getRequest());
  if (null == rsrc) {
    LOG.error("Attempt to remove absent resource: " + rem.getRequest() + " from "+ getUser());
    return true;
  }
  if (rsrc.getRefCount() > 0 || ResourceState.DOWNLOADING.equals(rsrc.getState()) || rsrc != rem) {
    LOG.error("Attempt to remove resource: " + rsrc + " with non-zero refcount");
    return false;
  }
 else {
    localrsrc.remove(rem.getRequest());
    if (ResourceState.LOCALIZED.equals(rsrc.getState())) {
      delService.delete(getUser(),getPathToDelete(rsrc.getLocalPath()));
    }
    decrementFileCountForLocalCacheDirectory(rem.getRequest(),rsrc);
    return true;
  }
}
