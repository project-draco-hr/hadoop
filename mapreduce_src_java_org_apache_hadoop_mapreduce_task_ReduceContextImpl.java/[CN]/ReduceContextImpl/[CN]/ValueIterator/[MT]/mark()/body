{
  if (backupStore == null) {
    backupStore=new BackupStore<KEYIN,VALUEIN>(conf,taskid);
  }
  isMarked=true;
  if (!inReset) {
    backupStore.reinitialize();
    if (currentKeyLength == -1) {
      return;
    }
    assert(currentValueLength != -1);
    int requestedSize=currentKeyLength + currentValueLength + WritableUtils.getVIntSize(currentKeyLength)+ WritableUtils.getVIntSize(currentValueLength);
    DataOutputStream out=backupStore.getOutputStream(requestedSize);
    writeFirstKeyValueBytes(out);
    backupStore.updateCounters(requestedSize);
  }
 else {
    backupStore.mark();
  }
}
