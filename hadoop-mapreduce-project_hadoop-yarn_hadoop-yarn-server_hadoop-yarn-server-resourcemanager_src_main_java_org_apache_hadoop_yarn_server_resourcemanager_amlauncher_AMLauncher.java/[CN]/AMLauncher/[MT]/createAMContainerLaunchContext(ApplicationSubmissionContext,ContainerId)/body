{
  ContainerLaunchContext container=recordFactory.newRecordInstance(ContainerLaunchContext.class);
  container.setCommands(applicationMasterContext.getCommandList());
  StringBuilder mergedCommand=new StringBuilder();
  String failCount=Integer.toString(application.getAppAttemptId().getAttemptId());
  List<String> commandList=new ArrayList<String>();
  for (  String str : container.getCommands()) {
    String result=str.replaceFirst(ApplicationConstants.AM_FAIL_COUNT_STRING,failCount);
    mergedCommand.append(result).append(" ");
    commandList.add(result);
  }
  container.setCommands(commandList);
  LOG.info("Command to launch container " + containerID + " : "+ mergedCommand);
  Map<String,String> environment=applicationMasterContext.getAllEnvironment();
  environment.putAll(setupTokensInEnv(applicationMasterContext));
  container.setEnv(environment);
  container.setContainerId(containerID);
  container.setUser(applicationMasterContext.getUser());
  container.setResource(applicationMasterContext.getMasterCapability());
  container.setLocalResources(applicationMasterContext.getAllResourcesTodo());
  container.setContainerTokens(applicationMasterContext.getFsTokensTodo());
  return container;
}
