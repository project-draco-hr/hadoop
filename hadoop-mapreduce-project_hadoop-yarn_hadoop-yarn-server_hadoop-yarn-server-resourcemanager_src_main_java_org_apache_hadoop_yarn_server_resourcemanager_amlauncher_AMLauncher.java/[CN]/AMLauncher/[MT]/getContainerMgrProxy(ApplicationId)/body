{
  Container container=application.getMasterContainer();
  final String containerManagerBindAddress=container.getNodeId().toString();
  final YarnRPC rpc=YarnRPC.create(conf);
  UserGroupInformation currentUser=UserGroupInformation.createRemoteUser("TODO");
  if (UserGroupInformation.isSecurityEnabled()) {
    ContainerToken containerToken=container.getContainerToken();
    Token<ContainerTokenIdentifier> token=new Token<ContainerTokenIdentifier>(containerToken.getIdentifier().array(),containerToken.getPassword().array(),new Text(containerToken.getKind()),new Text(containerToken.getService()));
    currentUser.addToken(token);
  }
  return currentUser.doAs(new PrivilegedAction<ContainerManager>(){
    @Override public ContainerManager run(){
      return (ContainerManager)rpc.getProxy(ContainerManager.class,NetUtils.createSocketAddr(containerManagerBindAddress),conf);
    }
  }
);
}
