{
  if (exists(f) && !overwrite) {
    throw new FileAlreadyExistsException("File already exists: " + f);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Creating new file '" + f + "' in S3");
  }
  Path absolutePath=makeAbsolute(f);
  String key=pathToKey(absolutePath);
  return new FSDataOutputStream(new NativeS3FsOutputStream(getConf(),store,key,progress,bufferSize),statistics);
}
