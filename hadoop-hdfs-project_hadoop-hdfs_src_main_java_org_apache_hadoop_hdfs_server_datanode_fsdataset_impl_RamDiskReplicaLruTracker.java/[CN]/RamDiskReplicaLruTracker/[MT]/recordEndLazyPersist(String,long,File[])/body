{
  Map<Long,RamDiskReplicaLru> map=replicaMaps.get(bpid);
  RamDiskReplicaLru ramDiskReplicaLru=map.get(blockId);
  if (ramDiskReplicaLru == null) {
    throw new IllegalStateException("Unknown replica bpid=" + bpid + "; blockId="+ blockId);
  }
  ramDiskReplicaLru.recordSavedBlockFiles(savedFiles);
  if (replicasNotPersisted.peek() == ramDiskReplicaLru) {
    replicasNotPersisted.remove();
  }
 else {
    replicasNotPersisted.remove(ramDiskReplicaLru);
  }
  ramDiskReplicaLru.lastUsedTime=Time.monotonicNow();
  replicasPersisted.put(ramDiskReplicaLru.lastUsedTime,ramDiskReplicaLru);
  ramDiskReplicaLru.isPersisted=true;
}
