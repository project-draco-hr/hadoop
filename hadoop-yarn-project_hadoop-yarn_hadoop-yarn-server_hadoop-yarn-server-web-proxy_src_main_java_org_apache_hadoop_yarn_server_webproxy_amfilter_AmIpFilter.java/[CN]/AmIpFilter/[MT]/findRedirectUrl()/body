{
  String addr;
  if (proxyUriBases.size() == 1) {
    addr=proxyUriBases.values().iterator().next();
  }
 else {
    YarnConfiguration conf=new YarnConfiguration();
    String activeRMId=RMHAUtils.findActiveRMHAId(conf);
    String addressPropertyPrefix=YarnConfiguration.useHttps(conf) ? YarnConfiguration.RM_WEBAPP_HTTPS_ADDRESS : YarnConfiguration.RM_WEBAPP_ADDRESS;
    String host=conf.get(HAUtil.addSuffix(addressPropertyPrefix,activeRMId));
    addr=proxyUriBases.get(host);
  }
  if (addr == null) {
    throw new ServletException("Could not determine the proxy server for redirection");
  }
  return addr;
}
