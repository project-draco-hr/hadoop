{
  String sLog;
  if (checkIP) {
    sLog=RMAuditLogger.createSuccessLog(USER,OPERATION,TARGET,appId,attemptId,containerId,resource,callerContext,remoteIp);
  }
 else {
    sLog=RMAuditLogger.createSuccessLog(USER,OPERATION,TARGET,appId,attemptId,containerId,resource,callerContext,null);
  }
  StringBuilder expLog=new StringBuilder();
  expLog.append("USER=test\t");
  if (checkIP) {
    InetAddress ip;
    if (remoteIp != null) {
      ip=remoteIp;
    }
 else {
      ip=Server.getRemoteIp();
    }
    expLog.append(Keys.IP.name() + "=" + ip.getHostAddress()+ "\t");
  }
  expLog.append("OPERATION=oper\tTARGET=tgt\tRESULT=SUCCESS");
  if (appId != null) {
    expLog.append("\tAPPID=app_1");
  }
  if (attemptId != null) {
    expLog.append("\tAPPATTEMPTID=app_attempt_1");
  }
  if (containerId != null) {
    expLog.append("\tCONTAINERID=container_1");
  }
  if (resource != null) {
    expLog.append("\tRESOURCE=<memory:1536, vcores:1>");
  }
  if (callerContext != null) {
    if (callerContext.getContext() != null) {
      expLog.append("\tCALLERCONTEXT=context");
    }
    if (callerContext.getSignature() != null) {
      expLog.append("\tCALLERSIGNATURE=signature");
    }
  }
  assertEquals(expLog.toString(),sLog);
}
