{
  String fLog=RMAuditLogger.createFailureLog(USER,OPERATION,PERM,TARGET,DESC,appId,attemptId,containerId,callerContext);
  StringBuilder expLog=new StringBuilder();
  expLog.append("USER=test\t");
  if (checkIP) {
    InetAddress ip=Server.getRemoteIp();
    expLog.append(Keys.IP.name() + "=" + ip.getHostAddress()+ "\t");
  }
  expLog.append("OPERATION=oper\tTARGET=tgt\tRESULT=FAILURE\t");
  expLog.append("DESCRIPTION=description of an audit log");
  expLog.append("\tPERMISSIONS=admin group");
  if (appId != null) {
    expLog.append("\tAPPID=app_1");
  }
  if (attemptId != null) {
    expLog.append("\tAPPATTEMPTID=app_attempt_1");
  }
  if (containerId != null) {
    expLog.append("\tCONTAINERID=container_1");
  }
  if (callerContext != null) {
    if (callerContext.getContext() != null) {
      expLog.append("\tCALLERCONTEXT=context");
    }
    if (callerContext.getSignature() != null) {
      expLog.append("\tCALLERSIGNATURE=signature");
    }
  }
  assertEquals(expLog.toString(),fLog);
}
