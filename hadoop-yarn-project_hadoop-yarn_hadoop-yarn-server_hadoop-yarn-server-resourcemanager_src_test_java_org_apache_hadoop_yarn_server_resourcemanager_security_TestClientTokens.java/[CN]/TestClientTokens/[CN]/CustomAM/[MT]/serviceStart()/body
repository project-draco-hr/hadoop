{
  Configuration conf=getConfig();
  ClientToAMTokenSecretManager secretManager=null;
  byte[] bytes=Base64.decodeBase64(this.secretKey);
  secretManager=new ClientToAMTokenSecretManager(this.appAttemptId,bytes);
  Server server;
  try {
    server=new RPC.Builder(conf).setProtocol(CustomProtocol.class).setNumHandlers(1).setSecretManager(secretManager).setInstance(this).build();
  }
 catch (  Exception e) {
    throw new YarnRuntimeException(e);
  }
  server.start();
  this.address=NetUtils.getConnectAddress(server);
  super.serviceStart();
}
