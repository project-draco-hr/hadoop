{
  if (!(new File(MiniMRYarnCluster.APPJAR)).exists()) {
    LOG.info("MRAppJar " + MiniMRYarnCluster.APPJAR + " not found. Not running test.");
    return;
  }
  Path first=createTempFile("distributed.first","x");
  Path second=makeJar(new Path(TEST_ROOT_DIR,"distributed.second.jar"),2);
  Path third=makeJar(new Path(TEST_ROOT_DIR,"distributed.third.jar"),3);
  Path fourth=makeJar(new Path(TEST_ROOT_DIR,"distributed.fourth.jar"),4);
  Job job=Job.getInstance(mrCluster.getConfig());
  job.setJar(jobJarPath);
  if (withWildcard) {
    Path libs=new Path("testLibs");
    Path wildcard=remoteFs.makeQualified(new Path(libs,"*"));
    remoteFs.mkdirs(libs);
    remoteFs.copyFromLocalFile(third,libs);
    job.addCacheFile(wildcard.toUri());
  }
 else {
    Path distributedCacheCheckerJar=new Path(JarFinder.getJar(DistributedCacheChecker.class));
    job.addFileToClassPath(localFs.makeQualified(distributedCacheCheckerJar));
  }
  job.setMapperClass(DistributedCacheChecker.class);
  job.setOutputFormatClass(NullOutputFormat.class);
  FileInputFormat.setInputPaths(job,first);
  job.addCacheFile(new URI(first.toUri().toString() + "#distributed.first.symlink"));
  job.addFileToClassPath(second);
  job.addFileToClassPath(APP_JAR.makeQualified(localFs.getUri(),APP_JAR.getParent()));
  job.addArchiveToClassPath(third);
  job.addCacheArchive(fourth.toUri());
  job.setMaxMapAttempts(1);
  job.submit();
  String trackingUrl=job.getTrackingURL();
  String jobId=job.getJobID().toString();
  Assert.assertTrue(job.waitForCompletion(false));
  Assert.assertTrue("Tracking URL was " + trackingUrl + " but didn't Match Job ID "+ jobId,trackingUrl.endsWith(jobId.substring(jobId.lastIndexOf("_")) + "/"));
}
