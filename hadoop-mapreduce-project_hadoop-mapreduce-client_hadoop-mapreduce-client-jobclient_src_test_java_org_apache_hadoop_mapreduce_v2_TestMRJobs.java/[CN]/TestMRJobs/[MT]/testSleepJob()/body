{
  LOG.info("\n\n\nStarting testSleepJob().");
  if (!(new File(MiniMRYarnCluster.APPJAR)).exists()) {
    LOG.info("MRAppJar " + MiniMRYarnCluster.APPJAR + " not found. Not running test.");
    return;
  }
  Configuration sleepConf=new Configuration(mrCluster.getConfig());
  sleepConf.set(MRConfig.MASTER_ADDRESS,"local");
  SleepJob sleepJob=new SleepJob();
  sleepJob.setConf(sleepConf);
  int numReduces=sleepConf.getInt("TestMRJobs.testSleepJob.reduces",2);
  Job job=sleepJob.createJob(3,numReduces,10000,1,5000,1);
  job.addFileToClassPath(APP_JAR);
  job.setJarByClass(SleepJob.class);
  job.setMaxMapAttempts(1);
  job.submit();
  String trackingUrl=job.getTrackingURL();
  String jobId=job.getJobID().toString();
  boolean succeeded=job.waitForCompletion(true);
  Assert.assertTrue(succeeded);
  Assert.assertEquals(JobStatus.State.SUCCEEDED,job.getJobState());
  Assert.assertTrue("Tracking URL was " + trackingUrl + " but didn't Match Job ID "+ jobId,trackingUrl.endsWith(jobId.substring(jobId.lastIndexOf("_")) + "/"));
  verifySleepJobCounters(job);
  verifyTaskProgress(job);
}
