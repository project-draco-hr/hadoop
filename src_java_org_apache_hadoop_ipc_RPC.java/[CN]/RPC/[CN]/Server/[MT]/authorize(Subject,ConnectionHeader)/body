{
  if (authorize) {
    Class<?> protocol=null;
    try {
      protocol=getProtocolClass(connection.getProtocol(),getConf());
    }
 catch (    ClassNotFoundException cfne) {
      throw new AuthorizationException("Unknown protocol: " + connection.getProtocol());
    }
    ServiceAuthorizationManager.authorize(user,protocol);
  }
}
