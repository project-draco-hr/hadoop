{
  UserGroupInformation ugi=null;
  try {
    ugi=UserGroupInformation.login(conf);
  }
 catch (  LoginException le) {
    throw new RuntimeException("Couldn't login!");
  }
  return getProxy(protocol,clientVersion,addr,ugi,conf,factory);
}
