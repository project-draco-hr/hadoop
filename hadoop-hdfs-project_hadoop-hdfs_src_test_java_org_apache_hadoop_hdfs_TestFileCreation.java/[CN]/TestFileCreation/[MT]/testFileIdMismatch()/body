{
  Configuration conf=new HdfsConfiguration();
  MiniDFSCluster cluster=new MiniDFSCluster.Builder(conf).numDataNodes(3).build();
  DistributedFileSystem dfs=null;
  try {
    cluster.waitActive();
    dfs=(DistributedFileSystem)cluster.getFileSystem();
    DFSClient client=dfs.dfs;
    final Path f=new Path("/testFileIdMismatch.txt");
    createFile(dfs,f,3);
    long someOtherFileId=-1;
    try {
      cluster.getNameNodeRpc().complete(f.toString(),client.clientName,null,someOtherFileId);
      fail();
    }
 catch (    FileNotFoundException fnf) {
      FileSystem.LOG.info("Caught Expected FileNotFoundException: ",fnf);
    }
  }
  finally {
    IOUtils.closeStream(dfs);
    cluster.shutdown();
  }
}
