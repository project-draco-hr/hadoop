{
  Path appLogDir=logAggregationService.getRemoteAppLogDir(appId,this.user);
  RemoteIterator<FileStatus> nodeFiles=null;
  try {
    Path qualifiedLogDir=FileContext.getFileContext(this.conf).makeQualified(appLogDir);
    nodeFiles=FileContext.getFileContext(qualifiedLogDir.toUri(),this.conf).listStatus(appLogDir);
  }
 catch (  FileNotFoundException fnf) {
    return -1;
  }
  int count=0;
  while (nodeFiles.hasNext()) {
    FileStatus status=nodeFiles.next();
    String filename=status.getPath().getName();
    if (filename.contains(LogAggregationUtils.TMP_FILE_SUFFIX)) {
      return -1;
    }
    if (filename.contains(LogAggregationUtils.getNodeString(logAggregationService.getNodeId()))) {
      count++;
    }
  }
  return count;
}
