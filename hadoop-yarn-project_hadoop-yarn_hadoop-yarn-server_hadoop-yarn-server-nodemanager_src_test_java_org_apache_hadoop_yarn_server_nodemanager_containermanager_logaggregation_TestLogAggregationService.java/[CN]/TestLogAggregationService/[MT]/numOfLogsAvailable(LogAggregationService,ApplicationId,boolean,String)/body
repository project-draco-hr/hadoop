{
  Path appLogDir=logAggregationService.getRemoteAppLogDir(appId,this.user);
  RemoteIterator<FileStatus> nodeFiles=null;
  try {
    Path qualifiedLogDir=FileContext.getFileContext(this.conf).makeQualified(appLogDir);
    nodeFiles=FileContext.getFileContext(qualifiedLogDir.toUri(),this.conf).listStatus(appLogDir);
  }
 catch (  FileNotFoundException fnf) {
    LOG.info("Context file not vailable: " + fnf);
    return -1;
  }
  int count=0;
  while (nodeFiles.hasNext()) {
    FileStatus status=nodeFiles.next();
    String filename=status.getPath().getName();
    if (filename.contains(LogAggregationUtils.TMP_FILE_SUFFIX) || (lastLogFile != null && filename.contains(lastLogFile) && sizeLimited)) {
      LOG.info("fileName :" + filename);
      LOG.info("lastLogFile :" + lastLogFile);
      return -1;
    }
    if (filename.contains(LogAggregationUtils.getNodeString(logAggregationService.getNodeId()))) {
      LOG.info("Node list filename :" + filename);
      count++;
    }
  }
  LOG.info("File Count :" + count);
  return count;
}
