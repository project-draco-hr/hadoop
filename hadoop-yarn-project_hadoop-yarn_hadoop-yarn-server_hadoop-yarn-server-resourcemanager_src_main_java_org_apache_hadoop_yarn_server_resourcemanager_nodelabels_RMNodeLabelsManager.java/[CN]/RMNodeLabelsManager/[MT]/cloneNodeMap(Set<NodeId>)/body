{
  Map<String,Host> map=new HashMap<String,Host>();
  for (  NodeId nodeId : nodesToCopy) {
    if (!map.containsKey(nodeId.getHost())) {
      Host originalN=nodeCollections.get(nodeId.getHost());
      if (null == originalN) {
        continue;
      }
      Host n=originalN.copy();
      n.nms.clear();
      map.put(nodeId.getHost(),n);
    }
    Host n=map.get(nodeId.getHost());
    if (WILDCARD_PORT == nodeId.getPort()) {
      for (      Entry<NodeId,Node> entry : nodeCollections.get(nodeId.getHost()).nms.entrySet()) {
        n.nms.put(entry.getKey(),entry.getValue().copy());
      }
    }
 else {
      Node nm=getNMInNodeSet(nodeId);
      if (null != nm) {
        n.nms.put(nodeId,nm.copy());
      }
    }
  }
  return map;
}
