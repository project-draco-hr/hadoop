{
  if (hdfs.exists(path)) {
    hdfs.delete(path,true);
  }
  FSDataOutputStream out=hdfs.create(path,(short)1);
  out.writeBytes("0123456789");
  out.close();
  BlockLocation[] locations=hdfs.getFileBlockLocations(path,0,10);
  String xferAddr=locations[0].getNames()[0];
  URL u=hftpFs.getNamenodeURL("/data" + ServletUtil.encodePath(path.toUri().getPath()),"ugi=userx,groupy");
  HttpURLConnection conn=(HttpURLConnection)u.openConnection();
  HttpURLConnection.setFollowRedirects(true);
  conn.connect();
  conn.getInputStream();
  boolean checked=false;
  for (  DataNode node : cluster.getDataNodes()) {
    DatanodeRegistration dnR=DataNodeTestUtils.getDNRegistrationForBP(node,blockPoolId);
    if (dnR.getXferAddr().equals(xferAddr)) {
      checked=true;
      assertEquals(dnR.getInfoPort(),conn.getURL().getPort());
    }
  }
  assertTrue("The test never checked that location of " + "the block and hftp desitnation are the same",checked);
}
