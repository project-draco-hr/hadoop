{
  for (  String baseDir : baseDirs) {
    LOG.info("Checking namenode directory " + baseDir);
    LOG.info("==== Contents ====:\n  " + Joiner.on("  \n").join(new File(baseDir,"current").list()));
    LOG.info("==================");
    assertExists(new File(baseDir,"current"));
    assertExists(new File(baseDir,"current/VERSION"));
    assertExists(new File(baseDir,"current/" + getInProgressEditsFileName(imageTxId + 1)));
    assertExists(new File(baseDir,"current/" + getImageFileName(imageTxId)));
    assertExists(new File(baseDir,"current/seen_txid"));
    File previous=new File(baseDir,"previous");
    assertExists(previous);
    assertEquals(UpgradeUtilities.checksumContents(NAME_NODE,previous,false),UpgradeUtilities.checksumMasterNameNodeContents());
  }
}
