{
  final Path rootPath=getTestRootPath(fc,"test");
  final Path path=new Path(rootPath,"zoo");
  FSDataOutputStream out=fc.create(path,EnumSet.of(CREATE),Options.CreateOpts.createParent());
  try {
    fc.setVerifyChecksum(true,path);
    out.write(data,0,data.length);
  }
  finally {
    out.close();
  }
  FileStatus fileStatus=fc.getFileStatus(path);
  final long len=fileStatus.getLen();
  assertTrue(len == data.length);
  byte[] bb=new byte[(int)len];
  FSDataInputStream fsdis=fc.open(path);
  try {
    fsdis.readFully(bb);
  }
  finally {
    fsdis.close();
  }
  assertArrayEquals(data,bb);
}
