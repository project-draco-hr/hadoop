{
  TestSetup setup=new TestSetup(new TestSuite(TestRackAwareTaskPlacement.class)){
    protected void setUp() throws Exception {
      JobConf conf=new JobConf();
      conf.set(JTConfig.JT_IPC_ADDRESS,"localhost:0");
      conf.set(JTConfig.JT_HTTP_ADDRESS,"0.0.0.0:0");
      conf.setClass("topology.node.switch.mapping.impl",StaticMapping.class,DNSToSwitchMapping.class);
      conf.set(JTConfig.JT_INSTRUMENTATION,FakeJobTrackerMetricsInst.class.getName());
      jobTracker=new FakeJobTracker(conf,new FakeClock(),trackers);
      fakeInst=(FakeJobTrackerMetricsInst)jobTracker.getInstrumentation();
      for (int i=0; i < allHosts.length; i++) {
        StaticMapping.addNodeToRack(allHosts[i],allRacks[i]);
      }
      for (      String tracker : trackers) {
        FakeObjectUtilities.establishFirstContact(jobTracker,tracker);
      }
    }
  }
;
  return setup;
}
