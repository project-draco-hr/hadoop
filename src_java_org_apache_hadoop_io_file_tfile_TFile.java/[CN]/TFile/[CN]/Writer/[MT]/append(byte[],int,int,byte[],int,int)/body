{
  if ((koff | klen | (koff + klen)| (key.length - (koff + klen))) < 0) {
    throw new IndexOutOfBoundsException("Bad key buffer offset-length combination.");
  }
  if ((voff | vlen | (voff + vlen)| (value.length - (voff + vlen))) < 0) {
    throw new IndexOutOfBoundsException("Bad value buffer offset-length combination.");
  }
  try {
    DataOutputStream dosKey=prepareAppendKey(klen);
    try {
      ++errorCount;
      dosKey.write(key,koff,klen);
      --errorCount;
    }
  finally {
      dosKey.close();
    }
    DataOutputStream dosValue=prepareAppendValue(vlen);
    try {
      ++errorCount;
      dosValue.write(value,voff,vlen);
      --errorCount;
    }
  finally {
      dosValue.close();
    }
  }
  finally {
    state=State.READY;
  }
}
