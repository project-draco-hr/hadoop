{
  Path file1=getTestRootPath(fc,"file1");
  createFile(fc,file1,numBlocks,blockSize);
  fc.deleteOnExit(file1);
  checkDeleteOnExitData(1,fc,file1);
  Assert.assertTrue(Runtime.getRuntime().removeShutdownHook(FileContext.FINALIZER));
  Path file2=getTestRootPath(fc,"dir1/file2");
  createFile(fc,file2,numBlocks,blockSize);
  fc.deleteOnExit(file2);
  checkDeleteOnExitData(1,fc,file1,file2);
  Path dir=getTestRootPath(fc,"dir3/dir4/dir5/dir6");
  createFile(fc,dir,numBlocks,blockSize);
  fc.deleteOnExit(dir);
  checkDeleteOnExitData(1,fc,file1,file2,dir);
  FileContext.FINALIZER.start();
  FileContext.FINALIZER.join();
  checkDeleteOnExitData(0,fc,new Path[0]);
  Assert.assertFalse(exists(fc,file1));
  Assert.assertFalse(exists(fc,file2));
  Assert.assertFalse(exists(fc,dir));
}
