{
  LdapIpDirFilter filter=new LdapIpDirFilter();
  String baseName="ou=proxyroles,dc=mycompany,dc=com";
  DummyLdapContext dlc=new DummyLdapContext();
  filter.initialize(baseName,dlc);
  request.setRemoteIPAddress("127.0.0.1");
  ServletContext context=config.getServletContext();
  context.removeAttribute("name.node.address");
  context.removeAttribute("name.conf");
  assertNull(context.getAttribute("name.node.address"));
  assertNull(context.getAttribute("name.conf"));
  filter.init(config);
  assertNotNull(context.getAttribute("name.node.address"));
  assertNotNull(context.getAttribute("name.conf"));
  request.removeAttribute("org.apache.hadoop.hdfsproxy.authorized.userID");
  FilterChain mockFilterChain=new DummyFilterChain();
  filter.doFilter(request,response,mockFilterChain);
  assertEquals(request.getAttribute("org.apache.hadoop.hdfsproxy.authorized.userID"),"testuser");
}
