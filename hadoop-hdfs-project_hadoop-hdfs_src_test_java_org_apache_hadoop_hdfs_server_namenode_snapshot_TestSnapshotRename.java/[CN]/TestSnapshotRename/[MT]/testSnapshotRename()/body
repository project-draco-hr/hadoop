{
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPLICATION,seed);
  Path snapshotRoot=SnapshotTestHelper.createSnapshot(hdfs,sub1,"s1");
  Path ssPath=new Path(snapshotRoot,file1.getName());
  assertTrue(hdfs.exists(ssPath));
  FileStatus statusBeforeRename=hdfs.getFileStatus(ssPath);
  hdfs.renameSnapshot(sub1,"s1","s2");
  assertFalse(hdfs.exists(ssPath));
  snapshotRoot=SnapshotTestHelper.getSnapshotRoot(sub1,"s2");
  ssPath=new Path(snapshotRoot,file1.getName());
  assertTrue(hdfs.exists(ssPath));
  FileStatus statusAfterRename=hdfs.getFileStatus(ssPath);
  assertFalse(statusBeforeRename.equals(statusAfterRename));
  statusBeforeRename.setPath(statusAfterRename.getPath());
  assertEquals(statusBeforeRename.toString(),statusAfterRename.toString());
}
