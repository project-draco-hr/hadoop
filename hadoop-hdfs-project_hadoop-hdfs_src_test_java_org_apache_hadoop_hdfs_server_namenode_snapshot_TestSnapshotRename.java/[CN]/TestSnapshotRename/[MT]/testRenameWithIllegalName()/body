{
  DFSTestUtil.createFile(hdfs,file1,BLOCKSIZE,REPLICATION,seed);
  SnapshotTestHelper.createSnapshot(hdfs,sub1,"s1");
  final String name1=HdfsConstants.DOT_SNAPSHOT_DIR;
  try {
    hdfs.renameSnapshot(sub1,"s1",name1);
    fail("Exception expected when an illegal name is given for rename");
  }
 catch (  RemoteException e) {
    String errorMsg="\"" + HdfsConstants.DOT_SNAPSHOT_DIR + "\" is a reserved name.";
    GenericTestUtils.assertExceptionContains(errorMsg,e);
  }
  String errorMsg="Snapshot name cannot contain \"" + Path.SEPARATOR + "\"";
  final String[] badNames=new String[]{"foo" + Path.SEPARATOR,Path.SEPARATOR + "foo",Path.SEPARATOR,"foo" + Path.SEPARATOR + "bar"};
  for (  String badName : badNames) {
    try {
      hdfs.renameSnapshot(sub1,"s1",badName);
      fail("Exception expected when an illegal name is given");
    }
 catch (    RemoteException e) {
      GenericTestUtils.assertExceptionContains(errorMsg,e);
    }
  }
}
