{
  if (idx != argv.length - 1) {
    printUsage("-upgradeProgress");
    return -1;
  }
  UpgradeAction action;
  if ("status".equalsIgnoreCase(argv[idx])) {
    action=UpgradeAction.GET_STATUS;
  }
 else   if ("details".equalsIgnoreCase(argv[idx])) {
    action=UpgradeAction.DETAILED_STATUS;
  }
 else   if ("force".equalsIgnoreCase(argv[idx])) {
    action=UpgradeAction.FORCE_PROCEED;
  }
 else {
    printUsage("-upgradeProgress");
    return -1;
  }
  DistributedFileSystem dfs=getDFS();
  UpgradeStatusReport status=dfs.distributedUpgradeProgress(action);
  String statusText=(status == null ? "There are no upgrades in progress." : status.getStatusText(action == UpgradeAction.DETAILED_STATUS));
  System.out.println(statusText);
  return 0;
}
