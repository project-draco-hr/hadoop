{
  DistributedFileSystem dfs=getDFS();
  FsStatus ds=dfs.getStatus();
  long capacity=ds.getCapacity();
  long used=ds.getUsed();
  long remaining=ds.getRemaining();
  long presentCapacity=used + remaining;
  boolean mode=dfs.setSafeMode(HdfsConstants.SafeModeAction.SAFEMODE_GET);
  if (mode) {
    System.out.println("Safe mode is ON");
  }
  System.out.println("Configured Capacity: " + capacity + " ("+ StringUtils.byteDesc(capacity)+ ")");
  System.out.println("Present Capacity: " + presentCapacity + " ("+ StringUtils.byteDesc(presentCapacity)+ ")");
  System.out.println("DFS Remaining: " + remaining + " ("+ StringUtils.byteDesc(remaining)+ ")");
  System.out.println("DFS Used: " + used + " ("+ StringUtils.byteDesc(used)+ ")");
  System.out.println("DFS Used%: " + StringUtils.formatPercent(used / (double)presentCapacity,2));
  System.out.println("Under replicated blocks: " + dfs.getUnderReplicatedBlocksCount());
  System.out.println("Blocks with corrupt replicas: " + dfs.getCorruptBlocksCount());
  System.out.println("Missing blocks: " + dfs.getMissingBlocksCount());
  System.out.println("Missing blocks (with replication factor 1): " + dfs.getMissingReplOneBlocksCount());
  System.out.println();
  System.out.println("-------------------------------------------------");
  List<String> args=Arrays.asList(argv);
  args=new ArrayList<String>(args.subList(i,args.size()));
  final boolean listLive=StringUtils.popOption("-live",args);
  final boolean listDead=StringUtils.popOption("-dead",args);
  final boolean listDecommissioning=StringUtils.popOption("-decommissioning",args);
  boolean listAll=(!listLive && !listDead && !listDecommissioning);
  if (listAll || listLive) {
    DatanodeInfo[] live=dfs.getDataNodeStats(DatanodeReportType.LIVE);
    if (live.length > 0 || listLive) {
      System.out.println("Live datanodes (" + live.length + "):\n");
    }
    if (live.length > 0) {
      for (      DatanodeInfo dn : live) {
        System.out.println(dn.getDatanodeReport());
        System.out.println();
      }
    }
  }
  if (listAll || listDead) {
    DatanodeInfo[] dead=dfs.getDataNodeStats(DatanodeReportType.DEAD);
    if (dead.length > 0 || listDead) {
      System.out.println("Dead datanodes (" + dead.length + "):\n");
    }
    if (dead.length > 0) {
      for (      DatanodeInfo dn : dead) {
        System.out.println(dn.getDatanodeReport());
        System.out.println();
      }
    }
  }
  if (listAll || listDecommissioning) {
    DatanodeInfo[] decom=dfs.getDataNodeStats(DatanodeReportType.DECOMMISSIONING);
    if (decom.length > 0 || listDecommissioning) {
      System.out.println("Decommissioning datanodes (" + decom.length + "):\n");
    }
    if (decom.length > 0) {
      for (      DatanodeInfo dn : decom) {
        System.out.println(dn.getDatanodeReport());
        System.out.println();
      }
    }
  }
}
