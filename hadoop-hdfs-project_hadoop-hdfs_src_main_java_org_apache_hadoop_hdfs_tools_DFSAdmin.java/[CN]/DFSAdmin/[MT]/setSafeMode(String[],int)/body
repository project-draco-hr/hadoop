{
  if (idx != argv.length - 1) {
    printUsage("-safemode");
    return;
  }
  HdfsConstants.SafeModeAction action;
  Boolean waitExitSafe=false;
  if ("leave".equalsIgnoreCase(argv[idx])) {
    action=HdfsConstants.SafeModeAction.SAFEMODE_LEAVE;
  }
 else   if ("enter".equalsIgnoreCase(argv[idx])) {
    action=HdfsConstants.SafeModeAction.SAFEMODE_ENTER;
  }
 else   if ("get".equalsIgnoreCase(argv[idx])) {
    action=HdfsConstants.SafeModeAction.SAFEMODE_GET;
  }
 else   if ("wait".equalsIgnoreCase(argv[idx])) {
    action=HdfsConstants.SafeModeAction.SAFEMODE_GET;
    waitExitSafe=true;
  }
 else {
    printUsage("-safemode");
    return;
  }
  DistributedFileSystem dfs=getDFS();
  boolean inSafeMode=dfs.setSafeMode(action);
  if (waitExitSafe) {
    while (inSafeMode) {
      try {
        Thread.sleep(5000);
      }
 catch (      java.lang.InterruptedException e) {
        throw new IOException("Wait Interrupted");
      }
      inSafeMode=dfs.setSafeMode(action);
    }
  }
  System.out.println("Safe mode is " + (inSafeMode ? "ON" : "OFF"));
}
