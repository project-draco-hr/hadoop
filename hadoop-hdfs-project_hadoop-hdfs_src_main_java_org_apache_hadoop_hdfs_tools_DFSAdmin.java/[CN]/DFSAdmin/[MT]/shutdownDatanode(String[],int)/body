{
  ClientDatanodeProtocol dnProxy=getDataNodeProxy(argv[i]);
  boolean upgrade=false;
  if (argv.length - 1 == i + 1) {
    if ("upgrade".equals(argv[i + 1])) {
      upgrade=true;
    }
 else {
      printUsage("-shutdownDatanode");
      return -1;
    }
  }
  dnProxy.shutdownDatanode(upgrade);
  return 0;
}
