{
  final String dn=argv[i];
  ClientDatanodeProtocol dnProxy=getDataNodeProxy(dn);
  boolean upgrade=false;
  if (argv.length - 1 == i + 1) {
    if ("upgrade".equalsIgnoreCase(argv[i + 1])) {
      upgrade=true;
    }
 else {
      printUsage("-shutdownDatanode");
      return -1;
    }
  }
  dnProxy.shutdownDatanode(upgrade);
  System.out.println("Submitted a shutdown request to datanode " + dn);
  return 0;
}
