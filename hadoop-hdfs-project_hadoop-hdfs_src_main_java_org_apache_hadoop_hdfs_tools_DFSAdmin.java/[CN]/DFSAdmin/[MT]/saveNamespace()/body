{
  int exitCode=-1;
  DistributedFileSystem dfs=getDFS();
  Configuration dfsConf=dfs.getConf();
  URI dfsUri=dfs.getUri();
  boolean isHaEnabled=HAUtil.isLogicalUri(dfsConf,dfsUri);
  if (isHaEnabled) {
    String nsId=dfsUri.getHost();
    List<ProxyAndInfo<ClientProtocol>> proxies=HAUtil.getProxiesForAllNameNodesInNameservice(dfsConf,nsId,ClientProtocol.class);
    for (    ProxyAndInfo<ClientProtocol> proxy : proxies) {
      proxy.getProxy().saveNamespace();
      System.out.println("Save namespace successful for " + proxy.getAddress());
    }
  }
 else {
    dfs.saveNamespace();
    System.out.println("Save namespace successful");
  }
  exitCode=0;
  return exitCode;
}
