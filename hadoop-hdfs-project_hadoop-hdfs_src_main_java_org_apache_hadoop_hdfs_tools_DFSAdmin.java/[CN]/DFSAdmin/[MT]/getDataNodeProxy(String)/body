{
  InetSocketAddress datanodeAddr=NetUtils.createSocketAddr(datanode);
  Configuration conf=getConf();
  conf.set(CommonConfigurationKeys.HADOOP_SECURITY_SERVICE_USER_NAME_KEY,conf.get(DFSConfigKeys.DFS_DATANODE_USER_NAME_KEY,""));
  ClientDatanodeProtocol dnProtocol=DFSUtil.createClientDatanodeProtocolProxy(datanodeAddr,getUGI(),conf,NetUtils.getSocketFactory(conf,ClientDatanodeProtocol.class));
  return dnProtocol;
}
