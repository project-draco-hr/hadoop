{
  final RollingUpgradeAction action=RollingUpgradeAction.fromString(argv.length >= 2 ? argv[1] : "");
  if (action == null) {
    throw new IllegalArgumentException("Failed to covert \"" + argv[1] + "\" to "+ RollingUpgradeAction.class.getSimpleName());
  }
  System.out.println(action + " rolling upgrade ...");
  final RollingUpgradeInfo info=dfs.rollingUpgrade(action);
switch (action) {
case QUERY:
    break;
case PREPARE:
  Preconditions.checkState(info.isStarted());
break;
case FINALIZE:
Preconditions.checkState(info.isFinalized());
break;
}
printMessage(info,System.out);
return 0;
}
