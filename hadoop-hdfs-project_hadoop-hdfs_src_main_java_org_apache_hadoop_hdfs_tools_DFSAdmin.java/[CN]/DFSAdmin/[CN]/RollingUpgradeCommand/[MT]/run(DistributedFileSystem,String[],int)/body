{
  final RollingUpgradeAction action=RollingUpgradeAction.fromString(argv.length >= 2 ? argv[1] : "");
  if (action == null) {
    throw new IllegalArgumentException("Failed to covert \"" + argv[1] + "\" to "+ RollingUpgradeAction.class.getSimpleName());
  }
  System.out.println(action + " rolling upgrade ...");
  final RollingUpgradeInfo info=dfs.rollingUpgrade(action);
switch (action) {
case QUERY:
    if (info != null && info.isStarted()) {
      System.out.println("Rolling upgrade is in progress:");
      System.out.println(info);
    }
 else {
      System.out.println("There is no rolling upgrade in progress.");
    }
  break;
case START:
Preconditions.checkState(info.isStarted());
System.out.println("Rolling upgrade is started:");
System.out.println(info);
break;
case FINALIZE:
Preconditions.checkState(info.isFinalized());
System.out.println("Rolling upgrade is finalized:");
System.out.println(info);
break;
}
return 0;
}
