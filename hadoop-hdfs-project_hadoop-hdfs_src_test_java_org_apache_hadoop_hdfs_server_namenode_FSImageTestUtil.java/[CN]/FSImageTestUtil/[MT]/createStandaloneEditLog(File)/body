{
  assertTrue(logDir.mkdirs() || logDir.exists());
  Files.deleteDirectoryContents(logDir);
  NNStorage storage=Mockito.mock(NNStorage.class);
  StorageDirectory sd=FSImageTestUtil.mockStorageDirectory(logDir,NameNodeDirType.EDITS);
  List<StorageDirectory> sds=Lists.newArrayList(sd);
  Mockito.doReturn(sds).when(storage).dirIterable(NameNodeDirType.EDITS);
  Mockito.doReturn(sd).when(storage).getStorageDirectory(Matchers.<URI>anyObject());
  return new FSEditLog(new Configuration(),storage,ImmutableList.of(logDir.toURI()));
}
