{
  setupCalled=true;
  if (cacheFiles.isEmpty()) {
    return;
  }
  ArrayList<Path> localArchives=new ArrayList<Path>();
  ArrayList<Path> localFiles=new ArrayList<Path>();
  Path workdirPath=new Path(workDir.getAbsolutePath());
  for (  CacheFile cacheFile : cacheFiles) {
    URI uri=cacheFile.uri;
    FileSystem fileSystem=FileSystem.get(uri,taskConf);
    FileStatus fileStatus=fileSystem.getFileStatus(new Path(uri.getPath()));
    String cacheSubdir=publicCacheSubDir;
    if (!cacheFile.isPublic) {
      cacheSubdir=privateCacheSubdir;
    }
    Path p=distributedCacheManager.getLocalCache(uri,taskConf,cacheSubdir,fileStatus,cacheFile.type == CacheFile.FileType.ARCHIVE,cacheFile.timestamp,workdirPath,false,cacheFile.isPublic);
    cacheFile.setLocalized(true);
    if (cacheFile.type == CacheFile.FileType.ARCHIVE) {
      localArchives.add(p);
    }
 else {
      localFiles.add(p);
    }
    if (cacheFile.shouldBeAddedToClassPath) {
      classPaths.add(p.toString());
    }
  }
  if (!localArchives.isEmpty()) {
    TrackerDistributedCacheManager.setLocalArchives(taskConf,stringifyPathList(localArchives));
  }
  if (!localFiles.isEmpty()) {
    TrackerDistributedCacheManager.setLocalFiles(taskConf,stringifyPathList(localFiles));
  }
}
