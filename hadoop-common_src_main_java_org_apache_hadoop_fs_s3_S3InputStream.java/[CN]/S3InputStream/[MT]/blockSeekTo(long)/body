{
  int targetBlock=-1;
  long targetBlockStart=0;
  long targetBlockEnd=0;
  for (int i=0; i < blocks.length; i++) {
    long blockLength=blocks[i].getLength();
    targetBlockEnd=targetBlockStart + blockLength - 1;
    if (target >= targetBlockStart && target <= targetBlockEnd) {
      targetBlock=i;
      break;
    }
 else {
      targetBlockStart=targetBlockEnd + 1;
    }
  }
  if (targetBlock < 0) {
    throw new IOException("Impossible situation: could not find target position " + target);
  }
  long offsetIntoBlock=target - targetBlockStart;
  this.blockFile=store.retrieveBlock(blocks[targetBlock],offsetIntoBlock);
  this.pos=target;
  this.blockEnd=targetBlockEnd;
  this.blockStream=new DataInputStream(new FileInputStream(blockFile));
}
