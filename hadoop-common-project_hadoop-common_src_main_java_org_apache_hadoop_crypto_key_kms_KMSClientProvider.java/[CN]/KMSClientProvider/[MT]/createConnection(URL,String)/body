{
  HttpURLConnection conn;
  try {
    DelegationTokenAuthenticatedURL authUrl=new DelegationTokenAuthenticatedURL(configurator);
    conn=authUrl.openConnection(url,authToken);
  }
 catch (  AuthenticationException ex) {
    throw new IOException(ex);
  }
  conn.setUseCaches(false);
  conn.setRequestMethod(method);
  if (method.equals(HTTP_POST) || method.equals(HTTP_PUT)) {
    conn.setDoOutput(true);
  }
  conn=configureConnection(conn);
  return conn;
}
