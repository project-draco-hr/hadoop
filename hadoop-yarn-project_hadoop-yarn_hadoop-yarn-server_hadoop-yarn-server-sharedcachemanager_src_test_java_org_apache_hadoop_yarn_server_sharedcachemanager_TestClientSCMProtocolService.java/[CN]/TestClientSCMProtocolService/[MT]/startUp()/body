{
  Configuration conf=new Configuration();
  conf.set(YarnConfiguration.SCM_STORE_CLASS,InMemorySCMStore.class.getName());
  conf.set(YarnConfiguration.SHARED_CACHE_ROOT,testDir.getPath());
  AppChecker appChecker=mock(AppChecker.class);
  store=new InMemorySCMStore(appChecker);
  store.init(conf);
  store.start();
  service=new ClientProtocolService(store);
  service.init(conf);
  service.start();
  YarnRPC rpc=YarnRPC.create(new Configuration());
  InetSocketAddress scmAddress=conf.getSocketAddr(YarnConfiguration.SCM_CLIENT_SERVER_ADDRESS,YarnConfiguration.DEFAULT_SCM_CLIENT_SERVER_ADDRESS,YarnConfiguration.DEFAULT_SCM_CLIENT_SERVER_PORT);
  clientSCMProxy=(ClientSCMProtocol)rpc.getProxy(ClientSCMProtocol.class,scmAddress,conf);
}
