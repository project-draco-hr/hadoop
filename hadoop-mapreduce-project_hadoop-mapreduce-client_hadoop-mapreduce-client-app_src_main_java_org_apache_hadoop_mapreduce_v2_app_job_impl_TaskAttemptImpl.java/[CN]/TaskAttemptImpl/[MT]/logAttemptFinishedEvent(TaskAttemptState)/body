{
  if (getLaunchTime() == 0)   return;
  if (attemptId.getTaskId().getTaskType() == TaskType.MAP) {
    MapAttemptFinishedEvent mfe=new MapAttemptFinishedEvent(TypeConverter.fromYarn(attemptId),TypeConverter.fromYarn(attemptId.getTaskId().getTaskType()),state.toString(),this.reportedStatus.mapFinishTime,finishTime,this.containerNodeId == null ? "UNKNOWN" : this.containerNodeId.getHost(),this.containerNodeId == null ? -1 : this.containerNodeId.getPort(),this.nodeRackName == null ? "UNKNOWN" : this.nodeRackName,this.reportedStatus.stateString,TypeConverter.fromYarn(getCounters()),getProgressSplitBlock().burst());
    eventHandler.handle(new JobHistoryEvent(attemptId.getTaskId().getJobId(),mfe));
  }
 else {
    ReduceAttemptFinishedEvent rfe=new ReduceAttemptFinishedEvent(TypeConverter.fromYarn(attemptId),TypeConverter.fromYarn(attemptId.getTaskId().getTaskType()),state.toString(),this.reportedStatus.shuffleFinishTime,this.reportedStatus.sortFinishTime,finishTime,this.containerNodeId == null ? "UNKNOWN" : this.containerNodeId.getHost(),this.containerNodeId == null ? -1 : this.containerNodeId.getPort(),this.nodeRackName == null ? "UNKNOWN" : this.nodeRackName,this.reportedStatus.stateString,TypeConverter.fromYarn(getCounters()),getProgressSplitBlock().burst());
    eventHandler.handle(new JobHistoryEvent(attemptId.getTaskId().getJobId(),rfe));
  }
}
