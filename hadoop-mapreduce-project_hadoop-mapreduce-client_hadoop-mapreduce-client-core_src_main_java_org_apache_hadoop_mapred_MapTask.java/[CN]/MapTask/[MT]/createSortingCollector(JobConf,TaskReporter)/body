{
  MapOutputCollector<KEY,VALUE> collector=(MapOutputCollector<KEY,VALUE>)ReflectionUtils.newInstance(job.getClass(JobContext.MAP_OUTPUT_COLLECTOR_CLASS_ATTR,MapOutputBuffer.class,MapOutputCollector.class),job);
  LOG.info("Map output collector class = " + collector.getClass().getName());
  MapOutputCollector.Context context=new MapOutputCollector.Context(this,job,reporter);
  collector.init(context);
  return collector;
}
