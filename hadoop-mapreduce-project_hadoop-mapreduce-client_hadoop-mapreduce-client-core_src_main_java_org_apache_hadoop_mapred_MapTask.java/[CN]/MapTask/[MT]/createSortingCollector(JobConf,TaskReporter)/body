{
  MapOutputCollector<KEY,VALUE> collector=(MapOutputCollector<KEY,VALUE>)ReflectionUtils.newInstance(job.getClass(JobContext.MAP_OUTPUT_COLLECTOR_CLASS_ATTR,MapOutputBuffer.class,MapOutputCollector.class),job);
  MapOutputCollector.Context context=new MapOutputCollector.Context(this,job,reporter);
  try {
    collector.init(context);
  }
 catch (  Exception e) {
    LOG.warn("Nativetask falling back to Java MapOutputCollector",e);
    collector=new MapOutputBuffer();
    collector.init(context);
  }
 finally {
    LOG.info("Map output collector class = " + collector.getClass().getName());
    return collector;
  }
}
