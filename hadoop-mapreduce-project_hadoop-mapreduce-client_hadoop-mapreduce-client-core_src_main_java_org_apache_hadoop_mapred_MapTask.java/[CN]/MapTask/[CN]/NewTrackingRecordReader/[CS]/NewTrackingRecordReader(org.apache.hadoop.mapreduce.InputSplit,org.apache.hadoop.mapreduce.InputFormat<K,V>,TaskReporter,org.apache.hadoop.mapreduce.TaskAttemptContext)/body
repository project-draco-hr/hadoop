{
  this.reporter=reporter;
  this.inputRecordCounter=reporter.getCounter(TaskCounter.MAP_INPUT_RECORDS);
  this.fileInputByteCounter=reporter.getCounter(FileInputFormatCounter.BYTES_READ);
  List<Statistics> matchedStats=null;
  if (split instanceof org.apache.hadoop.mapreduce.lib.input.FileSplit) {
    matchedStats=getFsStatistics(((org.apache.hadoop.mapreduce.lib.input.FileSplit)split).getPath(),taskContext.getConfiguration());
  }
  fsStats=matchedStats;
  long bytesInPrev=getInputBytes(fsStats);
  this.real=inputFormat.createRecordReader(split,taskContext);
  long bytesInCurr=getInputBytes(fsStats);
  fileInputByteCounter.increment(bytesInCurr - bytesInPrev);
}
