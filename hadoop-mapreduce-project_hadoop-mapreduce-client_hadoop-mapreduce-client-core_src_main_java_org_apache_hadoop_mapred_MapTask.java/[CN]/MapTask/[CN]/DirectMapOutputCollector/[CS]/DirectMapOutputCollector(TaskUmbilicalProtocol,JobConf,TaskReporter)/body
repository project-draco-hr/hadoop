{
  this.reporter=reporter;
  String finalName=getOutputName(getPartition());
  FileSystem fs=FileSystem.get(job);
  OutputFormat<K,V> outputFormat=job.getOutputFormat();
  mapOutputRecordCounter=reporter.getCounter(TaskCounter.MAP_OUTPUT_RECORDS);
  fileOutputByteCounter=reporter.getCounter(FileOutputFormatCounter.BYTES_WRITTEN);
  List<Statistics> matchedStats=null;
  if (outputFormat instanceof FileOutputFormat) {
    matchedStats=getFsStatistics(FileOutputFormat.getOutputPath(job),job);
  }
  fsStats=matchedStats;
  long bytesOutPrev=getOutputBytes(fsStats);
  out=job.getOutputFormat().getRecordWriter(fs,job,finalName,reporter);
  long bytesOutCurr=getOutputBytes(fsStats);
  fileOutputByteCounter.increment(bytesOutCurr - bytesOutPrev);
}
