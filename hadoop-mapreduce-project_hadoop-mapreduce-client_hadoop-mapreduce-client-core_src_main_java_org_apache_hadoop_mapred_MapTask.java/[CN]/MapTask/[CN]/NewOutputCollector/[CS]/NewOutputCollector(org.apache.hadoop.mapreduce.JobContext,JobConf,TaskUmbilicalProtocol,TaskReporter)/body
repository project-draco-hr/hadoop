{
  collector=createSortingCollector(job,reporter);
  partitions=jobContext.getNumReduceTasks();
  if (partitions > 1) {
    partitioner=(org.apache.hadoop.mapreduce.Partitioner<K,V>)ReflectionUtils.newInstance(jobContext.getPartitionerClass(),job);
  }
 else {
    partitioner=new org.apache.hadoop.mapreduce.Partitioner<K,V>(){
      @Override public int getPartition(      K key,      V value,      int numPartitions){
        return partitions - 1;
      }
    }
;
  }
}
