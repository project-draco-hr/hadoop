{
  numPartitions=conf.getNumReduceTasks();
  if (numPartitions > 1) {
    partitioner=(Partitioner<K,V>)ReflectionUtils.newInstance(conf.getPartitionerClass(),conf);
  }
 else {
    partitioner=new Partitioner<K,V>(){
      @Override public void configure(      JobConf job){
      }
      @Override public int getPartition(      K key,      V value,      int numPartitions){
        return numPartitions - 1;
      }
    }
;
  }
  this.collector=collector;
}
