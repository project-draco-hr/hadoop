{
  boolean replaced=false;
  DatanodeStorageInfo otherStorage=b.findStorageInfo(getDatanodeDescriptor());
  if (otherStorage != null) {
    if (otherStorage != this) {
      otherStorage.removeBlock(b);
      replaced=true;
    }
 else {
      return false;
    }
  }
  b.addStorage(this);
  blockList=b.listInsert(blockList,this);
  numBlocks++;
  return !replaced;
}
