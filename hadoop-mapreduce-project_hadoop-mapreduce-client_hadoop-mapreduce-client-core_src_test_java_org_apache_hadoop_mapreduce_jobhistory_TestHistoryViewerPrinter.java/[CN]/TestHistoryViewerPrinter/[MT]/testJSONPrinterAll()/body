{
  JobHistoryParser.JobInfo job=createJobInfo();
  JSONHistoryViewerPrinter printer=new JSONHistoryViewerPrinter(job,true,"http://");
  String outStr=run(printer);
  JSONAssert.assertEquals("{\n" + "    \"counters\": {\n" + "        \"group1\": [\n"+ "            {\n"+ "                \"counterName\": \"counter1\",\n"+ "                \"mapValue\": 5,\n"+ "                \"reduceValue\": 5,\n"+ "                \"totalValue\": 5\n"+ "            },\n"+ "            {\n"+ "                \"counterName\": \"counter2\",\n"+ "                \"mapValue\": 10,\n"+ "                \"reduceValue\": 10,\n"+ "                \"totalValue\": 10\n"+ "            }\n"+ "        ],\n"+ "        \"group2\": [\n"+ "            {\n"+ "                \"counterName\": \"counter1\",\n"+ "                \"mapValue\": 15,\n"+ "                \"reduceValue\": 15,\n"+ "                \"totalValue\": 15\n"+ "            }\n"+ "        ]\n"+ "    },\n"+ "    \"finishedAt\": 1317928516754,\n"+ "    \"hadoopJob\": \"job_1317928501754_0001\",\n"+ "    \"jobConf\": \"/tmp/job.xml\",\n"+ "    \"jobName\": \"my job\",\n"+ "    \"launchedAt\": 1317928502754,\n"+ "    \"status\": \"SUCCEEDED\",\n"+ "    \"submittedAt\": 1317928501754,\n"+ "    \"taskSummary\": {\n"+ "        \"cleanup\": {\n"+ "            \"failed\": 0,\n"+ "            \"finishTime\": 1317928520754,\n"+ "            \"killed\": 0,\n"+ "            \"startTime\": 1317928511754,\n"+ "            \"successful\": 1,\n"+ "            \"total\": 1\n"+ "        },\n"+ "        \"map\": {\n"+ "            \"failed\": 1,\n"+ "            \"finishTime\": 1317928516754,\n"+ "            \"killed\": 0,\n"+ "            \"startTime\": 1317928504754,\n"+ "            \"successful\": 5,\n"+ "            \"total\": 6\n"+ "        },\n"+ "        \"reduce\": {\n"+ "            \"failed\": 0,\n"+ "            \"finishTime\": 1317928518754,\n"+ "            \"killed\": 0,\n"+ "            \"startTime\": 1317928510754,\n"+ "            \"successful\": 1,\n"+ "            \"total\": 1\n"+ "        },\n"+ "        \"setup\": {\n"+ "            \"failed\": 0,\n"+ "            \"finishTime\": 1317928504754,\n"+ "            \"killed\": 0,\n"+ "            \"startTime\": 1317928503754,\n"+ "            \"successful\": 1,\n"+ "            \"total\": 1\n"+ "        }\n"+ "    },\n"+ "    \"tasks\": [\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_m_000002_1\",\n"+ "                \"finishTime\": 1317928506754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"startTime\": 1317928504754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_m_000002_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928506754,\n"+ "            \"inputSplits\": \"\",\n"+ "            \"startTime\": 1317928504754,\n"+ "            \"status\": \"FAILED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_m_000002\",\n"+ "            \"type\": \"MAP\"\n"+ "        },\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_s_000001_1\",\n"+ "                \"finishTime\": 1317928504754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"startTime\": 1317928503754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_s_000001_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928504754,\n"+ "            \"startTime\": 1317928503754,\n"+ "            \"status\": \"SUCCEEDED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_s_000001\",\n"+ "            \"type\": \"JOB_SETUP\"\n"+ "        },\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_m_000006_1\",\n"+ "                \"finishTime\": 1317928514754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"startTime\": 1317928508754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_m_000006_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928514754,\n"+ "            \"inputSplits\": \"\",\n"+ "            \"startTime\": 1317928508754,\n"+ "            \"status\": \"SUCCEEDED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_m_000006\",\n"+ "            \"type\": \"MAP\"\n"+ "        },\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_m_000005_1\",\n"+ "                \"finishTime\": 1317928512754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"startTime\": 1317928507754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_m_000005_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928512754,\n"+ "            \"inputSplits\": \"\",\n"+ "            \"startTime\": 1317928507754,\n"+ "            \"status\": \"SUCCEEDED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_m_000005\",\n"+ "            \"type\": \"MAP\"\n"+ "        },\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_m_000004_1\",\n"+ "                \"finishTime\": 1317928510754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"startTime\": 1317928506754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_m_000004_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928510754,\n"+ "            \"inputSplits\": \"\",\n"+ "            \"startTime\": 1317928506754,\n"+ "            \"status\": \"SUCCEEDED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_m_000004\",\n"+ "            \"type\": \"MAP\"\n"+ "        },\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_m_000003_1\",\n"+ "                \"finishTime\": 1317928508754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"startTime\": 1317928505754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_m_000003_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928508754,\n"+ "            \"inputSplits\": \"\",\n"+ "            \"startTime\": 1317928505754,\n"+ "            \"status\": \"SUCCEEDED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_m_000003\",\n"+ "            \"type\": \"MAP\"\n"+ "        },\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_c_000009_1\",\n"+ "                \"finishTime\": 1317928520754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"startTime\": 1317928511754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_c_000009_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928520754,\n"+ "            \"startTime\": 1317928511754,\n"+ "            \"status\": \"SUCCEEDED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_c_000009\",\n"+ "            \"type\": \"JOB_CLEANUP\"\n"+ "        },\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_m_000007_1\",\n"+ "                \"finishTime\": 1317928516754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"startTime\": 1317928509754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_m_000007_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928516754,\n"+ "            \"inputSplits\": \"\",\n"+ "            \"startTime\": 1317928509754,\n"+ "            \"status\": \"SUCCEEDED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_m_000007\",\n"+ "            \"type\": \"MAP\"\n"+ "        },\n"+ "        {\n"+ "            \"attempts\": {\n"+ "                \"attemptId\": \"attempt_1317928501754_0001_r_000008_1\",\n"+ "                \"finishTime\": 1317928518754,\n"+ "                \"hostName\": \"localhost\",\n"+ "                \"shuffleFinished\": 1317928518754,\n"+ "                \"sortFinished\": 1317928518754,\n"+ "                \"startTime\": 1317928510754,\n"+ "                \"taskLogs\": \"http://t:1234/tasklog?attemptid=attempt_1317928501754_0001_r_000008_1\"\n"+ "            },\n"+ "            \"counters\": {\n"+ "                \"group1\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 5\n"+ "                    },\n"+ "                    {\n"+ "                        \"counterName\": \"counter2\",\n"+ "                        \"value\": 10\n"+ "                    }\n"+ "                ],\n"+ "                \"group2\": [\n"+ "                    {\n"+ "                        \"counterName\": \"counter1\",\n"+ "                        \"value\": 15\n"+ "                    }\n"+ "                ]\n"+ "            },\n"+ "            \"finishTime\": 1317928518754,\n"+ "            \"startTime\": 1317928510754,\n"+ "            \"status\": \"SUCCEEDED\",\n"+ "            \"taskId\": \"task_1317928501754_0001_r_000008\",\n"+ "            \"type\": \"REDUCE\"\n"+ "        }\n"+ "    ],\n"+ "    \"user\": \"rkanter\"\n"+ "}\n",outStr,JSONCompareMode.NON_EXTENSIBLE);
}
