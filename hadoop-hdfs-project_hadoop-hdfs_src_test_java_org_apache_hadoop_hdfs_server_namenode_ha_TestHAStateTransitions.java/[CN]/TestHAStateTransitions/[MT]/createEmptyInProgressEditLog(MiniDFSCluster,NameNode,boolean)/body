{
  long txid=nn.getNamesystem().getEditLog().getLastWrittenTxId();
  URI sharedEditsUri=cluster.getSharedEditsDir(0,1);
  File sharedEditsDir=new File(sharedEditsUri.getPath());
  StorageDirectory storageDir=new StorageDirectory(sharedEditsDir);
  File inProgressFile=NameNodeAdapter.getInProgressEditsFile(storageDir,txid + 1);
  assertTrue("Failed to create in-progress edits file",inProgressFile.createNewFile());
  if (writeHeader) {
    DataOutputStream out=new DataOutputStream(new FileOutputStream(inProgressFile));
    EditLogFileOutputStream.writeHeader(NameNodeLayoutVersion.CURRENT_LAYOUT_VERSION,out);
    out.close();
  }
}
