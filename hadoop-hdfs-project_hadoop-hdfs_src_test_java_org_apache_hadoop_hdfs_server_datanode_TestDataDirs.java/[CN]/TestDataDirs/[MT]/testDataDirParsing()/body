{
  Configuration conf=new Configuration();
  List<StorageLocation> locations;
  File dir0=new File("/dir0");
  File dir1=new File("/dir1");
  File dir2=new File("/dir2");
  File dir3=new File("/dir3");
  File dir4=new File("/dir4");
  String locations1="[disk]/dir0,[DISK]/dir1,[sSd]/dir2,[disK]/dir3,[ram_disk]/dir4";
  conf.set(DFS_DATANODE_DATA_DIR_KEY,locations1);
  locations=DataNode.getStorageLocations(conf);
  assertThat(locations.size(),is(4));
  assertThat(locations.get(0).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(0).getUri(),is(dir0.toURI()));
  assertThat(locations.get(1).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(1).getUri(),is(dir1.toURI()));
  assertThat(locations.get(2).getStorageType(),is(StorageType.SSD));
  assertThat(locations.get(2).getUri(),is(dir2.toURI()));
  assertThat(locations.get(3).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(3).getUri(),is(dir3.toURI()));
  assertThat(locations.get(4).getStorageType(),is(StorageType.RAM_DISK));
  assertThat(locations.get(4).getUri(),is(dir4.toURI()));
  String locations2="[BadMediaType]/dir0,[ssd]/dir1,[disk]/dir2";
  conf.set(DFS_DATANODE_DATA_DIR_KEY,locations2);
  try {
    locations=DataNode.getStorageLocations(conf);
    fail();
  }
 catch (  IllegalArgumentException iae) {
    DataNode.LOG.info("The exception is expected.",iae);
  }
  String locations3="/dir0,/dir1";
  conf.set(DFS_DATANODE_DATA_DIR_KEY,locations3);
  locations=DataNode.getStorageLocations(conf);
  assertThat(locations.size(),is(2));
  assertThat(locations.get(0).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(0).getUri(),is(dir0.toURI()));
  assertThat(locations.get(1).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(1).getUri(),is(dir1.toURI()));
}
