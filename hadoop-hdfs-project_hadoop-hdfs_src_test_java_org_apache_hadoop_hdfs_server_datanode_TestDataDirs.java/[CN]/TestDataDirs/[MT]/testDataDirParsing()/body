{
  Configuration conf=new Configuration();
  ArrayList<StorageLocation> locations;
  File dir0=new File("/dir0");
  File dir1=new File("/dir1");
  File dir2=new File("/dir2");
  File dir3=new File("/dir3");
  String locations1="[disk]/dir0,[DISK]/dir1,[sSd]/dir2,[disK]/dir3";
  conf.set(DFS_DATANODE_DATA_DIR_KEY,locations1);
  locations=new ArrayList<StorageLocation>(DataNode.getStorageLocations(conf));
  assertThat(locations.size(),is(4));
  assertThat(locations.get(0).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(0).getUri(),is(dir0.toURI()));
  assertThat(locations.get(1).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(1).getUri(),is(dir1.toURI()));
  assertThat(locations.get(2).getStorageType(),is(StorageType.SSD));
  assertThat(locations.get(2).getUri(),is(dir2.toURI()));
  assertThat(locations.get(3).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(3).getUri(),is(dir3.toURI()));
  String locations2="[BadMediaType]/dir0,[ssd]/dir1,[disk]/dir2";
  conf.set(DFS_DATANODE_DATA_DIR_KEY,locations2);
  locations=new ArrayList<StorageLocation>(DataNode.getStorageLocations(conf));
  assertThat(locations.size(),is(3));
  assertThat(locations.get(0).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(0).getUri(),is(dir0.toURI()));
  assertThat(locations.get(1).getStorageType(),is(StorageType.SSD));
  assertThat(locations.get(1).getUri(),is(dir1.toURI()));
  assertThat(locations.get(2).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(2).getUri(),is(dir2.toURI()));
  String locations3="/dir0,/dir1";
  conf.set(DFS_DATANODE_DATA_DIR_KEY,locations3);
  locations=new ArrayList<StorageLocation>(DataNode.getStorageLocations(conf));
  assertThat(locations.size(),is(2));
  assertThat(locations.get(0).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(0).getUri(),is(dir0.toURI()));
  assertThat(locations.get(1).getStorageType(),is(StorageType.DISK));
  assertThat(locations.get(1).getUri(),is(dir1.toURI()));
}
