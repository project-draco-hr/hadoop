{
  DataNodeDiskChecker diskChecker=mock(DataNodeDiskChecker.class);
  doThrow(new IOException()).doThrow(new IOException()).doNothing().when(diskChecker).checkDir(any(LocalFileSystem.class),any(Path.class));
  LocalFileSystem fs=mock(LocalFileSystem.class);
  Collection<URI> uris=Arrays.asList(new URI("file:/p1/"),new URI("file:/p2/"),new URI("file:/p3/"));
  List<File> dirs=DataNode.getDataDirsFromURIs(uris,fs,diskChecker);
  assertEquals("number of valid data dirs",1,dirs.size());
  String validDir=dirs.iterator().next().getPath();
  assertEquals("p3 should be valid",new File("/p3").getPath(),validDir);
}
