{
  conf=new JobConf();
  conf.set("mapred.fairscheduler.allocation.file",ALLOC_FILE);
  conf.set("mapred.fairscheduler.poolnameproperty",POOL_PROPERTY);
  conf.setBoolean("mapred.fairscheduler.assignmultiple",assignMultiple);
  conf.setLong("mapred.fairscheduler.locality.delay.node",5000);
  conf.setLong("mapred.fairscheduler.locality.delay.rack",10000);
  taskTrackerManager=new FakeTaskTrackerManager(numRacks,numNodesPerRack);
  clock=new FakeClock();
  scheduler=new FairScheduler(clock,true);
  scheduler.waitForMapsBeforeLaunchingReduces=false;
  scheduler.setConf(conf);
  scheduler.setTaskTrackerManager(taskTrackerManager);
  scheduler.start();
}
