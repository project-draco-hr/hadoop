{
  setUpCluster(1,2,true);
  JobInProgress job1=submitJob(JobStatus.RUNNING,2,1);
  JobInfo info1=scheduler.infos.get(job1);
  assertEquals(0,info1.mapSchedulable.getRunningTasks());
  assertEquals(0,info1.reduceSchedulable.getRunningTasks());
  assertEquals(2,info1.mapSchedulable.getDemand());
  assertEquals(1,info1.reduceSchedulable.getDemand());
  assertEquals(2.0,info1.mapSchedulable.getFairShare());
  assertEquals(1.0,info1.reduceSchedulable.getFairShare());
  advanceTime(100);
  JobInProgress job2=submitJob(JobStatus.RUNNING,1,2);
  JobInfo info2=scheduler.infos.get(job2);
  assertEquals(0,info1.mapSchedulable.getRunningTasks());
  assertEquals(0,info1.reduceSchedulable.getRunningTasks());
  assertEquals(2,info1.mapSchedulable.getDemand());
  assertEquals(1,info1.reduceSchedulable.getDemand());
  assertEquals(2.0,info1.mapSchedulable.getFairShare());
  assertEquals(1.0,info1.reduceSchedulable.getFairShare());
  assertEquals(0,info2.mapSchedulable.getRunningTasks());
  assertEquals(0,info2.reduceSchedulable.getRunningTasks());
  assertEquals(1,info2.mapSchedulable.getDemand());
  assertEquals(2,info2.reduceSchedulable.getDemand());
  assertEquals(1.0,info2.mapSchedulable.getFairShare());
  assertEquals(2.0,info2.reduceSchedulable.getFairShare());
  checkAssignment("tt1","attempt_test_0001_m_000000_0 on tt1","attempt_test_0001_r_000000_0 on tt1","attempt_test_0002_m_000000_0 on tt1","attempt_test_0002_r_000000_0 on tt1");
  checkAssignment("tt2","attempt_test_0001_m_000001_0 on tt2","attempt_test_0002_r_000001_0 on tt2");
  assertNull(scheduler.assignTasks(tracker("tt2")));
  assertEquals(2,info1.mapSchedulable.getRunningTasks());
  assertEquals(1,info1.reduceSchedulable.getRunningTasks());
  assertEquals(2,info1.mapSchedulable.getDemand());
  assertEquals(1,info1.reduceSchedulable.getDemand());
  assertEquals(1,info2.mapSchedulable.getRunningTasks());
  assertEquals(2,info2.reduceSchedulable.getRunningTasks());
  assertEquals(1,info2.mapSchedulable.getDemand());
  assertEquals(2,info2.reduceSchedulable.getDemand());
}
