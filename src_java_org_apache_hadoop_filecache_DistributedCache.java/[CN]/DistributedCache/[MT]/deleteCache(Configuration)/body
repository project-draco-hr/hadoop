{
synchronized (cachedArchives) {
    for (Iterator it=cachedArchives.keySet().iterator(); it.hasNext(); ) {
      String cacheId=(String)it.next();
      CacheStatus lcacheStatus=cachedArchives.get(cacheId);
synchronized (lcacheStatus) {
        if (lcacheStatus.refcount == 0) {
          FileSystem.getLocal(conf).delete(lcacheStatus.localLoadPath,true);
synchronized (baseDirSize) {
            Long dirSize=baseDirSize.get(lcacheStatus.baseDir);
            if (dirSize != null) {
              dirSize-=lcacheStatus.size;
              baseDirSize.put(lcacheStatus.baseDir,dirSize);
            }
          }
          it.remove();
        }
      }
    }
  }
}
