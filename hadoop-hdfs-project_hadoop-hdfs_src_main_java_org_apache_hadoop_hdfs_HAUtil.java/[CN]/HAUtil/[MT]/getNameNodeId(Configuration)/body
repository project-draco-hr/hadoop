{
  String namenodeId=conf.get(DFS_HA_NAMENODE_ID_KEY);
  if (namenodeId != null) {
    return namenodeId;
  }
  if (!isHAEnabled(conf)) {
    return null;
  }
  namenodeId=DFSUtil.getSuffixIDs(conf,DFS_NAMENODE_RPC_ADDRESS_KEY,DFSUtil.LOCAL_ADDRESS_MATCHER)[1];
  if (namenodeId == null) {
    String msg="Configuration " + DFS_NAMENODE_RPC_ADDRESS_KEY + " must be suffixed with"+ namenodeId+ " for HA configuration.";
    throw new HadoopIllegalArgumentException(msg);
  }
  return namenodeId;
}
