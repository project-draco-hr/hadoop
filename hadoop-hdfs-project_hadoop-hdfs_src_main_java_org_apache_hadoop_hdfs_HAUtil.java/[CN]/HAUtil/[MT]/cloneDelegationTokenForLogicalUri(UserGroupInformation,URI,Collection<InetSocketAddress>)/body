{
  Text haService=HAUtil.buildTokenServiceForLogicalUri(haUri);
  Token<DelegationTokenIdentifier> haToken=tokenSelector.selectToken(haService,ugi.getTokens());
  if (haToken != null) {
    for (    InetSocketAddress singleNNAddr : nnAddrs) {
      Token<DelegationTokenIdentifier> specificToken=new Token<DelegationTokenIdentifier>(haToken);
      SecurityUtil.setTokenService(specificToken,singleNNAddr);
      ugi.addToken(specificToken);
      LOG.debug("Mapped HA service delegation token for logical URI " + haUri + " to namenode "+ singleNNAddr);
    }
  }
 else {
    LOG.debug("No HA service delegation token found for logical URI " + haUri);
  }
}
