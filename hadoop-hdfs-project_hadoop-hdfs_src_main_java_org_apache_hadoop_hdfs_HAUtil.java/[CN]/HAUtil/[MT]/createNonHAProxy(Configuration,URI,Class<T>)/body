{
  InetSocketAddress nnAddr=NameNode.getAddress(nameNodeUri);
  Text dtService=SecurityUtil.buildTokenService(nnAddr);
  if (xface == ClientProtocol.class) {
    T proxy=(T)DFSUtil.createNamenode(nnAddr,conf);
    return new ProxyAndInfo<T>(proxy,dtService);
  }
 else   if (xface == NamenodeProtocol.class) {
    T proxy=(T)DFSUtil.createNNProxyWithNamenodeProtocol(nnAddr,conf,UserGroupInformation.getCurrentUser());
    return new ProxyAndInfo<T>(proxy,dtService);
  }
 else {
    throw new AssertionError("Unsupported proxy type: " + xface);
  }
}
