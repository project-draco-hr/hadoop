{
  Text haService=buildTokenServiceForLogicalUri(haUri);
  Token<DelegationTokenIdentifier> haToken=DelegationTokenSelector.selectHdfsDelegationToken(haService,ugi);
  if (haToken == null) {
    return;
  }
  Token<DelegationTokenIdentifier> specificToken=new Token<DelegationTokenIdentifier>(haToken);
  specificToken.setService(SecurityUtil.buildTokenService(singleNNAddr));
  ugi.addToken(specificToken);
  LOG.debug("Mapped HA service delegation token for logical URI " + haUri + " to namenode "+ singleNNAddr);
}
