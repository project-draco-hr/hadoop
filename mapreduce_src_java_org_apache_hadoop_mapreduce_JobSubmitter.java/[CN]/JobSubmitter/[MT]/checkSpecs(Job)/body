{
  JobConf jConf=(JobConf)job.getConfiguration();
  if (jConf.getNumReduceTasks() == 0 ? jConf.getUseNewMapper() : jConf.getUseNewReducer()) {
    org.apache.hadoop.mapreduce.OutputFormat<?,?> output=ReflectionUtils.newInstance(job.getOutputFormatClass(),job.getConfiguration());
    output.checkOutputSpecs(job);
  }
 else {
    jConf.getOutputFormat().checkOutputSpecs(jtFs,jConf);
  }
}
