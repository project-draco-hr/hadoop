{
  org.apache.hadoop.mapred.InputSplit[] splits=job.getInputFormat().getSplits(job,job.getNumMapTasks());
  Arrays.sort(splits,new Comparator<org.apache.hadoop.mapred.InputSplit>(){
    public int compare(    org.apache.hadoop.mapred.InputSplit a,    org.apache.hadoop.mapred.InputSplit b){
      try {
        long left=a.getLength();
        long right=b.getLength();
        if (left == right) {
          return 0;
        }
 else         if (left < right) {
          return 1;
        }
 else {
          return -1;
        }
      }
 catch (      IOException ie) {
        throw new RuntimeException("Problem getting input split size",ie);
      }
    }
  }
);
  JobSplitWriter.createSplitFiles(jobSubmitDir,job,jobSubmitDir.getFileSystem(job),splits);
  return splits.length;
}
