{
  TaskAttemptID[] taskAttemptID=new TaskAttemptID[3];
  JobConf conf=new JobConf();
  conf.setSpeculativeExecution(false);
  conf.setNumMapTasks(0);
  conf.setNumReduceTasks(5);
  conf.set(JobContext.REDUCE_FAILURES_MAXPERCENT,".70");
  conf.setBoolean(JobContext.SETUP_CLEANUP_NEEDED,false);
  conf.setMaxTaskFailuresPerTracker(1);
  FakeJobInProgress job=new FakeJobInProgress(conf,jobTracker);
  job.setClusterSize(trackers.length);
  job.initTasks();
  taskAttemptID[0]=job.findReduceTask(trackers[0]);
  taskAttemptID[1]=job.findReduceTask(trackers[1]);
  taskAttemptID[2]=job.findReduceTask(trackers[2]);
  job.finishTask(taskAttemptID[1]);
  job.finishTask(taskAttemptID[2]);
  job.failTask(taskAttemptID[0]);
  taskAttemptID[0]=job.findReduceTask(trackers[0]);
  job.failTask(taskAttemptID[0]);
  taskAttemptID[0]=job.findReduceTask(trackers[1]);
  job.finishTask(taskAttemptID[0]);
  taskAttemptID[0]=job.findReduceTask(trackers[1]);
  taskAttemptID[1]=job.findReduceTask(trackers[2]);
  job.finishTask(taskAttemptID[0]);
  job.finishTask(taskAttemptID[1]);
  jobTracker.finalizeJob(job);
  return job;
}
