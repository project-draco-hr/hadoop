{
  this.blob=blob;
  this.opContext=opContext;
  ArrayList<PageRange> allRanges;
  try {
    allRanges=blob.downloadPageRanges(new BlobRequestOptions(),opContext);
  }
 catch (  StorageException e) {
    throw new IOException(e);
  }
  if (allRanges.size() > 0) {
    if (allRanges.get(0).getStartOffset() != 0) {
      throw badStartRangeException(blob,allRanges.get(0));
    }
    if (allRanges.size() > 1) {
      LOG.warn(String.format("Blob %s has %d page ranges beyond the first range. " + "Only reading the first range.",blob.getUri(),allRanges.size() - 1));
    }
    numberOfPagesRemaining=(allRanges.get(0).getEndOffset() + 1) / PAGE_SIZE;
  }
 else {
    numberOfPagesRemaining=0;
  }
}
