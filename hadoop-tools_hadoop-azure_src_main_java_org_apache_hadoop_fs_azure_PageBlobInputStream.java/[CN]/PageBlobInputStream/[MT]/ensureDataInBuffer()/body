{
  if (dataAvailableInBuffer()) {
    return true;
  }
  currentBuffer=null;
  if (numberOfPagesRemaining == 0) {
    return false;
  }
  final long pagesToRead=Math.min(MAX_PAGES_PER_DOWNLOAD,numberOfPagesRemaining);
  final int bufferSize=(int)(pagesToRead * PAGE_SIZE);
  try {
    ByteArrayOutputStream baos=new ByteArrayOutputStream(bufferSize);
    blob.downloadRange(currentOffsetInBlob,bufferSize,baos,withMD5Checking(),opContext);
    currentBuffer=baos.toByteArray();
  }
 catch (  StorageException e) {
    throw new IOException(e);
  }
  numberOfPagesRemaining-=pagesToRead;
  currentOffsetInBlob+=bufferSize;
  currentOffsetInBuffer=PAGE_HEADER_SIZE;
  validateCurrentBufferConsistency();
  return true;
}
