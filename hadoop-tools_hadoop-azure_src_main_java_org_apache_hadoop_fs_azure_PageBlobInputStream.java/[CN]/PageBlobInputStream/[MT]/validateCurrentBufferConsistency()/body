{
  if (currentBuffer.length % PAGE_SIZE != 0) {
    throw new AssertionError("Unexpected buffer size: " + currentBuffer.length);
  }
  int numberOfPages=currentBuffer.length / PAGE_SIZE;
  for (int page=0; page < numberOfPages; page++) {
    short currentPageSize=getPageSize(blob,currentBuffer,page * PAGE_SIZE);
    long totalPagesAfterCurrent=(numberOfPages - page - 1) + numberOfPagesRemaining;
    if (currentPageSize < PAGE_DATA_SIZE && totalPagesAfterCurrent > 0) {
      throw fileCorruptException(blob,String.format("Page with partial data found in the middle (%d pages from the" + " end) that only has %d bytes of data.",totalPagesAfterCurrent,currentPageSize));
    }
  }
}
