{
  LOG.debug("Initializing the GangliaSink for Ganglia metrics.");
  this.conf=conf;
  if (conf.getString("slave.host.name") != null) {
    hostName=conf.getString("slave.host.name");
  }
 else {
    try {
      hostName=DNS.getDefaultHost(conf.getString("dfs.datanode.dns.interface","default"),conf.getString("dfs.datanode.dns.nameserver","default"));
    }
 catch (    UnknownHostException uhe) {
      LOG.error(uhe);
      hostName="UNKNOWN.example.com";
    }
  }
  metricsServers=Servers.parse(conf.getString(SERVERS_PROPERTY),DEFAULT_PORT);
  gangliaConfMap=new HashMap<String,GangliaConf>();
  loadGangliaConf(GangliaConfType.units);
  loadGangliaConf(GangliaConfType.tmax);
  loadGangliaConf(GangliaConfType.dmax);
  loadGangliaConf(GangliaConfType.slope);
  try {
    datagramSocket=new DatagramSocket();
  }
 catch (  SocketException se) {
    LOG.error(se);
  }
  supportSparseMetrics=conf.getBoolean(SUPPORT_SPARSE_METRICS_PROPERTY,SUPPORT_SPARSE_METRICS_DEFAULT);
}
