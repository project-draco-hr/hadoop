{
  LOG.info("START - testing with generated edits");
  nnHelper.startCluster(buildDir + "/dfs/");
  String edits=nnHelper.generateEdits();
  FileChannel editsFile=new FileOutputStream(edits,true).getChannel();
  editsFile.truncate(editsFile.size() - 5);
  String editsParsedXml=cacheDir + "/editsRecoveredParsed.xml";
  String editsReparsed=cacheDir + "/editsRecoveredReparsed";
  String editsParsedXml2=cacheDir + "/editsRecoveredParsed2.xml";
  assertEquals(-1,runOev(edits,editsParsedXml,"xml",false));
  assertEquals(0,runOev(edits,editsParsedXml,"xml",true));
  assertEquals(0,runOev(editsParsedXml,editsReparsed,"binary",false));
  assertEquals(0,runOev(editsReparsed,editsParsedXml2,"xml",false));
  assertTrue("Test round trip",filesEqualIgnoreTrailingZeros(editsParsedXml,editsParsedXml2));
  nnHelper.shutdownCluster();
  LOG.info("END");
}
