{
  LOG.info("START - testing with generated edits");
  nnHelper.startCluster(buildDir + "/dfs/");
  String edits=nnHelper.generateEdits();
  String editsParsedXml=cacheDir + "/editsParsed.xml";
  String editsReparsed=cacheDir + "/editsReparsed";
  assertEquals(0,runOev(edits,editsParsedXml,"xml",false));
  assertEquals(0,runOev(editsParsedXml,editsReparsed,"binary",false));
  assertTrue("Edits " + edits + " should have all op codes",hasAllOpCodes(edits));
  LOG.info("Comparing generated file " + editsReparsed + " with reference file "+ edits);
  assertTrue("Generated edits and reparsed (bin to XML to bin) should be same",filesEqualIgnoreTrailingZeros(edits,editsReparsed));
  nnHelper.shutdownCluster();
  LOG.info("END");
}
