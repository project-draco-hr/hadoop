{
  ByteBuffer small=ByteBuffer.wrap(DFSTestUtil.loadFile(filenameSmall));
  ByteBuffer large=ByteBuffer.wrap(DFSTestUtil.loadFile(filenameLarge));
  if (small.capacity() > large.capacity()) {
    ByteBuffer tmpByteBuffer=small;
    small=large;
    large=tmpByteBuffer;
    String tmpFilename=filenameSmall;
    filenameSmall=filenameLarge;
    filenameLarge=tmpFilename;
  }
  small.position(0);
  small.limit(small.capacity());
  large.position(0);
  large.limit(small.capacity());
  if (!small.equals(large)) {
    return false;
  }
  int i=large.limit();
  large.clear();
  for (; i < large.capacity(); i++) {
    if (large.get(i) != FSEditLogOpCodes.OP_INVALID.getOpCode()) {
      return false;
    }
  }
  return true;
}
