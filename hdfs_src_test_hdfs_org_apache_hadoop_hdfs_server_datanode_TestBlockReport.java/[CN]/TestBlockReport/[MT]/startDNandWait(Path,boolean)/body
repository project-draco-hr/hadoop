{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Before next DN start: " + cluster.getDataNodes().size());
  }
  cluster.startDataNodes(conf,1,true,null,null);
  ArrayList<DataNode> datanodes=cluster.getDataNodes();
  assertEquals(datanodes.size(),2);
  if (LOG.isDebugEnabled()) {
    LOG.debug("New datanode " + cluster.getDataNodes().get(datanodes.size() - 1).getMachineName() + " has been started");
  }
  if (waitReplicas)   DFSTestUtil.waitReplication(fs,filePath,REPL_FACTOR);
}
