{
  describe("verify trying to create a file over an empty dir fails");
  Path path=path("testOverwriteEmptyDirectory");
  mkdirs(path);
  assertIsDirectory(path);
  byte[] data=dataset(256,'a','z');
  try {
    writeDataset(getFileSystem(),path,data,data.length,1024,true);
    assertIsDirectory(path);
    fail("write of file over empty dir succeeded");
  }
 catch (  FileAlreadyExistsException expected) {
    handleExpectedException(expected);
  }
catch (  FileNotFoundException e) {
    handleRelaxedException("overwriting a dir with a file ","FileAlreadyExistsException",e);
  }
catch (  IOException e) {
    handleRelaxedException("overwriting a dir with a file ","FileAlreadyExistsException",e);
  }
  assertIsDirectory(path);
}
