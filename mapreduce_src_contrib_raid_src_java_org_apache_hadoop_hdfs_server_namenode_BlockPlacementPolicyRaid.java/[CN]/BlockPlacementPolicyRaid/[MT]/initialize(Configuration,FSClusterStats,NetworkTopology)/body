{
  this.conf=conf;
  this.stripeLength=RaidNode.getStripeLength(conf);
  this.rsParityLength=RaidNode.rsParityLength(conf);
  this.xorParityLength=1;
  try {
    this.xorPrefix=RaidNode.xorDestinationPath(conf).toUri().getPath();
    this.rsPrefix=RaidNode.rsDestinationPath(conf).toUri().getPath();
  }
 catch (  IOException e) {
  }
  if (this.xorPrefix == null) {
    this.xorPrefix=RaidNode.DEFAULT_RAID_LOCATION;
  }
  if (this.rsPrefix == null) {
    this.rsPrefix=RaidNode.DEFAULT_RAIDRS_LOCATION;
  }
  this.namesystem=(FSNamesystem)stats;
  this.cachedLocatedBlocks=new CachedLocatedBlocks(namesystem);
  this.cachedFullPathNames=new CachedFullPathNames(namesystem);
  this.raidTempPrefix=RaidNode.xorTempPrefix(conf);
  this.raidrsTempPrefix=RaidNode.rsTempPrefix(conf);
  this.raidHarTempPrefix=RaidNode.xorHarTempPrefix(conf);
  this.raidrsHarTempPrefix=RaidNode.rsHarTempPrefix(conf);
  defaultPolicy=new BlockPlacementPolicyDefault(conf,stats,clusterMap);
}
