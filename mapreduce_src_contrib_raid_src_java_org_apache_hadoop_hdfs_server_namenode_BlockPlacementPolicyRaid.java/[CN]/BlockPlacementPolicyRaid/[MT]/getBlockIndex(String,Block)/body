{
  List<LocatedBlock> blocks=cachedLocatedBlocks.get(file);
synchronized (blocks) {
    if (block == null) {
      return blocks.size();
    }
    for (int i=0; i < blocks.size(); i++) {
      if (blocks.get(i).getBlock().getLocalBlock().equals(block)) {
        return i;
      }
    }
  }
  throw new IOException("Cannot locate " + block + " in file "+ file);
}
