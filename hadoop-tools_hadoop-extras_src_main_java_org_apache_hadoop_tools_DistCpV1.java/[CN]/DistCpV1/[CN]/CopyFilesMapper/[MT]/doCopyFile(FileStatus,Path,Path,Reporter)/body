{
  long bytesCopied=0L;
  Path srcPath=srcstat.getPath();
  try (FSDataInputStream in=srcPath.getFileSystem(job).open(srcPath)){
    reporter.incrCounter(Counter.BYTESEXPECTED,srcstat.getLen());
    try (FSDataOutputStream out=create(tmpfile,reporter,srcstat)){
      LOG.info("Copying file " + srcPath + " of size "+ srcstat.getLen()+ " bytes...");
      for (int bytesRead; (bytesRead=in.read(buffer)) >= 0; ) {
        out.write(buffer,0,bytesRead);
        bytesCopied+=bytesRead;
        reporter.setStatus(String.format("%.2f ",bytesCopied * 100.0 / srcstat.getLen()) + absdst + " [ "+ TraditionalBinaryPrefix.long2String(bytesCopied,"",1)+ " / "+ TraditionalBinaryPrefix.long2String(srcstat.getLen(),"",1)+ " ]");
      }
    }
   }
   return bytesCopied;
}
