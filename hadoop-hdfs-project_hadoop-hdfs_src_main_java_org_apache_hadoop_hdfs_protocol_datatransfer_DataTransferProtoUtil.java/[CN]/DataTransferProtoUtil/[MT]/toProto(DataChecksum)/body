{
  ChecksumTypeProto type=HdfsProtoUtil.toProto(checksum.getChecksumType());
  if (type == null) {
    throw new IllegalArgumentException("Can't convert checksum to protobuf: " + checksum);
  }
  return ChecksumProto.newBuilder().setBytesPerChecksum(checksum.getBytesPerChecksum()).setType(type).build();
}
