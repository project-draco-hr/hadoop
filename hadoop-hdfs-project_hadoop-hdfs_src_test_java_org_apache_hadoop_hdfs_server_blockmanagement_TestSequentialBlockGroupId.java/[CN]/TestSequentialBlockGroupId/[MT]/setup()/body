{
  Configuration conf=new HdfsConfiguration();
  conf.setInt(DFSConfigKeys.DFS_REPLICATION_KEY,1);
  conf.setLong(DFSConfigKeys.DFS_BLOCK_SIZE_KEY,blockSize);
  cluster=new MiniDFSCluster.Builder(conf).numDataNodes(numDNs).build();
  cluster.waitActive();
  fs=cluster.getFileSystem();
  blockGrpIdGenerator=cluster.getNamesystem().getBlockIdManager().getBlockGroupIdGenerator();
  fs.mkdirs(ecDir);
  cluster.getFileSystem().getClient().setErasureCodingPolicy("/ecDir",null);
}
