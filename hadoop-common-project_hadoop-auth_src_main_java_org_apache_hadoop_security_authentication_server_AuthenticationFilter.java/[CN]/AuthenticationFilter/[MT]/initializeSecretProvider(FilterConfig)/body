{
  secretProvider=(SignerSecretProvider)filterConfig.getServletContext().getAttribute(SIGNER_SECRET_PROVIDER_ATTRIBUTE);
  if (secretProvider == null) {
    Class<? extends SignerSecretProvider> providerClass=getProviderClass(config);
    try {
      secretProvider=providerClass.newInstance();
    }
 catch (    InstantiationException ex) {
      throw new ServletException(ex);
    }
catch (    IllegalAccessException ex) {
      throw new ServletException(ex);
    }
    try {
      secretProvider.init(config,filterConfig.getServletContext(),validity);
    }
 catch (    Exception ex) {
      throw new ServletException(ex);
    }
  }
 else {
    customSecretProvider=true;
  }
  signer=new Signer(secretProvider);
}
