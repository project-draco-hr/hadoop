{
  this(dfsClient,src,progress,stat,checksum);
  this.shouldSyncBlock=flag.contains(CreateFlag.SYNC_BLOCK);
  computePacketChunkSize(dfsClient.getConf().writePacketSize,checksum.getBytesPerChecksum());
  Span traceSpan=null;
  if (Trace.isTracing()) {
    traceSpan=Trace.startSpan(this.getClass().getSimpleName()).detach();
  }
  streamer=new DataStreamer(stat,traceSpan);
  if (favoredNodes != null && favoredNodes.length != 0) {
    streamer.setFavoredNodes(favoredNodes);
  }
}
