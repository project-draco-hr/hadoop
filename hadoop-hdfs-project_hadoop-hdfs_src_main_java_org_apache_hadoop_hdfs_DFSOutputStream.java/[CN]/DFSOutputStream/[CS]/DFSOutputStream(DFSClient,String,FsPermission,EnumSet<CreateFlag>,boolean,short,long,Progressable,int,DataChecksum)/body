{
  this(dfsClient,src,blockSize,progress,checksum,replication);
  this.shouldSyncBlock=flag.contains(CreateFlag.SYNC_BLOCK);
  computePacketChunkSize(dfsClient.getConf().writePacketSize,checksum.getBytesPerChecksum());
  try {
    dfsClient.namenode.create(src,masked,dfsClient.clientName,new EnumSetWritable<CreateFlag>(flag),createParent,replication,blockSize);
  }
 catch (  RemoteException re) {
    throw re.unwrapRemoteException(AccessControlException.class,DSQuotaExceededException.class,FileAlreadyExistsException.class,FileNotFoundException.class,ParentNotDirectoryException.class,NSQuotaExceededException.class,SafeModeException.class,UnresolvedPathException.class);
  }
  streamer=new DataStreamer();
}
