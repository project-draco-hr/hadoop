{
  this(dfsClient,src,stat.getBlockSize(),progress,checksum,stat.getReplication());
  initialFileSize=stat.getLen();
  if (lastBlock != null) {
    bytesCurBlock=lastBlock.getBlockSize();
    streamer=new DataStreamer(lastBlock,stat,checksum.getBytesPerChecksum());
  }
 else {
    computePacketChunkSize(dfsClient.getConf().writePacketSize,checksum.getBytesPerChecksum());
    streamer=new DataStreamer();
  }
  streamer.start();
}
