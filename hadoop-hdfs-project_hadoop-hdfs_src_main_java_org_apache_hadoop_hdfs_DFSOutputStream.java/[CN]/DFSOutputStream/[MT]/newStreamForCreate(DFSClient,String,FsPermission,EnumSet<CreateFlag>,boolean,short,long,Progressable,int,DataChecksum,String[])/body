{
  final HdfsFileStatus stat;
  try {
    stat=dfsClient.namenode.create(src,masked,dfsClient.clientName,new EnumSetWritable<CreateFlag>(flag),createParent,replication,blockSize);
  }
 catch (  RemoteException re) {
    throw re.unwrapRemoteException(AccessControlException.class,DSQuotaExceededException.class,FileAlreadyExistsException.class,FileNotFoundException.class,ParentNotDirectoryException.class,NSQuotaExceededException.class,SafeModeException.class,UnresolvedPathException.class);
  }
  final DFSOutputStream out=new DFSOutputStream(dfsClient,src,stat,flag,progress,checksum,favoredNodes);
  out.start();
  return out;
}
