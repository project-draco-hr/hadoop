{
  if (DFSClient.LOG.isDebugEnabled()) {
    DFSClient.LOG.debug("Connecting to datanode " + first);
  }
  final InetSocketAddress isa=NetUtils.createSocketAddr(first.getXferAddr());
  final Socket sock=client.socketFactory.createSocket();
  final int timeout=client.getDatanodeReadTimeout(length);
  NetUtils.connect(sock,isa,timeout);
  sock.setSoTimeout(timeout);
  sock.setSendBufferSize(HdfsConstants.DEFAULT_DATA_SOCKET_SIZE);
  if (DFSClient.LOG.isDebugEnabled()) {
    DFSClient.LOG.debug("Send buf size " + sock.getSendBufferSize());
  }
  return sock;
}
