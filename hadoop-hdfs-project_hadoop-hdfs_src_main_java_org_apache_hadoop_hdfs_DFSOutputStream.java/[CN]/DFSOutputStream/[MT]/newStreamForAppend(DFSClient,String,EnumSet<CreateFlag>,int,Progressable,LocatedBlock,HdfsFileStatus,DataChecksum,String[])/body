{
  TraceScope scope=dfsClient.getPathTraceScope("newStreamForAppend",src);
  if (stat.getReplication() == 0) {
    throw new IOException("Not support appending to a striping layout file yet.");
  }
  try {
    final DFSOutputStream out=new DFSOutputStream(dfsClient,src,flags,progress,lastBlock,stat,checksum,favoredNodes);
    out.start();
    return out;
  }
  finally {
    scope.close();
  }
}
