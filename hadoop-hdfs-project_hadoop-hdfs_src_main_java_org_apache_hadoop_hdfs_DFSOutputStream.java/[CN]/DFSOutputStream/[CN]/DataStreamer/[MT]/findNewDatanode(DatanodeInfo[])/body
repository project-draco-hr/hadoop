{
  if (nodes.length != original.length + 1) {
    throw new IOException("Failed to add a datanode.  " + "User may turn off this feature by setting " + DFSConfigKeys.DFS_CLIENT_WRITE_REPLACE_DATANODE_ON_FAILURE_POLICY_KEY + " in configuration, where the current policy is "+ dfsClient.dtpReplaceDatanodeOnFailure+ ".  (Nodes: current="+ Arrays.asList(nodes)+ ", original="+ Arrays.asList(original)+ ")");
  }
  for (int i=0; i < nodes.length; i++) {
    int j=0;
    for (; j < original.length && !nodes[i].equals(original[j]); j++)     ;
    if (j == original.length) {
      return i;
    }
  }
  throw new IOException("Failed: new datanode not found: nodes=" + Arrays.asList(nodes) + ", original="+ Arrays.asList(original));
}
