{
  long numBytesToWritePerMap=conf.getLong(BYTES_PER_MAP,10 * 1024);
  long totalBytesToWrite=conf.getLong(TOTAL_BYTES,numBytesToWritePerMap);
  int numMaps=(int)(totalBytesToWrite / numBytesToWritePerMap);
  if (numMaps == 0 && totalBytesToWrite > 0) {
    numMaps=1;
    conf.setLong(BYTES_PER_MAP,totalBytesToWrite);
  }
  conf.setInt(MRJobConfig.NUM_MAPS,numMaps);
  Job job=new Job(conf);
  job.setJarByClass(RandomTextWriterJob.class);
  job.setJobName("random-text-writer");
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(Text.class);
  job.setInputFormatClass(RandomInputFormat.class);
  job.setMapperClass(RandomTextMapper.class);
  job.setOutputFormatClass(SequenceFileOutputFormat.class);
  job.setNumReduceTasks(0);
  return job;
}
