{
  if (!isAllowedDelegationTokenOp()) {
    throw new IOException("Delegation Token can be renewed only with kerberos authentication");
  }
  DelegationToken protoToken=request.getDelegationToken();
  Token<MRDelegationTokenIdentifier> token=new Token<MRDelegationTokenIdentifier>(protoToken.getIdentifier().array(),protoToken.getPassword().array(),new Text(protoToken.getKind()),new Text(protoToken.getService()));
  String user=UserGroupInformation.getCurrentUser().getShortUserName();
  long nextExpTime=jhsDTSecretManager.renewToken(token,user);
  RenewDelegationTokenResponse renewResponse=Records.newRecord(RenewDelegationTokenResponse.class);
  renewResponse.setNextExpirationTime(nextExpTime);
  return renewResponse;
}
