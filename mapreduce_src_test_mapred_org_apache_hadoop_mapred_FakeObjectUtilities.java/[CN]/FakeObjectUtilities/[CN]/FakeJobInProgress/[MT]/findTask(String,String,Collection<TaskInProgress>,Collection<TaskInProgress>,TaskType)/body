{
  TaskInProgress tip=null;
  Iterator<TaskInProgress> iter=nonRunningTasks.iterator();
  while (iter.hasNext()) {
    TaskInProgress t=iter.next();
    if (t.isRunnable() && !t.isRunning()) {
      runningTasks.add(t);
      iter.remove();
      tip=t;
      break;
    }
  }
  if (tip == null) {
    if (getJobConf().getSpeculativeExecution()) {
      tip=findSpeculativeTask(runningTasks,trackerName,trackerHost,taskType);
    }
  }
  if (tip != null) {
    TaskAttemptID tId=tip.getTaskToRun(trackerName).getTaskID();
    if (tip.isMapTask()) {
      scheduleMap(tip);
    }
 else {
      scheduleReduce(tip);
    }
    makeRunning(tId,tip,trackerName);
    return tId;
  }
  return null;
}
