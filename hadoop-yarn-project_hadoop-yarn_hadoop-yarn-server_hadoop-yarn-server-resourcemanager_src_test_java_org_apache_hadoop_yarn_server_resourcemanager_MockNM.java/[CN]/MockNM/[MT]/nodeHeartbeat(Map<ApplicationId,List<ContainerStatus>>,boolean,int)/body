{
  NodeHeartbeatRequest req=Records.newRecord(NodeHeartbeatRequest.class);
  NodeStatus status=Records.newRecord(NodeStatus.class);
  status.setResponseId(resId);
  status.setNodeId(nodeId);
  for (  Map.Entry<ApplicationId,List<ContainerStatus>> entry : conts.entrySet()) {
    status.setContainersStatuses(entry.getValue());
  }
  NodeHealthStatus healthStatus=Records.newRecord(NodeHealthStatus.class);
  healthStatus.setHealthReport("");
  healthStatus.setIsNodeHealthy(isHealthy);
  healthStatus.setLastHealthReportTime(1);
  status.setNodeHealthStatus(healthStatus);
  req.setNodeStatus(status);
  req.setLastKnownMasterKey(this.currentMasterKey);
  NodeHeartbeatResponse heartbeatResponse=resourceTracker.nodeHeartbeat(req);
  MasterKey masterKeyFromRM=heartbeatResponse.getMasterKey();
  this.currentMasterKey=(masterKeyFromRM != null && masterKeyFromRM.getKeyId() != this.currentMasterKey.getKeyId() ? masterKeyFromRM : this.currentMasterKey);
  return heartbeatResponse;
}
