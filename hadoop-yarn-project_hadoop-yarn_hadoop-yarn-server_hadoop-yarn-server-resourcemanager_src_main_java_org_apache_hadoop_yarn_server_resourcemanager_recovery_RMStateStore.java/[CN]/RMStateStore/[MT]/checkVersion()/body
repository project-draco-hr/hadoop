{
  RMStateVersion loadedVersion=loadVersion();
  LOG.info("Loaded RM state version info " + loadedVersion);
  if (loadedVersion != null && loadedVersion.equals(getCurrentVersion())) {
    return;
  }
  if (loadedVersion == null) {
    loadedVersion=RMStateVersion.newInstance(1,0);
  }
  if (loadedVersion.isCompatibleTo(getCurrentVersion())) {
    LOG.info("Storing RM state version info " + getCurrentVersion());
    storeVersion();
  }
 else {
    throw new RMStateVersionIncompatibleException("Expecting RM state version " + getCurrentVersion() + ", but loading version "+ loadedVersion);
  }
}
