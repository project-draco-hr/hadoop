{
  if (!(event instanceof RMStateStoreAMRMTokenEvent)) {
    LOG.error("Illegal event type: " + event.getClass());
    return RMStateStoreState.ACTIVE;
  }
  RMStateStoreAMRMTokenEvent amrmEvent=(RMStateStoreAMRMTokenEvent)event;
  boolean isFenced=false;
  try {
    LOG.info("Updating AMRMToken");
    store.storeOrUpdateAMRMTokenSecretManagerState(amrmEvent.getAmrmTokenSecretManagerState(),amrmEvent.isUpdate());
  }
 catch (  Exception e) {
    LOG.error("Error storing info for AMRMTokenSecretManager",e);
    isFenced=store.notifyStoreOperationFailedInternal(e);
  }
  return finalState(isFenced);
}
