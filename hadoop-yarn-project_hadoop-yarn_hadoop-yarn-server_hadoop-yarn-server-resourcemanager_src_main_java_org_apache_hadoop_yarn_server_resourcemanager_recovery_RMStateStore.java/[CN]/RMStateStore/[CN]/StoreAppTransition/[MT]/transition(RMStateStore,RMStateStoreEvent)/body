{
  if (!(event instanceof RMStateStoreAppEvent)) {
    LOG.error("Illegal event type: " + event.getClass());
    return RMStateStoreState.ACTIVE;
  }
  boolean isFenced=false;
  ApplicationStateData appState=((RMStateStoreAppEvent)event).getAppState();
  ApplicationId appId=appState.getApplicationSubmissionContext().getApplicationId();
  LOG.info("Storing info for app: " + appId);
  try {
    store.storeApplicationStateInternal(appId,appState);
    store.notifyApplication(new RMAppEvent(appId,RMAppEventType.APP_NEW_SAVED));
  }
 catch (  Exception e) {
    LOG.error("Error storing app: " + appId,e);
    isFenced=store.notifyStoreOperationFailedInternal(e);
  }
  return finalState(isFenced);
}
