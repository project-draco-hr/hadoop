{
  AccessKey key=allKeys.get(keyID);
  if (key == null) {
    LOG.warn("Access key for keyID=" + keyID + " doesn't exist.");
    return false;
  }
  if (key.getMac() == null) {
    initMac(key);
  }
  Text tokenID=token.getTokenID();
  Text authenticator=new Text(key.getMac().doFinal(tokenID.getBytes()));
  return authenticator.equals(token.getTokenAuthenticator());
}
