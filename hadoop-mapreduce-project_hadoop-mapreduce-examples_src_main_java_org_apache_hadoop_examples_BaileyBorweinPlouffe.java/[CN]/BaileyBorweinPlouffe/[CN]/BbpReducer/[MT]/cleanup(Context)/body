{
  final Configuration conf=context.getConfiguration();
  final Path dir=new Path(conf.get(WORKING_DIR_PROPERTY));
  final FileSystem fs=dir.getFileSystem(conf);
{
    final Path hexfile=new Path(conf.get(HEX_FILE_PROPERTY));
    final OutputStream out=new BufferedOutputStream(fs.create(hexfile));
    try {
      for (      byte b : hex)       out.write(b);
    }
  finally {
      out.close();
    }
  }
  if (conf.getInt(DIGIT_START_PROPERTY,1) == 1) {
    final Path outfile=new Path(dir,"pi.txt");
    LOG.info("Writing text output to " + outfile);
    final OutputStream outputstream=fs.create(outfile);
    try {
      final PrintWriter out=new PrintWriter(new OutputStreamWriter(outputstream,Charsets.UTF_8),true);
      print(out,hex.iterator(),"Pi = 0x3.","%02X",5,5);
      out.println("Total number of hexadecimal digits is " + 2 * hex.size() + ".");
      final Fraction dec=new Fraction(hex);
      final int decDigits=2 * hex.size();
      print(out,new Iterator<Integer>(){
        private int i=0;
        public boolean hasNext(){
          return i < decDigits;
        }
        public Integer next(){
          i++;
          return dec.times10();
        }
        public void remove(){
        }
      }
,"Pi = 3.","%d",10,5);
      out.println("Total number of decimal digits is " + decDigits + ".");
    }
  finally {
      outputstream.close();
    }
  }
}
