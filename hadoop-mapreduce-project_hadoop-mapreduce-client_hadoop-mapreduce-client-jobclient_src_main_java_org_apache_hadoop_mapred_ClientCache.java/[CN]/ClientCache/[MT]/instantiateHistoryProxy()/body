{
  String serviceAddr=conf.get(JHConfig.HS_BIND_ADDRESS,JHConfig.DEFAULT_HS_BIND_ADDRESS);
  LOG.info("Connecting to HistoryServer at: " + serviceAddr);
  Configuration myConf=new Configuration(conf);
  myConf.setClass(YarnConfiguration.YARN_SECURITY_INFO,ClientRMSecurityInfo.class,SecurityInfo.class);
  YarnRPC rpc=YarnRPC.create(myConf);
  LOG.info("Connected to HistoryServer at: " + serviceAddr);
  return (MRClientProtocol)rpc.getProxy(MRClientProtocol.class,NetUtils.createSocketAddr(serviceAddr),myConf);
}
