{
  String[] qop=conf.getStrings("hadoop.rpc.protection",QualityOfProtection.AUTHENTICATION.toString());
  for (int i=0; i < qop.length; i++) {
    qop[i]=QualityOfProtection.valueOf(qop[i].toUpperCase()).getSaslQop();
  }
  SASL_PROPS.put(Sasl.QOP,StringUtils.join(",",qop));
  SASL_PROPS.put(Sasl.SERVER_AUTH,"true");
  Security.addProvider(new SaslPlainServer.SecurityProvider());
  saslFactory=new FastSaslServerFactory(SASL_PROPS);
}
