{
  QualityOfProtection saslQOP=QualityOfProtection.AUTHENTICATION;
  String rpcProtection=conf.get("hadoop.rpc.protection",QualityOfProtection.AUTHENTICATION.name().toLowerCase());
  if (QualityOfProtection.INTEGRITY.name().toLowerCase().equals(rpcProtection)) {
    saslQOP=QualityOfProtection.INTEGRITY;
  }
 else   if (QualityOfProtection.PRIVACY.name().toLowerCase().equals(rpcProtection)) {
    saslQOP=QualityOfProtection.PRIVACY;
  }
  SASL_PROPS.put(Sasl.QOP,saslQOP.getSaslQop());
  SASL_PROPS.put(Sasl.SERVER_AUTH,"true");
  Security.addProvider(new SaslPlainServer.SecurityProvider());
  saslFactory=new FastSaslServerFactory(SASL_PROPS);
}
