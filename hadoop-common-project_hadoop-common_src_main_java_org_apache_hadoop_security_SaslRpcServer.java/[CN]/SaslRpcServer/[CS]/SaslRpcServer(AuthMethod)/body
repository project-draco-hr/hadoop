{
  this.authMethod=authMethod;
  mechanism=authMethod.getMechanismName();
switch (authMethod) {
case SIMPLE:
{
      return;
    }
case TOKEN:
{
    protocol="";
    serverId=SaslRpcServer.SASL_DEFAULT_REALM;
    break;
  }
case KERBEROS:
{
  String fullName=UserGroupInformation.getCurrentUser().getUserName();
  if (LOG.isDebugEnabled())   LOG.debug("Kerberos principal name is " + fullName);
  String[] parts=fullName.split("[/@]",2);
  protocol=parts[0];
  serverId=(parts.length < 2) ? "" : parts[1];
  break;
}
default :
throw new AccessControlException("Server does not support SASL " + authMethod);
}
}
