{
  this.authMethod=authMethod;
  mechanism=authMethod.getMechanismName();
switch (authMethod) {
case SIMPLE:
{
      return;
    }
case TOKEN:
{
    protocol="";
    serverId=SaslRpcServer.SASL_DEFAULT_REALM;
    break;
  }
case KERBEROS:
{
  String fullName=UserGroupInformation.getCurrentUser().getUserName();
  if (LOG.isDebugEnabled())   LOG.debug("Kerberos principal name is " + fullName);
  KerberosName krbName=new KerberosName(fullName);
  serverId=krbName.getHostName();
  if (serverId == null) {
    serverId="";
  }
  protocol=krbName.getServiceName();
  break;
}
default :
throw new AccessControlException("Server does not support SASL " + authMethod);
}
}
