{
  JobStatus status=null;
  JobStory story=submitEvent.getJob();
  try {
    status=submitJob(story);
  }
 catch (  InterruptedException e) {
    throw new IOException(e);
  }
  runningJobs.put(status.getJobID(),new JobSketchInfo(story.getNumberMaps(),story.getNumberReduces()));
  System.out.println("Job " + status.getJobID() + " is submitted at "+ submitEvent.getTimeStamp());
  nextJob=jobStoryProducer.getNextJob();
  if (nextJob == null) {
    noMoreJobs=true;
    return SimulatorEngine.EMPTY_EVENTS;
  }
 else   if (submissionPolicy == SimulatorJobSubmissionPolicy.REPLAY) {
    return Collections.<SimulatorEvent>singletonList(new JobSubmissionEvent(this,nextJob.getSubmissionTime(),nextJob));
  }
 else   if (submissionPolicy == SimulatorJobSubmissionPolicy.STRESS) {
    return checkLoadAndSubmitJob(submitEvent.getTimeStamp());
  }
  return SimulatorEngine.EMPTY_EVENTS;
}
