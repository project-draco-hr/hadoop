{
  Path absolutePath=makeAbsolute(f);
  INode inode=store.retrieveINode(absolutePath);
  if (inode == null) {
    throw new FileNotFoundException("File " + f + " does not exist.");
  }
  if (inode.isFile()) {
    return new FileStatus[]{new S3FileStatus(f.makeQualified(this),inode)};
  }
  ArrayList<FileStatus> ret=new ArrayList<FileStatus>();
  for (  Path p : store.listSubPaths(absolutePath)) {
    ret.add(getFileStatus(p.makeQualified(this)));
  }
  return ret.toArray(new FileStatus[0]);
}
