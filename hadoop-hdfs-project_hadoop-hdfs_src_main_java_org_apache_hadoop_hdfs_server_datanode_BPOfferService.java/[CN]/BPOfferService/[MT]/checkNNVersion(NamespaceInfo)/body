{
  String nsBuildVer=nsInfo.getBuildVersion();
  String stBuildVer=Storage.getBuildVersion();
  if (!nsBuildVer.equals(stBuildVer)) {
    LOG.warn("Data-node and name-node Build versions must be the same. " + "Namenode build version: " + nsBuildVer + "Datanode "+ "build version: "+ stBuildVer);
    throw new IncorrectVersionException(nsBuildVer,"namenode",stBuildVer);
  }
  if (HdfsConstants.LAYOUT_VERSION != nsInfo.getLayoutVersion()) {
    LOG.warn("Data-node and name-node layout versions must be the same." + " Expected: " + HdfsConstants.LAYOUT_VERSION + " actual "+ bpNSInfo.getLayoutVersion());
    throw new IncorrectVersionException(bpNSInfo.getLayoutVersion(),"namenode");
  }
}
