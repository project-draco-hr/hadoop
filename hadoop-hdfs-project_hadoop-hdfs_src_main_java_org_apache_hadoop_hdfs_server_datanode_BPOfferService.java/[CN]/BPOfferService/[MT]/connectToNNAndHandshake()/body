{
  bpNamenode=(DatanodeProtocol)RPC.waitForProxy(DatanodeProtocol.class,DatanodeProtocol.versionID,nnAddr,dn.getConf());
  bpNSInfo=retrieveNamespaceInfo();
  dn.initBlockPool(this);
  register();
}
