{
  writeLock();
  try {
    if (this.bpNSInfo == null) {
      this.bpNSInfo=nsInfo;
      boolean success=false;
      try {
        dn.initBlockPool(this);
        success=true;
      }
  finally {
        if (!success) {
          this.bpNSInfo=null;
        }
      }
    }
 else {
      checkNSEquality(bpNSInfo.getBlockPoolID(),nsInfo.getBlockPoolID(),"Blockpool ID");
      checkNSEquality(bpNSInfo.getNamespaceID(),nsInfo.getNamespaceID(),"Namespace ID");
      checkNSEquality(bpNSInfo.getClusterID(),nsInfo.getClusterID(),"Cluster ID");
    }
  }
  finally {
    writeUnlock();
  }
}
