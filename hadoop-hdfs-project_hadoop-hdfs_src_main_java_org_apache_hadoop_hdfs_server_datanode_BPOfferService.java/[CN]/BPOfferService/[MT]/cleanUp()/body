{
  if (upgradeManager != null)   upgradeManager.shutdownUpgrade();
  shouldServiceRun=false;
  RPC.stopProxy(bpNamenode);
  dn.shutdownBlockPool(this);
}
