{
  HistoryViewer.SummarizedJob ts=new HistoryViewer.SummarizedJob(job);
  JSONObject jSums=new JSONObject();
  JSONObject jSumSetup=new JSONObject();
  jSumSetup.put("total",ts.totalSetups);
  jSumSetup.put("successful",ts.numFinishedSetups);
  jSumSetup.put("failed",ts.numFailedSetups);
  jSumSetup.put("killed",ts.numKilledSetups);
  jSumSetup.put("startTime",ts.setupStarted);
  jSumSetup.put("finishTime",ts.setupFinished);
  jSums.put("setup",jSumSetup);
  JSONObject jSumMap=new JSONObject();
  jSumMap.put("total",ts.totalMaps);
  jSumMap.put("successful",job.getFinishedMaps());
  jSumMap.put("failed",ts.numFailedMaps);
  jSumMap.put("killed",ts.numKilledMaps);
  jSumMap.put("startTime",ts.mapStarted);
  jSumMap.put("finishTime",ts.mapFinished);
  jSums.put("map",jSumMap);
  JSONObject jSumReduce=new JSONObject();
  jSumReduce.put("total",ts.totalReduces);
  jSumReduce.put("successful",job.getFinishedReduces());
  jSumReduce.put("failed",ts.numFailedReduces);
  jSumReduce.put("killed",ts.numKilledReduces);
  jSumReduce.put("startTime",ts.reduceStarted);
  jSumReduce.put("finishTime",ts.reduceFinished);
  jSums.put("reduce",jSumReduce);
  JSONObject jSumCleanup=new JSONObject();
  jSumCleanup.put("total",ts.totalCleanups);
  jSumCleanup.put("successful",ts.numFinishedCleanups);
  jSumCleanup.put("failed",ts.numFailedCleanups);
  jSumCleanup.put("killed",ts.numKilledCleanups);
  jSumCleanup.put("startTime",ts.cleanupStarted);
  jSumCleanup.put("finishTime",ts.cleanupFinished);
  jSums.put("cleanup",jSumCleanup);
  json.put("taskSummary",jSums);
}
