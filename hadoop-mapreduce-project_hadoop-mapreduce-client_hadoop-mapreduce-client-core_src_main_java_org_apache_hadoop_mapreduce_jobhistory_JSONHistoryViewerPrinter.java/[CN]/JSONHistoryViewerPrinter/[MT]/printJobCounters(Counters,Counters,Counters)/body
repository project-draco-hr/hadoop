{
  if (totalCounters != null) {
    JSONObject jGroups=new JSONObject();
    for (    String groupName : totalCounters.getGroupNames()) {
      CounterGroup totalGroup=totalCounters.getGroup(groupName);
      CounterGroup mapGroup=mapCounters.getGroup(groupName);
      CounterGroup reduceGroup=reduceCounters.getGroup(groupName);
      Iterator<Counter> ctrItr=totalGroup.iterator();
      JSONArray jGroup=new JSONArray();
      while (ctrItr.hasNext()) {
        JSONObject jCounter=new JSONObject();
        org.apache.hadoop.mapreduce.Counter counter=ctrItr.next();
        String name=counter.getName();
        long mapValue=mapGroup.findCounter(name).getValue();
        long reduceValue=reduceGroup.findCounter(name).getValue();
        long totalValue=counter.getValue();
        jCounter.put("counterName",name);
        jCounter.put("mapValue",mapValue);
        jCounter.put("reduceValue",reduceValue);
        jCounter.put("totalValue",totalValue);
        jGroup.put(jCounter);
      }
      jGroups.put(fixGroupNameForShuffleErrors(totalGroup.getName()),jGroup);
    }
    json.put("counters",jGroups);
  }
}
